var l8=Object.defineProperty;var c8=(t,e,i)=>e in t?l8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var y=(t,e,i)=>(c8(t,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=i(r);fetch(r.href,s)}})();/**
* @vue/shared v3.4.15
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function P1(t,e){const i=new Set(t.split(","));return e?n=>i.has(n.toLowerCase()):n=>i.has(n)}const _n={},km=[],Ho=()=>{},h8=()=>!1,Z_=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),E1=t=>t.startsWith("onUpdate:"),yr=Object.assign,w1=(t,e)=>{const i=t.indexOf(e);i>-1&&t.splice(i,1)},u8=Object.prototype.hasOwnProperty,Bi=(t,e)=>u8.call(t,e),Ht=Array.isArray,Cm=t=>J_(t)==="[object Map]",uz=t=>J_(t)==="[object Set]",si=t=>typeof t=="function",Dn=t=>typeof t=="string",Cp=t=>typeof t=="symbol",yn=t=>t!==null&&typeof t=="object",T1=t=>(yn(t)||si(t))&&si(t.then)&&si(t.catch),dz=Object.prototype.toString,J_=t=>dz.call(t),d8=t=>J_(t).slice(8,-1),fz=t=>J_(t)==="[object Object]",x1=t=>Dn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,e0=P1(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Q_=t=>{const e=Object.create(null);return i=>e[i]||(e[i]=t(i))},f8=/-(\w)/g,Ia=Q_(t=>t.replace(f8,(e,i)=>i?i.toUpperCase():"")),m8=/\B([A-Z])/g,Mp=Q_(t=>t.replace(m8,"-$1").toLowerCase()),vh=Q_(t=>t.charAt(0).toUpperCase()+t.slice(1)),t0=Q_(t=>t?`on${vh(t)}`:""),Tu=(t,e)=>!Object.is(t,e),i0=(t,e)=>{for(let i=0;i<t.length;i++)t[i](e)},D0=(t,e,i)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:i})},Nx=t=>{const e=parseFloat(t);return isNaN(e)?t:e},mz=t=>{const e=Dn(t)?Number(t):NaN;return isNaN(e)?t:e};let rL;const pz=()=>rL||(rL=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function mr(t){if(Ht(t)){const e={};for(let i=0;i<t.length;i++){const n=t[i],r=Dn(n)?y8(n):mr(n);if(r)for(const s in r)e[s]=r[s]}return e}else if(Dn(t)||yn(t))return t}const p8=/;(?![^(]*\))/g,g8=/:([^]+)/,v8=/\/\*[^]*?\*\//g;function y8(t){const e={};return t.replace(v8,"").split(p8).forEach(i=>{if(i){const n=i.split(g8);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Gs(t){let e="";if(Dn(t))e=t;else if(Ht(t))for(let i=0;i<t.length;i++){const n=Gs(t[i]);n&&(e+=n+" ")}else if(yn(t))for(const i in t)t[i]&&(e+=i+" ");return e.trim()}function k1(t){if(!t)return null;let{class:e,style:i}=t;return e&&!Dn(e)&&(t.class=Gs(e)),i&&(t.style=mr(i)),t}const S8="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",b8=P1(S8);function gz(t){return!!t||t===""}const nt=t=>Dn(t)?t:t==null?"":Ht(t)||yn(t)&&(t.toString===dz||!si(t.toString))?JSON.stringify(t,vz,2):String(t),vz=(t,e)=>e&&e.__v_isRef?vz(t,e.value):Cm(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((i,[n,r],s)=>(i[cw(n,s)+" =>"]=r,i),{})}:uz(e)?{[`Set(${e.size})`]:[...e.values()].map(i=>cw(i))}:Cp(e)?cw(e):yn(e)&&!Ht(e)&&!fz(e)?String(e):e,cw=(t,e="")=>{var i;return Cp(t)?`Symbol(${(i=t.description)!=null?i:e})`:t};/**
* @vue/reactivity v3.4.15
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Uo;class yz{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Uo,!e&&Uo&&(this.index=(Uo.scopes||(Uo.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const i=Uo;try{return Uo=this,e()}finally{Uo=i}}}on(){Uo=this}off(){Uo=this.parent}stop(e){if(this._active){let i,n;for(i=0,n=this.effects.length;i<n;i++)this.effects[i].stop();for(i=0,n=this.cleanups.length;i<n;i++)this.cleanups[i]();if(this.scopes)for(i=0,n=this.scopes.length;i<n;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function Ap(t){return new yz(t)}function _8(t,e=Uo){e&&e.active&&e.effects.push(t)}function C1(){return Uo}function ls(t){Uo&&Uo.cleanups.push(t)}let Ed;class M1{constructor(e,i,n,r){this.fn=e,this.trigger=i,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=2,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,_8(this,r)}get dirty(){if(this._dirtyLevel===1){Yd();for(let e=0;e<this._depsLength;e++){const i=this.deps[e];if(i.computed&&(P8(i.computed),this._dirtyLevel>=2))break}this._dirtyLevel<2&&(this._dirtyLevel=0),Zd()}return this._dirtyLevel>=2}set dirty(e){this._dirtyLevel=e?2:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=pu,i=Ed;try{return pu=!0,Ed=this,this._runnings++,sL(this),this.fn()}finally{oL(this),this._runnings--,Ed=i,pu=e}}stop(){var e;this.active&&(sL(this),oL(this),(e=this.onStop)==null||e.call(this),this.active=!1)}}function P8(t){return t.value}function sL(t){t._trackId++,t._depsLength=0}function oL(t){if(t.deps&&t.deps.length>t._depsLength){for(let e=t._depsLength;e<t.deps.length;e++)Sz(t.deps[e],t);t.deps.length=t._depsLength}}function Sz(t,e){const i=t.get(e);i!==void 0&&e._trackId!==i&&(t.delete(e),t.size===0&&t.cleanup())}let pu=!0,Rx=0;const bz=[];function Yd(){bz.push(pu),pu=!1}function Zd(){const t=bz.pop();pu=t===void 0?!0:t}function A1(){Rx++}function V1(){for(Rx--;!Rx&&Fx.length;)Fx.shift()()}function _z(t,e,i){if(e.get(t)!==t._trackId){e.set(t,t._trackId);const n=t.deps[t._depsLength];n!==e?(n&&Sz(n,t),t.deps[t._depsLength++]=e):t._depsLength++}}const Fx=[];function Pz(t,e,i){A1();for(const n of t.keys())if(n._dirtyLevel<e&&t.get(n)===n._trackId){const r=n._dirtyLevel;n._dirtyLevel=e,r===0&&(n._shouldSchedule=!0,n.trigger())}Ez(t),V1()}function Ez(t){for(const e of t.keys())e.scheduler&&e._shouldSchedule&&(!e._runnings||e.allowRecurse)&&t.get(e)===e._trackId&&(e._shouldSchedule=!1,Fx.push(e.scheduler))}const wz=(t,e)=>{const i=new Map;return i.cleanup=t,i.computed=e,i},N0=new WeakMap,wd=Symbol(""),zx=Symbol("");function To(t,e,i){if(pu&&Ed){let n=N0.get(t);n||N0.set(t,n=new Map);let r=n.get(i);r||n.set(i,r=wz(()=>n.delete(i))),_z(Ed,r)}}function Qc(t,e,i,n,r,s){const o=N0.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(i==="length"&&Ht(t)){const l=Number(n);o.forEach((c,u)=>{(u==="length"||!Cp(u)&&u>=l)&&a.push(c)})}else switch(i!==void 0&&a.push(o.get(i)),e){case"add":Ht(t)?x1(i)&&a.push(o.get("length")):(a.push(o.get(wd)),Cm(t)&&a.push(o.get(zx)));break;case"delete":Ht(t)||(a.push(o.get(wd)),Cm(t)&&a.push(o.get(zx)));break;case"set":Cm(t)&&a.push(o.get(wd));break}A1();for(const l of a)l&&Pz(l,2);V1()}function E8(t,e){var i;return(i=N0.get(t))==null?void 0:i.get(e)}const w8=P1("__proto__,__v_isRef,__isVue"),Tz=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Cp)),aL=T8();function T8(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...i){const n=hi(this);for(let s=0,o=this.length;s<o;s++)To(n,"get",s+"");const r=n[e](...i);return r===-1||r===!1?n[e](...i.map(hi)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...i){Yd(),A1();const n=hi(this)[e].apply(this,i);return V1(),Zd(),n}}),t}function x8(t){const e=hi(this);return To(e,"has",t),e.hasOwnProperty(t)}class xz{constructor(e=!1,i=!1){this._isReadonly=e,this._shallow=i}get(e,i,n){const r=this._isReadonly,s=this._shallow;if(i==="__v_isReactive")return!r;if(i==="__v_isReadonly")return r;if(i==="__v_isShallow")return s;if(i==="__v_raw")return n===(r?s?z8:Az:s?Mz:Cz).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=Ht(e);if(!r){if(o&&Bi(aL,i))return Reflect.get(aL,i,n);if(i==="hasOwnProperty")return x8}const a=Reflect.get(e,i,n);return(Cp(i)?Tz.has(i):w8(i))||(r||To(e,"get",i),s)?a:Fi(a)?o&&x1(i)?a:a.value:yn(a)?r?Vp(a):$r(a):a}}class kz extends xz{constructor(e=!1){super(!1,e)}set(e,i,n,r){let s=e[i];if(!this._shallow){const l=Gm(s);if(!R0(n)&&!Gm(n)&&(s=hi(s),n=hi(n)),!Ht(e)&&Fi(s)&&!Fi(n))return l?!1:(s.value=n,!0)}const o=Ht(e)&&x1(i)?Number(i)<e.length:Bi(e,i),a=Reflect.set(e,i,n,r);return e===hi(r)&&(o?Tu(n,s)&&Qc(e,"set",i,n):Qc(e,"add",i,n)),a}deleteProperty(e,i){const n=Bi(e,i);e[i];const r=Reflect.deleteProperty(e,i);return r&&n&&Qc(e,"delete",i,void 0),r}has(e,i){const n=Reflect.has(e,i);return(!Cp(i)||!Tz.has(i))&&To(e,"has",i),n}ownKeys(e){return To(e,"iterate",Ht(e)?"length":wd),Reflect.ownKeys(e)}}class k8 extends xz{constructor(e=!1){super(!0,e)}set(e,i){return!0}deleteProperty(e,i){return!0}}const C8=new kz,M8=new k8,A8=new kz(!0),L1=t=>t,eP=t=>Reflect.getPrototypeOf(t);function MS(t,e,i=!1,n=!1){t=t.__v_raw;const r=hi(t),s=hi(e);i||(Tu(e,s)&&To(r,"get",e),To(r,"get",s));const{has:o}=eP(r),a=n?L1:i?D1:gv;if(o.call(r,e))return a(t.get(e));if(o.call(r,s))return a(t.get(s));t!==r&&t.get(e)}function AS(t,e=!1){const i=this.__v_raw,n=hi(i),r=hi(t);return e||(Tu(t,r)&&To(n,"has",t),To(n,"has",r)),t===r?i.has(t):i.has(t)||i.has(r)}function VS(t,e=!1){return t=t.__v_raw,!e&&To(hi(t),"iterate",wd),Reflect.get(t,"size",t)}function lL(t){t=hi(t);const e=hi(this);return eP(e).has.call(e,t)||(e.add(t),Qc(e,"add",t,t)),this}function cL(t,e){e=hi(e);const i=hi(this),{has:n,get:r}=eP(i);let s=n.call(i,t);s||(t=hi(t),s=n.call(i,t));const o=r.call(i,t);return i.set(t,e),s?Tu(e,o)&&Qc(i,"set",t,e):Qc(i,"add",t,e),this}function hL(t){const e=hi(this),{has:i,get:n}=eP(e);let r=i.call(e,t);r||(t=hi(t),r=i.call(e,t)),n&&n.call(e,t);const s=e.delete(t);return r&&Qc(e,"delete",t,void 0),s}function uL(){const t=hi(this),e=t.size!==0,i=t.clear();return e&&Qc(t,"clear",void 0,void 0),i}function LS(t,e){return function(n,r){const s=this,o=s.__v_raw,a=hi(o),l=e?L1:t?D1:gv;return!t&&To(a,"iterate",wd),o.forEach((c,u)=>n.call(r,l(c),l(u),s))}}function IS(t,e,i){return function(...n){const r=this.__v_raw,s=hi(r),o=Cm(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=r[t](...n),u=i?L1:e?D1:gv;return!e&&To(s,"iterate",l?zx:wd),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function wh(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function V8(){const t={get(s){return MS(this,s)},get size(){return VS(this)},has:AS,add:lL,set:cL,delete:hL,clear:uL,forEach:LS(!1,!1)},e={get(s){return MS(this,s,!1,!0)},get size(){return VS(this)},has:AS,add:lL,set:cL,delete:hL,clear:uL,forEach:LS(!1,!0)},i={get(s){return MS(this,s,!0)},get size(){return VS(this,!0)},has(s){return AS.call(this,s,!0)},add:wh("add"),set:wh("set"),delete:wh("delete"),clear:wh("clear"),forEach:LS(!0,!1)},n={get(s){return MS(this,s,!0,!0)},get size(){return VS(this,!0)},has(s){return AS.call(this,s,!0)},add:wh("add"),set:wh("set"),delete:wh("delete"),clear:wh("clear"),forEach:LS(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=IS(s,!1,!1),i[s]=IS(s,!0,!1),e[s]=IS(s,!1,!0),n[s]=IS(s,!0,!0)}),[t,i,e,n]}const[L8,I8,O8,D8]=V8();function I1(t,e){const i=e?t?D8:O8:t?I8:L8;return(n,r,s)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?n:Reflect.get(Bi(i,r)&&r in n?i:n,r,s)}const N8={get:I1(!1,!1)},R8={get:I1(!1,!0)},F8={get:I1(!0,!1)},Cz=new WeakMap,Mz=new WeakMap,Az=new WeakMap,z8=new WeakMap;function U8(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function B8(t){return t.__v_skip||!Object.isExtensible(t)?0:U8(d8(t))}function $r(t){return Gm(t)?t:O1(t,!1,C8,N8,Cz)}function j8(t){return O1(t,!1,A8,R8,Mz)}function Vp(t){return O1(t,!0,M8,F8,Az)}function O1(t,e,i,n,r){if(!yn(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=r.get(t);if(s)return s;const o=B8(t);if(o===0)return t;const a=new Proxy(t,o===2?n:i);return r.set(t,a),a}function eh(t){return Gm(t)?eh(t.__v_raw):!!(t&&t.__v_isReactive)}function Gm(t){return!!(t&&t.__v_isReadonly)}function R0(t){return!!(t&&t.__v_isShallow)}function Vz(t){return eh(t)||Gm(t)}function hi(t){const e=t&&t.__v_raw;return e?hi(e):t}function tP(t){return D0(t,"__v_skip",!0),t}const gv=t=>yn(t)?$r(t):t,D1=t=>yn(t)?Vp(t):t;class Lz{constructor(e,i,n,r){this._setter=i,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new M1(()=>e(this._value),()=>n0(this,1),()=>this.dep&&Ez(this.dep)),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=n}get value(){const e=hi(this);return(!e._cacheable||e.effect.dirty)&&Tu(e._value,e._value=e.effect.run())&&n0(e,2),Iz(e),e.effect._dirtyLevel>=1&&n0(e,1),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function $8(t,e,i=!1){let n,r;const s=si(t);return s?(n=t,r=Ho):(n=t.get,r=t.set),new Lz(n,r,s||!r,i)}function Iz(t){pu&&Ed&&(t=hi(t),_z(Ed,t.dep||(t.dep=wz(()=>t.dep=void 0,t instanceof Lz?t:void 0))))}function n0(t,e=2,i){t=hi(t);const n=t.dep;n&&Pz(n,e)}function Fi(t){return!!(t&&t.__v_isRef===!0)}function ge(t){return Oz(t,!1)}function _t(t){return Oz(t,!0)}function Oz(t,e){return Fi(t)?t:new W8(t,e)}class W8{constructor(e,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?e:hi(e),this._value=i?e:gv(e)}get value(){return Iz(this),this._value}set value(e){const i=this.__v_isShallow||R0(e)||Gm(e);e=i?e:hi(e),Tu(e,this._rawValue)&&(this._rawValue=e,this._value=i?e:gv(e),n0(this,2))}}function le(t){return Fi(t)?t.value:t}const G8={get:(t,e,i)=>le(Reflect.get(t,e,i)),set:(t,e,i,n)=>{const r=t[e];return Fi(r)&&!Fi(i)?(r.value=i,!0):Reflect.set(t,e,i,n)}};function Dz(t){return eh(t)?t:new Proxy(t,G8)}function iP(t){const e=Ht(t)?new Array(t.length):{};for(const i in t)e[i]=Nz(t,i);return e}class H8{constructor(e,i,n){this._object=e,this._key=i,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return E8(hi(this._object),this._key)}}class q8{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function bt(t,e,i){return Fi(t)?t:si(t)?new q8(t):yn(t)&&arguments.length>1?Nz(t,e,i):ge(t)}function Nz(t,e,i){const n=t[e];return Fi(n)?n:new H8(t,e,i)}/**
* @vue/runtime-core v3.4.15
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function gu(t,e,i,n){let r;try{r=n?t(...n):t()}catch(s){xy(s,e,i)}return r}function Ca(t,e,i,n){if(si(t)){const s=gu(t,e,i,n);return s&&T1(s)&&s.catch(o=>{xy(o,e,i)}),s}const r=[];for(let s=0;s<t.length;s++)r.push(Ca(t[s],e,i,n));return r}function xy(t,e,i,n=!0){const r=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=`https://vuejs.org/error-reference/#runtime-${i}`;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](t,o,a)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){gu(l,null,10,[t,o,a]);return}}K8(t,i,r,n)}function K8(t,e,i,n=!0){console.error(t)}let vv=!1,Ux=!1;const Ss=[];let Ul=0;const Mm=[];let Hh=null,ld=0;const Rz=Promise.resolve();let N1=null;function vn(t){const e=N1||Rz;return t?e.then(this?t.bind(this):t):e}function X8(t){let e=Ul+1,i=Ss.length;for(;e<i;){const n=e+i>>>1,r=Ss[n],s=yv(r);s<t||s===t&&r.pre?e=n+1:i=n}return e}function R1(t){(!Ss.length||!Ss.includes(t,vv&&t.allowRecurse?Ul+1:Ul))&&(t.id==null?Ss.push(t):Ss.splice(X8(t.id),0,t),Fz())}function Fz(){!vv&&!Ux&&(Ux=!0,N1=Rz.then(Uz))}function Y8(t){const e=Ss.indexOf(t);e>Ul&&Ss.splice(e,1)}function Bx(t){Ht(t)?Mm.push(...t):(!Hh||!Hh.includes(t,t.allowRecurse?ld+1:ld))&&Mm.push(t),Fz()}function dL(t,e,i=vv?Ul+1:0){for(;i<Ss.length;i++){const n=Ss[i];if(n&&n.pre){if(t&&n.id!==t.uid)continue;Ss.splice(i,1),i--,n()}}}function zz(t){if(Mm.length){const e=[...new Set(Mm)].sort((i,n)=>yv(i)-yv(n));if(Mm.length=0,Hh){Hh.push(...e);return}for(Hh=e,ld=0;ld<Hh.length;ld++)Hh[ld]();Hh=null,ld=0}}const yv=t=>t.id==null?1/0:t.id,Z8=(t,e)=>{const i=yv(t)-yv(e);if(i===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return i};function Uz(t){Ux=!1,vv=!0,Ss.sort(Z8);const e=Ho;try{for(Ul=0;Ul<Ss.length;Ul++){const i=Ss[Ul];i&&i.active!==!1&&gu(i,null,14)}}finally{Ul=0,Ss.length=0,zz(),vv=!1,N1=null,(Ss.length||Mm.length)&&Uz()}}function J8(t,e,...i){if(t.isUnmounted)return;const n=t.vnode.props||_n;let r=i;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in n){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=n[u]||_n;d&&(r=i.map(f=>Dn(f)?f.trim():f)),h&&(r=i.map(Nx))}let a,l=n[a=t0(e)]||n[a=t0(Ia(e))];!l&&s&&(l=n[a=t0(Mp(e))]),l&&Ca(l,t,6,r);const c=n[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Ca(c,t,6,r)}}function Bz(t,e,i=!1){const n=e.emitsCache,r=n.get(t);if(r!==void 0)return r;const s=t.emits;let o={},a=!1;if(!si(t)){const l=c=>{const u=Bz(c,e,!0);u&&(a=!0,yr(o,u))};!i&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!s&&!a?(yn(t)&&n.set(t,null),null):(Ht(s)?s.forEach(l=>o[l]=null):yr(o,s),yn(t)&&n.set(t,o),o)}function nP(t,e){return!t||!Z_(e)?!1:(e=e.slice(2).replace(/Once$/,""),Bi(t,e[0].toLowerCase()+e.slice(1))||Bi(t,Mp(e))||Bi(t,e))}let gr=null,rP=null;function F0(t){const e=gr;return gr=t,rP=t&&t.type.__scopeId||null,e}function Q8(t){rP=t}function e6(){rP=null}function U(t,e=gr,i){if(!e||t._n)return t;const n=(...r)=>{n._d&&CL(-1);const s=F0(e);let o;try{o=t(...r)}finally{F0(s),n._d&&CL(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function hw(t){const{type:e,vnode:i,proxy:n,withProxy:r,props:s,propsOptions:[o],slots:a,attrs:l,emit:c,render:u,renderCache:h,data:d,setupState:f,ctx:m,inheritAttrs:g}=t;let v,p;const b=F0(t);try{if(i.shapeFlag&4){const P=r||n,E=P;v=il(u.call(E,P,h,s,f,d,m)),p=l}else{const P=e;v=il(P.length>1?P(s,{attrs:l,slots:a,emit:c}):P(s,null)),p=e.props?l:i6(l)}}catch(P){Gg.length=0,xy(P,t,1),v=w(Js)}let _=v;if(p&&g!==!1){const P=Object.keys(p),{shapeFlag:E}=_;P.length&&E&7&&(o&&P.some(E1)&&(p=n6(p,o)),_=sh(_,p))}return i.dirs&&(_=sh(_),_.dirs=_.dirs?_.dirs.concat(i.dirs):i.dirs),i.transition&&(_.transition=i.transition),v=_,F0(b),v}function t6(t,e=!0){let i;for(let n=0;n<t.length;n++){const r=t[n];if(qm(r)){if(r.type!==Js||r.children==="v-if"){if(i)return;i=r}}else return}return i}const i6=t=>{let e;for(const i in t)(i==="class"||i==="style"||Z_(i))&&((e||(e={}))[i]=t[i]);return e},n6=(t,e)=>{const i={};for(const n in t)(!E1(n)||!(n.slice(9)in e))&&(i[n]=t[n]);return i};function r6(t,e,i){const{props:n,children:r,component:s}=t,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(i&&l>=0){if(l&1024)return!0;if(l&16)return n?fL(n,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==n[d]&&!nP(c,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?fL(n,o,c):!0:!!o;return!1}function fL(t,e,i){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let r=0;r<n.length;r++){const s=n[r];if(e[s]!==t[s]&&!nP(i,s))return!0}return!1}function F1({vnode:t,parent:e},i){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=i,e=e.parent;else break}}const z1="components",s6="directives";function ml(t,e){return U1(z1,t,!0,e)||t}const jz=Symbol.for("v-ndc");function Sv(t){return Dn(t)?U1(z1,t,!1)||t:t||jz}function Mo(t){return U1(s6,t)}function U1(t,e,i=!0,n=!1){const r=gr||Wr;if(r){const s=r.type;if(t===z1){const a=n9(s,!1);if(a&&(a===e||a===Ia(e)||a===vh(Ia(e))))return s}const o=mL(r[t]||s[t],e)||mL(r.appContext[t],e);return!o&&n?s:o}}function mL(t,e){return t&&(t[e]||t[Ia(e)]||t[vh(Ia(e))])}const o6=t=>t.__isSuspense;let jx=0;const a6={name:"Suspense",__isSuspense:!0,process(t,e,i,n,r,s,o,a,l,c){if(t==null)l6(e,i,n,r,s,o,a,l,c);else{if(s&&s.deps>0){e.suspense=t.suspense;return}c6(t,e,i,n,r,o,a,l,c)}},hydrate:h6,create:B1,normalize:u6},uw=a6;function bv(t,e){const i=t.props&&t.props[e];si(i)&&i()}function l6(t,e,i,n,r,s,o,a,l){const{p:c,o:{createElement:u}}=l,h=u("div"),d=t.suspense=B1(t,r,n,e,h,i,s,o,a,l);c(null,d.pendingBranch=t.ssContent,h,null,n,d,s,o),d.deps>0?(bv(t,"onPending"),bv(t,"onFallback"),c(null,t.ssFallback,e,i,n,null,s,o),Am(d,t.ssFallback)):d.resolve(!1,!0)}function c6(t,e,i,n,r,s,o,a,{p:l,um:c,o:{createElement:u}}){const h=e.suspense=t.suspense;h.vnode=e,e.el=t.el;const d=e.ssContent,f=e.ssFallback,{activeBranch:m,pendingBranch:g,isInFallback:v,isHydrating:p}=h;if(g)h.pendingBranch=d,Bl(d,g)?(l(g,d,h.hiddenContainer,null,r,h,s,o,a),h.deps<=0?h.resolve():v&&(p||(l(m,f,i,n,r,null,s,o,a),Am(h,f)))):(h.pendingId=jx++,p?(h.isHydrating=!1,h.activeBranch=g):c(g,r,h),h.deps=0,h.effects.length=0,h.hiddenContainer=u("div"),v?(l(null,d,h.hiddenContainer,null,r,h,s,o,a),h.deps<=0?h.resolve():(l(m,f,i,n,r,null,s,o,a),Am(h,f))):m&&Bl(d,m)?(l(m,d,i,n,r,h,s,o,a),h.resolve(!0)):(l(null,d,h.hiddenContainer,null,r,h,s,o,a),h.deps<=0&&h.resolve()));else if(m&&Bl(d,m))l(m,d,i,n,r,h,s,o,a),Am(h,d);else if(bv(e,"onPending"),h.pendingBranch=d,d.shapeFlag&512?h.pendingId=d.component.suspenseId:h.pendingId=jx++,l(null,d,h.hiddenContainer,null,r,h,s,o,a),h.deps<=0)h.resolve();else{const{timeout:b,pendingId:_}=h;b>0?setTimeout(()=>{h.pendingId===_&&h.fallback(f)},b):b===0&&h.fallback(f)}}function B1(t,e,i,n,r,s,o,a,l,c,u=!1){const{p:h,m:d,um:f,n:m,o:{parentNode:g,remove:v}}=c;let p;const b=f6(t);b&&e!=null&&e.pendingBranch&&(p=e.pendingId,e.deps++);const _=t.props?mz(t.props.timeout):void 0,P=s,E={vnode:t,parent:e,parentComponent:i,namespace:o,container:n,hiddenContainer:r,deps:0,pendingId:jx++,timeout:typeof _=="number"?_:-1,activeBranch:null,pendingBranch:null,isInFallback:!u,isHydrating:u,isUnmounted:!1,effects:[],resolve(T=!1,C=!1){const{vnode:M,activeBranch:x,pendingBranch:V,pendingId:N,effects:D,parentComponent:O,container:F}=E;let X=!1;E.isHydrating?E.isHydrating=!1:T||(X=x&&V.transition&&V.transition.mode==="out-in",X&&(x.transition.afterLeave=()=>{N===E.pendingId&&(d(V,F,s===P?m(x):s,0),Bx(D))}),x&&(g(x.el)!==E.hiddenContainer&&(s=m(x)),f(x,O,E,!0)),X||d(V,F,s,0)),Am(E,V),E.pendingBranch=null,E.isInFallback=!1;let Z=E.parent,K=!1;for(;Z;){if(Z.pendingBranch){Z.effects.push(...D),K=!0;break}Z=Z.parent}!K&&!X&&Bx(D),E.effects=[],b&&e&&e.pendingBranch&&p===e.pendingId&&(e.deps--,e.deps===0&&!C&&e.resolve()),bv(M,"onResolve")},fallback(T){if(!E.pendingBranch)return;const{vnode:C,activeBranch:M,parentComponent:x,container:V,namespace:N}=E;bv(C,"onFallback");const D=m(M),O=()=>{E.isInFallback&&(h(null,T,V,D,x,null,N,a,l),Am(E,T))},F=T.transition&&T.transition.mode==="out-in";F&&(M.transition.afterLeave=O),E.isInFallback=!0,f(M,x,null,!0),F||O()},move(T,C,M){E.activeBranch&&d(E.activeBranch,T,C,M),E.container=T},next(){return E.activeBranch&&m(E.activeBranch)},registerDep(T,C){const M=!!E.pendingBranch;M&&E.deps++;const x=T.vnode.el;T.asyncDep.catch(V=>{xy(V,T,0)}).then(V=>{if(T.isUnmounted||E.isUnmounted||E.pendingId!==T.suspenseId)return;T.asyncResolved=!0;const{vnode:N}=T;Zx(T,V,!1),x&&(N.el=x);const D=!x&&T.subTree.el;C(T,N,g(x||T.subTree.el),x?null:m(T.subTree),E,o,l),D&&v(D),F1(T,N.el),M&&--E.deps===0&&E.resolve()})},unmount(T,C){E.isUnmounted=!0,E.activeBranch&&f(E.activeBranch,i,T,C),E.pendingBranch&&f(E.pendingBranch,i,T,C)}};return E}function h6(t,e,i,n,r,s,o,a,l){const c=e.suspense=B1(e,n,i,t.parentNode,document.createElement("div"),null,r,s,o,a,!0),u=l(t,c.pendingBranch=e.ssContent,i,c,s,o);return c.deps===0&&c.resolve(!1,!0),u}function u6(t){const{shapeFlag:e,children:i}=t,n=e&32;t.ssContent=pL(n?i.default:i),t.ssFallback=n?pL(i.fallback):w(Js)}function pL(t){let e;if(si(t)){const i=Hm&&t._c;i&&(t._d=!1,Te()),t=t(),i&&(t._d=!0,e=Pa,rU())}return Ht(t)&&(t=t6(t)),t=il(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(i=>i!==t)),t}function d6(t,e){e&&e.pendingBranch?Ht(t)?e.effects.push(...t):e.effects.push(t):Bx(t)}function Am(t,e){t.activeBranch=e;const{vnode:i,parentComponent:n}=t;let r=e.el;for(;!r&&e.component;)e=e.component.subTree,r=e.el;i.el=r,n&&n.subTree===i&&(n.vnode.el=r,F1(n,r))}function f6(t){var e;return((e=t.props)==null?void 0:e.suspensible)!=null&&t.props.suspensible!==!1}const m6=Symbol.for("v-scx"),p6=()=>xi(m6);function Oa(t,e){return j1(t,null,e)}const OS={};function He(t,e,i){return j1(t,e,i)}function j1(t,e,{immediate:i,deep:n,flush:r,once:s,onTrack:o,onTrigger:a}=_n){if(e&&s){const T=e;e=(...C)=>{T(...C),E()}}const l=Wr,c=T=>n===!0?T:fd(T,n===!1?1:void 0);let u,h=!1,d=!1;if(Fi(t)?(u=()=>t.value,h=R0(t)):eh(t)?(u=()=>c(t),h=!0):Ht(t)?(d=!0,h=t.some(T=>eh(T)||R0(T)),u=()=>t.map(T=>{if(Fi(T))return T.value;if(eh(T))return c(T);if(si(T))return gu(T,l,2)})):si(t)?e?u=()=>gu(t,l,2):u=()=>(f&&f(),Ca(t,l,3,[m])):u=Ho,e&&n){const T=u;u=()=>fd(T())}let f,m=T=>{f=_.onStop=()=>{gu(T,l,4),f=_.onStop=void 0}},g;if(cP)if(m=Ho,e?i&&Ca(e,l,3,[u(),d?[]:void 0,m]):u(),r==="sync"){const T=p6();g=T.__watcherHandles||(T.__watcherHandles=[])}else return Ho;let v=d?new Array(t.length).fill(OS):OS;const p=()=>{if(!(!_.active||!_.dirty))if(e){const T=_.run();(n||h||(d?T.some((C,M)=>Tu(C,v[M])):Tu(T,v)))&&(f&&f(),Ca(e,l,3,[T,v===OS?void 0:d&&v[0]===OS?[]:v,m]),v=T)}else _.run()};p.allowRecurse=!!e;let b;r==="sync"?b=p:r==="post"?b=()=>fo(p,l&&l.suspense):(p.pre=!0,l&&(p.id=l.uid),b=()=>R1(p));const _=new M1(u,Ho,b),P=C1(),E=()=>{_.stop(),P&&w1(P.effects,_)};return e?i?p():v=_.run():r==="post"?fo(_.run.bind(_),l&&l.suspense):_.run(),g&&g.push(E),E}function g6(t,e,i){const n=this.proxy,r=Dn(t)?t.includes(".")?$z(n,t):()=>n[t]:t.bind(n,n);let s;si(e)?s=e:(s=e.handler,i=e);const o=Nd(this),a=j1(r,s.bind(n),i);return o(),a}function $z(t,e){const i=e.split(".");return()=>{let n=t;for(let r=0;r<i.length&&n;r++)n=n[i[r]];return n}}function fd(t,e,i=0,n){if(!yn(t)||t.__v_skip)return t;if(e&&e>0){if(i>=e)return t;i++}if(n=n||new Set,n.has(t))return t;if(n.add(t),Fi(t))fd(t.value,e,i,n);else if(Ht(t))for(let r=0;r<t.length;r++)fd(t[r],e,i,n);else if(uz(t)||Cm(t))t.forEach(r=>{fd(r,e,i,n)});else if(fz(t))for(const r in t)fd(t[r],e,i,n);return t}function fi(t,e){if(gr===null)return t;const i=hP(gr)||gr.proxy,n=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[s,o,a,l=_n]=e[r];s&&(si(s)&&(s={mounted:s,updated:s}),s.deep&&fd(o),n.push({dir:s,instance:i,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function Gu(t,e,i,n){const r=t.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[n];l&&(Yd(),Ca(l,i,8,[t.el,a,t,e]),Zd())}}const qh=Symbol("_leaveCb"),DS=Symbol("_enterCb");function Wz(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ki(()=>{t.isMounted=!0}),an(()=>{t.isUnmounting=!0}),t}const sa=[Function,Array],Gz={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:sa,onEnter:sa,onAfterEnter:sa,onEnterCancelled:sa,onBeforeLeave:sa,onLeave:sa,onAfterLeave:sa,onLeaveCancelled:sa,onBeforeAppear:sa,onAppear:sa,onAfterAppear:sa,onAppearCancelled:sa},v6={name:"BaseTransition",props:Gz,setup(t,{slots:e}){const i=Sh(),n=Wz();let r;return()=>{const s=e.default&&$1(e.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const g of s)if(g.type!==Js){o=g;break}}const a=hi(t),{mode:l}=a;if(n.isLeaving)return dw(o);const c=gL(o);if(!c)return dw(o);const u=_v(c,a,n,i);Pv(c,u);const h=i.subTree,d=h&&gL(h);let f=!1;const{getTransitionKey:m}=c.type;if(m){const g=m();r===void 0?r=g:g!==r&&(r=g,f=!0)}if(d&&d.type!==Js&&(!Bl(c,d)||f)){const g=_v(d,a,n,i);if(Pv(d,g),l==="out-in")return n.isLeaving=!0,g.afterLeave=()=>{n.isLeaving=!1,i.update.active!==!1&&(i.effect.dirty=!0,i.update())},dw(o);l==="in-out"&&c.type!==Js&&(g.delayLeave=(v,p,b)=>{const _=Hz(n,d);_[String(d.key)]=d,v[qh]=()=>{p(),v[qh]=void 0,delete u.delayedLeave},u.delayedLeave=b})}return o}}},y6=v6;function Hz(t,e){const{leavingVNodes:i}=t;let n=i.get(e.type);return n||(n=Object.create(null),i.set(e.type,n)),n}function _v(t,e,i,n){const{appear:r,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:m,onBeforeAppear:g,onAppear:v,onAfterAppear:p,onAppearCancelled:b}=e,_=String(t.key),P=Hz(i,t),E=(M,x)=>{M&&Ca(M,n,9,x)},T=(M,x)=>{const V=x[1];E(M,x),Ht(M)?M.every(N=>N.length<=1)&&V():M.length<=1&&V()},C={mode:s,persisted:o,beforeEnter(M){let x=a;if(!i.isMounted)if(r)x=g||a;else return;M[qh]&&M[qh](!0);const V=P[_];V&&Bl(t,V)&&V.el[qh]&&V.el[qh](),E(x,[M])},enter(M){let x=l,V=c,N=u;if(!i.isMounted)if(r)x=v||l,V=p||c,N=b||u;else return;let D=!1;const O=M[DS]=F=>{D||(D=!0,F?E(N,[M]):E(V,[M]),C.delayedLeave&&C.delayedLeave(),M[DS]=void 0)};x?T(x,[M,O]):O()},leave(M,x){const V=String(t.key);if(M[DS]&&M[DS](!0),i.isUnmounting)return x();E(h,[M]);let N=!1;const D=M[qh]=O=>{N||(N=!0,x(),O?E(m,[M]):E(f,[M]),M[qh]=void 0,P[V]===t&&delete P[V])};P[V]=t,d?T(d,[M,D]):D()},clone(M){return _v(M,e,i,n)}};return C}function dw(t){if(sP(t))return t=sh(t),t.children=null,t}function gL(t){return sP(t)?t.children?t.children[0]:void 0:t}function Pv(t,e){t.shapeFlag&6&&t.component?Pv(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function $1(t,e=!1,i){let n=[],r=0;for(let s=0;s<t.length;s++){let o=t[s];const a=i==null?o.key:String(i)+String(o.key!=null?o.key:s);o.type===mt?(o.patchFlag&128&&r++,n=n.concat($1(o.children,e,a))):(e||o.type!==Js)&&n.push(a!=null?sh(o,{key:a}):o)}if(r>1)for(let s=0;s<n.length;s++)n[s].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function ri(t,e){return si(t)?(()=>yr({name:t.name},e,{setup:t}))():t}const jg=t=>!!t.type.__asyncLoader,sP=t=>t.type.__isKeepAlive;function W1(t,e){qz(t,"a",e)}function G1(t,e){qz(t,"da",e)}function qz(t,e,i=Wr){const n=t.__wdc||(t.__wdc=()=>{let r=i;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(oP(e,n,i),i){let r=i.parent;for(;r&&r.parent;)sP(r.parent.vnode)&&S6(n,e,i,r),r=r.parent}}function S6(t,e,i,n){const r=oP(e,t,n,!0);ky(()=>{w1(n[e],r)},i)}function oP(t,e,i=Wr,n=!1){if(i){const r=i[t]||(i[t]=[]),s=e.__weh||(e.__weh=(...o)=>{if(i.isUnmounted)return;Yd();const a=Nd(i),l=Ca(e,i,t,o);return a(),Zd(),l});return n?r.unshift(s):r.push(s),s}}const yh=t=>(e,i=Wr)=>(!cP||t==="sp")&&oP(t,(...n)=>e(...n),i),to=yh("bm"),ki=yh("m"),b6=yh("bu"),H1=yh("u"),an=yh("bum"),ky=yh("um"),_6=yh("sp"),P6=yh("rtg"),E6=yh("rtc");function w6(t,e=Wr){oP("ec",t,e)}function Zs(t,e,i,n){let r;const s=i&&i[n];if(Ht(t)||Dn(t)){r=new Array(t.length);for(let o=0,a=t.length;o<a;o++)r[o]=e(t[o],o,void 0,s&&s[o])}else if(typeof t=="number"){r=new Array(t);for(let o=0;o<t;o++)r[o]=e(o+1,o,void 0,s&&s[o])}else if(yn(t))if(t[Symbol.iterator])r=Array.from(t,(o,a)=>e(o,a,void 0,s&&s[a]));else{const o=Object.keys(t);r=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];r[a]=e(t[c],c,a,s&&s[a])}}else r=[];return i&&(i[n]=r),r}function T6(t,e){for(let i=0;i<e.length;i++){const n=e[i];if(Ht(n))for(let r=0;r<n.length;r++)t[n[r].name]=n[r].fn;else n&&(t[n.name]=n.key?(...r)=>{const s=n.fn(...r);return s&&(s.key=n.key),s}:n.fn)}return t}function Ma(t,e,i={},n,r){if(gr.isCE||gr.parent&&jg(gr.parent)&&gr.parent.isCE)return e!=="default"&&(i.name=e),w("slot",i,n&&n());let s=t[e];s&&s._c&&(s._d=!1),Te();const o=s&&Kz(s(i)),a=qe(mt,{key:i.key||o&&o.key||`_${e}`},o||(n?n():[]),o&&t._===1?64:-2);return!r&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function Kz(t){return t.some(e=>qm(e)?!(e.type===Js||e.type===mt&&!Kz(e.children)):!0)?t:null}function vL(t,e){const i={};for(const n in t)i[e&&/[A-Z]/.test(n)?`on:${n}`:t0(n)]=t[n];return i}const $x=t=>t?aU(t)?hP(t)||t.proxy:$x(t.parent):null,$g=yr(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>$x(t.parent),$root:t=>$x(t.root),$emit:t=>t.emit,$options:t=>K1(t),$forceUpdate:t=>t.f||(t.f=()=>{t.effect.dirty=!0,R1(t.update)}),$nextTick:t=>t.n||(t.n=vn.bind(t.proxy)),$watch:t=>g6.bind(t)}),fw=(t,e)=>t!==_n&&!t.__isScriptSetup&&Bi(t,e),x6={get({_:t},e){const{ctx:i,setupState:n,data:r,props:s,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return n[e];case 2:return r[e];case 4:return i[e];case 3:return s[e]}else{if(fw(n,e))return o[e]=1,n[e];if(r!==_n&&Bi(r,e))return o[e]=2,r[e];if((c=t.propsOptions[0])&&Bi(c,e))return o[e]=3,s[e];if(i!==_n&&Bi(i,e))return o[e]=4,i[e];Wx&&(o[e]=0)}}const u=$g[e];let h,d;if(u)return e==="$attrs"&&To(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(i!==_n&&Bi(i,e))return o[e]=4,i[e];if(d=l.config.globalProperties,Bi(d,e))return d[e]},set({_:t},e,i){const{data:n,setupState:r,ctx:s}=t;return fw(r,e)?(r[e]=i,!0):n!==_n&&Bi(n,e)?(n[e]=i,!0):Bi(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=i,!0)},has({_:{data:t,setupState:e,accessCache:i,ctx:n,appContext:r,propsOptions:s}},o){let a;return!!i[o]||t!==_n&&Bi(t,o)||fw(e,o)||(a=s[0])&&Bi(a,o)||Bi(n,o)||Bi($g,o)||Bi(r.config.globalProperties,o)},defineProperty(t,e,i){return i.get!=null?t._.accessCache[e]=0:Bi(i,"value")&&this.set(t,e,i.value,null),Reflect.defineProperty(t,e,i)}};function q1(){return k6().attrs}function k6(){const t=Sh();return t.setupContext||(t.setupContext=cU(t))}function yL(t){return Ht(t)?t.reduce((e,i)=>(e[i]=null,e),{}):t}function C6(t){const e=Sh();let i=t();return Yx(),T1(i)&&(i=i.catch(n=>{throw Nd(e),n})),[i,()=>Nd(e)]}let Wx=!0;function M6(t){const e=K1(t),i=t.proxy,n=t.ctx;Wx=!1,e.beforeCreate&&SL(e.beforeCreate,t,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:m,activated:g,deactivated:v,beforeDestroy:p,beforeUnmount:b,destroyed:_,unmounted:P,render:E,renderTracked:T,renderTriggered:C,errorCaptured:M,serverPrefetch:x,expose:V,inheritAttrs:N,components:D,directives:O,filters:F}=e;if(c&&A6(c,n,null),o)for(const K in o){const z=o[K];si(z)&&(n[K]=z.bind(i))}if(r){const K=r.call(i,i);yn(K)&&(t.data=$r(K))}if(Wx=!0,s)for(const K in s){const z=s[K],H=si(z)?z.bind(i,i):si(z.get)?z.get.bind(i,i):Ho,re=!si(z)&&si(z.set)?z.set.bind(i):Ho,ne=W({get:H,set:re});Object.defineProperty(n,K,{enumerable:!0,configurable:!0,get:()=>ne.value,set:B=>ne.value=B})}if(a)for(const K in a)Xz(a[K],n,i,K);if(l){const K=si(l)?l.call(i):l;Reflect.ownKeys(K).forEach(z=>{jn(z,K[z])})}u&&SL(u,t,"c");function Z(K,z){Ht(z)?z.forEach(H=>K(H.bind(i))):z&&K(z.bind(i))}if(Z(to,h),Z(ki,d),Z(b6,f),Z(H1,m),Z(W1,g),Z(G1,v),Z(w6,M),Z(E6,T),Z(P6,C),Z(an,b),Z(ky,P),Z(_6,x),Ht(V))if(V.length){const K=t.exposed||(t.exposed={});V.forEach(z=>{Object.defineProperty(K,z,{get:()=>i[z],set:H=>i[z]=H})})}else t.exposed||(t.exposed={});E&&t.render===Ho&&(t.render=E),N!=null&&(t.inheritAttrs=N),D&&(t.components=D),O&&(t.directives=O)}function A6(t,e,i=Ho){Ht(t)&&(t=Gx(t));for(const n in t){const r=t[n];let s;yn(r)?"default"in r?s=xi(r.from||n,r.default,!0):s=xi(r.from||n):s=xi(r),Fi(s)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[n]=s}}function SL(t,e,i){Ca(Ht(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,i)}function Xz(t,e,i,n){const r=n.includes(".")?$z(i,n):()=>i[n];if(Dn(t)){const s=e[t];si(s)&&He(r,s)}else if(si(t))He(r,t.bind(i));else if(yn(t))if(Ht(t))t.forEach(s=>Xz(s,e,i,n));else{const s=si(t.handler)?t.handler.bind(i):e[t.handler];si(s)&&He(r,s,t)}}function K1(t){const e=t.type,{mixins:i,extends:n}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!i&&!n?l=e:(l={},r.length&&r.forEach(c=>z0(l,c,o,!0)),z0(l,e,o)),yn(e)&&s.set(e,l),l}function z0(t,e,i,n=!1){const{mixins:r,extends:s}=e;s&&z0(t,s,i,!0),r&&r.forEach(o=>z0(t,o,i,!0));for(const o in e)if(!(n&&o==="expose")){const a=V6[o]||i&&i[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const V6={data:bL,props:_L,emits:_L,methods:Vg,computed:Vg,beforeCreate:Fs,created:Fs,beforeMount:Fs,mounted:Fs,beforeUpdate:Fs,updated:Fs,beforeDestroy:Fs,beforeUnmount:Fs,destroyed:Fs,unmounted:Fs,activated:Fs,deactivated:Fs,errorCaptured:Fs,serverPrefetch:Fs,components:Vg,directives:Vg,watch:I6,provide:bL,inject:L6};function bL(t,e){return e?t?function(){return yr(si(t)?t.call(this,this):t,si(e)?e.call(this,this):e)}:e:t}function L6(t,e){return Vg(Gx(t),Gx(e))}function Gx(t){if(Ht(t)){const e={};for(let i=0;i<t.length;i++)e[t[i]]=t[i];return e}return t}function Fs(t,e){return t?[...new Set([].concat(t,e))]:e}function Vg(t,e){return t?yr(Object.create(null),t,e):e}function _L(t,e){return t?Ht(t)&&Ht(e)?[...new Set([...t,...e])]:yr(Object.create(null),yL(t),yL(e??{})):e}function I6(t,e){if(!t)return e;if(!e)return t;const i=yr(Object.create(null),t);for(const n in e)i[n]=Fs(t[n],e[n]);return i}function Yz(){return{app:null,config:{isNativeTag:h8,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let O6=0;function D6(t,e){return function(n,r=null){si(n)||(n=yr({},n)),r!=null&&!yn(r)&&(r=null);const s=Yz(),o=new WeakSet;let a=!1;const l=s.app={_uid:O6++,_component:n,_props:r,_container:null,_context:s,_instance:null,version:s9,get config(){return s.config},set config(c){},use(c,...u){return o.has(c)||(c&&si(c.install)?(o.add(c),c.install(l,...u)):si(c)&&(o.add(c),c(l,...u))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,u){return u?(s.components[c]=u,l):s.components[c]},directive(c,u){return u?(s.directives[c]=u,l):s.directives[c]},mount(c,u,h){if(!a){const d=w(n,r);return d.appContext=s,h===!0?h="svg":h===!1&&(h=void 0),u&&e?e(d,c):t(d,c,h),a=!0,l._container=c,c.__vue_app__=l,hP(d.component)||d.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(c,u){return s.provides[c]=u,l},runWithContext(c){Ev=l;try{return c()}finally{Ev=null}}};return l}}let Ev=null;function jn(t,e){if(Wr){let i=Wr.provides;const n=Wr.parent&&Wr.parent.provides;n===i&&(i=Wr.provides=Object.create(n)),i[t]=e}}function xi(t,e,i=!1){const n=Wr||gr;if(n||Ev){const r=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:Ev._context.provides;if(r&&t in r)return r[t];if(arguments.length>1)return i&&si(e)?e.call(n&&n.proxy):e}}function N6(){return!!(Wr||gr||Ev)}function R6(t,e,i,n=!1){const r={},s={};D0(s,aP,1),t.propsDefaults=Object.create(null),Zz(t,e,r,s);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);i?t.props=n?r:j8(r):t.type.props?t.props=r:t.props=s,t.attrs=s}function F6(t,e,i,n){const{props:r,attrs:s,vnode:{patchFlag:o}}=t,a=hi(r),[l]=t.propsOptions;let c=!1;if((n||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(nP(t.emitsOptions,d))continue;const f=e[d];if(l)if(Bi(s,d))f!==s[d]&&(s[d]=f,c=!0);else{const m=Ia(d);r[m]=Hx(l,a,m,f,t,!1)}else f!==s[d]&&(s[d]=f,c=!0)}}}else{Zz(t,e,r,s)&&(c=!0);let u;for(const h in a)(!e||!Bi(e,h)&&((u=Mp(h))===h||!Bi(e,u)))&&(l?i&&(i[h]!==void 0||i[u]!==void 0)&&(r[h]=Hx(l,a,h,void 0,t,!0)):delete r[h]);if(s!==a)for(const h in s)(!e||!Bi(e,h))&&(delete s[h],c=!0)}c&&Qc(t,"set","$attrs")}function Zz(t,e,i,n){const[r,s]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(e0(l))continue;const c=e[l];let u;r&&Bi(r,u=Ia(l))?!s||!s.includes(u)?i[u]=c:(a||(a={}))[u]=c:nP(t.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,o=!0)}if(s){const l=hi(i),c=a||_n;for(let u=0;u<s.length;u++){const h=s[u];i[h]=Hx(r,l,h,c[h],t,!Bi(c,h))}}return o}function Hx(t,e,i,n,r,s){const o=t[i];if(o!=null){const a=Bi(o,"default");if(a&&n===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&si(l)){const{propsDefaults:c}=r;if(i in c)n=c[i];else{const u=Nd(r);n=c[i]=l.call(null,e),u()}}else n=l}o[0]&&(s&&!a?n=!1:o[1]&&(n===""||n===Mp(i))&&(n=!0))}return n}function Jz(t,e,i=!1){const n=e.propsCache,r=n.get(t);if(r)return r;const s=t.props,o={},a=[];let l=!1;if(!si(t)){const u=h=>{l=!0;const[d,f]=Jz(h,e,!0);yr(o,d),f&&a.push(...f)};!i&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!s&&!l)return yn(t)&&n.set(t,km),km;if(Ht(s))for(let u=0;u<s.length;u++){const h=Ia(s[u]);PL(h)&&(o[h]=_n)}else if(s)for(const u in s){const h=Ia(u);if(PL(h)){const d=s[u],f=o[h]=Ht(d)||si(d)?{type:d}:yr({},d);if(f){const m=TL(Boolean,f.type),g=TL(String,f.type);f[0]=m>-1,f[1]=g<0||m<g,(m>-1||Bi(f,"default"))&&a.push(h)}}}const c=[o,a];return yn(t)&&n.set(t,c),c}function PL(t){return t[0]!=="$"}function EL(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function wL(t,e){return EL(t)===EL(e)}function TL(t,e){return Ht(e)?e.findIndex(i=>wL(i,t)):si(e)&&wL(e,t)?0:-1}const Qz=t=>t[0]==="_"||t==="$stable",X1=t=>Ht(t)?t.map(il):[il(t)],z6=(t,e,i)=>{if(e._n)return e;const n=U((...r)=>X1(e(...r)),i);return n._c=!1,n},eU=(t,e,i)=>{const n=t._ctx;for(const r in t){if(Qz(r))continue;const s=t[r];if(si(s))e[r]=z6(r,s,n);else if(s!=null){const o=X1(s);e[r]=()=>o}}},tU=(t,e)=>{const i=X1(e);t.slots.default=()=>i},U6=(t,e)=>{if(t.vnode.shapeFlag&32){const i=e._;i?(t.slots=hi(e),D0(e,"_",i)):eU(e,t.slots={})}else t.slots={},e&&tU(t,e);D0(t.slots,aP,1)},B6=(t,e,i)=>{const{vnode:n,slots:r}=t;let s=!0,o=_n;if(n.shapeFlag&32){const a=e._;a?i&&a===1?s=!1:(yr(r,e),!i&&a===1&&delete r._):(s=!e.$stable,eU(e,r)),o=e}else e&&(tU(t,e),o={default:1});if(s)for(const a in r)!Qz(a)&&o[a]==null&&delete r[a]};function qx(t,e,i,n,r=!1){if(Ht(t)){t.forEach((d,f)=>qx(d,e&&(Ht(e)?e[f]:e),i,n,r));return}if(jg(n)&&!r)return;const s=n.shapeFlag&4?hP(n.component)||n.component.proxy:n.el,o=r?null:s,{i:a,r:l}=t,c=e&&e.r,u=a.refs===_n?a.refs={}:a.refs,h=a.setupState;if(c!=null&&c!==l&&(Dn(c)?(u[c]=null,Bi(h,c)&&(h[c]=null)):Fi(c)&&(c.value=null)),si(l))gu(l,a,12,[o,u]);else{const d=Dn(l),f=Fi(l),m=t.f;if(d||f){const g=()=>{if(m){const v=d?Bi(h,l)?h[l]:u[l]:l.value;r?Ht(v)&&w1(v,s):Ht(v)?v.includes(s)||v.push(s):d?(u[l]=[s],Bi(h,l)&&(h[l]=u[l])):(l.value=[s],t.k&&(u[t.k]=l.value))}else d?(u[l]=o,Bi(h,l)&&(h[l]=o)):f&&(l.value=o,t.k&&(u[t.k]=o))};r||m?g():(g.id=-1,fo(g,i))}}}const fo=d6;function j6(t){return $6(t)}function $6(t,e){const i=pz();i.__VUE__=!0;const{insert:n,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=Ho,insertStaticContent:m}=t,g=(A,I,G,ue=null,Se=null,Ee=null,Oe=void 0,ye=null,Pe=!!I.dynamicChildren)=>{if(A===I)return;A&&!Bl(A,I)&&(ue=ee(A),B(A,Se,Ee,!0),A=null),I.patchFlag===-2&&(Pe=!1,I.dynamicChildren=null);const{type:we,ref:j,shapeFlag:R}=I;switch(we){case Lp:v(A,I,G,ue);break;case Js:p(A,I,G,ue);break;case pw:A==null&&b(I,G,ue,Oe);break;case mt:D(A,I,G,ue,Se,Ee,Oe,ye,Pe);break;default:R&1?E(A,I,G,ue,Se,Ee,Oe,ye,Pe):R&6?O(A,I,G,ue,Se,Ee,Oe,ye,Pe):(R&64||R&128)&&we.process(A,I,G,ue,Se,Ee,Oe,ye,Pe,te)}j!=null&&Se&&qx(j,A&&A.ref,Ee,I||A,!I)},v=(A,I,G,ue)=>{if(A==null)n(I.el=a(I.children),G,ue);else{const Se=I.el=A.el;I.children!==A.children&&c(Se,I.children)}},p=(A,I,G,ue)=>{A==null?n(I.el=l(I.children||""),G,ue):I.el=A.el},b=(A,I,G,ue)=>{[A.el,A.anchor]=m(A.children,I,G,ue,A.el,A.anchor)},_=({el:A,anchor:I},G,ue)=>{let Se;for(;A&&A!==I;)Se=d(A),n(A,G,ue),A=Se;n(I,G,ue)},P=({el:A,anchor:I})=>{let G;for(;A&&A!==I;)G=d(A),r(A),A=G;r(I)},E=(A,I,G,ue,Se,Ee,Oe,ye,Pe)=>{I.type==="svg"?Oe="svg":I.type==="math"&&(Oe="mathml"),A==null?T(I,G,ue,Se,Ee,Oe,ye,Pe):x(A,I,Se,Ee,Oe,ye,Pe)},T=(A,I,G,ue,Se,Ee,Oe,ye)=>{let Pe,we;const{props:j,shapeFlag:R,transition:J,dirs:ve}=A;if(Pe=A.el=o(A.type,Ee,j&&j.is,j),R&8?u(Pe,A.children):R&16&&M(A.children,Pe,null,ue,Se,mw(A,Ee),Oe,ye),ve&&Gu(A,null,ue,"created"),C(Pe,A,A.scopeId,Oe,ue),j){for(const me in j)me!=="value"&&!e0(me)&&s(Pe,me,null,j[me],Ee,A.children,ue,Se,se);"value"in j&&s(Pe,"value",null,j.value,Ee),(we=j.onVnodeBeforeMount)&&Cl(we,ue,A)}ve&&Gu(A,null,ue,"beforeMount");const xe=W6(Se,J);xe&&J.beforeEnter(Pe),n(Pe,I,G),((we=j&&j.onVnodeMounted)||xe||ve)&&fo(()=>{we&&Cl(we,ue,A),xe&&J.enter(Pe),ve&&Gu(A,null,ue,"mounted")},Se)},C=(A,I,G,ue,Se)=>{if(G&&f(A,G),ue)for(let Ee=0;Ee<ue.length;Ee++)f(A,ue[Ee]);if(Se){let Ee=Se.subTree;if(I===Ee){const Oe=Se.vnode;C(A,Oe,Oe.scopeId,Oe.slotScopeIds,Se.parent)}}},M=(A,I,G,ue,Se,Ee,Oe,ye,Pe=0)=>{for(let we=Pe;we<A.length;we++){const j=A[we]=ye?Kh(A[we]):il(A[we]);g(null,j,I,G,ue,Se,Ee,Oe,ye)}},x=(A,I,G,ue,Se,Ee,Oe)=>{const ye=I.el=A.el;let{patchFlag:Pe,dynamicChildren:we,dirs:j}=I;Pe|=A.patchFlag&16;const R=A.props||_n,J=I.props||_n;let ve;if(G&&Hu(G,!1),(ve=J.onVnodeBeforeUpdate)&&Cl(ve,G,I,A),j&&Gu(I,A,G,"beforeUpdate"),G&&Hu(G,!0),we?V(A.dynamicChildren,we,ye,G,ue,mw(I,Se),Ee):Oe||z(A,I,ye,null,G,ue,mw(I,Se),Ee,!1),Pe>0){if(Pe&16)N(ye,I,R,J,G,ue,Se);else if(Pe&2&&R.class!==J.class&&s(ye,"class",null,J.class,Se),Pe&4&&s(ye,"style",R.style,J.style,Se),Pe&8){const xe=I.dynamicProps;for(let me=0;me<xe.length;me++){const Ne=xe[me],ze=R[Ne],ke=J[Ne];(ke!==ze||Ne==="value")&&s(ye,Ne,ze,ke,Se,A.children,G,ue,se)}}Pe&1&&A.children!==I.children&&u(ye,I.children)}else!Oe&&we==null&&N(ye,I,R,J,G,ue,Se);((ve=J.onVnodeUpdated)||j)&&fo(()=>{ve&&Cl(ve,G,I,A),j&&Gu(I,A,G,"updated")},ue)},V=(A,I,G,ue,Se,Ee,Oe)=>{for(let ye=0;ye<I.length;ye++){const Pe=A[ye],we=I[ye],j=Pe.el&&(Pe.type===mt||!Bl(Pe,we)||Pe.shapeFlag&70)?h(Pe.el):G;g(Pe,we,j,null,ue,Se,Ee,Oe,!0)}},N=(A,I,G,ue,Se,Ee,Oe)=>{if(G!==ue){if(G!==_n)for(const ye in G)!e0(ye)&&!(ye in ue)&&s(A,ye,G[ye],null,Oe,I.children,Se,Ee,se);for(const ye in ue){if(e0(ye))continue;const Pe=ue[ye],we=G[ye];Pe!==we&&ye!=="value"&&s(A,ye,we,Pe,Oe,I.children,Se,Ee,se)}"value"in ue&&s(A,"value",G.value,ue.value,Oe)}},D=(A,I,G,ue,Se,Ee,Oe,ye,Pe)=>{const we=I.el=A?A.el:a(""),j=I.anchor=A?A.anchor:a("");let{patchFlag:R,dynamicChildren:J,slotScopeIds:ve}=I;ve&&(ye=ye?ye.concat(ve):ve),A==null?(n(we,G,ue),n(j,G,ue),M(I.children||[],G,j,Se,Ee,Oe,ye,Pe)):R>0&&R&64&&J&&A.dynamicChildren?(V(A.dynamicChildren,J,G,Se,Ee,Oe,ye),(I.key!=null||Se&&I===Se.subTree)&&Y1(A,I,!0)):z(A,I,G,j,Se,Ee,Oe,ye,Pe)},O=(A,I,G,ue,Se,Ee,Oe,ye,Pe)=>{I.slotScopeIds=ye,A==null?I.shapeFlag&512?Se.ctx.activate(I,G,ue,Oe,Pe):F(I,G,ue,Se,Ee,Oe,Pe):X(A,I,Pe)},F=(A,I,G,ue,Se,Ee,Oe)=>{const ye=A.component=Q6(A,ue,Se);if(sP(A)&&(ye.ctx.renderer=te),e9(ye),ye.asyncDep){if(Se&&Se.registerDep(ye,Z),!A.el){const Pe=ye.subTree=w(Js);p(null,Pe,I,G)}}else Z(ye,A,I,G,Se,Ee,Oe)},X=(A,I,G)=>{const ue=I.component=A.component;if(r6(A,I,G))if(ue.asyncDep&&!ue.asyncResolved){K(ue,I,G);return}else ue.next=I,Y8(ue.update),ue.effect.dirty=!0,ue.update();else I.el=A.el,ue.vnode=I},Z=(A,I,G,ue,Se,Ee,Oe)=>{const ye=()=>{if(A.isMounted){let{next:j,bu:R,u:J,parent:ve,vnode:xe}=A;{const pt=iU(A);if(pt){j&&(j.el=xe.el,K(A,j,Oe)),pt.asyncDep.then(()=>{A.isUnmounted||ye()});return}}let me=j,Ne;Hu(A,!1),j?(j.el=xe.el,K(A,j,Oe)):j=xe,R&&i0(R),(Ne=j.props&&j.props.onVnodeBeforeUpdate)&&Cl(Ne,ve,j,xe),Hu(A,!0);const ze=hw(A),ke=A.subTree;A.subTree=ze,g(ke,ze,h(ke.el),ee(ke),A,Se,Ee),j.el=ze.el,me===null&&F1(A,ze.el),J&&fo(J,Se),(Ne=j.props&&j.props.onVnodeUpdated)&&fo(()=>Cl(Ne,ve,j,xe),Se)}else{let j;const{el:R,props:J}=I,{bm:ve,m:xe,parent:me}=A,Ne=jg(I);if(Hu(A,!1),ve&&i0(ve),!Ne&&(j=J&&J.onVnodeBeforeMount)&&Cl(j,me,I),Hu(A,!0),R&&ae){const ze=()=>{A.subTree=hw(A),ae(R,A.subTree,A,Se,null)};Ne?I.type.__asyncLoader().then(()=>!A.isUnmounted&&ze()):ze()}else{const ze=A.subTree=hw(A);g(null,ze,G,ue,A,Se,Ee),I.el=ze.el}if(xe&&fo(xe,Se),!Ne&&(j=J&&J.onVnodeMounted)){const ze=I;fo(()=>Cl(j,me,ze),Se)}(I.shapeFlag&256||me&&jg(me.vnode)&&me.vnode.shapeFlag&256)&&A.a&&fo(A.a,Se),A.isMounted=!0,I=G=ue=null}},Pe=A.effect=new M1(ye,Ho,()=>R1(we),A.scope),we=A.update=()=>{Pe.dirty&&Pe.run()};we.id=A.uid,Hu(A,!0),we()},K=(A,I,G)=>{I.component=A;const ue=A.vnode.props;A.vnode=I,A.next=null,F6(A,I.props,ue,G),B6(A,I.children,G),Yd(),dL(A),Zd()},z=(A,I,G,ue,Se,Ee,Oe,ye,Pe=!1)=>{const we=A&&A.children,j=A?A.shapeFlag:0,R=I.children,{patchFlag:J,shapeFlag:ve}=I;if(J>0){if(J&128){re(we,R,G,ue,Se,Ee,Oe,ye,Pe);return}else if(J&256){H(we,R,G,ue,Se,Ee,Oe,ye,Pe);return}}ve&8?(j&16&&se(we,Se,Ee),R!==we&&u(G,R)):j&16?ve&16?re(we,R,G,ue,Se,Ee,Oe,ye,Pe):se(we,Se,Ee,!0):(j&8&&u(G,""),ve&16&&M(R,G,ue,Se,Ee,Oe,ye,Pe))},H=(A,I,G,ue,Se,Ee,Oe,ye,Pe)=>{A=A||km,I=I||km;const we=A.length,j=I.length,R=Math.min(we,j);let J;for(J=0;J<R;J++){const ve=I[J]=Pe?Kh(I[J]):il(I[J]);g(A[J],ve,G,null,Se,Ee,Oe,ye,Pe)}we>j?se(A,Se,Ee,!0,!1,R):M(I,G,ue,Se,Ee,Oe,ye,Pe,R)},re=(A,I,G,ue,Se,Ee,Oe,ye,Pe)=>{let we=0;const j=I.length;let R=A.length-1,J=j-1;for(;we<=R&&we<=J;){const ve=A[we],xe=I[we]=Pe?Kh(I[we]):il(I[we]);if(Bl(ve,xe))g(ve,xe,G,null,Se,Ee,Oe,ye,Pe);else break;we++}for(;we<=R&&we<=J;){const ve=A[R],xe=I[J]=Pe?Kh(I[J]):il(I[J]);if(Bl(ve,xe))g(ve,xe,G,null,Se,Ee,Oe,ye,Pe);else break;R--,J--}if(we>R){if(we<=J){const ve=J+1,xe=ve<j?I[ve].el:ue;for(;we<=J;)g(null,I[we]=Pe?Kh(I[we]):il(I[we]),G,xe,Se,Ee,Oe,ye,Pe),we++}}else if(we>J)for(;we<=R;)B(A[we],Se,Ee,!0),we++;else{const ve=we,xe=we,me=new Map;for(we=xe;we<=J;we++){const Ge=I[we]=Pe?Kh(I[we]):il(I[we]);Ge.key!=null&&me.set(Ge.key,we)}let Ne,ze=0;const ke=J-xe+1;let pt=!1,Ue=0;const Ye=new Array(ke);for(we=0;we<ke;we++)Ye[we]=0;for(we=ve;we<=R;we++){const Ge=A[we];if(ze>=ke){B(Ge,Se,Ee,!0);continue}let St;if(Ge.key!=null)St=me.get(Ge.key);else for(Ne=xe;Ne<=J;Ne++)if(Ye[Ne-xe]===0&&Bl(Ge,I[Ne])){St=Ne;break}St===void 0?B(Ge,Se,Ee,!0):(Ye[St-xe]=we+1,St>=Ue?Ue=St:pt=!0,g(Ge,I[St],G,null,Se,Ee,Oe,ye,Pe),ze++)}const Je=pt?G6(Ye):km;for(Ne=Je.length-1,we=ke-1;we>=0;we--){const Ge=xe+we,St=I[Ge],Ft=Ge+1<j?I[Ge+1].el:ue;Ye[we]===0?g(null,St,G,Ft,Se,Ee,Oe,ye,Pe):pt&&(Ne<0||we!==Je[Ne]?ne(St,G,Ft,2):Ne--)}}},ne=(A,I,G,ue,Se=null)=>{const{el:Ee,type:Oe,transition:ye,children:Pe,shapeFlag:we}=A;if(we&6){ne(A.component.subTree,I,G,ue);return}if(we&128){A.suspense.move(I,G,ue);return}if(we&64){Oe.move(A,I,G,te);return}if(Oe===mt){n(Ee,I,G);for(let R=0;R<Pe.length;R++)ne(Pe[R],I,G,ue);n(A.anchor,I,G);return}if(Oe===pw){_(A,I,G);return}if(ue!==2&&we&1&&ye)if(ue===0)ye.beforeEnter(Ee),n(Ee,I,G),fo(()=>ye.enter(Ee),Se);else{const{leave:R,delayLeave:J,afterLeave:ve}=ye,xe=()=>n(Ee,I,G),me=()=>{R(Ee,()=>{xe(),ve&&ve()})};J?J(Ee,xe,me):me()}else n(Ee,I,G)},B=(A,I,G,ue=!1,Se=!1)=>{const{type:Ee,props:Oe,ref:ye,children:Pe,dynamicChildren:we,shapeFlag:j,patchFlag:R,dirs:J}=A;if(ye!=null&&qx(ye,null,G,A,!0),j&256){I.ctx.deactivate(A);return}const ve=j&1&&J,xe=!jg(A);let me;if(xe&&(me=Oe&&Oe.onVnodeBeforeUnmount)&&Cl(me,I,A),j&6)ie(A.component,G,ue);else{if(j&128){A.suspense.unmount(G,ue);return}ve&&Gu(A,null,I,"beforeUnmount"),j&64?A.type.remove(A,I,G,Se,te,ue):we&&(Ee!==mt||R>0&&R&64)?se(we,I,G,!1,!0):(Ee===mt&&R&384||!Se&&j&16)&&se(Pe,I,G),ue&&Q(A)}(xe&&(me=Oe&&Oe.onVnodeUnmounted)||ve)&&fo(()=>{me&&Cl(me,I,A),ve&&Gu(A,null,I,"unmounted")},G)},Q=A=>{const{type:I,el:G,anchor:ue,transition:Se}=A;if(I===mt){fe(G,ue);return}if(I===pw){P(A);return}const Ee=()=>{r(G),Se&&!Se.persisted&&Se.afterLeave&&Se.afterLeave()};if(A.shapeFlag&1&&Se&&!Se.persisted){const{leave:Oe,delayLeave:ye}=Se,Pe=()=>Oe(G,Ee);ye?ye(A.el,Ee,Pe):Pe()}else Ee()},fe=(A,I)=>{let G;for(;A!==I;)G=d(A),r(A),A=G;r(I)},ie=(A,I,G)=>{const{bum:ue,scope:Se,update:Ee,subTree:Oe,um:ye}=A;ue&&i0(ue),Se.stop(),Ee&&(Ee.active=!1,B(Oe,A,I,G)),ye&&fo(ye,I),fo(()=>{A.isUnmounted=!0},I),I&&I.pendingBranch&&!I.isUnmounted&&A.asyncDep&&!A.asyncResolved&&A.suspenseId===I.pendingId&&(I.deps--,I.deps===0&&I.resolve())},se=(A,I,G,ue=!1,Se=!1,Ee=0)=>{for(let Oe=Ee;Oe<A.length;Oe++)B(A[Oe],I,G,ue,Se)},ee=A=>A.shapeFlag&6?ee(A.component.subTree):A.shapeFlag&128?A.suspense.next():d(A.anchor||A.el);let de=!1;const Y=(A,I,G)=>{A==null?I._vnode&&B(I._vnode,null,null,!0):g(I._vnode||null,A,I,null,null,null,G),de||(de=!0,dL(),zz(),de=!1),I._vnode=A},te={p:g,um:B,m:ne,r:Q,mt:F,mc:M,pc:z,pbc:V,n:ee,o:t};let he,ae;return e&&([he,ae]=e(te)),{render:Y,hydrate:he,createApp:D6(Y,he)}}function mw({type:t,props:e},i){return i==="svg"&&t==="foreignObject"||i==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:i}function Hu({effect:t,update:e},i){t.allowRecurse=e.allowRecurse=i}function W6(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Y1(t,e,i=!1){const n=t.children,r=e.children;if(Ht(n)&&Ht(r))for(let s=0;s<n.length;s++){const o=n[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=Kh(r[s]),a.el=o.el),i||Y1(o,a)),a.type===Lp&&(a.el=o.el)}}function G6(t){const e=t.slice(),i=[0];let n,r,s,o,a;const l=t.length;for(n=0;n<l;n++){const c=t[n];if(c!==0){if(r=i[i.length-1],t[r]<c){e[n]=r,i.push(n);continue}for(s=0,o=i.length-1;s<o;)a=s+o>>1,t[i[a]]<c?s=a+1:o=a;c<t[i[s]]&&(s>0&&(e[n]=i[s-1]),i[s]=n)}}for(s=i.length,o=i[s-1];s-- >0;)i[s]=o,o=e[o];return i}function iU(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:iU(e)}const H6=t=>t.__isTeleport,Wg=t=>t&&(t.disabled||t.disabled===""),xL=t=>typeof SVGElement<"u"&&t instanceof SVGElement,kL=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,Kx=(t,e)=>{const i=t&&t.to;return Dn(i)?e?e(i):null:i},q6={name:"Teleport",__isTeleport:!0,process(t,e,i,n,r,s,o,a,l,c){const{mc:u,pc:h,pbc:d,o:{insert:f,querySelector:m,createText:g,createComment:v}}=c,p=Wg(e.props);let{shapeFlag:b,children:_,dynamicChildren:P}=e;if(t==null){const E=e.el=g(""),T=e.anchor=g("");f(E,i,n),f(T,i,n);const C=e.target=Kx(e.props,m),M=e.targetAnchor=g("");C&&(f(M,C),o==="svg"||xL(C)?o="svg":(o==="mathml"||kL(C))&&(o="mathml"));const x=(V,N)=>{b&16&&u(_,V,N,r,s,o,a,l)};p?x(i,T):C&&x(C,M)}else{e.el=t.el;const E=e.anchor=t.anchor,T=e.target=t.target,C=e.targetAnchor=t.targetAnchor,M=Wg(t.props),x=M?i:T,V=M?E:C;if(o==="svg"||xL(T)?o="svg":(o==="mathml"||kL(T))&&(o="mathml"),P?(d(t.dynamicChildren,P,x,r,s,o,a),Y1(t,e,!0)):l||h(t,e,x,V,r,s,o,a,!1),p)M?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):NS(e,i,E,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const N=e.target=Kx(e.props,m);N&&NS(e,N,null,c,0)}else M&&NS(e,T,C,c,1)}nU(e)},remove(t,e,i,n,{um:r,o:{remove:s}},o){const{shapeFlag:a,children:l,anchor:c,targetAnchor:u,target:h,props:d}=t;if(h&&s(u),o&&s(c),a&16){const f=o||!Wg(d);for(let m=0;m<l.length;m++){const g=l[m];r(g,e,i,f,!!g.dynamicChildren)}}},move:NS,hydrate:K6};function NS(t,e,i,{o:{insert:n},m:r},s=2){s===0&&n(t.targetAnchor,e,i);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=t,h=s===2;if(h&&n(o,e,i),(!h||Wg(u))&&l&16)for(let d=0;d<c.length;d++)r(c[d],e,i,2);h&&n(a,e,i)}function K6(t,e,i,n,r,s,{o:{nextSibling:o,parentNode:a,querySelector:l}},c){const u=e.target=Kx(e.props,l);if(u){const h=u._lpa||u.firstChild;if(e.shapeFlag&16)if(Wg(e.props))e.anchor=c(o(t),e,a(t),i,n,r,s),e.targetAnchor=h;else{e.anchor=o(t);let d=h;for(;d;)if(d=o(d),d&&d.nodeType===8&&d.data==="teleport anchor"){e.targetAnchor=d,u._lpa=e.targetAnchor&&o(e.targetAnchor);break}c(h,e,u,i,n,r,s)}nU(e)}return e.anchor&&o(e.anchor)}const X6=q6;function nU(t){const e=t.ctx;if(e&&e.ut){let i=t.children[0].el;for(;i&&i!==t.targetAnchor;)i.nodeType===1&&i.setAttribute("data-v-owner",e.uid),i=i.nextSibling;e.ut()}}const mt=Symbol.for("v-fgt"),Lp=Symbol.for("v-txt"),Js=Symbol.for("v-cmt"),pw=Symbol.for("v-stc"),Gg=[];let Pa=null;function Te(t=!1){Gg.push(Pa=t?null:[])}function rU(){Gg.pop(),Pa=Gg[Gg.length-1]||null}let Hm=1;function CL(t){Hm+=t}function sU(t){return t.dynamicChildren=Hm>0?Pa||km:null,rU(),Hm>0&&Pa&&Pa.push(t),t}function Ct(t,e,i,n,r,s){return sU(tt(t,e,i,n,r,s,!0))}function qe(t,e,i,n,r){return sU(w(t,e,i,n,r,!0))}function qm(t){return t?t.__v_isVNode===!0:!1}function Bl(t,e){return t.type===e.type&&t.key===e.key}const aP="__vInternal",oU=({key:t})=>t??null,r0=({ref:t,ref_key:e,ref_for:i})=>(typeof t=="number"&&(t=""+t),t!=null?Dn(t)||Fi(t)||si(t)?{i:gr,r:t,k:e,f:!!i}:t:null);function tt(t,e=null,i=null,n=0,r=null,s=t===mt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&oU(e),ref:e&&r0(e),scopeId:rP,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:gr};return a?(Z1(l,i),s&128&&t.normalize(l)):i&&(l.shapeFlag|=Dn(i)?8:16),Hm>0&&!o&&Pa&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Pa.push(l),l}const w=Y6;function Y6(t,e=null,i=null,n=0,r=null,s=!1){if((!t||t===jz)&&(t=Js),qm(t)){const a=sh(t,e,!0);return i&&Z1(a,i),Hm>0&&!s&&Pa&&(a.shapeFlag&6?Pa[Pa.indexOf(t)]=a:Pa.push(a)),a.patchFlag|=-2,a}if(r9(t)&&(t=t.__vccOpts),e){e=lP(e);let{class:a,style:l}=e;a&&!Dn(a)&&(e.class=Gs(a)),yn(l)&&(Vz(l)&&!Ht(l)&&(l=yr({},l)),e.style=mr(l))}const o=Dn(t)?1:o6(t)?128:H6(t)?64:yn(t)?4:si(t)?2:0;return tt(t,e,i,n,r,o,s,!0)}function lP(t){return t?Vz(t)||aP in t?yr({},t):t:null}function sh(t,e,i=!1){const{props:n,ref:r,patchFlag:s,children:o}=t,a=e?ht(n||{},e):n;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&oU(a),ref:e&&e.ref?i&&r?Ht(r)?r.concat(r0(e)):[r,r0(e)]:r0(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==mt?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&sh(t.ssContent),ssFallback:t.ssFallback&&sh(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function $e(t=" ",e=0){return w(Lp,null,t,e)}function Vi(t="",e=!1){return e?(Te(),qe(Js,null,t)):w(Js,null,t)}function il(t){return t==null||typeof t=="boolean"?w(Js):Ht(t)?w(mt,null,t.slice()):typeof t=="object"?Kh(t):w(Lp,null,String(t))}function Kh(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:sh(t)}function Z1(t,e){let i=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(Ht(e))i=16;else if(typeof e=="object")if(n&65){const r=e.default;r&&(r._c&&(r._d=!1),Z1(t,r()),r._c&&(r._d=!0));return}else{i=32;const r=e._;!r&&!(aP in e)?e._ctx=gr:r===3&&gr&&(gr.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else si(e)?(e={default:e,_ctx:gr},i=32):(e=String(e),n&64?(i=16,e=[$e(e)]):i=8);t.children=e,t.shapeFlag|=i}function ht(...t){const e={};for(let i=0;i<t.length;i++){const n=t[i];for(const r in n)if(r==="class")e.class!==n.class&&(e.class=Gs([e.class,n.class]));else if(r==="style")e.style=mr([e.style,n.style]);else if(Z_(r)){const s=e[r],o=n[r];o&&s!==o&&!(Ht(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=n[r])}return e}function Cl(t,e,i,n=null){Ca(t,e,7,[i,n])}const Z6=Yz();let J6=0;function Q6(t,e,i){const n=t.type,r=(e?e.appContext:t.appContext)||Z6,s={uid:J6++,vnode:t,type:n,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new yz(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Jz(n,r),emitsOptions:Bz(n,r),emit:null,emitted:null,propsDefaults:_n,inheritAttrs:n.inheritAttrs,ctx:_n,data:_n,props:_n,attrs:_n,slots:_n,refs:_n,setupState:_n,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=J8.bind(null,s),t.ce&&t.ce(s),s}let Wr=null;const Sh=()=>Wr||gr;let U0,Xx;{const t=pz(),e=(i,n)=>{let r;return(r=t[i])||(r=t[i]=[]),r.push(n),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};U0=e("__VUE_INSTANCE_SETTERS__",i=>Wr=i),Xx=e("__VUE_SSR_SETTERS__",i=>cP=i)}const Nd=t=>{const e=Wr;return U0(t),t.scope.on(),()=>{t.scope.off(),U0(e)}},Yx=()=>{Wr&&Wr.scope.off(),U0(null)};function aU(t){return t.vnode.shapeFlag&4}let cP=!1;function e9(t,e=!1){e&&Xx(e);const{props:i,children:n}=t.vnode,r=aU(t);R6(t,i,r,e),U6(t,n);const s=r?t9(t,e):void 0;return e&&Xx(!1),s}function t9(t,e){const i=t.type;t.accessCache=Object.create(null),t.proxy=tP(new Proxy(t.ctx,x6));const{setup:n}=i;if(n){const r=t.setupContext=n.length>1?cU(t):null,s=Nd(t);Yd();const o=gu(n,t,0,[t.props,r]);if(Zd(),s(),T1(o)){if(o.then(Yx,Yx),e)return o.then(a=>{Zx(t,a,e)}).catch(a=>{xy(a,t,0)});t.asyncDep=o}else Zx(t,o,e)}else lU(t,e)}function Zx(t,e,i){si(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:yn(e)&&(t.setupState=Dz(e)),lU(t,i)}let ML;function lU(t,e,i){const n=t.type;if(!t.render){if(!e&&ML&&!n.render){const r=n.template||K1(t).template;if(r){const{isCustomElement:s,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:l}=n,c=yr(yr({isCustomElement:s,delimiters:a},o),l);n.render=ML(r,c)}}t.render=n.render||Ho}{const r=Nd(t);Yd();try{M6(t)}finally{Zd(),r()}}}function i9(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(e,i){return To(t,"get","$attrs"),e[i]}}))}function cU(t){const e=i=>{t.exposed=i||{}};return{get attrs(){return i9(t)},slots:t.slots,emit:t.emit,expose:e}}function hP(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Dz(tP(t.exposed)),{get(e,i){if(i in e)return e[i];if(i in $g)return $g[i](t)},has(e,i){return i in e||i in $g}}))}function n9(t,e=!0){return si(t)?t.displayName||t.name:t.name||e&&t.__name}function r9(t){return si(t)&&"__vccOpts"in t}const W=(t,e)=>$8(t,e,cP);function ia(t,e,i){const n=arguments.length;return n===2?yn(e)&&!Ht(e)?qm(e)?w(t,null,[e]):w(t,e):w(t,null,e):(n>3?i=Array.prototype.slice.call(arguments,2):n===3&&qm(i)&&(i=[i]),w(t,e,i))}const s9="3.4.15";/**
* @vue/runtime-dom v3.4.15
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const o9="http://www.w3.org/2000/svg",a9="http://www.w3.org/1998/Math/MathML",Xh=typeof document<"u"?document:null,AL=Xh&&Xh.createElement("template"),l9={insert:(t,e,i)=>{e.insertBefore(t,i||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,i,n)=>{const r=e==="svg"?Xh.createElementNS(o9,t):e==="mathml"?Xh.createElementNS(a9,t):Xh.createElement(t,i?{is:i}:void 0);return t==="select"&&n&&n.multiple!=null&&r.setAttribute("multiple",n.multiple),r},createText:t=>Xh.createTextNode(t),createComment:t=>Xh.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Xh.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,i,n,r,s){const o=i?i.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),i),!(r===s||!(r=r.nextSibling)););else{AL.innerHTML=n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t;const a=AL.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,i)}return[o?o.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}},Th="transition",hg="animation",Km=Symbol("_vtc"),xo=(t,{slots:e})=>ia(y6,uU(t),e);xo.displayName="Transition";const hU={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},c9=xo.props=yr({},Gz,hU),qu=(t,e=[])=>{Ht(t)?t.forEach(i=>i(...e)):t&&t(...e)},VL=t=>t?Ht(t)?t.some(e=>e.length>1):t.length>1:!1;function uU(t){const e={};for(const D in t)D in hU||(e[D]=t[D]);if(t.css===!1)return e;const{name:i="v",type:n,duration:r,enterFromClass:s=`${i}-enter-from`,enterActiveClass:o=`${i}-enter-active`,enterToClass:a=`${i}-enter-to`,appearFromClass:l=s,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:h=`${i}-leave-from`,leaveActiveClass:d=`${i}-leave-active`,leaveToClass:f=`${i}-leave-to`}=t,m=h9(r),g=m&&m[0],v=m&&m[1],{onBeforeEnter:p,onEnter:b,onEnterCancelled:_,onLeave:P,onLeaveCancelled:E,onBeforeAppear:T=p,onAppear:C=b,onAppearCancelled:M=_}=e,x=(D,O,F)=>{Wh(D,O?u:a),Wh(D,O?c:o),F&&F()},V=(D,O)=>{D._isLeaving=!1,Wh(D,h),Wh(D,f),Wh(D,d),O&&O()},N=D=>(O,F)=>{const X=D?C:b,Z=()=>x(O,D,F);qu(X,[O,Z]),LL(()=>{Wh(O,D?l:s),Dc(O,D?u:a),VL(X)||IL(O,n,g,Z)})};return yr(e,{onBeforeEnter(D){qu(p,[D]),Dc(D,s),Dc(D,o)},onBeforeAppear(D){qu(T,[D]),Dc(D,l),Dc(D,c)},onEnter:N(!1),onAppear:N(!0),onLeave(D,O){D._isLeaving=!0;const F=()=>V(D,O);Dc(D,h),fU(),Dc(D,d),LL(()=>{D._isLeaving&&(Wh(D,h),Dc(D,f),VL(P)||IL(D,n,v,F))}),qu(P,[D,F])},onEnterCancelled(D){x(D,!1),qu(_,[D])},onAppearCancelled(D){x(D,!0),qu(M,[D])},onLeaveCancelled(D){V(D),qu(E,[D])}})}function h9(t){if(t==null)return null;if(yn(t))return[gw(t.enter),gw(t.leave)];{const e=gw(t);return[e,e]}}function gw(t){return mz(t)}function Dc(t,e){e.split(/\s+/).forEach(i=>i&&t.classList.add(i)),(t[Km]||(t[Km]=new Set)).add(e)}function Wh(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const i=t[Km];i&&(i.delete(e),i.size||(t[Km]=void 0))}function LL(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let u9=0;function IL(t,e,i,n){const r=t._endId=++u9,s=()=>{r===t._endId&&n()};if(i)return setTimeout(s,i);const{type:o,timeout:a,propCount:l}=dU(t,e);if(!o)return n();const c=o+"end";let u=0;const h=()=>{t.removeEventListener(c,d),s()},d=f=>{f.target===t&&++u>=l&&h()};setTimeout(()=>{u<l&&h()},a+1),t.addEventListener(c,d)}function dU(t,e){const i=window.getComputedStyle(t),n=m=>(i[m]||"").split(", "),r=n(`${Th}Delay`),s=n(`${Th}Duration`),o=OL(r,s),a=n(`${hg}Delay`),l=n(`${hg}Duration`),c=OL(a,l);let u=null,h=0,d=0;e===Th?o>0&&(u=Th,h=o,d=s.length):e===hg?c>0&&(u=hg,h=c,d=l.length):(h=Math.max(o,c),u=h>0?o>c?Th:hg:null,d=u?u===Th?s.length:l.length:0);const f=u===Th&&/\b(transform|all)(,|$)/.test(n(`${Th}Property`).toString());return{type:u,timeout:h,propCount:d,hasTransform:f}}function OL(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((i,n)=>DL(i)+DL(t[n])))}function DL(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function fU(){return document.body.offsetHeight}function d9(t,e,i){const n=t[Km];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):i?t.setAttribute("class",e):t.className=e}const J1=Symbol("_vod"),ln={beforeMount(t,{value:e},{transition:i}){t[J1]=t.style.display==="none"?"":t.style.display,i&&e?i.beforeEnter(t):ug(t,e)},mounted(t,{value:e},{transition:i}){i&&e&&i.enter(t)},updated(t,{value:e,oldValue:i},{transition:n}){!e!=!i&&(n?e?(n.beforeEnter(t),ug(t,!0),n.enter(t)):n.leave(t,()=>{ug(t,!1)}):ug(t,e))},beforeUnmount(t,{value:e}){ug(t,e)}};function ug(t,e){t.style.display=e?t[J1]:"none"}const f9=Symbol("");function m9(t,e,i){const n=t.style,r=n.display,s=Dn(i);if(i&&!s){if(e&&!Dn(e))for(const o in e)i[o]==null&&Jx(n,o,"");for(const o in i)Jx(n,o,i[o])}else if(s){if(e!==i){const o=n[f9];o&&(i+=";"+o),n.cssText=i}}else e&&t.removeAttribute("style");J1 in t&&(n.display=r)}const NL=/\s*!important$/;function Jx(t,e,i){if(Ht(i))i.forEach(n=>Jx(t,e,n));else if(i==null&&(i=""),e.startsWith("--"))t.setProperty(e,i);else{const n=p9(t,e);NL.test(i)?t.setProperty(Mp(n),i.replace(NL,""),"important"):t[n]=i}}const RL=["Webkit","Moz","ms"],vw={};function p9(t,e){const i=vw[e];if(i)return i;let n=Ia(e);if(n!=="filter"&&n in t)return vw[e]=n;n=vh(n);for(let r=0;r<RL.length;r++){const s=RL[r]+n;if(s in t)return vw[e]=s}return e}const FL="http://www.w3.org/1999/xlink";function g9(t,e,i,n,r){if(n&&e.startsWith("xlink:"))i==null?t.removeAttributeNS(FL,e.slice(6,e.length)):t.setAttributeNS(FL,e,i);else{const s=b8(e);i==null||s&&!gz(i)?t.removeAttribute(e):t.setAttribute(e,s?"":i)}}function v9(t,e,i,n,r,s,o){if(e==="innerHTML"||e==="textContent"){n&&o(n,r,s),t[e]=i??"";return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){t._value=i;const c=a==="OPTION"?t.getAttribute("value"):t.value,u=i??"";c!==u&&(t.value=u),i==null&&t.removeAttribute(e);return}let l=!1;if(i===""||i==null){const c=typeof t[e];c==="boolean"?i=gz(i):i==null&&c==="string"?(i="",l=!0):c==="number"&&(i=0,l=!0)}try{t[e]=i}catch{}l&&t.removeAttribute(e)}function nm(t,e,i,n){t.addEventListener(e,i,n)}function y9(t,e,i,n){t.removeEventListener(e,i,n)}const zL=Symbol("_vei");function S9(t,e,i,n,r=null){const s=t[zL]||(t[zL]={}),o=s[e];if(n&&o)o.value=n;else{const[a,l]=b9(e);if(n){const c=s[e]=E9(n,r);nm(t,a,c,l)}else o&&(y9(t,a,o,l),s[e]=void 0)}}const UL=/(?:Once|Passive|Capture)$/;function b9(t){let e;if(UL.test(t)){e={};let n;for(;n=t.match(UL);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Mp(t.slice(2)),e]}let yw=0;const _9=Promise.resolve(),P9=()=>yw||(_9.then(()=>yw=0),yw=Date.now());function E9(t,e){const i=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=i.attached)return;Ca(w9(n,i.value),e,5,[n])};return i.value=t,i.attached=P9(),i}function w9(t,e){if(Ht(e)){const i=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{i.call(t),t._stopped=!0},e.map(n=>r=>!r._stopped&&n&&n(r))}else return e}const BL=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,T9=(t,e,i,n,r,s,o,a,l)=>{const c=r==="svg";e==="class"?d9(t,n,c):e==="style"?m9(t,i,n):Z_(e)?E1(e)||S9(t,e,i,n,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):x9(t,e,n,c))?v9(t,e,n,s,o,a,l):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),g9(t,e,n,c))};function x9(t,e,i,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&BL(e)&&si(i));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return BL(e)&&Dn(i)?!1:e in t}const mU=new WeakMap,pU=new WeakMap,B0=Symbol("_moveCb"),jL=Symbol("_enterCb"),gU={name:"TransitionGroup",props:yr({},c9,{tag:String,moveClass:String}),setup(t,{slots:e}){const i=Sh(),n=Wz();let r,s;return H1(()=>{if(!r.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!L9(r[0].el,i.vnode.el,o))return;r.forEach(M9),r.forEach(A9);const a=r.filter(V9);fU(),a.forEach(l=>{const c=l.el,u=c.style;Dc(c,o),u.transform=u.webkitTransform=u.transitionDuration="";const h=c[B0]=d=>{d&&d.target!==c||(!d||/transform$/.test(d.propertyName))&&(c.removeEventListener("transitionend",h),c[B0]=null,Wh(c,o))};c.addEventListener("transitionend",h)})}),()=>{const o=hi(t),a=uU(o);let l=o.tag||mt;r=s,s=e.default?$1(e.default()):[];for(let c=0;c<s.length;c++){const u=s[c];u.key!=null&&Pv(u,_v(u,a,n,i))}if(r)for(let c=0;c<r.length;c++){const u=r[c];Pv(u,_v(u,a,n,i)),mU.set(u,u.el.getBoundingClientRect())}return w(l,null,s)}}},k9=t=>delete t.mode;gU.props;const C9=gU;function M9(t){const e=t.el;e[B0]&&e[B0](),e[jL]&&e[jL]()}function A9(t){pU.set(t,t.el.getBoundingClientRect())}function V9(t){const e=mU.get(t),i=pU.get(t),n=e.left-i.left,r=e.top-i.top;if(n||r){const s=t.el.style;return s.transform=s.webkitTransform=`translate(${n}px,${r}px)`,s.transitionDuration="0s",t}}function L9(t,e,i){const n=t.cloneNode(),r=t[Km];r&&r.forEach(a=>{a.split(/\s+/).forEach(l=>l&&n.classList.remove(l))}),i.split(/\s+/).forEach(a=>a&&n.classList.add(a)),n.style.display="none";const s=e.nodeType===1?e:e.parentNode;s.appendChild(n);const{hasTransform:o}=dU(n);return s.removeChild(n),o}const $L=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Ht(e)?i=>i0(e,i):e};function I9(t){t.target.composing=!0}function WL(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Sw=Symbol("_assign"),O9={created(t,{modifiers:{lazy:e,trim:i,number:n}},r){t[Sw]=$L(r);const s=n||r.props&&r.props.type==="number";nm(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;i&&(a=a.trim()),s&&(a=Nx(a)),t[Sw](a)}),i&&nm(t,"change",()=>{t.value=t.value.trim()}),e||(nm(t,"compositionstart",I9),nm(t,"compositionend",WL),nm(t,"change",WL))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,modifiers:{lazy:i,trim:n,number:r}},s){if(t[Sw]=$L(s),t.composing)return;const o=r||t.type==="number"?Nx(t.value):t.value,a=e??"";o!==a&&(document.activeElement===t&&t.type!=="range"&&(i||n&&t.value.trim()===a)||(t.value=a))}},D9=["ctrl","shift","alt","meta"],N9={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>D9.some(i=>t[`${i}Key`]&&!e.includes(i))},Qx=(t,e)=>{const i=t._withMods||(t._withMods={}),n=e.join(".");return i[n]||(i[n]=(r,...s)=>{for(let o=0;o<e.length;o++){const a=N9[e[o]];if(a&&a(r,e))return}return t(r,...s)})},R9=yr({patchProp:T9},l9);let GL;function F9(){return GL||(GL=j6(R9))}const z9=(...t)=>{const e=F9().createApp(...t),{mount:i}=e;return e.mount=n=>{const r=B9(n);if(!r)return;const s=e._component;!si(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.innerHTML="";const o=i(r,!1,U9(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function U9(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function B9(t){return Dn(t)?document.querySelector(t):t}const Os=[];function vU(){function t(n){console.debug("showDialog: queue length",Os.length),Os.findIndex(s=>s==n)<0?(Os.push(n),Os.length==1&&n.show()):console.debug("Attempt to show duplicate dialog")}function e(n){console.debug("hideDialog: queue length",Os.length);const r=Os.findIndex(s=>s==n);r>=0&&(Os[r].hide(),Os.splice(r,1)),Os.length>0&&Os[0].show()}function i(){if(console.debug("hideLastDialog: queue length",Os.length),Os.length===0)return!1;const n=Os.shift();return n==null||n.hide(),Os.length>0&&Os[0].show(),!0}return{showDialog:t,hideDialog:e,hideLastDialog:i}}const un=typeof window<"u",Q1=un&&"IntersectionObserver"in window,j9=un&&("ontouchstart"in window||window.navigator.maxTouchPoints>0),HL=un&&"EyeDropper"in window;function qL(t,e,i){$9(t,e),e.set(t,i)}function $9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function W9(t,e,i){var n=yU(t,e,"set");return G9(t,n,i),i}function G9(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}function Ku(t,e){var i=yU(t,e,"get");return H9(t,i)}function yU(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function H9(t,e){return e.get?e.get.call(t):e.value}function SU(t,e,i){const n=e.length-1;if(n<0)return t===void 0?i:t;for(let r=0;r<n;r++){if(t==null)return i;t=t[e[r]]}return t==null||t[e[n]]===void 0?i:t[e[n]]}function Jd(t,e){if(t===e)return!0;if(t instanceof Date&&e instanceof Date&&t.getTime()!==e.getTime()||t!==Object(t)||e!==Object(e))return!1;const i=Object.keys(t);return i.length!==Object.keys(e).length?!1:i.every(n=>Jd(t[n],e[n]))}function ek(t,e,i){return t==null||!e||typeof e!="string"?i:t[e]!==void 0?t[e]:(e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,""),SU(t,e.split("."),i))}function jl(t,e,i){if(e===!0)return t===void 0?i:t;if(e==null||typeof e=="boolean")return i;if(t!==Object(t)){if(typeof e!="function")return i;const r=e(t,i);return typeof r>"u"?i:r}if(typeof e=="string")return ek(t,e,i);if(Array.isArray(e))return SU(t,e,i);if(typeof e!="function")return i;const n=e(t,i);return typeof n>"u"?i:n}function eM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:t},(i,n)=>e+n)}function Lt(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(t==null||t===""))return isNaN(+t)?String(t):isFinite(+t)?`${Number(t)}${e}`:void 0}function j0(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function wv(t){if(t&&"$el"in t){const e=t.$el;return(e==null?void 0:e.nodeType)===Node.TEXT_NODE?e.nextElementSibling:e}return t}const KL=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16}),q9=Object.freeze({enter:"Enter",tab:"Tab",delete:"Delete",esc:"Escape",space:"Space",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",end:"End",home:"Home",del:"Delete",backspace:"Backspace",insert:"Insert",pageup:"PageUp",pagedown:"PageDown",shift:"Shift"});function bU(t){return Object.keys(t)}function md(t,e){return e.every(i=>t.hasOwnProperty(i))}function _U(t,e){const i={},n=new Set(Object.keys(t));for(const r of e)n.has(r)&&(i[r]=t[r]);return i}function tk(t,e,i){const n=Object.create(null),r=Object.create(null);for(const s in t)e.some(o=>o instanceof RegExp?o.test(s):o===s)&&!(i!=null&&i.some(o=>o===s))?n[s]=t[s]:r[s]=t[s];return[n,r]}function Ua(t,e){const i={...t};return e.forEach(n=>delete i[n]),i}const PU=/^on[^a-z]/,tM=t=>PU.test(t),K9=["onAfterscriptexecute","onAnimationcancel","onAnimationend","onAnimationiteration","onAnimationstart","onAuxclick","onBeforeinput","onBeforescriptexecute","onChange","onClick","onCompositionend","onCompositionstart","onCompositionupdate","onContextmenu","onCopy","onCut","onDblclick","onFocusin","onFocusout","onFullscreenchange","onFullscreenerror","onGesturechange","onGestureend","onGesturestart","onGotpointercapture","onInput","onKeydown","onKeypress","onKeyup","onLostpointercapture","onMousedown","onMousemove","onMouseout","onMouseover","onMouseup","onMousewheel","onPaste","onPointercancel","onPointerdown","onPointerenter","onPointerleave","onPointermove","onPointerout","onPointerover","onPointerup","onReset","onSelect","onSubmit","onTouchcancel","onTouchend","onTouchmove","onTouchstart","onTransitioncancel","onTransitionend","onTransitionrun","onTransitionstart","onWheel"];function Cy(t){const[e,i]=tk(t,[PU]),n=Ua(e,K9),[r,s]=tk(i,["class","style","id",/^data-/]);return Object.assign(r,e),Object.assign(s,n),[r,s]}function Aa(t){return t==null?[]:Array.isArray(t)?t:[t]}function X9(t,e){let i=0;const n=function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];clearTimeout(i),i=setTimeout(()=>t(...s),le(e))};return n.clear=()=>{clearTimeout(i)},n.immediate=t,n}function So(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(e,Math.min(i,t))}function XL(t){const e=t.toString().trim();return e.includes(".")?e.length-e.indexOf(".")-1:0}function YL(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return t+i.repeat(Math.max(0,e-t.length))}function ZL(t,e){return(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0").repeat(Math.max(0,e-t.length))+t}function Y9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=[];let n=0;for(;n<t.length;)i.push(t.substr(n,e)),n+=e;return i}function qo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;const n={};for(const r in t)n[r]=t[r];for(const r in e){const s=t[r],o=e[r];if(j0(s)&&j0(o)){n[r]=qo(s,o,i);continue}if(Array.isArray(s)&&Array.isArray(o)&&i){n[r]=i(s,o);continue}n[r]=o}return n}function EU(t){return t.map(e=>e.type===mt?EU(e.children):e).flat()}function Td(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(Td.cache.has(t))return Td.cache.get(t);const e=t.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return Td.cache.set(t,e),e}Td.cache=new Map;function Hg(t,e){if(!e||typeof e!="object")return[];if(Array.isArray(e))return e.map(i=>Hg(t,i)).flat(1);if(Array.isArray(e.children))return e.children.map(i=>Hg(t,i)).flat(1);if(e.component){if(Object.getOwnPropertySymbols(e.component.provides).includes(t))return[e.component];if(e.component.subTree)return Hg(t,e.component.subTree).flat(1)}return[]}var RS=new WeakMap,Pf=new WeakMap;class Z9{constructor(e){qL(this,RS,{writable:!0,value:[]}),qL(this,Pf,{writable:!0,value:0}),this.size=e}push(e){Ku(this,RS)[Ku(this,Pf)]=e,W9(this,Pf,(Ku(this,Pf)+1)%this.size)}values(){return Ku(this,RS).slice(Ku(this,Pf)).concat(Ku(this,RS).slice(0,Ku(this,Pf)))}}function J9(t){return"touches"in t?{clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}:{clientX:t.clientX,clientY:t.clientY}}function iM(t){const e=$r({}),i=W(t);return Oa(()=>{for(const n in i.value)e[n]=i.value[n]},{flush:"sync"}),iP(e)}function $0(t,e){return t.includes(e)}function wU(t){return t[2].toLowerCase()+t.slice(3)}const pl=()=>[Function,Array];function JL(t,e){return e="on"+vh(e),!!(t[e]||t[`${e}Once`]||t[`${e}Capture`]||t[`${e}OnceCapture`]||t[`${e}CaptureOnce`])}function TU(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];if(Array.isArray(t))for(const r of t)r(...i);else typeof t=="function"&&t(...i)}function Tv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=["button","[href]",'input:not([type="hidden"])',"select","textarea","[tabindex]"].map(n=>`${n}${e?':not([tabindex="-1"])':""}:not([disabled])`).join(", ");return[...t.querySelectorAll(i)]}function xU(t,e,i){let n,r=t.indexOf(document.activeElement);const s=e==="next"?1:-1;do r+=s,n=t[r];while((!n||n.offsetParent==null||!((i==null?void 0:i(n))??!0))&&r<t.length&&r>=0);return n}function W0(t,e){var n,r,s,o;const i=Tv(t);if(!e)(t===document.activeElement||!t.contains(document.activeElement))&&((n=i[0])==null||n.focus());else if(e==="first")(r=i[0])==null||r.focus();else if(e==="last")(s=i.at(-1))==null||s.focus();else if(typeof e=="number")(o=i[e])==null||o.focus();else{const a=xU(i,e);a?a.focus():W0(t,e==="next"?"first":"last")}}function Q9(){}function Xm(t,e){if(!(un&&typeof CSS<"u"&&typeof CSS.supports<"u"&&CSS.supports(`selector(${e})`)))return null;try{return!!t&&t.matches(e)}catch{return null}}function nM(t){return t.some(e=>qm(e)?e.type===Js?!1:e.type!==mt||nM(e.children):!0)?t:null}function e7(t,e){if(!un||t===0)return e(),()=>{};const i=window.setTimeout(e,t);return()=>window.clearTimeout(i)}const kU=["top","bottom"],t7=["start","end","left","right"];function ik(t,e){let[i,n]=t.split(" ");return n||(n=$0(kU,i)?"start":$0(t7,i)?"top":"center"),{side:nk(i,e),align:nk(n,e)}}function nk(t,e){return t==="start"?e?"right":"left":t==="end"?e?"left":"right":t}function bw(t){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[t.side],align:t.align}}function _w(t){return{side:t.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[t.align]}}function QL(t){return{side:t.align,align:t.side}}function eI(t){return $0(kU,t.side)?"y":"x"}class xd{constructor(e){let{x:i,y:n,width:r,height:s}=e;this.x=i,this.y=n,this.width=r,this.height=s}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function tI(t,e){return{x:{before:Math.max(0,e.left-t.left),after:Math.max(0,t.right-e.right)},y:{before:Math.max(0,e.top-t.top),after:Math.max(0,t.bottom-e.bottom)}}}function CU(t){return Array.isArray(t)?new xd({x:t[0],y:t[1],width:0,height:0}):t.getBoundingClientRect()}function rM(t){const e=t.getBoundingClientRect(),i=getComputedStyle(t),n=i.transform;if(n){let r,s,o,a,l;if(n.startsWith("matrix3d("))r=n.slice(9,-1).split(/, /),s=+r[0],o=+r[5],a=+r[12],l=+r[13];else if(n.startsWith("matrix("))r=n.slice(7,-1).split(/, /),s=+r[0],o=+r[3],a=+r[4],l=+r[5];else return new xd(e);const c=i.transformOrigin,u=e.x-a-(1-s)*parseFloat(c),h=e.y-l-(1-o)*parseFloat(c.slice(c.indexOf(" ")+1)),d=s?e.width/s:t.offsetWidth+1,f=o?e.height/o:t.offsetHeight+1;return new xd({x:u,y:h,width:d,height:f})}else return new xd(e)}function pd(t,e,i){if(typeof t.animate>"u")return{finished:Promise.resolve()};let n;try{n=t.animate(e,i)}catch{return{finished:Promise.resolve()}}return typeof n.finished>"u"&&(n.finished=new Promise(r=>{n.onfinish=()=>{r(n)}})),n}const s0=new WeakMap;function i7(t,e){Object.keys(e).forEach(i=>{if(tM(i)){const n=wU(i),r=s0.get(t);if(e[i]==null)r==null||r.forEach(s=>{const[o,a]=s;o===n&&(t.removeEventListener(n,a),r.delete(s))});else if(!r||![...r].some(s=>s[0]===n&&s[1]===e[i])){t.addEventListener(n,e[i]);const s=r||new Set;s.add([n,e[i]]),s0.has(t)||s0.set(t,s)}}else e[i]==null?t.removeAttribute(i):t.setAttribute(i,e[i])})}function n7(t,e){Object.keys(e).forEach(i=>{if(tM(i)){const n=wU(i),r=s0.get(t);r==null||r.forEach(s=>{const[o,a]=s;o===n&&(t.removeEventListener(n,a),r.delete(s))})}else t.removeAttribute(i)})}const Ef=2.4,iI=.2126729,nI=.7151522,rI=.072175,r7=.55,s7=.58,o7=.57,a7=.62,FS=.03,sI=1.45,l7=5e-4,c7=1.25,h7=1.25,oI=.078,aI=12.82051282051282,zS=.06,lI=.001;function cI(t,e){const i=(t.r/255)**Ef,n=(t.g/255)**Ef,r=(t.b/255)**Ef,s=(e.r/255)**Ef,o=(e.g/255)**Ef,a=(e.b/255)**Ef;let l=i*iI+n*nI+r*rI,c=s*iI+o*nI+a*rI;if(l<=FS&&(l+=(FS-l)**sI),c<=FS&&(c+=(FS-c)**sI),Math.abs(c-l)<l7)return 0;let u;if(c>l){const h=(c**r7-l**s7)*c7;u=h<lI?0:h<oI?h-h*aI*zS:h-zS}else{const h=(c**a7-l**o7)*h7;u=h>-lI?0:h>-oI?h-h*aI*zS:h+zS}return u*100}function u7(t,e){e=Array.isArray(e)?e.slice(0,-1).map(i=>`'${i}'`).join(", ")+` or '${e.at(-1)}'`:`'${e}'`}const G0=.20689655172413793,d7=t=>t>G0**3?Math.cbrt(t):t/(3*G0**2)+4/29,f7=t=>t>G0?t**3:3*G0**2*(t-4/29);function MU(t){const e=d7,i=e(t[1]);return[116*i-16,500*(e(t[0]/.95047)-i),200*(i-e(t[2]/1.08883))]}function AU(t){const e=f7,i=(t[0]+16)/116;return[e(i+t[1]/500)*.95047,e(i),e(i-t[2]/200)*1.08883]}const m7=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],p7=t=>t<=.0031308?t*12.92:1.055*t**(1/2.4)-.055,g7=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],v7=t=>t<=.04045?t/12.92:((t+.055)/1.055)**2.4;function VU(t){const e=Array(3),i=p7,n=m7;for(let r=0;r<3;++r)e[r]=Math.round(So(i(n[r][0]*t[0]+n[r][1]*t[1]+n[r][2]*t[2]))*255);return{r:e[0],g:e[1],b:e[2]}}function sM(t){let{r:e,g:i,b:n}=t;const r=[0,0,0],s=v7,o=g7;e=s(e/255),i=s(i/255),n=s(n/255);for(let a=0;a<3;++a)r[a]=o[a][0]*e+o[a][1]*i+o[a][2]*n;return r}function rk(t){return!!t&&/^(#|var\(--|(rgb|hsl)a?\()/.test(t)}function y7(t){return rk(t)&&!/^((rgb|hsl)a?\()?var\(--/.test(t)}const hI=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,S7={rgb:(t,e,i,n)=>({r:t,g:e,b:i,a:n}),rgba:(t,e,i,n)=>({r:t,g:e,b:i,a:n}),hsl:(t,e,i,n)=>uI({h:t,s:e,l:i,a:n}),hsla:(t,e,i,n)=>uI({h:t,s:e,l:i,a:n}),hsv:(t,e,i,n)=>oh({h:t,s:e,v:i,a:n}),hsva:(t,e,i,n)=>oh({h:t,s:e,v:i,a:n})};function Ea(t){if(typeof t=="number")return{r:(t&16711680)>>16,g:(t&65280)>>8,b:t&255};if(typeof t=="string"&&hI.test(t)){const{groups:e}=t.match(hI),{fn:i,values:n}=e,r=n.split(/,\s*/).map(s=>s.endsWith("%")&&["hsl","hsla","hsv","hsva"].includes(i)?parseFloat(s)/100:parseFloat(s));return S7[i](...r)}else if(typeof t=="string"){let e=t.startsWith("#")?t.slice(1):t;return[3,4].includes(e.length)?e=e.split("").map(i=>i+i).join(""):[6,8].includes(e.length),NU(e)}else if(typeof t=="object"){if(md(t,["r","g","b"]))return t;if(md(t,["h","s","l"]))return oh(oM(t));if(md(t,["h","s","v"]))return oh(t)}throw new TypeError(`Invalid color: ${t==null?t:String(t)||t.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function oh(t){const{h:e,s:i,v:n,a:r}=t,s=a=>{const l=(a+e/60)%6;return n-n*i*Math.max(Math.min(l,4-l,1),0)},o=[s(5),s(3),s(1)].map(a=>Math.round(a*255));return{r:o[0],g:o[1],b:o[2],a:r}}function uI(t){return oh(oM(t))}function uP(t){if(!t)return{h:0,s:1,v:1,a:1};const e=t.r/255,i=t.g/255,n=t.b/255,r=Math.max(e,i,n),s=Math.min(e,i,n);let o=0;r!==s&&(r===e?o=60*(0+(i-n)/(r-s)):r===i?o=60*(2+(n-e)/(r-s)):r===n&&(o=60*(4+(e-i)/(r-s)))),o<0&&(o=o+360);const a=r===0?0:(r-s)/r,l=[o,a,r];return{h:l[0],s:l[1],v:l[2],a:t.a}}function LU(t){const{h:e,s:i,v:n,a:r}=t,s=n-n*i/2,o=s===1||s===0?0:(n-s)/Math.min(s,1-s);return{h:e,s:o,l:s,a:r}}function oM(t){const{h:e,s:i,l:n,a:r}=t,s=n+i*Math.min(n,1-n),o=s===0?0:2-2*n/s;return{h:e,s:o,v:s,a:r}}function IU(t){let{r:e,g:i,b:n,a:r}=t;return r===void 0?`rgb(${e}, ${i}, ${n})`:`rgba(${e}, ${i}, ${n}, ${r})`}function OU(t){return IU(oh(t))}function US(t){const e=Math.round(t).toString(16);return("00".substr(0,2-e.length)+e).toUpperCase()}function DU(t){let{r:e,g:i,b:n,a:r}=t;return`#${[US(e),US(i),US(n),r!==void 0?US(Math.round(r*255)):""].join("")}`}function NU(t){t=b7(t);let[e,i,n,r]=Y9(t,2).map(s=>parseInt(s,16));return r=r===void 0?r:r/255,{r:e,g:i,b:n,a:r}}function RU(t){const e=NU(t);return uP(e)}function FU(t){return DU(oh(t))}function b7(t){return t.startsWith("#")&&(t=t.slice(1)),t=t.replace(/([^0-9a-f])/gi,"F"),(t.length===3||t.length===4)&&(t=t.split("").map(e=>e+e).join("")),t.length!==6&&(t=YL(YL(t,6),8,"F")),t}function _7(t,e){const i=MU(sM(t));return i[0]=i[0]+e*10,VU(AU(i))}function P7(t,e){const i=MU(sM(t));return i[0]=i[0]-e*10,VU(AU(i))}function sk(t){const e=Ea(t);return sM(e)[1]}function E7(t,e){const i=sk(t),n=sk(e),r=Math.max(i,n),s=Math.min(i,n);return(r+.05)/(s+.05)}function zU(t){const e=Math.abs(cI(Ea(0),Ea(t)));return Math.abs(cI(Ea(16777215),Ea(t)))>Math.min(e,50)?"#fff":"#000"}function We(t,e){return i=>Object.keys(t).reduce((n,r)=>{const o=typeof t[r]=="object"&&t[r]!=null&&!Array.isArray(t[r])?t[r]:{type:t[r]};return i&&r in i?n[r]={...o,default:i[r]}:n[r]=o,e&&!n[r].source&&(n[r].source=e),n},{})}const Ut=We({class:[String,Array],style:{type:[String,Array,Object],default:null}},"component"),Ym=Symbol.for("vuetify:defaults");function w7(t){return ge(t)}function aM(){const t=xi(Ym);if(!t)throw new Error("[Vuetify] Could not find defaults instance");return t}function Pl(t,e){const i=aM(),n=ge(t),r=W(()=>{if(le(e==null?void 0:e.disabled))return i.value;const o=le(e==null?void 0:e.scoped),a=le(e==null?void 0:e.reset),l=le(e==null?void 0:e.root);if(n.value==null&&!(o||a||l))return i.value;let c=qo(n.value,{prev:i.value});if(o)return c;if(a||l){const u=Number(a||1/0);for(let h=0;h<=u&&!(!c||!("prev"in c));h++)c=c.prev;return c&&typeof l=="string"&&l in c&&(c=qo(qo(c,{prev:c}),c[l])),c}return c.prev?qo(c.prev,c):c});return jn(Ym,r),r}function T7(t,e){var i,n;return typeof((i=t.props)==null?void 0:i[e])<"u"||typeof((n=t.props)==null?void 0:n[Td(e)])<"u"}function x7(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:aM();const n=br("useDefaults");if(e=e??n.type.name??n.type.__name,!e)throw new Error("[Vuetify] Could not determine component name");const r=W(()=>{var l;return(l=i.value)==null?void 0:l[t._as??e]}),s=new Proxy(t,{get(l,c){var h,d,f,m;const u=Reflect.get(l,c);return c==="class"||c==="style"?[(h=r.value)==null?void 0:h[c],u].filter(g=>g!=null):typeof c=="string"&&!T7(n.vnode,c)?((d=r.value)==null?void 0:d[c])??((m=(f=i.value)==null?void 0:f.global)==null?void 0:m[c])??u:u}}),o=_t();Oa(()=>{if(r.value){const l=Object.entries(r.value).filter(c=>{let[u]=c;return u.startsWith(u[0].toUpperCase())});o.value=l.length?Object.fromEntries(l):void 0}else o.value=void 0});function a(){const l=A7(Ym,n);jn(Ym,W(()=>o.value?qo((l==null?void 0:l.value)??{},o.value):l==null?void 0:l.value))}return{props:s,provideSubDefaults:a}}function El(t){if(t._setup=t._setup??t.setup,!t.name)return t;if(t._setup){t.props=We(t.props??{},t.name)();const e=Object.keys(t.props).filter(i=>i!=="class"&&i!=="style");t.filterProps=function(n){return _U(n,e)},t.props._as=String,t.setup=function(n,r){const s=aM();if(!s.value)return t._setup(n,r);const{props:o,provideSubDefaults:a}=x7(n,n._as??t.name,s),l=t._setup(o,r);return a(),l}}return t}function vt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return e=>(t?El:ri)(e)}function Qd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",i=arguments.length>2?arguments[2]:void 0;return vt()({name:i??vh(Ia(t.replace(/__/g,"-"))),props:{tag:{type:String,default:e},...Ut()},setup(n,r){let{slots:s}=r;return()=>{var o;return ia(n.tag,{class:[t,n.class],style:n.style},(o=s.default)==null?void 0:o.call(s))}}})}function UU(t){if(typeof t.getRootNode!="function"){for(;t.parentNode;)t=t.parentNode;return t!==document?null:document}const e=t.getRootNode();return e!==document&&e.getRootNode({composed:!0})!==document?null:e}const xv="cubic-bezier(0.4, 0, 0.2, 1)",k7="cubic-bezier(0.0, 0, 0.2, 1)",C7="cubic-bezier(0.4, 0, 1, 1)";function br(t,e){const i=Sh();if(!i)throw new Error(`[Vuetify] ${t} ${e||"must be called from inside a setup function"}`);return i}function Sc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const e=br(t).type;return Td((e==null?void 0:e.aliasName)||(e==null?void 0:e.name))}let BU=0,o0=new WeakMap;function Ao(){const t=br("getUid");if(o0.has(t))return o0.get(t);{const e=BU++;return o0.set(t,e),e}}Ao.reset=()=>{BU=0,o0=new WeakMap};function jU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(;t;){if(e?M7(t):lM(t))return t;t=t.parentElement}return document.scrollingElement}function H0(t,e){const i=[];if(e&&t&&!e.contains(t))return i;for(;t&&(lM(t)&&i.push(t),t!==e);)t=t.parentElement;return i}function lM(t){if(!t||t.nodeType!==Node.ELEMENT_NODE)return!1;const e=window.getComputedStyle(t);return e.overflowY==="scroll"||e.overflowY==="auto"&&t.scrollHeight>t.clientHeight}function M7(t){if(!t||t.nodeType!==Node.ELEMENT_NODE)return!1;const e=window.getComputedStyle(t);return["scroll","auto"].includes(e.overflowY)}function A7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:br("injectSelf");const{provides:i}=e;if(i&&t in i)return i[t]}function V7(t){for(;t;){if(window.getComputedStyle(t).position==="fixed")return!0;t=t.offsetParent}return!1}function Tt(t){const e=br("useRender");e.render=t}const Lu=We({border:[Boolean,Number,String]},"border");function Iu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sc();return{borderClasses:W(()=>{const n=Fi(t)?t.value:t.border,r=[];if(n===!0||n==="")r.push(`${e}--border`);else if(typeof n=="string"||n===0)for(const s of String(n).split(" "))r.push(`border-${s}`);return r})}}const L7=[null,"default","comfortable","compact"],Ba=We({density:{type:String,default:"default",validator:t=>L7.includes(t)}},"density");function wl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sc();return{densityClasses:W(()=>`${e}--density-${t.density}`)}}const Tl=We({elevation:{type:[Number,String],validator(t){const e=parseInt(t);return!isNaN(e)&&e>=0&&e<=24}}},"elevation");function xl(t){return{elevationClasses:W(()=>{const i=Fi(t)?t.value:t.elevation,n=[];return i==null||n.push(`elevation-${i}`),n})}}const cs=We({rounded:{type:[Boolean,Number,String],default:void 0}},"rounded");function hs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sc();return{roundedClasses:W(()=>{const n=Fi(t)?t.value:t.rounded,r=[];if(n===!0||n==="")r.push(`${e}--rounded`);else if(typeof n=="string"||n===0)for(const s of String(n).split(" "))r.push(`rounded-${s}`);return r})}}const pn=We({tag:{type:String,default:"div"}},"tag"),kv=Symbol.for("vuetify:theme"),wn=We({theme:String},"theme");function dI(){return{defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-bright":"#FFFFFF","surface-light":"#EEEEEE","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#1867C0","primary-darken-1":"#1F5592",secondary:"#48A9A6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-bright":"#ccbfd6","surface-light":"#424242","surface-variant":"#a3a3a3","on-surface-variant":"#424242",primary:"#2196F3","primary-darken-1":"#277CC1",secondary:"#54B6B2","secondary-darken-1":"#48A9A6",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}}}function I7(){var n,r;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dI();const e=dI();if(!t)return{...e,isDisabled:!0};const i={};for(const[s,o]of Object.entries(t.themes??{})){const a=o.dark||s==="dark"?(n=e.themes)==null?void 0:n.dark:(r=e.themes)==null?void 0:r.light;i[s]=qo(a,o)}return qo(e,{...t,themes:i})}function O7(t){const e=I7(t),i=ge(e.defaultTheme),n=ge(e.themes),r=W(()=>{const u={};for(const[h,d]of Object.entries(n.value)){const f=u[h]={...d,colors:{...d.colors}};if(e.variations)for(const m of e.variations.colors){const g=f.colors[m];if(g)for(const v of["lighten","darken"]){const p=v==="lighten"?_7:P7;for(const b of eM(e.variations[v],1))f.colors[`${m}-${v}-${b}`]=DU(p(Ea(g),b))}}for(const m of Object.keys(f.colors)){if(/^on-[a-z]/.test(m)||f.colors[`on-${m}`])continue;const g=`on-${m}`,v=Ea(f.colors[m]);f.colors[g]=zU(v)}}return u}),s=W(()=>r.value[i.value]),o=W(()=>{const u=[];s.value.dark&&Xu(u,":root",["color-scheme: dark"]),Xu(u,":root",fI(s.value));for(const[m,g]of Object.entries(r.value))Xu(u,`.v-theme--${m}`,[`color-scheme: ${g.dark?"dark":"normal"}`,...fI(g)]);const h=[],d=[],f=new Set(Object.values(r.value).flatMap(m=>Object.keys(m.colors)));for(const m of f)/^on-[a-z]/.test(m)?Xu(d,`.${m}`,[`color: rgb(var(--v-theme-${m})) !important`]):(Xu(h,`.bg-${m}`,[`--v-theme-overlay-multiplier: var(--v-theme-${m}-overlay-multiplier)`,`background-color: rgb(var(--v-theme-${m})) !important`,`color: rgb(var(--v-theme-on-${m})) !important`]),Xu(d,`.text-${m}`,[`color: rgb(var(--v-theme-${m})) !important`]),Xu(d,`.border-${m}`,[`--v-border-color: var(--v-theme-${m})`]));return u.push(...h,...d),u.map((m,g)=>g===0?m:`    ${m}`).join("")});function a(){return{style:[{children:o.value,id:"vuetify-theme-stylesheet",nonce:e.cspNonce||!1}]}}function l(u){if(e.isDisabled)return;const h=u._context.provides.usehead;if(h)if(h.push){const d=h.push(a);un&&He(o,()=>{d.patch(a)})}else un?(h.addHeadObjs(W(a)),Oa(()=>h.updateDOM())):h.addHeadObjs(a());else{let f=function(){if(typeof document<"u"&&!d){const m=document.createElement("style");m.type="text/css",m.id="vuetify-theme-stylesheet",e.cspNonce&&m.setAttribute("nonce",e.cspNonce),d=m,document.head.appendChild(d)}d&&(d.innerHTML=o.value)},d=un?document.getElementById("vuetify-theme-stylesheet"):null;un?He(o,f,{immediate:!0}):f()}}const c=W(()=>e.isDisabled?void 0:`v-theme--${i.value}`);return{install:l,isDisabled:e.isDisabled,name:i,themes:n,current:s,computedThemes:r,themeClasses:c,styles:o,global:{name:i,current:s}}}function Hn(t){br("provideTheme");const e=xi(kv,null);if(!e)throw new Error("Could not find Vuetify theme injection");const i=W(()=>t.theme??e.name.value),n=W(()=>e.themes.value[i.value]),r=W(()=>e.isDisabled?void 0:`v-theme--${i.value}`),s={...e,name:i,current:n,themeClasses:r};return jn(kv,s),s}function D7(){br("useTheme");const t=xi(kv,null);if(!t)throw new Error("Could not find Vuetify theme injection");return t}function Xu(t,e,i){t.push(`${e} {
`,...i.map(n=>`  ${n};
`),`}
`)}function fI(t){const e=t.dark?2:1,i=t.dark?1:2,n=[];for(const[r,s]of Object.entries(t.colors)){const o=Ea(s);n.push(`--v-theme-${r}: ${o.r},${o.g},${o.b}`),r.startsWith("on-")||n.push(`--v-theme-${r}-overlay-multiplier: ${sk(s)>.18?e:i}`)}for(const[r,s]of Object.entries(t.variables)){const o=typeof s=="string"&&s.startsWith("#")?Ea(s):void 0,a=o?`${o.r}, ${o.g}, ${o.b}`:void 0;n.push(`--v-${r}: ${a??s}`)}return n}function cM(t){return iM(()=>{const e=[],i={};if(t.value.background)if(rk(t.value.background)){if(i.backgroundColor=t.value.background,!t.value.text&&y7(t.value.background)){const n=Ea(t.value.background);if(n.a==null||n.a===1){const r=zU(n);i.color=r,i.caretColor=r}}}else e.push(`bg-${t.value.background}`);return t.value.text&&(rk(t.value.text)?(i.color=t.value.text,i.caretColor=t.value.text):e.push(`text-${t.value.text}`)),{colorClasses:e,colorStyles:i}})}function ko(t,e){const i=W(()=>({text:Fi(t)?t.value:e?t[e]:null})),{colorClasses:n,colorStyles:r}=cM(i);return{textColorClasses:n,textColorStyles:r}}function Cs(t,e){const i=W(()=>({background:Fi(t)?t.value:e?t[e]:null})),{colorClasses:n,colorStyles:r}=cM(i);return{backgroundColorClasses:n,backgroundColorStyles:r}}const N7=["elevated","flat","tonal","outlined","text","plain"];function ef(t,e){return w(mt,null,[t&&w("span",{key:"overlay",class:`${e}__overlay`},null),w("span",{key:"underlay",class:`${e}__underlay`},null)])}const bc=We({color:String,variant:{type:String,default:"elevated",validator:t=>N7.includes(t)}},"variant");function tf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sc();const i=W(()=>{const{variant:s}=le(t);return`${e}--variant-${s}`}),{colorClasses:n,colorStyles:r}=cM(W(()=>{const{variant:s,color:o}=le(t);return{[["elevated","flat"].includes(s)?"background":"text"]:o}}));return{colorClasses:n,colorStyles:r,variantClasses:i}}const $U=We({divided:Boolean,...Lu(),...Ut(),...Ba(),...Tl(),...cs(),...pn(),...wn(),...bc()},"VBtnGroup"),mI=vt()({name:"VBtnGroup",props:$U(),setup(t,e){let{slots:i}=e;const{themeClasses:n}=Hn(t),{densityClasses:r}=wl(t),{borderClasses:s}=Iu(t),{elevationClasses:o}=xl(t),{roundedClasses:a}=hs(t);Pl({VBtn:{height:"auto",color:bt(t,"color"),density:bt(t,"density"),flat:!0,variant:bt(t,"variant")}}),Tt(()=>w(t.tag,{class:["v-btn-group",{"v-btn-group--divided":t.divided},n.value,s.value,r.value,o.value,a.value,t.class],style:t.style},i))}});function ec(t,e){let i;function n(){i=Ap(),i.run(()=>e.length?e(()=>{i==null||i.stop(),n()}):e())}He(t,r=>{r&&!i?n():r||(i==null||i.stop(),i=void 0)},{immediate:!0}),ls(()=>{i==null||i.stop()})}function Oi(t,e,i){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:h=>h,r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:h=>h;const s=br("useProxiedModel"),o=ge(t[e]!==void 0?t[e]:i),a=Td(e),c=W(a!==e?()=>{var h,d,f,m;return t[e],!!(((h=s.vnode.props)!=null&&h.hasOwnProperty(e)||(d=s.vnode.props)!=null&&d.hasOwnProperty(a))&&((f=s.vnode.props)!=null&&f.hasOwnProperty(`onUpdate:${e}`)||(m=s.vnode.props)!=null&&m.hasOwnProperty(`onUpdate:${a}`)))}:()=>{var h,d;return t[e],!!((h=s.vnode.props)!=null&&h.hasOwnProperty(e)&&((d=s.vnode.props)!=null&&d.hasOwnProperty(`onUpdate:${e}`)))});ec(()=>!c.value,()=>{He(()=>t[e],h=>{o.value=h})});const u=W({get(){const h=t[e];return n(c.value?h:o.value)},set(h){const d=r(h),f=hi(c.value?t[e]:o.value);f===d||n(f)===h||(o.value=d,s==null||s.emit(`update:${e}`,d))}});return Object.defineProperty(u,"externalValue",{get:()=>c.value?t[e]:o.value}),u}const My=We({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),Ay=We({value:null,disabled:Boolean,selectedClass:String},"group-item");function Vy(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=br("useGroupItem");if(!n)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const r=Ao();jn(Symbol.for(`${e.description}:id`),r);const s=xi(e,null);if(!s){if(!i)return s;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${e.description}`)}const o=bt(t,"value"),a=W(()=>!!(s.disabled.value||t.disabled));s.register({id:r,value:o,disabled:a},n),an(()=>{s.unregister(r)});const l=W(()=>s.isSelected(r)),c=W(()=>l.value&&[s.selectedClass.value,t.selectedClass]);return He(l,u=>{n.emit("group:selected",{value:u})}),{id:r,isSelected:l,toggle:()=>s.select(r,!l.value),select:u=>s.select(r,u),selectedClass:c,value:o,disabled:a,group:s}}function Ip(t,e){let i=!1;const n=$r([]),r=Oi(t,"modelValue",[],d=>d==null?[]:WU(n,Aa(d)),d=>{const f=F7(n,d);return t.multiple?f:f[0]}),s=br("useGroup");function o(d,f){const m=d,g=Symbol.for(`${e.description}:id`),p=Hg(g,s==null?void 0:s.vnode).indexOf(f);le(m.value)==null&&(m.value=p),p>-1?n.splice(p,0,m):n.push(m)}function a(d){if(i)return;l();const f=n.findIndex(m=>m.id===d);n.splice(f,1)}function l(){const d=n.find(f=>!f.disabled);d&&t.mandatory==="force"&&!r.value.length&&(r.value=[d.id])}ki(()=>{l()}),an(()=>{i=!0});function c(d,f){const m=n.find(g=>g.id===d);if(!(f&&(m!=null&&m.disabled)))if(t.multiple){const g=r.value.slice(),v=g.findIndex(b=>b===d),p=~v;if(f=f??!p,p&&t.mandatory&&g.length<=1||!p&&t.max!=null&&g.length+1>t.max)return;v<0&&f?g.push(d):v>=0&&!f&&g.splice(v,1),r.value=g}else{const g=r.value.includes(d);if(t.mandatory&&g)return;r.value=f??!g?[d]:[]}}function u(d){if(t.multiple,r.value.length){const f=r.value[0],m=n.findIndex(p=>p.id===f);let g=(m+d)%n.length,v=n[g];for(;v.disabled&&g!==m;)g=(g+d)%n.length,v=n[g];if(v.disabled)return;r.value=[n[g].id]}else{const f=n.find(m=>!m.disabled);f&&(r.value=[f.id])}}const h={register:o,unregister:a,selected:r,select:c,disabled:bt(t,"disabled"),prev:()=>u(n.length-1),next:()=>u(1),isSelected:d=>r.value.includes(d),selectedClass:W(()=>t.selectedClass),items:W(()=>n),getItemIndex:d=>R7(n,d)};return jn(e,h),h}function R7(t,e){const i=WU(t,[e]);return i.length?t.findIndex(n=>n.id===i[0]):-1}function WU(t,e){const i=[];return e.forEach(n=>{const r=t.find(o=>Jd(n,o.value)),s=t[n];(r==null?void 0:r.value)!=null?i.push(r.id):s!=null&&i.push(s.id)}),i}function F7(t,e){const i=[];return e.forEach(n=>{const r=t.findIndex(s=>s.id===n);if(~r){const s=t[r];i.push(s.value!=null?s.value:r)}}),i}const GU=Symbol.for("vuetify:v-btn-toggle"),z7=We({...$U(),...My()},"VBtnToggle");vt()({name:"VBtnToggle",props:z7(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const{isSelected:n,next:r,prev:s,select:o,selected:a}=Ip(t,GU);return Tt(()=>{const l=mI.filterProps(t);return w(mI,ht({class:["v-btn-toggle",t.class]},l,{style:t.style}),{default:()=>{var c;return[(c=i.default)==null?void 0:c.call(i,{isSelected:n,next:r,prev:s,select:o,selected:a})]}})}),{next:r,prev:s,select:o}}});const U7=We({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),rr=vt(!1)({name:"VDefaultsProvider",props:U7(),setup(t,e){let{slots:i}=e;const{defaults:n,disabled:r,reset:s,root:o,scoped:a}=iP(t);return Pl(n,{reset:s,root:o,scoped:a,disabled:r}),()=>{var l;return(l=i.default)==null?void 0:l.call(i)}}});const B7={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar",eyeDropper:"mdi-eyedropper"},j7={component:t=>ia(qU,{...t,class:"mdi"})},ji=[String,Function,Object,Array],ok=Symbol.for("vuetify:icons"),dP=We({icon:{type:ji},tag:{type:String,required:!0}},"icon"),pI=vt()({name:"VComponentIcon",props:dP(),setup(t,e){let{slots:i}=e;return()=>{const n=t.icon;return w(t.tag,null,{default:()=>{var r;return[t.icon?w(n,null,null):(r=i.default)==null?void 0:r.call(i)]}})}}}),HU=El({name:"VSvgIcon",inheritAttrs:!1,props:dP(),setup(t,e){let{attrs:i}=e;return()=>w(t.tag,ht(i,{style:null}),{default:()=>[w("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(t.icon)?t.icon.map(n=>Array.isArray(n)?w("path",{d:n[0],"fill-opacity":n[1]},null):w("path",{d:n},null)):w("path",{d:t.icon},null)])]})}});El({name:"VLigatureIcon",props:dP(),setup(t){return()=>w(t.tag,null,{default:()=>[t.icon]})}});const qU=El({name:"VClassIcon",props:dP(),setup(t){return()=>w(t.tag,{class:t.icon},null)}}),$7={svg:{component:HU},class:{component:qU}};function W7(t){return qo({defaultSet:"mdi",sets:{...$7,mdi:j7},aliases:{...B7,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z"}},t)}const G7=t=>{const e=xi(ok);if(!e)throw new Error("Missing Vuetify Icons provide!");return{iconData:W(()=>{var l;const n=le(t);if(!n)return{component:pI};let r=n;if(typeof r=="string"&&(r=r.trim(),r.startsWith("$")&&(r=(l=e.aliases)==null?void 0:l[r.slice(1)])),!r)throw new Error(`Could not find aliased icon "${n}"`);if(Array.isArray(r))return{component:HU,icon:r};if(typeof r!="string")return{component:pI,icon:r};const s=Object.keys(e.sets).find(c=>typeof r=="string"&&r.startsWith(`${c}:`)),o=s?r.slice(s.length+1):r;return{component:e.sets[s??e.defaultSet].component,icon:o}})}},H7=["x-small","small","default","large","x-large"],Ly=We({size:{type:[String,Number],default:"default"}},"size");function Iy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sc();return iM(()=>{let i,n;return $0(H7,t.size)?i=`${e}--size-${t.size}`:t.size&&(n={width:Lt(t.size),height:Lt(t.size)}),{sizeClasses:i,sizeStyles:n}})}const q7=We({color:String,start:Boolean,end:Boolean,icon:ji,...Ut(),...Ly(),...pn({tag:"i"}),...wn()},"VIcon"),lt=vt()({name:"VIcon",props:q7(),setup(t,e){let{attrs:i,slots:n}=e;const r=ge(),{themeClasses:s}=Hn(t),{iconData:o}=G7(W(()=>r.value||t.icon)),{sizeClasses:a}=Iy(t),{textColorClasses:l,textColorStyles:c}=ko(bt(t,"color"));return Tt(()=>{var h,d;const u=(h=n.default)==null?void 0:h.call(n);return u&&(r.value=(d=EU(u).filter(f=>f.type===Lp&&f.children&&typeof f.children=="string")[0])==null?void 0:d.children),w(o.value.component,{tag:t.tag,icon:o.value.icon,class:["v-icon","notranslate",s.value,a.value,l.value,{"v-icon--clickable":!!i.onClick,"v-icon--start":t.start,"v-icon--end":t.end},t.class],style:[a.value?void 0:{fontSize:Lt(t.size),height:Lt(t.size),width:Lt(t.size)},c.value,t.style],role:i.onClick?"button":void 0,"aria-hidden":!i.onClick},{default:()=>[u]})}),{}}});function KU(t,e){const i=ge(),n=_t(!1);if(Q1){const r=new IntersectionObserver(s=>{t==null||t(s,r),n.value=!!s.find(o=>o.isIntersecting)},e);an(()=>{r.disconnect()}),He(i,(s,o)=>{o&&(r.unobserve(o),n.value=!1),s&&r.observe(s)},{flush:"post"})}return{intersectionRef:i,isIntersecting:n}}function Rd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"content";const i=ge(),n=ge();if(un){const r=new ResizeObserver(s=>{t==null||t(s,r),s.length&&(e==="content"?n.value=s[0].contentRect:n.value=s[0].target.getBoundingClientRect())});an(()=>{r.disconnect()}),He(i,(s,o)=>{o&&(r.unobserve(wv(o)),n.value=void 0),s&&r.observe(wv(s))},{flush:"post"})}return{resizeRef:i,contentRect:Vp(n)}}const K7=We({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...Ut(),...Ly(),...pn({tag:"div"}),...wn()},"VProgressCircular"),XU=vt()({name:"VProgressCircular",props:K7(),setup(t,e){let{slots:i}=e;const n=20,r=2*Math.PI*n,s=ge(),{themeClasses:o}=Hn(t),{sizeClasses:a,sizeStyles:l}=Iy(t),{textColorClasses:c,textColorStyles:u}=ko(bt(t,"color")),{textColorClasses:h,textColorStyles:d}=ko(bt(t,"bgColor")),{intersectionRef:f,isIntersecting:m}=KU(),{resizeRef:g,contentRect:v}=Rd(),p=W(()=>Math.max(0,Math.min(100,parseFloat(t.modelValue)))),b=W(()=>Number(t.width)),_=W(()=>l.value?Number(t.size):v.value?v.value.width:Math.max(b.value,32)),P=W(()=>n/(1-b.value/_.value)*2),E=W(()=>b.value/_.value*P.value),T=W(()=>Lt((100-p.value)/100*r));return Oa(()=>{f.value=s.value,g.value=s.value}),Tt(()=>w(t.tag,{ref:s,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!t.indeterminate,"v-progress-circular--visible":m.value,"v-progress-circular--disable-shrink":t.indeterminate==="disable-shrink"},o.value,a.value,c.value,t.class],style:[l.value,u.value,t.style],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":t.indeterminate?void 0:p.value},{default:()=>[w("svg",{style:{transform:`rotate(calc(-90deg + ${Number(t.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${P.value} ${P.value}`},[w("circle",{class:["v-progress-circular__underlay",h.value],style:d.value,fill:"transparent",cx:"50%",cy:"50%",r:n,"stroke-width":E.value,"stroke-dasharray":r,"stroke-dashoffset":0},null),w("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:n,"stroke-width":E.value,"stroke-dasharray":r,"stroke-dashoffset":T.value},null)]),i.default&&w("div",{class:"v-progress-circular__content"},[i.default({value:p.value})])]})),{}}}),bh=We({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function _h(t){return{dimensionStyles:W(()=>({height:Lt(t.height),maxHeight:Lt(t.maxHeight),maxWidth:Lt(t.maxWidth),minHeight:Lt(t.minHeight),minWidth:Lt(t.minWidth),width:Lt(t.width)}))}}const X7={badge:"Badge",open:"Open",close:"Close",confirmEdit:{ok:"OK",cancel:"Cancel"},dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{itemsSelected:"{0} selected",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more",today:"Today"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action",otp:"Please enter OTP character {0}"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},stepper:{next:"Next",prev:"Previous"},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"}},gI="$vuetify.",vI=(t,e)=>t.replace(/\{(\d+)\}/g,(i,n)=>String(e[+n])),YU=(t,e,i)=>function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];if(!n.startsWith(gI))return vI(n,s);const a=n.replace(gI,""),l=t.value&&i.value[t.value],c=e.value&&i.value[e.value];let u=ek(l,a,null);return u||(`${n}${t.value}`,u=ek(c,a,null)),u||(u=n),typeof u!="string"&&(u=n),vI(u,s)};function ZU(t,e){return(i,n)=>new Intl.NumberFormat([t.value,e.value],n).format(i)}function Pw(t,e,i){const n=Oi(t,e,t[e]??i.value);return n.value=t[e]??i.value,He(i,r=>{t[e]==null&&(n.value=i.value)}),n}function JU(t){return e=>{const i=Pw(e,"locale",t.current),n=Pw(e,"fallback",t.fallback),r=Pw(e,"messages",t.messages);return{name:"vuetify",current:i,fallback:n,messages:r,t:YU(i,n,r),n:ZU(i,n),provide:JU({current:i,fallback:n,messages:r})}}}function Y7(t){const e=_t((t==null?void 0:t.locale)??"en"),i=_t((t==null?void 0:t.fallback)??"en"),n=ge({en:X7,...t==null?void 0:t.messages});return{name:"vuetify",current:e,fallback:i,messages:n,t:YU(e,i,n),n:ZU(e,i),provide:JU({current:e,fallback:i,messages:n})}}const q0=Symbol.for("vuetify:locale");function Z7(t){return t.name!=null}function J7(t){const e=t!=null&&t.adapter&&Z7(t==null?void 0:t.adapter)?t==null?void 0:t.adapter:Y7(t),i=eq(e,t);return{...e,...i}}function nf(){const t=xi(q0);if(!t)throw new Error("[Vuetify] Could not find injected locale instance");return t}function Q7(){return{af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,km:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1}}function eq(t,e){const i=ge((e==null?void 0:e.rtl)??Q7()),n=W(()=>i.value[t.current.value]??!1);return{isRtl:n,rtl:i,rtlClasses:W(()=>`v-locale--is-${n.value?"rtl":"ltr"}`)}}function io(){const t=xi(q0);if(!t)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:t.isRtl,rtlClasses:t.rtlClasses}}const yI={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},rf=We({location:String},"location");function sf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2?arguments[2]:void 0;const{isRtl:n}=io();return{locationStyles:W(()=>{if(!t.location)return{};const{side:s,align:o}=ik(t.location.split(" ").length>1?t.location:`${t.location} center`,n.value);function a(c){return i?i(c):0}const l={};return s!=="center"&&(e?l[yI[s]]=`calc(100% - ${a(s)}px)`:l[s]=0),o!=="center"?e?l[yI[o]]=`calc(100% - ${a(o)}px)`:l[o]=0:(s==="center"?l.top=l.left="50%":l[{top:"left",bottom:"left",left:"top",right:"top"}[s]]="50%",l.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[s]),l})}}const tq=We({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...Ut(),...rf({location:"top"}),...cs(),...pn(),...wn()},"VProgressLinear"),QU=vt()({name:"VProgressLinear",props:tq(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const n=Oi(t,"modelValue"),{isRtl:r,rtlClasses:s}=io(),{themeClasses:o}=Hn(t),{locationStyles:a}=sf(t),{textColorClasses:l,textColorStyles:c}=ko(t,"color"),{backgroundColorClasses:u,backgroundColorStyles:h}=Cs(W(()=>t.bgColor||t.color)),{backgroundColorClasses:d,backgroundColorStyles:f}=Cs(t,"color"),{roundedClasses:m}=hs(t),{intersectionRef:g,isIntersecting:v}=KU(),p=W(()=>parseInt(t.max,10)),b=W(()=>parseInt(t.height,10)),_=W(()=>parseFloat(t.bufferValue)/p.value*100),P=W(()=>parseFloat(n.value)/p.value*100),E=W(()=>r.value!==t.reverse),T=W(()=>t.indeterminate?"fade-transition":"slide-x-transition"),C=W(()=>t.bgOpacity==null?t.bgOpacity:parseFloat(t.bgOpacity));function M(x){if(!g.value)return;const{left:V,right:N,width:D}=g.value.getBoundingClientRect(),O=E.value?D-x.clientX+(N-D):x.clientX-V;n.value=Math.round(O/D*p.value)}return Tt(()=>w(t.tag,{ref:g,class:["v-progress-linear",{"v-progress-linear--absolute":t.absolute,"v-progress-linear--active":t.active&&v.value,"v-progress-linear--reverse":E.value,"v-progress-linear--rounded":t.rounded,"v-progress-linear--rounded-bar":t.roundedBar,"v-progress-linear--striped":t.striped},m.value,o.value,s.value,t.class],style:[{bottom:t.location==="bottom"?0:void 0,top:t.location==="top"?0:void 0,height:t.active?Lt(b.value):0,"--v-progress-linear-height":Lt(b.value),...a.value},t.style],role:"progressbar","aria-hidden":t.active?"false":"true","aria-valuemin":"0","aria-valuemax":t.max,"aria-valuenow":t.indeterminate?void 0:P.value,onClick:t.clickable&&M},{default:()=>[t.stream&&w("div",{key:"stream",class:["v-progress-linear__stream",l.value],style:{...c.value,[E.value?"left":"right"]:Lt(-b.value),borderTop:`${Lt(b.value/2)} dotted`,opacity:C.value,top:`calc(50% - ${Lt(b.value/4)})`,width:Lt(100-_.value,"%"),"--v-progress-linear-stream-to":Lt(b.value*(E.value?1:-1))}},null),w("div",{class:["v-progress-linear__background",u.value],style:[h.value,{opacity:C.value,width:Lt(t.stream?_.value:100,"%")}]},null),w(xo,{name:T.value},{default:()=>[t.indeterminate?w("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(x=>w("div",{key:x,class:["v-progress-linear__indeterminate",x,d.value],style:f.value},null))]):w("div",{class:["v-progress-linear__determinate",d.value],style:[f.value,{width:Lt(P.value,"%")}]},null)]}),i.default&&w("div",{class:"v-progress-linear__content"},[i.default({value:P.value,buffer:_.value})])]})),{}}}),hM=We({loading:[Boolean,String]},"loader");function fP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sc();return{loaderClasses:W(()=>({[`${e}--loading`]:t.loading}))}}function uM(t,e){var n;let{slots:i}=e;return w("div",{class:`${t.name}__loader`},[((n=i.default)==null?void 0:n.call(i,{color:t.color,isActive:t.active}))||w(QU,{absolute:t.absolute,active:t.active,color:t.color,height:"2",indeterminate:!0},null)])}const iq=["static","relative","fixed","absolute","sticky"],Oy=We({position:{type:String,validator:t=>iq.includes(t)}},"position");function Dy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sc();return{positionClasses:W(()=>t.position?`${e}--${t.position}`:void 0)}}function nq(){const t=br("useRoute");return W(()=>{var e;return(e=t==null?void 0:t.proxy)==null?void 0:e.$route})}function eB(){var t,e;return(e=(t=br("useRouter"))==null?void 0:t.proxy)==null?void 0:e.$router}function mP(t,e){const i=Sv("RouterLink"),n=W(()=>!!(t.href||t.to)),r=W(()=>(n==null?void 0:n.value)||JL(e,"click")||JL(t,"click"));if(typeof i=="string")return{isLink:n,isClickable:r,href:bt(t,"href")};const s=t.to?i.useLink(t):void 0,o=nq();return{isLink:n,isClickable:r,route:s==null?void 0:s.route,navigate:s==null?void 0:s.navigate,isActive:s&&W(()=>{var a,l,c;return t.exact?o.value?((c=s.isExactActive)==null?void 0:c.value)&&Jd(s.route.value.query,o.value.query):(l=s.isExactActive)==null?void 0:l.value:(a=s.isActive)==null?void 0:a.value}),href:W(()=>t.to?s==null?void 0:s.route.value.href:t.href)}}const pP=We({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let Ew=!1;function rq(t,e){let i=!1,n,r;un&&(vn(()=>{window.addEventListener("popstate",s),n=t==null?void 0:t.beforeEach((o,a,l)=>{Ew?i?e(l):l():setTimeout(()=>i?e(l):l()),Ew=!0}),r=t==null?void 0:t.afterEach(()=>{Ew=!1})}),ls(()=>{window.removeEventListener("popstate",s),n==null||n(),r==null||r()}));function s(o){var a;(a=o.state)!=null&&a.replaced||(i=!0,setTimeout(()=>i=!1))}}function sq(t,e){He(()=>{var i;return(i=t.isActive)==null?void 0:i.value},i=>{t.isLink.value&&i&&e&&vn(()=>{e(!0)})},{immediate:!0})}const ak=Symbol("rippleStop"),oq=80;function SI(t,e){t.style.transform=e,t.style.webkitTransform=e}function lk(t){return t.constructor.name==="TouchEvent"}function tB(t){return t.constructor.name==="KeyboardEvent"}const aq=function(t,e){var h;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=0,r=0;if(!tB(t)){const d=e.getBoundingClientRect(),f=lk(t)?t.touches[t.touches.length-1]:t;n=f.clientX-d.left,r=f.clientY-d.top}let s=0,o=.3;(h=e._ripple)!=null&&h.circle?(o=.15,s=e.clientWidth/2,s=i.center?s:s+Math.sqrt((n-s)**2+(r-s)**2)/4):s=Math.sqrt(e.clientWidth**2+e.clientHeight**2)/2;const a=`${(e.clientWidth-s*2)/2}px`,l=`${(e.clientHeight-s*2)/2}px`,c=i.center?a:`${n-s}px`,u=i.center?l:`${r-s}px`;return{radius:s,scale:o,x:c,y:u,centerX:a,centerY:l}},K0={show(t,e){var f;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!((f=e==null?void 0:e._ripple)!=null&&f.enabled))return;const n=document.createElement("span"),r=document.createElement("span");n.appendChild(r),n.className="v-ripple__container",i.class&&(n.className+=` ${i.class}`);const{radius:s,scale:o,x:a,y:l,centerX:c,centerY:u}=aq(t,e,i),h=`${s*2}px`;r.className="v-ripple__animation",r.style.width=h,r.style.height=h,e.appendChild(n);const d=window.getComputedStyle(e);d&&d.position==="static"&&(e.style.position="relative",e.dataset.previousPosition="static"),r.classList.add("v-ripple__animation--enter"),r.classList.add("v-ripple__animation--visible"),SI(r,`translate(${a}, ${l}) scale3d(${o},${o},${o})`),r.dataset.activated=String(performance.now()),setTimeout(()=>{r.classList.remove("v-ripple__animation--enter"),r.classList.add("v-ripple__animation--in"),SI(r,`translate(${c}, ${u}) scale3d(1,1,1)`)},0)},hide(t){var s;if(!((s=t==null?void 0:t._ripple)!=null&&s.enabled))return;const e=t.getElementsByClassName("v-ripple__animation");if(e.length===0)return;const i=e[e.length-1];if(i.dataset.isHiding)return;i.dataset.isHiding="true";const n=performance.now()-Number(i.dataset.activated),r=Math.max(250-n,0);setTimeout(()=>{i.classList.remove("v-ripple__animation--in"),i.classList.add("v-ripple__animation--out"),setTimeout(()=>{var a;t.getElementsByClassName("v-ripple__animation").length===1&&t.dataset.previousPosition&&(t.style.position=t.dataset.previousPosition,delete t.dataset.previousPosition),((a=i.parentNode)==null?void 0:a.parentNode)===t&&t.removeChild(i.parentNode)},300)},r)}};function iB(t){return typeof t>"u"||!!t}function Cv(t){const e={},i=t.currentTarget;if(!(!(i!=null&&i._ripple)||i._ripple.touched||t[ak])){if(t[ak]=!0,lk(t))i._ripple.touched=!0,i._ripple.isTouch=!0;else if(i._ripple.isTouch)return;if(e.center=i._ripple.centered||tB(t),i._ripple.class&&(e.class=i._ripple.class),lk(t)){if(i._ripple.showTimerCommit)return;i._ripple.showTimerCommit=()=>{K0.show(t,i,e)},i._ripple.showTimer=window.setTimeout(()=>{var n;(n=i==null?void 0:i._ripple)!=null&&n.showTimerCommit&&(i._ripple.showTimerCommit(),i._ripple.showTimerCommit=null)},oq)}else K0.show(t,i,e)}}function bI(t){t[ak]=!0}function $o(t){const e=t.currentTarget;if(e!=null&&e._ripple){if(window.clearTimeout(e._ripple.showTimer),t.type==="touchend"&&e._ripple.showTimerCommit){e._ripple.showTimerCommit(),e._ripple.showTimerCommit=null,e._ripple.showTimer=window.setTimeout(()=>{$o(t)});return}window.setTimeout(()=>{e._ripple&&(e._ripple.touched=!1)}),K0.hide(e)}}function nB(t){const e=t.currentTarget;e!=null&&e._ripple&&(e._ripple.showTimerCommit&&(e._ripple.showTimerCommit=null),window.clearTimeout(e._ripple.showTimer))}let Mv=!1;function rB(t){!Mv&&(t.keyCode===KL.enter||t.keyCode===KL.space)&&(Mv=!0,Cv(t))}function sB(t){Mv=!1,$o(t)}function oB(t){Mv&&(Mv=!1,$o(t))}function aB(t,e,i){const{value:n,modifiers:r}=e,s=iB(n);if(s||K0.hide(t),t._ripple=t._ripple??{},t._ripple.enabled=s,t._ripple.centered=r.center,t._ripple.circle=r.circle,j0(n)&&n.class&&(t._ripple.class=n.class),s&&!i){if(r.stop){t.addEventListener("touchstart",bI,{passive:!0}),t.addEventListener("mousedown",bI);return}t.addEventListener("touchstart",Cv,{passive:!0}),t.addEventListener("touchend",$o,{passive:!0}),t.addEventListener("touchmove",nB,{passive:!0}),t.addEventListener("touchcancel",$o),t.addEventListener("mousedown",Cv),t.addEventListener("mouseup",$o),t.addEventListener("mouseleave",$o),t.addEventListener("keydown",rB),t.addEventListener("keyup",sB),t.addEventListener("blur",oB),t.addEventListener("dragstart",$o,{passive:!0})}else!s&&i&&lB(t)}function lB(t){t.removeEventListener("mousedown",Cv),t.removeEventListener("touchstart",Cv),t.removeEventListener("touchend",$o),t.removeEventListener("touchmove",nB),t.removeEventListener("touchcancel",$o),t.removeEventListener("mouseup",$o),t.removeEventListener("mouseleave",$o),t.removeEventListener("keydown",rB),t.removeEventListener("keyup",sB),t.removeEventListener("dragstart",$o),t.removeEventListener("blur",oB)}function lq(t,e){aB(t,e,!1)}function cq(t){delete t._ripple,lB(t)}function hq(t,e){if(e.value===e.oldValue)return;const i=iB(e.oldValue);aB(t,e,i)}const of={mounted:lq,unmounted:cq,updated:hq},cB=We({active:{type:Boolean,default:void 0},symbol:{type:null,default:GU},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:ji,appendIcon:ji,block:Boolean,slim:Boolean,stacked:Boolean,ripple:{type:[Boolean,Object],default:!0},text:String,...Lu(),...Ut(),...Ba(),...bh(),...Tl(),...Ay(),...hM(),...rf(),...Oy(),...cs(),...pP(),...Ly(),...pn({tag:"button"}),...wn(),...bc({variant:"elevated"})},"VBtn"),Qt=vt()({name:"VBtn",directives:{Ripple:of},props:cB(),emits:{"group:selected":t=>!0},setup(t,e){let{attrs:i,slots:n}=e;const{themeClasses:r}=Hn(t),{borderClasses:s}=Iu(t),{colorClasses:o,colorStyles:a,variantClasses:l}=tf(t),{densityClasses:c}=wl(t),{dimensionStyles:u}=_h(t),{elevationClasses:h}=xl(t),{loaderClasses:d}=fP(t),{locationStyles:f}=sf(t),{positionClasses:m}=Dy(t),{roundedClasses:g}=hs(t),{sizeClasses:v,sizeStyles:p}=Iy(t),b=Vy(t,t.symbol,!1),_=mP(t,i),P=W(()=>{var x;return t.active!==void 0?t.active:_.isLink.value?(x=_.isActive)==null?void 0:x.value:b==null?void 0:b.isSelected.value}),E=W(()=>(b==null?void 0:b.disabled.value)||t.disabled),T=W(()=>t.variant==="elevated"&&!(t.disabled||t.flat||t.border)),C=W(()=>{if(!(t.value===void 0||typeof t.value=="symbol"))return Object(t.value)===t.value?JSON.stringify(t.value,null,0):t.value});function M(x){var V;E.value||_.isLink.value&&(x.metaKey||x.ctrlKey||x.shiftKey||x.button!==0||i.target==="_blank")||((V=_.navigate)==null||V.call(_,x),b==null||b.toggle())}return sq(_,b==null?void 0:b.select),Tt(()=>{var F,X;const x=_.isLink.value?"a":t.tag,V=!!(t.prependIcon||n.prepend),N=!!(t.appendIcon||n.append),D=!!(t.icon&&t.icon!==!0),O=(b==null?void 0:b.isSelected.value)&&(!_.isLink.value||((F=_.isActive)==null?void 0:F.value))||!b||((X=_.isActive)==null?void 0:X.value);return fi(w(x,{type:x==="a"?void 0:"button",class:["v-btn",b==null?void 0:b.selectedClass.value,{"v-btn--active":P.value,"v-btn--block":t.block,"v-btn--disabled":E.value,"v-btn--elevated":T.value,"v-btn--flat":t.flat,"v-btn--icon":!!t.icon,"v-btn--loading":t.loading,"v-btn--slim":t.slim,"v-btn--stacked":t.stacked},r.value,s.value,O?o.value:void 0,c.value,h.value,d.value,m.value,g.value,v.value,l.value,t.class],style:[O?a.value:void 0,u.value,f.value,p.value,t.style],disabled:E.value||void 0,href:_.href.value,onClick:M,value:C.value},{default:()=>{var Z;return[ef(!0,"v-btn"),!t.icon&&V&&w("span",{key:"prepend",class:"v-btn__prepend"},[n.prepend?w(rr,{key:"prepend-defaults",disabled:!t.prependIcon,defaults:{VIcon:{icon:t.prependIcon}}},n.prepend):w(lt,{key:"prepend-icon",icon:t.prependIcon},null)]),w("span",{class:"v-btn__content","data-no-activator":""},[!n.default&&D?w(lt,{key:"content-icon",icon:t.icon},null):w(rr,{key:"content-defaults",disabled:!D,defaults:{VIcon:{icon:t.icon}}},{default:()=>{var K;return[((K=n.default)==null?void 0:K.call(n))??t.text]}})]),!t.icon&&N&&w("span",{key:"append",class:"v-btn__append"},[n.append?w(rr,{key:"append-defaults",disabled:!t.appendIcon,defaults:{VIcon:{icon:t.appendIcon}}},n.append):w(lt,{key:"append-icon",icon:t.appendIcon},null)]),!!t.loading&&w("span",{key:"loader",class:"v-btn__loader"},[((Z=n.loader)==null?void 0:Z.call(n))??w(XU,{color:typeof t.loading=="boolean"?void 0:t.loading,indeterminate:!0,size:"23",width:"2"},null)])]}}),[[Mo("ripple"),!E.value&&t.ripple,null]])}),{group:b}}});const Op=vt()({name:"VCardActions",props:Ut(),setup(t,e){let{slots:i}=e;return Pl({VBtn:{slim:!0,variant:"text"}}),Tt(()=>{var n;return w("div",{class:["v-card-actions",t.class],style:t.style},[(n=i.default)==null?void 0:n.call(i)])}),{}}}),uq=Qd("v-card-subtitle"),gP=Qd("v-card-title");function dq(t){return{aspectStyles:W(()=>{const e=Number(t.aspectRatio);return e?{paddingBottom:String(1/e*100)+"%"}:void 0})}}const hB=We({aspectRatio:[String,Number],contentClass:String,inline:Boolean,...Ut(),...bh()},"VResponsive"),_I=vt()({name:"VResponsive",props:hB(),setup(t,e){let{slots:i}=e;const{aspectStyles:n}=dq(t),{dimensionStyles:r}=_h(t);return Tt(()=>{var s;return w("div",{class:["v-responsive",{"v-responsive--inline":t.inline},t.class],style:[r.value,t.style]},[w("div",{class:"v-responsive__sizer",style:n.value},null),(s=i.additional)==null?void 0:s.call(i),i.default&&w("div",{class:["v-responsive__content",t.contentClass]},[i.default()])])}),{}}}),af=We({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:t=>t!==!0}},"transition"),Gl=(t,e)=>{let{slots:i}=e;const{transition:n,disabled:r,...s}=t,{component:o=xo,...a}=typeof n=="object"?n:{};return ia(o,ht(typeof n=="string"?{name:r?"":n}:a,s,{disabled:r}),i)};function fq(t,e){if(!Q1)return;const i=e.modifiers||{},n=e.value,{handler:r,options:s}=typeof n=="object"?n:{handler:n,options:{}},o=new IntersectionObserver(function(){var h;let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],l=arguments.length>1?arguments[1]:void 0;const c=(h=t._observe)==null?void 0:h[e.instance.$.uid];if(!c)return;const u=a.some(d=>d.isIntersecting);r&&(!i.quiet||c.init)&&(!i.once||u||c.init)&&r(u,a,l),u&&i.once?uB(t,e):c.init=!0},s);t._observe=Object(t._observe),t._observe[e.instance.$.uid]={init:!1,observer:o},o.observe(t)}function uB(t,e){var n;const i=(n=t._observe)==null?void 0:n[e.instance.$.uid];i&&(i.observer.unobserve(t),delete t._observe[e.instance.$.uid])}const mq={mounted:fq,unmounted:uB},dM=mq,pq=We({alt:String,cover:Boolean,color:String,draggable:{type:[Boolean,String],default:void 0},eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},crossorigin:String,referrerpolicy:String,srcset:String,position:String,...hB(),...Ut(),...cs(),...af()},"VImg"),dB=vt()({name:"VImg",directives:{intersect:dM},props:pq(),emits:{loadstart:t=>!0,load:t=>!0,error:t=>!0},setup(t,e){let{emit:i,slots:n}=e;const{backgroundColorClasses:r,backgroundColorStyles:s}=Cs(bt(t,"color")),{roundedClasses:o}=hs(t),a=br("VImg"),l=_t(""),c=ge(),u=_t(t.eager?"loading":"idle"),h=_t(),d=_t(),f=W(()=>t.src&&typeof t.src=="object"?{src:t.src.src,srcset:t.srcset||t.src.srcset,lazySrc:t.lazySrc||t.src.lazySrc,aspect:Number(t.aspectRatio||t.src.aspect||0)}:{src:t.src,srcset:t.srcset,lazySrc:t.lazySrc,aspect:Number(t.aspectRatio||0)}),m=W(()=>f.value.aspect||h.value/d.value||0);He(()=>t.src,()=>{g(u.value!=="idle")}),He(m,(D,O)=>{!D&&O&&c.value&&P(c.value)}),to(()=>g());function g(D){if(!(t.eager&&D)&&!(Q1&&!D&&!t.eager)){if(u.value="loading",f.value.lazySrc){const O=new Image;O.src=f.value.lazySrc,P(O,null)}f.value.src&&vn(()=>{var O;i("loadstart",((O=c.value)==null?void 0:O.currentSrc)||f.value.src),setTimeout(()=>{var F;if(!a.isUnmounted)if((F=c.value)!=null&&F.complete){if(c.value.naturalWidth||p(),u.value==="error")return;m.value||P(c.value,null),u.value==="loading"&&v()}else m.value||P(c.value),b()})})}}function v(){var D;a.isUnmounted||(b(),P(c.value),u.value="loaded",i("load",((D=c.value)==null?void 0:D.currentSrc)||f.value.src))}function p(){var D;a.isUnmounted||(u.value="error",i("error",((D=c.value)==null?void 0:D.currentSrc)||f.value.src))}function b(){const D=c.value;D&&(l.value=D.currentSrc||D.src)}let _=-1;an(()=>{clearTimeout(_)});function P(D){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const F=()=>{if(clearTimeout(_),a.isUnmounted)return;const{naturalHeight:X,naturalWidth:Z}=D;X||Z?(h.value=Z,d.value=X):!D.complete&&u.value==="loading"&&O!=null?_=window.setTimeout(F,O):(D.currentSrc.endsWith(".svg")||D.currentSrc.startsWith("data:image/svg+xml"))&&(h.value=1,d.value=1)};F()}const E=W(()=>({"v-img__img--cover":t.cover,"v-img__img--contain":!t.cover})),T=()=>{var F;if(!f.value.src||u.value==="idle")return null;const D=w("img",{class:["v-img__img",E.value],style:{objectPosition:t.position},src:f.value.src,srcset:f.value.srcset,alt:t.alt,crossorigin:t.crossorigin,referrerpolicy:t.referrerpolicy,draggable:t.draggable,sizes:t.sizes,ref:c,onLoad:v,onError:p},null),O=(F=n.sources)==null?void 0:F.call(n);return w(Gl,{transition:t.transition,appear:!0},{default:()=>[fi(O?w("picture",{class:"v-img__picture"},[O,D]):D,[[ln,u.value==="loaded"]])]})},C=()=>w(Gl,{transition:t.transition},{default:()=>[f.value.lazySrc&&u.value!=="loaded"&&w("img",{class:["v-img__img","v-img__img--preload",E.value],style:{objectPosition:t.position},src:f.value.lazySrc,alt:t.alt,crossorigin:t.crossorigin,referrerpolicy:t.referrerpolicy,draggable:t.draggable},null)]}),M=()=>n.placeholder?w(Gl,{transition:t.transition,appear:!0},{default:()=>[(u.value==="loading"||u.value==="error"&&!n.error)&&w("div",{class:"v-img__placeholder"},[n.placeholder()])]}):null,x=()=>n.error?w(Gl,{transition:t.transition,appear:!0},{default:()=>[u.value==="error"&&w("div",{class:"v-img__error"},[n.error()])]}):null,V=()=>t.gradient?w("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${t.gradient})`}},null):null,N=_t(!1);{const D=He(m,O=>{O&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{N.value=!0})}),D())})}return Tt(()=>{const D=_I.filterProps(t);return fi(w(_I,ht({class:["v-img",{"v-img--booting":!N.value},r.value,o.value,t.class],style:[{width:Lt(t.width==="auto"?h.value:t.width)},s.value,t.style]},D,{aspectRatio:m.value,"aria-label":t.alt,role:t.alt?"img":void 0}),{additional:()=>w(mt,null,[w(T,null,null),w(C,null,null),w(V,null,null),w(M,null,null),w(x,null,null)]),default:n.default}),[[Mo("intersect"),{handler:g,options:t.options},null,{once:!0}]])}),{currentSrc:l,image:c,state:u,naturalWidth:h,naturalHeight:d}}}),gq=We({start:Boolean,end:Boolean,icon:ji,image:String,text:String,...Ut(),...Ba(),...cs(),...Ly(),...pn(),...wn(),...bc({variant:"flat"})},"VAvatar"),ah=vt()({name:"VAvatar",props:gq(),setup(t,e){let{slots:i}=e;const{themeClasses:n}=Hn(t),{colorClasses:r,colorStyles:s,variantClasses:o}=tf(t),{densityClasses:a}=wl(t),{roundedClasses:l}=hs(t),{sizeClasses:c,sizeStyles:u}=Iy(t);return Tt(()=>w(t.tag,{class:["v-avatar",{"v-avatar--start":t.start,"v-avatar--end":t.end},n.value,r.value,a.value,l.value,c.value,o.value,t.class],style:[s.value,u.value,t.style]},{default:()=>{var h;return[t.image?w(dB,{key:"image",src:t.image,alt:"",cover:!0},null):t.icon?w(lt,{key:"icon",icon:t.icon},null):((h=i.default)==null?void 0:h.call(i))??t.text,ef(!1,"v-avatar")]}})),{}}}),vq=We({appendAvatar:String,appendIcon:ji,prependAvatar:String,prependIcon:ji,subtitle:[String,Number],title:[String,Number],...Ut(),...Ba()},"VCardItem"),yq=vt()({name:"VCardItem",props:vq(),setup(t,e){let{slots:i}=e;return Tt(()=>{var c;const n=!!(t.prependAvatar||t.prependIcon),r=!!(n||i.prepend),s=!!(t.appendAvatar||t.appendIcon),o=!!(s||i.append),a=!!(t.title!=null||i.title),l=!!(t.subtitle!=null||i.subtitle);return w("div",{class:["v-card-item",t.class],style:t.style},[r&&w("div",{key:"prepend",class:"v-card-item__prepend"},[i.prepend?w(rr,{key:"prepend-defaults",disabled:!n,defaults:{VAvatar:{density:t.density,image:t.prependAvatar},VIcon:{density:t.density,icon:t.prependIcon}}},i.prepend):w(mt,null,[t.prependAvatar&&w(ah,{key:"prepend-avatar",density:t.density,image:t.prependAvatar},null),t.prependIcon&&w(lt,{key:"prepend-icon",density:t.density,icon:t.prependIcon},null)])]),w("div",{class:"v-card-item__content"},[a&&w(gP,{key:"title"},{default:()=>{var u;return[((u=i.title)==null?void 0:u.call(i))??t.title]}}),l&&w(uq,{key:"subtitle"},{default:()=>{var u;return[((u=i.subtitle)==null?void 0:u.call(i))??t.subtitle]}}),(c=i.default)==null?void 0:c.call(i)]),o&&w("div",{key:"append",class:"v-card-item__append"},[i.append?w(rr,{key:"append-defaults",disabled:!s,defaults:{VAvatar:{density:t.density,image:t.appendAvatar},VIcon:{density:t.density,icon:t.appendIcon}}},i.append):w(mt,null,[t.appendIcon&&w(lt,{key:"append-icon",density:t.density,icon:t.appendIcon},null),t.appendAvatar&&w(ah,{key:"append-avatar",density:t.density,image:t.appendAvatar},null)])])])}),{}}}),lh=Qd("v-card-text"),Sq=We({appendAvatar:String,appendIcon:ji,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:ji,ripple:{type:[Boolean,Object],default:!0},subtitle:[String,Number],text:[String,Number],title:[String,Number],...Lu(),...Ut(),...Ba(),...bh(),...Tl(),...hM(),...rf(),...Oy(),...cs(),...pP(),...pn(),...wn(),...bc({variant:"elevated"})},"VCard"),uc=vt()({name:"VCard",directives:{Ripple:of},props:Sq(),setup(t,e){let{attrs:i,slots:n}=e;const{themeClasses:r}=Hn(t),{borderClasses:s}=Iu(t),{colorClasses:o,colorStyles:a,variantClasses:l}=tf(t),{densityClasses:c}=wl(t),{dimensionStyles:u}=_h(t),{elevationClasses:h}=xl(t),{loaderClasses:d}=fP(t),{locationStyles:f}=sf(t),{positionClasses:m}=Dy(t),{roundedClasses:g}=hs(t),v=mP(t,i),p=W(()=>t.link!==!1&&v.isLink.value),b=W(()=>!t.disabled&&t.link!==!1&&(t.link||v.isClickable.value));return Tt(()=>{const _=p.value?"a":t.tag,P=!!(n.title||t.title!=null),E=!!(n.subtitle||t.subtitle!=null),T=P||E,C=!!(n.append||t.appendAvatar||t.appendIcon),M=!!(n.prepend||t.prependAvatar||t.prependIcon),x=!!(n.image||t.image),V=T||M||C,N=!!(n.text||t.text!=null);return fi(w(_,{class:["v-card",{"v-card--disabled":t.disabled,"v-card--flat":t.flat,"v-card--hover":t.hover&&!(t.disabled||t.flat),"v-card--link":b.value},r.value,s.value,o.value,c.value,h.value,d.value,m.value,g.value,l.value,t.class],style:[a.value,u.value,f.value,t.style],href:v.href.value,onClick:b.value&&v.navigate,tabindex:t.disabled?-1:void 0},{default:()=>{var D;return[x&&w("div",{key:"image",class:"v-card__image"},[n.image?w(rr,{key:"image-defaults",disabled:!t.image,defaults:{VImg:{cover:!0,src:t.image}}},n.image):w(dB,{key:"image-img",cover:!0,src:t.image},null)]),w(uM,{name:"v-card",active:!!t.loading,color:typeof t.loading=="boolean"?void 0:t.loading},{default:n.loader}),V&&w(yq,{key:"item",prependAvatar:t.prependAvatar,prependIcon:t.prependIcon,title:t.title,subtitle:t.subtitle,appendAvatar:t.appendAvatar,appendIcon:t.appendIcon},{default:n.item,prepend:n.prepend,title:n.title,subtitle:n.subtitle,append:n.append}),N&&w(lh,{key:"text"},{default:()=>{var O;return[((O=n.text)==null?void 0:O.call(n))??t.text]}}),(D=n.default)==null?void 0:D.call(n),n.actions&&w(Op,null,{default:n.actions}),ef(b.value,"v-card")]}}),[[Mo("ripple"),b.value&&t.ripple]])}),{}}});const bq=We({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function na(t,e,i){return vt()({name:t,props:bq({mode:i,origin:e}),setup(n,r){let{slots:s}=r;const o={onBeforeEnter(a){n.origin&&(a.style.transformOrigin=n.origin)},onLeave(a){if(n.leaveAbsolute){const{offsetTop:l,offsetLeft:c,offsetWidth:u,offsetHeight:h}=a;a._transitionInitialStyles={position:a.style.position,top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height},a.style.position="absolute",a.style.top=`${l}px`,a.style.left=`${c}px`,a.style.width=`${u}px`,a.style.height=`${h}px`}n.hideOnLeave&&a.style.setProperty("display","none","important")},onAfterLeave(a){if(n.leaveAbsolute&&(a!=null&&a._transitionInitialStyles)){const{position:l,top:c,left:u,width:h,height:d}=a._transitionInitialStyles;delete a._transitionInitialStyles,a.style.position=l||"",a.style.top=c||"",a.style.left=u||"",a.style.width=h||"",a.style.height=d||""}}};return()=>{const a=n.group?C9:xo;return ia(a,{name:n.disabled?"":t,css:!n.disabled,...n.group?void 0:{mode:n.mode},...n.disabled?{}:o},s.default)}}})}function fB(t,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return vt()({name:t,props:{mode:{type:String,default:i},disabled:Boolean},setup(n,r){let{slots:s}=r;return()=>ia(xo,{name:n.disabled?"":t,css:!n.disabled,...n.disabled?{}:e},s.default)}})}function mB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const i=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",n=Ia(`offset-${i}`);return{onBeforeEnter(o){o._parent=o.parentNode,o._initialStyle={transition:o.style.transition,overflow:o.style.overflow,[i]:o.style[i]}},onEnter(o){const a=o._initialStyle;o.style.setProperty("transition","none","important"),o.style.overflow="hidden";const l=`${o[n]}px`;o.style[i]="0",o.offsetHeight,o.style.transition=a.transition,t&&o._parent&&o._parent.classList.add(t),requestAnimationFrame(()=>{o.style[i]=l})},onAfterEnter:s,onEnterCancelled:s,onLeave(o){o._initialStyle={transition:"",overflow:o.style.overflow,[i]:o.style[i]},o.style.overflow="hidden",o.style[i]=`${o[n]}px`,o.offsetHeight,requestAnimationFrame(()=>o.style[i]="0")},onAfterLeave:r,onLeaveCancelled:r};function r(o){t&&o._parent&&o._parent.classList.remove(t),s(o)}function s(o){const a=o._initialStyle[i];o.style.overflow=o._initialStyle.overflow,a!=null&&(o.style[i]=a),delete o._initialStyle}}const _q=We({target:[Object,Array]},"v-dialog-transition"),fM=vt()({name:"VDialogTransition",props:_q(),setup(t,e){let{slots:i}=e;const n={onBeforeEnter(r){r.style.pointerEvents="none",r.style.visibility="hidden"},async onEnter(r,s){var d;await new Promise(f=>requestAnimationFrame(f)),await new Promise(f=>requestAnimationFrame(f)),r.style.visibility="";const{x:o,y:a,sx:l,sy:c,speed:u}=EI(t.target,r),h=pd(r,[{transform:`translate(${o}px, ${a}px) scale(${l}, ${c})`,opacity:0},{}],{duration:225*u,easing:k7});(d=PI(r))==null||d.forEach(f=>{pd(f,[{opacity:0},{opacity:0,offset:.33},{}],{duration:225*2*u,easing:xv})}),h.finished.then(()=>s())},onAfterEnter(r){r.style.removeProperty("pointer-events")},onBeforeLeave(r){r.style.pointerEvents="none"},async onLeave(r,s){var d;await new Promise(f=>requestAnimationFrame(f));const{x:o,y:a,sx:l,sy:c,speed:u}=EI(t.target,r);pd(r,[{},{transform:`translate(${o}px, ${a}px) scale(${l}, ${c})`,opacity:0}],{duration:125*u,easing:C7}).finished.then(()=>s()),(d=PI(r))==null||d.forEach(f=>{pd(f,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*u,easing:xv})})},onAfterLeave(r){r.style.removeProperty("pointer-events")}};return()=>t.target?w(xo,ht({name:"dialog-transition"},n,{css:!1}),i):w(xo,{name:"dialog-transition"},i)}});function PI(t){var i;const e=(i=t.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:i.children;return e&&[...e]}function EI(t,e){const i=CU(t),n=rM(e),[r,s]=getComputedStyle(e).transformOrigin.split(" ").map(p=>parseFloat(p)),[o,a]=getComputedStyle(e).getPropertyValue("--v-overlay-anchor-origin").split(" ");let l=i.left+i.width/2;o==="left"||a==="left"?l-=i.width/2:(o==="right"||a==="right")&&(l+=i.width/2);let c=i.top+i.height/2;o==="top"||a==="top"?c-=i.height/2:(o==="bottom"||a==="bottom")&&(c+=i.height/2);const u=i.width/n.width,h=i.height/n.height,d=Math.max(1,u,h),f=u/d||0,m=h/d||0,g=n.width*n.height/(window.innerWidth*window.innerHeight),v=g>.12?Math.min(1.5,(g-.12)*10+1):1;return{x:l-(r+n.left),y:c-(s+n.top),sx:f,sy:m,speed:v}}na("fab-transition","center center","out-in");na("dialog-bottom-transition");na("dialog-top-transition");const wI=na("fade-transition"),pB=na("scale-transition");na("scroll-x-transition");na("scroll-x-reverse-transition");na("scroll-y-transition");na("scroll-y-reverse-transition");const Pq=na("slide-x-transition");na("slide-x-reverse-transition");const gB=na("slide-y-transition");na("slide-y-reverse-transition");const vB=fB("expand-transition",mB()),yB=fB("expand-x-transition",mB("",!0));function ww(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Eq(t,e){return{x:t.x-e.x,y:t.y-e.y}}function TI(t,e){if(t.side==="top"||t.side==="bottom"){const{side:i,align:n}=t,r=n==="left"?0:n==="center"?e.width/2:n==="right"?e.width:n,s=i==="top"?0:i==="bottom"?e.height:i;return ww({x:r,y:s},e)}else if(t.side==="left"||t.side==="right"){const{side:i,align:n}=t,r=i==="left"?0:i==="right"?e.width:i,s=n==="top"?0:n==="center"?e.height/2:n==="bottom"?e.height:n;return ww({x:r,y:s},e)}return ww({x:e.width/2,y:e.height/2},e)}const SB={static:xq,connected:Cq},wq=We({locationStrategy:{type:[String,Function],default:"static",validator:t=>typeof t=="function"||t in SB},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function Tq(t,e){const i=ge({}),n=ge();un&&ec(()=>!!(e.isActive.value&&t.locationStrategy),s=>{var o,a;He(()=>t.locationStrategy,s),ls(()=>{window.removeEventListener("resize",r),n.value=void 0}),window.addEventListener("resize",r,{passive:!0}),typeof t.locationStrategy=="function"?n.value=(o=t.locationStrategy(e,t,i))==null?void 0:o.updateLocation:n.value=(a=SB[t.locationStrategy](e,t,i))==null?void 0:a.updateLocation});function r(s){var o;(o=n.value)==null||o.call(n,s)}return{contentStyles:i,updateLocation:n}}function xq(){}function kq(t,e){e?t.style.removeProperty("left"):t.style.removeProperty("right");const i=rM(t);return e?i.x+=parseFloat(t.style.right||0):i.x-=parseFloat(t.style.left||0),i.y-=parseFloat(t.style.top||0),i}function Cq(t,e,i){(Array.isArray(t.target.value)||V7(t.target.value))&&Object.assign(i.value,{position:"fixed",top:0,[t.isRtl.value?"right":"left"]:0});const{preferredAnchor:r,preferredOrigin:s}=iM(()=>{const m=ik(e.location,t.isRtl.value),g=e.origin==="overlap"?m:e.origin==="auto"?bw(m):ik(e.origin,t.isRtl.value);return m.side===g.side&&m.align===_w(g).align?{preferredAnchor:QL(m),preferredOrigin:QL(g)}:{preferredAnchor:m,preferredOrigin:g}}),[o,a,l,c]=["minWidth","minHeight","maxWidth","maxHeight"].map(m=>W(()=>{const g=parseFloat(e[m]);return isNaN(g)?1/0:g})),u=W(()=>{if(Array.isArray(e.offset))return e.offset;if(typeof e.offset=="string"){const m=e.offset.split(" ").map(parseFloat);return m.length<2&&m.push(0),m}return typeof e.offset=="number"?[e.offset,0]:[0,0]});let h=!1;const d=new ResizeObserver(()=>{h&&f()});He([t.target,t.contentEl],(m,g)=>{let[v,p]=m,[b,_]=g;b&&!Array.isArray(b)&&d.unobserve(b),v&&!Array.isArray(v)&&d.observe(v),_&&d.unobserve(_),p&&d.observe(p)},{immediate:!0}),ls(()=>{d.disconnect()});function f(){if(h=!1,requestAnimationFrame(()=>h=!0),!t.target.value||!t.contentEl.value)return;const m=CU(t.target.value),g=kq(t.contentEl.value,t.isRtl.value),v=H0(t.contentEl.value),p=12;v.length||(v.push(document.documentElement),t.contentEl.value.style.top&&t.contentEl.value.style.left||(g.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),g.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const b=v.reduce((N,D)=>{const O=D.getBoundingClientRect(),F=new xd({x:D===document.documentElement?0:O.x,y:D===document.documentElement?0:O.y,width:D.clientWidth,height:D.clientHeight});return N?new xd({x:Math.max(N.left,F.left),y:Math.max(N.top,F.top),width:Math.min(N.right,F.right)-Math.max(N.left,F.left),height:Math.min(N.bottom,F.bottom)-Math.max(N.top,F.top)}):F},void 0);b.x+=p,b.y+=p,b.width-=p*2,b.height-=p*2;let _={anchor:r.value,origin:s.value};function P(N){const D=new xd(g),O=TI(N.anchor,m),F=TI(N.origin,D);let{x:X,y:Z}=Eq(O,F);switch(N.anchor.side){case"top":Z-=u.value[0];break;case"bottom":Z+=u.value[0];break;case"left":X-=u.value[0];break;case"right":X+=u.value[0];break}switch(N.anchor.align){case"top":Z-=u.value[1];break;case"bottom":Z+=u.value[1];break;case"left":X-=u.value[1];break;case"right":X+=u.value[1];break}return D.x+=X,D.y+=Z,D.width=Math.min(D.width,l.value),D.height=Math.min(D.height,c.value),{overflows:tI(D,b),x:X,y:Z}}let E=0,T=0;const C={x:0,y:0},M={x:!1,y:!1};let x=-1;for(;!(x++>10);){const{x:N,y:D,overflows:O}=P(_);E+=N,T+=D,g.x+=N,g.y+=D;{const F=eI(_.anchor),X=O.x.before||O.x.after,Z=O.y.before||O.y.after;let K=!1;if(["x","y"].forEach(z=>{if(z==="x"&&X&&!M.x||z==="y"&&Z&&!M.y){const H={anchor:{..._.anchor},origin:{..._.origin}},re=z==="x"?F==="y"?_w:bw:F==="y"?bw:_w;H.anchor=re(H.anchor),H.origin=re(H.origin);const{overflows:ne}=P(H);(ne[z].before<=O[z].before&&ne[z].after<=O[z].after||ne[z].before+ne[z].after<(O[z].before+O[z].after)/2)&&(_=H,K=M[z]=!0)}}),K)continue}O.x.before&&(E+=O.x.before,g.x+=O.x.before),O.x.after&&(E-=O.x.after,g.x-=O.x.after),O.y.before&&(T+=O.y.before,g.y+=O.y.before),O.y.after&&(T-=O.y.after,g.y-=O.y.after);{const F=tI(g,b);C.x=b.width-F.x.before-F.x.after,C.y=b.height-F.y.before-F.y.after,E+=F.x.before,g.x+=F.x.before,T+=F.y.before,g.y+=F.y.before}break}const V=eI(_.anchor);return Object.assign(i.value,{"--v-overlay-anchor-origin":`${_.anchor.side} ${_.anchor.align}`,transformOrigin:`${_.origin.side} ${_.origin.align}`,top:Lt(Tw(T)),left:t.isRtl.value?void 0:Lt(Tw(E)),right:t.isRtl.value?Lt(Tw(-E)):void 0,minWidth:Lt(V==="y"?Math.min(o.value,m.width):o.value),maxWidth:Lt(xI(So(C.x,o.value===1/0?0:o.value,l.value))),maxHeight:Lt(xI(So(C.y,a.value===1/0?0:a.value,c.value)))}),{available:C,contentBox:g}}return He(()=>[r.value,s.value,e.offset,e.minWidth,e.minHeight,e.maxWidth,e.maxHeight],()=>f()),vn(()=>{const m=f();if(!m)return;const{available:g,contentBox:v}=m;v.height>g.y&&requestAnimationFrame(()=>{f(),requestAnimationFrame(()=>{f()})})}),{updateLocation:f}}function Tw(t){return Math.round(t*devicePixelRatio)/devicePixelRatio}function xI(t){return Math.ceil(t*devicePixelRatio)/devicePixelRatio}let ck=!0;const X0=[];function Mq(t){!ck||X0.length?(X0.push(t),hk()):(ck=!1,t(),hk())}let kI=-1;function hk(){cancelAnimationFrame(kI),kI=requestAnimationFrame(()=>{const t=X0.shift();t&&t(),X0.length?hk():ck=!0})}const a0={none:null,close:Lq,block:Iq,reposition:Oq},Aq=We({scrollStrategy:{type:[String,Function],default:"block",validator:t=>typeof t=="function"||t in a0}},"VOverlay-scroll-strategies");function Vq(t,e){if(!un)return;let i;Oa(async()=>{i==null||i.stop(),e.isActive.value&&t.scrollStrategy&&(i=Ap(),await vn(),i.active&&i.run(()=>{var n;typeof t.scrollStrategy=="function"?t.scrollStrategy(e,t,i):(n=a0[t.scrollStrategy])==null||n.call(a0,e,t,i)}))}),ls(()=>{i==null||i.stop()})}function Lq(t){function e(i){t.isActive.value=!1}bB(t.targetEl.value??t.contentEl.value,e)}function Iq(t,e){var o;const i=(o=t.root.value)==null?void 0:o.offsetParent,n=[...new Set([...H0(t.targetEl.value,e.contained?i:void 0),...H0(t.contentEl.value,e.contained?i:void 0)])].filter(a=>!a.classList.contains("v-overlay-scroll-blocked")),r=window.innerWidth-document.documentElement.offsetWidth,s=(a=>lM(a)&&a)(i||document.documentElement);s&&t.root.value.classList.add("v-overlay--scroll-blocked"),n.forEach((a,l)=>{a.style.setProperty("--v-body-scroll-x",Lt(-a.scrollLeft)),a.style.setProperty("--v-body-scroll-y",Lt(-a.scrollTop)),a!==document.documentElement&&a.style.setProperty("--v-scrollbar-offset",Lt(r)),a.classList.add("v-overlay-scroll-blocked")}),ls(()=>{n.forEach((a,l)=>{const c=parseFloat(a.style.getPropertyValue("--v-body-scroll-x")),u=parseFloat(a.style.getPropertyValue("--v-body-scroll-y")),h=a.style.scrollBehavior;a.style.scrollBehavior="auto",a.style.removeProperty("--v-body-scroll-x"),a.style.removeProperty("--v-body-scroll-y"),a.style.removeProperty("--v-scrollbar-offset"),a.classList.remove("v-overlay-scroll-blocked"),a.scrollLeft=-c,a.scrollTop=-u,a.style.scrollBehavior=h}),s&&t.root.value.classList.remove("v-overlay--scroll-blocked")})}function Oq(t,e,i){let n=!1,r=-1,s=-1;function o(a){Mq(()=>{var u,h;const l=performance.now();(h=(u=t.updateLocation).value)==null||h.call(u,a),n=(performance.now()-l)/(1e3/60)>2})}s=(typeof requestIdleCallback>"u"?a=>a():requestIdleCallback)(()=>{i.run(()=>{bB(t.targetEl.value??t.contentEl.value,a=>{n?(cancelAnimationFrame(r),r=requestAnimationFrame(()=>{r=requestAnimationFrame(()=>{o(a)})})):o(a)})})}),ls(()=>{typeof cancelIdleCallback<"u"&&cancelIdleCallback(s),cancelAnimationFrame(r)})}function bB(t,e){const i=[document,...H0(t)];i.forEach(n=>{n.addEventListener("scroll",e,{passive:!0})}),ls(()=>{i.forEach(n=>{n.removeEventListener("scroll",e)})})}const uk=Symbol.for("vuetify:v-menu"),_B=We({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function PB(t,e){let i=()=>{};function n(o){i==null||i();const a=Number(o?t.openDelay:t.closeDelay);return new Promise(l=>{i=e7(a,()=>{e==null||e(o),l(o)})})}function r(){return n(!0)}function s(){return n(!1)}return{clearDelay:i,runOpenDelay:r,runCloseDelay:s}}const Dq=We({target:[String,Object],activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,..._B()},"VOverlay-activator");function Nq(t,e){let{isActive:i,isTop:n}=e;const r=br("useActivator"),s=ge();let o=!1,a=!1,l=!0;const c=W(()=>t.openOnFocus||t.openOnFocus==null&&t.openOnHover),u=W(()=>t.openOnClick||t.openOnClick==null&&!t.openOnHover&&!c.value),{runOpenDelay:h,runCloseDelay:d}=PB(t,C=>{C===(t.openOnHover&&o||c.value&&a)&&!(t.openOnHover&&i.value&&!n.value)&&(i.value!==C&&(l=!0),i.value=C)}),f=ge(),m={onClick:C=>{C.stopPropagation(),s.value=C.currentTarget||C.target,i.value||(f.value=[C.clientX,C.clientY]),i.value=!i.value},onMouseenter:C=>{var M;(M=C.sourceCapabilities)!=null&&M.firesTouchEvents||(o=!0,s.value=C.currentTarget||C.target,h())},onMouseleave:C=>{o=!1,d()},onFocus:C=>{Xm(C.target,":focus-visible")!==!1&&(a=!0,C.stopPropagation(),s.value=C.currentTarget||C.target,h())},onBlur:C=>{a=!1,C.stopPropagation(),d()}},g=W(()=>{const C={};return u.value&&(C.onClick=m.onClick),t.openOnHover&&(C.onMouseenter=m.onMouseenter,C.onMouseleave=m.onMouseleave),c.value&&(C.onFocus=m.onFocus,C.onBlur=m.onBlur),C}),v=W(()=>{const C={};if(t.openOnHover&&(C.onMouseenter=()=>{o=!0,h()},C.onMouseleave=()=>{o=!1,d()}),c.value&&(C.onFocusin=()=>{a=!0,h()},C.onFocusout=()=>{a=!1,d()}),t.closeOnContentClick){const M=xi(uk,null);C.onClick=()=>{i.value=!1,M==null||M.closeParents()}}return C}),p=W(()=>{const C={};return t.openOnHover&&(C.onMouseenter=()=>{l&&(o=!0,l=!1,h())},C.onMouseleave=()=>{o=!1,d()}),C});He(n,C=>{C&&(t.openOnHover&&!o&&(!c.value||!a)||c.value&&!a&&(!t.openOnHover||!o))&&(i.value=!1)}),He(i,C=>{C||setTimeout(()=>{f.value=void 0})},{flush:"post"});const b=ge();Oa(()=>{b.value&&vn(()=>{s.value=wv(b.value)})});const _=ge(),P=W(()=>t.target==="cursor"&&f.value?f.value:_.value?wv(_.value):EB(t.target,r)||s.value),E=W(()=>Array.isArray(P.value)?void 0:P.value);let T;return He(()=>!!t.activator,C=>{C&&un?(T=Ap(),T.run(()=>{Rq(t,r,{activatorEl:s,activatorEvents:g})})):T&&T.stop()},{flush:"post",immediate:!0}),ls(()=>{T==null||T.stop()}),{activatorEl:s,activatorRef:b,target:P,targetEl:E,targetRef:_,activatorEvents:g,contentEvents:v,scrimEvents:p}}function Rq(t,e,i){let{activatorEl:n,activatorEvents:r}=i;He(()=>t.activator,(l,c)=>{if(c&&l!==c){const u=a(c);u&&o(u)}l&&vn(()=>s())},{immediate:!0}),He(()=>t.activatorProps,()=>{s()}),ls(()=>{o()});function s(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a(),c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.activatorProps;l&&i7(l,ht(r.value,c))}function o(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:a(),c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.activatorProps;l&&n7(l,ht(r.value,c))}function a(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.activator;const c=EB(l,e);return n.value=(c==null?void 0:c.nodeType)===Node.ELEMENT_NODE?c:void 0,n.value}}function EB(t,e){var n,r;if(!t)return;let i;if(t==="parent"){let s=(r=(n=e==null?void 0:e.proxy)==null?void 0:n.$el)==null?void 0:r.parentNode;for(;s!=null&&s.hasAttribute("data-no-activator");)s=s.parentNode;i=s}else typeof t=="string"?i=document.querySelector(t):"$el"in t?i=t.$el:i=t;return i}const vP=["sm","md","lg","xl","xxl"],dk=Symbol.for("vuetify:display"),CI={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},Fq=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:CI;return qo(CI,t)};function MI(t){return un&&!t?window.innerWidth:typeof t=="object"&&t.clientWidth||0}function AI(t){return un&&!t?window.innerHeight:typeof t=="object"&&t.clientHeight||0}function VI(t){const e=un&&!t?window.navigator.userAgent:"ssr";function i(m){return!!e.match(m)}const n=i(/android/i),r=i(/iphone|ipad|ipod/i),s=i(/cordova/i),o=i(/electron/i),a=i(/chrome/i),l=i(/edge/i),c=i(/firefox/i),u=i(/opera/i),h=i(/win/i),d=i(/mac/i),f=i(/linux/i);return{android:n,ios:r,cordova:s,electron:o,chrome:a,edge:l,firefox:c,opera:u,win:h,mac:d,linux:f,touch:j9,ssr:e==="ssr"}}function zq(t,e){const{thresholds:i,mobileBreakpoint:n}=Fq(t),r=_t(AI(e)),s=_t(VI(e)),o=$r({}),a=_t(MI(e));function l(){r.value=AI(),a.value=MI()}function c(){l(),s.value=VI()}return Oa(()=>{const u=a.value<i.sm,h=a.value<i.md&&!u,d=a.value<i.lg&&!(h||u),f=a.value<i.xl&&!(d||h||u),m=a.value<i.xxl&&!(f||d||h||u),g=a.value>=i.xxl,v=u?"xs":h?"sm":d?"md":f?"lg":m?"xl":"xxl",p=typeof n=="number"?n:i[n],b=a.value<p;o.xs=u,o.sm=h,o.md=d,o.lg=f,o.xl=m,o.xxl=g,o.smAndUp=!u,o.mdAndUp=!(u||h),o.lgAndUp=!(u||h||d),o.xlAndUp=!(u||h||d||f),o.smAndDown=!(d||f||m||g),o.mdAndDown=!(f||m||g),o.lgAndDown=!(m||g),o.xlAndDown=!g,o.name=v,o.height=r.value,o.width=a.value,o.mobile=b,o.mobileBreakpoint=n,o.platform=s.value,o.thresholds=i}),un&&window.addEventListener("resize",l,{passive:!0}),{...iP(o),update:c,ssr:!!e}}const wB=We({mobileBreakpoint:[Number,String]},"display");function Dp(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sc();const i=xi(dk);if(!i)throw new Error("Could not find Vuetify display injection");const n=W(()=>{if(!t.mobileBreakpoint)return i.mobile.value;const s=typeof t.mobileBreakpoint=="number"?t.mobileBreakpoint:i.thresholds.value[t.mobileBreakpoint];return i.width.value<s}),r=W(()=>e?{[`${e}--mobile`]:n.value}:{});return{...i,displayClasses:r,mobile:n}}function Uq(){if(!un)return _t(!1);const{ssr:t}=Dp();if(t){const e=_t(!1);return ki(()=>{e.value=!0}),e}else return _t(!0)}const yP=We({eager:Boolean},"lazy");function mM(t,e){const i=_t(!1),n=W(()=>i.value||t.eager||e.value);He(e,()=>i.value=!0);function r(){t.eager||(i.value=!1)}return{isBooted:i,hasContent:n,onAfterLeave:r}}function Np(){const e=br("useScopeId").vnode.scopeId;return{scopeId:e?{[e]:""}:void 0}}const LI=Symbol.for("vuetify:stack"),dg=$r([]);function Bq(t,e,i){const n=br("useStack"),r=!i,s=xi(LI,void 0),o=$r({activeChildren:new Set});jn(LI,o);const a=_t(+e.value);ec(t,()=>{var h;const u=(h=dg.at(-1))==null?void 0:h[1];a.value=u?u+10:+e.value,r&&dg.push([n.uid,a.value]),s==null||s.activeChildren.add(n.uid),ls(()=>{if(r){const d=hi(dg).findIndex(f=>f[0]===n.uid);dg.splice(d,1)}s==null||s.activeChildren.delete(n.uid)})});const l=_t(!0);r&&Oa(()=>{var h;const u=((h=dg.at(-1))==null?void 0:h[0])===n.uid;setTimeout(()=>l.value=u)});const c=W(()=>!o.activeChildren.size);return{globalTop:Vp(l),localTop:c,stackStyles:W(()=>({zIndex:a.value}))}}function jq(t){return{teleportTarget:W(()=>{const i=t.value;if(i===!0||!un)return;const n=i===!1?document.body:typeof i=="string"?document.querySelector(i):i;if(n==null)return;let r=n.querySelector(":scope > .v-overlay-container");return r||(r=document.createElement("div"),r.className="v-overlay-container",n.appendChild(r)),r})}}function $q(){return!0}function TB(t,e,i){if(!t||xB(t,i)===!1)return!1;const n=UU(e);if(typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&n.host===t.target)return!1;const r=(typeof i.value=="object"&&i.value.include||(()=>[]))();return r.push(e),!r.some(s=>s==null?void 0:s.contains(t.target))}function xB(t,e){return(typeof e.value=="object"&&e.value.closeConditional||$q)(t)}function Wq(t,e,i){const n=typeof i.value=="function"?i.value:i.value.handler;e._clickOutside.lastMousedownWasOutside&&TB(t,e,i)&&setTimeout(()=>{xB(t,i)&&n&&n(t)},0)}function II(t,e){const i=UU(t);e(document),typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&e(i)}const Gq={mounted(t,e){const i=r=>Wq(r,t,e),n=r=>{t._clickOutside.lastMousedownWasOutside=TB(r,t,e)};II(t,r=>{r.addEventListener("click",i,!0),r.addEventListener("mousedown",n,!0)}),t._clickOutside||(t._clickOutside={lastMousedownWasOutside:!1}),t._clickOutside[e.instance.$.uid]={onClick:i,onMousedown:n}},unmounted(t,e){t._clickOutside&&(II(t,i=>{var s;if(!i||!((s=t._clickOutside)!=null&&s[e.instance.$.uid]))return;const{onClick:n,onMousedown:r}=t._clickOutside[e.instance.$.uid];i.removeEventListener("click",n,!0),i.removeEventListener("mousedown",r,!0)}),delete t._clickOutside[e.instance.$.uid])}};function Hq(t){const{modelValue:e,color:i,...n}=t;return w(xo,{name:"fade-transition",appear:!0},{default:()=>[t.modelValue&&w("div",ht({class:["v-overlay__scrim",t.color.backgroundColorClasses.value],style:t.color.backgroundColorStyles.value},n),null)]})}const Ny=We({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...Dq(),...Ut(),...bh(),...yP(),...wq(),...Aq(),...wn(),...af()},"VOverlay"),dc=vt()({name:"VOverlay",directives:{ClickOutside:Gq},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,...Ny()},emits:{"click:outside":t=>!0,"update:modelValue":t=>!0,afterLeave:()=>!0},setup(t,e){let{slots:i,attrs:n,emit:r}=e;const s=Oi(t,"modelValue"),o=W({get:()=>s.value,set:Q=>{Q&&t.disabled||(s.value=Q)}}),{teleportTarget:a}=jq(W(()=>t.attach||t.contained)),{themeClasses:l}=Hn(t),{rtlClasses:c,isRtl:u}=io(),{hasContent:h,onAfterLeave:d}=mM(t,o),f=Cs(W(()=>typeof t.scrim=="string"?t.scrim:null)),{globalTop:m,localTop:g,stackStyles:v}=Bq(o,bt(t,"zIndex"),t._disableGlobalStack),{activatorEl:p,activatorRef:b,target:_,targetEl:P,targetRef:E,activatorEvents:T,contentEvents:C,scrimEvents:M}=Nq(t,{isActive:o,isTop:g}),{dimensionStyles:x}=_h(t),V=Uq(),{scopeId:N}=Np();He(()=>t.disabled,Q=>{Q&&(o.value=!1)});const D=ge(),O=ge(),{contentStyles:F,updateLocation:X}=Tq(t,{isRtl:u,contentEl:O,target:_,isActive:o});Vq(t,{root:D,contentEl:O,targetEl:P,isActive:o,updateLocation:X});function Z(Q){r("click:outside",Q),t.persistent?ne():o.value=!1}function K(){return o.value&&m.value}un&&He(o,Q=>{Q?window.addEventListener("keydown",z):window.removeEventListener("keydown",z)},{immediate:!0}),an(()=>{un&&window.removeEventListener("keydown",z)});function z(Q){var fe,ie;Q.key==="Escape"&&m.value&&(t.persistent?ne():(o.value=!1,(fe=O.value)!=null&&fe.contains(document.activeElement)&&((ie=p.value)==null||ie.focus())))}const H=eB();ec(()=>t.closeOnBack,()=>{rq(H,Q=>{m.value&&o.value?(Q(!1),t.persistent?ne():o.value=!1):Q()})});const re=ge();He(()=>o.value&&(t.absolute||t.contained)&&a.value==null,Q=>{if(Q){const fe=jU(D.value);fe&&fe!==document.scrollingElement&&(re.value=fe.scrollTop)}});function ne(){t.noClickAnimation||O.value&&pd(O.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:xv})}function B(){d(),r("afterLeave")}return Tt(()=>{var Q;return w(mt,null,[(Q=i.activator)==null?void 0:Q.call(i,{isActive:o.value,props:ht({ref:b,targetRef:E},T.value,t.activatorProps)}),!t.disabled&&V.value&&h.value&&w(X6,{disabled:!a.value,to:a.value},{default:()=>[w("div",ht({class:["v-overlay",{"v-overlay--absolute":t.absolute||t.contained,"v-overlay--active":o.value,"v-overlay--contained":t.contained},l.value,c.value,t.class],style:[v.value,{top:Lt(re.value)},t.style],ref:D},N,n),[w(Hq,ht({color:f,modelValue:!!t.scrim&&o.value},M.value),null),w(Gl,{appear:!0,persisted:!0,transition:t.transition,target:_.value,onAfterLeave:B},{default:()=>{var fe;return[fi(w("div",ht({ref:O,class:["v-overlay__content",t.contentClass],style:[x.value,F.value]},C.value,t.contentProps),[(fe=i.default)==null?void 0:fe.call(i,{isActive:o})]),[[ln,o.value],[Mo("click-outside"),{handler:Z,closeConditional:K,include:()=>[p.value]}]])]}})])]})])}),{activatorEl:p,target:_,animateClick:ne,contentEl:O,globalTop:m,localTop:g,updateLocation:X}}}),xw=Symbol("Forwarded refs");function kw(t,e){let i=t;for(;i;){const n=Reflect.getOwnPropertyDescriptor(i,e);if(n)return n;i=Object.getPrototypeOf(i)}}function _c(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return t[xw]=i,new Proxy(t,{get(r,s){if(Reflect.has(r,s))return Reflect.get(r,s);if(!(typeof s=="symbol"||s.startsWith("$")||s.startsWith("__"))){for(const o of i)if(o.value&&Reflect.has(o.value,s)){const a=Reflect.get(o.value,s);return typeof a=="function"?a.bind(o.value):a}}},has(r,s){if(Reflect.has(r,s))return!0;if(typeof s=="symbol"||s.startsWith("$")||s.startsWith("__"))return!1;for(const o of i)if(o.value&&Reflect.has(o.value,s))return!0;return!1},set(r,s,o){if(Reflect.has(r,s))return Reflect.set(r,s,o);if(typeof s=="symbol"||s.startsWith("$")||s.startsWith("__"))return!1;for(const a of i)if(a.value&&Reflect.has(a.value,s))return Reflect.set(a.value,s,o);return!1},getOwnPropertyDescriptor(r,s){var a;const o=Reflect.getOwnPropertyDescriptor(r,s);if(o)return o;if(!(typeof s=="symbol"||s.startsWith("$")||s.startsWith("__"))){for(const l of i){if(!l.value)continue;const c=kw(l.value,s)??("_"in l.value?kw((a=l.value._)==null?void 0:a.setupState,s):void 0);if(c)return c}for(const l of i){const c=l.value&&l.value[xw];if(!c)continue;const u=c.slice();for(;u.length;){const h=u.shift(),d=kw(h.value,s);if(d)return d;const f=h.value&&h.value[xw];f&&u.push(...f)}}}}})}const qq=We({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...Ny({origin:"center center",scrollStrategy:"block",transition:{component:fM},zIndex:2400})},"VDialog"),Kq=vt()({name:"VDialog",props:qq(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const n=Oi(t,"modelValue"),{scopeId:r}=Np(),s=ge();function o(l){var h,d;const c=l.relatedTarget,u=l.target;if(c!==u&&((h=s.value)!=null&&h.contentEl)&&((d=s.value)!=null&&d.globalTop)&&![document,s.value.contentEl].includes(u)&&!s.value.contentEl.contains(u)){const f=Tv(s.value.contentEl);if(!f.length)return;const m=f[0],g=f[f.length-1];c===m?g.focus():m.focus()}}un&&He(()=>n.value&&t.retainFocus,l=>{l?document.addEventListener("focusin",o):document.removeEventListener("focusin",o)},{immediate:!0}),He(n,async l=>{var c,u;await vn(),l?(c=s.value.contentEl)==null||c.focus({preventScroll:!0}):(u=s.value.activatorEl)==null||u.focus({preventScroll:!0})});const a=W(()=>ht({"aria-haspopup":"dialog","aria-expanded":String(n.value)},t.activatorProps));return Tt(()=>{const l=dc.filterProps(t);return w(dc,ht({ref:s,class:["v-dialog",{"v-dialog--fullscreen":t.fullscreen,"v-dialog--scrollable":t.scrollable},t.class],style:t.style},l,{modelValue:n.value,"onUpdate:modelValue":c=>n.value=c,"aria-modal":"true",activatorProps:a.value,role:"dialog"},r),{activator:i.activator,default:function(){for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];return w(rr,{root:"VDialog"},{default:()=>{var d;return[(d=i.default)==null?void 0:d.call(i,...u)]}})}})}),_c({},s)}});const Xq=We({color:String,inset:Boolean,length:[Number,String],thickness:[Number,String],vertical:Boolean,...Ut(),...wn()},"VDivider"),ch=vt()({name:"VDivider",props:Xq(),setup(t,e){let{attrs:i}=e;const{themeClasses:n}=Hn(t),{textColorClasses:r,textColorStyles:s}=ko(bt(t,"color")),o=W(()=>{const a={};return t.length&&(a[t.vertical?"maxHeight":"maxWidth"]=Lt(t.length)),t.thickness&&(a[t.vertical?"borderRightWidth":"borderTopWidth"]=Lt(t.thickness)),a});return Tt(()=>w("hr",{class:[{"v-divider":!0,"v-divider--inset":t.inset,"v-divider--vertical":t.vertical},n.value,r.value,t.class],style:[o.value,s.value,t.style],"aria-orientation":!i.role||i.role==="separator"?t.vertical?"vertical":"horizontal":void 0,role:`${i.role||"separator"}`},null)),{}}});const Yq=We({fluid:{type:Boolean,default:!1},...Ut(),...pn()},"VContainer"),Ph=vt()({name:"VContainer",props:Yq(),setup(t,e){let{slots:i}=e;const{rtlClasses:n}=io();return Tt(()=>w(t.tag,{class:["v-container",{"v-container--fluid":t.fluid},n.value,t.class],style:t.style},i)),{}}}),kB=(()=>vP.reduce((t,e)=>(t[e]={type:[Boolean,String,Number],default:!1},t),{}))(),CB=(()=>vP.reduce((t,e)=>{const i="offset"+vh(e);return t[i]={type:[String,Number],default:null},t},{}))(),MB=(()=>vP.reduce((t,e)=>{const i="order"+vh(e);return t[i]={type:[String,Number],default:null},t},{}))(),OI={col:Object.keys(kB),offset:Object.keys(CB),order:Object.keys(MB)};function Zq(t,e,i){let n=t;if(!(i==null||i===!1)){if(e){const r=e.replace(t,"");n+=`-${r}`}return t==="col"&&(n="v-"+n),t==="col"&&(i===""||i===!0)||(n+=`-${i}`),n.toLowerCase()}}const Jq=["auto","start","end","center","baseline","stretch"],Qq=We({cols:{type:[Boolean,String,Number],default:!1},...kB,offset:{type:[String,Number],default:null},...CB,order:{type:[String,Number],default:null},...MB,alignSelf:{type:String,default:null,validator:t=>Jq.includes(t)},...Ut(),...pn()},"VCol"),Si=vt()({name:"VCol",props:Qq(),setup(t,e){let{slots:i}=e;const n=W(()=>{const r=[];let s;for(s in OI)OI[s].forEach(a=>{const l=t[a],c=Zq(s,a,l);c&&r.push(c)});const o=r.some(a=>a.startsWith("v-col-"));return r.push({"v-col":!o||!t.cols,[`v-col-${t.cols}`]:t.cols,[`offset-${t.offset}`]:t.offset,[`order-${t.order}`]:t.order,[`align-self-${t.alignSelf}`]:t.alignSelf}),r});return()=>{var r;return ia(t.tag,{class:[n.value,t.class],style:t.style},(r=i.default)==null?void 0:r.call(i))}}}),pM=["start","end","center"],AB=["space-between","space-around","space-evenly"];function gM(t,e){return vP.reduce((i,n)=>{const r=t+vh(n);return i[r]=e(),i},{})}const eK=[...pM,"baseline","stretch"],VB=t=>eK.includes(t),LB=gM("align",()=>({type:String,default:null,validator:VB})),tK=[...pM,...AB],IB=t=>tK.includes(t),OB=gM("justify",()=>({type:String,default:null,validator:IB})),iK=[...pM,...AB,"stretch"],DB=t=>iK.includes(t),NB=gM("alignContent",()=>({type:String,default:null,validator:DB})),DI={align:Object.keys(LB),justify:Object.keys(OB),alignContent:Object.keys(NB)},nK={align:"align",justify:"justify",alignContent:"align-content"};function rK(t,e,i){let n=nK[t];if(i!=null){if(e){const r=e.replace(t,"");n+=`-${r}`}return n+=`-${i}`,n.toLowerCase()}}const sK=We({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:VB},...LB,justify:{type:String,default:null,validator:IB},...OB,alignContent:{type:String,default:null,validator:DB},...NB,...Ut(),...pn()},"VRow"),pr=vt()({name:"VRow",props:sK(),setup(t,e){let{slots:i}=e;const n=W(()=>{const r=[];let s;for(s in DI)DI[s].forEach(o=>{const a=t[o],l=rK(s,o,a);l&&r.push(l)});return r.push({"v-row--no-gutters":t.noGutters,"v-row--dense":t.dense,[`align-${t.align}`]:t.align,[`justify-${t.justify}`]:t.justify,[`align-content-${t.alignContent}`]:t.alignContent}),r});return()=>{var r;return ia(t.tag,{class:["v-row",n.value,t.class],style:t.style},(r=i.default)==null?void 0:r.call(i))}}}),Ry=Qd("v-spacer","div","VSpacer"),xu=ri({__name:"Dialog",props:{title:{},yesText:{},yesAction:{type:Function},noText:{},noAction:{type:Function},isDisabled:{type:Boolean}},setup(t,{expose:e}){const i=vU(),n=t;e({show:o,hide:a});const r=ge(!1),s=W(()=>n.yesText??"Yes");W(()=>n.noText??"No");function o(){r.value=!0}function a(){r.value=!1}function l(){console.debug("Calling hideLast()"),i.hideLastDialog()||a()}function c(){l(),n.yesAction&&n.yesAction()}function u(){l(),n.noAction&&n.noAction()}return(h,d)=>(Te(),qe(Kq,ht(h.$attrs,{modelValue:r.value,"onUpdate:modelValue":d[2]||(d[2]=f=>r.value=f),transition:"dialog-transition"}),{default:U(()=>[w(uc,{elevation:"2"},{default:U(()=>[w(gP,{id:"_test_title"},{default:U(()=>[$e(nt(h.title),1)],void 0,!0),_:1}),w(ch),w(lh,null,{default:U(()=>[Ma(h.$slots,"default")],void 0,!0),_:3}),w(ch),w(Op,null,{default:U(()=>[w(Ry),w(Qt,{id:"_test_posButton",disabled:h.isDisabled,color:"primary",onClick:d[0]||(d[0]=f=>c())},{default:U(()=>[$e(nt(s.value),1)],void 0,!0),_:1},8,["disabled"]),h.noText?(Te(),qe(Qt,{key:0,id:"_test_negButton",color:"secondary",onClick:d[1]||(d[1]=f=>u())},{default:U(()=>[$e(nt(h.noText),1)],void 0,!0),_:1})):Vi("",!0)],void 0,!0),_:1})],void 0,!0),_:3})],void 0),_:3},16,["modelValue"]))}});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RB=function(t){const e=[];let i=0;for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<128?e[i++]=r:r<2048?(e[i++]=r>>6|192,e[i++]=r&63|128):(r&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++n)&1023),e[i++]=r>>18|240,e[i++]=r>>12&63|128,e[i++]=r>>6&63|128,e[i++]=r&63|128):(e[i++]=r>>12|224,e[i++]=r>>6&63|128,e[i++]=r&63|128)}return e},oK=function(t){const e=[];let i=0,n=0;for(;i<t.length;){const r=t[i++];if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[i++];e[n++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=t[i++],o=t[i++],a=t[i++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[i++],o=t[i++];e[n++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},FB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const i=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<t.length;r+=3){const s=t[r],o=r+1<t.length,a=o?t[r+1]:0,l=r+2<t.length,c=l?t[r+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(d=64)),n.push(i[u],i[h],i[d],i[f])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(RB(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):oK(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const i=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<t.length;){const s=i[t.charAt(r++)],a=r<t.length?i[t.charAt(r)]:0;++r;const c=r<t.length?i[t.charAt(r)]:64;++r;const h=r<t.length?i[t.charAt(r)]:64;if(++r,s==null||a==null||c==null||h==null)throw new aK;const d=s<<2|a>>4;if(n.push(d),c!==64){const f=a<<4&240|c>>2;if(n.push(f),h!==64){const m=c<<6&192|h;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class aK extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const lK=function(t){const e=RB(t);return FB.encodeByteArray(e,!0)},Y0=function(t){return lK(t).replace(/\./g,"")},zB=function(t){try{return FB.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cK(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hK=()=>cK().__FIREBASE_DEFAULTS__,uK=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},dK=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&zB(t[1]);return e&&JSON.parse(e)},SP=()=>{try{return hK()||uK()||dK()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},UB=t=>{var e,i;return(i=(e=SP())===null||e===void 0?void 0:e.emulatorHosts)===null||i===void 0?void 0:i[t]},BB=t=>{const e=UB(t);if(!e)return;const i=e.lastIndexOf(":");if(i<=0||i+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(i+1),10);return e[0]==="["?[e.substring(1,i-1),n]:[e.substring(0,i),n]},jB=()=>{var t;return(t=SP())===null||t===void 0?void 0:t.config},$B=t=>{var e;return(e=SP())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fK{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}wrapCallback(e){return(i,n)=>{i?this.reject(i):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(i):e(i,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WB(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i={alg:"none",type:"JWT"},n=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Y0(JSON.stringify(i)),Y0(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function mK(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ms())}function pK(){var t;const e=(t=SP())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function gK(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function vK(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yK(){const t=Ms();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function SK(){try{return typeof indexedDB=="object"}catch{return!1}}function bK(){return new Promise((t,e)=>{try{let i=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),i||self.indexedDB.deleteDatabase(n),t(!0)},r.onupgradeneeded=()=>{i=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(i){e(i)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _K="FirebaseError";class Pc extends Error{constructor(e,i,n){super(i),this.code=e,this.customData=n,this.name=_K,Object.setPrototypeOf(this,Pc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fy.prototype.create)}}class Fy{constructor(e,i,n){this.service=e,this.serviceName=i,this.errors=n}create(e,...i){const n=i[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?PK(s,n):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Pc(r,a,n)}}function PK(t,e){return t.replace(EK,(i,n)=>{const r=e[n];return r!=null?String(r):`<${n}?>`})}const EK=/\{\$([^}]+)}/g;function wK(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Z0(t,e){if(t===e)return!0;const i=Object.keys(t),n=Object.keys(e);for(const r of i){if(!n.includes(r))return!1;const s=t[r],o=e[r];if(NI(s)&&NI(o)){if(!Z0(s,o))return!1}else if(s!==o)return!1}for(const r of n)if(!i.includes(r))return!1;return!0}function NI(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zy(t){const e=[];for(const[i,n]of Object.entries(t))Array.isArray(n)?n.forEach(r=>{e.push(encodeURIComponent(i)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(i)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Lg(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[r,s]=n.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function Ig(t){const e=t.indexOf("?");if(!e)return"";const i=t.indexOf("#",e);return t.substring(e,i>0?i:void 0)}function TK(t,e){const i=new xK(t,e);return i.subscribe.bind(i)}class xK{constructor(e,i){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=i,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(i=>{i.next(e)})}error(e){this.forEachObserver(i=>{i.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,i,n){let r;if(e===void 0&&i===void 0&&n===void 0)throw new Error("Missing Observer.");kK(e,["next","error","complete"])?r=e:r={next:e,error:i,complete:n},r.next===void 0&&(r.next=Cw),r.error===void 0&&(r.error=Cw),r.complete===void 0&&(r.complete=Cw);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let i=0;i<this.observers.length;i++)this.sendOne(i,e)}sendOne(e,i){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{i(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function kK(t,e){if(typeof t!="object"||t===null)return!1;for(const i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}function Cw(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(t){return t&&t._delegate?t._delegate:t}class ku{constructor(e,i,n){this.name=e,this.instanceFactory=i,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sd="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CK{constructor(e,i){this.name=e,this.container=i,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const i=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(i)){const n=new fK;if(this.instancesDeferred.set(i,n),this.isInitialized(i)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:i});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(i).promise}getImmediate(e){var i;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(i=e==null?void 0:e.optional)!==null&&i!==void 0?i:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AK(e))try{this.getOrInitializeService({instanceIdentifier:sd})}catch{}for(const[i,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(i);try{const s=this.getOrInitializeService({instanceIdentifier:r});n.resolve(s)}catch{}}}}clearInstance(e=sd){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...e.filter(i=>"_delete"in i).map(i=>i._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sd){return this.instances.has(e)}getOptions(e=sd){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:i={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:i});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);n===a&&o.resolve(r)}return r}onInit(e,i){var n;const r=this.normalizeInstanceIdentifier(i),s=(n=this.onInitCallbacks.get(r))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,i){const n=this.onInitCallbacks.get(i);if(n)for(const r of n)try{r(e,i)}catch{}}getOrInitializeService({instanceIdentifier:e,options:i={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:MK(e),options:i}),this.instances.set(e,n),this.instancesOptions.set(e,i),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=sd){return this.component?this.component.multipleInstances?e:sd:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function MK(t){return t===sd?void 0:t}function AK(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VK{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const i=this.getProvider(e.name);if(i.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);i.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const i=new CK(e,this);return this.providers.set(e,i),i}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gi;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Gi||(Gi={}));const LK={debug:Gi.DEBUG,verbose:Gi.VERBOSE,info:Gi.INFO,warn:Gi.WARN,error:Gi.ERROR,silent:Gi.SILENT},IK=Gi.INFO,OK={[Gi.DEBUG]:"log",[Gi.VERBOSE]:"log",[Gi.INFO]:"info",[Gi.WARN]:"warn",[Gi.ERROR]:"error"},DK=(t,e,...i)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),r=OK[e];if(r)console[r](`[${n}]  ${t.name}:`,...i);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class vM{constructor(e){this.name=e,this._logLevel=IK,this._logHandler=DK,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Gi))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?LK[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Gi.DEBUG,...e),this._logHandler(this,Gi.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Gi.VERBOSE,...e),this._logHandler(this,Gi.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Gi.INFO,...e),this._logHandler(this,Gi.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Gi.WARN,...e),this._logHandler(this,Gi.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Gi.ERROR,...e),this._logHandler(this,Gi.ERROR,...e)}}const NK=(t,e)=>e.some(i=>t instanceof i);let RI,FI;function RK(){return RI||(RI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function FK(){return FI||(FI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const GB=new WeakMap,fk=new WeakMap,HB=new WeakMap,Mw=new WeakMap,yM=new WeakMap;function zK(t){const e=new Promise((i,n)=>{const r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{i(vu(t.result)),r()},o=()=>{n(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(i=>{i instanceof IDBCursor&&GB.set(i,t)}).catch(()=>{}),yM.set(e,t),e}function UK(t){if(fk.has(t))return;const e=new Promise((i,n)=>{const r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{i(),r()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});fk.set(t,e)}let mk={get(t,e,i){if(t instanceof IDBTransaction){if(e==="done")return fk.get(t);if(e==="objectStoreNames")return t.objectStoreNames||HB.get(t);if(e==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return vu(t[e])},set(t,e,i){return t[e]=i,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function BK(t){mk=t(mk)}function jK(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...i){const n=t.call(Aw(this),e,...i);return HB.set(n,e.sort?e.sort():[e]),vu(n)}:FK().includes(t)?function(...e){return t.apply(Aw(this),e),vu(GB.get(this))}:function(...e){return vu(t.apply(Aw(this),e))}}function $K(t){return typeof t=="function"?jK(t):(t instanceof IDBTransaction&&UK(t),NK(t,RK())?new Proxy(t,mk):t)}function vu(t){if(t instanceof IDBRequest)return zK(t);if(Mw.has(t))return Mw.get(t);const e=$K(t);return e!==t&&(Mw.set(t,e),yM.set(e,t)),e}const Aw=t=>yM.get(t);function WK(t,e,{blocked:i,upgrade:n,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=vu(o);return n&&o.addEventListener("upgradeneeded",l=>{n(vu(o.result),l.oldVersion,l.newVersion,vu(o.transaction),l)}),i&&o.addEventListener("blocked",l=>i(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const GK=["get","getKey","getAll","getAllKeys","count"],HK=["put","add","delete","clear"],Vw=new Map;function zI(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Vw.get(e))return Vw.get(e);const i=e.replace(/FromIndex$/,""),n=e!==i,r=HK.includes(i);if(!(i in(n?IDBIndex:IDBObjectStore).prototype)||!(r||GK.includes(i)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(a.shift())),(await Promise.all([c[i](...a),r&&l.done]))[0]};return Vw.set(e,s),s}BK(t=>({...t,get:(e,i,n)=>zI(e,i)||t.get(e,i,n),has:(e,i)=>!!zI(e,i)||t.has(e,i)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qK{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(i=>{if(KK(i)){const n=i.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(i=>i).join(" ")}}function KK(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const pk="@firebase/app",UI="0.9.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd=new vM("@firebase/app"),XK="@firebase/app-compat",YK="@firebase/analytics-compat",ZK="@firebase/analytics",JK="@firebase/app-check-compat",QK="@firebase/app-check",eX="@firebase/auth",tX="@firebase/auth-compat",iX="@firebase/database",nX="@firebase/database-compat",rX="@firebase/functions",sX="@firebase/functions-compat",oX="@firebase/installations",aX="@firebase/installations-compat",lX="@firebase/messaging",cX="@firebase/messaging-compat",hX="@firebase/performance",uX="@firebase/performance-compat",dX="@firebase/remote-config",fX="@firebase/remote-config-compat",mX="@firebase/storage",pX="@firebase/storage-compat",gX="@firebase/firestore",vX="@firebase/firestore-compat",yX="firebase",SX="9.23.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk="[DEFAULT]",bX={[pk]:"fire-core",[XK]:"fire-core-compat",[ZK]:"fire-analytics",[YK]:"fire-analytics-compat",[QK]:"fire-app-check",[JK]:"fire-app-check-compat",[eX]:"fire-auth",[tX]:"fire-auth-compat",[iX]:"fire-rtdb",[nX]:"fire-rtdb-compat",[rX]:"fire-fn",[sX]:"fire-fn-compat",[oX]:"fire-iid",[aX]:"fire-iid-compat",[lX]:"fire-fcm",[cX]:"fire-fcm-compat",[hX]:"fire-perf",[uX]:"fire-perf-compat",[dX]:"fire-rc",[fX]:"fire-rc-compat",[mX]:"fire-gcs",[pX]:"fire-gcs-compat",[gX]:"fire-fst",[vX]:"fire-fst-compat","fire-js":"fire-js",[yX]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0=new Map,vk=new Map;function _X(t,e){try{t.container.addComponent(e)}catch(i){Fd.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,i)}}function zd(t){const e=t.name;if(vk.has(e))return Fd.debug(`There were multiple attempts to register component ${e}.`),!1;vk.set(e,t);for(const i of J0.values())_X(i,t);return!0}function bP(t,e){const i=t.container.getProvider("heartbeat").getImmediate({optional:!0});return i&&i.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PX={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},yu=new Fy("app","Firebase",PX);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EX{constructor(e,i,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},i),this._name=i.name,this._automaticDataCollectionEnabled=i.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ku("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yu.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf=SX;function qB(t,e={}){let i=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:gk,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw yu.create("bad-app-name",{appName:String(r)});if(i||(i=jB()),!i)throw yu.create("no-options");const s=J0.get(r);if(s){if(Z0(i,s.options)&&Z0(n,s.config))return s;throw yu.create("duplicate-app",{appName:r})}const o=new VK(r);for(const l of vk.values())o.addComponent(l);const a=new EX(i,n,o);return J0.set(r,a),a}function SM(t=gk){const e=J0.get(t);if(!e&&t===gk&&jB())return qB();if(!e)throw yu.create("no-app",{appName:t});return e}function tc(t,e,i){var n;let r=(n=bX[t])!==null&&n!==void 0?n:t;i&&(r+=`-${i}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fd.warn(a.join(" "));return}zd(new ku(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wX="firebase-heartbeat-database",TX=1,Av="firebase-heartbeat-store";let Lw=null;function KB(){return Lw||(Lw=WK(wX,TX,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Av)}}}).catch(t=>{throw yu.create("idb-open",{originalErrorMessage:t.message})})),Lw}async function xX(t){try{return await(await KB()).transaction(Av).objectStore(Av).get(XB(t))}catch(e){if(e instanceof Pc)Fd.warn(e.message);else{const i=yu.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Fd.warn(i.message)}}}async function BI(t,e){try{const n=(await KB()).transaction(Av,"readwrite");await n.objectStore(Av).put(e,XB(t)),await n.done}catch(i){if(i instanceof Pc)Fd.warn(i.message);else{const n=yu.create("idb-set",{originalErrorMessage:i==null?void 0:i.message});Fd.warn(n.message)}}}function XB(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kX=1024,CX=30*24*60*60*1e3;class MX{constructor(e){this.container=e,this._heartbeatsCache=null;const i=this.container.getProvider("app").getImmediate();this._storage=new VX(i),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=jI();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(r=>r.date===n)))return this._heartbeatsCache.heartbeats.push({date:n,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const s=new Date(r.date).valueOf();return Date.now()-s<=CX}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=jI(),{heartbeatsToSend:i,unsentEntries:n}=AX(this._heartbeatsCache.heartbeats),r=Y0(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function jI(){return new Date().toISOString().substring(0,10)}function AX(t,e=kX){const i=[];let n=t.slice();for(const r of t){const s=i.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),$I(i)>e){s.dates.pop();break}}else if(i.push({agent:r.agent,dates:[r.date]}),$I(i)>e){i.pop();break}n=n.slice(1)}return{heartbeatsToSend:i,unsentEntries:n}}class VX{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return SK()?bK().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await xX(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var i;if(await this._canUseIndexedDBPromise){const r=await this.read();return BI(this.app,{lastSentHeartbeatDate:(i=e.lastSentHeartbeatDate)!==null&&i!==void 0?i:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var i;if(await this._canUseIndexedDBPromise){const r=await this.read();return BI(this.app,{lastSentHeartbeatDate:(i=e.lastSentHeartbeatDate)!==null&&i!==void 0?i:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function $I(t){return Y0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LX(t){zd(new ku("platform-logger",e=>new qK(e),"PRIVATE")),zd(new ku("heartbeat",e=>new MX(e),"PRIVATE")),tc(pk,UI,t),tc(pk,UI,"esm2017"),tc("fire-js","")}LX("");function bM(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i}function YB(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const IX=YB,ZB=new Fy("auth","Firebase",YB());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=new vM("@firebase/auth");function OX(t,...e){Q0.logLevel<=Gi.WARN&&Q0.warn(`Auth (${lf}): ${t}`,...e)}function l0(t,...e){Q0.logLevel<=Gi.ERROR&&Q0.error(`Auth (${lf}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Da(t,...e){throw _M(t,...e)}function ic(t,...e){return _M(t,...e)}function JB(t,e,i){const n=Object.assign(Object.assign({},IX()),{[e]:i});return new Fy("auth","Firebase",n).create(e,{appName:t.name})}function DX(t,e,i){const n=i;if(!(e instanceof n))throw n.name!==e.constructor.name&&Da(t,"argument-error"),JB(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function _M(t,...e){if(typeof t!="string"){const i=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(i,...n)}return ZB.create(t,...e)}function qt(t,e,...i){if(!t)throw _M(e,...i)}function $c(t){const e="INTERNAL ASSERTION FAILED: "+t;throw l0(e),new Error(e)}function hh(t,e){t||$c(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yk(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function NX(){return WI()==="http:"||WI()==="https:"}function WI(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RX(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(NX()||gK()||"connection"in navigator)?navigator.onLine:!0}function FX(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,i){this.shortDelay=e,this.longDelay=i,hh(i>e,"Short delay should be less than long delay!"),this.isMobile=mK()||vK()}get(){return RX()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PM(t,e){hh(t.emulator,"Emulator should always be set here");const{url:i}=t.emulator;return e?`${i}${e.startsWith("/")?e.slice(1):e}`:i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QB{static initialize(e,i,n){this.fetchImpl=e,i&&(this.headersImpl=i),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;$c("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;$c("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;$c("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zX={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UX=new Uy(3e4,6e4);function cf(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function hf(t,e,i,n,r={}){return e3(t,r,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const a=zy(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),QB.fetch()(t3(t,t.config.apiHost,i,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},s))})}async function e3(t,e,i){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},zX),e);try{const r=new BX(t),s=await Promise.race([i(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw BS(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw BS(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw BS(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw BS(t,"user-disabled",o);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw JB(t,u,c);Da(t,u)}}catch(r){if(r instanceof Pc)throw r;Da(t,"network-request-failed",{message:String(r)})}}async function By(t,e,i,n,r={}){const s=await hf(t,e,i,n,r);return"mfaPendingCredential"in s&&Da(t,"multi-factor-auth-required",{_serverResponse:s}),s}function t3(t,e,i,n){const r=`${e}${i}?${n}`;return t.config.emulator?PM(t.config,r):`${t.config.apiScheme}://${r}`}class BX{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((i,n)=>{this.timer=setTimeout(()=>n(ic(this.auth,"network-request-failed")),UX.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function BS(t,e,i){const n={appName:t.name};i.email&&(n.email=i.email),i.phoneNumber&&(n.phoneNumber=i.phoneNumber);const r=ic(t,e,n);return r.customData._tokenResponse=i,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jX(t,e){return hf(t,"POST","/v1/accounts:delete",e)}async function $X(t,e){return hf(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function WX(t,e=!1){const i=Nn(t),n=await i.getIdToken(e),r=EM(n);qt(r&&r.exp&&r.auth_time&&r.iat,i.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:n,authTime:qg(Iw(r.auth_time)),issuedAtTime:qg(Iw(r.iat)),expirationTime:qg(Iw(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Iw(t){return Number(t)*1e3}function EM(t){const[e,i,n]=t.split(".");if(e===void 0||i===void 0||n===void 0)return l0("JWT malformed, contained fewer than 3 sections"),null;try{const r=zB(i);return r?JSON.parse(r):(l0("Failed to decode base64 JWT payload"),null)}catch(r){return l0("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function GX(t){const e=EM(t);return qt(e,"internal-error"),qt(typeof e.exp<"u","internal-error"),qt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vv(t,e,i=!1){if(i)return e;try{return await e}catch(n){throw n instanceof Pc&&HX(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function HX({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qX{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var i;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=((i=this.user.stsTokenManager.expirationTime)!==null&&i!==void 0?i:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const i=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},i)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3{constructor(e,i){this.createdAt=e,this.lastLoginAt=i,this._initializeTime()}_initializeTime(){this.lastSignInTime=qg(this.lastLoginAt),this.creationTime=qg(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e_(t){var e;const i=t.auth,n=await t.getIdToken(),r=await Vv(t,$X(i,{idToken:n}));qt(r==null?void 0:r.users.length,i,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?YX(s.providerUserInfo):[],a=XX(t.providerData,o),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new i3(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function KX(t){const e=Nn(t);await e_(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function XX(t,e){return[...t.filter(n=>!e.some(r=>r.providerId===n.providerId)),...e]}function YX(t){return t.map(e=>{var{providerId:i}=e,n=bM(e,["providerId"]);return{providerId:i,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZX(t,e){const i=await e3(t,{},async()=>{const n=zy({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=t3(t,r,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",QB.fetch()(o,{method:"POST",headers:a,body:n})});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){qt(e.idToken,"internal-error"),qt(typeof e.idToken<"u","internal-error"),qt(typeof e.refreshToken<"u","internal-error");const i="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):GX(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,i)}async getToken(e,i=!1){return qt(!this.accessToken||this.refreshToken,e,"user-token-expired"),!i&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,i){const{accessToken:n,refreshToken:r,expiresIn:s}=await ZX(e,i);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,i,n){this.refreshToken=i||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,i){const{refreshToken:n,accessToken:r,expirationTime:s}=i,o=new Lv;return n&&(qt(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),r&&(qt(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(qt(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Lv,this.toJSON())}_performRefresh(){return $c("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xh(t,e){qt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class kd{constructor(e){var{uid:i,auth:n,stsTokenManager:r}=e,s=bM(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new qX(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=i,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new i3(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const i=await Vv(this,this.stsTokenManager.getToken(this.auth,e));return qt(i,this.auth,"internal-error"),this.accessToken!==i&&(this.accessToken=i,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),i}getIdTokenResult(e){return WX(this,e)}reload(){return KX(this)}_assign(e){this!==e&&(qt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(i=>Object.assign({},i)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const i=new kd(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return i.metadata._copy(this.metadata),i}_onReload(e){qt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,i=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),i&&await e_(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Vv(this,jX(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,i){var n,r,s,o,a,l,c,u;const h=(n=i.displayName)!==null&&n!==void 0?n:void 0,d=(r=i.email)!==null&&r!==void 0?r:void 0,f=(s=i.phoneNumber)!==null&&s!==void 0?s:void 0,m=(o=i.photoURL)!==null&&o!==void 0?o:void 0,g=(a=i.tenantId)!==null&&a!==void 0?a:void 0,v=(l=i._redirectEventId)!==null&&l!==void 0?l:void 0,p=(c=i.createdAt)!==null&&c!==void 0?c:void 0,b=(u=i.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:_,emailVerified:P,isAnonymous:E,providerData:T,stsTokenManager:C}=i;qt(_&&C,e,"internal-error");const M=Lv.fromJSON(this.name,C);qt(typeof _=="string",e,"internal-error"),xh(h,e.name),xh(d,e.name),qt(typeof P=="boolean",e,"internal-error"),qt(typeof E=="boolean",e,"internal-error"),xh(f,e.name),xh(m,e.name),xh(g,e.name),xh(v,e.name),xh(p,e.name),xh(b,e.name);const x=new kd({uid:_,auth:e,email:d,emailVerified:P,displayName:h,isAnonymous:E,photoURL:m,phoneNumber:f,tenantId:g,stsTokenManager:M,createdAt:p,lastLoginAt:b});return T&&Array.isArray(T)&&(x.providerData=T.map(V=>Object.assign({},V))),v&&(x._redirectEventId=v),x}static async _fromIdTokenResponse(e,i,n=!1){const r=new Lv;r.updateFromServerResponse(i);const s=new kd({uid:i.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await e_(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI=new Map;function Wc(t){hh(t instanceof Function,"Expected a class definition");let e=GI.get(t);return e?(hh(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,GI.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n3{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,i){this.storage[e]=i}async _get(e){const i=this.storage[e];return i===void 0?null:i}async _remove(e){delete this.storage[e]}_addListener(e,i){}_removeListener(e,i){}}n3.type="NONE";const HI=n3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c0(t,e,i){return`firebase:${t}:${e}:${i}`}class Vm{constructor(e,i,n){this.persistence=e,this.auth=i,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=c0(this.userKey,r.apiKey,s),this.fullPersistenceKey=c0("persistence",r.apiKey,s),this.boundEventHandler=i._onStorageEvent.bind(i),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?kd._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const i=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,i)return this.setCurrentUser(i)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,i,n="authUser"){if(!i.length)return new Vm(Wc(HI),e,n);const r=(await Promise.all(i.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=r[0]||Wc(HI);const o=c0(n,e.config.apiKey,e.name);let a=null;for(const c of i)try{const u=await c._get(o);if(u){const h=kd._fromJSON(e,u);c!==s&&(a=h),s=c;break}}catch{}const l=r.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Vm(s,e,n):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(i.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Vm(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qI(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(o3(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(r3(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(l3(e))return"Blackberry";if(c3(e))return"Webos";if(wM(e))return"Safari";if((e.includes("chrome/")||s3(e))&&!e.includes("edge/"))return"Chrome";if(a3(e))return"Android";{const i=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(i);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function r3(t=Ms()){return/firefox\//i.test(t)}function wM(t=Ms()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function s3(t=Ms()){return/crios\//i.test(t)}function o3(t=Ms()){return/iemobile/i.test(t)}function a3(t=Ms()){return/android/i.test(t)}function l3(t=Ms()){return/blackberry/i.test(t)}function c3(t=Ms()){return/webos/i.test(t)}function _P(t=Ms()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function JX(t=Ms()){var e;return _P(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function QX(){return yK()&&document.documentMode===10}function h3(t=Ms()){return _P(t)||a3(t)||c3(t)||l3(t)||/windows phone/i.test(t)||o3(t)}function eY(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u3(t,e=[]){let i;switch(t){case"Browser":i=qI(Ms());break;case"Worker":i=`${qI(Ms())}-${t}`;break;default:i=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${i}/JsCore/${lf}/${n}`}async function d3(t,e){return hf(t,"GET","/v2/recaptchaConfig",cf(t,e))}function KI(t){return t!==void 0&&t.enterprise!==void 0}class f3{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(i=>i.provider==="EMAIL_PASSWORD_PROVIDER"&&i.enforcementState!=="OFF")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tY(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function m3(t){return new Promise((e,i)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=r=>{const s=ic("internal-error");s.customData=r,i(s)},n.type="text/javascript",n.charset="UTF-8",tY().appendChild(n)})}function iY(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const nY="https://www.google.com/recaptcha/enterprise.js?render=",rY="recaptcha-enterprise",sY="NO_RECAPTCHA";class p3{constructor(e){this.type=rY,this.auth=Ou(e)}async verify(e="verify",i=!1){async function n(s){if(!i){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{d3(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new f3(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function r(s,o,a){const l=window.grecaptcha;KI(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(sY)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{n(this.auth).then(a=>{if(!i&&KI(window.grecaptcha))r(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}m3(nY+a).then(()=>{r(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})}}async function Zm(t,e,i,n=!1){const r=new p3(t);let s;try{s=await r.verify(i)}catch{s=await r.verify(i,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oY{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,i){const n=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});n.onAbort=i,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const i=[];try{for(const n of this.queue)await n(e),n.onAbort&&i.push(n.onAbort)}catch(n){i.reverse();for(const r of i)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aY{constructor(e,i,n,r){this.app=e,this.heartbeatServiceProvider=i,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new XI(this),this.idTokenSubscription=new XI(this),this.beforeStateQueue=new oY(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ZB,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,i){return i&&(this._popupRedirectResolver=Wc(i)),this._initializationPromise=this.queue(async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Vm.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(i),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var i;const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return qt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let i=null;try{i=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return i}async reloadAndSetCurrentUserOrClear(e){try{await e_(e)}catch(i){if((i==null?void 0:i.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=FX()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const i=e?Nn(e):null;return i&&qt(i.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(i&&i._clone(this))}async _updateCurrentUser(e,i=!1){if(!this._deleted)return e&&qt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),i||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Wc(e))})}async initializeRecaptchaConfig(){const e=await d3(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new f3(e);this.tenantId==null?this._agentRecaptchaConfig=i:this._tenantRecaptchaConfigs[this.tenantId]=i,i.emailPasswordEnabled&&new p3(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Fy("auth","Firebase",e())}onAuthStateChanged(e,i,n){return this.registerStateListener(this.authStateSubscription,e,i,n)}beforeAuthStateChanged(e,i){return this.beforeStateQueue.pushCallback(e,i)}onIdTokenChanged(e,i,n){return this.registerStateListener(this.idTokenSubscription,e,i,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,i){const n=await this.getOrInitRedirectPersistenceManager(i);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const i=e&&Wc(e)||this._popupRedirectResolver;qt(i,this,"argument-error"),this.redirectPersistenceManager=await Vm.create(this,[Wc(i._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var i,n;return this._isInitialized&&await this.queue(async()=>{}),((i=this._currentUser)===null||i===void 0?void 0:i._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,i;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(i=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&i!==void 0?i:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,i,n,r){if(this._deleted)return()=>{};const s=typeof i=="function"?i:i.next.bind(i),o=this._isInitialized?Promise.resolve():this._initializationPromise;return qt(o,this,"internal-error"),o.then(()=>s(this.currentUser)),typeof i=="function"?e.addObserver(i,n,r):e.addObserver(i)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return qt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=u3(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const i={"X-Client-Version":this.clientVersion};this.app.options.appId&&(i["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(i["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(i["X-Firebase-AppCheck"]=r),i}async _getAppCheckToken(){var e;const i=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return i!=null&&i.error&&OX(`Error while retrieving App Check token: ${i.error}`),i==null?void 0:i.token}}function Ou(t){return Nn(t)}class XI{constructor(e){this.auth=e,this.observer=null,this.addObserver=TK(i=>this.observer=i)}get next(){return qt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lY(t,e){const i=bP(t,"auth");if(i.isInitialized()){const r=i.getImmediate(),s=i.getOptions();if(Z0(s,e??{}))return r;Da(r,"already-initialized")}return i.initialize({options:e})}function cY(t,e){const i=(e==null?void 0:e.persistence)||[],n=(Array.isArray(i)?i:[i]).map(Wc);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function hY(t,e,i){const n=Ou(t);qt(n._canInitEmulator,n,"emulator-config-failed"),qt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const r=!!(i!=null&&i.disableWarnings),s=g3(e),{host:o,port:a}=uY(e),l=a===null?"":`:${a}`;n.config.emulator={url:`${s}//${o}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||dY()}function g3(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function uY(t){const e=g3(t),i=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!i)return{host:"",port:null};const n=i[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(n);if(r){const s=r[1];return{host:s,port:YI(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:YI(o)}}}function YI(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function dY(){function t(){const e=document.createElement("p"),i=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",i.position="fixed",i.width="100%",i.backgroundColor="#ffffff",i.border=".1em solid #000000",i.color="#b50000",i.bottom="0px",i.left="0px",i.margin="0px",i.zIndex="10000",i.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{constructor(e,i){this.providerId=e,this.signInMethod=i}toJSON(){return $c("not implemented")}_getIdTokenResponse(e){return $c("not implemented")}_linkToIdToken(e,i){return $c("not implemented")}_getReauthenticationResolver(e){return $c("not implemented")}}async function fY(t,e){return hf(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ow(t,e){return By(t,"POST","/v1/accounts:signInWithPassword",cf(t,e))}async function v3(t,e){return hf(t,"POST","/v1/accounts:sendOobCode",cf(t,e))}async function mY(t,e){return v3(t,e)}async function Dw(t,e){return v3(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pY(t,e){return By(t,"POST","/v1/accounts:signInWithEmailLink",cf(t,e))}async function gY(t,e){return By(t,"POST","/v1/accounts:signInWithEmailLink",cf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv extends TM{constructor(e,i,n,r=null){super("password",n),this._email=e,this._password=i,this._tenantId=r}static _fromEmailAndPassword(e,i){return new Iv(e,i,"password")}static _fromEmailAndCode(e,i,n=null){return new Iv(e,i,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const i=typeof e=="string"?JSON.parse(e):e;if(i!=null&&i.email&&(i!=null&&i.password)){if(i.signInMethod==="password")return this._fromEmailAndPassword(i.email,i.password);if(i.signInMethod==="emailLink")return this._fromEmailAndCode(i.email,i.password,i.tenantId)}return null}async _getIdTokenResponse(e){var i;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((i=e._getRecaptchaConfig())===null||i===void 0)&&i.emailPasswordEnabled){const r=await Zm(e,n,"signInWithPassword");return Ow(e,r)}else return Ow(e,n).catch(async r=>{if(r.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const s=await Zm(e,n,"signInWithPassword");return Ow(e,s)}else return Promise.reject(r)});case"emailLink":return pY(e,{email:this._email,oobCode:this._password});default:Da(e,"internal-error")}}async _linkToIdToken(e,i){switch(this.signInMethod){case"password":return fY(e,{idToken:i,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return gY(e,{idToken:i,email:this._email,oobCode:this._password});default:Da(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lm(t,e){return By(t,"POST","/v1/accounts:signInWithIdp",cf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vY="http://localhost";class Ud extends TM{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const i=new Ud(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(i.idToken=e.idToken),e.accessToken&&(i.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(i.nonce=e.nonce),e.pendingToken&&(i.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(i.accessToken=e.oauthToken,i.secret=e.oauthTokenSecret):Da("argument-error"),i}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const i=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:r}=i,s=bM(i,["providerId","signInMethod"]);if(!n||!r)return null;const o=new Ud(n,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const i=this.buildRequest();return Lm(e,i)}_linkToIdToken(e,i){const n=this.buildRequest();return n.idToken=i,Lm(e,n)}_getReauthenticationResolver(e){const i=this.buildRequest();return i.autoCreate=!1,Lm(e,i)}buildRequest(){const e={requestUri:vY,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const i={};this.idToken&&(i.id_token=this.idToken),this.accessToken&&(i.access_token=this.accessToken),this.secret&&(i.oauth_token_secret=this.secret),i.providerId=this.providerId,this.nonce&&!this.pendingToken&&(i.nonce=this.nonce),e.postBody=zy(i)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yY(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function SY(t){const e=Lg(Ig(t)).link,i=e?Lg(Ig(e)).deep_link_id:null,n=Lg(Ig(t)).deep_link_id;return(n?Lg(Ig(n)).link:null)||n||i||e||t}class xM{constructor(e){var i,n,r,s,o,a;const l=Lg(Ig(e)),c=(i=l.apiKey)!==null&&i!==void 0?i:null,u=(n=l.oobCode)!==null&&n!==void 0?n:null,h=yY((r=l.mode)!==null&&r!==void 0?r:null);qt(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const i=SY(e);try{return new xM(i)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(){this.providerId=Rp.PROVIDER_ID}static credential(e,i){return Iv._fromEmailAndPassword(e,i)}static credentialWithLink(e,i){const n=xM.parseLink(i);return qt(n,"argument-error"),Iv._fromEmailAndCode(e,n.code,n.tenantId)}}Rp.PROVIDER_ID="password";Rp.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Rp.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy extends kM{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu extends jy{constructor(){super("facebook.com")}static credential(e){return Ud._fromParams({providerId:nu.PROVIDER_ID,signInMethod:nu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nu.credentialFromTaggedObject(e)}static credentialFromError(e){return nu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nu.credential(e.oauthAccessToken)}catch{return null}}}nu.FACEBOOK_SIGN_IN_METHOD="facebook.com";nu.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc extends jy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,i){return Ud._fromParams({providerId:zc.PROVIDER_ID,signInMethod:zc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:i})}static credentialFromResult(e){return zc.credentialFromTaggedObject(e)}static credentialFromError(e){return zc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:i,oauthAccessToken:n}=e;if(!i&&!n)return null;try{return zc.credential(i,n)}catch{return null}}}zc.GOOGLE_SIGN_IN_METHOD="google.com";zc.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru extends jy{constructor(){super("github.com")}static credential(e){return Ud._fromParams({providerId:ru.PROVIDER_ID,signInMethod:ru.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ru.credentialFromTaggedObject(e)}static credentialFromError(e){return ru.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ru.credential(e.oauthAccessToken)}catch{return null}}}ru.GITHUB_SIGN_IN_METHOD="github.com";ru.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su extends jy{constructor(){super("twitter.com")}static credential(e,i){return Ud._fromParams({providerId:su.PROVIDER_ID,signInMethod:su.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:i})}static credentialFromResult(e){return su.credentialFromTaggedObject(e)}static credentialFromError(e){return su.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:i,oauthTokenSecret:n}=e;if(!i||!n)return null;try{return su.credential(i,n)}catch{return null}}}su.TWITTER_SIGN_IN_METHOD="twitter.com";su.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nw(t,e){return By(t,"POST","/v1/accounts:signUp",cf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,i,n,r=!1){const s=await kd._fromIdTokenResponse(e,n,r),o=ZI(n);return new Bd({user:s,providerId:o,_tokenResponse:n,operationType:i})}static async _forOperation(e,i,n){await e._updateTokensIfNecessary(n,!0);const r=ZI(n);return new Bd({user:e,providerId:r,_tokenResponse:n,operationType:i})}}function ZI(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_ extends Pc{constructor(e,i,n,r){var s;super(i.code,i.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,t_.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:i.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,i,n,r){return new t_(e,i,n,r)}}function y3(t,e,i,n){return(e==="reauthenticate"?i._getReauthenticationResolver(t):i._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?t_._fromErrorAndOperation(t,s,e,n):s})}async function bY(t,e,i=!1){const n=await Vv(t,e._linkToIdToken(t.auth,await t.getIdToken()),i);return Bd._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _Y(t,e,i=!1){const{auth:n}=t,r="reauthenticate";try{const s=await Vv(t,y3(n,r,e,t),i);qt(s.idToken,n,"internal-error");const o=EM(s.idToken);qt(o,n,"internal-error");const{sub:a}=o;return qt(t.uid===a,n,"user-mismatch"),Bd._forOperation(t,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Da(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S3(t,e,i=!1){const n="signIn",r=await y3(t,n,e),s=await Bd._fromIdTokenResponse(t,n,r);return i||await t._updateCurrentUser(s.user),s}async function PY(t,e){return S3(Ou(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h0(t,e,i){var n;qt(((n=i.url)===null||n===void 0?void 0:n.length)>0,t,"invalid-continue-uri"),qt(typeof i.dynamicLinkDomain>"u"||i.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=i.url,e.dynamicLinkDomain=i.dynamicLinkDomain,e.canHandleCodeInApp=i.handleCodeInApp,i.iOS&&(qt(i.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=i.iOS.bundleId),i.android&&(qt(i.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=i.android.installApp,e.androidMinimumVersionCode=i.android.minimumVersion,e.androidPackageName=i.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EY(t,e,i){var n;const r=Ou(t),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(!((n=r._getRecaptchaConfig())===null||n===void 0)&&n.emailPasswordEnabled){const o=await Zm(r,s,"getOobCode",!0);i&&h0(r,o,i),await Dw(r,o)}else i&&h0(r,s,i),await Dw(r,s).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const a=await Zm(r,s,"getOobCode",!0);i&&h0(r,a,i),await Dw(r,a)}else return Promise.reject(o)})}async function wY(t,e,i){var n;const r=Ou(t),s={returnSecureToken:!0,email:e,password:i,clientType:"CLIENT_TYPE_WEB"};let o;if(!((n=r._getRecaptchaConfig())===null||n===void 0)&&n.emailPasswordEnabled){const c=await Zm(r,s,"signUpPassword");o=Nw(r,c)}else o=Nw(r,s).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const u=await Zm(r,s,"signUpPassword");return Nw(r,u)}else return Promise.reject(c)});const a=await o.catch(c=>Promise.reject(c)),l=await Bd._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}function TY(t,e,i){return PY(Nn(t),Rp.credential(e,i))}async function xY(t,e){const i=Nn(t),r={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&h0(i.auth,r,e);const{email:s}=await mY(i.auth,r);s!==t.email&&await t.reload()}function kY(t,e,i,n){return Nn(t).onIdTokenChanged(e,i,n)}function CY(t,e,i){return Nn(t).beforeAuthStateChanged(e,i)}const i_="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(e,i){this.storageRetriever=e,this.type=i}_isAvailable(){try{return this.storage?(this.storage.setItem(i_,"1"),this.storage.removeItem(i_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,i){return this.storage.setItem(e,JSON.stringify(i)),Promise.resolve()}_get(e){const i=this.storage.getItem(e);return Promise.resolve(i?JSON.parse(i):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MY(){const t=Ms();return wM(t)||_P(t)}const AY=1e3,VY=10;class _3 extends b3{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,i)=>this.onStorageEvent(e,i),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=MY()&&eY(),this.fallbackToPolling=h3(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const i of Object.keys(this.listeners)){const n=this.storage.getItem(i),r=this.localCache[i];n!==r&&e(i,r,n)}}onStorageEvent(e,i=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const n=e.key;if(i?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(n);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!i)return}const r=()=>{const o=this.storage.getItem(n);!i&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);QX()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,VY):r()}notifyListeners(e,i){this.localCache[e]=i;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,i,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:i,newValue:n}),!0)})},AY)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(i)}_removeListener(e,i){this.listeners[e]&&(this.listeners[e].delete(i),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,i){await super._set(e,i),this.localCache[e]=JSON.stringify(i)}async _get(e){const i=await super._get(e);return this.localCache[e]=JSON.stringify(i),i}async _remove(e){await super._remove(e),delete this.localCache[e]}}_3.type="LOCAL";const LY=_3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3 extends b3{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,i){}_removeListener(e,i){}}P3.type="SESSION";const E3=P3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IY(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(i){return{fulfilled:!1,reason:i}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const i=this.receivers.find(r=>r.isListeningto(e));if(i)return i;const n=new PP(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const i=e,{eventId:n,eventType:r,data:s}=i.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;i.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(o).map(async c=>c(i.origin,s)),l=await IY(a);i.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:l})}_subscribe(e,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(i)}_unsubscribe(e,i){this.handlersMap[e]&&i&&this.handlersMap[e].delete(i),(!i||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}PP.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CM(t="",e=10){let i="";for(let n=0;n<e;n++)i+=Math.floor(Math.random()*10);return t+i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OY{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,i,n=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=CM("",20);r.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);o={messageChannel:r,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(d.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:i},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(){return window}function DY(t){nc().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w3(){return typeof nc().WorkerGlobalScope<"u"&&typeof nc().importScripts=="function"}async function NY(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function RY(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function FY(){return w3()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T3="firebaseLocalStorageDb",zY=1,n_="firebaseLocalStorage",x3="fbase_key";class $y{constructor(e){this.request=e}toPromise(){return new Promise((e,i)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{i(this.request.error)})})}}function EP(t,e){return t.transaction([n_],e?"readwrite":"readonly").objectStore(n_)}function UY(){const t=indexedDB.deleteDatabase(T3);return new $y(t).toPromise()}function Sk(){const t=indexedDB.open(T3,zY);return new Promise((e,i)=>{t.addEventListener("error",()=>{i(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(n_,{keyPath:x3})}catch(r){i(r)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(n_)?e(n):(n.close(),await UY(),e(await Sk()))})})}async function JI(t,e,i){const n=EP(t,!0).put({[x3]:e,value:i});return new $y(n).toPromise()}async function BY(t,e){const i=EP(t,!1).get(e),n=await new $y(i).toPromise();return n===void 0?null:n.value}function QI(t,e){const i=EP(t,!0).delete(e);return new $y(i).toPromise()}const jY=800,$Y=3;class k3{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sk(),this.db)}async _withRetries(e){let i=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(i++>$Y)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return w3()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=PP._getInstance(FY()),this.receiver._subscribe("keyChanged",async(e,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(e,i)=>["keyChanged"])}async initializeSender(){var e,i;if(this.activeServiceWorker=await NY(),!this.activeServiceWorker)return;this.sender=new OY(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((i=n[0])===null||i===void 0)&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||RY()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sk();return await JI(e,i_,"1"),await QI(e,i_),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,i){return this._withPendingWrite(async()=>(await this._withRetries(n=>JI(n,e,i)),this.localCache[e]=i,this.notifyServiceWorker(e)))}async _get(e){const i=await this._withRetries(n=>BY(n,e));return this.localCache[e]=i,i}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(i=>QI(i,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=EP(r,!1).getAll();return new $y(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const i=[],n=new Set;for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),i.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),i.push(r));return i}notifyListeners(e,i){this.localCache[e]=i;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jY)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(i)}_removeListener(e,i){this.listeners[e]&&(this.listeners[e].delete(i),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}k3.type="LOCAL";const WY=k3;new Uy(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C3(t,e){return e?Wc(e):(qt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM extends TM{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Lm(e,this._buildIdpRequest())}_linkToIdToken(e,i){return Lm(e,this._buildIdpRequest(i))}_getReauthenticationResolver(e){return Lm(e,this._buildIdpRequest())}_buildIdpRequest(e){const i={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(i.idToken=e),i}}function GY(t){return S3(t.auth,new MM(t),t.bypassAuthState)}function HY(t){const{auth:e,user:i}=t;return qt(i,e,"internal-error"),_Y(i,new MM(t),t.bypassAuthState)}async function qY(t){const{auth:e,user:i}=t;return qt(i,e,"internal-error"),bY(i,new MM(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M3{constructor(e,i,n,r,s=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(i)?i:[i]}execute(){return new Promise(async(e,i)=>{this.pendingPromise={resolve:e,reject:i};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:i,sessionId:n,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:i,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return GY;case"linkViaPopup":case"linkViaRedirect":return qY;case"reauthViaPopup":case"reauthViaRedirect":return HY;default:Da(this.auth,"internal-error")}}resolve(e){hh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){hh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KY=new Uy(2e3,1e4);async function XY(t,e,i){const n=Ou(t);DX(t,e,kM);const r=C3(n,i);return new gd(n,"signInViaPopup",e,r).executeNotNull()}class gd extends M3{constructor(e,i,n,r,s){super(e,i,r,s),this.provider=n,this.authWindow=null,this.pollId=null,gd.currentPopupAction&&gd.currentPopupAction.cancel(),gd.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return qt(e,this.auth,"internal-error"),e}async onExecution(){hh(this.filter.length===1,"Popup operations only handle one event");const e=CM();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(ic(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ic(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,gd.currentPopupAction=null}pollUserCancellation(){const e=()=>{var i,n;if(!((n=(i=this.authWindow)===null||i===void 0?void 0:i.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ic(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,KY.get())};e()}}gd.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YY="pendingRedirect",u0=new Map;class ZY extends M3{constructor(e,i,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],i,void 0,n),this.eventId=null}async execute(){let e=u0.get(this.auth._key());if(!e){try{const n=await JY(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(i){e=()=>Promise.reject(i)}u0.set(this.auth._key(),e)}return this.bypassAuthState||u0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const i=await this.auth._redirectUserForId(e.eventId);if(i)return this.user=i,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function JY(t,e){const i=tZ(e),n=eZ(t);if(!await n._isAvailable())return!1;const r=await n._get(i)==="true";return await n._remove(i),r}function QY(t,e){u0.set(t._key(),e)}function eZ(t){return Wc(t._redirectPersistence)}function tZ(t){return c0(YY,t.config.apiKey,t.name)}async function iZ(t,e,i=!1){const n=Ou(t),r=C3(n,e),o=await new ZY(n,r,i).execute();return o&&!i&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nZ=10*60*1e3;class rZ{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let i=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(i=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!sZ(e)||(this.hasHandledPotentialRedirect=!0,i||(this.queuedRedirectEvent=e,i=!0)),i}sendToConsumer(e,i){var n;if(e.error&&!A3(e)){const r=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";i.onError(ic(this.auth,r))}else i.onAuthEvent(e)}isEventForConsumer(e,i){const n=i.eventId===null||!!e.eventId&&e.eventId===i.eventId;return i.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=nZ&&this.cachedEventUids.clear(),this.cachedEventUids.has(eO(e))}saveEventToCache(e){this.cachedEventUids.add(eO(e)),this.lastProcessedEventTime=Date.now()}}function eO(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function A3({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function sZ(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return A3(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oZ(t,e={}){return hf(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aZ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,lZ=/^https?/;async function cZ(t){if(t.config.emulator)return;const{authorizedDomains:e}=await oZ(t);for(const i of e)try{if(hZ(i))return}catch{}Da(t,"unauthorized-domain")}function hZ(t){const e=yk(),{protocol:i,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?i==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):i==="chrome-extension:"&&o.hostname===n}if(!lZ.test(i))return!1;if(aZ.test(t))return n===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uZ=new Uy(3e4,6e4);function tO(){const t=nc().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let i=0;i<t.CP.length;i++)t.CP[i]=null}}function dZ(t){return new Promise((e,i)=>{var n,r,s;function o(){tO(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tO(),i(ic(t,"network-request-failed"))},timeout:uZ.get()})}if(!((r=(n=nc().gapi)===null||n===void 0?void 0:n.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=nc().gapi)===null||s===void 0)&&s.load)o();else{const a=iY("iframefcb");return nc()[a]=()=>{gapi.load?o():i(ic(t,"network-request-failed"))},m3(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>i(l))}}).catch(e=>{throw d0=null,e})}let d0=null;function fZ(t){return d0=d0||dZ(t),d0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mZ=new Uy(5e3,15e3),pZ="__/auth/iframe",gZ="emulator/auth/iframe",vZ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},yZ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function SZ(t){const e=t.config;qt(e.authDomain,t,"auth-domain-config-required");const i=e.emulator?PM(e,gZ):`https://${t.config.authDomain}/${pZ}`,n={apiKey:e.apiKey,appName:t.name,v:lf},r=yZ.get(t.config.apiHost);r&&(n.eid=r);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${i}?${zy(n).slice(1)}`}async function bZ(t){const e=await fZ(t),i=nc().gapi;return qt(i,t,"internal-error"),e.open({where:document.body,url:SZ(t),messageHandlersFilter:i.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vZ,dontclear:!0},n=>new Promise(async(r,s)=>{await n.restyle({setHideOnLeave:!1});const o=ic(t,"network-request-failed"),a=nc().setTimeout(()=>{s(o)},mZ.get());function l(){nc().clearTimeout(a),r(n)}n.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Z={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},PZ=500,EZ=600,wZ="_blank",TZ="http://localhost";class iO{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function xZ(t,e,i,n=PZ,r=EZ){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const l=Object.assign(Object.assign({},_Z),{width:n.toString(),height:r.toString(),top:s,left:o}),c=Ms().toLowerCase();i&&(a=s3(c)?wZ:i),r3(c)&&(e=e||TZ,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[f,m])=>`${d}${f}=${m},`,"");if(JX(c)&&a!=="_self")return kZ(e||"",a),new iO(null);const h=window.open(e||"",a,u);qt(h,t,"popup-blocked");try{h.focus()}catch{}return new iO(h)}function kZ(t,e){const i=document.createElement("a");i.href=t,i.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),i.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CZ="__/auth/handler",MZ="emulator/auth/handler",AZ=encodeURIComponent("fac");async function nO(t,e,i,n,r,s){qt(t.config.authDomain,t,"auth-domain-config-required"),qt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:i,redirectUrl:n,v:lf,eventId:r};if(e instanceof kM){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",wK(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries(s||{}))o[u]=h}if(e instanceof jy){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${AZ}=${encodeURIComponent(l)}`:"";return`${VZ(t)}?${zy(a).slice(1)}${c}`}function VZ({config:t}){return t.emulator?PM(t,MZ):`https://${t.authDomain}/${CZ}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw="webStorageSupport";class LZ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=E3,this._completeRedirectFn=iZ,this._overrideRedirectResult=QY}async _openPopup(e,i,n,r){var s;hh((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await nO(e,i,n,yk(),r);return xZ(e,o,CM())}async _openRedirect(e,i,n,r){await this._originValidation(e);const s=await nO(e,i,n,yk(),r);return DY(s),new Promise(()=>{})}_initialize(e){const i=e._key();if(this.eventManagers[i]){const{manager:r,promise:s}=this.eventManagers[i];return r?Promise.resolve(r):(hh(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[i]={promise:n},n.catch(()=>{delete this.eventManagers[i]}),n}async initAndGetManager(e){const i=await bZ(e),n=new rZ(e);return i.register("authEvent",r=>(qt(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:n.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=i,n}_isIframeWebStorageSupported(e,i){this.iframes[e._key()].send(Rw,{type:Rw},r=>{var s;const o=(s=r==null?void 0:r[0])===null||s===void 0?void 0:s[Rw];o!==void 0&&i(!!o),Da(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const i=e._key();return this.originValidationPromises[i]||(this.originValidationPromises[i]=cZ(e)),this.originValidationPromises[i]}get _shouldInitProactively(){return h3()||wM()||_P()}}const IZ=LZ;var rO="@firebase/auth",sO="0.23.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OZ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const i=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,i),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const i=this.internalListeners.get(e);i&&(this.internalListeners.delete(e),i(),this.updateProactiveRefresh())}assertAuthConfigured(){qt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DZ(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function NZ(t){zd(new ku("auth",(e,{options:i})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;qt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:u3(t)},c=new aY(n,r,s,l);return cY(c,i),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,i,n)=>{e.getProvider("auth-internal").initialize()})),zd(new ku("auth-internal",e=>{const i=Ou(e.getProvider("auth").getImmediate());return(n=>new OZ(n))(i)},"PRIVATE").setInstantiationMode("EXPLICIT")),tc(rO,sO,DZ(t)),tc(rO,sO,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RZ=5*60,FZ=$B("authIdTokenMaxAge")||RZ;let oO=null;const zZ=t=>async e=>{const i=e&&await e.getIdTokenResult(),n=i&&(new Date().getTime()-Date.parse(i.issuedAtTime))/1e3;if(n&&n>FZ)return;const r=i==null?void 0:i.token;oO!==r&&(oO=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function Fp(t=SM()){const e=bP(t,"auth");if(e.isInitialized())return e.getImmediate();const i=lY(t,{popupRedirectResolver:IZ,persistence:[WY,LY,E3]}),n=$B("authTokenSyncURL");if(n){const s=zZ(n);CY(i,s,()=>s(i.currentUser)),kY(i,o=>s(o))}const r=UB("auth");return r&&hY(i,`http://${r}`),i}NZ("Browser");var UZ=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let V3;const wP=t=>V3=t,L3=Symbol();function bk(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Kg;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Kg||(Kg={}));function BZ(){const t=Ap(!0),e=t.run(()=>ge({}));let i=[],n=[];const r=tP({install(s){wP(r),r._a=s,s.provide(L3,r),s.config.globalProperties.$pinia=r,n.forEach(o=>i.push(o)),n=[]},use(s){return!this._a&&!UZ?n.push(s):i.push(s),this},_p:i,_a:null,_e:t,_s:new Map,state:e});return r}const I3=()=>{};function aO(t,e,i,n=I3){t.push(e);const r=()=>{const s=t.indexOf(e);s>-1&&(t.splice(s,1),n())};return!i&&C1()&&ls(r),r}function wf(t,...e){t.slice().forEach(i=>{i(...e)})}const jZ=t=>t();function _k(t,e){t instanceof Map&&e instanceof Map&&e.forEach((i,n)=>t.set(n,i)),t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const i in e){if(!e.hasOwnProperty(i))continue;const n=e[i],r=t[i];bk(r)&&bk(n)&&t.hasOwnProperty(i)&&!Fi(n)&&!eh(n)?t[i]=_k(r,n):t[i]=n}return t}const $Z=Symbol();function WZ(t){return!bk(t)||!t.hasOwnProperty($Z)}const{assign:Gh}=Object;function GZ(t){return!!(Fi(t)&&t.effect)}function HZ(t,e,i,n){const{state:r,actions:s,getters:o}=e,a=i.state.value[t];let l;function c(){a||(i.state.value[t]=r?r():{});const u=iP(i.state.value[t]);return Gh(u,s,Object.keys(o||{}).reduce((h,d)=>(h[d]=tP(W(()=>{wP(i);const f=i._s.get(t);return o[d].call(f,f)})),h),{}))}return l=O3(t,c,e,i,n,!0),l}function O3(t,e,i={},n,r,s){let o;const a=Gh({actions:{}},i),l={deep:!0};let c,u,h=[],d=[],f;const m=n.state.value[t];!s&&!m&&(n.state.value[t]={}),ge({});let g;function v(M){let x;c=u=!1,typeof M=="function"?(M(n.state.value[t]),x={type:Kg.patchFunction,storeId:t,events:f}):(_k(n.state.value[t],M),x={type:Kg.patchObject,payload:M,storeId:t,events:f});const V=g=Symbol();vn().then(()=>{g===V&&(c=!0)}),u=!0,wf(h,x,n.state.value[t])}const p=s?function(){const{state:x}=i,V=x?x():{};this.$patch(N=>{Gh(N,V)})}:I3;function b(){o.stop(),h=[],d=[],n._s.delete(t)}function _(M,x){return function(){wP(n);const V=Array.from(arguments),N=[],D=[];function O(Z){N.push(Z)}function F(Z){D.push(Z)}wf(d,{args:V,name:M,store:E,after:O,onError:F});let X;try{X=x.apply(this&&this.$id===t?this:E,V)}catch(Z){throw wf(D,Z),Z}return X instanceof Promise?X.then(Z=>(wf(N,Z),Z)).catch(Z=>(wf(D,Z),Promise.reject(Z))):(wf(N,X),X)}}const P={_p:n,$id:t,$onAction:aO.bind(null,d),$patch:v,$reset:p,$subscribe(M,x={}){const V=aO(h,M,x.detached,()=>N()),N=o.run(()=>He(()=>n.state.value[t],D=>{(x.flush==="sync"?u:c)&&M({storeId:t,type:Kg.direct,events:f},D)},Gh({},l,x)));return V},$dispose:b},E=$r(P);n._s.set(t,E);const C=(n._a&&n._a.runWithContext||jZ)(()=>n._e.run(()=>(o=Ap()).run(e)));for(const M in C){const x=C[M];if(Fi(x)&&!GZ(x)||eh(x))s||(m&&WZ(x)&&(Fi(x)?x.value=m[M]:_k(x,m[M])),n.state.value[t][M]=x);else if(typeof x=="function"){const V=_(M,x);C[M]=V,a.actions[M]=x}}return Gh(E,C),Gh(hi(E),C),Object.defineProperty(E,"$state",{get:()=>n.state.value[t],set:M=>{v(x=>{Gh(x,M)})}}),n._p.forEach(M=>{Gh(E,o.run(()=>M({store:E,app:n._a,pinia:n,options:a})))}),m&&s&&i.hydrate&&i.hydrate(E.$state,m),c=!0,u=!0,E}function D3(t,e,i){let n,r;const s=typeof e=="function";typeof t=="string"?(n=t,r=s?i:e):(r=t,n=t.id);function o(a,l){const c=N6();return a=a||(c?xi(L3,null):null),a&&wP(a),a=V3,a._s.has(n)||(s?O3(n,e,r,a):HZ(n,r,a)),a._s.get(n)}return o.$id=n,o}function Ji(t){{t=hi(t);const e={};for(const i in t){const n=t[i];(Fi(n)||eh(n))&&(e[i]=bt(t,i))}return e}}function qZ(t){return{all:t=t||new Map,on:function(e,i){var n=t.get(e);n?n.push(i):t.set(e,[i])},off:function(e,i){var n=t.get(e);n&&(i?n.splice(n.indexOf(i)>>>0,1):t.set(e,[]))},emit:function(e,i){var n=t.get(e);n&&n.slice().map(function(r){r(i)}),(n=t.get("*"))&&n.slice().map(function(r){r(e,i)})}}}class KZ{constructor(){y(this,"mitt");this.mitt=qZ()}fire(e,i){this.verifyKebabCase(e),this.mitt.emit(e,i)}listen(e,i){this.verifyKebabCase(e),this.mitt.on(e,i)}unlisten(e){this.verifyKebabCase(e),this.mitt.off(e)}verifyKebabCase(e){if(!e.match(/[a-z]+(-[a-z]+)+/))throw`${e} is not in kebab-case`}}const $=new KZ;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const AM="153",XZ=0,lO=1,YZ=2,N3=1,ZZ=2,Nc=3,Cu=0,bo=1,Uc=2,Su=0,Im=1,cO=2,hO=3,uO=4,JZ=5,rm=100,QZ=101,eJ=102,dO=103,fO=104,tJ=200,iJ=201,nJ=202,rJ=203,R3=204,F3=205,sJ=206,oJ=207,aJ=208,lJ=209,cJ=210,hJ=0,uJ=1,dJ=2,Pk=3,fJ=4,mJ=5,pJ=6,gJ=7,z3=0,vJ=1,yJ=2,th=0,SJ=1,bJ=2,_J=3,PJ=4,EJ=5,U3=300,Jm=301,Qm=302,Ek=303,wk=304,TP=306,Tk=1e3,ol=1001,xk=1002,Hs=1003,mO=1004,Fw=1005,pa=1006,wJ=1007,Ov=1008,bu=1009,TJ=1010,xJ=1011,VM=1012,B3=1013,hu=1014,uu=1015,Dv=1016,j3=1017,$3=1018,Cd=1020,kJ=1021,al=1023,CJ=1024,MJ=1025,Md=1026,ep=1027,AJ=1028,W3=1029,VJ=1030,G3=1031,H3=1033,zw=33776,Uw=33777,Bw=33778,jw=33779,pO=35840,gO=35841,vO=35842,yO=35843,LJ=36196,SO=37492,bO=37496,_O=37808,PO=37809,EO=37810,wO=37811,TO=37812,xO=37813,kO=37814,CO=37815,MO=37816,AO=37817,VO=37818,LO=37819,IO=37820,OO=37821,$w=36492,IJ=36283,DO=36284,NO=36285,RO=36286,q3=3e3,Ad=3001,OJ=3200,DJ=3201,K3=0,NJ=1,Vd="",yi="srgb",fc="srgb-linear",X3="display-p3",Ww=7680,RJ=519,FJ=512,zJ=513,UJ=514,BJ=515,jJ=516,$J=517,WJ=518,GJ=519,FO=35044,zO="300 es",kk=1035,Gc=2e3,r_=2001;class zp{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(i)===-1&&n[e].push(i)}hasEventListener(e,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(i)!==-1}removeEventListener(e,i){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(i);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const ds=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Gw=Math.PI/180,Ck=180/Math.PI;function Wy(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(ds[t&255]+ds[t>>8&255]+ds[t>>16&255]+ds[t>>24&255]+"-"+ds[e&255]+ds[e>>8&255]+"-"+ds[e>>16&15|64]+ds[e>>24&255]+"-"+ds[i&63|128]+ds[i>>8&255]+"-"+ds[i>>16&255]+ds[i>>24&255]+ds[n&255]+ds[n>>8&255]+ds[n>>16&255]+ds[n>>24&255]).toLowerCase()}function po(t,e,i){return Math.max(e,Math.min(i,t))}function HJ(t,e){return(t%e+e)%e}function Hw(t,e,i){return(1-i)*t+i*e}function UO(t){return(t&t-1)===0&&t!==0}function Mk(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function jS(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Lo(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}class Pi{constructor(e=0,i=0){Pi.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,n=this.y,r=e.elements;return this.x=r[0]*i+r[3]*n+r[6],this.y=r[1]*i+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(po(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y;return i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const n=Math.cos(i),r=Math.sin(i),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ti{constructor(e,i,n,r,s,o,a,l,c){Ti.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,n,r,s,o,a,l,c)}set(e,i,n,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=i,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this}extractBasis(e,i,n){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,r=i.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],d=n[2],f=n[5],m=n[8],g=r[0],v=r[3],p=r[6],b=r[1],_=r[4],P=r[7],E=r[2],T=r[5],C=r[8];return s[0]=o*g+a*b+l*E,s[3]=o*v+a*_+l*T,s[6]=o*p+a*P+l*C,s[1]=c*g+u*b+h*E,s[4]=c*v+u*_+h*T,s[7]=c*p+u*P+h*C,s[2]=d*g+f*b+m*E,s[5]=d*v+f*_+m*T,s[8]=d*p+f*P+m*C,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return i*o*u-i*a*c-n*s*u+n*a*l+r*s*c-r*o*l}invert(){const e=this.elements,i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=a*l-u*s,f=c*s-o*l,m=i*h+n*d+r*f;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);const g=1/m;return e[0]=h*g,e[1]=(r*c-u*n)*g,e[2]=(a*n-r*o)*g,e[3]=d*g,e[4]=(u*i-r*l)*g,e[5]=(r*s-a*i)*g,e[6]=f*g,e[7]=(n*l-c*i)*g,e[8]=(o*i-n*s)*g,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+i,0,0,1),this}scale(e,i){return this.premultiply(qw.makeScale(e,i)),this}rotate(e){return this.premultiply(qw.makeRotation(-e)),this}translate(e,i){return this.premultiply(qw.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,n,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,n=e.elements;for(let r=0;r<9;r++)if(i[r]!==n[r])return!1;return!0}fromArray(e,i=0){for(let n=0;n<9;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const qw=new Ti;function Y3(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function Nv(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}const BO={};function Xg(t){t in BO||(BO[t]=!0,console.warn(t))}function Om(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Kw(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}const qJ=new Ti().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),KJ=new Ti().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function XJ(t){return t.convertSRGBToLinear().applyMatrix3(KJ)}function YJ(t){return t.applyMatrix3(qJ).convertLinearToSRGB()}const ZJ={[fc]:t=>t,[yi]:t=>t.convertSRGBToLinear(),[X3]:XJ},JJ={[fc]:t=>t,[yi]:t=>t.convertLinearToSRGB(),[X3]:YJ},ja={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(t){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!t},get workingColorSpace(){return fc},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,i){if(this.enabled===!1||e===i||!e||!i)return t;const n=ZJ[e],r=JJ[i];if(n===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${i}".`);return r(n(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}};let Tf;class Z3{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Tf===void 0&&(Tf=Nv("canvas")),Tf.width=e.width,Tf.height=e.height;const n=Tf.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),i=Tf}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=Nv("canvas");i.width=e.width,i.height=e.height;const n=i.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Om(s[o]/255)*255;return n.putImageData(r,0,0),i}else if(e.data){const i=e.data.slice(0);for(let n=0;n<i.length;n++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[n]=Math.floor(Om(i[n]/255)*255):i[n]=Om(i[n]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let QJ=0;class J3{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:QJ++}),this.uuid=Wy(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(Xw(r[o].image)):s.push(Xw(r[o]))}else s=Xw(r);n.url=s}return i||(e.images[this.uuid]=n),n}}function Xw(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?Z3.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let eQ=0,Ec=class f0 extends zp{constructor(e=f0.DEFAULT_IMAGE,i=f0.DEFAULT_MAPPING,n=ol,r=ol,s=pa,o=Ov,a=al,l=bu,c=f0.DEFAULT_ANISOTROPY,u=Vd){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:eQ++}),this.uuid=Wy(),this.name="",this.source=new J3(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Pi(0,0),this.repeat=new Pi(1,1),this.center=new Pi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ti,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(Xg("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===Ad?yi:Vd),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==U3)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Tk:e.x=e.x-Math.floor(e.x);break;case ol:e.x=e.x<0?0:1;break;case xk:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Tk:e.y=e.y-Math.floor(e.y);break;case ol:e.y=e.y<0?0:1;break;case xk:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Xg("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===yi?Ad:q3}set encoding(e){Xg("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Ad?yi:Vd}};Ec.DEFAULT_IMAGE=null;Ec.DEFAULT_MAPPING=U3;Ec.DEFAULT_ANISOTROPY=1;class kn{constructor(e=0,i=0,n=0,r=1){kn.prototype.isVector4=!0,this.x=e,this.y=i,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,n,r){return this.x=e,this.y=i,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*i+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*i+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*i+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*i+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,n,r,s;const l=e.elements,c=l[0],u=l[4],h=l[8],d=l[1],f=l[5],m=l[9],g=l[2],v=l[6],p=l[10];if(Math.abs(u-d)<.01&&Math.abs(h-g)<.01&&Math.abs(m-v)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+g)<.1&&Math.abs(m+v)<.1&&Math.abs(c+f+p-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const _=(c+1)/2,P=(f+1)/2,E=(p+1)/2,T=(u+d)/4,C=(h+g)/4,M=(m+v)/4;return _>P&&_>E?_<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(_),r=T/n,s=C/n):P>E?P<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(P),n=T/r,s=M/r):E<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(E),n=C/s,r=M/s),this.set(n,r,s,i),this}let b=Math.sqrt((v-m)*(v-m)+(h-g)*(h-g)+(d-u)*(d-u));return Math.abs(b)<.001&&(b=1),this.x=(v-m)/b,this.y=(h-g)/b,this.z=(d-u)/b,this.w=Math.acos((c+f+p-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this.w=e.w+(i.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class jd extends zp{constructor(e=1,i=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=i,this.depth=1,this.scissor=new kn(0,0,e,i),this.scissorTest=!1,this.viewport=new kn(0,0,e,i);const r={width:e,height:i,depth:1};n.encoding!==void 0&&(Xg("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===Ad?yi:Vd),this.texture=new Ec(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:pa,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(e,i,n=1){(this.width!==e||this.height!==i||this.depth!==n)&&(this.width=e,this.height=i,this.depth=n,this.texture.image.width=e,this.texture.image.height=i,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const i=Object.assign({},e.texture.image);return this.texture.source=new J3(i),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Q3 extends Ec{constructor(e=null,i=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:i,height:n,depth:r},this.magFilter=Hs,this.minFilter=Hs,this.wrapR=ol,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class tQ extends Ec{constructor(e=null,i=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:i,height:n,depth:r},this.magFilter=Hs,this.minFilter=Hs,this.wrapR=ol,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class _u{constructor(e=0,i=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=n,this._w=r}static slerpFlat(e,i,n,r,s,o,a){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3];const d=s[o+0],f=s[o+1],m=s[o+2],g=s[o+3];if(a===0){e[i+0]=l,e[i+1]=c,e[i+2]=u,e[i+3]=h;return}if(a===1){e[i+0]=d,e[i+1]=f,e[i+2]=m,e[i+3]=g;return}if(h!==g||l!==d||c!==f||u!==m){let v=1-a;const p=l*d+c*f+u*m+h*g,b=p>=0?1:-1,_=1-p*p;if(_>Number.EPSILON){const E=Math.sqrt(_),T=Math.atan2(E,p*b);v=Math.sin(v*T)/E,a=Math.sin(a*T)/E}const P=a*b;if(l=l*v+d*P,c=c*v+f*P,u=u*v+m*P,h=h*v+g*P,v===1-a){const E=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=E,c*=E,u*=E,h*=E}}e[i]=l,e[i+1]=c,e[i+2]=u,e[i+3]=h}static multiplyQuaternionsFlat(e,i,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],u=n[r+3],h=s[o],d=s[o+1],f=s[o+2],m=s[o+3];return e[i]=a*m+u*h+l*f-c*d,e[i+1]=l*m+u*d+c*h-a*f,e[i+2]=c*m+u*f+a*d-l*h,e[i+3]=u*m-a*h-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,n,r){return this._x=e,this._y=i,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i){const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),u=a(r/2),h=a(s/2),d=l(n/2),f=l(r/2),m=l(s/2);switch(o){case"XYZ":this._x=d*u*h+c*f*m,this._y=c*f*h-d*u*m,this._z=c*u*m+d*f*h,this._w=c*u*h-d*f*m;break;case"YXZ":this._x=d*u*h+c*f*m,this._y=c*f*h-d*u*m,this._z=c*u*m-d*f*h,this._w=c*u*h+d*f*m;break;case"ZXY":this._x=d*u*h-c*f*m,this._y=c*f*h+d*u*m,this._z=c*u*m+d*f*h,this._w=c*u*h-d*f*m;break;case"ZYX":this._x=d*u*h-c*f*m,this._y=c*f*h+d*u*m,this._z=c*u*m-d*f*h,this._w=c*u*h+d*f*m;break;case"YZX":this._x=d*u*h+c*f*m,this._y=c*f*h+d*u*m,this._z=c*u*m-d*f*h,this._w=c*u*h-d*f*m;break;case"XZY":this._x=d*u*h-c*f*m,this._y=c*f*h-d*u*m,this._z=c*u*m+d*f*h,this._w=c*u*h+d*f*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const n=i/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,n=i[0],r=i[4],s=i[8],o=i[1],a=i[5],l=i[9],c=i[2],u=i[6],h=i[10],d=n+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>h){const f=2*Math.sqrt(1+n-a-h);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>h){const f=2*Math.sqrt(1+a-n-h);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+h-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let n=e.dot(i)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(po(this.dot(e),-1,1)))}rotateTowards(e,i){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,i/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const n=e._x,r=e._y,s=e._z,o=e._w,a=i._x,l=i._y,c=i._z,u=i._w;return this._x=n*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-n*c,this._z=s*u+o*c+n*l-r*a,this._w=o*u-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-i;return this._w=f*o+i*this._w,this._x=f*n+i*this._x,this._y=f*r+i*this._y,this._z=f*s+i*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-i)*u)/c,d=Math.sin(i*u)/c;return this._w=o*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,i,n){return this.copy(e).slerp(i,n)}random(){const e=Math.random(),i=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(i*Math.cos(r),n*Math.sin(s),n*Math.cos(s),i*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class k{constructor(e=0,i=0,n=0){k.prototype.isVector3=!0,this.x=e,this.y=i,this.z=n}set(e,i,n){return n===void 0&&(n=this.z),this.x=e,this.y=i,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(jO.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(jO.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*i+s[3]*n+s[6]*r,this.y=s[1]*i+s[4]*n+s[7]*r,this.z=s[2]*i+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*i+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*i+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*i+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*i+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const i=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*i+o*r-a*n,u=l*n+a*i-s*r,h=l*r+s*n-o*i,d=-s*i-o*n-a*r;return this.x=c*l+d*-s+u*-a-h*-o,this.y=u*l+d*-o+h*-s-c*-a,this.z=h*l+d*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*i+s[4]*n+s[8]*r,this.y=s[1]*i+s[5]*n+s[9]*r,this.z=s[2]*i+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,n){return this.x=e.x+(i.x-e.x)*n,this.y=e.y+(i.y-e.y)*n,this.z=e.z+(i.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const n=e.x,r=e.y,s=e.z,o=i.x,a=i.y,l=i.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const n=e.dot(this)/i;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Yw.copy(this).projectOnVector(e),this.sub(Yw)}reflect(e){return this.sub(Yw.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(e)/i;return Math.acos(po(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return i*i+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,n){const r=Math.sin(i)*e;return this.x=r*Math.sin(n),this.y=Math.cos(i)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,n){return this.x=e*Math.sin(i),this.y=n,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=n,this.z=r,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(i),this.y=n*Math.sin(i),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Yw=new k,jO=new _u;class Gy{constructor(e=new k(1/0,1/0,1/0),i=new k(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i+=3)this.expandByPoint(Cc.fromArray(e,i));return this}setFromBufferAttribute(e){this.makeEmpty();for(let i=0,n=e.count;i<n;i++)this.expandByPoint(Cc.fromBufferAttribute(e,i));return this}setFromPoints(e){this.makeEmpty();for(let i=0,n=e.length;i<n;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const n=Cc.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){if(e.updateWorldMatrix(!1,!1),e.boundingBox!==void 0)e.boundingBox===null&&e.computeBoundingBox(),xf.copy(e.boundingBox),xf.applyMatrix4(e.matrixWorld),this.union(xf);else{const r=e.geometry;if(r!==void 0)if(i&&r.attributes!==void 0&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)Cc.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(Cc)}else r.boundingBox===null&&r.computeBoundingBox(),xf.copy(r.boundingBox),xf.applyMatrix4(e.matrixWorld),this.union(xf)}const n=e.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],i);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Cc),Cc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,n;return e.normal.x>0?(i=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),i<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(fg),$S.subVectors(this.max,fg),kf.subVectors(e.a,fg),Cf.subVectors(e.b,fg),Mf.subVectors(e.c,fg),kh.subVectors(Cf,kf),Ch.subVectors(Mf,Cf),Yu.subVectors(kf,Mf);let i=[0,-kh.z,kh.y,0,-Ch.z,Ch.y,0,-Yu.z,Yu.y,kh.z,0,-kh.x,Ch.z,0,-Ch.x,Yu.z,0,-Yu.x,-kh.y,kh.x,0,-Ch.y,Ch.x,0,-Yu.y,Yu.x,0];return!Zw(i,kf,Cf,Mf,$S)||(i=[1,0,0,0,1,0,0,0,1],!Zw(i,kf,Cf,Mf,$S))?!1:(WS.crossVectors(kh,Ch),i=[WS.x,WS.y,WS.z],Zw(i,kf,Cf,Mf,$S))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Cc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Cc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(kc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),kc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),kc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),kc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),kc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),kc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),kc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),kc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(kc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const kc=[new k,new k,new k,new k,new k,new k,new k,new k],Cc=new k,xf=new Gy,kf=new k,Cf=new k,Mf=new k,kh=new k,Ch=new k,Yu=new k,fg=new k,$S=new k,WS=new k,Zu=new k;function Zw(t,e,i,n,r){for(let s=0,o=t.length-3;s<=o;s+=3){Zu.fromArray(t,s);const a=r.x*Math.abs(Zu.x)+r.y*Math.abs(Zu.y)+r.z*Math.abs(Zu.z),l=e.dot(Zu),c=i.dot(Zu),u=n.dot(Zu);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const iQ=new Gy,mg=new k,Jw=new k;class LM{constructor(e=new k,i=-1){this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const n=this.center;i!==void 0?n.copy(i):iQ.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const n=this.center.distanceToSquared(e);return i.copy(e),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;mg.subVectors(e,this.center);const i=mg.lengthSq();if(i>this.radius*this.radius){const n=Math.sqrt(i),r=(n-this.radius)*.5;this.center.addScaledVector(mg,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Jw.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(mg.copy(e.center).add(Jw)),this.expandByPoint(mg.copy(e.center).sub(Jw))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Mc=new k,Qw=new k,GS=new k,Mh=new k,eT=new k,HS=new k,tT=new k;class nQ{constructor(e=new k,i=new k(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Mc)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=Mc.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(Mc.copy(this.origin).addScaledVector(this.direction,i),Mc.distanceToSquared(e))}distanceSqToSegment(e,i,n,r){Qw.copy(e).add(i).multiplyScalar(.5),GS.copy(i).sub(e).normalize(),Mh.copy(this.origin).sub(Qw);const s=e.distanceTo(i)*.5,o=-this.direction.dot(GS),a=Mh.dot(this.direction),l=-Mh.dot(GS),c=Mh.lengthSq(),u=Math.abs(1-o*o);let h,d,f,m;if(u>0)if(h=o*l-a,d=o*a-l,m=s*u,h>=0)if(d>=-m)if(d<=m){const g=1/u;h*=g,d*=g,f=h*(h+o*d+2*a)+d*(o*h+d+2*l)+c}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d<=-m?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c):d<=m?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(Qw).addScaledVector(GS,d),f}intersectSphere(e,i){Mc.subVectors(e.center,this.origin);const n=Mc.dot(this.direction),r=Mc.dot(Mc)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return l<0?null:a<0?this.at(l,i):this.at(a,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/i;return n>=0?n:null}intersectPlane(e,i){const n=this.distanceToPlane(e);return n===null?null:this.at(n,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let n,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),n>l||a>r)||((a>n||n!==n)&&(n=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,i)}intersectsBox(e){return this.intersectBox(e,Mc)!==null}intersectTriangle(e,i,n,r,s){eT.subVectors(i,e),HS.subVectors(n,e),tT.crossVectors(eT,HS);let o=this.direction.dot(tT),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Mh.subVectors(this.origin,e);const l=a*this.direction.dot(HS.crossVectors(Mh,HS));if(l<0)return null;const c=a*this.direction.dot(eT.cross(Mh));if(c<0||l+c>o)return null;const u=-a*Mh.dot(tT);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Pt{constructor(e,i,n,r,s,o,a,l,c,u,h,d,f,m,g,v){Pt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,n,r,s,o,a,l,c,u,h,d,f,m,g,v)}set(e,i,n,r,s,o,a,l,c,u,h,d,f,m,g,v){const p=this.elements;return p[0]=e,p[4]=i,p[8]=n,p[12]=r,p[1]=s,p[5]=o,p[9]=a,p[13]=l,p[2]=c,p[6]=u,p[10]=h,p[14]=d,p[3]=f,p[7]=m,p[11]=g,p[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Pt().fromArray(this.elements)}copy(e){const i=this.elements,n=e.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this}copyPosition(e){const i=this.elements,n=e.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,n){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,i,n){return this.set(e.x,i.x,n.x,0,e.y,i.y,n.y,0,e.z,i.z,n.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,n=e.elements,r=1/Af.setFromMatrixColumn(e,0).length(),s=1/Af.setFromMatrixColumn(e,1).length(),o=1/Af.setFromMatrixColumn(e,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[3]=0,i[4]=n[4]*s,i[5]=n[5]*s,i[6]=n[6]*s,i[7]=0,i[8]=n[8]*o,i[9]=n[9]*o,i[10]=n[10]*o,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=o*u,f=o*h,m=a*u,g=a*h;i[0]=l*u,i[4]=-l*h,i[8]=c,i[1]=f+m*c,i[5]=d-g*c,i[9]=-a*l,i[2]=g-d*c,i[6]=m+f*c,i[10]=o*l}else if(e.order==="YXZ"){const d=l*u,f=l*h,m=c*u,g=c*h;i[0]=d+g*a,i[4]=m*a-f,i[8]=o*c,i[1]=o*h,i[5]=o*u,i[9]=-a,i[2]=f*a-m,i[6]=g+d*a,i[10]=o*l}else if(e.order==="ZXY"){const d=l*u,f=l*h,m=c*u,g=c*h;i[0]=d-g*a,i[4]=-o*h,i[8]=m+f*a,i[1]=f+m*a,i[5]=o*u,i[9]=g-d*a,i[2]=-o*c,i[6]=a,i[10]=o*l}else if(e.order==="ZYX"){const d=o*u,f=o*h,m=a*u,g=a*h;i[0]=l*u,i[4]=m*c-f,i[8]=d*c+g,i[1]=l*h,i[5]=g*c+d,i[9]=f*c-m,i[2]=-c,i[6]=a*l,i[10]=o*l}else if(e.order==="YZX"){const d=o*l,f=o*c,m=a*l,g=a*c;i[0]=l*u,i[4]=g-d*h,i[8]=m*h+f,i[1]=h,i[5]=o*u,i[9]=-a*u,i[2]=-c*u,i[6]=f*h+m,i[10]=d-g*h}else if(e.order==="XZY"){const d=o*l,f=o*c,m=a*l,g=a*c;i[0]=l*u,i[4]=-h,i[8]=c*u,i[1]=d*h+g,i[5]=o*u,i[9]=f*h-m,i[2]=m*h-f,i[6]=a*u,i[10]=g*h+d}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(rQ,e,sQ)}lookAt(e,i,n){const r=this.elements;return Io.subVectors(e,i),Io.lengthSq()===0&&(Io.z=1),Io.normalize(),Ah.crossVectors(n,Io),Ah.lengthSq()===0&&(Math.abs(n.z)===1?Io.x+=1e-4:Io.z+=1e-4,Io.normalize(),Ah.crossVectors(n,Io)),Ah.normalize(),qS.crossVectors(Io,Ah),r[0]=Ah.x,r[4]=qS.x,r[8]=Io.x,r[1]=Ah.y,r[5]=qS.y,r[9]=Io.y,r[2]=Ah.z,r[6]=qS.z,r[10]=Io.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const n=e.elements,r=i.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],u=n[1],h=n[5],d=n[9],f=n[13],m=n[2],g=n[6],v=n[10],p=n[14],b=n[3],_=n[7],P=n[11],E=n[15],T=r[0],C=r[4],M=r[8],x=r[12],V=r[1],N=r[5],D=r[9],O=r[13],F=r[2],X=r[6],Z=r[10],K=r[14],z=r[3],H=r[7],re=r[11],ne=r[15];return s[0]=o*T+a*V+l*F+c*z,s[4]=o*C+a*N+l*X+c*H,s[8]=o*M+a*D+l*Z+c*re,s[12]=o*x+a*O+l*K+c*ne,s[1]=u*T+h*V+d*F+f*z,s[5]=u*C+h*N+d*X+f*H,s[9]=u*M+h*D+d*Z+f*re,s[13]=u*x+h*O+d*K+f*ne,s[2]=m*T+g*V+v*F+p*z,s[6]=m*C+g*N+v*X+p*H,s[10]=m*M+g*D+v*Z+p*re,s[14]=m*x+g*O+v*K+p*ne,s[3]=b*T+_*V+P*F+E*z,s[7]=b*C+_*N+P*X+E*H,s[11]=b*M+_*D+P*Z+E*re,s[15]=b*x+_*O+P*K+E*ne,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],h=e[6],d=e[10],f=e[14],m=e[3],g=e[7],v=e[11],p=e[15];return m*(+s*l*h-r*c*h-s*a*d+n*c*d+r*a*f-n*l*f)+g*(+i*l*f-i*c*d+s*o*d-r*o*f+r*c*u-s*l*u)+v*(+i*c*h-i*a*f-s*o*h+n*o*f+s*a*u-n*c*u)+p*(-r*a*u-i*l*h+i*a*d+r*o*h-n*o*d+n*l*u)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=i,r[14]=n),this}invert(){const e=this.elements,i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],m=e[12],g=e[13],v=e[14],p=e[15],b=h*v*c-g*d*c+g*l*f-a*v*f-h*l*p+a*d*p,_=m*d*c-u*v*c-m*l*f+o*v*f+u*l*p-o*d*p,P=u*g*c-m*h*c+m*a*f-o*g*f-u*a*p+o*h*p,E=m*h*l-u*g*l-m*a*d+o*g*d+u*a*v-o*h*v,T=i*b+n*_+r*P+s*E;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/T;return e[0]=b*C,e[1]=(g*d*s-h*v*s-g*r*f+n*v*f+h*r*p-n*d*p)*C,e[2]=(a*v*s-g*l*s+g*r*c-n*v*c-a*r*p+n*l*p)*C,e[3]=(h*l*s-a*d*s-h*r*c+n*d*c+a*r*f-n*l*f)*C,e[4]=_*C,e[5]=(u*v*s-m*d*s+m*r*f-i*v*f-u*r*p+i*d*p)*C,e[6]=(m*l*s-o*v*s-m*r*c+i*v*c+o*r*p-i*l*p)*C,e[7]=(o*d*s-u*l*s+u*r*c-i*d*c-o*r*f+i*l*f)*C,e[8]=P*C,e[9]=(m*h*s-u*g*s-m*n*f+i*g*f+u*n*p-i*h*p)*C,e[10]=(o*g*s-m*a*s+m*n*c-i*g*c-o*n*p+i*a*p)*C,e[11]=(u*a*s-o*h*s-u*n*c+i*h*c+o*n*f-i*a*f)*C,e[12]=E*C,e[13]=(u*g*r-m*h*r+m*n*d-i*g*d-u*n*v+i*h*v)*C,e[14]=(m*a*r-o*g*r-m*n*l+i*g*l+o*n*v-i*a*v)*C,e[15]=(o*h*r-u*a*r+u*n*l-i*h*l-o*n*d+i*a*d)*C,this}scale(e){const i=this.elements,n=e.x,r=e.y,s=e.z;return i[0]*=n,i[4]*=r,i[8]*=s,i[1]*=n,i[5]*=r,i[9]*=s,i[2]*=n,i[6]*=r,i[10]*=s,i[3]*=n,i[7]*=r,i[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,n,r))}makeTranslation(e,i,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,n,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),n=Math.sin(e);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const n=Math.cos(i),r=Math.sin(i),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+n,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,i,n){return this.set(e,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,i,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,i,r,1,0,0,0,0,1),this}compose(e,i,n){const r=this.elements,s=i._x,o=i._y,a=i._z,l=i._w,c=s+s,u=o+o,h=a+a,d=s*c,f=s*u,m=s*h,g=o*u,v=o*h,p=a*h,b=l*c,_=l*u,P=l*h,E=n.x,T=n.y,C=n.z;return r[0]=(1-(g+p))*E,r[1]=(f+P)*E,r[2]=(m-_)*E,r[3]=0,r[4]=(f-P)*T,r[5]=(1-(d+p))*T,r[6]=(v+b)*T,r[7]=0,r[8]=(m+_)*C,r[9]=(v-b)*C,r[10]=(1-(d+g))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,i,n){const r=this.elements;let s=Af.set(r[0],r[1],r[2]).length();const o=Af.set(r[4],r[5],r[6]).length(),a=Af.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],$a.copy(this);const c=1/s,u=1/o,h=1/a;return $a.elements[0]*=c,$a.elements[1]*=c,$a.elements[2]*=c,$a.elements[4]*=u,$a.elements[5]*=u,$a.elements[6]*=u,$a.elements[8]*=h,$a.elements[9]*=h,$a.elements[10]*=h,i.setFromRotationMatrix($a),n.x=s,n.y=o,n.z=a,this}makePerspective(e,i,n,r,s,o,a=Gc){const l=this.elements,c=2*s/(i-e),u=2*s/(n-r),h=(i+e)/(i-e),d=(n+r)/(n-r);let f,m;if(a===Gc)f=-(o+s)/(o-s),m=-2*o*s/(o-s);else if(a===r_)f=-o/(o-s),m=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=m,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,i,n,r,s,o,a=Gc){const l=this.elements,c=1/(i-e),u=1/(n-r),h=1/(o-s),d=(i+e)*c,f=(n+r)*u;let m,g;if(a===Gc)m=(o+s)*h,g=-2*h;else if(a===r_)m=s*h,g=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=g,l[14]=-m,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const i=this.elements,n=e.elements;for(let r=0;r<16;r++)if(i[r]!==n[r])return!1;return!0}fromArray(e,i=0){for(let n=0;n<16;n++)this.elements[n]=e[n+i];return this}toArray(e=[],i=0){const n=this.elements;return e[i]=n[0],e[i+1]=n[1],e[i+2]=n[2],e[i+3]=n[3],e[i+4]=n[4],e[i+5]=n[5],e[i+6]=n[6],e[i+7]=n[7],e[i+8]=n[8],e[i+9]=n[9],e[i+10]=n[10],e[i+11]=n[11],e[i+12]=n[12],e[i+13]=n[13],e[i+14]=n[14],e[i+15]=n[15],e}}const Af=new k,$a=new Pt,rQ=new k(0,0,0),sQ=new k(1,1,1),Ah=new k,qS=new k,Io=new k,$O=new Pt,WO=new _u;class xP{constructor(e=0,i=0,n=0,r=xP.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,n,r=this._order){return this._x=e,this._y=i,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,n=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],h=r[2],d=r[6],f=r[10];switch(i){case"XYZ":this._y=Math.asin(po(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-po(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(po(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-po(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(po(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-po(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,n){return $O.makeRotationFromQuaternion(e),this.setFromRotationMatrix($O,i,n)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return WO.setFromEuler(this),this.setFromQuaternion(WO,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}xP.DEFAULT_ORDER="XYZ";class e4{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let oQ=0;const GO=new k,Vf=new _u,Ac=new Pt,KS=new k,pg=new k,aQ=new k,lQ=new _u,HO=new k(1,0,0),qO=new k(0,1,0),KO=new k(0,0,1),cQ={type:"added"},XO={type:"removed"};class _o extends zp{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:oQ++}),this.uuid=Wy(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=_o.DEFAULT_UP.clone();const e=new k,i=new xP,n=new _u,r=new k(1,1,1);function s(){n.setFromEuler(i,!1)}function o(){i.setFromQuaternion(n,void 0,!1)}i._onChange(s),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Pt},normalMatrix:{value:new Ti}}),this.matrix=new Pt,this.matrixWorld=new Pt,this.matrixAutoUpdate=_o.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=_o.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new e4,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return Vf.setFromAxisAngle(e,i),this.quaternion.multiply(Vf),this}rotateOnWorldAxis(e,i){return Vf.setFromAxisAngle(e,i),this.quaternion.premultiply(Vf),this}rotateX(e){return this.rotateOnAxis(HO,e)}rotateY(e){return this.rotateOnAxis(qO,e)}rotateZ(e){return this.rotateOnAxis(KO,e)}translateOnAxis(e,i){return GO.copy(e).applyQuaternion(this.quaternion),this.position.add(GO.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(HO,e)}translateY(e){return this.translateOnAxis(qO,e)}translateZ(e){return this.translateOnAxis(KO,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ac.copy(this.matrixWorld).invert())}lookAt(e,i,n){e.isVector3?KS.copy(e):KS.set(e,i,n);const r=this.parent;this.updateWorldMatrix(!0,!1),pg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ac.lookAt(pg,KS,this.up):Ac.lookAt(KS,pg,this.up),this.quaternion.setFromRotationMatrix(Ac),r&&(Ac.extractRotation(r.matrixWorld),Vf.setFromRotationMatrix(Ac),this.quaternion.premultiply(Vf.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(cQ)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(XO)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const i=this.children[e];i.parent=null,i.dispatchEvent(XO)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Ac.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ac.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ac),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,i);if(o!==void 0)return o}}getObjectsByProperty(e,i){let n=[];this[e]===i&&n.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(e,i);o.length>0&&(n=n.concat(o))}return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(pg,e,aQ),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(pg,lQ,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let n=0,r=i.length;n<r;n++){const s=i[n];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,i){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const i=e===void 0||typeof e=="string",n={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const h=l[c];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(i){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),h=o(e.shapes),d=o(e.skeletons),f=o(e.animations),m=o(e.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),u.length>0&&(n.images=u),h.length>0&&(n.shapes=h),d.length>0&&(n.skeletons=d),f.length>0&&(n.animations=f),m.length>0&&(n.nodes=m)}return n.object=r,n;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations,this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}_o.DEFAULT_UP=new k(0,1,0);_o.DEFAULT_MATRIX_AUTO_UPDATE=!0;_o.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Wa=new k,Vc=new k,iT=new k,Lc=new k,Lf=new k,If=new k,YO=new k,nT=new k,rT=new k,sT=new k;let XS=!1;class nl{constructor(e=new k,i=new k,n=new k){this.a=e,this.b=i,this.c=n}static getNormal(e,i,n,r){r.subVectors(n,i),Wa.subVectors(e,i),r.cross(Wa);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,i,n,r,s){Wa.subVectors(r,i),Vc.subVectors(n,i),iT.subVectors(e,i);const o=Wa.dot(Wa),a=Wa.dot(Vc),l=Wa.dot(iT),c=Vc.dot(Vc),u=Vc.dot(iT),h=o*c-a*a;if(h===0)return s.set(-2,-1,-1);const d=1/h,f=(c*l-a*u)*d,m=(o*u-a*l)*d;return s.set(1-f-m,m,f)}static containsPoint(e,i,n,r){return this.getBarycoord(e,i,n,r,Lc),Lc.x>=0&&Lc.y>=0&&Lc.x+Lc.y<=1}static getUV(e,i,n,r,s,o,a,l){return XS===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),XS=!0),this.getInterpolation(e,i,n,r,s,o,a,l)}static getInterpolation(e,i,n,r,s,o,a,l){return this.getBarycoord(e,i,n,r,Lc),l.setScalar(0),l.addScaledVector(s,Lc.x),l.addScaledVector(o,Lc.y),l.addScaledVector(a,Lc.z),l}static isFrontFacing(e,i,n,r){return Wa.subVectors(n,i),Vc.subVectors(e,i),Wa.cross(Vc).dot(r)<0}set(e,i,n){return this.a.copy(e),this.b.copy(i),this.c.copy(n),this}setFromPointsAndIndices(e,i,n,r){return this.a.copy(e[i]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,i,n,r){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Wa.subVectors(this.c,this.b),Vc.subVectors(this.a,this.b),Wa.cross(Vc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return nl.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return nl.getBarycoord(e,this.a,this.b,this.c,i)}getUV(e,i,n,r,s){return XS===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),XS=!0),nl.getInterpolation(e,this.a,this.b,this.c,i,n,r,s)}getInterpolation(e,i,n,r,s){return nl.getInterpolation(e,this.a,this.b,this.c,i,n,r,s)}containsPoint(e){return nl.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return nl.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const n=this.a,r=this.b,s=this.c;let o,a;Lf.subVectors(r,n),If.subVectors(s,n),nT.subVectors(e,n);const l=Lf.dot(nT),c=If.dot(nT);if(l<=0&&c<=0)return i.copy(n);rT.subVectors(e,r);const u=Lf.dot(rT),h=If.dot(rT);if(u>=0&&h<=u)return i.copy(r);const d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),i.copy(n).addScaledVector(Lf,o);sT.subVectors(e,s);const f=Lf.dot(sT),m=If.dot(sT);if(m>=0&&f<=m)return i.copy(s);const g=f*c-l*m;if(g<=0&&c>=0&&m<=0)return a=c/(c-m),i.copy(n).addScaledVector(If,a);const v=u*m-f*h;if(v<=0&&h-u>=0&&f-m>=0)return YO.subVectors(s,r),a=(h-u)/(h-u+(f-m)),i.copy(r).addScaledVector(YO,a);const p=1/(v+g+d);return o=g*p,a=d*p,i.copy(n).addScaledVector(Lf,o).addScaledVector(If,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let hQ=0;class Hy extends zp{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:hQ++}),this.uuid=Wy(),this.name="",this.type="Material",this.blending=Im,this.side=Cu,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=R3,this.blendDst=F3,this.blendEquation=rm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Pk,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=RJ,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ww,this.stencilZFail=Ww,this.stencilZPass=Ww,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const n=e[i];if(n===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}const r=this[i];if(r===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[i]=n}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Im&&(n.blending=this.blending),this.side!==Cu&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let n=null;if(i!==null){const r=i.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=i[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const t4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ga={h:0,s:0,l:0},YS={h:0,s:0,l:0};function oT(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*6*(2/3-i):t}let hn=class{constructor(e,i,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,n)}set(e,i,n){if(i===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,i,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=yi){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ja.toWorkingColorSpace(this,i),this}setRGB(e,i,n,r=ja.workingColorSpace){return this.r=e,this.g=i,this.b=n,ja.toWorkingColorSpace(this,r),this}setHSL(e,i,n,r=ja.workingColorSpace){if(e=HJ(e,1),i=po(i,0,1),n=po(n,0,1),i===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+i):n+i-n*i,o=2*n-s;this.r=oT(o,s,e+1/3),this.g=oT(o,s,e),this.b=oT(o,s,e-1/3)}return ja.toWorkingColorSpace(this,r),this}setStyle(e,i=yi){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,i);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,i);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,i);if(o===6)return this.setHex(parseInt(s,16),i);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,i);return this}setColorName(e,i=yi){const n=t4[e.toLowerCase()];return n!==void 0?this.setHex(n,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Om(e.r),this.g=Om(e.g),this.b=Om(e.b),this}copyLinearToSRGB(e){return this.r=Kw(e.r),this.g=Kw(e.g),this.b=Kw(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=yi){return ja.fromWorkingColorSpace(fs.copy(this),e),Math.round(po(fs.r*255,0,255))*65536+Math.round(po(fs.g*255,0,255))*256+Math.round(po(fs.b*255,0,255))}getHexString(e=yi){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=ja.workingColorSpace){ja.fromWorkingColorSpace(fs.copy(this),i);const n=fs.r,r=fs.g,s=fs.b,o=Math.max(n,r,s),a=Math.min(n,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const h=o-a;switch(c=u<=.5?h/(o+a):h/(2-o-a),o){case n:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-n)/h+2;break;case s:l=(n-r)/h+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,i=ja.workingColorSpace){return ja.fromWorkingColorSpace(fs.copy(this),i),e.r=fs.r,e.g=fs.g,e.b=fs.b,e}getStyle(e=yi){ja.fromWorkingColorSpace(fs.copy(this),e);const i=fs.r,n=fs.g,r=fs.b;return e!==yi?`color(${e} ${i.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(i*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,i,n){return this.getHSL(Ga),Ga.h+=e,Ga.s+=i,Ga.l+=n,this.setHSL(Ga.h,Ga.s,Ga.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,n){return this.r=e.r+(i.r-e.r)*n,this.g=e.g+(i.g-e.g)*n,this.b=e.b+(i.b-e.b)*n,this}lerpHSL(e,i){this.getHSL(Ga),e.getHSL(YS);const n=Hw(Ga.h,YS.h,i),r=Hw(Ga.s,YS.s,i),s=Hw(Ga.l,YS.l,i);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const i=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*i+s[3]*n+s[6]*r,this.g=s[1]*i+s[4]*n+s[7]*r,this.b=s[2]*i+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const fs=new hn;hn.NAMES=t4;class i4 extends Hy{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new hn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=z3,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const ar=new k,ZS=new Pi;class rc{constructor(e,i,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=n,this.usage=FO,this.updateRange={offset:0,count:-1},this.gpuType=uu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,i,n){e*=this.itemSize,n*=i.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=i.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)ZS.fromBufferAttribute(this,i),ZS.applyMatrix3(e),this.setXY(i,ZS.x,ZS.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)ar.fromBufferAttribute(this,i),ar.applyMatrix3(e),this.setXYZ(i,ar.x,ar.y,ar.z);return this}applyMatrix4(e){for(let i=0,n=this.count;i<n;i++)ar.fromBufferAttribute(this,i),ar.applyMatrix4(e),this.setXYZ(i,ar.x,ar.y,ar.z);return this}applyNormalMatrix(e){for(let i=0,n=this.count;i<n;i++)ar.fromBufferAttribute(this,i),ar.applyNormalMatrix(e),this.setXYZ(i,ar.x,ar.y,ar.z);return this}transformDirection(e){for(let i=0,n=this.count;i<n;i++)ar.fromBufferAttribute(this,i),ar.transformDirection(e),this.setXYZ(i,ar.x,ar.y,ar.z);return this}set(e,i=0){return this.array.set(e,i),this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=jS(i,this.array)),i}setX(e,i){return this.normalized&&(i=Lo(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=jS(i,this.array)),i}setY(e,i){return this.normalized&&(i=Lo(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=jS(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Lo(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=jS(i,this.array)),i}setW(e,i){return this.normalized&&(i=Lo(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,n){return e*=this.itemSize,this.normalized&&(i=Lo(i,this.array),n=Lo(n,this.array)),this.array[e+0]=i,this.array[e+1]=n,this}setXYZ(e,i,n,r){return e*=this.itemSize,this.normalized&&(i=Lo(i,this.array),n=Lo(n,this.array),r=Lo(r,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,i,n,r,s){return e*=this.itemSize,this.normalized&&(i=Lo(i,this.array),n=Lo(n,this.array),r=Lo(r,this.array),s=Lo(s,this.array)),this.array[e+0]=i,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==FO&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class n4 extends rc{constructor(e,i,n){super(new Uint16Array(e),i,n)}}class r4 extends rc{constructor(e,i,n){super(new Uint32Array(e),i,n)}}class sc extends rc{constructor(e,i,n){super(new Float32Array(e),i,n)}}let uQ=0;const oa=new Pt,aT=new _o,Of=new k,Oo=new Gy,gg=new Gy,Ir=new k;class Du extends zp{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:uQ++}),this.uuid=Wy(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Y3(e)?r4:n4)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,n=0){this.groups.push({start:e,count:i,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Ti().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return oa.makeRotationFromQuaternion(e),this.applyMatrix4(oa),this}rotateX(e){return oa.makeRotationX(e),this.applyMatrix4(oa),this}rotateY(e){return oa.makeRotationY(e),this.applyMatrix4(oa),this}rotateZ(e){return oa.makeRotationZ(e),this.applyMatrix4(oa),this}translate(e,i,n){return oa.makeTranslation(e,i,n),this.applyMatrix4(oa),this}scale(e,i,n){return oa.makeScale(e,i,n),this.applyMatrix4(oa),this}lookAt(e){return aT.lookAt(e),aT.updateMatrix(),this.applyMatrix4(aT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Of).negate(),this.translate(Of.x,Of.y,Of.z),this}setFromPoints(e){const i=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];i.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new sc(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Gy);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new k(-1/0,-1/0,-1/0),new k(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let n=0,r=i.length;n<r;n++){const s=i[n];Oo.setFromBufferAttribute(s),this.morphTargetsRelative?(Ir.addVectors(this.boundingBox.min,Oo.min),this.boundingBox.expandByPoint(Ir),Ir.addVectors(this.boundingBox.max,Oo.max),this.boundingBox.expandByPoint(Ir)):(this.boundingBox.expandByPoint(Oo.min),this.boundingBox.expandByPoint(Oo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new LM);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new k,1/0);return}if(e){const n=this.boundingSphere.center;if(Oo.setFromBufferAttribute(e),i)for(let s=0,o=i.length;s<o;s++){const a=i[s];gg.setFromBufferAttribute(a),this.morphTargetsRelative?(Ir.addVectors(Oo.min,gg.min),Oo.expandByPoint(Ir),Ir.addVectors(Oo.max,gg.max),Oo.expandByPoint(Ir)):(Oo.expandByPoint(gg.min),Oo.expandByPoint(gg.max))}Oo.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Ir.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Ir));if(i)for(let s=0,o=i.length;s<o;s++){const a=i[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Ir.fromBufferAttribute(a,c),l&&(Of.fromBufferAttribute(e,c),Ir.add(Of)),r=Math.max(r,n.distanceToSquared(Ir))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=e.array,r=i.position.array,s=i.normal.array,o=i.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new rc(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let V=0;V<a;V++)c[V]=new k,u[V]=new k;const h=new k,d=new k,f=new k,m=new Pi,g=new Pi,v=new Pi,p=new k,b=new k;function _(V,N,D){h.fromArray(r,V*3),d.fromArray(r,N*3),f.fromArray(r,D*3),m.fromArray(o,V*2),g.fromArray(o,N*2),v.fromArray(o,D*2),d.sub(h),f.sub(h),g.sub(m),v.sub(m);const O=1/(g.x*v.y-v.x*g.y);isFinite(O)&&(p.copy(d).multiplyScalar(v.y).addScaledVector(f,-g.y).multiplyScalar(O),b.copy(f).multiplyScalar(g.x).addScaledVector(d,-v.x).multiplyScalar(O),c[V].add(p),c[N].add(p),c[D].add(p),u[V].add(b),u[N].add(b),u[D].add(b))}let P=this.groups;P.length===0&&(P=[{start:0,count:n.length}]);for(let V=0,N=P.length;V<N;++V){const D=P[V],O=D.start,F=D.count;for(let X=O,Z=O+F;X<Z;X+=3)_(n[X+0],n[X+1],n[X+2])}const E=new k,T=new k,C=new k,M=new k;function x(V){C.fromArray(s,V*3),M.copy(C);const N=c[V];E.copy(N),E.sub(C.multiplyScalar(C.dot(N))).normalize(),T.crossVectors(M,N);const O=T.dot(u[V])<0?-1:1;l[V*4]=E.x,l[V*4+1]=E.y,l[V*4+2]=E.z,l[V*4+3]=O}for(let V=0,N=P.length;V<N;++V){const D=P[V],O=D.start,F=D.count;for(let X=O,Z=O+F;X<Z;X+=3)x(n[X+0]),x(n[X+1]),x(n[X+2])}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new rc(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let d=0,f=n.count;d<f;d++)n.setXYZ(d,0,0,0);const r=new k,s=new k,o=new k,a=new k,l=new k,c=new k,u=new k,h=new k;if(e)for(let d=0,f=e.count;d<f;d+=3){const m=e.getX(d+0),g=e.getX(d+1),v=e.getX(d+2);r.fromBufferAttribute(i,m),s.fromBufferAttribute(i,g),o.fromBufferAttribute(i,v),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(n,m),l.fromBufferAttribute(n,g),c.fromBufferAttribute(n,v),a.add(u),l.add(u),c.add(u),n.setXYZ(m,a.x,a.y,a.z),n.setXYZ(g,l.x,l.y,l.z),n.setXYZ(v,c.x,c.y,c.z)}else for(let d=0,f=i.count;d<f;d+=3)r.fromBufferAttribute(i,d+0),s.fromBufferAttribute(i,d+1),o.fromBufferAttribute(i,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),n.setXYZ(d+0,u.x,u.y,u.z),n.setXYZ(d+1,u.x,u.y,u.z),n.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let i=0,n=e.count;i<n;i++)Ir.fromBufferAttribute(e,i),Ir.normalize(),e.setXYZ(i,Ir.x,Ir.y,Ir.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,h=a.normalized,d=new c.constructor(l.length*u);let f=0,m=0;for(let g=0,v=l.length;g<v;g++){a.isInterleavedBufferAttribute?f=l[g]*a.data.stride+a.offset:f=l[g]*u;for(let p=0;p<u;p++)d[m++]=c[f++]}return new rc(d,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new Du,n=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,n);i.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){const d=c[u],f=e(d,n);l.push(f)}i.morphAttributes[a]=l}i.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];i.addGroup(c.start,c.count,c.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const l in n){const c=n[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++){const f=c[h];u.push(f.toJSON(e.data))}u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(i));const r=e.attributes;for(const c in r){const u=r[c];this.setAttribute(c,u.clone(i))}const s=e.morphAttributes;for(const c in s){const u=[],h=s[c];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(i));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const ZO=new Pt,Ju=new nQ,JS=new LM,JO=new k,Df=new k,Nf=new k,Rf=new k,lT=new k,QS=new k,eb=new Pi,tb=new Pi,ib=new Pi,QO=new k,eD=new k,tD=new k,nb=new k,rb=new k;class Hc extends _o{constructor(e=new Du,i=new i4){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,i){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;i.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){QS.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],h=s[l];u!==0&&(lT.fromBufferAttribute(h,e),o?QS.addScaledVector(lT,u):QS.addScaledVector(lT.sub(i),u))}i.add(QS)}return i}raycast(e,i){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),JS.copy(n.boundingSphere),JS.applyMatrix4(s),Ju.copy(e.ray).recast(e.near),!(JS.containsPoint(Ju.origin)===!1&&(Ju.intersectSphere(JS,JO)===null||Ju.origin.distanceToSquared(JO)>(e.far-e.near)**2))&&(ZO.copy(s).invert(),Ju.copy(e.ray).applyMatrix4(ZO),!(n.boundingBox!==null&&Ju.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,i,Ju)))}_computeIntersections(e,i,n){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(a!==null)if(Array.isArray(o))for(let m=0,g=d.length;m<g;m++){const v=d[m],p=o[v.materialIndex],b=Math.max(v.start,f.start),_=Math.min(a.count,Math.min(v.start+v.count,f.start+f.count));for(let P=b,E=_;P<E;P+=3){const T=a.getX(P),C=a.getX(P+1),M=a.getX(P+2);r=sb(this,p,e,n,c,u,h,T,C,M),r&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=v.materialIndex,i.push(r))}}else{const m=Math.max(0,f.start),g=Math.min(a.count,f.start+f.count);for(let v=m,p=g;v<p;v+=3){const b=a.getX(v),_=a.getX(v+1),P=a.getX(v+2);r=sb(this,o,e,n,c,u,h,b,_,P),r&&(r.faceIndex=Math.floor(v/3),i.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let m=0,g=d.length;m<g;m++){const v=d[m],p=o[v.materialIndex],b=Math.max(v.start,f.start),_=Math.min(l.count,Math.min(v.start+v.count,f.start+f.count));for(let P=b,E=_;P<E;P+=3){const T=P,C=P+1,M=P+2;r=sb(this,p,e,n,c,u,h,T,C,M),r&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=v.materialIndex,i.push(r))}}else{const m=Math.max(0,f.start),g=Math.min(l.count,f.start+f.count);for(let v=m,p=g;v<p;v+=3){const b=v,_=v+1,P=v+2;r=sb(this,o,e,n,c,u,h,b,_,P),r&&(r.faceIndex=Math.floor(v/3),i.push(r))}}}}function dQ(t,e,i,n,r,s,o,a){let l;if(e.side===bo?l=n.intersectTriangle(o,s,r,!0,a):l=n.intersectTriangle(r,s,o,e.side===Cu,a),l===null)return null;rb.copy(a),rb.applyMatrix4(t.matrixWorld);const c=i.ray.origin.distanceTo(rb);return c<i.near||c>i.far?null:{distance:c,point:rb.clone(),object:t}}function sb(t,e,i,n,r,s,o,a,l,c){t.getVertexPosition(a,Df),t.getVertexPosition(l,Nf),t.getVertexPosition(c,Rf);const u=dQ(t,e,i,n,Df,Nf,Rf,nb);if(u){r&&(eb.fromBufferAttribute(r,a),tb.fromBufferAttribute(r,l),ib.fromBufferAttribute(r,c),u.uv=nl.getInterpolation(nb,Df,Nf,Rf,eb,tb,ib,new Pi)),s&&(eb.fromBufferAttribute(s,a),tb.fromBufferAttribute(s,l),ib.fromBufferAttribute(s,c),u.uv1=nl.getInterpolation(nb,Df,Nf,Rf,eb,tb,ib,new Pi),u.uv2=u.uv1),o&&(QO.fromBufferAttribute(o,a),eD.fromBufferAttribute(o,l),tD.fromBufferAttribute(o,c),u.normal=nl.getInterpolation(nb,Df,Nf,Rf,QO,eD,tD,new k),u.normal.dot(n.direction)>0&&u.normal.multiplyScalar(-1));const h={a,b:l,c,normal:new k,materialIndex:0};nl.getNormal(Df,Nf,Rf,h.normal),u.face=h}return u}class qy extends Du{constructor(e=1,i=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],h=[];let d=0,f=0;m("z","y","x",-1,-1,n,i,e,o,s,0),m("z","y","x",1,-1,n,i,-e,o,s,1),m("x","z","y",1,1,e,n,i,r,o,2),m("x","z","y",1,-1,e,n,-i,r,o,3),m("x","y","z",1,-1,e,i,n,r,s,4),m("x","y","z",-1,-1,e,i,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new sc(c,3)),this.setAttribute("normal",new sc(u,3)),this.setAttribute("uv",new sc(h,2));function m(g,v,p,b,_,P,E,T,C,M,x){const V=P/C,N=E/M,D=P/2,O=E/2,F=T/2,X=C+1,Z=M+1;let K=0,z=0;const H=new k;for(let re=0;re<Z;re++){const ne=re*N-O;for(let B=0;B<X;B++){const Q=B*V-D;H[g]=Q*b,H[v]=ne*_,H[p]=F,c.push(H.x,H.y,H.z),H[g]=0,H[v]=0,H[p]=T>0?1:-1,u.push(H.x,H.y,H.z),h.push(B/C),h.push(1-re/M),K+=1}}for(let re=0;re<M;re++)for(let ne=0;ne<C;ne++){const B=d+ne+X*re,Q=d+ne+X*(re+1),fe=d+(ne+1)+X*(re+1),ie=d+(ne+1)+X*re;l.push(B,Q,ie),l.push(Q,fe,ie),z+=6}a.addGroup(f,z,x),f+=z,d+=K}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qy(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function tp(t){const e={};for(const i in t){e[i]={};for(const n in t[i]){const r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][n]=null):e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e}function zs(t){const e={};for(let i=0;i<t.length;i++){const n=tp(t[i]);for(const r in n)e[r]=n[r]}return e}function fQ(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].clone());return e}function s4(t){return t.getRenderTarget()===null?t.outputColorSpace:fc}const mQ={clone:tp,merge:zs};var pQ=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,gQ=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class $d extends Hy{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=pQ,this.fragmentShader=gQ,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=tp(e.uniforms),this.uniformsGroups=fQ(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?i.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?i.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?i.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?i.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?i.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?i.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?i.uniforms[r]={type:"m4",value:o.toArray()}:i.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader,i.lights=this.lights,i.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(i.extensions=n),i}}class o4 extends _o{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Pt,this.projectionMatrix=new Pt,this.projectionMatrixInverse=new Pt,this.coordinateSystem=Gc}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(-i[8],-i[9],-i[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class ga extends o4{constructor(e=50,i=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=Ck*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Gw*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Ck*2*Math.atan(Math.tan(Gw*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,i,n,r,s,o){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(Gw*.5*this.fov)/this.zoom,n=2*i,r=this.aspect*n,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,i-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,i,i-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const Ff=-90,zf=1;class vQ extends _o{constructor(e,i,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null;const r=new ga(Ff,zf,e,i);r.layers=this.layers,this.add(r);const s=new ga(Ff,zf,e,i);s.layers=this.layers,this.add(s);const o=new ga(Ff,zf,e,i);o.layers=this.layers,this.add(o);const a=new ga(Ff,zf,e,i);a.layers=this.layers,this.add(a);const l=new ga(Ff,zf,e,i);l.layers=this.layers,this.add(l);const c=new ga(Ff,zf,e,i);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,i=this.children.concat(),[n,r,s,o,a,l]=i;for(const c of i)this.remove(c);if(e===Gc)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===r_)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of i)this.add(c),c.updateMatrixWorld()}update(e,i){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),h=e.toneMapping,d=e.xr.enabled;e.toneMapping=th,e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(i,r),e.setRenderTarget(n,1),e.render(i,s),e.setRenderTarget(n,2),e.render(i,o),e.setRenderTarget(n,3),e.render(i,a),e.setRenderTarget(n,4),e.render(i,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(i,c),e.setRenderTarget(u),e.toneMapping=h,e.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}class a4 extends Ec{constructor(e,i,n,r,s,o,a,l,c,u){e=e!==void 0?e:[],i=i!==void 0?i:Jm,super(e,i,n,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class yQ extends jd{constructor(e=1,i={}){super(e,e,i),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];i.encoding!==void 0&&(Xg("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Ad?yi:Vd),this.texture=new a4(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:pa}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new qy(5,5,5),s=new $d({name:"CubemapFromEquirect",uniforms:tp(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:bo,blending:Su});s.uniforms.tEquirect.value=i;const o=new Hc(r,s),a=i.minFilter;return i.minFilter===Ov&&(i.minFilter=pa),new vQ(1,10,this).update(e,o),i.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,i,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(i,n,r);e.setRenderTarget(s)}}const cT=new k,SQ=new k,bQ=new Ti;class od{constructor(e=new k(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,n,r){return this.normal.set(e,i,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,n){const r=cT.subVectors(n,i).cross(SQ.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,i){const n=e.delta(cT),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:i.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const i=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return i<0&&n>0||n<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const n=i||bQ.getNormalMatrix(e),r=this.coplanarPoint(cT).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Qu=new LM,ob=new k;class IM{constructor(e=new od,i=new od,n=new od,r=new od,s=new od,o=new od){this.planes=[e,i,n,r,s,o]}set(e,i,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(i),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const i=this.planes;for(let n=0;n<6;n++)i[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,i=Gc){const n=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],u=r[5],h=r[6],d=r[7],f=r[8],m=r[9],g=r[10],v=r[11],p=r[12],b=r[13],_=r[14],P=r[15];if(n[0].setComponents(l-s,d-c,v-f,P-p).normalize(),n[1].setComponents(l+s,d+c,v+f,P+p).normalize(),n[2].setComponents(l+o,d+u,v+m,P+b).normalize(),n[3].setComponents(l-o,d-u,v-m,P-b).normalize(),n[4].setComponents(l-a,d-h,v-g,P-_).normalize(),i===Gc)n[5].setComponents(l+a,d+h,v+g,P+_).normalize();else if(i===r_)n[5].setComponents(a,h,g,_).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Qu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const i=e.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),Qu.copy(i.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Qu)}intersectsSprite(e){return Qu.center.set(0,0,0),Qu.radius=.7071067811865476,Qu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Qu)}intersectsSphere(e){const i=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(i[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const i=this.planes;for(let n=0;n<6;n++){const r=i[n];if(ob.x=r.normal.x>0?e.max.x:e.min.x,ob.y=r.normal.y>0?e.max.y:e.min.y,ob.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(ob)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let n=0;n<6;n++)if(i[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function l4(){let t=null,e=!1,i=null,n=null;function r(s,o){i(s,o),n=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&i!==null&&(n=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){i=s},setContext:function(s){t=s}}}function _Q(t,e){const i=e.isWebGL2,n=new WeakMap;function r(c,u){const h=c.array,d=c.usage,f=t.createBuffer();t.bindBuffer(u,f),t.bufferData(u,h,d),c.onUploadCallback();let m;if(h instanceof Float32Array)m=t.FLOAT;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(i)m=t.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else m=t.UNSIGNED_SHORT;else if(h instanceof Int16Array)m=t.SHORT;else if(h instanceof Uint32Array)m=t.UNSIGNED_INT;else if(h instanceof Int32Array)m=t.INT;else if(h instanceof Int8Array)m=t.BYTE;else if(h instanceof Uint8Array)m=t.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)m=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:f,type:m,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function s(c,u,h){const d=u.array,f=u.updateRange;t.bindBuffer(h,c),f.count===-1?t.bufferSubData(h,0,d):(i?t.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):t.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);u&&(t.deleteBuffer(u.buffer),n.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const d=n.get(c);(!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const h=n.get(c);h===void 0?n.set(c,r(c,u)):h.version<c.version&&(s(h.buffer,c,u),h.version=c.version)}return{get:o,remove:a,update:l}}class OM extends Du{constructor(e=1,i=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:n,heightSegments:r};const s=e/2,o=i/2,a=Math.floor(n),l=Math.floor(r),c=a+1,u=l+1,h=e/a,d=i/l,f=[],m=[],g=[],v=[];for(let p=0;p<u;p++){const b=p*d-o;for(let _=0;_<c;_++){const P=_*h-s;m.push(P,-b,0),g.push(0,0,1),v.push(_/a),v.push(1-p/l)}}for(let p=0;p<l;p++)for(let b=0;b<a;b++){const _=b+c*p,P=b+c*(p+1),E=b+1+c*(p+1),T=b+1+c*p;f.push(_,P,T),f.push(P,E,T)}this.setIndex(f),this.setAttribute("position",new sc(m,3)),this.setAttribute("normal",new sc(g,3)),this.setAttribute("uv",new sc(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new OM(e.width,e.height,e.widthSegments,e.heightSegments)}}var PQ=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,EQ=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,wQ=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,TQ=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,xQ=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,kQ=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,CQ="vec3 transformed = vec3( position );",MQ=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,AQ=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,VQ=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,LQ=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,IQ=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,OQ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,DQ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,NQ=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,RQ=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,FQ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,zQ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,UQ=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,BQ=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,jQ=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,$Q=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,WQ=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,GQ=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,HQ=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,qQ=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,KQ="gl_FragColor = linearToOutputTexel( gl_FragColor );",XQ=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,YQ=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,ZQ=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,JQ=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,QQ=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,eee=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,tee=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,iee=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,nee=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,ree=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,see=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,oee=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,aee=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lee=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,cee=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,hee=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,uee=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,dee=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,fee=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,mee=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,pee=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,gee=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,vee=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,yee=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,See=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,bee=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,_ee=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Pee=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Eee=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,wee=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Tee=`#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif`,xee=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,kee=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Cee=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Mee=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Aee=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Vee=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Lee=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Iee=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Oee=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Dee=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,Nee=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Ree=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Fee=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,zee=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Uee=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Bee=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,jee=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,$ee=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Wee=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Gee=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Hee=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,qee=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Kee=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Xee=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Yee=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Zee=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Jee=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Qee=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,ete=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,tte=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,ite=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,nte=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,rte=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,ste=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,ote=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,ate=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,lte=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,cte=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,hte=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,ute=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,dte=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,fte=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,mte=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,pte=`#ifdef USE_UV
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,gte=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vte=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,yte=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Ste=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,bte=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,_te=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Pte=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Ete=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,wte=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Tte=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,xte=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,kte=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Cte=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Mte=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Ate=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Vte=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Lte=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ite=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ote=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Dte=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Nte=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Rte=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Fte=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,zte=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ute=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Bte=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,jte=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$te=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Wte=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Gte=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Hte=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,qte=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Kte=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Xte=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Yte=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,wi={alphamap_fragment:PQ,alphamap_pars_fragment:EQ,alphatest_fragment:wQ,alphatest_pars_fragment:TQ,aomap_fragment:xQ,aomap_pars_fragment:kQ,begin_vertex:CQ,beginnormal_vertex:MQ,bsdfs:AQ,iridescence_fragment:VQ,bumpmap_pars_fragment:LQ,clipping_planes_fragment:IQ,clipping_planes_pars_fragment:OQ,clipping_planes_pars_vertex:DQ,clipping_planes_vertex:NQ,color_fragment:RQ,color_pars_fragment:FQ,color_pars_vertex:zQ,color_vertex:UQ,common:BQ,cube_uv_reflection_fragment:jQ,defaultnormal_vertex:$Q,displacementmap_pars_vertex:WQ,displacementmap_vertex:GQ,emissivemap_fragment:HQ,emissivemap_pars_fragment:qQ,encodings_fragment:KQ,encodings_pars_fragment:XQ,envmap_fragment:YQ,envmap_common_pars_fragment:ZQ,envmap_pars_fragment:JQ,envmap_pars_vertex:QQ,envmap_physical_pars_fragment:uee,envmap_vertex:eee,fog_vertex:tee,fog_pars_vertex:iee,fog_fragment:nee,fog_pars_fragment:ree,gradientmap_pars_fragment:see,lightmap_fragment:oee,lightmap_pars_fragment:aee,lights_lambert_fragment:lee,lights_lambert_pars_fragment:cee,lights_pars_begin:hee,lights_toon_fragment:dee,lights_toon_pars_fragment:fee,lights_phong_fragment:mee,lights_phong_pars_fragment:pee,lights_physical_fragment:gee,lights_physical_pars_fragment:vee,lights_fragment_begin:yee,lights_fragment_maps:See,lights_fragment_end:bee,logdepthbuf_fragment:_ee,logdepthbuf_pars_fragment:Pee,logdepthbuf_pars_vertex:Eee,logdepthbuf_vertex:wee,map_fragment:Tee,map_pars_fragment:xee,map_particle_fragment:kee,map_particle_pars_fragment:Cee,metalnessmap_fragment:Mee,metalnessmap_pars_fragment:Aee,morphcolor_vertex:Vee,morphnormal_vertex:Lee,morphtarget_pars_vertex:Iee,morphtarget_vertex:Oee,normal_fragment_begin:Dee,normal_fragment_maps:Nee,normal_pars_fragment:Ree,normal_pars_vertex:Fee,normal_vertex:zee,normalmap_pars_fragment:Uee,clearcoat_normal_fragment_begin:Bee,clearcoat_normal_fragment_maps:jee,clearcoat_pars_fragment:$ee,iridescence_pars_fragment:Wee,output_fragment:Gee,packing:Hee,premultiplied_alpha_fragment:qee,project_vertex:Kee,dithering_fragment:Xee,dithering_pars_fragment:Yee,roughnessmap_fragment:Zee,roughnessmap_pars_fragment:Jee,shadowmap_pars_fragment:Qee,shadowmap_pars_vertex:ete,shadowmap_vertex:tte,shadowmask_pars_fragment:ite,skinbase_vertex:nte,skinning_pars_vertex:rte,skinning_vertex:ste,skinnormal_vertex:ote,specularmap_fragment:ate,specularmap_pars_fragment:lte,tonemapping_fragment:cte,tonemapping_pars_fragment:hte,transmission_fragment:ute,transmission_pars_fragment:dte,uv_pars_fragment:fte,uv_pars_vertex:mte,uv_vertex:pte,worldpos_vertex:gte,background_vert:vte,background_frag:yte,backgroundCube_vert:Ste,backgroundCube_frag:bte,cube_vert:_te,cube_frag:Pte,depth_vert:Ete,depth_frag:wte,distanceRGBA_vert:Tte,distanceRGBA_frag:xte,equirect_vert:kte,equirect_frag:Cte,linedashed_vert:Mte,linedashed_frag:Ate,meshbasic_vert:Vte,meshbasic_frag:Lte,meshlambert_vert:Ite,meshlambert_frag:Ote,meshmatcap_vert:Dte,meshmatcap_frag:Nte,meshnormal_vert:Rte,meshnormal_frag:Fte,meshphong_vert:zte,meshphong_frag:Ute,meshphysical_vert:Bte,meshphysical_frag:jte,meshtoon_vert:$te,meshtoon_frag:Wte,points_vert:Gte,points_frag:Hte,shadow_vert:qte,shadow_frag:Kte,sprite_vert:Xte,sprite_frag:Yte},dt={common:{diffuse:{value:new hn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ti},alphaMap:{value:null},alphaMapTransform:{value:new Ti},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ti}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ti}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ti}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ti},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ti},normalScale:{value:new Pi(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ti},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ti}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ti}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ti}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new hn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new hn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ti},alphaTest:{value:0},uvTransform:{value:new Ti}},sprite:{diffuse:{value:new hn(16777215)},opacity:{value:1},center:{value:new Pi(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ti},alphaMap:{value:null},alphaMapTransform:{value:new Ti},alphaTest:{value:0}}},Rl={basic:{uniforms:zs([dt.common,dt.specularmap,dt.envmap,dt.aomap,dt.lightmap,dt.fog]),vertexShader:wi.meshbasic_vert,fragmentShader:wi.meshbasic_frag},lambert:{uniforms:zs([dt.common,dt.specularmap,dt.envmap,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.fog,dt.lights,{emissive:{value:new hn(0)}}]),vertexShader:wi.meshlambert_vert,fragmentShader:wi.meshlambert_frag},phong:{uniforms:zs([dt.common,dt.specularmap,dt.envmap,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.fog,dt.lights,{emissive:{value:new hn(0)},specular:{value:new hn(1118481)},shininess:{value:30}}]),vertexShader:wi.meshphong_vert,fragmentShader:wi.meshphong_frag},standard:{uniforms:zs([dt.common,dt.envmap,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.roughnessmap,dt.metalnessmap,dt.fog,dt.lights,{emissive:{value:new hn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:wi.meshphysical_vert,fragmentShader:wi.meshphysical_frag},toon:{uniforms:zs([dt.common,dt.aomap,dt.lightmap,dt.emissivemap,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.gradientmap,dt.fog,dt.lights,{emissive:{value:new hn(0)}}]),vertexShader:wi.meshtoon_vert,fragmentShader:wi.meshtoon_frag},matcap:{uniforms:zs([dt.common,dt.bumpmap,dt.normalmap,dt.displacementmap,dt.fog,{matcap:{value:null}}]),vertexShader:wi.meshmatcap_vert,fragmentShader:wi.meshmatcap_frag},points:{uniforms:zs([dt.points,dt.fog]),vertexShader:wi.points_vert,fragmentShader:wi.points_frag},dashed:{uniforms:zs([dt.common,dt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:wi.linedashed_vert,fragmentShader:wi.linedashed_frag},depth:{uniforms:zs([dt.common,dt.displacementmap]),vertexShader:wi.depth_vert,fragmentShader:wi.depth_frag},normal:{uniforms:zs([dt.common,dt.bumpmap,dt.normalmap,dt.displacementmap,{opacity:{value:1}}]),vertexShader:wi.meshnormal_vert,fragmentShader:wi.meshnormal_frag},sprite:{uniforms:zs([dt.sprite,dt.fog]),vertexShader:wi.sprite_vert,fragmentShader:wi.sprite_frag},background:{uniforms:{uvTransform:{value:new Ti},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:wi.background_vert,fragmentShader:wi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:wi.backgroundCube_vert,fragmentShader:wi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:wi.cube_vert,fragmentShader:wi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:wi.equirect_vert,fragmentShader:wi.equirect_frag},distanceRGBA:{uniforms:zs([dt.common,dt.displacementmap,{referencePosition:{value:new k},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:wi.distanceRGBA_vert,fragmentShader:wi.distanceRGBA_frag},shadow:{uniforms:zs([dt.lights,dt.fog,{color:{value:new hn(0)},opacity:{value:1}}]),vertexShader:wi.shadow_vert,fragmentShader:wi.shadow_frag}};Rl.physical={uniforms:zs([Rl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ti},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ti},clearcoatNormalScale:{value:new Pi(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ti},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ti},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ti},sheen:{value:0},sheenColor:{value:new hn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ti},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ti},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ti},transmissionSamplerSize:{value:new Pi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ti},attenuationDistance:{value:0},attenuationColor:{value:new hn(0)},specularColor:{value:new hn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ti},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ti},anisotropyVector:{value:new Pi},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ti}}]),vertexShader:wi.meshphysical_vert,fragmentShader:wi.meshphysical_frag};const ab={r:0,b:0,g:0};function Zte(t,e,i,n,r,s,o){const a=new hn(0);let l=s===!0?0:1,c,u,h=null,d=0,f=null;function m(v,p){let b=!1,_=p.isScene===!0?p.background:null;switch(_&&_.isTexture&&(_=(p.backgroundBlurriness>0?i:e).get(_)),_===null?g(a,l):_&&_.isColor&&(g(_,1),b=!0),t.xr.getEnvironmentBlendMode()){case"opaque":b=!0;break;case"additive":n.buffers.color.setClear(0,0,0,1,o),b=!0;break;case"alpha-blend":n.buffers.color.setClear(0,0,0,0,o),b=!0;break}(t.autoClear||b)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),_&&(_.isCubeTexture||_.mapping===TP)?(u===void 0&&(u=new Hc(new qy(1,1,1),new $d({name:"BackgroundCubeMaterial",uniforms:tp(Rl.backgroundCube.uniforms),vertexShader:Rl.backgroundCube.vertexShader,fragmentShader:Rl.backgroundCube.fragmentShader,side:bo,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(T,C,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=_,u.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=p.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=p.backgroundIntensity,u.material.toneMapped=_.colorSpace!==yi,(h!==_||d!==_.version||f!==t.toneMapping)&&(u.material.needsUpdate=!0,h=_,d=_.version,f=t.toneMapping),u.layers.enableAll(),v.unshift(u,u.geometry,u.material,0,0,null)):_&&_.isTexture&&(c===void 0&&(c=new Hc(new OM(2,2),new $d({name:"BackgroundMaterial",uniforms:tp(Rl.background.uniforms),vertexShader:Rl.background.vertexShader,fragmentShader:Rl.background.fragmentShader,side:Cu,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=_,c.material.uniforms.backgroundIntensity.value=p.backgroundIntensity,c.material.toneMapped=_.colorSpace!==yi,_.matrixAutoUpdate===!0&&_.updateMatrix(),c.material.uniforms.uvTransform.value.copy(_.matrix),(h!==_||d!==_.version||f!==t.toneMapping)&&(c.material.needsUpdate=!0,h=_,d=_.version,f=t.toneMapping),c.layers.enableAll(),v.unshift(c,c.geometry,c.material,0,0,null))}function g(v,p){v.getRGB(ab,s4(t)),n.buffers.color.setClear(ab.r,ab.g,ab.b,p,o)}return{getClearColor:function(){return a},setClearColor:function(v,p=1){a.set(v),l=p,g(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(v){l=v,g(a,l)},render:m}}function Jte(t,e,i,n){const r=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||s!==null,a={},l=v(null);let c=l,u=!1;function h(F,X,Z,K,z){let H=!1;if(o){const re=g(K,Z,X);c!==re&&(c=re,f(c.object)),H=p(F,K,Z,z),H&&b(F,K,Z,z)}else{const re=X.wireframe===!0;(c.geometry!==K.id||c.program!==Z.id||c.wireframe!==re)&&(c.geometry=K.id,c.program=Z.id,c.wireframe=re,H=!0)}z!==null&&i.update(z,t.ELEMENT_ARRAY_BUFFER),(H||u)&&(u=!1,M(F,X,Z,K),z!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i.get(z).buffer))}function d(){return n.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(F){return n.isWebGL2?t.bindVertexArray(F):s.bindVertexArrayOES(F)}function m(F){return n.isWebGL2?t.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function g(F,X,Z){const K=Z.wireframe===!0;let z=a[F.id];z===void 0&&(z={},a[F.id]=z);let H=z[X.id];H===void 0&&(H={},z[X.id]=H);let re=H[K];return re===void 0&&(re=v(d()),H[K]=re),re}function v(F){const X=[],Z=[],K=[];for(let z=0;z<r;z++)X[z]=0,Z[z]=0,K[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:X,enabledAttributes:Z,attributeDivisors:K,object:F,attributes:{},index:null}}function p(F,X,Z,K){const z=c.attributes,H=X.attributes;let re=0;const ne=Z.getAttributes();for(const B in ne)if(ne[B].location>=0){const fe=z[B];let ie=H[B];if(ie===void 0&&(B==="instanceMatrix"&&F.instanceMatrix&&(ie=F.instanceMatrix),B==="instanceColor"&&F.instanceColor&&(ie=F.instanceColor)),fe===void 0||fe.attribute!==ie||ie&&fe.data!==ie.data)return!0;re++}return c.attributesNum!==re||c.index!==K}function b(F,X,Z,K){const z={},H=X.attributes;let re=0;const ne=Z.getAttributes();for(const B in ne)if(ne[B].location>=0){let fe=H[B];fe===void 0&&(B==="instanceMatrix"&&F.instanceMatrix&&(fe=F.instanceMatrix),B==="instanceColor"&&F.instanceColor&&(fe=F.instanceColor));const ie={};ie.attribute=fe,fe&&fe.data&&(ie.data=fe.data),z[B]=ie,re++}c.attributes=z,c.attributesNum=re,c.index=K}function _(){const F=c.newAttributes;for(let X=0,Z=F.length;X<Z;X++)F[X]=0}function P(F){E(F,0)}function E(F,X){const Z=c.newAttributes,K=c.enabledAttributes,z=c.attributeDivisors;Z[F]=1,K[F]===0&&(t.enableVertexAttribArray(F),K[F]=1),z[F]!==X&&((n.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,X),z[F]=X)}function T(){const F=c.newAttributes,X=c.enabledAttributes;for(let Z=0,K=X.length;Z<K;Z++)X[Z]!==F[Z]&&(t.disableVertexAttribArray(Z),X[Z]=0)}function C(F,X,Z,K,z,H,re){re===!0?t.vertexAttribIPointer(F,X,Z,z,H):t.vertexAttribPointer(F,X,Z,K,z,H)}function M(F,X,Z,K){if(n.isWebGL2===!1&&(F.isInstancedMesh||K.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;_();const z=K.attributes,H=Z.getAttributes(),re=X.defaultAttributeValues;for(const ne in H){const B=H[ne];if(B.location>=0){let Q=z[ne];if(Q===void 0&&(ne==="instanceMatrix"&&F.instanceMatrix&&(Q=F.instanceMatrix),ne==="instanceColor"&&F.instanceColor&&(Q=F.instanceColor)),Q!==void 0){const fe=Q.normalized,ie=Q.itemSize,se=i.get(Q);if(se===void 0)continue;const ee=se.buffer,de=se.type,Y=se.bytesPerElement,te=n.isWebGL2===!0&&(de===t.INT||de===t.UNSIGNED_INT||Q.gpuType===B3);if(Q.isInterleavedBufferAttribute){const he=Q.data,ae=he.stride,A=Q.offset;if(he.isInstancedInterleavedBuffer){for(let I=0;I<B.locationSize;I++)E(B.location+I,he.meshPerAttribute);F.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let I=0;I<B.locationSize;I++)P(B.location+I);t.bindBuffer(t.ARRAY_BUFFER,ee);for(let I=0;I<B.locationSize;I++)C(B.location+I,ie/B.locationSize,de,fe,ae*Y,(A+ie/B.locationSize*I)*Y,te)}else{if(Q.isInstancedBufferAttribute){for(let he=0;he<B.locationSize;he++)E(B.location+he,Q.meshPerAttribute);F.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=Q.meshPerAttribute*Q.count)}else for(let he=0;he<B.locationSize;he++)P(B.location+he);t.bindBuffer(t.ARRAY_BUFFER,ee);for(let he=0;he<B.locationSize;he++)C(B.location+he,ie/B.locationSize,de,fe,ie*Y,ie/B.locationSize*he*Y,te)}}else if(re!==void 0){const fe=re[ne];if(fe!==void 0)switch(fe.length){case 2:t.vertexAttrib2fv(B.location,fe);break;case 3:t.vertexAttrib3fv(B.location,fe);break;case 4:t.vertexAttrib4fv(B.location,fe);break;default:t.vertexAttrib1fv(B.location,fe)}}}}T()}function x(){D();for(const F in a){const X=a[F];for(const Z in X){const K=X[Z];for(const z in K)m(K[z].object),delete K[z];delete X[Z]}delete a[F]}}function V(F){if(a[F.id]===void 0)return;const X=a[F.id];for(const Z in X){const K=X[Z];for(const z in K)m(K[z].object),delete K[z];delete X[Z]}delete a[F.id]}function N(F){for(const X in a){const Z=a[X];if(Z[F.id]===void 0)continue;const K=Z[F.id];for(const z in K)m(K[z].object),delete K[z];delete Z[F.id]}}function D(){O(),u=!0,c!==l&&(c=l,f(c.object))}function O(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:D,resetDefaultState:O,dispose:x,releaseStatesOfGeometry:V,releaseStatesOfProgram:N,initAttributes:_,enableAttribute:P,disableUnusedAttributes:T}}function Qte(t,e,i,n){const r=n.isWebGL2;let s;function o(c){s=c}function a(c,u){t.drawArrays(s,c,u),i.update(u,s,1)}function l(c,u,h){if(h===0)return;let d,f;if(r)d=t,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,u,h),i.update(u,s,h)}this.setMode=o,this.render=a,this.renderInstances=l}function eie(t,e,i){let n;function r(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const C=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(C){if(C==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return C==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&t.constructor.name==="WebGL2RenderingContext";let a=i.precision!==void 0?i.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=i.logarithmicDepthBuffer===!0,h=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),d=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=t.getParameter(t.MAX_TEXTURE_SIZE),m=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),g=t.getParameter(t.MAX_VERTEX_ATTRIBS),v=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),p=t.getParameter(t.MAX_VARYING_VECTORS),b=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),_=d>0,P=o||e.has("OES_texture_float"),E=_&&P,T=o?t.getParameter(t.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:m,maxAttributes:g,maxVertexUniforms:v,maxVaryings:p,maxFragmentUniforms:b,vertexTextures:_,floatFragmentTextures:P,floatVertexTextures:E,maxSamples:T}}function tie(t){const e=this;let i=null,n=0,r=!1,s=!1;const o=new od,a=new Ti,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const f=h.length!==0||d||n!==0||r;return r=d,n=h.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){i=u(h,d,0)},this.setState=function(h,d,f){const m=h.clippingPlanes,g=h.clipIntersection,v=h.clipShadows,p=t.get(h);if(!r||m===null||m.length===0||s&&!v)s?u(null):c();else{const b=s?0:n,_=b*4;let P=p.clippingState||null;l.value=P,P=u(m,d,_,f);for(let E=0;E!==_;++E)P[E]=i[E];p.clippingState=P,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=b}};function c(){l.value!==i&&(l.value=i,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(h,d,f,m){const g=h!==null?h.length:0;let v=null;if(g!==0){if(v=l.value,m!==!0||v===null){const p=f+g*4,b=d.matrixWorldInverse;a.getNormalMatrix(b),(v===null||v.length<p)&&(v=new Float32Array(p));for(let _=0,P=f;_!==g;++_,P+=4)o.copy(h[_]).applyMatrix4(b,a),o.normal.toArray(v,P),v[P+3]=o.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,v}}function iie(t){let e=new WeakMap;function i(o,a){return a===Ek?o.mapping=Jm:a===wk&&(o.mapping=Qm),o}function n(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===Ek||a===wk)if(e.has(o)){const l=e.get(o).texture;return i(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new yQ(l.height/2);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),i(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}class c4 extends o4{constructor(e=-1,i=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+i,l=r-i;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const pm=4,iD=[.125,.215,.35,.446,.526,.582],cd=20,hT=new c4,nD=new hn;let uT=null;const ad=(1+Math.sqrt(5))/2,Uf=1/ad,rD=[new k(1,1,1),new k(-1,1,1),new k(1,1,-1),new k(-1,1,-1),new k(0,ad,Uf),new k(0,ad,-Uf),new k(Uf,0,ad),new k(-Uf,0,ad),new k(ad,Uf,0),new k(-ad,Uf,0)];class sD{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,i=0,n=.1,r=100){uT=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),i>0&&this._blur(s,0,0,i),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=lD(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=aD(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(uT),e.scissorTest=!1,lb(e,0,0,e.width,e.height)}_fromTexture(e,i){e.mapping===Jm||e.mapping===Qm?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),uT=this._renderer.getRenderTarget();const n=i||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,n={magFilter:pa,minFilter:pa,generateMipmaps:!1,type:Dv,format:al,colorSpace:fc,depthBuffer:!1},r=oD(e,i,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=oD(e,i,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=nie(s)),this._blurMaterial=rie(s,e,i)}return r}_compileMaterial(e){const i=new Hc(this._lodPlanes[0],e);this._renderer.compile(i,hT)}_sceneToCubeUV(e,i,n,r){const a=new ga(90,1,i,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(nD),u.toneMapping=th,u.autoClear=!1;const f=new i4({name:"PMREM.Background",side:bo,depthWrite:!1,depthTest:!1}),m=new Hc(new qy,f);let g=!1;const v=e.background;v?v.isColor&&(f.color.copy(v),e.background=null,g=!0):(f.color.copy(nD),g=!0);for(let p=0;p<6;p++){const b=p%3;b===0?(a.up.set(0,l[p],0),a.lookAt(c[p],0,0)):b===1?(a.up.set(0,0,l[p]),a.lookAt(0,c[p],0)):(a.up.set(0,l[p],0),a.lookAt(0,0,c[p]));const _=this._cubeSize;lb(r,b*_,p>2?_:0,_,_),u.setRenderTarget(r),g&&u.render(m,a),u.render(e,a)}m.geometry.dispose(),m.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=v}_textureToCubeUV(e,i){const n=this._renderer,r=e.mapping===Jm||e.mapping===Qm;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=lD()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=aD());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Hc(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;lb(i,0,0,3*l,2*l),n.setRenderTarget(i),n.render(o,hT)}_applyPMREM(e){const i=this._renderer,n=i.autoClear;i.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=rD[(r-1)%rD.length];this._blur(e,r-1,r,s,o)}i.autoClear=n}_blur(e,i,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,i,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,i,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,h=new Hc(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[n]-1,m=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*cd-1),g=s/m,v=isFinite(s)?1+Math.floor(u*g):cd;v>cd&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${cd}`);const p=[];let b=0;for(let C=0;C<cd;++C){const M=C/g,x=Math.exp(-M*M/2);p.push(x),C===0?b+=x:C<v&&(b+=2*x)}for(let C=0;C<p.length;C++)p[C]=p[C]/b;d.envMap.value=e.texture,d.samples.value=v,d.weights.value=p,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:_}=this;d.dTheta.value=m,d.mipInt.value=_-n;const P=this._sizeLods[r],E=3*P*(r>_-pm?r-_+pm:0),T=4*(this._cubeSize-P);lb(i,E,T,3*P,2*P),l.setRenderTarget(i),l.render(h,hT)}}function nie(t){const e=[],i=[],n=[];let r=t;const s=t-pm+1+iD.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);i.push(a);let l=1/a;o>t-pm?l=iD[o-t+pm-1]:o===0&&(l=0),n.push(l);const c=1/(a-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,m=6,g=3,v=2,p=1,b=new Float32Array(g*m*f),_=new Float32Array(v*m*f),P=new Float32Array(p*m*f);for(let T=0;T<f;T++){const C=T%3*2/3-1,M=T>2?0:-1,x=[C,M,0,C+2/3,M,0,C+2/3,M+1,0,C,M,0,C+2/3,M+1,0,C,M+1,0];b.set(x,g*m*T),_.set(d,v*m*T);const V=[T,T,T,T,T,T];P.set(V,p*m*T)}const E=new Du;E.setAttribute("position",new rc(b,g)),E.setAttribute("uv",new rc(_,v)),E.setAttribute("faceIndex",new rc(P,p)),e.push(E),r>pm&&r--}return{lodPlanes:e,sizeLods:i,sigmas:n}}function oD(t,e,i){const n=new jd(t,e,i);return n.texture.mapping=TP,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function lb(t,e,i,n,r){t.viewport.set(e,i,n,r),t.scissor.set(e,i,n,r)}function rie(t,e,i){const n=new Float32Array(cd),r=new k(0,1,0);return new $d({name:"SphericalGaussianBlur",defines:{n:cd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:DM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Su,depthTest:!1,depthWrite:!1})}function aD(){return new $d({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:DM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Su,depthTest:!1,depthWrite:!1})}function lD(){return new $d({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:DM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Su,depthTest:!1,depthWrite:!1})}function DM(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function sie(t){let e=new WeakMap,i=null;function n(a){if(a&&a.isTexture){const l=a.mapping,c=l===Ek||l===wk,u=l===Jm||l===Qm;if(c||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=e.get(a);return i===null&&(i=new sD(t)),h=c?i.fromEquirectangular(a,h):i.fromCubemap(a,h),e.set(a,h),h.texture}else{if(e.has(a))return e.get(a).texture;{const h=a.image;if(c&&h&&h.height>0||u&&h&&r(h)){i===null&&(i=new sD(t));const d=c?i.fromEquirectangular(a):i.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:o}}function oie(t){const e={};function i(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(n){const r=i(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function aie(t,e,i,n){const r={},s=new WeakMap;function o(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const m in d.attributes)e.remove(d.attributes[m]);for(const m in d.morphAttributes){const g=d.morphAttributes[m];for(let v=0,p=g.length;v<p;v++)e.remove(g[v])}d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function a(h,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,i.memory.geometries++),d}function l(h){const d=h.attributes;for(const m in d)e.update(d[m],t.ARRAY_BUFFER);const f=h.morphAttributes;for(const m in f){const g=f[m];for(let v=0,p=g.length;v<p;v++)e.update(g[v],t.ARRAY_BUFFER)}}function c(h){const d=[],f=h.index,m=h.attributes.position;let g=0;if(f!==null){const b=f.array;g=f.version;for(let _=0,P=b.length;_<P;_+=3){const E=b[_+0],T=b[_+1],C=b[_+2];d.push(E,T,T,C,C,E)}}else{const b=m.array;g=m.version;for(let _=0,P=b.length/3-1;_<P;_+=3){const E=_+0,T=_+1,C=_+2;d.push(E,T,T,C,C,E)}}const v=new(Y3(d)?r4:n4)(d,1);v.version=g;const p=s.get(h);p&&e.remove(p),s.set(h,v)}function u(h){const d=s.get(h);if(d){const f=h.index;f!==null&&d.version<f.version&&c(h)}else c(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:u}}function lie(t,e,i,n){const r=n.isWebGL2;let s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function u(d,f){t.drawElements(s,f,a,d*l),i.update(f,s,1)}function h(d,f,m){if(m===0)return;let g,v;if(r)g=t,v="drawElementsInstanced";else if(g=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",g===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[v](s,f,a,d*l,m),i.update(f,s,m)}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=h}function cie(t){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(i.calls++,o){case t.TRIANGLES:i.triangles+=a*(s/3);break;case t.LINES:i.lines+=a*(s/2);break;case t.LINE_STRIP:i.lines+=a*(s-1);break;case t.LINE_LOOP:i.lines+=a*s;break;case t.POINTS:i.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:r,update:n}}function hie(t,e){return t[0]-e[0]}function uie(t,e){return Math.abs(e[1])-Math.abs(t[1])}function die(t,e,i){const n={},r=new Float32Array(8),s=new WeakMap,o=new kn,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,u,h){const d=c.morphTargetInfluences;if(e.isWebGL2===!0){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=f!==void 0?f.length:0;let g=s.get(u);if(g===void 0||g.count!==m){let F=function(){D.dispose(),s.delete(u),u.removeEventListener("dispose",F)};g!==void 0&&g.texture.dispose();const b=u.morphAttributes.position!==void 0,_=u.morphAttributes.normal!==void 0,P=u.morphAttributes.color!==void 0,E=u.morphAttributes.position||[],T=u.morphAttributes.normal||[],C=u.morphAttributes.color||[];let M=0;b===!0&&(M=1),_===!0&&(M=2),P===!0&&(M=3);let x=u.attributes.position.count*M,V=1;x>e.maxTextureSize&&(V=Math.ceil(x/e.maxTextureSize),x=e.maxTextureSize);const N=new Float32Array(x*V*4*m),D=new Q3(N,x,V,m);D.type=uu,D.needsUpdate=!0;const O=M*4;for(let X=0;X<m;X++){const Z=E[X],K=T[X],z=C[X],H=x*V*4*X;for(let re=0;re<Z.count;re++){const ne=re*O;b===!0&&(o.fromBufferAttribute(Z,re),N[H+ne+0]=o.x,N[H+ne+1]=o.y,N[H+ne+2]=o.z,N[H+ne+3]=0),_===!0&&(o.fromBufferAttribute(K,re),N[H+ne+4]=o.x,N[H+ne+5]=o.y,N[H+ne+6]=o.z,N[H+ne+7]=0),P===!0&&(o.fromBufferAttribute(z,re),N[H+ne+8]=o.x,N[H+ne+9]=o.y,N[H+ne+10]=o.z,N[H+ne+11]=z.itemSize===4?o.w:1)}}g={count:m,texture:D,size:new Pi(x,V)},s.set(u,g),u.addEventListener("dispose",F)}let v=0;for(let b=0;b<d.length;b++)v+=d[b];const p=u.morphTargetsRelative?1:1-v;h.getUniforms().setValue(t,"morphTargetBaseInfluence",p),h.getUniforms().setValue(t,"morphTargetInfluences",d),h.getUniforms().setValue(t,"morphTargetsTexture",g.texture,i),h.getUniforms().setValue(t,"morphTargetsTextureSize",g.size)}else{const f=d===void 0?0:d.length;let m=n[u.id];if(m===void 0||m.length!==f){m=[];for(let _=0;_<f;_++)m[_]=[_,0];n[u.id]=m}for(let _=0;_<f;_++){const P=m[_];P[0]=_,P[1]=d[_]}m.sort(uie);for(let _=0;_<8;_++)_<f&&m[_][1]?(a[_][0]=m[_][0],a[_][1]=m[_][1]):(a[_][0]=Number.MAX_SAFE_INTEGER,a[_][1]=0);a.sort(hie);const g=u.morphAttributes.position,v=u.morphAttributes.normal;let p=0;for(let _=0;_<8;_++){const P=a[_],E=P[0],T=P[1];E!==Number.MAX_SAFE_INTEGER&&T?(g&&u.getAttribute("morphTarget"+_)!==g[E]&&u.setAttribute("morphTarget"+_,g[E]),v&&u.getAttribute("morphNormal"+_)!==v[E]&&u.setAttribute("morphNormal"+_,v[E]),r[_]=T,p+=T):(g&&u.hasAttribute("morphTarget"+_)===!0&&u.deleteAttribute("morphTarget"+_),v&&u.hasAttribute("morphNormal"+_)===!0&&u.deleteAttribute("morphNormal"+_),r[_]=0)}const b=u.morphTargetsRelative?1:1-p;h.getUniforms().setValue(t,"morphTargetBaseInfluence",b),h.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function fie(t,e,i,n){let r=new WeakMap;function s(l){const c=n.render.frame,u=l.geometry,h=e.get(l,u);return r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&i.update(l.instanceColor,t.ARRAY_BUFFER)),h}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),i.remove(c.instanceMatrix),c.instanceColor!==null&&i.remove(c.instanceColor)}return{update:s,dispose:o}}const h4=new Ec,u4=new Q3,d4=new tQ,f4=new a4,cD=[],hD=[],uD=new Float32Array(16),dD=new Float32Array(9),fD=new Float32Array(4);function Up(t,e,i){const n=t[0];if(n<=0||n>0)return t;const r=e*i;let s=cD[r];if(s===void 0&&(s=new Float32Array(r),cD[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=i,t[o].toArray(s,a)}return s}function Ar(t,e){if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Vr(t,e){for(let i=0,n=e.length;i<n;i++)t[i]=e[i]}function kP(t,e){let i=hD[e];i===void 0&&(i=new Int32Array(e),hD[e]=i);for(let n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function mie(t,e){const i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function pie(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Ar(i,e))return;t.uniform2fv(this.addr,e),Vr(i,e)}}function gie(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(Ar(i,e))return;t.uniform3fv(this.addr,e),Vr(i,e)}}function vie(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Ar(i,e))return;t.uniform4fv(this.addr,e),Vr(i,e)}}function yie(t,e){const i=this.cache,n=e.elements;if(n===void 0){if(Ar(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),Vr(i,e)}else{if(Ar(i,n))return;fD.set(n),t.uniformMatrix2fv(this.addr,!1,fD),Vr(i,n)}}function Sie(t,e){const i=this.cache,n=e.elements;if(n===void 0){if(Ar(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),Vr(i,e)}else{if(Ar(i,n))return;dD.set(n),t.uniformMatrix3fv(this.addr,!1,dD),Vr(i,n)}}function bie(t,e){const i=this.cache,n=e.elements;if(n===void 0){if(Ar(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),Vr(i,e)}else{if(Ar(i,n))return;uD.set(n),t.uniformMatrix4fv(this.addr,!1,uD),Vr(i,n)}}function _ie(t,e){const i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function Pie(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Ar(i,e))return;t.uniform2iv(this.addr,e),Vr(i,e)}}function Eie(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Ar(i,e))return;t.uniform3iv(this.addr,e),Vr(i,e)}}function wie(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Ar(i,e))return;t.uniform4iv(this.addr,e),Vr(i,e)}}function Tie(t,e){const i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function xie(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Ar(i,e))return;t.uniform2uiv(this.addr,e),Vr(i,e)}}function kie(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Ar(i,e))return;t.uniform3uiv(this.addr,e),Vr(i,e)}}function Cie(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Ar(i,e))return;t.uniform4uiv(this.addr,e),Vr(i,e)}}function Mie(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(e||h4,r)}function Aie(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||d4,r)}function Vie(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(e||f4,r)}function Lie(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||u4,r)}function Iie(t){switch(t){case 5126:return mie;case 35664:return pie;case 35665:return gie;case 35666:return vie;case 35674:return yie;case 35675:return Sie;case 35676:return bie;case 5124:case 35670:return _ie;case 35667:case 35671:return Pie;case 35668:case 35672:return Eie;case 35669:case 35673:return wie;case 5125:return Tie;case 36294:return xie;case 36295:return kie;case 36296:return Cie;case 35678:case 36198:case 36298:case 36306:case 35682:return Mie;case 35679:case 36299:case 36307:return Aie;case 35680:case 36300:case 36308:case 36293:return Vie;case 36289:case 36303:case 36311:case 36292:return Lie}}function Oie(t,e){t.uniform1fv(this.addr,e)}function Die(t,e){const i=Up(e,this.size,2);t.uniform2fv(this.addr,i)}function Nie(t,e){const i=Up(e,this.size,3);t.uniform3fv(this.addr,i)}function Rie(t,e){const i=Up(e,this.size,4);t.uniform4fv(this.addr,i)}function Fie(t,e){const i=Up(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function zie(t,e){const i=Up(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function Uie(t,e){const i=Up(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function Bie(t,e){t.uniform1iv(this.addr,e)}function jie(t,e){t.uniform2iv(this.addr,e)}function $ie(t,e){t.uniform3iv(this.addr,e)}function Wie(t,e){t.uniform4iv(this.addr,e)}function Gie(t,e){t.uniform1uiv(this.addr,e)}function Hie(t,e){t.uniform2uiv(this.addr,e)}function qie(t,e){t.uniform3uiv(this.addr,e)}function Kie(t,e){t.uniform4uiv(this.addr,e)}function Xie(t,e,i){const n=this.cache,r=e.length,s=kP(i,r);Ar(n,s)||(t.uniform1iv(this.addr,s),Vr(n,s));for(let o=0;o!==r;++o)i.setTexture2D(e[o]||h4,s[o])}function Yie(t,e,i){const n=this.cache,r=e.length,s=kP(i,r);Ar(n,s)||(t.uniform1iv(this.addr,s),Vr(n,s));for(let o=0;o!==r;++o)i.setTexture3D(e[o]||d4,s[o])}function Zie(t,e,i){const n=this.cache,r=e.length,s=kP(i,r);Ar(n,s)||(t.uniform1iv(this.addr,s),Vr(n,s));for(let o=0;o!==r;++o)i.setTextureCube(e[o]||f4,s[o])}function Jie(t,e,i){const n=this.cache,r=e.length,s=kP(i,r);Ar(n,s)||(t.uniform1iv(this.addr,s),Vr(n,s));for(let o=0;o!==r;++o)i.setTexture2DArray(e[o]||u4,s[o])}function Qie(t){switch(t){case 5126:return Oie;case 35664:return Die;case 35665:return Nie;case 35666:return Rie;case 35674:return Fie;case 35675:return zie;case 35676:return Uie;case 5124:case 35670:return Bie;case 35667:case 35671:return jie;case 35668:case 35672:return $ie;case 35669:case 35673:return Wie;case 5125:return Gie;case 36294:return Hie;case 36295:return qie;case 36296:return Kie;case 35678:case 36198:case 36298:case 36306:case 35682:return Xie;case 35679:case 36299:case 36307:return Yie;case 35680:case 36300:case 36308:case 36293:return Zie;case 36289:case 36303:case 36311:case 36292:return Jie}}class ene{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.setValue=Iie(i.type)}}class tne{constructor(e,i,n){this.id=e,this.addr=n,this.cache=[],this.size=i.size,this.setValue=Qie(i.type)}}class ine{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,i,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,i[a.id],n)}}}const dT=/(\w+)(\])?(\[|\.)?/g;function mD(t,e){t.seq.push(e),t.map[e.id]=e}function nne(t,e,i){const n=t.name,r=n.length;for(dT.lastIndex=0;;){const s=dT.exec(n),o=dT.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){mD(i,c===void 0?new ene(a,t,e):new tne(a,t,e));break}else{let h=i.map[a];h===void 0&&(h=new ine(a),mD(i,h)),i=h}}}class m0{constructor(e,i){this.seq=[],this.map={};const n=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const s=e.getActiveUniform(i,r),o=e.getUniformLocation(i,s.name);nne(s,o,this)}}setValue(e,i,n,r){const s=this.map[i];s!==void 0&&s.setValue(e,n,r)}setOptional(e,i,n){const r=i[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,i,n,r){for(let s=0,o=i.length;s!==o;++s){const a=i[s],l=n[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,i){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in i&&n.push(o)}return n}}function pD(t,e,i){const n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}let rne=0;function sne(t,e){const i=t.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,i.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${i[o]}`)}return n.join(`
`)}function one(t){switch(t){case fc:return["Linear","( value )"];case yi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),["Linear","( value )"]}}function gD(t,e,i){const n=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(n&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return i.toUpperCase()+`

`+r+`

`+sne(t.getShaderSource(e),o)}else return r}function ane(t,e){const i=one(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function lne(t,e){let i;switch(e){case SJ:i="Linear";break;case bJ:i="Reinhard";break;case _J:i="OptimizedCineon";break;case PJ:i="ACESFilmic";break;case EJ:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function cne(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Og).join(`
`)}function hne(t){const e=[];for(const i in t){const n=t[i];n!==!1&&e.push("#define "+i+" "+n)}return e.join(`
`)}function une(t,e){const i={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=t.getActiveAttrib(e,r),o=s.name;let a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),i[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return i}function Og(t){return t!==""}function vD(t,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function yD(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const dne=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ak(t){return t.replace(dne,fne)}function fne(t,e){const i=wi[e];if(i===void 0)throw new Error("Can not resolve #include <"+e+">");return Ak(i)}const mne=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function SD(t){return t.replace(mne,pne)}function pne(t,e,i,n){let r="";for(let s=parseInt(e);s<parseInt(i);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function bD(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function gne(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===N3?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===ZZ?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Nc&&(e="SHADOWMAP_TYPE_VSM"),e}function vne(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Jm:case Qm:e="ENVMAP_TYPE_CUBE";break;case TP:e="ENVMAP_TYPE_CUBE_UV";break}return e}function yne(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Qm:e="ENVMAP_MODE_REFRACTION";break}return e}function Sne(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case z3:e="ENVMAP_BLENDING_MULTIPLY";break;case vJ:e="ENVMAP_BLENDING_MIX";break;case yJ:e="ENVMAP_BLENDING_ADD";break}return e}function bne(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function _ne(t,e,i,n){const r=t.getContext(),s=i.defines;let o=i.vertexShader,a=i.fragmentShader;const l=gne(i),c=vne(i),u=yne(i),h=Sne(i),d=bne(i),f=i.isWebGL2?"":cne(i),m=hne(s),g=r.createProgram();let v,p,b=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(v=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m].filter(Og).join(`
`),v.length>0&&(v+=`
`),p=[f,"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m].filter(Og).join(`
`),p.length>0&&(p+=`
`)):(v=[bD(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Og).join(`
`),p=[f,bD(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.envMap?"#define "+u:"",i.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==th?"#define TONE_MAPPING":"",i.toneMapping!==th?wi.tonemapping_pars_fragment:"",i.toneMapping!==th?lne("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",wi.encodings_pars_fragment,ane("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Og).join(`
`)),o=Ak(o),o=vD(o,i),o=yD(o,i),a=Ak(a),a=vD(a,i),a=yD(a,i),o=SD(o),a=SD(a),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,v=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,p=["#define varying in",i.glslVersion===zO?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===zO?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+p);const _=b+v+o,P=b+p+a,E=pD(r,r.VERTEX_SHADER,_),T=pD(r,r.FRAGMENT_SHADER,P);if(r.attachShader(g,E),r.attachShader(g,T),i.index0AttributeName!==void 0?r.bindAttribLocation(g,0,i.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g),t.debug.checkShaderErrors){const x=r.getProgramInfoLog(g).trim(),V=r.getShaderInfoLog(E).trim(),N=r.getShaderInfoLog(T).trim();let D=!0,O=!0;if(r.getProgramParameter(g,r.LINK_STATUS)===!1)if(D=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,g,E,T);else{const F=gD(r,E,"vertex"),X=gD(r,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,r.VALIDATE_STATUS)+`

Program Info Log: `+x+`
`+F+`
`+X)}else x!==""?console.warn("THREE.WebGLProgram: Program Info Log:",x):(V===""||N==="")&&(O=!1);O&&(this.diagnostics={runnable:D,programLog:x,vertexShader:{log:V,prefix:v},fragmentShader:{log:N,prefix:p}})}r.deleteShader(E),r.deleteShader(T);let C;this.getUniforms=function(){return C===void 0&&(C=new m0(r,g)),C};let M;return this.getAttributes=function(){return M===void 0&&(M=une(r,g)),M},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=rne++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=E,this.fragmentShader=T,this}let Pne=0;class Ene{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(i),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const n of i)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;let n=i.get(e);return n===void 0&&(n=new Set,i.set(e,n)),n}_getShaderStage(e){const i=this.shaderCache;let n=i.get(e);return n===void 0&&(n=new wne(e),i.set(e,n)),n}}class wne{constructor(e){this.id=Pne++,this.code=e,this.usedTimes=0}}function Tne(t,e,i,n,r,s,o){const a=new e4,l=new Ene,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(x){return x===0?"uv":`uv${x}`}function v(x,V,N,D,O){const F=D.fog,X=O.geometry,Z=x.isMeshStandardMaterial?D.environment:null,K=(x.isMeshStandardMaterial?i:e).get(x.envMap||Z),z=K&&K.mapping===TP?K.image.height:null,H=m[x.type];x.precision!==null&&(f=r.getMaxPrecision(x.precision),f!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",f,"instead."));const re=X.morphAttributes.position||X.morphAttributes.normal||X.morphAttributes.color,ne=re!==void 0?re.length:0;let B=0;X.morphAttributes.position!==void 0&&(B=1),X.morphAttributes.normal!==void 0&&(B=2),X.morphAttributes.color!==void 0&&(B=3);let Q,fe,ie,se;if(H){const gn=Rl[H];Q=gn.vertexShader,fe=gn.fragmentShader}else Q=x.vertexShader,fe=x.fragmentShader,l.update(x),ie=l.getVertexShaderID(x),se=l.getFragmentShaderID(x);const ee=t.getRenderTarget(),de=O.isInstancedMesh===!0,Y=!!x.map,te=!!x.matcap,he=!!K,ae=!!x.aoMap,A=!!x.lightMap,I=!!x.bumpMap,G=!!x.normalMap,ue=!!x.displacementMap,Se=!!x.emissiveMap,Ee=!!x.metalnessMap,Oe=!!x.roughnessMap,ye=x.anisotropy>0,Pe=x.clearcoat>0,we=x.iridescence>0,j=x.sheen>0,R=x.transmission>0,J=ye&&!!x.anisotropyMap,ve=Pe&&!!x.clearcoatMap,xe=Pe&&!!x.clearcoatNormalMap,me=Pe&&!!x.clearcoatRoughnessMap,Ne=we&&!!x.iridescenceMap,ze=we&&!!x.iridescenceThicknessMap,ke=j&&!!x.sheenColorMap,pt=j&&!!x.sheenRoughnessMap,Ue=!!x.specularMap,Ye=!!x.specularColorMap,Je=!!x.specularIntensityMap,Ge=R&&!!x.transmissionMap,St=R&&!!x.thicknessMap,Ft=!!x.gradientMap,be=!!x.alphaMap,et=x.alphaTest>0,Ie=!!x.extensions,rt=!!X.attributes.uv1,Ke=!!X.attributes.uv2,Nt=!!X.attributes.uv3;return{isWebGL2:u,shaderID:H,shaderType:x.type,shaderName:x.name,vertexShader:Q,fragmentShader:fe,defines:x.defines,customVertexShaderID:ie,customFragmentShaderID:se,isRawShaderMaterial:x.isRawShaderMaterial===!0,glslVersion:x.glslVersion,precision:f,instancing:de,instancingColor:de&&O.instanceColor!==null,supportsVertexTextures:d,outputColorSpace:ee===null?t.outputColorSpace:ee.isXRRenderTarget===!0?ee.texture.colorSpace:fc,map:Y,matcap:te,envMap:he,envMapMode:he&&K.mapping,envMapCubeUVHeight:z,aoMap:ae,lightMap:A,bumpMap:I,normalMap:G,displacementMap:d&&ue,emissiveMap:Se,normalMapObjectSpace:G&&x.normalMapType===NJ,normalMapTangentSpace:G&&x.normalMapType===K3,metalnessMap:Ee,roughnessMap:Oe,anisotropy:ye,anisotropyMap:J,clearcoat:Pe,clearcoatMap:ve,clearcoatNormalMap:xe,clearcoatRoughnessMap:me,iridescence:we,iridescenceMap:Ne,iridescenceThicknessMap:ze,sheen:j,sheenColorMap:ke,sheenRoughnessMap:pt,specularMap:Ue,specularColorMap:Ye,specularIntensityMap:Je,transmission:R,transmissionMap:Ge,thicknessMap:St,gradientMap:Ft,opaque:x.transparent===!1&&x.blending===Im,alphaMap:be,alphaTest:et,combine:x.combine,mapUv:Y&&g(x.map.channel),aoMapUv:ae&&g(x.aoMap.channel),lightMapUv:A&&g(x.lightMap.channel),bumpMapUv:I&&g(x.bumpMap.channel),normalMapUv:G&&g(x.normalMap.channel),displacementMapUv:ue&&g(x.displacementMap.channel),emissiveMapUv:Se&&g(x.emissiveMap.channel),metalnessMapUv:Ee&&g(x.metalnessMap.channel),roughnessMapUv:Oe&&g(x.roughnessMap.channel),anisotropyMapUv:J&&g(x.anisotropyMap.channel),clearcoatMapUv:ve&&g(x.clearcoatMap.channel),clearcoatNormalMapUv:xe&&g(x.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:me&&g(x.clearcoatRoughnessMap.channel),iridescenceMapUv:Ne&&g(x.iridescenceMap.channel),iridescenceThicknessMapUv:ze&&g(x.iridescenceThicknessMap.channel),sheenColorMapUv:ke&&g(x.sheenColorMap.channel),sheenRoughnessMapUv:pt&&g(x.sheenRoughnessMap.channel),specularMapUv:Ue&&g(x.specularMap.channel),specularColorMapUv:Ye&&g(x.specularColorMap.channel),specularIntensityMapUv:Je&&g(x.specularIntensityMap.channel),transmissionMapUv:Ge&&g(x.transmissionMap.channel),thicknessMapUv:St&&g(x.thicknessMap.channel),alphaMapUv:be&&g(x.alphaMap.channel),vertexTangents:!!X.attributes.tangent&&(G||ye),vertexColors:x.vertexColors,vertexAlphas:x.vertexColors===!0&&!!X.attributes.color&&X.attributes.color.itemSize===4,vertexUv1s:rt,vertexUv2s:Ke,vertexUv3s:Nt,pointsUvs:O.isPoints===!0&&!!X.attributes.uv&&(Y||be),fog:!!F,useFog:x.fog===!0,fogExp2:F&&F.isFogExp2,flatShading:x.flatShading===!0,sizeAttenuation:x.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:O.isSkinnedMesh===!0,morphTargets:X.morphAttributes.position!==void 0,morphNormals:X.morphAttributes.normal!==void 0,morphColors:X.morphAttributes.color!==void 0,morphTargetsCount:ne,morphTextureStride:B,numDirLights:V.directional.length,numPointLights:V.point.length,numSpotLights:V.spot.length,numSpotLightMaps:V.spotLightMap.length,numRectAreaLights:V.rectArea.length,numHemiLights:V.hemi.length,numDirLightShadows:V.directionalShadowMap.length,numPointLightShadows:V.pointShadowMap.length,numSpotLightShadows:V.spotShadowMap.length,numSpotLightShadowsWithMaps:V.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:t.shadowMap.enabled&&N.length>0,shadowMapType:t.shadowMap.type,toneMapping:x.toneMapped?t.toneMapping:th,useLegacyLights:t.useLegacyLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:x.side===Uc,flipSided:x.side===bo,useDepthPacking:x.depthPacking>=0,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:Ie&&x.extensions.derivatives===!0,extensionFragDepth:Ie&&x.extensions.fragDepth===!0,extensionDrawBuffers:Ie&&x.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ie&&x.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}}function p(x){const V=[];if(x.shaderID?V.push(x.shaderID):(V.push(x.customVertexShaderID),V.push(x.customFragmentShaderID)),x.defines!==void 0)for(const N in x.defines)V.push(N),V.push(x.defines[N]);return x.isRawShaderMaterial===!1&&(b(V,x),_(V,x),V.push(t.outputColorSpace)),V.push(x.customProgramCacheKey),V.join()}function b(x,V){x.push(V.precision),x.push(V.outputColorSpace),x.push(V.envMapMode),x.push(V.envMapCubeUVHeight),x.push(V.mapUv),x.push(V.alphaMapUv),x.push(V.lightMapUv),x.push(V.aoMapUv),x.push(V.bumpMapUv),x.push(V.normalMapUv),x.push(V.displacementMapUv),x.push(V.emissiveMapUv),x.push(V.metalnessMapUv),x.push(V.roughnessMapUv),x.push(V.anisotropyMapUv),x.push(V.clearcoatMapUv),x.push(V.clearcoatNormalMapUv),x.push(V.clearcoatRoughnessMapUv),x.push(V.iridescenceMapUv),x.push(V.iridescenceThicknessMapUv),x.push(V.sheenColorMapUv),x.push(V.sheenRoughnessMapUv),x.push(V.specularMapUv),x.push(V.specularColorMapUv),x.push(V.specularIntensityMapUv),x.push(V.transmissionMapUv),x.push(V.thicknessMapUv),x.push(V.combine),x.push(V.fogExp2),x.push(V.sizeAttenuation),x.push(V.morphTargetsCount),x.push(V.morphAttributeCount),x.push(V.numDirLights),x.push(V.numPointLights),x.push(V.numSpotLights),x.push(V.numSpotLightMaps),x.push(V.numHemiLights),x.push(V.numRectAreaLights),x.push(V.numDirLightShadows),x.push(V.numPointLightShadows),x.push(V.numSpotLightShadows),x.push(V.numSpotLightShadowsWithMaps),x.push(V.shadowMapType),x.push(V.toneMapping),x.push(V.numClippingPlanes),x.push(V.numClipIntersection),x.push(V.depthPacking)}function _(x,V){a.disableAll(),V.isWebGL2&&a.enable(0),V.supportsVertexTextures&&a.enable(1),V.instancing&&a.enable(2),V.instancingColor&&a.enable(3),V.matcap&&a.enable(4),V.envMap&&a.enable(5),V.normalMapObjectSpace&&a.enable(6),V.normalMapTangentSpace&&a.enable(7),V.clearcoat&&a.enable(8),V.iridescence&&a.enable(9),V.alphaTest&&a.enable(10),V.vertexColors&&a.enable(11),V.vertexAlphas&&a.enable(12),V.vertexUv1s&&a.enable(13),V.vertexUv2s&&a.enable(14),V.vertexUv3s&&a.enable(15),V.vertexTangents&&a.enable(16),V.anisotropy&&a.enable(17),x.push(a.mask),a.disableAll(),V.fog&&a.enable(0),V.useFog&&a.enable(1),V.flatShading&&a.enable(2),V.logarithmicDepthBuffer&&a.enable(3),V.skinning&&a.enable(4),V.morphTargets&&a.enable(5),V.morphNormals&&a.enable(6),V.morphColors&&a.enable(7),V.premultipliedAlpha&&a.enable(8),V.shadowMapEnabled&&a.enable(9),V.useLegacyLights&&a.enable(10),V.doubleSided&&a.enable(11),V.flipSided&&a.enable(12),V.useDepthPacking&&a.enable(13),V.dithering&&a.enable(14),V.transmission&&a.enable(15),V.sheen&&a.enable(16),V.opaque&&a.enable(17),V.pointsUvs&&a.enable(18),x.push(a.mask)}function P(x){const V=m[x.type];let N;if(V){const D=Rl[V];N=mQ.clone(D.uniforms)}else N=x.uniforms;return N}function E(x,V){let N;for(let D=0,O=c.length;D<O;D++){const F=c[D];if(F.cacheKey===V){N=F,++N.usedTimes;break}}return N===void 0&&(N=new _ne(t,V,x,s),c.push(N)),N}function T(x){if(--x.usedTimes===0){const V=c.indexOf(x);c[V]=c[c.length-1],c.pop(),x.destroy()}}function C(x){l.remove(x)}function M(){l.dispose()}return{getParameters:v,getProgramCacheKey:p,getUniforms:P,acquireProgram:E,releaseProgram:T,releaseShaderCache:C,programs:c,dispose:M}}function xne(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function i(s){t.delete(s)}function n(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:i,update:n,dispose:r}}function kne(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function _D(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function PD(){const t=[];let e=0;const i=[],n=[],r=[];function s(){e=0,i.length=0,n.length=0,r.length=0}function o(h,d,f,m,g,v){let p=t[e];return p===void 0?(p={id:h.id,object:h,geometry:d,material:f,groupOrder:m,renderOrder:h.renderOrder,z:g,group:v},t[e]=p):(p.id=h.id,p.object=h,p.geometry=d,p.material=f,p.groupOrder=m,p.renderOrder=h.renderOrder,p.z=g,p.group=v),e++,p}function a(h,d,f,m,g,v){const p=o(h,d,f,m,g,v);f.transmission>0?n.push(p):f.transparent===!0?r.push(p):i.push(p)}function l(h,d,f,m,g,v){const p=o(h,d,f,m,g,v);f.transmission>0?n.unshift(p):f.transparent===!0?r.unshift(p):i.unshift(p)}function c(h,d){i.length>1&&i.sort(h||kne),n.length>1&&n.sort(d||_D),r.length>1&&r.sort(d||_D)}function u(){for(let h=e,d=t.length;h<d;h++){const f=t[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:i,transmissive:n,transparent:r,init:s,push:a,unshift:l,finish:u,sort:c}}function Cne(){let t=new WeakMap;function e(n,r){const s=t.get(n);let o;return s===void 0?(o=new PD,t.set(n,[o])):r>=s.length?(o=new PD,s.push(o)):o=s[r],o}function i(){t=new WeakMap}return{get:e,dispose:i}}function Mne(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new k,color:new hn};break;case"SpotLight":i={position:new k,direction:new k,color:new hn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new k,color:new hn,distance:0,decay:0};break;case"HemisphereLight":i={direction:new k,skyColor:new hn,groundColor:new hn};break;case"RectAreaLight":i={color:new hn,position:new k,halfWidth:new k,halfHeight:new k};break}return t[e.id]=i,i}}}function Ane(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Pi};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Pi};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Pi,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=i,i}}}let Vne=0;function Lne(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Ine(t,e){const i=new Mne,n=Ane(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new k);const s=new k,o=new Pt,a=new Pt;function l(u,h){let d=0,f=0,m=0;for(let N=0;N<9;N++)r.probe[N].set(0,0,0);let g=0,v=0,p=0,b=0,_=0,P=0,E=0,T=0,C=0,M=0;u.sort(Lne);const x=h===!0?Math.PI:1;for(let N=0,D=u.length;N<D;N++){const O=u[N],F=O.color,X=O.intensity,Z=O.distance,K=O.shadow&&O.shadow.map?O.shadow.map.texture:null;if(O.isAmbientLight)d+=F.r*X*x,f+=F.g*X*x,m+=F.b*X*x;else if(O.isLightProbe)for(let z=0;z<9;z++)r.probe[z].addScaledVector(O.sh.coefficients[z],X);else if(O.isDirectionalLight){const z=i.get(O);if(z.color.copy(O.color).multiplyScalar(O.intensity*x),O.castShadow){const H=O.shadow,re=n.get(O);re.shadowBias=H.bias,re.shadowNormalBias=H.normalBias,re.shadowRadius=H.radius,re.shadowMapSize=H.mapSize,r.directionalShadow[g]=re,r.directionalShadowMap[g]=K,r.directionalShadowMatrix[g]=O.shadow.matrix,P++}r.directional[g]=z,g++}else if(O.isSpotLight){const z=i.get(O);z.position.setFromMatrixPosition(O.matrixWorld),z.color.copy(F).multiplyScalar(X*x),z.distance=Z,z.coneCos=Math.cos(O.angle),z.penumbraCos=Math.cos(O.angle*(1-O.penumbra)),z.decay=O.decay,r.spot[p]=z;const H=O.shadow;if(O.map&&(r.spotLightMap[C]=O.map,C++,H.updateMatrices(O),O.castShadow&&M++),r.spotLightMatrix[p]=H.matrix,O.castShadow){const re=n.get(O);re.shadowBias=H.bias,re.shadowNormalBias=H.normalBias,re.shadowRadius=H.radius,re.shadowMapSize=H.mapSize,r.spotShadow[p]=re,r.spotShadowMap[p]=K,T++}p++}else if(O.isRectAreaLight){const z=i.get(O);z.color.copy(F).multiplyScalar(X),z.halfWidth.set(O.width*.5,0,0),z.halfHeight.set(0,O.height*.5,0),r.rectArea[b]=z,b++}else if(O.isPointLight){const z=i.get(O);if(z.color.copy(O.color).multiplyScalar(O.intensity*x),z.distance=O.distance,z.decay=O.decay,O.castShadow){const H=O.shadow,re=n.get(O);re.shadowBias=H.bias,re.shadowNormalBias=H.normalBias,re.shadowRadius=H.radius,re.shadowMapSize=H.mapSize,re.shadowCameraNear=H.camera.near,re.shadowCameraFar=H.camera.far,r.pointShadow[v]=re,r.pointShadowMap[v]=K,r.pointShadowMatrix[v]=O.shadow.matrix,E++}r.point[v]=z,v++}else if(O.isHemisphereLight){const z=i.get(O);z.skyColor.copy(O.color).multiplyScalar(X*x),z.groundColor.copy(O.groundColor).multiplyScalar(X*x),r.hemi[_]=z,_++}}b>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=dt.LTC_FLOAT_1,r.rectAreaLTC2=dt.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=dt.LTC_HALF_1,r.rectAreaLTC2=dt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=m;const V=r.hash;(V.directionalLength!==g||V.pointLength!==v||V.spotLength!==p||V.rectAreaLength!==b||V.hemiLength!==_||V.numDirectionalShadows!==P||V.numPointShadows!==E||V.numSpotShadows!==T||V.numSpotMaps!==C)&&(r.directional.length=g,r.spot.length=p,r.rectArea.length=b,r.point.length=v,r.hemi.length=_,r.directionalShadow.length=P,r.directionalShadowMap.length=P,r.pointShadow.length=E,r.pointShadowMap.length=E,r.spotShadow.length=T,r.spotShadowMap.length=T,r.directionalShadowMatrix.length=P,r.pointShadowMatrix.length=E,r.spotLightMatrix.length=T+C-M,r.spotLightMap.length=C,r.numSpotLightShadowsWithMaps=M,V.directionalLength=g,V.pointLength=v,V.spotLength=p,V.rectAreaLength=b,V.hemiLength=_,V.numDirectionalShadows=P,V.numPointShadows=E,V.numSpotShadows=T,V.numSpotMaps=C,r.version=Vne++)}function c(u,h){let d=0,f=0,m=0,g=0,v=0;const p=h.matrixWorldInverse;for(let b=0,_=u.length;b<_;b++){const P=u[b];if(P.isDirectionalLight){const E=r.directional[d];E.direction.setFromMatrixPosition(P.matrixWorld),s.setFromMatrixPosition(P.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(p),d++}else if(P.isSpotLight){const E=r.spot[m];E.position.setFromMatrixPosition(P.matrixWorld),E.position.applyMatrix4(p),E.direction.setFromMatrixPosition(P.matrixWorld),s.setFromMatrixPosition(P.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(p),m++}else if(P.isRectAreaLight){const E=r.rectArea[g];E.position.setFromMatrixPosition(P.matrixWorld),E.position.applyMatrix4(p),a.identity(),o.copy(P.matrixWorld),o.premultiply(p),a.extractRotation(o),E.halfWidth.set(P.width*.5,0,0),E.halfHeight.set(0,P.height*.5,0),E.halfWidth.applyMatrix4(a),E.halfHeight.applyMatrix4(a),g++}else if(P.isPointLight){const E=r.point[f];E.position.setFromMatrixPosition(P.matrixWorld),E.position.applyMatrix4(p),f++}else if(P.isHemisphereLight){const E=r.hemi[v];E.direction.setFromMatrixPosition(P.matrixWorld),E.direction.transformDirection(p),v++}}}return{setup:l,setupView:c,state:r}}function ED(t,e){const i=new Ine(t,e),n=[],r=[];function s(){n.length=0,r.length=0}function o(h){n.push(h)}function a(h){r.push(h)}function l(h){i.setup(n,h)}function c(h){i.setupView(n,h)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function One(t,e){let i=new WeakMap;function n(s,o=0){const a=i.get(s);let l;return a===void 0?(l=new ED(t,e),i.set(s,[l])):o>=a.length?(l=new ED(t,e),a.push(l)):l=a[o],l}function r(){i=new WeakMap}return{get:n,dispose:r}}class Dne extends Hy{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=OJ,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Nne extends Hy{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Rne=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Fne=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function zne(t,e,i){let n=new IM;const r=new Pi,s=new Pi,o=new kn,a=new Dne({depthPacking:DJ}),l=new Nne,c={},u=i.maxTextureSize,h={[Cu]:bo,[bo]:Cu,[Uc]:Uc},d=new $d({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Pi},radius:{value:4}},vertexShader:Rne,fragmentShader:Fne}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const m=new Du;m.setAttribute("position",new rc(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new Hc(m,d),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=N3;let p=this.type;this.render=function(E,T,C){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||E.length===0)return;const M=t.getRenderTarget(),x=t.getActiveCubeFace(),V=t.getActiveMipmapLevel(),N=t.state;N.setBlending(Su),N.buffers.color.setClear(1,1,1,1),N.buffers.depth.setTest(!0),N.setScissorTest(!1);const D=p!==Nc&&this.type===Nc,O=p===Nc&&this.type!==Nc;for(let F=0,X=E.length;F<X;F++){const Z=E[F],K=Z.shadow;if(K===void 0){console.warn("THREE.WebGLShadowMap:",Z,"has no shadow.");continue}if(K.autoUpdate===!1&&K.needsUpdate===!1)continue;r.copy(K.mapSize);const z=K.getFrameExtents();if(r.multiply(z),s.copy(K.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/z.x),r.x=s.x*z.x,K.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/z.y),r.y=s.y*z.y,K.mapSize.y=s.y)),K.map===null||D===!0||O===!0){const re=this.type!==Nc?{minFilter:Hs,magFilter:Hs}:{};K.map!==null&&K.map.dispose(),K.map=new jd(r.x,r.y,re),K.map.texture.name=Z.name+".shadowMap",K.camera.updateProjectionMatrix()}t.setRenderTarget(K.map),t.clear();const H=K.getViewportCount();for(let re=0;re<H;re++){const ne=K.getViewport(re);o.set(s.x*ne.x,s.y*ne.y,s.x*ne.z,s.y*ne.w),N.viewport(o),K.updateMatrices(Z,re),n=K.getFrustum(),P(T,C,K.camera,Z,this.type)}K.isPointLightShadow!==!0&&this.type===Nc&&b(K,C),K.needsUpdate=!1}p=this.type,v.needsUpdate=!1,t.setRenderTarget(M,x,V)};function b(E,T){const C=e.update(g);d.defines.VSM_SAMPLES!==E.blurSamples&&(d.defines.VSM_SAMPLES=E.blurSamples,f.defines.VSM_SAMPLES=E.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),E.mapPass===null&&(E.mapPass=new jd(r.x,r.y)),d.uniforms.shadow_pass.value=E.map.texture,d.uniforms.resolution.value=E.mapSize,d.uniforms.radius.value=E.radius,t.setRenderTarget(E.mapPass),t.clear(),t.renderBufferDirect(T,null,C,d,g,null),f.uniforms.shadow_pass.value=E.mapPass.texture,f.uniforms.resolution.value=E.mapSize,f.uniforms.radius.value=E.radius,t.setRenderTarget(E.map),t.clear(),t.renderBufferDirect(T,null,C,f,g,null)}function _(E,T,C,M){let x=null;const V=C.isPointLight===!0?E.customDistanceMaterial:E.customDepthMaterial;if(V!==void 0)x=V;else if(x=C.isPointLight===!0?l:a,t.localClippingEnabled&&T.clipShadows===!0&&Array.isArray(T.clippingPlanes)&&T.clippingPlanes.length!==0||T.displacementMap&&T.displacementScale!==0||T.alphaMap&&T.alphaTest>0||T.map&&T.alphaTest>0){const N=x.uuid,D=T.uuid;let O=c[N];O===void 0&&(O={},c[N]=O);let F=O[D];F===void 0&&(F=x.clone(),O[D]=F),x=F}if(x.visible=T.visible,x.wireframe=T.wireframe,M===Nc?x.side=T.shadowSide!==null?T.shadowSide:T.side:x.side=T.shadowSide!==null?T.shadowSide:h[T.side],x.alphaMap=T.alphaMap,x.alphaTest=T.alphaTest,x.map=T.map,x.clipShadows=T.clipShadows,x.clippingPlanes=T.clippingPlanes,x.clipIntersection=T.clipIntersection,x.displacementMap=T.displacementMap,x.displacementScale=T.displacementScale,x.displacementBias=T.displacementBias,x.wireframeLinewidth=T.wireframeLinewidth,x.linewidth=T.linewidth,C.isPointLight===!0&&x.isMeshDistanceMaterial===!0){const N=t.properties.get(x);N.light=C}return x}function P(E,T,C,M,x){if(E.visible===!1)return;if(E.layers.test(T.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&x===Nc)&&(!E.frustumCulled||n.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,E.matrixWorld);const D=e.update(E),O=E.material;if(Array.isArray(O)){const F=D.groups;for(let X=0,Z=F.length;X<Z;X++){const K=F[X],z=O[K.materialIndex];if(z&&z.visible){const H=_(E,z,M,x);t.renderBufferDirect(C,null,D,H,E,K)}}}else if(O.visible){const F=_(E,O,M,x);t.renderBufferDirect(C,null,D,F,E,null)}}const N=E.children;for(let D=0,O=N.length;D<O;D++)P(N[D],T,C,M,x)}}function Une(t,e,i){const n=i.isWebGL2;function r(){let be=!1;const et=new kn;let Ie=null;const rt=new kn(0,0,0,0);return{setMask:function(Ke){Ie!==Ke&&!be&&(t.colorMask(Ke,Ke,Ke,Ke),Ie=Ke)},setLocked:function(Ke){be=Ke},setClear:function(Ke,Nt,zi,gn,wc){wc===!0&&(Ke*=gn,Nt*=gn,zi*=gn),et.set(Ke,Nt,zi,gn),rt.equals(et)===!1&&(t.clearColor(Ke,Nt,zi,gn),rt.copy(et))},reset:function(){be=!1,Ie=null,rt.set(-1,0,0,0)}}}function s(){let be=!1,et=null,Ie=null,rt=null;return{setTest:function(Ke){Ke?ee(t.DEPTH_TEST):de(t.DEPTH_TEST)},setMask:function(Ke){et!==Ke&&!be&&(t.depthMask(Ke),et=Ke)},setFunc:function(Ke){if(Ie!==Ke){switch(Ke){case hJ:t.depthFunc(t.NEVER);break;case uJ:t.depthFunc(t.ALWAYS);break;case dJ:t.depthFunc(t.LESS);break;case Pk:t.depthFunc(t.LEQUAL);break;case fJ:t.depthFunc(t.EQUAL);break;case mJ:t.depthFunc(t.GEQUAL);break;case pJ:t.depthFunc(t.GREATER);break;case gJ:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}Ie=Ke}},setLocked:function(Ke){be=Ke},setClear:function(Ke){rt!==Ke&&(t.clearDepth(Ke),rt=Ke)},reset:function(){be=!1,et=null,Ie=null,rt=null}}}function o(){let be=!1,et=null,Ie=null,rt=null,Ke=null,Nt=null,zi=null,gn=null,wc=null;return{setTest:function(Sn){be||(Sn?ee(t.STENCIL_TEST):de(t.STENCIL_TEST))},setMask:function(Sn){et!==Sn&&!be&&(t.stencilMask(Sn),et=Sn)},setFunc:function(Sn,Vo,Vn){(Ie!==Sn||rt!==Vo||Ke!==Vn)&&(t.stencilFunc(Sn,Vo,Vn),Ie=Sn,rt=Vo,Ke=Vn)},setOp:function(Sn,Vo,Vn){(Nt!==Sn||zi!==Vo||gn!==Vn)&&(t.stencilOp(Sn,Vo,Vn),Nt=Sn,zi=Vo,gn=Vn)},setLocked:function(Sn){be=Sn},setClear:function(Sn){wc!==Sn&&(t.clearStencil(Sn),wc=Sn)},reset:function(){be=!1,et=null,Ie=null,rt=null,Ke=null,Nt=null,zi=null,gn=null,wc=null}}}const a=new r,l=new s,c=new o,u=new WeakMap,h=new WeakMap;let d={},f={},m=new WeakMap,g=[],v=null,p=!1,b=null,_=null,P=null,E=null,T=null,C=null,M=null,x=!1,V=null,N=null,D=null,O=null,F=null;const X=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Z=!1,K=0;const z=t.getParameter(t.VERSION);z.indexOf("WebGL")!==-1?(K=parseFloat(/^WebGL (\d)/.exec(z)[1]),Z=K>=1):z.indexOf("OpenGL ES")!==-1&&(K=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),Z=K>=2);let H=null,re={};const ne=t.getParameter(t.SCISSOR_BOX),B=t.getParameter(t.VIEWPORT),Q=new kn().fromArray(ne),fe=new kn().fromArray(B);function ie(be,et,Ie,rt){const Ke=new Uint8Array(4),Nt=t.createTexture();t.bindTexture(be,Nt),t.texParameteri(be,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(be,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let zi=0;zi<Ie;zi++)n&&(be===t.TEXTURE_3D||be===t.TEXTURE_2D_ARRAY)?t.texImage3D(et,0,t.RGBA,1,1,rt,0,t.RGBA,t.UNSIGNED_BYTE,Ke):t.texImage2D(et+zi,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,Ke);return Nt}const se={};se[t.TEXTURE_2D]=ie(t.TEXTURE_2D,t.TEXTURE_2D,1),se[t.TEXTURE_CUBE_MAP]=ie(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(se[t.TEXTURE_2D_ARRAY]=ie(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),se[t.TEXTURE_3D]=ie(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ee(t.DEPTH_TEST),l.setFunc(Pk),ue(!1),Se(lO),ee(t.CULL_FACE),I(Su);function ee(be){d[be]!==!0&&(t.enable(be),d[be]=!0)}function de(be){d[be]!==!1&&(t.disable(be),d[be]=!1)}function Y(be,et){return f[be]!==et?(t.bindFramebuffer(be,et),f[be]=et,n&&(be===t.DRAW_FRAMEBUFFER&&(f[t.FRAMEBUFFER]=et),be===t.FRAMEBUFFER&&(f[t.DRAW_FRAMEBUFFER]=et)),!0):!1}function te(be,et){let Ie=g,rt=!1;if(be)if(Ie=m.get(et),Ie===void 0&&(Ie=[],m.set(et,Ie)),be.isWebGLMultipleRenderTargets){const Ke=be.texture;if(Ie.length!==Ke.length||Ie[0]!==t.COLOR_ATTACHMENT0){for(let Nt=0,zi=Ke.length;Nt<zi;Nt++)Ie[Nt]=t.COLOR_ATTACHMENT0+Nt;Ie.length=Ke.length,rt=!0}}else Ie[0]!==t.COLOR_ATTACHMENT0&&(Ie[0]=t.COLOR_ATTACHMENT0,rt=!0);else Ie[0]!==t.BACK&&(Ie[0]=t.BACK,rt=!0);rt&&(i.isWebGL2?t.drawBuffers(Ie):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ie))}function he(be){return v!==be?(t.useProgram(be),v=be,!0):!1}const ae={[rm]:t.FUNC_ADD,[QZ]:t.FUNC_SUBTRACT,[eJ]:t.FUNC_REVERSE_SUBTRACT};if(n)ae[dO]=t.MIN,ae[fO]=t.MAX;else{const be=e.get("EXT_blend_minmax");be!==null&&(ae[dO]=be.MIN_EXT,ae[fO]=be.MAX_EXT)}const A={[tJ]:t.ZERO,[iJ]:t.ONE,[nJ]:t.SRC_COLOR,[R3]:t.SRC_ALPHA,[cJ]:t.SRC_ALPHA_SATURATE,[aJ]:t.DST_COLOR,[sJ]:t.DST_ALPHA,[rJ]:t.ONE_MINUS_SRC_COLOR,[F3]:t.ONE_MINUS_SRC_ALPHA,[lJ]:t.ONE_MINUS_DST_COLOR,[oJ]:t.ONE_MINUS_DST_ALPHA};function I(be,et,Ie,rt,Ke,Nt,zi,gn){if(be===Su){p===!0&&(de(t.BLEND),p=!1);return}if(p===!1&&(ee(t.BLEND),p=!0),be!==JZ){if(be!==b||gn!==x){if((_!==rm||T!==rm)&&(t.blendEquation(t.FUNC_ADD),_=rm,T=rm),gn)switch(be){case Im:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case cO:t.blendFunc(t.ONE,t.ONE);break;case hO:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case uO:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",be);break}else switch(be){case Im:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case cO:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case hO:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case uO:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",be);break}P=null,E=null,C=null,M=null,b=be,x=gn}return}Ke=Ke||et,Nt=Nt||Ie,zi=zi||rt,(et!==_||Ke!==T)&&(t.blendEquationSeparate(ae[et],ae[Ke]),_=et,T=Ke),(Ie!==P||rt!==E||Nt!==C||zi!==M)&&(t.blendFuncSeparate(A[Ie],A[rt],A[Nt],A[zi]),P=Ie,E=rt,C=Nt,M=zi),b=be,x=!1}function G(be,et){be.side===Uc?de(t.CULL_FACE):ee(t.CULL_FACE);let Ie=be.side===bo;et&&(Ie=!Ie),ue(Ie),be.blending===Im&&be.transparent===!1?I(Su):I(be.blending,be.blendEquation,be.blendSrc,be.blendDst,be.blendEquationAlpha,be.blendSrcAlpha,be.blendDstAlpha,be.premultipliedAlpha),l.setFunc(be.depthFunc),l.setTest(be.depthTest),l.setMask(be.depthWrite),a.setMask(be.colorWrite);const rt=be.stencilWrite;c.setTest(rt),rt&&(c.setMask(be.stencilWriteMask),c.setFunc(be.stencilFunc,be.stencilRef,be.stencilFuncMask),c.setOp(be.stencilFail,be.stencilZFail,be.stencilZPass)),Oe(be.polygonOffset,be.polygonOffsetFactor,be.polygonOffsetUnits),be.alphaToCoverage===!0?ee(t.SAMPLE_ALPHA_TO_COVERAGE):de(t.SAMPLE_ALPHA_TO_COVERAGE)}function ue(be){V!==be&&(be?t.frontFace(t.CW):t.frontFace(t.CCW),V=be)}function Se(be){be!==XZ?(ee(t.CULL_FACE),be!==N&&(be===lO?t.cullFace(t.BACK):be===YZ?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):de(t.CULL_FACE),N=be}function Ee(be){be!==D&&(Z&&t.lineWidth(be),D=be)}function Oe(be,et,Ie){be?(ee(t.POLYGON_OFFSET_FILL),(O!==et||F!==Ie)&&(t.polygonOffset(et,Ie),O=et,F=Ie)):de(t.POLYGON_OFFSET_FILL)}function ye(be){be?ee(t.SCISSOR_TEST):de(t.SCISSOR_TEST)}function Pe(be){be===void 0&&(be=t.TEXTURE0+X-1),H!==be&&(t.activeTexture(be),H=be)}function we(be,et,Ie){Ie===void 0&&(H===null?Ie=t.TEXTURE0+X-1:Ie=H);let rt=re[Ie];rt===void 0&&(rt={type:void 0,texture:void 0},re[Ie]=rt),(rt.type!==be||rt.texture!==et)&&(H!==Ie&&(t.activeTexture(Ie),H=Ie),t.bindTexture(be,et||se[be]),rt.type=be,rt.texture=et)}function j(){const be=re[H];be!==void 0&&be.type!==void 0&&(t.bindTexture(be.type,null),be.type=void 0,be.texture=void 0)}function R(){try{t.compressedTexImage2D.apply(t,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function J(){try{t.compressedTexImage3D.apply(t,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function ve(){try{t.texSubImage2D.apply(t,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function xe(){try{t.texSubImage3D.apply(t,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function me(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Ne(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function ze(){try{t.texStorage2D.apply(t,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function ke(){try{t.texStorage3D.apply(t,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function pt(){try{t.texImage2D.apply(t,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Ue(){try{t.texImage3D.apply(t,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Ye(be){Q.equals(be)===!1&&(t.scissor(be.x,be.y,be.z,be.w),Q.copy(be))}function Je(be){fe.equals(be)===!1&&(t.viewport(be.x,be.y,be.z,be.w),fe.copy(be))}function Ge(be,et){let Ie=h.get(et);Ie===void 0&&(Ie=new WeakMap,h.set(et,Ie));let rt=Ie.get(be);rt===void 0&&(rt=t.getUniformBlockIndex(et,be.name),Ie.set(be,rt))}function St(be,et){const rt=h.get(et).get(be);u.get(et)!==rt&&(t.uniformBlockBinding(et,rt,be.__bindingPointIndex),u.set(et,rt))}function Ft(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),n===!0&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},H=null,re={},f={},m=new WeakMap,g=[],v=null,p=!1,b=null,_=null,P=null,E=null,T=null,C=null,M=null,x=!1,V=null,N=null,D=null,O=null,F=null,Q.set(0,0,t.canvas.width,t.canvas.height),fe.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:ee,disable:de,bindFramebuffer:Y,drawBuffers:te,useProgram:he,setBlending:I,setMaterial:G,setFlipSided:ue,setCullFace:Se,setLineWidth:Ee,setPolygonOffset:Oe,setScissorTest:ye,activeTexture:Pe,bindTexture:we,unbindTexture:j,compressedTexImage2D:R,compressedTexImage3D:J,texImage2D:pt,texImage3D:Ue,updateUBOMapping:Ge,uniformBlockBinding:St,texStorage2D:ze,texStorage3D:ke,texSubImage2D:ve,texSubImage3D:xe,compressedTexSubImage2D:me,compressedTexSubImage3D:Ne,scissor:Ye,viewport:Je,reset:Ft}}function Bne(t,e,i,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap;let g;const v=new WeakMap;let p=!1;try{p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function b(j,R){return p?new OffscreenCanvas(j,R):Nv("canvas")}function _(j,R,J,ve){let xe=1;if((j.width>ve||j.height>ve)&&(xe=ve/Math.max(j.width,j.height)),xe<1||R===!0)if(typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&j instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&j instanceof ImageBitmap){const me=R?Mk:Math.floor,Ne=me(xe*j.width),ze=me(xe*j.height);g===void 0&&(g=b(Ne,ze));const ke=J?b(Ne,ze):g;return ke.width=Ne,ke.height=ze,ke.getContext("2d").drawImage(j,0,0,Ne,ze),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+j.width+"x"+j.height+") to ("+Ne+"x"+ze+")."),ke}else return"data"in j&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+j.width+"x"+j.height+")."),j;return j}function P(j){return UO(j.width)&&UO(j.height)}function E(j){return a?!1:j.wrapS!==ol||j.wrapT!==ol||j.minFilter!==Hs&&j.minFilter!==pa}function T(j,R){return j.generateMipmaps&&R&&j.minFilter!==Hs&&j.minFilter!==pa}function C(j){t.generateMipmap(j)}function M(j,R,J,ve,xe=!1){if(a===!1)return R;if(j!==null){if(t[j]!==void 0)return t[j];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+j+"'")}let me=R;return R===t.RED&&(J===t.FLOAT&&(me=t.R32F),J===t.HALF_FLOAT&&(me=t.R16F),J===t.UNSIGNED_BYTE&&(me=t.R8)),R===t.RG&&(J===t.FLOAT&&(me=t.RG32F),J===t.HALF_FLOAT&&(me=t.RG16F),J===t.UNSIGNED_BYTE&&(me=t.RG8)),R===t.RGBA&&(J===t.FLOAT&&(me=t.RGBA32F),J===t.HALF_FLOAT&&(me=t.RGBA16F),J===t.UNSIGNED_BYTE&&(me=ve===yi&&xe===!1?t.SRGB8_ALPHA8:t.RGBA8),J===t.UNSIGNED_SHORT_4_4_4_4&&(me=t.RGBA4),J===t.UNSIGNED_SHORT_5_5_5_1&&(me=t.RGB5_A1)),(me===t.R16F||me===t.R32F||me===t.RG16F||me===t.RG32F||me===t.RGBA16F||me===t.RGBA32F)&&e.get("EXT_color_buffer_float"),me}function x(j,R,J){return T(j,J)===!0||j.isFramebufferTexture&&j.minFilter!==Hs&&j.minFilter!==pa?Math.log2(Math.max(R.width,R.height))+1:j.mipmaps!==void 0&&j.mipmaps.length>0?j.mipmaps.length:j.isCompressedTexture&&Array.isArray(j.image)?R.mipmaps.length:1}function V(j){return j===Hs||j===mO||j===Fw?t.NEAREST:t.LINEAR}function N(j){const R=j.target;R.removeEventListener("dispose",N),O(R),R.isVideoTexture&&m.delete(R)}function D(j){const R=j.target;R.removeEventListener("dispose",D),X(R)}function O(j){const R=n.get(j);if(R.__webglInit===void 0)return;const J=j.source,ve=v.get(J);if(ve){const xe=ve[R.__cacheKey];xe.usedTimes--,xe.usedTimes===0&&F(j),Object.keys(ve).length===0&&v.delete(J)}n.remove(j)}function F(j){const R=n.get(j);t.deleteTexture(R.__webglTexture);const J=j.source,ve=v.get(J);delete ve[R.__cacheKey],o.memory.textures--}function X(j){const R=j.texture,J=n.get(j),ve=n.get(R);if(ve.__webglTexture!==void 0&&(t.deleteTexture(ve.__webglTexture),o.memory.textures--),j.depthTexture&&j.depthTexture.dispose(),j.isWebGLCubeRenderTarget)for(let xe=0;xe<6;xe++)t.deleteFramebuffer(J.__webglFramebuffer[xe]),J.__webglDepthbuffer&&t.deleteRenderbuffer(J.__webglDepthbuffer[xe]);else{if(t.deleteFramebuffer(J.__webglFramebuffer),J.__webglDepthbuffer&&t.deleteRenderbuffer(J.__webglDepthbuffer),J.__webglMultisampledFramebuffer&&t.deleteFramebuffer(J.__webglMultisampledFramebuffer),J.__webglColorRenderbuffer)for(let xe=0;xe<J.__webglColorRenderbuffer.length;xe++)J.__webglColorRenderbuffer[xe]&&t.deleteRenderbuffer(J.__webglColorRenderbuffer[xe]);J.__webglDepthRenderbuffer&&t.deleteRenderbuffer(J.__webglDepthRenderbuffer)}if(j.isWebGLMultipleRenderTargets)for(let xe=0,me=R.length;xe<me;xe++){const Ne=n.get(R[xe]);Ne.__webglTexture&&(t.deleteTexture(Ne.__webglTexture),o.memory.textures--),n.remove(R[xe])}n.remove(R),n.remove(j)}let Z=0;function K(){Z=0}function z(){const j=Z;return j>=l&&console.warn("THREE.WebGLTextures: Trying to use "+j+" texture units while this GPU supports only "+l),Z+=1,j}function H(j){const R=[];return R.push(j.wrapS),R.push(j.wrapT),R.push(j.wrapR||0),R.push(j.magFilter),R.push(j.minFilter),R.push(j.anisotropy),R.push(j.internalFormat),R.push(j.format),R.push(j.type),R.push(j.generateMipmaps),R.push(j.premultiplyAlpha),R.push(j.flipY),R.push(j.unpackAlignment),R.push(j.colorSpace),R.join()}function re(j,R){const J=n.get(j);if(j.isVideoTexture&&Pe(j),j.isRenderTargetTexture===!1&&j.version>0&&J.__version!==j.version){const ve=j.image;if(ve===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ve.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Y(J,j,R);return}}i.bindTexture(t.TEXTURE_2D,J.__webglTexture,t.TEXTURE0+R)}function ne(j,R){const J=n.get(j);if(j.version>0&&J.__version!==j.version){Y(J,j,R);return}i.bindTexture(t.TEXTURE_2D_ARRAY,J.__webglTexture,t.TEXTURE0+R)}function B(j,R){const J=n.get(j);if(j.version>0&&J.__version!==j.version){Y(J,j,R);return}i.bindTexture(t.TEXTURE_3D,J.__webglTexture,t.TEXTURE0+R)}function Q(j,R){const J=n.get(j);if(j.version>0&&J.__version!==j.version){te(J,j,R);return}i.bindTexture(t.TEXTURE_CUBE_MAP,J.__webglTexture,t.TEXTURE0+R)}const fe={[Tk]:t.REPEAT,[ol]:t.CLAMP_TO_EDGE,[xk]:t.MIRRORED_REPEAT},ie={[Hs]:t.NEAREST,[mO]:t.NEAREST_MIPMAP_NEAREST,[Fw]:t.NEAREST_MIPMAP_LINEAR,[pa]:t.LINEAR,[wJ]:t.LINEAR_MIPMAP_NEAREST,[Ov]:t.LINEAR_MIPMAP_LINEAR},se={[FJ]:t.NEVER,[GJ]:t.ALWAYS,[zJ]:t.LESS,[BJ]:t.LEQUAL,[UJ]:t.EQUAL,[WJ]:t.GEQUAL,[jJ]:t.GREATER,[$J]:t.NOTEQUAL};function ee(j,R,J){if(J?(t.texParameteri(j,t.TEXTURE_WRAP_S,fe[R.wrapS]),t.texParameteri(j,t.TEXTURE_WRAP_T,fe[R.wrapT]),(j===t.TEXTURE_3D||j===t.TEXTURE_2D_ARRAY)&&t.texParameteri(j,t.TEXTURE_WRAP_R,fe[R.wrapR]),t.texParameteri(j,t.TEXTURE_MAG_FILTER,ie[R.magFilter]),t.texParameteri(j,t.TEXTURE_MIN_FILTER,ie[R.minFilter])):(t.texParameteri(j,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(j,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(j===t.TEXTURE_3D||j===t.TEXTURE_2D_ARRAY)&&t.texParameteri(j,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),(R.wrapS!==ol||R.wrapT!==ol)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(j,t.TEXTURE_MAG_FILTER,V(R.magFilter)),t.texParameteri(j,t.TEXTURE_MIN_FILTER,V(R.minFilter)),R.minFilter!==Hs&&R.minFilter!==pa&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),R.compareFunction&&(t.texParameteri(j,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(j,t.TEXTURE_COMPARE_FUNC,se[R.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const ve=e.get("EXT_texture_filter_anisotropic");if(R.magFilter===Hs||R.minFilter!==Fw&&R.minFilter!==Ov||R.type===uu&&e.has("OES_texture_float_linear")===!1||a===!1&&R.type===Dv&&e.has("OES_texture_half_float_linear")===!1)return;(R.anisotropy>1||n.get(R).__currentAnisotropy)&&(t.texParameterf(j,ve.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(R.anisotropy,r.getMaxAnisotropy())),n.get(R).__currentAnisotropy=R.anisotropy)}}function de(j,R){let J=!1;j.__webglInit===void 0&&(j.__webglInit=!0,R.addEventListener("dispose",N));const ve=R.source;let xe=v.get(ve);xe===void 0&&(xe={},v.set(ve,xe));const me=H(R);if(me!==j.__cacheKey){xe[me]===void 0&&(xe[me]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,J=!0),xe[me].usedTimes++;const Ne=xe[j.__cacheKey];Ne!==void 0&&(xe[j.__cacheKey].usedTimes--,Ne.usedTimes===0&&F(R)),j.__cacheKey=me,j.__webglTexture=xe[me].texture}return J}function Y(j,R,J){let ve=t.TEXTURE_2D;(R.isDataArrayTexture||R.isCompressedArrayTexture)&&(ve=t.TEXTURE_2D_ARRAY),R.isData3DTexture&&(ve=t.TEXTURE_3D);const xe=de(j,R),me=R.source;i.bindTexture(ve,j.__webglTexture,t.TEXTURE0+J);const Ne=n.get(me);if(me.version!==Ne.__version||xe===!0){i.activeTexture(t.TEXTURE0+J),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,R.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,R.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE);const ze=E(R)&&P(R.image)===!1;let ke=_(R.image,ze,!1,u);ke=we(R,ke);const pt=P(ke)||a,Ue=s.convert(R.format,R.colorSpace);let Ye=s.convert(R.type),Je=M(R.internalFormat,Ue,Ye,R.colorSpace);ee(ve,R,pt);let Ge;const St=R.mipmaps,Ft=a&&R.isVideoTexture!==!0,be=Ne.__version===void 0||xe===!0,et=x(R,ke,pt);if(R.isDepthTexture)Je=t.DEPTH_COMPONENT,a?R.type===uu?Je=t.DEPTH_COMPONENT32F:R.type===hu?Je=t.DEPTH_COMPONENT24:R.type===Cd?Je=t.DEPTH24_STENCIL8:Je=t.DEPTH_COMPONENT16:R.type===uu&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),R.format===Md&&Je===t.DEPTH_COMPONENT&&R.type!==VM&&R.type!==hu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),R.type=hu,Ye=s.convert(R.type)),R.format===ep&&Je===t.DEPTH_COMPONENT&&(Je=t.DEPTH_STENCIL,R.type!==Cd&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),R.type=Cd,Ye=s.convert(R.type))),be&&(Ft?i.texStorage2D(t.TEXTURE_2D,1,Je,ke.width,ke.height):i.texImage2D(t.TEXTURE_2D,0,Je,ke.width,ke.height,0,Ue,Ye,null));else if(R.isDataTexture)if(St.length>0&&pt){Ft&&be&&i.texStorage2D(t.TEXTURE_2D,et,Je,St[0].width,St[0].height);for(let Ie=0,rt=St.length;Ie<rt;Ie++)Ge=St[Ie],Ft?i.texSubImage2D(t.TEXTURE_2D,Ie,0,0,Ge.width,Ge.height,Ue,Ye,Ge.data):i.texImage2D(t.TEXTURE_2D,Ie,Je,Ge.width,Ge.height,0,Ue,Ye,Ge.data);R.generateMipmaps=!1}else Ft?(be&&i.texStorage2D(t.TEXTURE_2D,et,Je,ke.width,ke.height),i.texSubImage2D(t.TEXTURE_2D,0,0,0,ke.width,ke.height,Ue,Ye,ke.data)):i.texImage2D(t.TEXTURE_2D,0,Je,ke.width,ke.height,0,Ue,Ye,ke.data);else if(R.isCompressedTexture)if(R.isCompressedArrayTexture){Ft&&be&&i.texStorage3D(t.TEXTURE_2D_ARRAY,et,Je,St[0].width,St[0].height,ke.depth);for(let Ie=0,rt=St.length;Ie<rt;Ie++)Ge=St[Ie],R.format!==al?Ue!==null?Ft?i.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Ie,0,0,0,Ge.width,Ge.height,ke.depth,Ue,Ge.data,0,0):i.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Ie,Je,Ge.width,Ge.height,ke.depth,0,Ge.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ft?i.texSubImage3D(t.TEXTURE_2D_ARRAY,Ie,0,0,0,Ge.width,Ge.height,ke.depth,Ue,Ye,Ge.data):i.texImage3D(t.TEXTURE_2D_ARRAY,Ie,Je,Ge.width,Ge.height,ke.depth,0,Ue,Ye,Ge.data)}else{Ft&&be&&i.texStorage2D(t.TEXTURE_2D,et,Je,St[0].width,St[0].height);for(let Ie=0,rt=St.length;Ie<rt;Ie++)Ge=St[Ie],R.format!==al?Ue!==null?Ft?i.compressedTexSubImage2D(t.TEXTURE_2D,Ie,0,0,Ge.width,Ge.height,Ue,Ge.data):i.compressedTexImage2D(t.TEXTURE_2D,Ie,Je,Ge.width,Ge.height,0,Ge.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ft?i.texSubImage2D(t.TEXTURE_2D,Ie,0,0,Ge.width,Ge.height,Ue,Ye,Ge.data):i.texImage2D(t.TEXTURE_2D,Ie,Je,Ge.width,Ge.height,0,Ue,Ye,Ge.data)}else if(R.isDataArrayTexture)Ft?(be&&i.texStorage3D(t.TEXTURE_2D_ARRAY,et,Je,ke.width,ke.height,ke.depth),i.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,ke.width,ke.height,ke.depth,Ue,Ye,ke.data)):i.texImage3D(t.TEXTURE_2D_ARRAY,0,Je,ke.width,ke.height,ke.depth,0,Ue,Ye,ke.data);else if(R.isData3DTexture)Ft?(be&&i.texStorage3D(t.TEXTURE_3D,et,Je,ke.width,ke.height,ke.depth),i.texSubImage3D(t.TEXTURE_3D,0,0,0,0,ke.width,ke.height,ke.depth,Ue,Ye,ke.data)):i.texImage3D(t.TEXTURE_3D,0,Je,ke.width,ke.height,ke.depth,0,Ue,Ye,ke.data);else if(R.isFramebufferTexture){if(be)if(Ft)i.texStorage2D(t.TEXTURE_2D,et,Je,ke.width,ke.height);else{let Ie=ke.width,rt=ke.height;for(let Ke=0;Ke<et;Ke++)i.texImage2D(t.TEXTURE_2D,Ke,Je,Ie,rt,0,Ue,Ye,null),Ie>>=1,rt>>=1}}else if(St.length>0&&pt){Ft&&be&&i.texStorage2D(t.TEXTURE_2D,et,Je,St[0].width,St[0].height);for(let Ie=0,rt=St.length;Ie<rt;Ie++)Ge=St[Ie],Ft?i.texSubImage2D(t.TEXTURE_2D,Ie,0,0,Ue,Ye,Ge):i.texImage2D(t.TEXTURE_2D,Ie,Je,Ue,Ye,Ge);R.generateMipmaps=!1}else Ft?(be&&i.texStorage2D(t.TEXTURE_2D,et,Je,ke.width,ke.height),i.texSubImage2D(t.TEXTURE_2D,0,0,0,Ue,Ye,ke)):i.texImage2D(t.TEXTURE_2D,0,Je,Ue,Ye,ke);T(R,pt)&&C(ve),Ne.__version=me.version,R.onUpdate&&R.onUpdate(R)}j.__version=R.version}function te(j,R,J){if(R.image.length!==6)return;const ve=de(j,R),xe=R.source;i.bindTexture(t.TEXTURE_CUBE_MAP,j.__webglTexture,t.TEXTURE0+J);const me=n.get(xe);if(xe.version!==me.__version||ve===!0){i.activeTexture(t.TEXTURE0+J),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,R.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,R.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE);const Ne=R.isCompressedTexture||R.image[0].isCompressedTexture,ze=R.image[0]&&R.image[0].isDataTexture,ke=[];for(let Ie=0;Ie<6;Ie++)!Ne&&!ze?ke[Ie]=_(R.image[Ie],!1,!0,c):ke[Ie]=ze?R.image[Ie].image:R.image[Ie],ke[Ie]=we(R,ke[Ie]);const pt=ke[0],Ue=P(pt)||a,Ye=s.convert(R.format,R.colorSpace),Je=s.convert(R.type),Ge=M(R.internalFormat,Ye,Je,R.colorSpace),St=a&&R.isVideoTexture!==!0,Ft=me.__version===void 0||ve===!0;let be=x(R,pt,Ue);ee(t.TEXTURE_CUBE_MAP,R,Ue);let et;if(Ne){St&&Ft&&i.texStorage2D(t.TEXTURE_CUBE_MAP,be,Ge,pt.width,pt.height);for(let Ie=0;Ie<6;Ie++){et=ke[Ie].mipmaps;for(let rt=0;rt<et.length;rt++){const Ke=et[rt];R.format!==al?Ye!==null?St?i.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,rt,0,0,Ke.width,Ke.height,Ye,Ke.data):i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,rt,Ge,Ke.width,Ke.height,0,Ke.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):St?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,rt,0,0,Ke.width,Ke.height,Ye,Je,Ke.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,rt,Ge,Ke.width,Ke.height,0,Ye,Je,Ke.data)}}}else{et=R.mipmaps,St&&Ft&&(et.length>0&&be++,i.texStorage2D(t.TEXTURE_CUBE_MAP,be,Ge,ke[0].width,ke[0].height));for(let Ie=0;Ie<6;Ie++)if(ze){St?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0,0,0,ke[Ie].width,ke[Ie].height,Ye,Je,ke[Ie].data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0,Ge,ke[Ie].width,ke[Ie].height,0,Ye,Je,ke[Ie].data);for(let rt=0;rt<et.length;rt++){const Nt=et[rt].image[Ie].image;St?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,rt+1,0,0,Nt.width,Nt.height,Ye,Je,Nt.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,rt+1,Ge,Nt.width,Nt.height,0,Ye,Je,Nt.data)}}else{St?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0,0,0,Ye,Je,ke[Ie]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0,Ge,Ye,Je,ke[Ie]);for(let rt=0;rt<et.length;rt++){const Ke=et[rt];St?i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,rt+1,0,0,Ye,Je,Ke.image[Ie]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,rt+1,Ge,Ye,Je,Ke.image[Ie])}}}T(R,Ue)&&C(t.TEXTURE_CUBE_MAP),me.__version=xe.version,R.onUpdate&&R.onUpdate(R)}j.__version=R.version}function he(j,R,J,ve,xe){const me=s.convert(J.format,J.colorSpace),Ne=s.convert(J.type),ze=M(J.internalFormat,me,Ne,J.colorSpace);n.get(R).__hasExternalTextures||(xe===t.TEXTURE_3D||xe===t.TEXTURE_2D_ARRAY?i.texImage3D(xe,0,ze,R.width,R.height,R.depth,0,me,Ne,null):i.texImage2D(xe,0,ze,R.width,R.height,0,me,Ne,null)),i.bindFramebuffer(t.FRAMEBUFFER,j),ye(R)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,ve,xe,n.get(J).__webglTexture,0,Oe(R)):(xe===t.TEXTURE_2D||xe>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&xe<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,ve,xe,n.get(J).__webglTexture,0),i.bindFramebuffer(t.FRAMEBUFFER,null)}function ae(j,R,J){if(t.bindRenderbuffer(t.RENDERBUFFER,j),R.depthBuffer&&!R.stencilBuffer){let ve=t.DEPTH_COMPONENT16;if(J||ye(R)){const xe=R.depthTexture;xe&&xe.isDepthTexture&&(xe.type===uu?ve=t.DEPTH_COMPONENT32F:xe.type===hu&&(ve=t.DEPTH_COMPONENT24));const me=Oe(R);ye(R)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,me,ve,R.width,R.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,me,ve,R.width,R.height)}else t.renderbufferStorage(t.RENDERBUFFER,ve,R.width,R.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,j)}else if(R.depthBuffer&&R.stencilBuffer){const ve=Oe(R);J&&ye(R)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,ve,t.DEPTH24_STENCIL8,R.width,R.height):ye(R)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,ve,t.DEPTH24_STENCIL8,R.width,R.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,R.width,R.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,j)}else{const ve=R.isWebGLMultipleRenderTargets===!0?R.texture:[R.texture];for(let xe=0;xe<ve.length;xe++){const me=ve[xe],Ne=s.convert(me.format,me.colorSpace),ze=s.convert(me.type),ke=M(me.internalFormat,Ne,ze,me.colorSpace),pt=Oe(R);J&&ye(R)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,pt,ke,R.width,R.height):ye(R)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,pt,ke,R.width,R.height):t.renderbufferStorage(t.RENDERBUFFER,ke,R.width,R.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function A(j,R){if(R&&R.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(t.FRAMEBUFFER,j),!(R.depthTexture&&R.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(R.depthTexture).__webglTexture||R.depthTexture.image.width!==R.width||R.depthTexture.image.height!==R.height)&&(R.depthTexture.image.width=R.width,R.depthTexture.image.height=R.height,R.depthTexture.needsUpdate=!0),re(R.depthTexture,0);const ve=n.get(R.depthTexture).__webglTexture,xe=Oe(R);if(R.depthTexture.format===Md)ye(R)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,ve,0,xe):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,ve,0);else if(R.depthTexture.format===ep)ye(R)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,ve,0,xe):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,ve,0);else throw new Error("Unknown depthTexture format")}function I(j){const R=n.get(j),J=j.isWebGLCubeRenderTarget===!0;if(j.depthTexture&&!R.__autoAllocateDepthBuffer){if(J)throw new Error("target.depthTexture not supported in Cube render targets");A(R.__webglFramebuffer,j)}else if(J){R.__webglDepthbuffer=[];for(let ve=0;ve<6;ve++)i.bindFramebuffer(t.FRAMEBUFFER,R.__webglFramebuffer[ve]),R.__webglDepthbuffer[ve]=t.createRenderbuffer(),ae(R.__webglDepthbuffer[ve],j,!1)}else i.bindFramebuffer(t.FRAMEBUFFER,R.__webglFramebuffer),R.__webglDepthbuffer=t.createRenderbuffer(),ae(R.__webglDepthbuffer,j,!1);i.bindFramebuffer(t.FRAMEBUFFER,null)}function G(j,R,J){const ve=n.get(j);R!==void 0&&he(ve.__webglFramebuffer,j,j.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),J!==void 0&&I(j)}function ue(j){const R=j.texture,J=n.get(j),ve=n.get(R);j.addEventListener("dispose",D),j.isWebGLMultipleRenderTargets!==!0&&(ve.__webglTexture===void 0&&(ve.__webglTexture=t.createTexture()),ve.__version=R.version,o.memory.textures++);const xe=j.isWebGLCubeRenderTarget===!0,me=j.isWebGLMultipleRenderTargets===!0,Ne=P(j)||a;if(xe){J.__webglFramebuffer=[];for(let ze=0;ze<6;ze++)J.__webglFramebuffer[ze]=t.createFramebuffer()}else{if(J.__webglFramebuffer=t.createFramebuffer(),me)if(r.drawBuffers){const ze=j.texture;for(let ke=0,pt=ze.length;ke<pt;ke++){const Ue=n.get(ze[ke]);Ue.__webglTexture===void 0&&(Ue.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&j.samples>0&&ye(j)===!1){const ze=me?R:[R];J.__webglMultisampledFramebuffer=t.createFramebuffer(),J.__webglColorRenderbuffer=[],i.bindFramebuffer(t.FRAMEBUFFER,J.__webglMultisampledFramebuffer);for(let ke=0;ke<ze.length;ke++){const pt=ze[ke];J.__webglColorRenderbuffer[ke]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,J.__webglColorRenderbuffer[ke]);const Ue=s.convert(pt.format,pt.colorSpace),Ye=s.convert(pt.type),Je=M(pt.internalFormat,Ue,Ye,pt.colorSpace,j.isXRRenderTarget===!0),Ge=Oe(j);t.renderbufferStorageMultisample(t.RENDERBUFFER,Ge,Je,j.width,j.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ke,t.RENDERBUFFER,J.__webglColorRenderbuffer[ke])}t.bindRenderbuffer(t.RENDERBUFFER,null),j.depthBuffer&&(J.__webglDepthRenderbuffer=t.createRenderbuffer(),ae(J.__webglDepthRenderbuffer,j,!0)),i.bindFramebuffer(t.FRAMEBUFFER,null)}}if(xe){i.bindTexture(t.TEXTURE_CUBE_MAP,ve.__webglTexture),ee(t.TEXTURE_CUBE_MAP,R,Ne);for(let ze=0;ze<6;ze++)he(J.__webglFramebuffer[ze],j,R,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+ze);T(R,Ne)&&C(t.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(me){const ze=j.texture;for(let ke=0,pt=ze.length;ke<pt;ke++){const Ue=ze[ke],Ye=n.get(Ue);i.bindTexture(t.TEXTURE_2D,Ye.__webglTexture),ee(t.TEXTURE_2D,Ue,Ne),he(J.__webglFramebuffer,j,Ue,t.COLOR_ATTACHMENT0+ke,t.TEXTURE_2D),T(Ue,Ne)&&C(t.TEXTURE_2D)}i.unbindTexture()}else{let ze=t.TEXTURE_2D;(j.isWebGL3DRenderTarget||j.isWebGLArrayRenderTarget)&&(a?ze=j.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(ze,ve.__webglTexture),ee(ze,R,Ne),he(J.__webglFramebuffer,j,R,t.COLOR_ATTACHMENT0,ze),T(R,Ne)&&C(ze),i.unbindTexture()}j.depthBuffer&&I(j)}function Se(j){const R=P(j)||a,J=j.isWebGLMultipleRenderTargets===!0?j.texture:[j.texture];for(let ve=0,xe=J.length;ve<xe;ve++){const me=J[ve];if(T(me,R)){const Ne=j.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,ze=n.get(me).__webglTexture;i.bindTexture(Ne,ze),C(Ne),i.unbindTexture()}}}function Ee(j){if(a&&j.samples>0&&ye(j)===!1){const R=j.isWebGLMultipleRenderTargets?j.texture:[j.texture],J=j.width,ve=j.height;let xe=t.COLOR_BUFFER_BIT;const me=[],Ne=j.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ze=n.get(j),ke=j.isWebGLMultipleRenderTargets===!0;if(ke)for(let pt=0;pt<R.length;pt++)i.bindFramebuffer(t.FRAMEBUFFER,ze.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+pt,t.RENDERBUFFER,null),i.bindFramebuffer(t.FRAMEBUFFER,ze.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+pt,t.TEXTURE_2D,null,0);i.bindFramebuffer(t.READ_FRAMEBUFFER,ze.__webglMultisampledFramebuffer),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,ze.__webglFramebuffer);for(let pt=0;pt<R.length;pt++){me.push(t.COLOR_ATTACHMENT0+pt),j.depthBuffer&&me.push(Ne);const Ue=ze.__ignoreDepthValues!==void 0?ze.__ignoreDepthValues:!1;if(Ue===!1&&(j.depthBuffer&&(xe|=t.DEPTH_BUFFER_BIT),j.stencilBuffer&&(xe|=t.STENCIL_BUFFER_BIT)),ke&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,ze.__webglColorRenderbuffer[pt]),Ue===!0&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[Ne]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[Ne])),ke){const Ye=n.get(R[pt]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Ye,0)}t.blitFramebuffer(0,0,J,ve,0,0,J,ve,xe,t.NEAREST),f&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,me)}if(i.bindFramebuffer(t.READ_FRAMEBUFFER,null),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),ke)for(let pt=0;pt<R.length;pt++){i.bindFramebuffer(t.FRAMEBUFFER,ze.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+pt,t.RENDERBUFFER,ze.__webglColorRenderbuffer[pt]);const Ue=n.get(R[pt]).__webglTexture;i.bindFramebuffer(t.FRAMEBUFFER,ze.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+pt,t.TEXTURE_2D,Ue,0)}i.bindFramebuffer(t.DRAW_FRAMEBUFFER,ze.__webglMultisampledFramebuffer)}}function Oe(j){return Math.min(h,j.samples)}function ye(j){const R=n.get(j);return a&&j.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&R.__useRenderToTexture!==!1}function Pe(j){const R=o.render.frame;m.get(j)!==R&&(m.set(j,R),j.update())}function we(j,R){const J=j.colorSpace,ve=j.format,xe=j.type;return j.isCompressedTexture===!0||j.format===kk||J!==fc&&J!==Vd&&(J===yi?a===!1?e.has("EXT_sRGB")===!0&&ve===al?(j.format=kk,j.minFilter=pa,j.generateMipmaps=!1):R=Z3.sRGBToLinear(R):(ve!==al||xe!==bu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",J)),R}this.allocateTextureUnit=z,this.resetTextureUnits=K,this.setTexture2D=re,this.setTexture2DArray=ne,this.setTexture3D=B,this.setTextureCube=Q,this.rebindTextures=G,this.setupRenderTarget=ue,this.updateRenderTargetMipmap=Se,this.updateMultisampleRenderTarget=Ee,this.setupDepthRenderbuffer=I,this.setupFrameBufferTexture=he,this.useMultisampledRTT=ye}function jne(t,e,i){const n=i.isWebGL2;function r(s,o=Vd){let a;if(s===bu)return t.UNSIGNED_BYTE;if(s===j3)return t.UNSIGNED_SHORT_4_4_4_4;if(s===$3)return t.UNSIGNED_SHORT_5_5_5_1;if(s===TJ)return t.BYTE;if(s===xJ)return t.SHORT;if(s===VM)return t.UNSIGNED_SHORT;if(s===B3)return t.INT;if(s===hu)return t.UNSIGNED_INT;if(s===uu)return t.FLOAT;if(s===Dv)return n?t.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===kJ)return t.ALPHA;if(s===al)return t.RGBA;if(s===CJ)return t.LUMINANCE;if(s===MJ)return t.LUMINANCE_ALPHA;if(s===Md)return t.DEPTH_COMPONENT;if(s===ep)return t.DEPTH_STENCIL;if(s===kk)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===AJ)return t.RED;if(s===W3)return t.RED_INTEGER;if(s===VJ)return t.RG;if(s===G3)return t.RG_INTEGER;if(s===H3)return t.RGBA_INTEGER;if(s===zw||s===Uw||s===Bw||s===jw)if(o===yi)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===zw)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Uw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Bw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===jw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===zw)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Uw)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Bw)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===jw)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===pO||s===gO||s===vO||s===yO)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===pO)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===gO)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===vO)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===yO)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===LJ)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===SO||s===bO)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===SO)return o===yi?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===bO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===_O||s===PO||s===EO||s===wO||s===TO||s===xO||s===kO||s===CO||s===MO||s===AO||s===VO||s===LO||s===IO||s===OO)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===_O)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===PO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===EO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===wO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===TO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===xO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===kO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===CO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===MO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===AO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===VO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===LO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===IO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===OO)return o===yi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===$w)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===$w)return o===yi?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===IJ||s===DO||s===NO||s===RO)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===$w)return a.COMPRESSED_RED_RGTC1_EXT;if(s===DO)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===NO)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===RO)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Cd?n?t.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}class $ne extends ga{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let cb=class extends _o{constructor(){super(),this.isGroup=!0,this.type="Group"}};const Wne={type:"move"};class fT{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new cb,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new cb,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new k,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new k),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new cb,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new k,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new k),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const i=this._hand;if(i)for(const n of e.hand.values())this._getHandJoint(i,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&i.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const g of e.hand.values()){const v=i.getJointPose(g,n),p=this._getHandJoint(c,g);v!==null&&(p.matrix.fromArray(v.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,p.jointRadius=v.radius),p.visible=v!==null}const u=c.joints["index-finger-tip"],h=c.joints["thumb-tip"],d=u.position.distanceTo(h.position),f=.02,m=.005;c.inputState.pinching&&d>f+m?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-m&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=i.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=i.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Wne)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,i){if(e.joints[i.jointName]===void 0){const n=new cb;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[i.jointName]=n,e.add(n)}return e.joints[i.jointName]}}class Gne extends Ec{constructor(e,i,n,r,s,o,a,l,c,u){if(u=u!==void 0?u:Md,u!==Md&&u!==ep)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===Md&&(n=hu),n===void 0&&u===ep&&(n=Cd),super(null,r,s,o,a,l,u,n,c),this.isDepthTexture=!0,this.image={width:e,height:i},this.magFilter=a!==void 0?a:Hs,this.minFilter=l!==void 0?l:Hs,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const i=super.toJSON(e);return this.compareFunction!==null&&(i.compareFunction=this.compareFunction),i}}class Hne extends zp{constructor(e,i){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,h=null,d=null,f=null,m=null;const g=i.getContextAttributes();let v=null,p=null;const b=[],_=[];let P=null;const E=new ga;E.layers.enable(1),E.viewport=new kn;const T=new ga;T.layers.enable(2),T.viewport=new kn;const C=[E,T],M=new $ne;M.layers.enable(1),M.layers.enable(2);let x=null,V=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getCamera=function(){},this.setUserCamera=function(B){P=B},this.getController=function(B){let Q=b[B];return Q===void 0&&(Q=new fT,b[B]=Q),Q.getTargetRaySpace()},this.getControllerGrip=function(B){let Q=b[B];return Q===void 0&&(Q=new fT,b[B]=Q),Q.getGripSpace()},this.getHand=function(B){let Q=b[B];return Q===void 0&&(Q=new fT,b[B]=Q),Q.getHandSpace()};function N(B){const Q=_.indexOf(B.inputSource);if(Q===-1)return;const fe=b[Q];fe!==void 0&&(fe.update(B.inputSource,B.frame,c||o),fe.dispatchEvent({type:B.type,data:B.inputSource}))}function D(){r.removeEventListener("select",N),r.removeEventListener("selectstart",N),r.removeEventListener("selectend",N),r.removeEventListener("squeeze",N),r.removeEventListener("squeezestart",N),r.removeEventListener("squeezeend",N),r.removeEventListener("end",D),r.removeEventListener("inputsourceschange",O);for(let B=0;B<b.length;B++){const Q=_[B];Q!==null&&(_[B]=null,b[B].disconnect(Q))}x=null,V=null,e.setRenderTarget(v),f=null,d=null,h=null,r=null,p=null,ne.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(B){s=B,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(B){a=B,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(B){c=B},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return h},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=async function(B){if(r=B,r!==null){if(v=e.getRenderTarget(),r.addEventListener("select",N),r.addEventListener("selectstart",N),r.addEventListener("selectend",N),r.addEventListener("squeeze",N),r.addEventListener("squeezestart",N),r.addEventListener("squeezeend",N),r.addEventListener("end",D),r.addEventListener("inputsourceschange",O),g.xrCompatible!==!0&&await i.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Q={antialias:r.renderState.layers===void 0?g.antialias:!0,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,i,Q),r.updateRenderState({baseLayer:f}),p=new jd(f.framebufferWidth,f.framebufferHeight,{format:al,type:bu,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil})}else{let Q=null,fe=null,ie=null;g.depth&&(ie=g.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,Q=g.stencil?ep:Md,fe=g.stencil?Cd:hu);const se={colorFormat:i.RGBA8,depthFormat:ie,scaleFactor:s};h=new XRWebGLBinding(r,i),d=h.createProjectionLayer(se),r.updateRenderState({layers:[d]}),p=new jd(d.textureWidth,d.textureHeight,{format:al,type:bu,depthTexture:new Gne(d.textureWidth,d.textureHeight,fe,void 0,void 0,void 0,void 0,void 0,void 0,Q),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0});const ee=e.properties.get(p);ee.__ignoreDepthValues=d.ignoreDepthValues}p.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),ne.setContext(r),ne.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function O(B){for(let Q=0;Q<B.removed.length;Q++){const fe=B.removed[Q],ie=_.indexOf(fe);ie>=0&&(_[ie]=null,b[ie].disconnect(fe))}for(let Q=0;Q<B.added.length;Q++){const fe=B.added[Q];let ie=_.indexOf(fe);if(ie===-1){for(let ee=0;ee<b.length;ee++)if(ee>=_.length){_.push(fe),ie=ee;break}else if(_[ee]===null){_[ee]=fe,ie=ee;break}if(ie===-1)break}const se=b[ie];se&&se.connect(fe)}}const F=new k,X=new k;function Z(B,Q,fe){F.setFromMatrixPosition(Q.matrixWorld),X.setFromMatrixPosition(fe.matrixWorld);const ie=F.distanceTo(X),se=Q.projectionMatrix.elements,ee=fe.projectionMatrix.elements,de=se[14]/(se[10]-1),Y=se[14]/(se[10]+1),te=(se[9]+1)/se[5],he=(se[9]-1)/se[5],ae=(se[8]-1)/se[0],A=(ee[8]+1)/ee[0],I=de*ae,G=de*A,ue=ie/(-ae+A),Se=ue*-ae;Q.matrixWorld.decompose(B.position,B.quaternion,B.scale),B.translateX(Se),B.translateZ(ue),B.matrixWorld.compose(B.position,B.quaternion,B.scale),B.matrixWorldInverse.copy(B.matrixWorld).invert();const Ee=de+ue,Oe=Y+ue,ye=I-Se,Pe=G+(ie-Se),we=te*Y/Oe*Ee,j=he*Y/Oe*Ee;B.projectionMatrix.makePerspective(ye,Pe,we,j,Ee,Oe),B.projectionMatrixInverse.copy(B.projectionMatrix).invert()}function K(B,Q){Q===null?B.matrixWorld.copy(B.matrix):B.matrixWorld.multiplyMatrices(Q.matrixWorld,B.matrix),B.matrixWorldInverse.copy(B.matrixWorld).invert()}this.updateCameraXR=function(B){if(r===null)return B;P&&(B=P),M.near=T.near=E.near=B.near,M.far=T.far=E.far=B.far,(x!==M.near||V!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),x=M.near,V=M.far);const Q=B.parent,fe=M.cameras;K(M,Q);for(let ie=0;ie<fe.length;ie++)K(fe[ie],Q);return fe.length===2?Z(M,E,T):M.projectionMatrix.copy(E.projectionMatrix),P&&z(M,Q),M};function z(B,Q){const fe=P;Q===null?fe.matrix.copy(B.matrixWorld):(fe.matrix.copy(Q.matrixWorld),fe.matrix.invert(),fe.matrix.multiply(B.matrixWorld)),fe.matrix.decompose(fe.position,fe.quaternion,fe.scale),fe.updateMatrixWorld(!0);const ie=fe.children;for(let se=0,ee=ie.length;se<ee;se++)ie[se].updateMatrixWorld(!0);fe.projectionMatrix.copy(B.projectionMatrix),fe.projectionMatrixInverse.copy(B.projectionMatrixInverse),fe.isPerspectiveCamera&&(fe.fov=Ck*2*Math.atan(1/fe.projectionMatrix.elements[5]),fe.zoom=1)}this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(B){l=B,d!==null&&(d.fixedFoveation=B),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=B)};let H=null;function re(B,Q){if(u=Q.getViewerPose(c||o),m=Q,u!==null){const fe=u.views;f!==null&&(e.setRenderTargetFramebuffer(p,f.framebuffer),e.setRenderTarget(p));let ie=!1;fe.length!==M.cameras.length&&(M.cameras.length=0,ie=!0);for(let se=0;se<fe.length;se++){const ee=fe[se];let de=null;if(f!==null)de=f.getViewport(ee);else{const te=h.getViewSubImage(d,ee);de=te.viewport,se===0&&(e.setRenderTargetTextures(p,te.colorTexture,d.ignoreDepthValues?void 0:te.depthStencilTexture),e.setRenderTarget(p))}let Y=C[se];Y===void 0&&(Y=new ga,Y.layers.enable(se),Y.viewport=new kn,C[se]=Y),Y.matrix.fromArray(ee.transform.matrix),Y.matrix.decompose(Y.position,Y.quaternion,Y.scale),Y.projectionMatrix.fromArray(ee.projectionMatrix),Y.projectionMatrixInverse.copy(Y.projectionMatrix).invert(),Y.viewport.set(de.x,de.y,de.width,de.height),se===0&&(M.matrix.copy(Y.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),ie===!0&&M.cameras.push(Y)}}for(let fe=0;fe<b.length;fe++){const ie=_[fe],se=b[fe];ie!==null&&se!==void 0&&se.update(ie,Q,c||o)}H&&H(B,Q),Q.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Q}),m=null}const ne=new l4;ne.setAnimationLoop(re),this.setAnimationLoop=function(B){H=B},this.dispose=function(){}}}function qne(t,e){function i(v,p){v.matrixAutoUpdate===!0&&v.updateMatrix(),p.value.copy(v.matrix)}function n(v,p){p.color.getRGB(v.fogColor.value,s4(t)),p.isFog?(v.fogNear.value=p.near,v.fogFar.value=p.far):p.isFogExp2&&(v.fogDensity.value=p.density)}function r(v,p,b,_,P){p.isMeshBasicMaterial||p.isMeshLambertMaterial?s(v,p):p.isMeshToonMaterial?(s(v,p),h(v,p)):p.isMeshPhongMaterial?(s(v,p),u(v,p)):p.isMeshStandardMaterial?(s(v,p),d(v,p),p.isMeshPhysicalMaterial&&f(v,p,P)):p.isMeshMatcapMaterial?(s(v,p),m(v,p)):p.isMeshDepthMaterial?s(v,p):p.isMeshDistanceMaterial?(s(v,p),g(v,p)):p.isMeshNormalMaterial?s(v,p):p.isLineBasicMaterial?(o(v,p),p.isLineDashedMaterial&&a(v,p)):p.isPointsMaterial?l(v,p,b,_):p.isSpriteMaterial?c(v,p):p.isShadowMaterial?(v.color.value.copy(p.color),v.opacity.value=p.opacity):p.isShaderMaterial&&(p.uniformsNeedUpdate=!1)}function s(v,p){v.opacity.value=p.opacity,p.color&&v.diffuse.value.copy(p.color),p.emissive&&v.emissive.value.copy(p.emissive).multiplyScalar(p.emissiveIntensity),p.map&&(v.map.value=p.map,i(p.map,v.mapTransform)),p.alphaMap&&(v.alphaMap.value=p.alphaMap,i(p.alphaMap,v.alphaMapTransform)),p.bumpMap&&(v.bumpMap.value=p.bumpMap,i(p.bumpMap,v.bumpMapTransform),v.bumpScale.value=p.bumpScale,p.side===bo&&(v.bumpScale.value*=-1)),p.normalMap&&(v.normalMap.value=p.normalMap,i(p.normalMap,v.normalMapTransform),v.normalScale.value.copy(p.normalScale),p.side===bo&&v.normalScale.value.negate()),p.displacementMap&&(v.displacementMap.value=p.displacementMap,i(p.displacementMap,v.displacementMapTransform),v.displacementScale.value=p.displacementScale,v.displacementBias.value=p.displacementBias),p.emissiveMap&&(v.emissiveMap.value=p.emissiveMap,i(p.emissiveMap,v.emissiveMapTransform)),p.specularMap&&(v.specularMap.value=p.specularMap,i(p.specularMap,v.specularMapTransform)),p.alphaTest>0&&(v.alphaTest.value=p.alphaTest);const b=e.get(p).envMap;if(b&&(v.envMap.value=b,v.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=p.reflectivity,v.ior.value=p.ior,v.refractionRatio.value=p.refractionRatio),p.lightMap){v.lightMap.value=p.lightMap;const _=t.useLegacyLights===!0?Math.PI:1;v.lightMapIntensity.value=p.lightMapIntensity*_,i(p.lightMap,v.lightMapTransform)}p.aoMap&&(v.aoMap.value=p.aoMap,v.aoMapIntensity.value=p.aoMapIntensity,i(p.aoMap,v.aoMapTransform))}function o(v,p){v.diffuse.value.copy(p.color),v.opacity.value=p.opacity,p.map&&(v.map.value=p.map,i(p.map,v.mapTransform))}function a(v,p){v.dashSize.value=p.dashSize,v.totalSize.value=p.dashSize+p.gapSize,v.scale.value=p.scale}function l(v,p,b,_){v.diffuse.value.copy(p.color),v.opacity.value=p.opacity,v.size.value=p.size*b,v.scale.value=_*.5,p.map&&(v.map.value=p.map,i(p.map,v.uvTransform)),p.alphaMap&&(v.alphaMap.value=p.alphaMap,i(p.alphaMap,v.alphaMapTransform)),p.alphaTest>0&&(v.alphaTest.value=p.alphaTest)}function c(v,p){v.diffuse.value.copy(p.color),v.opacity.value=p.opacity,v.rotation.value=p.rotation,p.map&&(v.map.value=p.map,i(p.map,v.mapTransform)),p.alphaMap&&(v.alphaMap.value=p.alphaMap,i(p.alphaMap,v.alphaMapTransform)),p.alphaTest>0&&(v.alphaTest.value=p.alphaTest)}function u(v,p){v.specular.value.copy(p.specular),v.shininess.value=Math.max(p.shininess,1e-4)}function h(v,p){p.gradientMap&&(v.gradientMap.value=p.gradientMap)}function d(v,p){v.metalness.value=p.metalness,p.metalnessMap&&(v.metalnessMap.value=p.metalnessMap,i(p.metalnessMap,v.metalnessMapTransform)),v.roughness.value=p.roughness,p.roughnessMap&&(v.roughnessMap.value=p.roughnessMap,i(p.roughnessMap,v.roughnessMapTransform)),e.get(p).envMap&&(v.envMapIntensity.value=p.envMapIntensity)}function f(v,p,b){v.ior.value=p.ior,p.sheen>0&&(v.sheenColor.value.copy(p.sheenColor).multiplyScalar(p.sheen),v.sheenRoughness.value=p.sheenRoughness,p.sheenColorMap&&(v.sheenColorMap.value=p.sheenColorMap,i(p.sheenColorMap,v.sheenColorMapTransform)),p.sheenRoughnessMap&&(v.sheenRoughnessMap.value=p.sheenRoughnessMap,i(p.sheenRoughnessMap,v.sheenRoughnessMapTransform))),p.clearcoat>0&&(v.clearcoat.value=p.clearcoat,v.clearcoatRoughness.value=p.clearcoatRoughness,p.clearcoatMap&&(v.clearcoatMap.value=p.clearcoatMap,i(p.clearcoatMap,v.clearcoatMapTransform)),p.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=p.clearcoatRoughnessMap,i(p.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),p.clearcoatNormalMap&&(v.clearcoatNormalMap.value=p.clearcoatNormalMap,i(p.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(p.clearcoatNormalScale),p.side===bo&&v.clearcoatNormalScale.value.negate())),p.iridescence>0&&(v.iridescence.value=p.iridescence,v.iridescenceIOR.value=p.iridescenceIOR,v.iridescenceThicknessMinimum.value=p.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=p.iridescenceThicknessRange[1],p.iridescenceMap&&(v.iridescenceMap.value=p.iridescenceMap,i(p.iridescenceMap,v.iridescenceMapTransform)),p.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=p.iridescenceThicknessMap,i(p.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),p.transmission>0&&(v.transmission.value=p.transmission,v.transmissionSamplerMap.value=b.texture,v.transmissionSamplerSize.value.set(b.width,b.height),p.transmissionMap&&(v.transmissionMap.value=p.transmissionMap,i(p.transmissionMap,v.transmissionMapTransform)),v.thickness.value=p.thickness,p.thicknessMap&&(v.thicknessMap.value=p.thicknessMap,i(p.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=p.attenuationDistance,v.attenuationColor.value.copy(p.attenuationColor)),p.anisotropy>0&&(v.anisotropyVector.value.set(p.anisotropy*Math.cos(p.anisotropyRotation),p.anisotropy*Math.sin(p.anisotropyRotation)),p.anisotropyMap&&(v.anisotropyMap.value=p.anisotropyMap,i(p.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=p.specularIntensity,v.specularColor.value.copy(p.specularColor),p.specularColorMap&&(v.specularColorMap.value=p.specularColorMap,i(p.specularColorMap,v.specularColorMapTransform)),p.specularIntensityMap&&(v.specularIntensityMap.value=p.specularIntensityMap,i(p.specularIntensityMap,v.specularIntensityMapTransform))}function m(v,p){p.matcap&&(v.matcap.value=p.matcap)}function g(v,p){const b=e.get(p).light;v.referencePosition.value.setFromMatrixPosition(b.matrixWorld),v.nearDistance.value=b.shadow.camera.near,v.farDistance.value=b.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function Kne(t,e,i,n){let r={},s={},o=[];const a=i.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(b,_){const P=_.program;n.uniformBlockBinding(b,P)}function c(b,_){let P=r[b.id];P===void 0&&(m(b),P=u(b),r[b.id]=P,b.addEventListener("dispose",v));const E=_.program;n.updateUBOMapping(b,E);const T=e.render.frame;s[b.id]!==T&&(d(b),s[b.id]=T)}function u(b){const _=h();b.__bindingPointIndex=_;const P=t.createBuffer(),E=b.__size,T=b.usage;return t.bindBuffer(t.UNIFORM_BUFFER,P),t.bufferData(t.UNIFORM_BUFFER,E,T),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,_,P),P}function h(){for(let b=0;b<a;b++)if(o.indexOf(b)===-1)return o.push(b),b;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(b){const _=r[b.id],P=b.uniforms,E=b.__cache;t.bindBuffer(t.UNIFORM_BUFFER,_);for(let T=0,C=P.length;T<C;T++){const M=P[T];if(f(M,T,E)===!0){const x=M.__offset,V=Array.isArray(M.value)?M.value:[M.value];let N=0;for(let D=0;D<V.length;D++){const O=V[D],F=g(O);typeof O=="number"?(M.__data[0]=O,t.bufferSubData(t.UNIFORM_BUFFER,x+N,M.__data)):O.isMatrix3?(M.__data[0]=O.elements[0],M.__data[1]=O.elements[1],M.__data[2]=O.elements[2],M.__data[3]=O.elements[0],M.__data[4]=O.elements[3],M.__data[5]=O.elements[4],M.__data[6]=O.elements[5],M.__data[7]=O.elements[0],M.__data[8]=O.elements[6],M.__data[9]=O.elements[7],M.__data[10]=O.elements[8],M.__data[11]=O.elements[0]):(O.toArray(M.__data,N),N+=F.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,x,M.__data)}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function f(b,_,P){const E=b.value;if(P[_]===void 0){if(typeof E=="number")P[_]=E;else{const T=Array.isArray(E)?E:[E],C=[];for(let M=0;M<T.length;M++)C.push(T[M].clone());P[_]=C}return!0}else if(typeof E=="number"){if(P[_]!==E)return P[_]=E,!0}else{const T=Array.isArray(P[_])?P[_]:[P[_]],C=Array.isArray(E)?E:[E];for(let M=0;M<T.length;M++){const x=T[M];if(x.equals(C[M])===!1)return x.copy(C[M]),!0}}return!1}function m(b){const _=b.uniforms;let P=0;const E=16;let T=0;for(let C=0,M=_.length;C<M;C++){const x=_[C],V={boundary:0,storage:0},N=Array.isArray(x.value)?x.value:[x.value];for(let D=0,O=N.length;D<O;D++){const F=N[D],X=g(F);V.boundary+=X.boundary,V.storage+=X.storage}if(x.__data=new Float32Array(V.storage/Float32Array.BYTES_PER_ELEMENT),x.__offset=P,C>0){T=P%E;const D=E-T;T!==0&&D-V.boundary<0&&(P+=E-T,x.__offset=P)}P+=V.storage}return T=P%E,T>0&&(P+=E-T),b.__size=P,b.__cache={},this}function g(b){const _={boundary:0,storage:0};return typeof b=="number"?(_.boundary=4,_.storage=4):b.isVector2?(_.boundary=8,_.storage=8):b.isVector3||b.isColor?(_.boundary=16,_.storage=12):b.isVector4?(_.boundary=16,_.storage=16):b.isMatrix3?(_.boundary=48,_.storage=48):b.isMatrix4?(_.boundary=64,_.storage=64):b.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",b),_}function v(b){const _=b.target;_.removeEventListener("dispose",v);const P=o.indexOf(_.__bindingPointIndex);o.splice(P,1),t.deleteBuffer(r[_.id]),delete r[_.id],delete s[_.id]}function p(){for(const b in r)t.deleteBuffer(r[b]);o=[],r={},s={}}return{bind:l,update:c,dispose:p}}function Xne(){const t=Nv("canvas");return t.style.display="block",t}class m4{constructor(e={}){const{canvas:i=Xne(),context:n=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1}=e;this.isWebGLRenderer=!0;let d;n!==null?d=n.getContextAttributes().alpha:d=o;const f=new Uint32Array(4),m=new Int32Array(4);let g=null,v=null;const p=[],b=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=yi,this.useLegacyLights=!0,this.toneMapping=th,this.toneMappingExposure=1;const _=this;let P=!1,E=0,T=0,C=null,M=-1,x=null;const V=new kn,N=new kn;let D=null;const O=new hn(0);let F=0,X=i.width,Z=i.height,K=1,z=null,H=null;const re=new kn(0,0,X,Z),ne=new kn(0,0,X,Z);let B=!1;const Q=new IM;let fe=!1,ie=!1,se=null;const ee=new Pt,de=new Pi,Y=new k,te={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function he(){return C===null?K:1}let ae=n;function A(ce,Ae){for(let Re=0;Re<ce.length;Re++){const Me=ce[Re],Fe=i.getContext(Me,Ae);if(Fe!==null)return Fe}return null}try{const ce={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in i&&i.setAttribute("data-engine",`three.js r${AM}`),i.addEventListener("webglcontextlost",et,!1),i.addEventListener("webglcontextrestored",Ie,!1),i.addEventListener("webglcontextcreationerror",rt,!1),ae===null){const Ae=["webgl2","webgl","experimental-webgl"];if(_.isWebGL1Renderer===!0&&Ae.shift(),ae=A(Ae,ce),ae===null)throw A(Ae)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ae instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),ae.getShaderPrecisionFormat===void 0&&(ae.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ce){throw console.error("THREE.WebGLRenderer: "+ce.message),ce}let I,G,ue,Se,Ee,Oe,ye,Pe,we,j,R,J,ve,xe,me,Ne,ze,ke,pt,Ue,Ye,Je,Ge,St;function Ft(){I=new oie(ae),G=new eie(ae,I,e),I.init(G),Je=new jne(ae,I,G),ue=new Une(ae,I,G),Se=new cie(ae),Ee=new xne,Oe=new Bne(ae,I,ue,Ee,G,Je,Se),ye=new iie(_),Pe=new sie(_),we=new _Q(ae,G),Ge=new Jte(ae,I,we,G),j=new aie(ae,we,Se,Ge),R=new fie(ae,j,we,Se),pt=new die(ae,G,Oe),Ne=new tie(Ee),J=new Tne(_,ye,Pe,I,G,Ge,Ne),ve=new qne(_,Ee),xe=new Cne,me=new One(I,G),ke=new Zte(_,ye,Pe,ue,R,d,l),ze=new zne(_,R,G),St=new Kne(ae,Se,G,ue),Ue=new Qte(ae,I,Se,G),Ye=new lie(ae,I,Se,G),Se.programs=J.programs,_.capabilities=G,_.extensions=I,_.properties=Ee,_.renderLists=xe,_.shadowMap=ze,_.state=ue,_.info=Se}Ft();const be=new Hne(_,ae);this.xr=be,this.getContext=function(){return ae},this.getContextAttributes=function(){return ae.getContextAttributes()},this.forceContextLoss=function(){const ce=I.get("WEBGL_lose_context");ce&&ce.loseContext()},this.forceContextRestore=function(){const ce=I.get("WEBGL_lose_context");ce&&ce.restoreContext()},this.getPixelRatio=function(){return K},this.setPixelRatio=function(ce){ce!==void 0&&(K=ce,this.setSize(X,Z,!1))},this.getSize=function(ce){return ce.set(X,Z)},this.setSize=function(ce,Ae,Re=!0){if(be.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}X=ce,Z=Ae,i.width=Math.floor(ce*K),i.height=Math.floor(Ae*K),Re===!0&&(i.style.width=ce+"px",i.style.height=Ae+"px"),this.setViewport(0,0,ce,Ae)},this.getDrawingBufferSize=function(ce){return ce.set(X*K,Z*K).floor()},this.setDrawingBufferSize=function(ce,Ae,Re){X=ce,Z=Ae,K=Re,i.width=Math.floor(ce*Re),i.height=Math.floor(Ae*Re),this.setViewport(0,0,ce,Ae)},this.getCurrentViewport=function(ce){return ce.copy(V)},this.getViewport=function(ce){return ce.copy(re)},this.setViewport=function(ce,Ae,Re,Me){ce.isVector4?re.set(ce.x,ce.y,ce.z,ce.w):re.set(ce,Ae,Re,Me),ue.viewport(V.copy(re).multiplyScalar(K).floor())},this.getScissor=function(ce){return ce.copy(ne)},this.setScissor=function(ce,Ae,Re,Me){ce.isVector4?ne.set(ce.x,ce.y,ce.z,ce.w):ne.set(ce,Ae,Re,Me),ue.scissor(N.copy(ne).multiplyScalar(K).floor())},this.getScissorTest=function(){return B},this.setScissorTest=function(ce){ue.setScissorTest(B=ce)},this.setOpaqueSort=function(ce){z=ce},this.setTransparentSort=function(ce){H=ce},this.getClearColor=function(ce){return ce.copy(ke.getClearColor())},this.setClearColor=function(){ke.setClearColor.apply(ke,arguments)},this.getClearAlpha=function(){return ke.getClearAlpha()},this.setClearAlpha=function(){ke.setClearAlpha.apply(ke,arguments)},this.clear=function(ce=!0,Ae=!0,Re=!0){let Me=0;if(ce){let Fe=!1;if(C!==null){const xt=C.texture.format;Fe=xt===H3||xt===G3||xt===W3}if(Fe){const xt=C.texture.type,Wt=xt===bu||xt===hu||xt===VM||xt===Cd||xt===j3||xt===$3,Gt=ke.getClearColor(),ti=ke.getClearAlpha(),Ei=Gt.r,ai=Gt.g,ui=Gt.b,dn=Ee.get(C).__webglFramebuffer;Wt?(f[0]=Ei,f[1]=ai,f[2]=ui,f[3]=ti,ae.clearBufferuiv(ae.COLOR,dn,f)):(m[0]=Ei,m[1]=ai,m[2]=ui,m[3]=ti,ae.clearBufferiv(ae.COLOR,dn,m))}else Me|=ae.COLOR_BUFFER_BIT}Ae&&(Me|=ae.DEPTH_BUFFER_BIT),Re&&(Me|=ae.STENCIL_BUFFER_BIT),ae.clear(Me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",et,!1),i.removeEventListener("webglcontextrestored",Ie,!1),i.removeEventListener("webglcontextcreationerror",rt,!1),xe.dispose(),me.dispose(),Ee.dispose(),ye.dispose(),Pe.dispose(),R.dispose(),Ge.dispose(),St.dispose(),J.dispose(),be.dispose(),be.removeEventListener("sessionstart",Sn),be.removeEventListener("sessionend",Vo),se&&(se.dispose(),se=null),Vn.stop()};function et(ce){ce.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),P=!0}function Ie(){console.log("THREE.WebGLRenderer: Context Restored."),P=!1;const ce=Se.autoReset,Ae=ze.enabled,Re=ze.autoUpdate,Me=ze.needsUpdate,Fe=ze.type;Ft(),Se.autoReset=ce,ze.enabled=Ae,ze.autoUpdate=Re,ze.needsUpdate=Me,ze.type=Fe}function rt(ce){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ce.statusMessage)}function Ke(ce){const Ae=ce.target;Ae.removeEventListener("dispose",Ke),Nt(Ae)}function Nt(ce){zi(ce),Ee.remove(ce)}function zi(ce){const Ae=Ee.get(ce).programs;Ae!==void 0&&(Ae.forEach(function(Re){J.releaseProgram(Re)}),ce.isShaderMaterial&&J.releaseShaderCache(ce))}this.renderBufferDirect=function(ce,Ae,Re,Me,Fe,xt){Ae===null&&(Ae=te);const Wt=Fe.isMesh&&Fe.matrixWorld.determinant()<0,Gt=iw(ce,Ae,Re,Me,Fe);ue.setMaterial(Me,Wt);let ti=Re.index,Ei=1;Me.wireframe===!0&&(ti=j.getWireframeAttribute(Re),Ei=2);const ai=Re.drawRange,ui=Re.attributes.position;let dn=ai.start*Ei,Ln=(ai.start+ai.count)*Ei;xt!==null&&(dn=Math.max(dn,xt.start*Ei),Ln=Math.min(Ln,(xt.start+xt.count)*Ei)),ti!==null?(dn=Math.max(dn,0),Ln=Math.min(Ln,ti.count)):ui!=null&&(dn=Math.max(dn,0),Ln=Math.min(Ln,ui.count));const ro=Ln-dn;if(ro<0||ro===1/0)return;Ge.setup(Fe,Me,Gt,Re,ti);let so,Rn=Ue;if(ti!==null&&(so=we.get(ti),Rn=Ye,Rn.setIndex(so)),Fe.isMesh)Me.wireframe===!0?(ue.setLineWidth(Me.wireframeLinewidth*he()),Rn.setMode(ae.LINES)):Rn.setMode(ae.TRIANGLES);else if(Fe.isLine){let Ci=Me.linewidth;Ci===void 0&&(Ci=1),ue.setLineWidth(Ci*he()),Fe.isLineSegments?Rn.setMode(ae.LINES):Fe.isLineLoop?Rn.setMode(ae.LINE_LOOP):Rn.setMode(ae.LINE_STRIP)}else Fe.isPoints?Rn.setMode(ae.POINTS):Fe.isSprite&&Rn.setMode(ae.TRIANGLES);if(Fe.isInstancedMesh)Rn.renderInstances(dn,ro,Fe.count);else if(Re.isInstancedBufferGeometry){const Ci=Re._maxInstanceCount!==void 0?Re._maxInstanceCount:1/0,og=Math.min(Re.instanceCount,Ci);Rn.renderInstances(dn,ro,og)}else Rn.render(dn,ro)},this.compile=function(ce,Ae){function Re(Me,Fe,xt){Me.transparent===!0&&Me.side===Uc&&Me.forceSinglePass===!1?(Me.side=bo,Me.needsUpdate=!0,no(Me,Fe,xt),Me.side=Cu,Me.needsUpdate=!0,no(Me,Fe,xt),Me.side=Uc):no(Me,Fe,xt)}v=me.get(ce),v.init(),b.push(v),ce.traverseVisible(function(Me){Me.isLight&&Me.layers.test(Ae.layers)&&(v.pushLight(Me),Me.castShadow&&v.pushShadow(Me))}),v.setupLights(_.useLegacyLights),ce.traverse(function(Me){const Fe=Me.material;if(Fe)if(Array.isArray(Fe))for(let xt=0;xt<Fe.length;xt++){const Wt=Fe[xt];Re(Wt,ce,Me)}else Re(Fe,ce,Me)}),b.pop(),v=null};let gn=null;function wc(ce){gn&&gn(ce)}function Sn(){Vn.stop()}function Vo(){Vn.start()}const Vn=new l4;Vn.setAnimationLoop(wc),typeof self<"u"&&Vn.setContext(self),this.setAnimationLoop=function(ce){gn=ce,be.setAnimationLoop(ce),ce===null?Vn.stop():Vn.start()},be.addEventListener("sessionstart",Sn),be.addEventListener("sessionend",Vo),this.render=function(ce,Ae){if(Ae!==void 0&&Ae.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(P===!0)return;ce.matrixWorldAutoUpdate===!0&&ce.updateMatrixWorld(),Ae.parent===null&&Ae.matrixWorldAutoUpdate===!0&&Ae.updateMatrixWorld(),be.enabled===!0&&be.isPresenting===!0&&(Ae=be.updateCameraXR(Ae)),ce.isScene===!0&&ce.onBeforeRender(_,ce,Ae,C),v=me.get(ce,b.length),v.init(),b.push(v),ee.multiplyMatrices(Ae.projectionMatrix,Ae.matrixWorldInverse),Q.setFromProjectionMatrix(ee),ie=this.localClippingEnabled,fe=Ne.init(this.clippingPlanes,ie),g=xe.get(ce,p.length),g.init(),p.push(g),bS(ce,Ae,0,_.sortObjects),g.finish(),_.sortObjects===!0&&g.sort(z,H),fe===!0&&Ne.beginShadows();const Re=v.state.shadowsArray;if(ze.render(Re,ce,Ae),fe===!0&&Ne.endShadows(),this.info.autoReset===!0&&this.info.reset(),this.info.render.frame++,ke.render(g,ce),v.setupLights(_.useLegacyLights),Ae.isArrayCamera){const Me=Ae.cameras;for(let Fe=0,xt=Me.length;Fe<xt;Fe++){const Wt=Me[Fe];_S(g,ce,Wt,Wt.viewport)}}else _S(g,ce,Ae);C!==null&&(Oe.updateMultisampleRenderTarget(C),Oe.updateRenderTargetMipmap(C)),ce.isScene===!0&&ce.onAfterRender(_,ce,Ae),Ge.resetDefaultState(),M=-1,x=null,b.pop(),b.length>0?v=b[b.length-1]:v=null,p.pop(),p.length>0?g=p[p.length-1]:g=null};function bS(ce,Ae,Re,Me){if(ce.visible===!1)return;if(ce.layers.test(Ae.layers)){if(ce.isGroup)Re=ce.renderOrder;else if(ce.isLOD)ce.autoUpdate===!0&&ce.update(Ae);else if(ce.isLight)v.pushLight(ce),ce.castShadow&&v.pushShadow(ce);else if(ce.isSprite){if(!ce.frustumCulled||Q.intersectsSprite(ce)){Me&&Y.setFromMatrixPosition(ce.matrixWorld).applyMatrix4(ee);const Wt=R.update(ce),Gt=ce.material;Gt.visible&&g.push(ce,Wt,Gt,Re,Y.z,null)}}else if((ce.isMesh||ce.isLine||ce.isPoints)&&(!ce.frustumCulled||Q.intersectsObject(ce))){ce.isSkinnedMesh&&ce.skeleton.frame!==Se.render.frame&&(ce.skeleton.update(),ce.skeleton.frame=Se.render.frame);const Wt=R.update(ce),Gt=ce.material;if(Me&&(ce.boundingSphere!==void 0?(ce.boundingSphere===null&&ce.computeBoundingSphere(),Y.copy(ce.boundingSphere.center)):(Wt.boundingSphere===null&&Wt.computeBoundingSphere(),Y.copy(Wt.boundingSphere.center)),Y.applyMatrix4(ce.matrixWorld).applyMatrix4(ee)),Array.isArray(Gt)){const ti=Wt.groups;for(let Ei=0,ai=ti.length;Ei<ai;Ei++){const ui=ti[Ei],dn=Gt[ui.materialIndex];dn&&dn.visible&&g.push(ce,Wt,dn,Re,Y.z,ui)}}else Gt.visible&&g.push(ce,Wt,Gt,Re,Y.z,null)}}const xt=ce.children;for(let Wt=0,Gt=xt.length;Wt<Gt;Wt++)bS(xt[Wt],Ae,Re,Me)}function _S(ce,Ae,Re,Me){const Fe=ce.opaque,xt=ce.transmissive,Wt=ce.transparent;v.setupLightsView(Re),fe===!0&&Ne.setGlobalState(_.clippingPlanes,Re),xt.length>0&&tw(Fe,xt,Ae,Re),Me&&ue.viewport(V.copy(Me)),Fe.length>0&&Sf(Fe,Ae,Re),xt.length>0&&Sf(xt,Ae,Re),Wt.length>0&&Sf(Wt,Ae,Re),ue.buffers.depth.setTest(!0),ue.buffers.depth.setMask(!0),ue.buffers.color.setMask(!0),ue.setPolygonOffset(!1)}function tw(ce,Ae,Re,Me){const Fe=G.isWebGL2;se===null&&(se=new jd(1,1,{generateMipmaps:!0,type:I.has("EXT_color_buffer_half_float")?Dv:bu,minFilter:Ov,samples:Fe&&a===!0?4:0})),_.getDrawingBufferSize(de),Fe?se.setSize(de.x,de.y):se.setSize(Mk(de.x),Mk(de.y));const xt=_.getRenderTarget();_.setRenderTarget(se),_.getClearColor(O),F=_.getClearAlpha(),F<1&&_.setClearColor(16777215,.5),_.clear();const Wt=_.toneMapping;_.toneMapping=th,Sf(ce,Re,Me),Oe.updateMultisampleRenderTarget(se),Oe.updateRenderTargetMipmap(se);let Gt=!1;for(let ti=0,Ei=Ae.length;ti<Ei;ti++){const ai=Ae[ti],ui=ai.object,dn=ai.geometry,Ln=ai.material,ro=ai.group;if(Ln.side===Uc&&ui.layers.test(Me.layers)){const so=Ln.side;Ln.side=bo,Ln.needsUpdate=!0,PS(ui,Re,Me,dn,Ln,ro),Ln.side=so,Ln.needsUpdate=!0,Gt=!0}}Gt===!0&&(Oe.updateMultisampleRenderTarget(se),Oe.updateRenderTargetMipmap(se)),_.setRenderTarget(xt),_.setClearColor(O,F),_.toneMapping=Wt}function Sf(ce,Ae,Re){const Me=Ae.isScene===!0?Ae.overrideMaterial:null;for(let Fe=0,xt=ce.length;Fe<xt;Fe++){const Wt=ce[Fe],Gt=Wt.object,ti=Wt.geometry,Ei=Me===null?Wt.material:Me,ai=Wt.group;Gt.layers.test(Re.layers)&&PS(Gt,Ae,Re,ti,Ei,ai)}}function PS(ce,Ae,Re,Me,Fe,xt){ce.onBeforeRender(_,Ae,Re,Me,Fe,xt),ce.modelViewMatrix.multiplyMatrices(Re.matrixWorldInverse,ce.matrixWorld),ce.normalMatrix.getNormalMatrix(ce.modelViewMatrix),Fe.onBeforeRender(_,Ae,Re,Me,ce,xt),Fe.transparent===!0&&Fe.side===Uc&&Fe.forceSinglePass===!1?(Fe.side=bo,Fe.needsUpdate=!0,_.renderBufferDirect(Re,Ae,Me,Fe,ce,xt),Fe.side=Cu,Fe.needsUpdate=!0,_.renderBufferDirect(Re,Ae,Me,Fe,ce,xt),Fe.side=Uc):_.renderBufferDirect(Re,Ae,Me,Fe,ce,xt),ce.onAfterRender(_,Ae,Re,Me,Fe,xt)}function no(ce,Ae,Re){Ae.isScene!==!0&&(Ae=te);const Me=Ee.get(ce),Fe=v.state.lights,xt=v.state.shadowsArray,Wt=Fe.state.version,Gt=J.getParameters(ce,Fe.state,xt,Ae,Re),ti=J.getProgramCacheKey(Gt);let Ei=Me.programs;Me.environment=ce.isMeshStandardMaterial?Ae.environment:null,Me.fog=Ae.fog,Me.envMap=(ce.isMeshStandardMaterial?Pe:ye).get(ce.envMap||Me.environment),Ei===void 0&&(ce.addEventListener("dispose",Ke),Ei=new Map,Me.programs=Ei);let ai=Ei.get(ti);if(ai!==void 0){if(Me.currentProgram===ai&&Me.lightsStateVersion===Wt)return ES(ce,Gt),ai}else Gt.uniforms=J.getUniforms(ce),ce.onBuild(Re,Gt,_),ce.onBeforeCompile(Gt,_),ai=J.acquireProgram(Gt,ti),Ei.set(ti,ai),Me.uniforms=Gt.uniforms;const ui=Me.uniforms;(!ce.isShaderMaterial&&!ce.isRawShaderMaterial||ce.clipping===!0)&&(ui.clippingPlanes=Ne.uniform),ES(ce,Gt),Me.needsLights=rw(ce),Me.lightsStateVersion=Wt,Me.needsLights&&(ui.ambientLightColor.value=Fe.state.ambient,ui.lightProbe.value=Fe.state.probe,ui.directionalLights.value=Fe.state.directional,ui.directionalLightShadows.value=Fe.state.directionalShadow,ui.spotLights.value=Fe.state.spot,ui.spotLightShadows.value=Fe.state.spotShadow,ui.rectAreaLights.value=Fe.state.rectArea,ui.ltc_1.value=Fe.state.rectAreaLTC1,ui.ltc_2.value=Fe.state.rectAreaLTC2,ui.pointLights.value=Fe.state.point,ui.pointLightShadows.value=Fe.state.pointShadow,ui.hemisphereLights.value=Fe.state.hemi,ui.directionalShadowMap.value=Fe.state.directionalShadowMap,ui.directionalShadowMatrix.value=Fe.state.directionalShadowMatrix,ui.spotShadowMap.value=Fe.state.spotShadowMap,ui.spotLightMatrix.value=Fe.state.spotLightMatrix,ui.spotLightMap.value=Fe.state.spotLightMap,ui.pointShadowMap.value=Fe.state.pointShadowMap,ui.pointShadowMatrix.value=Fe.state.pointShadowMatrix);const dn=ai.getUniforms(),Ln=m0.seqWithValue(dn.seq,ui);return Me.currentProgram=ai,Me.uniformsList=Ln,ai}function ES(ce,Ae){const Re=Ee.get(ce);Re.outputColorSpace=Ae.outputColorSpace,Re.instancing=Ae.instancing,Re.skinning=Ae.skinning,Re.morphTargets=Ae.morphTargets,Re.morphNormals=Ae.morphNormals,Re.morphColors=Ae.morphColors,Re.morphTargetsCount=Ae.morphTargetsCount,Re.numClippingPlanes=Ae.numClippingPlanes,Re.numIntersection=Ae.numClipIntersection,Re.vertexAlphas=Ae.vertexAlphas,Re.vertexTangents=Ae.vertexTangents,Re.toneMapping=Ae.toneMapping}function iw(ce,Ae,Re,Me,Fe){Ae.isScene!==!0&&(Ae=te),Oe.resetTextureUnits();const xt=Ae.fog,Wt=Me.isMeshStandardMaterial?Ae.environment:null,Gt=C===null?_.outputColorSpace:C.isXRRenderTarget===!0?C.texture.colorSpace:fc,ti=(Me.isMeshStandardMaterial?Pe:ye).get(Me.envMap||Wt),Ei=Me.vertexColors===!0&&!!Re.attributes.color&&Re.attributes.color.itemSize===4,ai=!!Re.attributes.tangent&&(!!Me.normalMap||Me.anisotropy>0),ui=!!Re.morphAttributes.position,dn=!!Re.morphAttributes.normal,Ln=!!Re.morphAttributes.color,ro=Me.toneMapped?_.toneMapping:th,so=Re.morphAttributes.position||Re.morphAttributes.normal||Re.morphAttributes.color,Rn=so!==void 0?so.length:0,Ci=Ee.get(Me),og=v.state.lights;if(fe===!0&&(ie===!0||ce!==x)){const Ls=ce===x&&Me.id===M;Ne.setState(Me,ce,Ls)}let or=!1;Me.version===Ci.__version?(Ci.needsLights&&Ci.lightsStateVersion!==og.state.version||Ci.outputColorSpace!==Gt||Fe.isInstancedMesh&&Ci.instancing===!1||!Fe.isInstancedMesh&&Ci.instancing===!0||Fe.isSkinnedMesh&&Ci.skinning===!1||!Fe.isSkinnedMesh&&Ci.skinning===!0||Ci.envMap!==ti||Me.fog===!0&&Ci.fog!==xt||Ci.numClippingPlanes!==void 0&&(Ci.numClippingPlanes!==Ne.numPlanes||Ci.numIntersection!==Ne.numIntersection)||Ci.vertexAlphas!==Ei||Ci.vertexTangents!==ai||Ci.morphTargets!==ui||Ci.morphNormals!==dn||Ci.morphColors!==Ln||Ci.toneMapping!==ro||G.isWebGL2===!0&&Ci.morphTargetsCount!==Rn)&&(or=!0):(or=!0,Ci.__version=Me.version);let Tc=Ci.currentProgram;or===!0&&(Tc=no(Me,Ae,Fe));let wS=!1,ju=!1,ag=!1;const _r=Tc.getUniforms(),xc=Ci.uniforms;if(ue.useProgram(Tc.program)&&(wS=!0,ju=!0,ag=!0),Me.id!==M&&(M=Me.id,ju=!0),wS||x!==ce){if(_r.setValue(ae,"projectionMatrix",ce.projectionMatrix),G.logarithmicDepthBuffer&&_r.setValue(ae,"logDepthBufFC",2/(Math.log(ce.far+1)/Math.LN2)),x!==ce&&(x=ce,ju=!0,ag=!0),Me.isShaderMaterial||Me.isMeshPhongMaterial||Me.isMeshToonMaterial||Me.isMeshStandardMaterial||Me.envMap){const Ls=_r.map.cameraPosition;Ls!==void 0&&Ls.setValue(ae,Y.setFromMatrixPosition(ce.matrixWorld))}(Me.isMeshPhongMaterial||Me.isMeshToonMaterial||Me.isMeshLambertMaterial||Me.isMeshBasicMaterial||Me.isMeshStandardMaterial||Me.isShaderMaterial)&&_r.setValue(ae,"isOrthographic",ce.isOrthographicCamera===!0),(Me.isMeshPhongMaterial||Me.isMeshToonMaterial||Me.isMeshLambertMaterial||Me.isMeshBasicMaterial||Me.isMeshStandardMaterial||Me.isShaderMaterial||Me.isShadowMaterial||Fe.isSkinnedMesh)&&_r.setValue(ae,"viewMatrix",ce.matrixWorldInverse)}if(Fe.isSkinnedMesh){_r.setOptional(ae,Fe,"bindMatrix"),_r.setOptional(ae,Fe,"bindMatrixInverse");const Ls=Fe.skeleton;Ls&&(G.floatVertexTextures?(Ls.boneTexture===null&&Ls.computeBoneTexture(),_r.setValue(ae,"boneTexture",Ls.boneTexture,Oe),_r.setValue(ae,"boneTextureSize",Ls.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const lg=Re.morphAttributes;if((lg.position!==void 0||lg.normal!==void 0||lg.color!==void 0&&G.isWebGL2===!0)&&pt.update(Fe,Re,Tc),(ju||Ci.receiveShadow!==Fe.receiveShadow)&&(Ci.receiveShadow=Fe.receiveShadow,_r.setValue(ae,"receiveShadow",Fe.receiveShadow)),Me.isMeshGouraudMaterial&&Me.envMap!==null&&(xc.envMap.value=ti,xc.flipEnvMap.value=ti.isCubeTexture&&ti.isRenderTargetTexture===!1?-1:1),ju&&(_r.setValue(ae,"toneMappingExposure",_.toneMappingExposure),Ci.needsLights&&nw(xc,ag),xt&&Me.fog===!0&&ve.refreshFogUniforms(xc,xt),ve.refreshMaterialUniforms(xc,Me,K,Z,se),m0.upload(ae,Ci.uniformsList,xc,Oe)),Me.isShaderMaterial&&Me.uniformsNeedUpdate===!0&&(m0.upload(ae,Ci.uniformsList,xc,Oe),Me.uniformsNeedUpdate=!1),Me.isSpriteMaterial&&_r.setValue(ae,"center",Fe.center),_r.setValue(ae,"modelViewMatrix",Fe.modelViewMatrix),_r.setValue(ae,"normalMatrix",Fe.normalMatrix),_r.setValue(ae,"modelMatrix",Fe.matrixWorld),Me.isShaderMaterial||Me.isRawShaderMaterial){const Ls=Me.uniformsGroups;for(let cg=0,sw=Ls.length;cg<sw;cg++)if(G.isWebGL2){const TS=Ls[cg];St.update(TS,Tc),St.bind(TS,Tc)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Tc}function nw(ce,Ae){ce.ambientLightColor.needsUpdate=Ae,ce.lightProbe.needsUpdate=Ae,ce.directionalLights.needsUpdate=Ae,ce.directionalLightShadows.needsUpdate=Ae,ce.pointLights.needsUpdate=Ae,ce.pointLightShadows.needsUpdate=Ae,ce.spotLights.needsUpdate=Ae,ce.spotLightShadows.needsUpdate=Ae,ce.rectAreaLights.needsUpdate=Ae,ce.hemisphereLights.needsUpdate=Ae}function rw(ce){return ce.isMeshLambertMaterial||ce.isMeshToonMaterial||ce.isMeshPhongMaterial||ce.isMeshStandardMaterial||ce.isShadowMaterial||ce.isShaderMaterial&&ce.lights===!0}this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return C},this.setRenderTargetTextures=function(ce,Ae,Re){Ee.get(ce.texture).__webglTexture=Ae,Ee.get(ce.depthTexture).__webglTexture=Re;const Me=Ee.get(ce);Me.__hasExternalTextures=!0,Me.__hasExternalTextures&&(Me.__autoAllocateDepthBuffer=Re===void 0,Me.__autoAllocateDepthBuffer||I.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Me.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ce,Ae){const Re=Ee.get(ce);Re.__webglFramebuffer=Ae,Re.__useDefaultFramebuffer=Ae===void 0},this.setRenderTarget=function(ce,Ae=0,Re=0){C=ce,E=Ae,T=Re;let Me=!0,Fe=null,xt=!1,Wt=!1;if(ce){const ti=Ee.get(ce);ti.__useDefaultFramebuffer!==void 0?(ue.bindFramebuffer(ae.FRAMEBUFFER,null),Me=!1):ti.__webglFramebuffer===void 0?Oe.setupRenderTarget(ce):ti.__hasExternalTextures&&Oe.rebindTextures(ce,Ee.get(ce.texture).__webglTexture,Ee.get(ce.depthTexture).__webglTexture);const Ei=ce.texture;(Ei.isData3DTexture||Ei.isDataArrayTexture||Ei.isCompressedArrayTexture)&&(Wt=!0);const ai=Ee.get(ce).__webglFramebuffer;ce.isWebGLCubeRenderTarget?(Fe=ai[Ae],xt=!0):G.isWebGL2&&ce.samples>0&&Oe.useMultisampledRTT(ce)===!1?Fe=Ee.get(ce).__webglMultisampledFramebuffer:Fe=ai,V.copy(ce.viewport),N.copy(ce.scissor),D=ce.scissorTest}else V.copy(re).multiplyScalar(K).floor(),N.copy(ne).multiplyScalar(K).floor(),D=B;if(ue.bindFramebuffer(ae.FRAMEBUFFER,Fe)&&G.drawBuffers&&Me&&ue.drawBuffers(ce,Fe),ue.viewport(V),ue.scissor(N),ue.setScissorTest(D),xt){const ti=Ee.get(ce.texture);ae.framebufferTexture2D(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_CUBE_MAP_POSITIVE_X+Ae,ti.__webglTexture,Re)}else if(Wt){const ti=Ee.get(ce.texture),Ei=Ae||0;ae.framebufferTextureLayer(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ti.__webglTexture,Re||0,Ei)}M=-1},this.readRenderTargetPixels=function(ce,Ae,Re,Me,Fe,xt,Wt){if(!(ce&&ce.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Gt=Ee.get(ce).__webglFramebuffer;if(ce.isWebGLCubeRenderTarget&&Wt!==void 0&&(Gt=Gt[Wt]),Gt){ue.bindFramebuffer(ae.FRAMEBUFFER,Gt);try{const ti=ce.texture,Ei=ti.format,ai=ti.type;if(Ei!==al&&Je.convert(Ei)!==ae.getParameter(ae.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const ui=ai===Dv&&(I.has("EXT_color_buffer_half_float")||G.isWebGL2&&I.has("EXT_color_buffer_float"));if(ai!==bu&&Je.convert(ai)!==ae.getParameter(ae.IMPLEMENTATION_COLOR_READ_TYPE)&&!(ai===uu&&(G.isWebGL2||I.has("OES_texture_float")||I.has("WEBGL_color_buffer_float")))&&!ui){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ae>=0&&Ae<=ce.width-Me&&Re>=0&&Re<=ce.height-Fe&&ae.readPixels(Ae,Re,Me,Fe,Je.convert(Ei),Je.convert(ai),xt)}finally{const ti=C!==null?Ee.get(C).__webglFramebuffer:null;ue.bindFramebuffer(ae.FRAMEBUFFER,ti)}}},this.copyFramebufferToTexture=function(ce,Ae,Re=0){const Me=Math.pow(2,-Re),Fe=Math.floor(Ae.image.width*Me),xt=Math.floor(Ae.image.height*Me);Oe.setTexture2D(Ae,0),ae.copyTexSubImage2D(ae.TEXTURE_2D,Re,0,0,ce.x,ce.y,Fe,xt),ue.unbindTexture()},this.copyTextureToTexture=function(ce,Ae,Re,Me=0){const Fe=Ae.image.width,xt=Ae.image.height,Wt=Je.convert(Re.format),Gt=Je.convert(Re.type);Oe.setTexture2D(Re,0),ae.pixelStorei(ae.UNPACK_FLIP_Y_WEBGL,Re.flipY),ae.pixelStorei(ae.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Re.premultiplyAlpha),ae.pixelStorei(ae.UNPACK_ALIGNMENT,Re.unpackAlignment),Ae.isDataTexture?ae.texSubImage2D(ae.TEXTURE_2D,Me,ce.x,ce.y,Fe,xt,Wt,Gt,Ae.image.data):Ae.isCompressedTexture?ae.compressedTexSubImage2D(ae.TEXTURE_2D,Me,ce.x,ce.y,Ae.mipmaps[0].width,Ae.mipmaps[0].height,Wt,Ae.mipmaps[0].data):ae.texSubImage2D(ae.TEXTURE_2D,Me,ce.x,ce.y,Wt,Gt,Ae.image),Me===0&&Re.generateMipmaps&&ae.generateMipmap(ae.TEXTURE_2D),ue.unbindTexture()},this.copyTextureToTexture3D=function(ce,Ae,Re,Me,Fe=0){if(_.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const xt=ce.max.x-ce.min.x+1,Wt=ce.max.y-ce.min.y+1,Gt=ce.max.z-ce.min.z+1,ti=Je.convert(Me.format),Ei=Je.convert(Me.type);let ai;if(Me.isData3DTexture)Oe.setTexture3D(Me,0),ai=ae.TEXTURE_3D;else if(Me.isDataArrayTexture)Oe.setTexture2DArray(Me,0),ai=ae.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ae.pixelStorei(ae.UNPACK_FLIP_Y_WEBGL,Me.flipY),ae.pixelStorei(ae.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Me.premultiplyAlpha),ae.pixelStorei(ae.UNPACK_ALIGNMENT,Me.unpackAlignment);const ui=ae.getParameter(ae.UNPACK_ROW_LENGTH),dn=ae.getParameter(ae.UNPACK_IMAGE_HEIGHT),Ln=ae.getParameter(ae.UNPACK_SKIP_PIXELS),ro=ae.getParameter(ae.UNPACK_SKIP_ROWS),so=ae.getParameter(ae.UNPACK_SKIP_IMAGES),Rn=Re.isCompressedTexture?Re.mipmaps[0]:Re.image;ae.pixelStorei(ae.UNPACK_ROW_LENGTH,Rn.width),ae.pixelStorei(ae.UNPACK_IMAGE_HEIGHT,Rn.height),ae.pixelStorei(ae.UNPACK_SKIP_PIXELS,ce.min.x),ae.pixelStorei(ae.UNPACK_SKIP_ROWS,ce.min.y),ae.pixelStorei(ae.UNPACK_SKIP_IMAGES,ce.min.z),Re.isDataTexture||Re.isData3DTexture?ae.texSubImage3D(ai,Fe,Ae.x,Ae.y,Ae.z,xt,Wt,Gt,ti,Ei,Rn.data):Re.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ae.compressedTexSubImage3D(ai,Fe,Ae.x,Ae.y,Ae.z,xt,Wt,Gt,ti,Rn.data)):ae.texSubImage3D(ai,Fe,Ae.x,Ae.y,Ae.z,xt,Wt,Gt,ti,Ei,Rn),ae.pixelStorei(ae.UNPACK_ROW_LENGTH,ui),ae.pixelStorei(ae.UNPACK_IMAGE_HEIGHT,dn),ae.pixelStorei(ae.UNPACK_SKIP_PIXELS,Ln),ae.pixelStorei(ae.UNPACK_SKIP_ROWS,ro),ae.pixelStorei(ae.UNPACK_SKIP_IMAGES,so),Fe===0&&Me.generateMipmaps&&ae.generateMipmap(ai),ue.unbindTexture()},this.initTexture=function(ce){ce.isCubeTexture?Oe.setTextureCube(ce,0):ce.isData3DTexture?Oe.setTexture3D(ce,0):ce.isDataArrayTexture||ce.isCompressedArrayTexture?Oe.setTexture2DArray(ce,0):Oe.setTexture2D(ce,0),ue.unbindTexture()},this.resetState=function(){E=0,T=0,C=null,ue.reset(),Ge.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Gc}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===yi?Ad:q3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Ad?yi:fc}}class Yne extends m4{}Yne.prototype.isWebGL1Renderer=!0;class Zne extends _o{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class NM extends Du{constructor(e=1,i=32,n=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},i=Math.max(3,Math.floor(i)),n=Math.max(2,Math.floor(n));const l=Math.min(o+a,Math.PI);let c=0;const u=[],h=new k,d=new k,f=[],m=[],g=[],v=[];for(let p=0;p<=n;p++){const b=[],_=p/n;let P=0;p===0&&o===0?P=.5/i:p===n&&l===Math.PI&&(P=-.5/i);for(let E=0;E<=i;E++){const T=E/i;h.x=-e*Math.cos(r+T*s)*Math.sin(o+_*a),h.y=e*Math.cos(o+_*a),h.z=e*Math.sin(r+T*s)*Math.sin(o+_*a),m.push(h.x,h.y,h.z),d.copy(h).normalize(),g.push(d.x,d.y,d.z),v.push(T+P,1-_),b.push(c++)}u.push(b)}for(let p=0;p<n;p++)for(let b=0;b<i;b++){const _=u[p][b+1],P=u[p][b],E=u[p+1][b],T=u[p+1][b+1];(p!==0||o>0)&&f.push(_,P,T),(p!==n-1||l<Math.PI)&&f.push(P,E,T)}this.setIndex(f),this.setAttribute("position",new sc(m,3)),this.setAttribute("normal",new sc(g,3)),this.setAttribute("uv",new sc(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new NM(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Jne extends Hy{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new hn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=K3,this.normalScale=new Pi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const wD={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class Qne{constructor(e,i,n){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=n,this.itemStart=function(u){a++,s===!1&&r.onStart!==void 0&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,r.onProgress!==void 0&&r.onProgress(u,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){const h=c.indexOf(u);return h!==-1&&c.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=c.length;h<d;h+=2){const f=c[h],m=c[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return m}return null}}}const ere=new Qne;let p4=class{constructor(e){this.manager=e!==void 0?e:ere,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const n=this;return new Promise(function(r,s){n.load(e,r,i,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};class tre extends p4{constructor(e){super(e)}load(e,i,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=wD.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){i&&i(o),s.manager.itemEnd(e)},0),o;const a=Nv("img");function l(){u(),wD.add(e,this),i&&i(this),s.manager.itemEnd(e)}function c(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class ire extends p4{constructor(e){super(e)}load(e,i,n,r){const s=new Ec,o=new tre(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,i!==void 0&&i(s)},n,r),s}}class g4 extends _o{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new hn(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}const mT=new Pt,TD=new k,xD=new k;class nre{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Pi(512,512),this.map=null,this.mapPass=null,this.matrix=new Pt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new IM,this._frameExtents=new Pi(1,1),this._viewportCount=1,this._viewports=[new kn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,n=this.matrix;TD.setFromMatrixPosition(e.matrixWorld),i.position.copy(TD),xD.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(xD),i.updateMatrixWorld(),mT.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(mT),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(mT)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const kD=new Pt,vg=new k,pT=new k;class rre extends nre{constructor(){super(new ga(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Pi(4,2),this._viewportCount=6,this._viewports=[new kn(2,1,1,1),new kn(0,1,1,1),new kn(3,1,1,1),new kn(1,1,1,1),new kn(3,0,1,1),new kn(1,0,1,1)],this._cubeDirections=[new k(1,0,0),new k(-1,0,0),new k(0,0,1),new k(0,0,-1),new k(0,1,0),new k(0,-1,0)],this._cubeUps=[new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,0,1),new k(0,0,-1)]}updateMatrices(e,i=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),vg.setFromMatrixPosition(e.matrixWorld),n.position.copy(vg),pT.copy(n.position),pT.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(pT),n.updateMatrixWorld(),r.makeTranslation(-vg.x,-vg.y,-vg.z),kD.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(kD)}}class sre extends g4{constructor(e,i,n=0,r=2){super(e,i),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new rre}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class ore extends g4{constructor(e,i){super(e,i),this.isAmbientLight=!0,this.type="AmbientLight"}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:AM}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=AM);const Wi=class Wi{constructor(){y(this,"lastState")}static undo(){var i;if(Wi.commandHistory.length===0)return;const e=Wi.commandHistory.pop();console.log("undo last",e),e&&(Wi.redoHistory.push(e),e.restoreState()),(i=Wi.store)==null||i.updateDisplay(),$.fire("undo-enabled",{value:Wi.commandHistory.length>0}),$.fire("redo-enabled",{value:Wi.redoHistory.length>0})}static redo(){var i;if(Wi.redoHistory.length===0)return;const e=Wi.redoHistory.pop();e&&e.execute(!0),(i=Wi.store)==null||i.updateDisplay()}execute(e){Wi.commandHistory.push(this),this.saveState(),this.do(),Wi.redoHistory.length>0&&e===void 0&&Wi.redoHistory.splice(0),$.fire("undo-enabled",{value:Wi.commandHistory.length>0}),$.fire("redo-enabled",{value:Wi.redoHistory.length>0})}push(){Wi.commandHistory.push(this),this.saveState(),Wi.redoHistory.length>0&&Wi.redoHistory.splice(0),$.fire("undo-enabled",{value:Wi.commandHistory.length>0}),$.fire("redo-enabled",{value:Wi.redoHistory.length>0})}static dumpOpcode(){const e=Wi.commandHistory.map(i=>i.toOpcode()).filter(i=>i!==null);return JSON.stringify(e)}static setGlobalStore(e){Wi.store=e}static symbolToASCIIDec(e){return e===void 0?"":(e.match(/%61|%47|%38|%64/)&&console.error(`Save Command: Forbidden pattern %61, %47, %38, or %64 found in string ${e}`),e.replaceAll("@","%64").replaceAll("=","%61").replaceAll("/","%47").replaceAll("&","%38"))}static asciiDecToSymbol(e){return e.replaceAll("%38","&").replaceAll("%47","/").replaceAll("%61","=").replaceAll("%64","@")}};y(Wi,"store"),y(Wi,"tmpVector",new k),y(Wi,"tmpVector1",new k),y(Wi,"commandHistory",[]),y(Wi,"redoHistory",[]),y(Wi,"undoEnabled",()=>Wi.commandHistory.length>0),y(Wi,"redoEnabled",()=>Wi.redoHistory.length>0);let L=Wi;const rl=new Map;rl.set("undoAction",{id:0,action:"undoAction",displayedName:"buttons.UndoLastActionDisplayedName",icon:"mdi-undo",toolTipMessage:"buttons.UndoLastActionToolTipMessage",toolUseMessage:"buttons.UndoLastActionToolUseMessage",clickFunc:()=>{L.undo()}}).set("redoAction",{id:5,action:"redoAction",displayedName:"buttons.RedoLastActionDisplayedName",icon:"mdi-redo",toolTipMessage:"buttons.RedoLastActionToolTipMessage",toolUseMessage:"buttons.RedoLastActionToolUseMessage",clickFunc:()=>{L.redo()}}).set("resetAction",{id:10,action:"resetAction",displayedName:"buttons.ResetSphereActionDisplayedName",icon:"mdi-broom",toolTipMessage:"buttons.ResetSphereActionToolTipMessage",toolUseMessage:"buttons.ResetSphereActionToolUseMessage",clickFunc:()=>{$.fire("initiate-clear-construction",{})}});rl.set("select",{id:0,action:"select",displayedName:"buttons.SelectDisplayedName",toolGroup:"EditTools",toolTipMessage:"buttons.SelectToolTipMessage",toolUseMessage:"buttons.SelectToolUseMessage"}).set("delete",{id:5,action:"delete",displayedName:"buttons.DeleteDisplayedName",toolGroup:"EditTools",toolTipMessage:"buttons.DeleteToolTipMessage",toolUseMessage:"buttons.DeleteToolUseMessage"}).set("hide",{id:0,action:"hide",displayedName:"buttons.HideDisplayedName",toolGroup:"DisplayTools",toolTipMessage:"buttons.HideObjectToolTipMessage",toolUseMessage:"buttons.HideObjectToolUseMessage"}).set("toggleLabelDisplay",{id:5,action:"toggleLabelDisplay",displayedName:"buttons.ToggleLabelDisplayedName",toolGroup:"DisplayTools",toolTipMessage:"buttons.ToggleLabelToolTipMessage",toolUseMessage:"buttons.ToggleLabelToolUseMessage"}).set("move",{id:15,action:"move",displayedName:"buttons.MoveDisplayedName",toolGroup:"DisplayTools",toolTipMessage:"buttons.MoveObjectToolTipMessage",toolUseMessage:"buttons.MoveObjectToolUseMessage"}).set("rotate",{id:20,action:"rotate",displayedName:"buttons.RotateDisplayedName",toolGroup:"DisplayTools",toolTipMessage:"buttons.RotateSphereToolTipMessage",toolUseMessage:"buttons.RotateSphereToolUseMessage"}).set("zoomIn",{id:25,action:"zoomIn",displayedName:"buttons.PanZoomInDisplayedName",toolGroup:"DisplayTools",toolTipMessage:"buttons.PanZoomInToolTipMessage",toolUseMessage:"buttons.PanZoomInToolUseMessage"}).set("zoomOut",{id:30,action:"zoomOut",displayedName:"buttons.PanZoomOutDisplayedName",toolGroup:"DisplayTools",toolTipMessage:"buttons.PanZoomOutToolTipMessage",toolUseMessage:"buttons.PanZoomOutToolUseMessage"}).set("zoomFit",{id:35,action:"zoomFit",displayedName:"buttons.ZoomFitDisplayedName",toolGroup:"DisplayTools",toolTipMessage:"buttons.ZoomFitToolTipMessage",toolUseMessage:"buttons.ZoomFitToolUseMessage"}).set("point",{id:0,action:"point",displayedName:"buttons.CreatePointDisplayedName",toolGroup:"BasicTools",toolTipMessage:"buttons.CreatePointToolTipMessage",toolUseMessage:"buttons.CreatePointToolUseMessage"}).set("line",{id:5,action:"line",displayedName:"buttons.CreateLineDisplayedName",toolGroup:"BasicTools",toolTipMessage:"buttons.CreateLineToolTipMessage",toolUseMessage:"buttons.CreateLineToolUseMessage"}).set("segment",{id:10,action:"segment",displayedName:"buttons.CreateLineSegmentDisplayedName",toolGroup:"BasicTools",toolTipMessage:"buttons.CreateLineSegmentToolTipMessage",toolUseMessage:"buttons.CreateLineSegmentToolUseMessage"}).set("circle",{id:20,action:"circle",displayedName:"buttons.CreateCircleDisplayedName",toolGroup:"BasicTools",toolTipMessage:"buttons.CreateCircleToolTipMessage",toolUseMessage:"buttons.CreateCircleToolUseMessage"}).set("antipodalPoint",{id:0,action:"antipodalPoint",displayedName:"buttons.CreateAntipodalPointDisplayedName",toolGroup:"ConstructionTools",toolTipMessage:"buttons.CreateAntipodalPointToolTipMessage",toolUseMessage:"buttons.CreateAntipodalPointToolUseMessage"}).set("polar",{id:5,action:"polar",displayedName:"buttons.CreatePolarDisplayedName",toolGroup:"ConstructionTools",toolTipMessage:"buttons.CreatePolarToolTipMessage",toolUseMessage:"buttons.CreatePolarToolUseMessage"}).set("midpoint",{id:10,action:"midpoint",displayedName:"buttons.CreateMidpointDisplayedName",toolGroup:"ConstructionTools",toolTipMessage:"buttons.CreateMidpointToolTipMessage",toolUseMessage:"buttons.CreateMidpointToolUseMessage"}).set("angleBisector",{id:15,action:"angleBisector",displayedName:"buttons.CreateAngleBisectorDisplayedName",toolGroup:"ConstructionTools",toolTipMessage:"buttons.CreateAngleBisectorToolTipMessage",toolUseMessage:"buttons.CreateAngleBisectorToolUseMessage"}).set("tangent",{id:20,action:"tangent",displayedName:"buttons.CreateTangentDisplayedName",toolGroup:"ConstructionTools",toolTipMessage:"buttons.CreateTangentToolTipMessage",toolUseMessage:"buttons.CreateTangentToolUseMessage"}).set("perpendicular",{id:25,action:"perpendicular",displayedName:"buttons.CreatePerpendicularDisplayedName",toolGroup:"ConstructionTools",toolTipMessage:"buttons.CreatePerpendicularToolTipMessage",toolUseMessage:"buttons.CreatePerpendicularToolUseMessage"}).set("intersect",{id:30,action:"intersect",displayedName:"buttons.CreateIntersectionDisplayedName",toolGroup:"ConstructionTools",toolTipMessage:"buttons.CreateIntersectionToolTipMessage",toolUseMessage:"buttons.CreateIntersectionToolUseMessage"}).set("pointOnObject",{id:55,action:"pointOnObject",displayedName:"buttons.CreatePointOnOneDimDisplayedName",toolGroup:"ConstructionTools",toolTipMessage:"buttons.CreatePointOnOneDimToolTipMessage",toolUseMessage:"buttons.CreatePointOnOneDimToolUseMessage"}).set("angle",{id:0,action:"angle",displayedName:"buttons.CreateAngleDisplayedName",toolGroup:"MeasurementTools",toolTipMessage:"buttons.CreateAngleToolTipMessage",toolUseMessage:"buttons.CreateAngleToolUseMessage"}).set("pointDistance",{id:5,action:"pointDistance",displayedName:"buttons.CreatePointDistanceDisplayedName",toolGroup:"MeasurementTools",toolTipMessage:"buttons.CreatePointDistanceToolTipMessage",toolUseMessage:"buttons.CreatePointDistanceToolUseMessage"}).set("segmentLength",{id:10,action:"segmentLength",displayedName:"buttons.CreateSegmentLengthDisplayedName",toolGroup:"MeasurementTools",toolTipMessage:"buttons.CreateSegmentLengthToolTipMessage",toolUseMessage:"buttons.CreateSegmentLengthToolUseMessage"}).set("coordinate",{id:15,action:"coordinate",displayedName:"buttons.CreateCoordinateDisplayedName",toolGroup:"MeasurementTools",toolTipMessage:"buttons.CreateCoordinateToolTipMessage",toolUseMessage:"buttons.CreateCoordinateToolUseMessage"}).set("measureTriangle",{id:20,action:"measureTriangle",displayedName:"buttons.MeasureTriangleDisplayedName",toolGroup:"MeasurementTools",toolTipMessage:"buttons.MeasureTriangleToolTipMessage",toolUseMessage:"buttons.MeasureTriangleToolUseMessage"}).set("measurePolygon",{id:25,action:"measurePolygon",displayedName:"buttons.MeasurePolygonDisplayedName",toolGroup:"MeasurementTools",toolTipMessage:"buttons.MeasurePolygonToolTipMessage",toolUseMessage:"buttons.MeasurePolygonToolUseMessage"}).set("ellipse",{id:0,action:"ellipse",displayedName:"buttons.CreateEllipseDisplayedName",toolGroup:"ConicTools",toolTipMessage:"buttons.CreateEllipseToolTipMessage",toolUseMessage:"buttons.CreateEllipseToolUseMessage"}).set("threePointCircle",{id:0,action:"threePointCircle",displayedName:"buttons.CreateThreePointCircleDisplayedName",toolGroup:"AdvancedTools",toolTipMessage:"buttons.CreateThreePointCircleToolTipMessage",toolUseMessage:"buttons.CreateThreePointCircleToolUseMessage"}).set("nSectPoint",{id:10,action:"nSectPoint",displayedName:"buttons.CreateNSectSegmentDisplayedName",toolGroup:"AdvancedTools",toolTipMessage:"buttons.CreateNSectSegmentToolTipMessage",toolUseMessage:"buttons.CreateNSectSegmentToolUseMessage"}).set("nSectLine",{id:15,action:"nSectLine",displayedName:"buttons.CreateNSectAngleDisplayedName",toolGroup:"AdvancedTools",toolTipMessage:"buttons.CreateNSectAngleToolTipMessage",toolUseMessage:"buttons.CreateNSectAngleToolUseMessage"}).set("pointReflection",{id:0,action:"pointReflection",displayedName:"buttons.CreatePointReflectionDisplayedName",toolGroup:"TransformationTools",toolTipMessage:"buttons.CreatePointReflectionToolTipMessage",toolUseMessage:"buttons.CreatePointReflectionToolUseMessage"}).set("reflection",{id:5,action:"reflection",displayedName:"buttons.CreateReflectionDisplayedName",toolGroup:"TransformationTools",toolTipMessage:"buttons.CreateReflectionToolTipMessage",toolUseMessage:"buttons.CreateReflectionToolUseMessage"}).set("rotation",{id:10,action:"rotation",displayedName:"buttons.CreateRotationDisplayedName",toolGroup:"TransformationTools",toolTipMessage:"buttons.CreateRotationToolTipMessage",toolUseMessage:"buttons.CreateRotationToolUseMessage"}).set("translation",{id:15,action:"translation",displayedName:"buttons.CreateTranslationDisplayedName",toolGroup:"TransformationTools",toolTipMessage:"buttons.CreateTranslationToolTipMessage",toolUseMessage:"buttons.CreateTranslationToolUseMessage"}).set("inversion",{id:20,action:"inversion",displayedName:"buttons.CreateInversionDisplayedName",toolGroup:"TransformationTools",toolTipMessage:"buttons.CreateInversionToolTipMessage",toolUseMessage:"buttons.CreateInversionToolUseMessage"}).set("applyTransformation",{id:25,action:"applyTransformation",displayedName:"buttons.ApplyTransformationDisplayedName",toolGroup:"TransformationTools",toolTipMessage:"buttons.ApplyTransformationToolTipMessage",toolUseMessage:"buttons.ApplyTransformationToolUseMessage"}).set("measuredCircle",{id:15,action:"measuredCircle",displayedName:"buttons.CreateMeasuredCircleDisplayedName",toolGroup:"MeasuredObjectTools",toolTipMessage:"buttons.CreateMeasuredCircleToolTipMessage",toolUseMessage:"buttons.CreateMeasuredCircleToolUseMessage"});const are=[{group:"EditTools",tools:["select","delete"]},{group:"DisplayTools",tools:["hide","toggleLabelDisplay","move","rotate","zoomIn","zoomOut","zoomFit"]},{group:"BasicTools",tools:["point","line","segment","circle"]},{group:"ConstructionTools",tools:["antipodalPoint","polar","midpoint","angleBisector","tangent","perpendicular","intersect","pointOnObject"]},{group:"MeasurementTools",tools:["angle","pointDistance","segmentLength","coordinate","measureTriangle","measurePolygon"]},{group:"ConicTools",tools:["ellipse"]},{group:"AdvancedTools",tools:["threePointCircle","nSectPoint","nSectLine"]},{group:"TransformationTools",tools:["pointReflection","reflection","rotation","translation","inversion","applyTransformation"]},{group:"MeasuredObjectTools",tools:["measuredCircle"]}],p0=are.map(t=>({group:t.group,children:t.tools.map(e=>rl.get(e))}));function CD(t,e){let i=0;for(;i<e.length&&t>e[i];)i++;i==e.length?e.push(t):e.splice(i,0,t)}const gT=[[],[]],Eh=D3("acct",{state:()=>({loginEnabled:!1,temporaryProfilePicture:"",userDisplayedName:void 0,userEmail:void 0,userProfilePictureURL:void 0,userRole:void 0,includedTools:[],excludedTools:[],favoriteTools:gT,constructionDocId:null,constructionSaved:!1}),getters:{hasUnsavedWork(t){return!1}},actions:{resetToolset(t=!0){this.includedTools.splice(0),this.excludedTools.splice(0);const e=p0.flatMap(i=>i.children).map(i=>i.action);t?this.includedTools.push(...e):this.excludedTools.push(...e)},includeToolName(t){const e=this.excludedTools.findIndex(i=>i===t);e>=0&&(CD(t,this.includedTools),this.excludedTools.splice(e,1))},excludeToolName(t){const e=this.includedTools.findIndex(i=>i===t);e>=0&&(CD(t,this.excludedTools),this.includedTools.splice(e,1))},parseAndSetFavoriteTools(t){t.trim().length>0?(this.favoriteTools=t.split("#").map(e=>e.split(",").map(i=>i.trim())),this.favoriteTools.length!==2&&(this.favoriteTools=gT)):this.favoriteTools=gT}}});/*!
  * shared v9.9.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */const s_=typeof window<"u",Nu=(t,e=!1)=>e?Symbol.for(t):Symbol(t),Rv=t=>typeof t=="number"&&isFinite(t),MD=t=>ure(t)==="[object RegExp]",lre=t=>sl(t)&&Object.keys(t).length===0,oc=Object.assign;let AD;const g0=()=>AD||(AD=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),cre=Object.prototype.hasOwnProperty;function o_(t,e){return cre.call(t,e)}const qc=Array.isArray,hb=t=>typeof t=="function",cr=t=>typeof t=="string",Rc=t=>typeof t=="boolean",Ko=t=>t!==null&&typeof t=="object",hre=Object.prototype.toString,ure=t=>hre.call(t),sl=t=>{if(!Ko(t))return!1;const e=Object.getPrototypeOf(t);return e===null||e.constructor===Object};function v4(t){let e=t;return()=>++e}const ub=t=>!Ko(t)||qc(t);function v0(t,e){if(ub(t)||ub(e))throw new Error("Invalid value");const i=[{src:t,des:e}];for(;i.length;){const{src:n,des:r}=i.pop();Object.keys(n).forEach(s=>{ub(n[s])||ub(r[s])?r[s]=n[s]:i.push({src:n[s],des:r[s]})})}}/*!
  * shared v9.9.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */const dre=(t,e,i)=>fre({l:t,k:e,s:i}),fre=t=>JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),Wo=t=>typeof t=="number"&&isFinite(t),mre=t=>S4(t)==="[object Date]",VD=t=>S4(t)==="[object RegExp]",RM=t=>Cn(t)&&Object.keys(t).length===0,Bp=Object.assign;let LD;const vT=()=>LD||(LD=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ID(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const ac=Array.isArray,Br=t=>typeof t=="function",gi=t=>typeof t=="string",vo=t=>typeof t=="boolean",Gr=t=>t!==null&&typeof t=="object",pre=t=>Gr(t)&&Br(t.then)&&Br(t.catch),y4=Object.prototype.toString,S4=t=>y4.call(t),Cn=t=>{if(!Gr(t))return!1;const e=Object.getPrototypeOf(t);return e===null||e.constructor===Object},gre=t=>t==null?"":ac(t)||Cn(t)&&t.toString===y4?JSON.stringify(t,null,2):String(t);function vre(t,e=""){return t.reduce((i,n,r)=>r===0?i+n:i+e+n,"")}function yre(t){let e=t;return()=>++e}function Sre(t,e){typeof console<"u"&&(console.warn("[intlify] "+t),e&&console.warn(e.stack))}/*!
  * message-compiler v9.9.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */function bre(t,e,i){return{line:t,column:e,offset:i}}function Vk(t,e,i){const n={start:t,end:e};return i!=null&&(n.source=i),n}const _re=/\{([0-9a-zA-Z]+)\}/g;function Pre(t,...e){return e.length===1&&Ere(e[0])&&(e=e[0]),(!e||!e.hasOwnProperty)&&(e={}),t.replace(_re,(i,n)=>e.hasOwnProperty(n)?e[n]:"")}const b4=Object.assign,OD=t=>typeof t=="string",Ere=t=>t!==null&&typeof t=="object";function _4(t,e=""){return t.reduce((i,n,r)=>r===0?i+n:i+e+n,"")}const Xt={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14,UNHANDLED_CODEGEN_NODE_TYPE:15,UNHANDLED_MINIFIER_NODE_TYPE:16,__EXTEND_POINT__:17},wre={[Xt.EXPECTED_TOKEN]:"Expected token: '{0}'",[Xt.INVALID_TOKEN_IN_PLACEHOLDER]:"Invalid token in placeholder: '{0}'",[Xt.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER]:"Unterminated single quote in placeholder",[Xt.UNKNOWN_ESCAPE_SEQUENCE]:"Unknown escape sequence: \\{0}",[Xt.INVALID_UNICODE_ESCAPE_SEQUENCE]:"Invalid unicode escape sequence: {0}",[Xt.UNBALANCED_CLOSING_BRACE]:"Unbalanced closing brace",[Xt.UNTERMINATED_CLOSING_BRACE]:"Unterminated closing brace",[Xt.EMPTY_PLACEHOLDER]:"Empty placeholder",[Xt.NOT_ALLOW_NEST_PLACEHOLDER]:"Not allowed nest placeholder",[Xt.INVALID_LINKED_FORMAT]:"Invalid linked format",[Xt.MUST_HAVE_MESSAGES_IN_PLURAL]:"Plural must have messages",[Xt.UNEXPECTED_EMPTY_LINKED_MODIFIER]:"Unexpected empty linked modifier",[Xt.UNEXPECTED_EMPTY_LINKED_KEY]:"Unexpected empty linked key",[Xt.UNEXPECTED_LEXICAL_ANALYSIS]:"Unexpected lexical analysis in token: '{0}'",[Xt.UNHANDLED_CODEGEN_NODE_TYPE]:"unhandled codegen node type: '{0}'",[Xt.UNHANDLED_MINIFIER_NODE_TYPE]:"unhandled mimifier node type: '{0}'"};function jp(t,e,i={}){const{domain:n,messages:r,args:s}=i,o=Pre((r||wre)[t]||"",...s||[]),a=new SyntaxError(String(o));return a.code=t,e&&(a.location=e),a.domain=n,a}function Tre(t){throw t}const Ic=" ",xre="\r",$s=`
`,kre=String.fromCharCode(8232),Cre=String.fromCharCode(8233);function Mre(t){const e=t;let i=0,n=1,r=1,s=0;const o=C=>e[C]===xre&&e[C+1]===$s,a=C=>e[C]===$s,l=C=>e[C]===Cre,c=C=>e[C]===kre,u=C=>o(C)||a(C)||l(C)||c(C),h=()=>i,d=()=>n,f=()=>r,m=()=>s,g=C=>o(C)||l(C)||c(C)?$s:e[C],v=()=>g(i),p=()=>g(i+s);function b(){return s=0,u(i)&&(n++,r=0),o(i)&&i++,i++,r++,e[i]}function _(){return o(i+s)&&s++,s++,e[i+s]}function P(){i=0,n=1,r=1,s=0}function E(C=0){s=C}function T(){const C=i+s;for(;C!==i;)b();s=0}return{index:h,line:d,column:f,peekOffset:m,charAt:g,currentChar:v,currentPeek:p,next:b,peek:_,reset:P,resetPeek:E,skipToPeek:T}}const Vh=void 0,Are=".",DD="'",Vre="tokenizer";function Lre(t,e={}){const i=e.location!==!1,n=Mre(t),r=()=>n.index(),s=()=>bre(n.line(),n.column(),n.index()),o=s(),a=r(),l={currentType:14,offset:a,startLoc:o,endLoc:o,lastType:14,lastOffset:a,lastStartLoc:o,lastEndLoc:o,braceNest:0,inLinked:!1,text:""},c=()=>l,{onError:u}=e;function h(A,I,G,...ue){const Se=c();if(I.column+=G,I.offset+=G,u){const Ee=i?Vk(Se.startLoc,I):null,Oe=jp(A,Ee,{domain:Vre,args:ue});u(Oe)}}function d(A,I,G){A.endLoc=s(),A.currentType=I;const ue={type:I};return i&&(ue.loc=Vk(A.startLoc,A.endLoc)),G!=null&&(ue.value=G),ue}const f=A=>d(A,14);function m(A,I){return A.currentChar()===I?(A.next(),I):(h(Xt.EXPECTED_TOKEN,s(),0,I),"")}function g(A){let I="";for(;A.currentPeek()===Ic||A.currentPeek()===$s;)I+=A.currentPeek(),A.peek();return I}function v(A){const I=g(A);return A.skipToPeek(),I}function p(A){if(A===Vh)return!1;const I=A.charCodeAt(0);return I>=97&&I<=122||I>=65&&I<=90||I===95}function b(A){if(A===Vh)return!1;const I=A.charCodeAt(0);return I>=48&&I<=57}function _(A,I){const{currentType:G}=I;if(G!==2)return!1;g(A);const ue=p(A.currentPeek());return A.resetPeek(),ue}function P(A,I){const{currentType:G}=I;if(G!==2)return!1;g(A);const ue=A.currentPeek()==="-"?A.peek():A.currentPeek(),Se=b(ue);return A.resetPeek(),Se}function E(A,I){const{currentType:G}=I;if(G!==2)return!1;g(A);const ue=A.currentPeek()===DD;return A.resetPeek(),ue}function T(A,I){const{currentType:G}=I;if(G!==8)return!1;g(A);const ue=A.currentPeek()===".";return A.resetPeek(),ue}function C(A,I){const{currentType:G}=I;if(G!==9)return!1;g(A);const ue=p(A.currentPeek());return A.resetPeek(),ue}function M(A,I){const{currentType:G}=I;if(!(G===8||G===12))return!1;g(A);const ue=A.currentPeek()===":";return A.resetPeek(),ue}function x(A,I){const{currentType:G}=I;if(G!==10)return!1;const ue=()=>{const Ee=A.currentPeek();return Ee==="{"?p(A.peek()):Ee==="@"||Ee==="%"||Ee==="|"||Ee===":"||Ee==="."||Ee===Ic||!Ee?!1:Ee===$s?(A.peek(),ue()):p(Ee)},Se=ue();return A.resetPeek(),Se}function V(A){g(A);const I=A.currentPeek()==="|";return A.resetPeek(),I}function N(A){const I=g(A),G=A.currentPeek()==="%"&&A.peek()==="{";return A.resetPeek(),{isModulo:G,hasSpace:I.length>0}}function D(A,I=!0){const G=(Se=!1,Ee="",Oe=!1)=>{const ye=A.currentPeek();return ye==="{"?Ee==="%"?!1:Se:ye==="@"||!ye?Ee==="%"?!0:Se:ye==="%"?(A.peek(),G(Se,"%",!0)):ye==="|"?Ee==="%"||Oe?!0:!(Ee===Ic||Ee===$s):ye===Ic?(A.peek(),G(!0,Ic,Oe)):ye===$s?(A.peek(),G(!0,$s,Oe)):!0},ue=G();return I&&A.resetPeek(),ue}function O(A,I){const G=A.currentChar();return G===Vh?Vh:I(G)?(A.next(),G):null}function F(A){return O(A,G=>{const ue=G.charCodeAt(0);return ue>=97&&ue<=122||ue>=65&&ue<=90||ue>=48&&ue<=57||ue===95||ue===36})}function X(A){return O(A,G=>{const ue=G.charCodeAt(0);return ue>=48&&ue<=57})}function Z(A){return O(A,G=>{const ue=G.charCodeAt(0);return ue>=48&&ue<=57||ue>=65&&ue<=70||ue>=97&&ue<=102})}function K(A){let I="",G="";for(;I=X(A);)G+=I;return G}function z(A){v(A);const I=A.currentChar();return I!=="%"&&h(Xt.EXPECTED_TOKEN,s(),0,I),A.next(),"%"}function H(A){let I="";for(;;){const G=A.currentChar();if(G==="{"||G==="}"||G==="@"||G==="|"||!G)break;if(G==="%")if(D(A))I+=G,A.next();else break;else if(G===Ic||G===$s)if(D(A))I+=G,A.next();else{if(V(A))break;I+=G,A.next()}else I+=G,A.next()}return I}function re(A){v(A);let I="",G="";for(;I=F(A);)G+=I;return A.currentChar()===Vh&&h(Xt.UNTERMINATED_CLOSING_BRACE,s(),0),G}function ne(A){v(A);let I="";return A.currentChar()==="-"?(A.next(),I+=`-${K(A)}`):I+=K(A),A.currentChar()===Vh&&h(Xt.UNTERMINATED_CLOSING_BRACE,s(),0),I}function B(A){v(A),m(A,"'");let I="",G="";const ue=Ee=>Ee!==DD&&Ee!==$s;for(;I=O(A,ue);)I==="\\"?G+=Q(A):G+=I;const Se=A.currentChar();return Se===$s||Se===Vh?(h(Xt.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,s(),0),Se===$s&&(A.next(),m(A,"'")),G):(m(A,"'"),G)}function Q(A){const I=A.currentChar();switch(I){case"\\":case"'":return A.next(),`\\${I}`;case"u":return fe(A,I,4);case"U":return fe(A,I,6);default:return h(Xt.UNKNOWN_ESCAPE_SEQUENCE,s(),0,I),""}}function fe(A,I,G){m(A,I);let ue="";for(let Se=0;Se<G;Se++){const Ee=Z(A);if(!Ee){h(Xt.INVALID_UNICODE_ESCAPE_SEQUENCE,s(),0,`\\${I}${ue}${A.currentChar()}`);break}ue+=Ee}return`\\${I}${ue}`}function ie(A){v(A);let I="",G="";const ue=Se=>Se!=="{"&&Se!=="}"&&Se!==Ic&&Se!==$s;for(;I=O(A,ue);)G+=I;return G}function se(A){let I="",G="";for(;I=F(A);)G+=I;return G}function ee(A){const I=(G=!1,ue)=>{const Se=A.currentChar();return Se==="{"||Se==="%"||Se==="@"||Se==="|"||Se==="("||Se===")"||!Se||Se===Ic?ue:Se===$s||Se===Are?(ue+=Se,A.next(),I(G,ue)):(ue+=Se,A.next(),I(!0,ue))};return I(!1,"")}function de(A){v(A);const I=m(A,"|");return v(A),I}function Y(A,I){let G=null;switch(A.currentChar()){case"{":return I.braceNest>=1&&h(Xt.NOT_ALLOW_NEST_PLACEHOLDER,s(),0),A.next(),G=d(I,2,"{"),v(A),I.braceNest++,G;case"}":return I.braceNest>0&&I.currentType===2&&h(Xt.EMPTY_PLACEHOLDER,s(),0),A.next(),G=d(I,3,"}"),I.braceNest--,I.braceNest>0&&v(A),I.inLinked&&I.braceNest===0&&(I.inLinked=!1),G;case"@":return I.braceNest>0&&h(Xt.UNTERMINATED_CLOSING_BRACE,s(),0),G=te(A,I)||f(I),I.braceNest=0,G;default:let Se=!0,Ee=!0,Oe=!0;if(V(A))return I.braceNest>0&&h(Xt.UNTERMINATED_CLOSING_BRACE,s(),0),G=d(I,1,de(A)),I.braceNest=0,I.inLinked=!1,G;if(I.braceNest>0&&(I.currentType===5||I.currentType===6||I.currentType===7))return h(Xt.UNTERMINATED_CLOSING_BRACE,s(),0),I.braceNest=0,he(A,I);if(Se=_(A,I))return G=d(I,5,re(A)),v(A),G;if(Ee=P(A,I))return G=d(I,6,ne(A)),v(A),G;if(Oe=E(A,I))return G=d(I,7,B(A)),v(A),G;if(!Se&&!Ee&&!Oe)return G=d(I,13,ie(A)),h(Xt.INVALID_TOKEN_IN_PLACEHOLDER,s(),0,G.value),v(A),G;break}return G}function te(A,I){const{currentType:G}=I;let ue=null;const Se=A.currentChar();switch((G===8||G===9||G===12||G===10)&&(Se===$s||Se===Ic)&&h(Xt.INVALID_LINKED_FORMAT,s(),0),Se){case"@":return A.next(),ue=d(I,8,"@"),I.inLinked=!0,ue;case".":return v(A),A.next(),d(I,9,".");case":":return v(A),A.next(),d(I,10,":");default:return V(A)?(ue=d(I,1,de(A)),I.braceNest=0,I.inLinked=!1,ue):T(A,I)||M(A,I)?(v(A),te(A,I)):C(A,I)?(v(A),d(I,12,se(A))):x(A,I)?(v(A),Se==="{"?Y(A,I)||ue:d(I,11,ee(A))):(G===8&&h(Xt.INVALID_LINKED_FORMAT,s(),0),I.braceNest=0,I.inLinked=!1,he(A,I))}}function he(A,I){let G={type:14};if(I.braceNest>0)return Y(A,I)||f(I);if(I.inLinked)return te(A,I)||f(I);switch(A.currentChar()){case"{":return Y(A,I)||f(I);case"}":return h(Xt.UNBALANCED_CLOSING_BRACE,s(),0),A.next(),d(I,3,"}");case"@":return te(A,I)||f(I);default:if(V(A))return G=d(I,1,de(A)),I.braceNest=0,I.inLinked=!1,G;const{isModulo:Se,hasSpace:Ee}=N(A);if(Se)return Ee?d(I,0,H(A)):d(I,4,z(A));if(D(A))return d(I,0,H(A));break}return G}function ae(){const{currentType:A,offset:I,startLoc:G,endLoc:ue}=l;return l.lastType=A,l.lastOffset=I,l.lastStartLoc=G,l.lastEndLoc=ue,l.offset=r(),l.startLoc=s(),n.currentChar()===Vh?d(l,14):he(n,l)}return{nextToken:ae,currentOffset:r,currentPosition:s,context:c}}const Ire="parser",Ore=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function Dre(t,e,i){switch(t){case"\\\\":return"\\";case"\\'":return"'";default:{const n=parseInt(e||i,16);return n<=55295||n>=57344?String.fromCodePoint(n):""}}}function Nre(t={}){const e=t.location!==!1,{onError:i}=t;function n(p,b,_,P,...E){const T=p.currentPosition();if(T.offset+=P,T.column+=P,i){const C=e?Vk(_,T):null,M=jp(b,C,{domain:Ire,args:E});i(M)}}function r(p,b,_){const P={type:p};return e&&(P.start=b,P.end=b,P.loc={start:_,end:_}),P}function s(p,b,_,P){P&&(p.type=P),e&&(p.end=b,p.loc&&(p.loc.end=_))}function o(p,b){const _=p.context(),P=r(3,_.offset,_.startLoc);return P.value=b,s(P,p.currentOffset(),p.currentPosition()),P}function a(p,b){const _=p.context(),{lastOffset:P,lastStartLoc:E}=_,T=r(5,P,E);return T.index=parseInt(b,10),p.nextToken(),s(T,p.currentOffset(),p.currentPosition()),T}function l(p,b){const _=p.context(),{lastOffset:P,lastStartLoc:E}=_,T=r(4,P,E);return T.key=b,p.nextToken(),s(T,p.currentOffset(),p.currentPosition()),T}function c(p,b){const _=p.context(),{lastOffset:P,lastStartLoc:E}=_,T=r(9,P,E);return T.value=b.replace(Ore,Dre),p.nextToken(),s(T,p.currentOffset(),p.currentPosition()),T}function u(p){const b=p.nextToken(),_=p.context(),{lastOffset:P,lastStartLoc:E}=_,T=r(8,P,E);return b.type!==12?(n(p,Xt.UNEXPECTED_EMPTY_LINKED_MODIFIER,_.lastStartLoc,0),T.value="",s(T,P,E),{nextConsumeToken:b,node:T}):(b.value==null&&n(p,Xt.UNEXPECTED_LEXICAL_ANALYSIS,_.lastStartLoc,0,Ml(b)),T.value=b.value||"",s(T,p.currentOffset(),p.currentPosition()),{node:T})}function h(p,b){const _=p.context(),P=r(7,_.offset,_.startLoc);return P.value=b,s(P,p.currentOffset(),p.currentPosition()),P}function d(p){const b=p.context(),_=r(6,b.offset,b.startLoc);let P=p.nextToken();if(P.type===9){const E=u(p);_.modifier=E.node,P=E.nextConsumeToken||p.nextToken()}switch(P.type!==10&&n(p,Xt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ml(P)),P=p.nextToken(),P.type===2&&(P=p.nextToken()),P.type){case 11:P.value==null&&n(p,Xt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ml(P)),_.key=h(p,P.value||"");break;case 5:P.value==null&&n(p,Xt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ml(P)),_.key=l(p,P.value||"");break;case 6:P.value==null&&n(p,Xt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ml(P)),_.key=a(p,P.value||"");break;case 7:P.value==null&&n(p,Xt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ml(P)),_.key=c(p,P.value||"");break;default:n(p,Xt.UNEXPECTED_EMPTY_LINKED_KEY,b.lastStartLoc,0);const E=p.context(),T=r(7,E.offset,E.startLoc);return T.value="",s(T,E.offset,E.startLoc),_.key=T,s(_,E.offset,E.startLoc),{nextConsumeToken:P,node:_}}return s(_,p.currentOffset(),p.currentPosition()),{node:_}}function f(p){const b=p.context(),_=b.currentType===1?p.currentOffset():b.offset,P=b.currentType===1?b.endLoc:b.startLoc,E=r(2,_,P);E.items=[];let T=null;do{const x=T||p.nextToken();switch(T=null,x.type){case 0:x.value==null&&n(p,Xt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ml(x)),E.items.push(o(p,x.value||""));break;case 6:x.value==null&&n(p,Xt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ml(x)),E.items.push(a(p,x.value||""));break;case 5:x.value==null&&n(p,Xt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ml(x)),E.items.push(l(p,x.value||""));break;case 7:x.value==null&&n(p,Xt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ml(x)),E.items.push(c(p,x.value||""));break;case 8:const V=d(p);E.items.push(V.node),T=V.nextConsumeToken||null;break}}while(b.currentType!==14&&b.currentType!==1);const C=b.currentType===1?b.lastOffset:p.currentOffset(),M=b.currentType===1?b.lastEndLoc:p.currentPosition();return s(E,C,M),E}function m(p,b,_,P){const E=p.context();let T=P.items.length===0;const C=r(1,b,_);C.cases=[],C.cases.push(P);do{const M=f(p);T||(T=M.items.length===0),C.cases.push(M)}while(E.currentType!==14);return T&&n(p,Xt.MUST_HAVE_MESSAGES_IN_PLURAL,_,0),s(C,p.currentOffset(),p.currentPosition()),C}function g(p){const b=p.context(),{offset:_,startLoc:P}=b,E=f(p);return b.currentType===14?E:m(p,_,P,E)}function v(p){const b=Lre(p,b4({},t)),_=b.context(),P=r(0,_.offset,_.startLoc);return e&&P.loc&&(P.loc.source=p),P.body=g(b),t.onCacheKey&&(P.cacheKey=t.onCacheKey(p)),_.currentType!==14&&n(b,Xt.UNEXPECTED_LEXICAL_ANALYSIS,_.lastStartLoc,0,p[_.offset]||""),s(P,b.currentOffset(),b.currentPosition()),P}return{parse:v}}function Ml(t){if(t.type===14)return"EOF";const e=(t.value||"").replace(/\r?\n/gu,"\\n");return e.length>10?e.slice(0,9)+"":e}function Rre(t,e={}){const i={ast:t,helpers:new Set};return{context:()=>i,helper:s=>(i.helpers.add(s),s)}}function ND(t,e){for(let i=0;i<t.length;i++)FM(t[i],e)}function FM(t,e){switch(t.type){case 1:ND(t.cases,e),e.helper("plural");break;case 2:ND(t.items,e);break;case 6:FM(t.key,e),e.helper("linked"),e.helper("type");break;case 5:e.helper("interpolate"),e.helper("list");break;case 4:e.helper("interpolate"),e.helper("named");break}}function Fre(t,e={}){const i=Rre(t);i.helper("normalize"),t.body&&FM(t.body,i);const n=i.context();t.helpers=Array.from(n.helpers)}function zre(t){const e=t.body;return e.type===2?RD(e):e.cases.forEach(i=>RD(i)),t}function RD(t){if(t.items.length===1){const e=t.items[0];(e.type===3||e.type===9)&&(t.static=e.value,delete e.value)}else{const e=[];for(let i=0;i<t.items.length;i++){const n=t.items[i];if(!(n.type===3||n.type===9)||n.value==null)break;e.push(n.value)}if(e.length===t.items.length){t.static=_4(e);for(let i=0;i<t.items.length;i++){const n=t.items[i];(n.type===3||n.type===9)&&delete n.value}}}}const Ure="minifier";function sm(t){switch(t.t=t.type,t.type){case 0:const e=t;sm(e.body),e.b=e.body,delete e.body;break;case 1:const i=t,n=i.cases;for(let u=0;u<n.length;u++)sm(n[u]);i.c=n,delete i.cases;break;case 2:const r=t,s=r.items;for(let u=0;u<s.length;u++)sm(s[u]);r.i=s,delete r.items,r.static&&(r.s=r.static,delete r.static);break;case 3:case 9:case 8:case 7:const o=t;o.value&&(o.v=o.value,delete o.value);break;case 6:const a=t;sm(a.key),a.k=a.key,delete a.key,a.modifier&&(sm(a.modifier),a.m=a.modifier,delete a.modifier);break;case 5:const l=t;l.i=l.index,delete l.index;break;case 4:const c=t;c.k=c.key,delete c.key;break;default:throw jp(Xt.UNHANDLED_MINIFIER_NODE_TYPE,null,{domain:Ure,args:[t.type]})}delete t.type}const Bre="parser";function jre(t,e){const{sourceMap:i,filename:n,breakLineCode:r,needIndent:s}=e,o=e.location!==!1,a={filename:n,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:r,needIndent:s,indentLevel:0};o&&t.loc&&(a.source=t.loc.source);const l=()=>a;function c(v,p){a.code+=v}function u(v,p=!0){const b=p?r:"";c(s?b+"  ".repeat(v):b)}function h(v=!0){const p=++a.indentLevel;v&&u(p)}function d(v=!0){const p=--a.indentLevel;v&&u(p)}function f(){u(a.indentLevel)}return{context:l,push:c,indent:h,deindent:d,newline:f,helper:v=>`_${v}`,needIndent:()=>a.needIndent}}function $re(t,e){const{helper:i}=t;t.push(`${i("linked")}(`),ip(t,e.key),e.modifier?(t.push(", "),ip(t,e.modifier),t.push(", _type")):t.push(", undefined, _type"),t.push(")")}function Wre(t,e){const{helper:i,needIndent:n}=t;t.push(`${i("normalize")}([`),t.indent(n());const r=e.items.length;for(let s=0;s<r&&(ip(t,e.items[s]),s!==r-1);s++)t.push(", ");t.deindent(n()),t.push("])")}function Gre(t,e){const{helper:i,needIndent:n}=t;if(e.cases.length>1){t.push(`${i("plural")}([`),t.indent(n());const r=e.cases.length;for(let s=0;s<r&&(ip(t,e.cases[s]),s!==r-1);s++)t.push(", ");t.deindent(n()),t.push("])")}}function Hre(t,e){e.body?ip(t,e.body):t.push("null")}function ip(t,e){const{helper:i}=t;switch(e.type){case 0:Hre(t,e);break;case 1:Gre(t,e);break;case 2:Wre(t,e);break;case 6:$re(t,e);break;case 8:t.push(JSON.stringify(e.value),e);break;case 7:t.push(JSON.stringify(e.value),e);break;case 5:t.push(`${i("interpolate")}(${i("list")}(${e.index}))`,e);break;case 4:t.push(`${i("interpolate")}(${i("named")}(${JSON.stringify(e.key)}))`,e);break;case 9:t.push(JSON.stringify(e.value),e);break;case 3:t.push(JSON.stringify(e.value),e);break;default:throw jp(Xt.UNHANDLED_CODEGEN_NODE_TYPE,null,{domain:Bre,args:[e.type]})}}const qre=(t,e={})=>{const i=OD(e.mode)?e.mode:"normal",n=OD(e.filename)?e.filename:"message.intl",r=!!e.sourceMap,s=e.breakLineCode!=null?e.breakLineCode:i==="arrow"?";":`
`,o=e.needIndent?e.needIndent:i!=="arrow",a=t.helpers||[],l=jre(t,{mode:i,filename:n,sourceMap:r,breakLineCode:s,needIndent:o});l.push(i==="normal"?"function __msg__ (ctx) {":"(ctx) => {"),l.indent(o),a.length>0&&(l.push(`const { ${_4(a.map(h=>`${h}: _${h}`),", ")} } = ctx`),l.newline()),l.push("return "),ip(l,t),l.deindent(o),l.push("}"),delete t.helpers;const{code:c,map:u}=l.context();return{ast:t,code:c,map:u?u.toJSON():void 0}};function Kre(t,e={}){const i=b4({},e),n=!!i.jit,r=!!i.minify,s=i.optimize==null?!0:i.optimize,a=Nre(i).parse(t);return n?(s&&zre(a),r&&sm(a),{ast:a,code:""}):(Fre(a,i),qre(a,i))}/*!
  * core-base v9.9.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */function Xre(){typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(vT().__INTLIFY_PROD_DEVTOOLS__=!1),typeof __INTLIFY_JIT_COMPILATION__!="boolean"&&(vT().__INTLIFY_JIT_COMPILATION__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(vT().__INTLIFY_DROP_MESSAGE_COMPILER__=!1)}const Ru=[];Ru[0]={w:[0],i:[3,0],"[":[4],o:[7]};Ru[1]={w:[1],".":[2],"[":[4],o:[7]};Ru[2]={w:[2],i:[3,0],0:[3,0]};Ru[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]};Ru[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]};Ru[5]={"'":[4,0],o:8,l:[5,0]};Ru[6]={'"':[4,0],o:8,l:[6,0]};const Yre=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function Zre(t){return Yre.test(t)}function Jre(t){const e=t.charCodeAt(0),i=t.charCodeAt(t.length-1);return e===i&&(e===34||e===39)?t.slice(1,-1):t}function Qre(t){if(t==null)return"o";switch(t.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return t;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function ese(t){const e=t.trim();return t.charAt(0)==="0"&&isNaN(parseInt(t))?!1:Zre(e)?Jre(e):"*"+e}function tse(t){const e=[];let i=-1,n=0,r=0,s,o,a,l,c,u,h;const d=[];d[0]=()=>{o===void 0?o=a:o+=a},d[1]=()=>{o!==void 0&&(e.push(o),o=void 0)},d[2]=()=>{d[0](),r++},d[3]=()=>{if(r>0)r--,n=4,d[0]();else{if(r=0,o===void 0||(o=ese(o),o===!1))return!1;d[1]()}};function f(){const m=t[i+1];if(n===5&&m==="'"||n===6&&m==='"')return i++,a="\\"+m,d[0](),!0}for(;n!==null;)if(i++,s=t[i],!(s==="\\"&&f())){if(l=Qre(s),h=Ru[n],c=h[l]||h.l||8,c===8||(n=c[0],c[1]!==void 0&&(u=d[c[1]],u&&(a=s,u()===!1))))return;if(n===7)return e}}const FD=new Map;function ise(t,e){return Gr(t)?t[e]:null}function nse(t,e){if(!Gr(t))return null;let i=FD.get(e);if(i||(i=tse(e),i&&FD.set(e,i)),!i)return null;const n=i.length;let r=t,s=0;for(;s<n;){const o=r[i[s]];if(o===void 0||Br(r))return null;r=o,s++}return r}const rse=t=>t,sse=t=>"",ose="text",ase=t=>t.length===0?"":vre(t),lse=gre;function zD(t,e){return t=Math.abs(t),e===2?t?t>1?1:0:1:t?Math.min(t,2):0}function cse(t){const e=Wo(t.pluralIndex)?t.pluralIndex:-1;return t.named&&(Wo(t.named.count)||Wo(t.named.n))?Wo(t.named.count)?t.named.count:Wo(t.named.n)?t.named.n:e:e}function hse(t,e){e.count||(e.count=t),e.n||(e.n=t)}function use(t={}){const e=t.locale,i=cse(t),n=Gr(t.pluralRules)&&gi(e)&&Br(t.pluralRules[e])?t.pluralRules[e]:zD,r=Gr(t.pluralRules)&&gi(e)&&Br(t.pluralRules[e])?zD:void 0,s=p=>p[n(i,p.length,r)],o=t.list||[],a=p=>o[p],l=t.named||{};Wo(t.pluralIndex)&&hse(i,l);const c=p=>l[p];function u(p){const b=Br(t.messages)?t.messages(p):Gr(t.messages)?t.messages[p]:!1;return b||(t.parent?t.parent.message(p):sse)}const h=p=>t.modifiers?t.modifiers[p]:rse,d=Cn(t.processor)&&Br(t.processor.normalize)?t.processor.normalize:ase,f=Cn(t.processor)&&Br(t.processor.interpolate)?t.processor.interpolate:lse,m=Cn(t.processor)&&gi(t.processor.type)?t.processor.type:ose,v={list:a,named:c,plural:s,linked:(p,...b)=>{const[_,P]=b;let E="text",T="";b.length===1?Gr(_)?(T=_.modifier||T,E=_.type||E):gi(_)&&(T=_||T):b.length===2&&(gi(_)&&(T=_||T),gi(P)&&(E=P||E));const C=u(p)(v),M=E==="vnode"&&ac(C)&&T?C[0]:C;return T?h(T)(M,E):M},message:u,type:m,interpolate:f,normalize:d,values:Bp({},o,l)};return v}let Fv=null;function dse(t){Fv=t}function fse(t,e,i){Fv&&Fv.emit("i18n:init",{timestamp:Date.now(),i18n:t,version:e,meta:i})}const mse=pse("function:translate");function pse(t){return e=>Fv&&Fv.emit(t,e)}const gse={NOT_FOUND_KEY:1,FALLBACK_TO_TRANSLATE:2,CANNOT_FORMAT_NUMBER:3,FALLBACK_TO_NUMBER_FORMAT:4,CANNOT_FORMAT_DATE:5,FALLBACK_TO_DATE_FORMAT:6,EXPERIMENTAL_CUSTOM_MESSAGE_COMPILER:7,__EXTEND_POINT__:8},P4=Xt.__EXTEND_POINT__,ed=yre(P4),Hl={INVALID_ARGUMENT:P4,INVALID_DATE_ARGUMENT:ed(),INVALID_ISO_DATE_ARGUMENT:ed(),NOT_SUPPORT_NON_STRING_MESSAGE:ed(),NOT_SUPPORT_LOCALE_PROMISE_VALUE:ed(),NOT_SUPPORT_LOCALE_ASYNC_FUNCTION:ed(),NOT_SUPPORT_LOCALE_TYPE:ed(),__EXTEND_POINT__:ed()};function Kc(t){return jp(t,null,void 0)}function zM(t,e){return e.locale!=null?UD(e.locale):UD(t.locale)}let yT;function UD(t){if(gi(t))return t;if(Br(t)){if(t.resolvedOnce&&yT!=null)return yT;if(t.constructor.name==="Function"){const e=t();if(pre(e))throw Kc(Hl.NOT_SUPPORT_LOCALE_PROMISE_VALUE);return yT=e}else throw Kc(Hl.NOT_SUPPORT_LOCALE_ASYNC_FUNCTION)}else throw Kc(Hl.NOT_SUPPORT_LOCALE_TYPE)}function vse(t,e,i){return[...new Set([i,...ac(e)?e:Gr(e)?Object.keys(e):gi(e)?[e]:[i]])]}function E4(t,e,i){const n=gi(i)?i:a_,r=t;r.__localeChainCache||(r.__localeChainCache=new Map);let s=r.__localeChainCache.get(n);if(!s){s=[];let o=[i];for(;ac(o);)o=BD(s,o,e);const a=ac(e)||!Cn(e)?e:e.default?e.default:null;o=gi(a)?[a]:a,ac(o)&&BD(s,o,!1),r.__localeChainCache.set(n,s)}return s}function BD(t,e,i){let n=!0;for(let r=0;r<e.length&&vo(n);r++){const s=e[r];gi(s)&&(n=yse(t,e[r],i))}return n}function yse(t,e,i){let n;const r=e.split("-");do{const s=r.join("-");n=Sse(t,s,i),r.splice(-1,1)}while(r.length&&n===!0);return n}function Sse(t,e,i){let n=!1;if(!t.includes(e)&&(n=!0,e)){n=e[e.length-1]!=="!";const r=e.replace(/!/g,"");t.push(r),(ac(i)||Cn(i))&&i[r]&&(n=i[r])}return n}const bse="9.9.1",CP=-1,a_="en-US",jD="",$D=t=>`${t.charAt(0).toLocaleUpperCase()}${t.substr(1)}`;function _se(){return{upper:(t,e)=>e==="text"&&gi(t)?t.toUpperCase():e==="vnode"&&Gr(t)&&"__v_isVNode"in t?t.children.toUpperCase():t,lower:(t,e)=>e==="text"&&gi(t)?t.toLowerCase():e==="vnode"&&Gr(t)&&"__v_isVNode"in t?t.children.toLowerCase():t,capitalize:(t,e)=>e==="text"&&gi(t)?$D(t):e==="vnode"&&Gr(t)&&"__v_isVNode"in t?$D(t.children):t}}let w4;function Pse(t){w4=t}let T4;function Ese(t){T4=t}let x4;function wse(t){x4=t}let k4=null;const Tse=t=>{k4=t},xse=()=>k4;let C4=null;const WD=t=>{C4=t},kse=()=>C4;let GD=0;function Cse(t={}){const e=Br(t.onWarn)?t.onWarn:Sre,i=gi(t.version)?t.version:bse,n=gi(t.locale)||Br(t.locale)?t.locale:a_,r=Br(n)?a_:n,s=ac(t.fallbackLocale)||Cn(t.fallbackLocale)||gi(t.fallbackLocale)||t.fallbackLocale===!1?t.fallbackLocale:r,o=Cn(t.messages)?t.messages:{[r]:{}},a=Cn(t.datetimeFormats)?t.datetimeFormats:{[r]:{}},l=Cn(t.numberFormats)?t.numberFormats:{[r]:{}},c=Bp({},t.modifiers||{},_se()),u=t.pluralRules||{},h=Br(t.missing)?t.missing:null,d=vo(t.missingWarn)||VD(t.missingWarn)?t.missingWarn:!0,f=vo(t.fallbackWarn)||VD(t.fallbackWarn)?t.fallbackWarn:!0,m=!!t.fallbackFormat,g=!!t.unresolving,v=Br(t.postTranslation)?t.postTranslation:null,p=Cn(t.processor)?t.processor:null,b=vo(t.warnHtmlMessage)?t.warnHtmlMessage:!0,_=!!t.escapeParameter,P=Br(t.messageCompiler)?t.messageCompiler:w4,E=Br(t.messageResolver)?t.messageResolver:T4||ise,T=Br(t.localeFallbacker)?t.localeFallbacker:x4||vse,C=Gr(t.fallbackContext)?t.fallbackContext:void 0,M=t,x=Gr(M.__datetimeFormatters)?M.__datetimeFormatters:new Map,V=Gr(M.__numberFormatters)?M.__numberFormatters:new Map,N=Gr(M.__meta)?M.__meta:{};GD++;const D={version:i,cid:GD,locale:n,fallbackLocale:s,messages:o,modifiers:c,pluralRules:u,missing:h,missingWarn:d,fallbackWarn:f,fallbackFormat:m,unresolving:g,postTranslation:v,processor:p,warnHtmlMessage:b,escapeParameter:_,messageCompiler:P,messageResolver:E,localeFallbacker:T,fallbackContext:C,onWarn:e,__meta:N};return D.datetimeFormats=a,D.numberFormats=l,D.__datetimeFormatters=x,D.__numberFormatters=V,__INTLIFY_PROD_DEVTOOLS__&&fse(D,i,N),D}function UM(t,e,i,n,r){const{missing:s,onWarn:o}=t;if(s!==null){const a=s(t,i,e,r);return gi(a)?a:e}else return e}function yg(t,e,i){const n=t;n.__localeChainCache=new Map,t.localeFallbacker(t,i,e)}function ST(t){return i=>Mse(i,t)}function Mse(t,e){const i=e.b||e.body;if((i.t||i.type)===1){const n=i,r=n.c||n.cases;return t.plural(r.reduce((s,o)=>[...s,HD(t,o)],[]))}else return HD(t,i)}function HD(t,e){const i=e.s||e.static;if(i)return t.type==="text"?i:t.normalize([i]);{const n=(e.i||e.items).reduce((r,s)=>[...r,Lk(t,s)],[]);return t.normalize(n)}}function Lk(t,e){const i=e.t||e.type;switch(i){case 3:const n=e;return n.v||n.value;case 9:const r=e;return r.v||r.value;case 4:const s=e;return t.interpolate(t.named(s.k||s.key));case 5:const o=e;return t.interpolate(t.list(o.i!=null?o.i:o.index));case 6:const a=e,l=a.m||a.modifier;return t.linked(Lk(t,a.k||a.key),l?Lk(t,l):void 0,t.type);case 7:const c=e;return c.v||c.value;case 8:const u=e;return u.v||u.value;default:throw new Error(`unhandled node type on format message part: ${i}`)}}const Ase=t=>t;let db=Object.create(null);const np=t=>Gr(t)&&(t.t===0||t.type===0)&&("b"in t||"body"in t);function Vse(t,e={}){let i=!1;const n=e.onError||Tre;return e.onError=r=>{i=!0,n(r)},{...Kre(t,e),detectError:i}}function Lse(t,e){if(__INTLIFY_JIT_COMPILATION__&&!__INTLIFY_DROP_MESSAGE_COMPILER__&&gi(t)){vo(e.warnHtmlMessage)&&e.warnHtmlMessage;const n=(e.onCacheKey||Ase)(t),r=db[n];if(r)return r;const{ast:s,detectError:o}=Vse(t,{...e,location:!1,jit:!0}),a=ST(s);return o?a:db[n]=a}else{const i=t.cacheKey;if(i){const n=db[i];return n||(db[i]=ST(t))}else return ST(t)}}const qD=()=>"",va=t=>Br(t);function KD(t,...e){const{fallbackFormat:i,postTranslation:n,unresolving:r,messageCompiler:s,fallbackLocale:o,messages:a}=t,[l,c]=Ik(...e),u=vo(c.missingWarn)?c.missingWarn:t.missingWarn,h=vo(c.fallbackWarn)?c.fallbackWarn:t.fallbackWarn,d=vo(c.escapeParameter)?c.escapeParameter:t.escapeParameter,f=!!c.resolvedMessage,m=gi(c.default)||vo(c.default)?vo(c.default)?s?l:()=>l:c.default:i?s?l:()=>l:"",g=i||m!=="",v=zM(t,c);d&&Ise(c);let[p,b,_]=f?[l,v,a[v]||{}]:M4(t,l,v,o,h,u),P=p,E=l;if(!f&&!(gi(P)||np(P)||va(P))&&g&&(P=m,E=P),!f&&(!(gi(P)||np(P)||va(P))||!gi(b)))return r?CP:l;let T=!1;const C=()=>{T=!0},M=va(P)?P:A4(t,l,b,P,E,C);if(T)return P;const x=Nse(t,b,_,c),V=use(x),N=Ose(t,M,V),D=n?n(N,l):N;if(__INTLIFY_PROD_DEVTOOLS__){const O={timestamp:Date.now(),key:gi(l)?l:va(P)?P.key:"",locale:b||(va(P)?P.locale:""),format:gi(P)?P:va(P)?P.source:"",message:D};O.meta=Bp({},t.__meta,xse()||{}),mse(O)}return D}function Ise(t){ac(t.list)?t.list=t.list.map(e=>gi(e)?ID(e):e):Gr(t.named)&&Object.keys(t.named).forEach(e=>{gi(t.named[e])&&(t.named[e]=ID(t.named[e]))})}function M4(t,e,i,n,r,s){const{messages:o,onWarn:a,messageResolver:l,localeFallbacker:c}=t,u=c(t,n,i);let h={},d,f=null;const m="translate";for(let g=0;g<u.length&&(d=u[g],h=o[d]||{},(f=l(h,e))===null&&(f=h[e]),!(gi(f)||np(f)||va(f)));g++){const v=UM(t,e,d,s,m);v!==e&&(f=v)}return[f,d,h]}function A4(t,e,i,n,r,s){const{messageCompiler:o,warnHtmlMessage:a}=t;if(va(n)){const c=n;return c.locale=c.locale||i,c.key=c.key||e,c}if(o==null){const c=()=>n;return c.locale=i,c.key=e,c}const l=o(n,Dse(t,i,r,n,a,s));return l.locale=i,l.key=e,l.source=n,l}function Ose(t,e,i){return e(i)}function Ik(...t){const[e,i,n]=t,r={};if(!gi(e)&&!Wo(e)&&!va(e)&&!np(e))throw Kc(Hl.INVALID_ARGUMENT);const s=Wo(e)?String(e):(va(e),e);return Wo(i)?r.plural=i:gi(i)?r.default=i:Cn(i)&&!RM(i)?r.named=i:ac(i)&&(r.list=i),Wo(n)?r.plural=n:gi(n)?r.default=n:Cn(n)&&Bp(r,n),[s,r]}function Dse(t,e,i,n,r,s){return{locale:e,key:i,warnHtmlMessage:r,onError:o=>{throw s&&s(o),o},onCacheKey:o=>dre(e,i,o)}}function Nse(t,e,i,n){const{modifiers:r,pluralRules:s,messageResolver:o,fallbackLocale:a,fallbackWarn:l,missingWarn:c,fallbackContext:u}=t,d={locale:e,modifiers:r,pluralRules:s,messages:f=>{let m=o(i,f);if(m==null&&u){const[,,g]=M4(u,f,e,a,l,c);m=o(g,f)}if(gi(m)||np(m)){let g=!1;const p=A4(t,f,e,m,f,()=>{g=!0});return g?qD:p}else return va(m)?m:qD}};return t.processor&&(d.processor=t.processor),n.list&&(d.list=n.list),n.named&&(d.named=n.named),Wo(n.plural)&&(d.pluralIndex=n.plural),d}function XD(t,...e){const{datetimeFormats:i,unresolving:n,fallbackLocale:r,onWarn:s,localeFallbacker:o}=t,{__datetimeFormatters:a}=t,[l,c,u,h]=Ok(...e),d=vo(u.missingWarn)?u.missingWarn:t.missingWarn;vo(u.fallbackWarn)?u.fallbackWarn:t.fallbackWarn;const f=!!u.part,m=zM(t,u),g=o(t,r,m);if(!gi(l)||l==="")return new Intl.DateTimeFormat(m,h).format(c);let v={},p,b=null;const _="datetime format";for(let T=0;T<g.length&&(p=g[T],v=i[p]||{},b=v[l],!Cn(b));T++)UM(t,l,p,d,_);if(!Cn(b)||!gi(p))return n?CP:l;let P=`${p}__${l}`;RM(h)||(P=`${P}__${JSON.stringify(h)}`);let E=a.get(P);return E||(E=new Intl.DateTimeFormat(p,Bp({},b,h)),a.set(P,E)),f?E.formatToParts(c):E.format(c)}const V4=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function Ok(...t){const[e,i,n,r]=t,s={};let o={},a;if(gi(e)){const l=e.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!l)throw Kc(Hl.INVALID_ISO_DATE_ARGUMENT);const c=l[3]?l[3].trim().startsWith("T")?`${l[1].trim()}${l[3].trim()}`:`${l[1].trim()}T${l[3].trim()}`:l[1].trim();a=new Date(c);try{a.toISOString()}catch{throw Kc(Hl.INVALID_ISO_DATE_ARGUMENT)}}else if(mre(e)){if(isNaN(e.getTime()))throw Kc(Hl.INVALID_DATE_ARGUMENT);a=e}else if(Wo(e))a=e;else throw Kc(Hl.INVALID_ARGUMENT);return gi(i)?s.key=i:Cn(i)&&Object.keys(i).forEach(l=>{V4.includes(l)?o[l]=i[l]:s[l]=i[l]}),gi(n)?s.locale=n:Cn(n)&&(o=n),Cn(r)&&(o=r),[s.key||"",a,s,o]}function YD(t,e,i){const n=t;for(const r in i){const s=`${e}__${r}`;n.__datetimeFormatters.has(s)&&n.__datetimeFormatters.delete(s)}}function ZD(t,...e){const{numberFormats:i,unresolving:n,fallbackLocale:r,onWarn:s,localeFallbacker:o}=t,{__numberFormatters:a}=t,[l,c,u,h]=Dk(...e),d=vo(u.missingWarn)?u.missingWarn:t.missingWarn;vo(u.fallbackWarn)?u.fallbackWarn:t.fallbackWarn;const f=!!u.part,m=zM(t,u),g=o(t,r,m);if(!gi(l)||l==="")return new Intl.NumberFormat(m,h).format(c);let v={},p,b=null;const _="number format";for(let T=0;T<g.length&&(p=g[T],v=i[p]||{},b=v[l],!Cn(b));T++)UM(t,l,p,d,_);if(!Cn(b)||!gi(p))return n?CP:l;let P=`${p}__${l}`;RM(h)||(P=`${P}__${JSON.stringify(h)}`);let E=a.get(P);return E||(E=new Intl.NumberFormat(p,Bp({},b,h)),a.set(P,E)),f?E.formatToParts(c):E.format(c)}const L4=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function Dk(...t){const[e,i,n,r]=t,s={};let o={};if(!Wo(e))throw Kc(Hl.INVALID_ARGUMENT);const a=e;return gi(i)?s.key=i:Cn(i)&&Object.keys(i).forEach(l=>{L4.includes(l)?o[l]=i[l]:s[l]=i[l]}),gi(n)?s.locale=n:Cn(n)&&(o=n),Cn(r)&&(o=r),[s.key||"",a,s,o]}function JD(t,e,i){const n=t;for(const r in i){const s=`${e}__${r}`;n.__numberFormatters.has(s)&&n.__numberFormatters.delete(s)}}Xre();/*!
  * vue-i18n v9.9.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */const Rse="9.9.1";function Fse(){typeof __INTLIFY_JIT_COMPILATION__!="boolean"&&(g0().__INTLIFY_JIT_COMPILATION__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(g0().__INTLIFY_DROP_MESSAGE_COMPILER__=!1),typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(g0().__INTLIFY_PROD_DEVTOOLS__=!1)}const I4=gse.__EXTEND_POINT__,Lh=v4(I4);Lh(),Lh(),Lh(),Lh(),Lh(),Lh(),Lh(),Lh();const O4=Hl.__EXTEND_POINT__,ao=v4(O4),Na={UNEXPECTED_RETURN_TYPE:O4,INVALID_ARGUMENT:ao(),MUST_BE_CALL_SETUP_TOP:ao(),NOT_INSTALLED:ao(),NOT_AVAILABLE_IN_LEGACY_MODE:ao(),REQUIRED_VALUE:ao(),INVALID_VALUE:ao(),CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN:ao(),NOT_INSTALLED_WITH_PROVIDE:ao(),UNEXPECTED_ERROR:ao(),NOT_COMPATIBLE_LEGACY_VUE_I18N:ao(),BRIDGE_SUPPORT_VUE_2_ONLY:ao(),MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION:ao(),NOT_AVAILABLE_COMPOSITION_IN_LEGACY:ao(),__EXTEND_POINT__:ao()};function yl(t,...e){return jp(t,null,void 0)}const Nk=Nu("__translateVNode"),Rk=Nu("__datetimeParts"),Fk=Nu("__numberParts"),zse=Nu("__setPluralRules"),Use=Nu("__injectWithOption"),zk=Nu("__dispose");function zv(t){if(!Ko(t))return t;for(const e in t)if(o_(t,e))if(!e.includes("."))Ko(t[e])&&zv(t[e]);else{const i=e.split("."),n=i.length-1;let r=t,s=!1;for(let o=0;o<n;o++){if(i[o]in r||(r[i[o]]={}),!Ko(r[i[o]])){s=!0;break}r=r[i[o]]}s||(r[i[n]]=t[e],delete t[e]),Ko(r[i[n]])&&zv(r[i[n]])}return t}function D4(t,e){const{messages:i,__i18n:n,messageResolver:r,flatJson:s}=e,o=sl(i)?i:qc(n)?{}:{[t]:{}};if(qc(n)&&n.forEach(a=>{if("locale"in a&&"resource"in a){const{locale:l,resource:c}=a;l?(o[l]=o[l]||{},v0(c,o[l])):v0(c,o)}else cr(a)&&v0(JSON.parse(a),o)}),r==null&&s)for(const a in o)o_(o,a)&&zv(o[a]);return o}function N4(t){return t.type}function Bse(t,e,i){let n=Ko(e.messages)?e.messages:{};"__i18nGlobal"in i&&(n=D4(t.locale.value,{messages:n,__i18n:i.__i18nGlobal}));const r=Object.keys(n);r.length&&r.forEach(s=>{t.mergeLocaleMessage(s,n[s])});{if(Ko(e.datetimeFormats)){const s=Object.keys(e.datetimeFormats);s.length&&s.forEach(o=>{t.mergeDateTimeFormat(o,e.datetimeFormats[o])})}if(Ko(e.numberFormats)){const s=Object.keys(e.numberFormats);s.length&&s.forEach(o=>{t.mergeNumberFormat(o,e.numberFormats[o])})}}}function QD(t){return w(Lp,null,t,0)}const eN="__INTLIFY_META__",tN=()=>[],jse=()=>!1;let iN=0;function nN(t){return(e,i,n,r)=>t(i,n,Sh()||void 0,r)}const $se=()=>{const t=Sh();let e=null;return t&&(e=N4(t)[eN])?{[eN]:e}:null};function R4(t={},e){const{__root:i,__injectWithOption:n}=t,r=i===void 0,s=t.flatJson,o=s_?ge:_t;let a=Rc(t.inheritLocale)?t.inheritLocale:!0;const l=o(i&&a?i.locale.value:cr(t.locale)?t.locale:a_),c=o(i&&a?i.fallbackLocale.value:cr(t.fallbackLocale)||qc(t.fallbackLocale)||sl(t.fallbackLocale)||t.fallbackLocale===!1?t.fallbackLocale:l.value),u=o(D4(l.value,t)),h=o(sl(t.datetimeFormats)?t.datetimeFormats:{[l.value]:{}}),d=o(sl(t.numberFormats)?t.numberFormats:{[l.value]:{}});let f=i?i.missingWarn:Rc(t.missingWarn)||MD(t.missingWarn)?t.missingWarn:!0,m=i?i.fallbackWarn:Rc(t.fallbackWarn)||MD(t.fallbackWarn)?t.fallbackWarn:!0,g=i?i.fallbackRoot:Rc(t.fallbackRoot)?t.fallbackRoot:!0,v=!!t.fallbackFormat,p=hb(t.missing)?t.missing:null,b=hb(t.missing)?nN(t.missing):null,_=hb(t.postTranslation)?t.postTranslation:null,P=i?i.warnHtmlMessage:Rc(t.warnHtmlMessage)?t.warnHtmlMessage:!0,E=!!t.escapeParameter;const T=i?i.modifiers:sl(t.modifiers)?t.modifiers:{};let C=t.pluralRules||i&&i.pluralRules,M;M=(()=>{r&&WD(null);const J={version:Rse,locale:l.value,fallbackLocale:c.value,messages:u.value,modifiers:T,pluralRules:C,missing:b===null?void 0:b,missingWarn:f,fallbackWarn:m,fallbackFormat:v,unresolving:!0,postTranslation:_===null?void 0:_,warnHtmlMessage:P,escapeParameter:E,messageResolver:t.messageResolver,messageCompiler:t.messageCompiler,__meta:{framework:"vue"}};J.datetimeFormats=h.value,J.numberFormats=d.value,J.__datetimeFormatters=sl(M)?M.__datetimeFormatters:void 0,J.__numberFormatters=sl(M)?M.__numberFormatters:void 0;const ve=Cse(J);return r&&WD(ve),ve})(),yg(M,l.value,c.value);function V(){return[l.value,c.value,u.value,h.value,d.value]}const N=W({get:()=>l.value,set:J=>{l.value=J,M.locale=l.value}}),D=W({get:()=>c.value,set:J=>{c.value=J,M.fallbackLocale=c.value,yg(M,l.value,J)}}),O=W(()=>u.value),F=W(()=>h.value),X=W(()=>d.value);function Z(){return hb(_)?_:null}function K(J){_=J,M.postTranslation=J}function z(){return p}function H(J){J!==null&&(b=nN(J)),p=J,M.missing=b}const re=(J,ve,xe,me,Ne,ze)=>{V();let ke;try{__INTLIFY_PROD_DEVTOOLS__,r||(M.fallbackContext=i?kse():void 0),ke=J(M)}finally{__INTLIFY_PROD_DEVTOOLS__,r||(M.fallbackContext=void 0)}if(xe!=="translate exists"&&Rv(ke)&&ke===CP||xe==="translate exists"&&!ke){const[pt,Ue]=ve();return i&&g?me(i):Ne(pt)}else{if(ze(ke))return ke;throw yl(Na.UNEXPECTED_RETURN_TYPE)}};function ne(...J){return re(ve=>Reflect.apply(KD,null,[ve,...J]),()=>Ik(...J),"translate",ve=>Reflect.apply(ve.t,ve,[...J]),ve=>ve,ve=>cr(ve))}function B(...J){const[ve,xe,me]=J;if(me&&!Ko(me))throw yl(Na.INVALID_ARGUMENT);return ne(ve,xe,oc({resolvedMessage:!0},me||{}))}function Q(...J){return re(ve=>Reflect.apply(XD,null,[ve,...J]),()=>Ok(...J),"datetime format",ve=>Reflect.apply(ve.d,ve,[...J]),()=>jD,ve=>cr(ve))}function fe(...J){return re(ve=>Reflect.apply(ZD,null,[ve,...J]),()=>Dk(...J),"number format",ve=>Reflect.apply(ve.n,ve,[...J]),()=>jD,ve=>cr(ve))}function ie(J){return J.map(ve=>cr(ve)||Rv(ve)||Rc(ve)?QD(String(ve)):ve)}const ee={normalize:ie,interpolate:J=>J,type:"vnode"};function de(...J){return re(ve=>{let xe;const me=ve;try{me.processor=ee,xe=Reflect.apply(KD,null,[me,...J])}finally{me.processor=null}return xe},()=>Ik(...J),"translate",ve=>ve[Nk](...J),ve=>[QD(ve)],ve=>qc(ve))}function Y(...J){return re(ve=>Reflect.apply(ZD,null,[ve,...J]),()=>Dk(...J),"number format",ve=>ve[Fk](...J),tN,ve=>cr(ve)||qc(ve))}function te(...J){return re(ve=>Reflect.apply(XD,null,[ve,...J]),()=>Ok(...J),"datetime format",ve=>ve[Rk](...J),tN,ve=>cr(ve)||qc(ve))}function he(J){C=J,M.pluralRules=C}function ae(J,ve){return re(()=>{if(!J)return!1;const xe=cr(ve)?ve:l.value,me=G(xe),Ne=M.messageResolver(me,J);return np(Ne)||va(Ne)||cr(Ne)},()=>[J],"translate exists",xe=>Reflect.apply(xe.te,xe,[J,ve]),jse,xe=>Rc(xe))}function A(J){let ve=null;const xe=E4(M,c.value,l.value);for(let me=0;me<xe.length;me++){const Ne=u.value[xe[me]]||{},ze=M.messageResolver(Ne,J);if(ze!=null){ve=ze;break}}return ve}function I(J){const ve=A(J);return ve??(i?i.tm(J)||{}:{})}function G(J){return u.value[J]||{}}function ue(J,ve){if(s){const xe={[J]:ve};for(const me in xe)o_(xe,me)&&zv(xe[me]);ve=xe[J]}u.value[J]=ve,M.messages=u.value}function Se(J,ve){u.value[J]=u.value[J]||{};const xe={[J]:ve};if(s)for(const me in xe)o_(xe,me)&&zv(xe[me]);ve=xe[J],v0(ve,u.value[J]),M.messages=u.value}function Ee(J){return h.value[J]||{}}function Oe(J,ve){h.value[J]=ve,M.datetimeFormats=h.value,YD(M,J,ve)}function ye(J,ve){h.value[J]=oc(h.value[J]||{},ve),M.datetimeFormats=h.value,YD(M,J,ve)}function Pe(J){return d.value[J]||{}}function we(J,ve){d.value[J]=ve,M.numberFormats=d.value,JD(M,J,ve)}function j(J,ve){d.value[J]=oc(d.value[J]||{},ve),M.numberFormats=d.value,JD(M,J,ve)}iN++,i&&s_&&(He(i.locale,J=>{a&&(l.value=J,M.locale=J,yg(M,l.value,c.value))}),He(i.fallbackLocale,J=>{a&&(c.value=J,M.fallbackLocale=J,yg(M,l.value,c.value))}));const R={id:iN,locale:N,fallbackLocale:D,get inheritLocale(){return a},set inheritLocale(J){a=J,J&&i&&(l.value=i.locale.value,c.value=i.fallbackLocale.value,yg(M,l.value,c.value))},get availableLocales(){return Object.keys(u.value).sort()},messages:O,get modifiers(){return T},get pluralRules(){return C||{}},get isGlobal(){return r},get missingWarn(){return f},set missingWarn(J){f=J,M.missingWarn=f},get fallbackWarn(){return m},set fallbackWarn(J){m=J,M.fallbackWarn=m},get fallbackRoot(){return g},set fallbackRoot(J){g=J},get fallbackFormat(){return v},set fallbackFormat(J){v=J,M.fallbackFormat=v},get warnHtmlMessage(){return P},set warnHtmlMessage(J){P=J,M.warnHtmlMessage=J},get escapeParameter(){return E},set escapeParameter(J){E=J,M.escapeParameter=J},t:ne,getLocaleMessage:G,setLocaleMessage:ue,mergeLocaleMessage:Se,getPostTranslationHandler:Z,setPostTranslationHandler:K,getMissingHandler:z,setMissingHandler:H,[zse]:he};return R.datetimeFormats=F,R.numberFormats=X,R.rt=B,R.te=ae,R.tm=I,R.d=Q,R.n=fe,R.getDateTimeFormat=Ee,R.setDateTimeFormat=Oe,R.mergeDateTimeFormat=ye,R.getNumberFormat=Pe,R.setNumberFormat=we,R.mergeNumberFormat=j,R[Use]=n,R[Nk]=de,R[Rk]=te,R[Fk]=Y,R}const BM={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:t=>t==="parent"||t==="global",default:"parent"},i18n:{type:Object}};function Wse({slots:t},e){return e.length===1&&e[0]==="default"?(t.default?t.default():[]).reduce((n,r)=>[...n,...r.type===mt?r.children:[r]],[]):e.reduce((i,n)=>{const r=t[n];return r&&(i[n]=r()),i},{})}function F4(t){return mt}const Gse=ri({name:"i18n-t",props:oc({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:t=>Rv(t)||!isNaN(t)}},BM),setup(t,e){const{slots:i,attrs:n}=e,r=t.i18n||qn({useScope:t.scope,__useComponent:!0});return()=>{const s=Object.keys(i).filter(h=>h!=="_"),o={};t.locale&&(o.locale=t.locale),t.plural!==void 0&&(o.plural=cr(t.plural)?+t.plural:t.plural);const a=Wse(e,s),l=r[Nk](t.keypath,a,o),c=oc({},n),u=cr(t.tag)||Ko(t.tag)?t.tag:F4();return ia(u,c,l)}}}),rN=Gse;function Hse(t){return qc(t)&&!cr(t[0])}function z4(t,e,i,n){const{slots:r,attrs:s}=e;return()=>{const o={part:!0};let a={};t.locale&&(o.locale=t.locale),cr(t.format)?o.key=t.format:Ko(t.format)&&(cr(t.format.key)&&(o.key=t.format.key),a=Object.keys(t.format).reduce((d,f)=>i.includes(f)?oc({},d,{[f]:t.format[f]}):d,{}));const l=n(t.value,o,a);let c=[o.key];qc(l)?c=l.map((d,f)=>{const m=r[d.type],g=m?m({[d.type]:d.value,index:f,parts:l}):[d.value];return Hse(g)&&(g[0].key=`${d.type}-${f}`),g}):cr(l)&&(c=[l]);const u=oc({},s),h=cr(t.tag)||Ko(t.tag)?t.tag:F4();return ia(h,u,c)}}const qse=ri({name:"i18n-n",props:oc({value:{type:Number,required:!0},format:{type:[String,Object]}},BM),setup(t,e){const i=t.i18n||qn({useScope:"parent",__useComponent:!0});return z4(t,e,L4,(...n)=>i[Fk](...n))}}),sN=qse,Kse=ri({name:"i18n-d",props:oc({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},BM),setup(t,e){const i=t.i18n||qn({useScope:"parent",__useComponent:!0});return z4(t,e,V4,(...n)=>i[Rk](...n))}}),oN=Kse;function Xse(t,e){const i=t;if(t.mode==="composition")return i.__getInstance(e)||t.global;{const n=i.__getInstance(e);return n!=null?n.__composer:t.global.__composer}}function Yse(t){const e=o=>{const{instance:a,modifiers:l,value:c}=o;if(!a||!a.$)throw yl(Na.UNEXPECTED_ERROR);const u=Xse(t,a.$),h=aN(c);return[Reflect.apply(u.t,u,[...lN(h)]),u]};return{created:(o,a)=>{const[l,c]=e(a);s_&&t.global===c&&(o.__i18nWatcher=He(c.locale,()=>{a.instance&&a.instance.$forceUpdate()})),o.__composer=c,o.textContent=l},unmounted:o=>{s_&&o.__i18nWatcher&&(o.__i18nWatcher(),o.__i18nWatcher=void 0,delete o.__i18nWatcher),o.__composer&&(o.__composer=void 0,delete o.__composer)},beforeUpdate:(o,{value:a})=>{if(o.__composer){const l=o.__composer,c=aN(a);o.textContent=Reflect.apply(l.t,l,[...lN(c)])}},getSSRProps:o=>{const[a]=e(o);return{textContent:a}}}}function aN(t){if(cr(t))return{path:t};if(sl(t)){if(!("path"in t))throw yl(Na.REQUIRED_VALUE,"path");return t}else throw yl(Na.INVALID_VALUE)}function lN(t){const{path:e,locale:i,args:n,choice:r,plural:s}=t,o={},a=n||{};return cr(i)&&(o.locale=i),Rv(r)&&(o.plural=r),Rv(s)&&(o.plural=s),[e,a,o]}function Zse(t,e,...i){const n=sl(i[0])?i[0]:{},r=!!n.useI18nComponentName;(Rc(n.globalInstall)?n.globalInstall:!0)&&([r?"i18n":rN.name,"I18nT"].forEach(o=>t.component(o,rN)),[sN.name,"I18nN"].forEach(o=>t.component(o,sN)),[oN.name,"I18nD"].forEach(o=>t.component(o,oN))),t.directive("t",Yse(e))}const Jse=Nu("global-vue-i18n");function Qse(t={},e){const i=Rc(t.globalInjection)?t.globalInjection:!0,n=!0,r=new Map,[s,o]=eoe(t),a=Nu("");function l(h){return r.get(h)||null}function c(h,d){r.set(h,d)}function u(h){r.delete(h)}{const h={get mode(){return"composition"},get allowComposition(){return n},async install(d,...f){if(d.__VUE_I18N_SYMBOL__=a,d.provide(d.__VUE_I18N_SYMBOL__,h),sl(f[0])){const v=f[0];h.__composerExtend=v.__composerExtend,h.__vueI18nExtend=v.__vueI18nExtend}let m=null;i&&(m=loe(d,h.global)),Zse(d,h,...f);const g=d.unmount;d.unmount=()=>{m&&m(),h.dispose(),g()}},get global(){return o},dispose(){s.stop()},__instances:r,__getInstance:l,__setInstance:c,__deleteInstance:u};return h}}function qn(t={}){const e=Sh();if(e==null)throw yl(Na.MUST_BE_CALL_SETUP_TOP);if(!e.isCE&&e.appContext.app!=null&&!e.appContext.app.__VUE_I18N_SYMBOL__)throw yl(Na.NOT_INSTALLED);const i=toe(e),n=noe(i),r=N4(e),s=ioe(t,r);if(s==="global")return Bse(n,t,r),n;if(s==="parent"){let l=roe(i,e,t.__useComponent);return l==null&&(l=n),l}const o=i;let a=o.__getInstance(e);if(a==null){const l=oc({},t);"__i18n"in r&&(l.__i18n=r.__i18n),n&&(l.__root=n),a=R4(l),o.__composerExtend&&(a[zk]=o.__composerExtend(a)),ooe(o,e,a),o.__setInstance(e,a)}return a}function eoe(t,e,i){const n=Ap();{const r=n.run(()=>R4(t));if(r==null)throw yl(Na.UNEXPECTED_ERROR);return[n,r]}}function toe(t){{const e=xi(t.isCE?Jse:t.appContext.app.__VUE_I18N_SYMBOL__);if(!e)throw yl(t.isCE?Na.NOT_INSTALLED_WITH_PROVIDE:Na.UNEXPECTED_ERROR);return e}}function ioe(t,e){return lre(t)?"__i18n"in e?"local":"global":t.useScope?t.useScope:"local"}function noe(t){return t.mode==="composition"?t.global:t.global.__composer}function roe(t,e,i=!1){let n=null;const r=e.root;let s=soe(e,i);for(;s!=null;){const o=t;if(t.mode==="composition"&&(n=o.__getInstance(s)),n!=null||r===s)break;s=s.parent}return n}function soe(t,e=!1){return t==null?null:e&&t.vnode.ctx||t.parent}function ooe(t,e,i){ki(()=>{},e),ky(()=>{const n=i;t.__deleteInstance(e);const r=n[zk];r&&(r(),delete n[zk])},e)}const aoe=["locale","fallbackLocale","availableLocales"],cN=["t","rt","d","n","tm","te"];function loe(t,e){const i=Object.create(null);return aoe.forEach(r=>{const s=Object.getOwnPropertyDescriptor(e,r);if(!s)throw yl(Na.UNEXPECTED_ERROR);const o=Fi(s.value)?{get(){return s.value.value},set(a){s.value.value=a}}:{get(){return s.get&&s.get()}};Object.defineProperty(i,r,o)}),t.config.globalProperties.$i18n=i,cN.forEach(r=>{const s=Object.getOwnPropertyDescriptor(e,r);if(!s||!s.value)throw yl(Na.UNEXPECTED_ERROR);Object.defineProperty(t.config.globalProperties,`$${r}`,s)}),()=>{delete t.config.globalProperties.$i18n,cN.forEach(r=>{delete t.config.globalProperties[`$${r}`]})}}Fse();__INTLIFY_JIT_COMPILATION__&&Pse(Lse);Ese(nse);wse(E4);if(__INTLIFY_PROD_DEVTOOLS__){const t=g0();t.__INTLIFY__=!0,dse(t.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__)}const l_=Symbol.for("vuetify:layout"),U4=Symbol.for("vuetify:layout-item"),hN=1e3,B4=We({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),coe=We({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function jM(){const t=xi(l_);if(!t)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:t.getLayoutItem,mainRect:t.mainRect,mainStyles:t.mainStyles}}function hoe(t){const e=xi(l_);if(!e)throw new Error("[Vuetify] Could not find injected layout");const i=t.id??`layout-item-${Ao()}`,n=br("useLayoutItem");jn(U4,{id:i});const r=_t(!1);G1(()=>r.value=!0),W1(()=>r.value=!1);const{layoutItemStyles:s,layoutItemScrimStyles:o}=e.register(n,{...t,active:W(()=>r.value?!1:t.active.value),id:i});return an(()=>e.unregister(i)),{layoutItemStyles:s,layoutRect:e.layoutRect,layoutItemScrimStyles:o}}const uoe=(t,e,i,n)=>{let r={top:0,left:0,right:0,bottom:0};const s=[{id:"",layer:{...r}}];for(const o of t){const a=e.get(o),l=i.get(o),c=n.get(o);if(!a||!l||!c)continue;const u={...r,[a.value]:parseInt(r[a.value],10)+(c.value?parseInt(l.value,10):0)};s.push({id:o,layer:u}),r=u}return s};function j4(t){const e=xi(l_,null),i=W(()=>e?e.rootZIndex.value-100:hN),n=ge([]),r=$r(new Map),s=$r(new Map),o=$r(new Map),a=$r(new Map),l=$r(new Map),{resizeRef:c,contentRect:u}=Rd(),h=W(()=>{const T=new Map,C=t.overlaps??[];for(const M of C.filter(x=>x.includes(":"))){const[x,V]=M.split(":");if(!n.value.includes(x)||!n.value.includes(V))continue;const N=r.get(x),D=r.get(V),O=s.get(x),F=s.get(V);!N||!D||!O||!F||(T.set(V,{position:N.value,amount:parseInt(O.value,10)}),T.set(x,{position:D.value,amount:-parseInt(F.value,10)}))}return T}),d=W(()=>{const T=[...new Set([...o.values()].map(M=>M.value))].sort((M,x)=>M-x),C=[];for(const M of T){const x=n.value.filter(V=>{var N;return((N=o.get(V))==null?void 0:N.value)===M});C.push(...x)}return uoe(C,r,s,a)}),f=W(()=>!Array.from(l.values()).some(T=>T.value)),m=W(()=>d.value[d.value.length-1].layer),g=W(()=>({"--v-layout-left":Lt(m.value.left),"--v-layout-right":Lt(m.value.right),"--v-layout-top":Lt(m.value.top),"--v-layout-bottom":Lt(m.value.bottom),...f.value?void 0:{transition:"none"}})),v=W(()=>d.value.slice(1).map((T,C)=>{let{id:M}=T;const{layer:x}=d.value[C],V=s.get(M),N=r.get(M);return{id:M,...x,size:Number(V.value),position:N.value}})),p=T=>v.value.find(C=>C.id===T),b=br("createLayout"),_=_t(!1);ki(()=>{_.value=!0}),jn(l_,{register:(T,C)=>{let{id:M,order:x,position:V,layoutSize:N,elementSize:D,active:O,disableTransitions:F,absolute:X}=C;o.set(M,x),r.set(M,V),s.set(M,N),a.set(M,O),F&&l.set(M,F);const K=Hg(U4,b==null?void 0:b.vnode).indexOf(T);K>-1?n.value.splice(K,0,M):n.value.push(M);const z=W(()=>v.value.findIndex(B=>B.id===M)),H=W(()=>i.value+d.value.length*2-z.value*2),re=W(()=>{const B=V.value==="left"||V.value==="right",Q=V.value==="right",fe=V.value==="bottom",ie={[V.value]:0,zIndex:H.value,transform:`translate${B?"X":"Y"}(${(O.value?0:-110)*(Q||fe?-1:1)}%)`,position:X.value||i.value!==hN?"absolute":"fixed",...f.value?void 0:{transition:"none"}};if(!_.value)return ie;const se=v.value[z.value];if(!se)throw new Error(`[Vuetify] Could not find layout item "${M}"`);const ee=h.value.get(M);return ee&&(se[ee.position]+=ee.amount),{...ie,height:B?`calc(100% - ${se.top}px - ${se.bottom}px)`:D.value?`${D.value}px`:void 0,left:Q?void 0:`${se.left}px`,right:Q?`${se.right}px`:void 0,top:V.value!=="bottom"?`${se.top}px`:void 0,bottom:V.value!=="top"?`${se.bottom}px`:void 0,width:B?D.value?`${D.value}px`:void 0:`calc(100% - ${se.left}px - ${se.right}px)`}}),ne=W(()=>({zIndex:H.value-1}));return{layoutItemStyles:re,layoutItemScrimStyles:ne,zIndex:H}},unregister:T=>{o.delete(T),r.delete(T),s.delete(T),a.delete(T),l.delete(T),n.value=n.value.filter(C=>C!==T)},mainRect:m,mainStyles:g,getLayoutItem:p,items:v,layoutRect:u,rootZIndex:i});const P=W(()=>["v-layout",{"v-layout--full-height":t.fullHeight}]),E=W(()=>({zIndex:e?i.value:void 0,position:e?"relative":void 0,overflow:e?"hidden":void 0}));return{layoutClasses:P,layoutStyles:E,getLayoutItem:p,items:v,layoutRect:u,layoutRef:c}}const doe=We({...Ut(),...B4({fullHeight:!0}),...wn()},"VApp"),foe=vt()({name:"VApp",props:doe(),setup(t,e){let{slots:i}=e;const n=Hn(t),{layoutClasses:r,getLayoutItem:s,items:o,layoutRef:a}=j4(t),{rtlClasses:l}=io();return Tt(()=>{var c;return w("div",{ref:a,class:["v-application",n.themeClasses.value,r.value,l.value,t.class],style:[t.style]},[w("div",{class:"v-application__wrap"},[(c=i.default)==null?void 0:c.call(i)])])}),{getLayoutItem:s,items:o,theme:n}}});function MP(){const t=_t(!1);return ki(()=>{window.requestAnimationFrame(()=>{t.value=!0})}),{ssrBootStyles:W(()=>t.value?void 0:{transition:"none !important"}),isBooted:Vp(t)}}const moe=We({scrollable:Boolean,...Ut(),...pn({tag:"main"})},"VMain"),$4=vt()({name:"VMain",props:moe(),setup(t,e){let{slots:i}=e;const{mainStyles:n}=jM(),{ssrBootStyles:r}=MP();return Tt(()=>w(t.tag,{class:["v-main",{"v-main--scrollable":t.scrollable},t.class],style:[n.value,r.value,t.style]},{default:()=>{var s,o;return[t.scrollable?w("div",{class:"v-main__scroller"},[(s=i.default)==null?void 0:s.call(i)]):(o=i.default)==null?void 0:o.call(i)]}})),{}}}),poe=ri({__name:"App",setup(t){const e=Fp(),{t:i}=qn(),n=Eh(),{userRole:r}=Ji(n),s=ge(null),o=ge(""),a=ge("");to(()=>{n.resetToolset()}),ki(()=>{console.log("Base URL is ","/")});async function l(){var c;await e.signOut(),(c=s.value)==null||c.hide(),r.value=void 0,a.value="",o.value="",n.parseAndSetFavoriteTools("")}return(c,u)=>{const h=ml("router-view");return Te(),Ct(mt,null,[w(foe,null,{default:U(()=>[w($4,null,{default:U(()=>[w(h)],void 0,!0),_:1})],void 0),_:1}),w(xu,{ref_key:"logoutDialog",ref:s,title:le(i)("constructions.confirmLogout"),"yes-text":le(i)("constructions.proceed"),"yes-action":()=>l(),"no-text":le(i)("constructions.cancel"),style:{},"max-width":"40%"},{default:U(()=>[tt("p",null,nt(le(i)("constructions.logoutDialog")),1)],void 0),_:1},8,["title","yes-text","yes-action","no-text"])],64)}}});const goe="modulepreload",voe=function(t){return"/"+t},uN={},bT=function(e,i,n){if(!i||i.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(i.map(s=>{if(s=voe(s),s in uN)return;uN[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!n)for(let u=r.length-1;u>=0;u--){const h=r[u];if(h.href===s&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":goe,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};/*!
  * vue-router v4.0.16
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const W4=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",$p=t=>W4?Symbol(t):"_vr_"+t,$M=$p("rvlm"),dN=$p("rvd"),AP=$p("r"),G4=$p("rl"),Uk=$p("rvl"),om=typeof window<"u";function yoe(t){return t.__esModule||W4&&t[Symbol.toStringTag]==="Module"}const fn=Object.assign;function _T(t,e){const i={};for(const n in e){const r=e[n];i[n]=Array.isArray(r)?r.map(t):t(r)}return i}const Yg=()=>{},Soe=/\/$/,boe=t=>t.replace(Soe,"");function PT(t,e,i="/"){let n,r={},s="",o="";const a=e.indexOf("?"),l=e.indexOf("#",a>-1?a:0);return a>-1&&(n=e.slice(0,a),s=e.slice(a+1,l>-1?l:e.length),r=t(s)),l>-1&&(n=n||e.slice(0,l),o=e.slice(l,e.length)),n=woe(n??e,i),{fullPath:n+(s&&"?")+s+o,path:n,query:r,hash:o}}function _oe(t,e){const i=e.query?t(e.query):"";return e.path+(i&&"?")+i+(e.hash||"")}function fN(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function Poe(t,e,i){const n=e.matched.length-1,r=i.matched.length-1;return n>-1&&n===r&&rp(e.matched[n],i.matched[r])&&H4(e.params,i.params)&&t(e.query)===t(i.query)&&e.hash===i.hash}function rp(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function H4(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!Eoe(t[i],e[i]))return!1;return!0}function Eoe(t,e){return Array.isArray(t)?mN(t,e):Array.isArray(e)?mN(e,t):t===e}function mN(t,e){return Array.isArray(e)?t.length===e.length&&t.every((i,n)=>i===e[n]):t.length===1&&t[0]===e}function woe(t,e){if(t.startsWith("/"))return t;if(!t)return e;const i=e.split("/"),n=t.split("/");let r=i.length-1,s,o;for(s=0;s<n.length;s++)if(o=n[s],!(r===1||o==="."))if(o==="..")r--;else break;return i.slice(0,r).join("/")+"/"+n.slice(s-(s===n.length?1:0)).join("/")}var Uv;(function(t){t.pop="pop",t.push="push"})(Uv||(Uv={}));var Zg;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Zg||(Zg={}));function Toe(t){if(!t)if(om){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),boe(t)}const xoe=/^[^#]+#/;function koe(t,e){return t.replace(xoe,"#")+e}function Coe(t,e){const i=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-i.left-(e.left||0),top:n.top-i.top-(e.top||0)}}const VP=()=>({left:window.pageXOffset,top:window.pageYOffset});function Moe(t){let e;if("el"in t){const i=t.el,n=typeof i=="string"&&i.startsWith("#"),r=typeof i=="string"?n?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!r)return;e=Coe(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function pN(t,e){return(history.state?history.state.position-e:-1)+t}const Bk=new Map;function Aoe(t,e){Bk.set(t,e)}function Voe(t){const e=Bk.get(t);return Bk.delete(t),e}let Loe=()=>location.protocol+"//"+location.host;function q4(t,e){const{pathname:i,search:n,hash:r}=e,s=t.indexOf("#");if(s>-1){let a=r.includes(t.slice(s))?t.slice(s).length:1,l=r.slice(a);return l[0]!=="/"&&(l="/"+l),fN(l,"")}return fN(i,t)+n+r}function Ioe(t,e,i,n){let r=[],s=[],o=null;const a=({state:d})=>{const f=q4(t,location),m=i.value,g=e.value;let v=0;if(d){if(i.value=f,e.value=d,o&&o===m){o=null;return}v=g?d.position-g.position:0}else n(f);r.forEach(p=>{p(i.value,m,{delta:v,type:Uv.pop,direction:v?v>0?Zg.forward:Zg.back:Zg.unknown})})};function l(){o=i.value}function c(d){r.push(d);const f=()=>{const m=r.indexOf(d);m>-1&&r.splice(m,1)};return s.push(f),f}function u(){const{history:d}=window;d.state&&d.replaceState(fn({},d.state,{scroll:VP()}),"")}function h(){for(const d of s)d();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:l,listen:c,destroy:h}}function gN(t,e,i,n=!1,r=!1){return{back:t,current:e,forward:i,replaced:n,position:window.history.length,scroll:r?VP():null}}function Ooe(t){const{history:e,location:i}=window,n={value:q4(t,i)},r={value:e.state};r.value||s(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const h=t.indexOf("#"),d=h>-1?(i.host&&document.querySelector("base")?t:t.slice(h))+l:Loe()+t+l;try{e[u?"replaceState":"pushState"](c,"",d),r.value=c}catch(f){console.error(f),i[u?"replace":"assign"](d)}}function o(l,c){const u=fn({},e.state,gN(r.value.back,l,r.value.forward,!0),c,{position:r.value.position});s(l,u,!0),n.value=l}function a(l,c){const u=fn({},r.value,e.state,{forward:l,scroll:VP()});s(u.current,u,!0);const h=fn({},gN(n.value,l,null),{position:u.position+1},c);s(l,h,!1),n.value=l}return{location:n,state:r,push:a,replace:o}}function Doe(t){t=Toe(t);const e=Ooe(t),i=Ioe(t,e.state,e.location,e.replace);function n(s,o=!0){o||i.pauseListeners(),history.go(s)}const r=fn({location:"",base:t,go:n,createHref:koe.bind(null,t)},e,i);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function Noe(t){return typeof t=="string"||t&&typeof t=="object"}function K4(t){return typeof t=="string"||typeof t=="symbol"}const Ih={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},X4=$p("nf");var vN;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(vN||(vN={}));function sp(t,e){return fn(new Error,{type:t,[X4]:!0},e)}function Oh(t,e){return t instanceof Error&&X4 in t&&(e==null||!!(t.type&e))}const yN="[^/]+?",Roe={sensitive:!1,strict:!1,start:!0,end:!0},Foe=/[.+*?^${}()[\]/\\]/g;function zoe(t,e){const i=fn({},Roe,e),n=[];let r=i.start?"^":"";const s=[];for(const c of t){const u=c.length?[]:[90];i.strict&&!c.length&&(r+="/");for(let h=0;h<c.length;h++){const d=c[h];let f=40+(i.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(Foe,"\\$&"),f+=40;else if(d.type===1){const{value:m,repeatable:g,optional:v,regexp:p}=d;s.push({name:m,repeatable:g,optional:v});const b=p||yN;if(b!==yN){f+=10;try{new RegExp(`(${b})`)}catch(P){throw new Error(`Invalid custom RegExp for param "${m}" (${b}): `+P.message)}}let _=g?`((?:${b})(?:/(?:${b}))*)`:`(${b})`;h||(_=v&&c.length<2?`(?:/${_})`:"/"+_),v&&(_+="?"),r+=_,f+=20,v&&(f+=-8),g&&(f+=-20),b===".*"&&(f+=-50)}u.push(f)}n.push(u)}if(i.strict&&i.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}i.strict||(r+="/?"),i.end?r+="$":i.strict&&(r+="(?:/|$)");const o=new RegExp(r,i.sensitive?"":"i");function a(c){const u=c.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",m=s[d-1];h[m.name]=f&&m.repeatable?f.split("/"):f}return h}function l(c){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:m,repeatable:g,optional:v}=f,p=m in c?c[m]:"";if(Array.isArray(p)&&!g)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const b=Array.isArray(p)?p.join("/"):p;if(!b)if(v)d.length<2&&t.length>1&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${m}"`);u+=b}}return u}return{re:o,score:n,keys:s,parse:a,stringify:l}}function Uoe(t,e){let i=0;for(;i<t.length&&i<e.length;){const n=e[i]-t[i];if(n)return n;i++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function Boe(t,e){let i=0;const n=t.score,r=e.score;for(;i<n.length&&i<r.length;){const s=Uoe(n[i],r[i]);if(s)return s;i++}if(Math.abs(r.length-n.length)===1){if(SN(n))return 1;if(SN(r))return-1}return r.length-n.length}function SN(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const joe={type:0,value:""},$oe=/[a-zA-Z0-9_]/;function Woe(t){if(!t)return[[]];if(t==="/")return[[joe]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${i})/"${c}": ${f}`)}let i=0,n=i;const r=[];let s;function o(){s&&r.push(s),s=[]}let a=0,l,c="",u="";function h(){c&&(i===0?s.push({type:0,value:c}):i===1||i===2||i===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;a<t.length;){if(l=t[a++],l==="\\"&&i!==2){n=i,i=4;continue}switch(i){case 0:l==="/"?(c&&h(),o()):l===":"?(h(),i=1):d();break;case 4:d(),i=n;break;case 1:l==="("?i=2:$oe.test(l)?d():(h(),i=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:i=3:u+=l;break;case 3:h(),i=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return i===2&&e(`Unfinished custom RegExp for param "${c}"`),h(),o(),r}function Goe(t,e,i){const n=zoe(Woe(t.path),i),r=fn(n,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function Hoe(t,e){const i=[],n=new Map;e=_N({strict:!1,end:!0,sensitive:!1},e);function r(u){return n.get(u)}function s(u,h,d){const f=!d,m=Koe(u);m.aliasOf=d&&d.record;const g=_N(e,u),v=[m];if("alias"in u){const _=typeof u.alias=="string"?[u.alias]:u.alias;for(const P of _)v.push(fn({},m,{components:d?d.record.components:m.components,path:P,aliasOf:d?d.record:m}))}let p,b;for(const _ of v){const{path:P}=_;if(h&&P[0]!=="/"){const E=h.record.path,T=E[E.length-1]==="/"?"":"/";_.path=h.record.path+(P&&T+P)}if(p=Goe(_,h,g),d?d.alias.push(p):(b=b||p,b!==p&&b.alias.push(p),f&&u.name&&!bN(p)&&o(u.name)),"children"in m){const E=m.children;for(let T=0;T<E.length;T++)s(E[T],p,d&&d.children[T])}d=d||p,l(p)}return b?()=>{o(b)}:Yg}function o(u){if(K4(u)){const h=n.get(u);h&&(n.delete(u),i.splice(i.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=i.indexOf(u);h>-1&&(i.splice(h,1),u.record.name&&n.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return i}function l(u){let h=0;for(;h<i.length&&Boe(u,i[h])>=0&&(u.record.path!==i[h].record.path||!Y4(u,i[h]));)h++;i.splice(h,0,u),u.record.name&&!bN(u)&&n.set(u.record.name,u)}function c(u,h){let d,f={},m,g;if("name"in u&&u.name){if(d=n.get(u.name),!d)throw sp(1,{location:u});g=d.record.name,f=fn(qoe(h.params,d.keys.filter(b=>!b.optional).map(b=>b.name)),u.params),m=d.stringify(f)}else if("path"in u)m=u.path,d=i.find(b=>b.re.test(m)),d&&(f=d.parse(m),g=d.record.name);else{if(d=h.name?n.get(h.name):i.find(b=>b.re.test(h.path)),!d)throw sp(1,{location:u,currentLocation:h});g=d.record.name,f=fn({},h.params,u.params),m=d.stringify(f)}const v=[];let p=d;for(;p;)v.unshift(p.record),p=p.parent;return{name:g,path:m,params:f,matched:v,meta:Yoe(v)}}return t.forEach(u=>s(u)),{addRoute:s,resolve:c,removeRoute:o,getRoutes:a,getRecordMatcher:r}}function qoe(t,e){const i={};for(const n of e)n in t&&(i[n]=t[n]);return i}function Koe(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:Xoe(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function Xoe(t){const e={},i=t.props||!1;if("component"in t)e.default=i;else for(const n in t.components)e[n]=typeof i=="boolean"?i:i[n];return e}function bN(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function Yoe(t){return t.reduce((e,i)=>fn(e,i.meta),{})}function _N(t,e){const i={};for(const n in t)i[n]=n in e?e[n]:t[n];return i}function Y4(t,e){return e.children.some(i=>i===t||Y4(t,i))}const Z4=/#/g,Zoe=/&/g,Joe=/\//g,Qoe=/=/g,eae=/\?/g,J4=/\+/g,tae=/%5B/g,iae=/%5D/g,Q4=/%5E/g,nae=/%60/g,e5=/%7B/g,rae=/%7C/g,t5=/%7D/g,sae=/%20/g;function WM(t){return encodeURI(""+t).replace(rae,"|").replace(tae,"[").replace(iae,"]")}function oae(t){return WM(t).replace(e5,"{").replace(t5,"}").replace(Q4,"^")}function jk(t){return WM(t).replace(J4,"%2B").replace(sae,"+").replace(Z4,"%23").replace(Zoe,"%26").replace(nae,"`").replace(e5,"{").replace(t5,"}").replace(Q4,"^")}function aae(t){return jk(t).replace(Qoe,"%3D")}function lae(t){return WM(t).replace(Z4,"%23").replace(eae,"%3F")}function cae(t){return t==null?"":lae(t).replace(Joe,"%2F")}function c_(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function hae(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<n.length;++r){const s=n[r].replace(J4," "),o=s.indexOf("="),a=c_(o<0?s:s.slice(0,o)),l=o<0?null:c_(s.slice(o+1));if(a in e){let c=e[a];Array.isArray(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function PN(t){let e="";for(let i in t){const n=t[i];if(i=aae(i),n==null){n!==void 0&&(e+=(e.length?"&":"")+i);continue}(Array.isArray(n)?n.map(s=>s&&jk(s)):[n&&jk(n)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+i,s!=null&&(e+="="+s))})}return e}function uae(t){const e={};for(const i in t){const n=t[i];n!==void 0&&(e[i]=Array.isArray(n)?n.map(r=>r==null?null:""+r):n==null?n:""+n)}return e}function Sg(){let t=[];function e(n){return t.push(n),()=>{const r=t.indexOf(n);r>-1&&t.splice(r,1)}}function i(){t=[]}return{add:e,list:()=>t,reset:i}}function i5(t,e,i){const n=()=>{t[e].delete(i)};ky(n),G1(n),W1(()=>{t[e].add(i)}),t[e].add(i)}function dae(t){const e=xi($M,{}).value;e&&i5(e,"leaveGuards",t)}function fae(t){const e=xi($M,{}).value;e&&i5(e,"updateGuards",t)}function Yh(t,e,i,n,r){const s=n&&(n.enterCallbacks[r]=n.enterCallbacks[r]||[]);return()=>new Promise((o,a)=>{const l=h=>{h===!1?a(sp(4,{from:i,to:e})):h instanceof Error?a(h):Noe(h)?a(sp(2,{from:e,to:h})):(s&&n.enterCallbacks[r]===s&&typeof h=="function"&&s.push(h),o())},c=t.call(n&&n.instances[r],e,i,l);let u=Promise.resolve(c);t.length<3&&(u=u.then(l)),u.catch(h=>a(h))})}function ET(t,e,i,n){const r=[];for(const s of t)for(const o in s.components){let a=s.components[o];if(!(e!=="beforeRouteEnter"&&!s.instances[o]))if(mae(a)){const c=(a.__vccOpts||a)[e];c&&r.push(Yh(c,i,n,s,o))}else{let l=a();r.push(()=>l.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${s.path}"`));const u=yoe(c)?c.default:c;s.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&Yh(d,i,n,s,o)()}))}}return r}function mae(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function EN(t){const e=xi(AP),i=xi(G4),n=W(()=>e.resolve(le(t.to))),r=W(()=>{const{matched:l}=n.value,{length:c}=l,u=l[c-1],h=i.matched;if(!u||!h.length)return-1;const d=h.findIndex(rp.bind(null,u));if(d>-1)return d;const f=wN(l[c-2]);return c>1&&wN(u)===f&&h[h.length-1].path!==f?h.findIndex(rp.bind(null,l[c-2])):d}),s=W(()=>r.value>-1&&yae(i.params,n.value.params)),o=W(()=>r.value>-1&&r.value===i.matched.length-1&&H4(i.params,n.value.params));function a(l={}){return vae(l)?e[le(t.replace)?"replace":"push"](le(t.to)).catch(Yg):Promise.resolve()}return{route:n,href:W(()=>n.value.href),isActive:s,isExactActive:o,navigate:a}}const pae=ri({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:EN,setup(t,{slots:e}){const i=$r(EN(t)),{options:n}=xi(AP),r=W(()=>({[TN(t.activeClass,n.linkActiveClass,"router-link-active")]:i.isActive,[TN(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const s=e.default&&e.default(i);return t.custom?s:ia("a",{"aria-current":i.isExactActive?t.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:r.value},s)}}}),gae=pae;function vae(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function yae(t,e){for(const i in e){const n=e[i],r=t[i];if(typeof n=="string"){if(n!==r)return!1}else if(!Array.isArray(r)||r.length!==n.length||n.some((s,o)=>s!==r[o]))return!1}return!0}function wN(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const TN=(t,e,i)=>t??e??i,Sae=ri({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:i}){const n=xi(Uk),r=W(()=>t.route||n.value),s=xi(dN,0),o=W(()=>r.value.matched[s]);jn(dN,s+1),jn($M,o),jn(Uk,r);const a=ge();return He(()=>[a.value,o.value,t.name],([l,c,u],[h,d,f])=>{c&&(c.instances[u]=l,d&&d!==c&&l&&l===h&&(c.leaveGuards.size||(c.leaveGuards=d.leaveGuards),c.updateGuards.size||(c.updateGuards=d.updateGuards))),l&&c&&(!d||!rp(c,d)||!h)&&(c.enterCallbacks[u]||[]).forEach(m=>m(l))},{flush:"post"}),()=>{const l=r.value,c=o.value,u=c&&c.components[t.name],h=t.name;if(!u)return xN(i.default,{Component:u,route:l});const d=c.props[t.name],f=d?d===!0?l.params:typeof d=="function"?d(l):d:null,g=ia(u,fn({},f,e,{onVnodeUnmounted:v=>{v.component.isUnmounted&&(c.instances[h]=null)},ref:a}));return xN(i.default,{Component:g,route:l})||g}}});function xN(t,e){if(!t)return null;const i=t(e);return i.length===1?i[0]:i}const bae=Sae;function _ae(t){const e=Hoe(t.routes,t),i=t.parseQuery||hae,n=t.stringifyQuery||PN,r=t.history,s=Sg(),o=Sg(),a=Sg(),l=_t(Ih);let c=Ih;om&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=_T.bind(null,ie=>""+ie),h=_T.bind(null,cae),d=_T.bind(null,c_);function f(ie,se){let ee,de;return K4(ie)?(ee=e.getRecordMatcher(ie),de=se):de=ie,e.addRoute(de,ee)}function m(ie){const se=e.getRecordMatcher(ie);se&&e.removeRoute(se)}function g(){return e.getRoutes().map(ie=>ie.record)}function v(ie){return!!e.getRecordMatcher(ie)}function p(ie,se){if(se=fn({},se||l.value),typeof ie=="string"){const ae=PT(i,ie,se.path),A=e.resolve({path:ae.path},se),I=r.createHref(ae.fullPath);return fn(ae,A,{params:d(A.params),hash:c_(ae.hash),redirectedFrom:void 0,href:I})}let ee;if("path"in ie)ee=fn({},ie,{path:PT(i,ie.path,se.path).path});else{const ae=fn({},ie.params);for(const A in ae)ae[A]==null&&delete ae[A];ee=fn({},ie,{params:h(ie.params)}),se.params=h(se.params)}const de=e.resolve(ee,se),Y=ie.hash||"";de.params=u(d(de.params));const te=_oe(n,fn({},ie,{hash:oae(Y),path:de.path})),he=r.createHref(te);return fn({fullPath:te,hash:Y,query:n===PN?uae(ie.query):ie.query||{}},de,{redirectedFrom:void 0,href:he})}function b(ie){return typeof ie=="string"?PT(i,ie,l.value.path):fn({},ie)}function _(ie,se){if(c!==ie)return sp(8,{from:se,to:ie})}function P(ie){return C(ie)}function E(ie){return P(fn(b(ie),{replace:!0}))}function T(ie){const se=ie.matched[ie.matched.length-1];if(se&&se.redirect){const{redirect:ee}=se;let de=typeof ee=="function"?ee(ie):ee;return typeof de=="string"&&(de=de.includes("?")||de.includes("#")?de=b(de):{path:de},de.params={}),fn({query:ie.query,hash:ie.hash,params:ie.params},de)}}function C(ie,se){const ee=c=p(ie),de=l.value,Y=ie.state,te=ie.force,he=ie.replace===!0,ae=T(ee);if(ae)return C(fn(b(ae),{state:Y,force:te,replace:he}),se||ee);const A=ee;A.redirectedFrom=se;let I;return!te&&Poe(n,de,ee)&&(I=sp(16,{to:A,from:de}),re(de,de,!0,!1)),(I?Promise.resolve(I):x(A,de)).catch(G=>Oh(G)?Oh(G,2)?G:H(G):K(G,A,de)).then(G=>{if(G){if(Oh(G,2))return C(fn(b(G.to),{state:Y,force:te,replace:he}),se||A)}else G=N(A,de,!0,he,Y);return V(A,de,G),G})}function M(ie,se){const ee=_(ie,se);return ee?Promise.reject(ee):Promise.resolve()}function x(ie,se){let ee;const[de,Y,te]=Pae(ie,se);ee=ET(de.reverse(),"beforeRouteLeave",ie,se);for(const ae of de)ae.leaveGuards.forEach(A=>{ee.push(Yh(A,ie,se))});const he=M.bind(null,ie,se);return ee.push(he),Bf(ee).then(()=>{ee=[];for(const ae of s.list())ee.push(Yh(ae,ie,se));return ee.push(he),Bf(ee)}).then(()=>{ee=ET(Y,"beforeRouteUpdate",ie,se);for(const ae of Y)ae.updateGuards.forEach(A=>{ee.push(Yh(A,ie,se))});return ee.push(he),Bf(ee)}).then(()=>{ee=[];for(const ae of ie.matched)if(ae.beforeEnter&&!se.matched.includes(ae))if(Array.isArray(ae.beforeEnter))for(const A of ae.beforeEnter)ee.push(Yh(A,ie,se));else ee.push(Yh(ae.beforeEnter,ie,se));return ee.push(he),Bf(ee)}).then(()=>(ie.matched.forEach(ae=>ae.enterCallbacks={}),ee=ET(te,"beforeRouteEnter",ie,se),ee.push(he),Bf(ee))).then(()=>{ee=[];for(const ae of o.list())ee.push(Yh(ae,ie,se));return ee.push(he),Bf(ee)}).catch(ae=>Oh(ae,8)?ae:Promise.reject(ae))}function V(ie,se,ee){for(const de of a.list())de(ie,se,ee)}function N(ie,se,ee,de,Y){const te=_(ie,se);if(te)return te;const he=se===Ih,ae=om?history.state:{};ee&&(de||he?r.replace(ie.fullPath,fn({scroll:he&&ae&&ae.scroll},Y)):r.push(ie.fullPath,Y)),l.value=ie,re(ie,se,ee,he),H()}let D;function O(){D||(D=r.listen((ie,se,ee)=>{const de=p(ie),Y=T(de);if(Y){C(fn(Y,{replace:!0}),de).catch(Yg);return}c=de;const te=l.value;om&&Aoe(pN(te.fullPath,ee.delta),VP()),x(de,te).catch(he=>Oh(he,12)?he:Oh(he,2)?(C(he.to,de).then(ae=>{Oh(ae,20)&&!ee.delta&&ee.type===Uv.pop&&r.go(-1,!1)}).catch(Yg),Promise.reject()):(ee.delta&&r.go(-ee.delta,!1),K(he,de,te))).then(he=>{he=he||N(de,te,!1),he&&(ee.delta?r.go(-ee.delta,!1):ee.type===Uv.pop&&Oh(he,20)&&r.go(-1,!1)),V(de,te,he)}).catch(Yg)}))}let F=Sg(),X=Sg(),Z;function K(ie,se,ee){H(ie);const de=X.list();return de.length?de.forEach(Y=>Y(ie,se,ee)):console.error(ie),Promise.reject(ie)}function z(){return Z&&l.value!==Ih?Promise.resolve():new Promise((ie,se)=>{F.add([ie,se])})}function H(ie){return Z||(Z=!ie,O(),F.list().forEach(([se,ee])=>ie?ee(ie):se()),F.reset()),ie}function re(ie,se,ee,de){const{scrollBehavior:Y}=t;if(!om||!Y)return Promise.resolve();const te=!ee&&Voe(pN(ie.fullPath,0))||(de||!ee)&&history.state&&history.state.scroll||null;return vn().then(()=>Y(ie,se,te)).then(he=>he&&Moe(he)).catch(he=>K(he,ie,se))}const ne=ie=>r.go(ie);let B;const Q=new Set;return{currentRoute:l,addRoute:f,removeRoute:m,hasRoute:v,getRoutes:g,resolve:p,options:t,push:P,replace:E,go:ne,back:()=>ne(-1),forward:()=>ne(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:X.add,isReady:z,install(ie){const se=this;ie.component("RouterLink",gae),ie.component("RouterView",bae),ie.config.globalProperties.$router=se,Object.defineProperty(ie.config.globalProperties,"$route",{enumerable:!0,get:()=>le(l)}),om&&!B&&l.value===Ih&&(B=!0,P(r.location).catch(Y=>{}));const ee={};for(const Y in Ih)ee[Y]=W(()=>l.value[Y]);ie.provide(AP,se),ie.provide(G4,$r(ee)),ie.provide(Uk,l);const de=ie.unmount;Q.add(ie),ie.unmount=function(){Q.delete(ie),Q.size<1&&(c=Ih,D&&D(),D=null,l.value=Ih,B=!1,Z=!1),de()}}}}function Bf(t){return t.reduce((e,i)=>e.then(()=>i()),Promise.resolve())}function Pae(t,e){const i=[],n=[],r=[],s=Math.max(e.matched.length,t.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(t.matched.find(c=>rp(c,a))?n.push(a):i.push(a));const l=t.matched[o];l&&(e.matched.find(c=>rp(c,l))||r.push(l))}return[i,n,r]}function LP(){return xi(AP)}const Eae="data:image/gif;base64,R0lGODlhYwBlAPefACklJScnKysrKzMzMzw8PCkpQTMzQj45QURERExMTE5OVFNTU1RUW1tbW2RbW2hfX0xMYk5Ga1ZLZ1NTZF5UYlxcZlJSbFxbaktLck9Pe1NJd1RUc1xcc1NTe1tbe2heYWpec2NjY2xiYmRkaGtra3FnZ3RqanhubmNjcmxsdWRke2trenJyc31zc3t7e4F1dYR5eYl+flJSg1tbgVZWjVlZi1tbkmNXkWNjgmpqg2Fhi21ninV1g35+iGJilW1tkWZmmHZ2lHFxnGdnomtrpm9vrXNmpnR0onx8pnFxrHl5q3R0snt7tXFxvnt7vHx8woV3hYJymoR1o4R1woN5xoN+y5F+y4ODg42BgYaGiYuLi5GEhJOKipuNjYWFlIiIl4iIn5SUlJ2SkpCQmZycnKGUlKeZma2enpeXoJyco4KCuJaDu6Kioq6ioqenrqurq7Ojo7urq6yss7Ozs7y2trCwvLu7u8Cvr8Szs8O/v8q5udC9voGBxIOCzYuCz4uLzJiEzJKSz4SE0YmJ1Y2N2pSE0ZuH0p2J1pGR27q6wJWU4ZmZ5Z2d6sTDw87ExMLCyczLy9LDw9jGxtLKytzLy9PT09rU1NbW2dvb2+HOzuXS0urW1uHe3uPj4+rq6gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAUAAJ8ALAAAAABjAGUAAAj/AD8JHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8A5YVyQaLCgZMkGDUiwyPLGjseXEcOwWJCAxBU2diBhutTJEyZMkNg0QDBAQIIFV+bAXFrQzpUFDVzY6empqtWrnbRcsWMV05wrKFm8YfoyDMkrla6qVXvJxZyumCpVamTHjtkFWhqRxehUAYtGa69iasTGBYsRCgik6XRJLiaqVeNCsuNigQu9eyU2eoo2sM83LlCoEKLmzyJGiwbZuADJc9VOQCGBvYI5c0MtCVxcCgxJSwUcShAxGj5ckSBBihghmoHGtVW5lbTgtb1wTggSadV2YlPBg5PTxIsL/xoEnjiRFc5fQ2cRQil1g1kasFl7KQsEIMLDD180vrx+Pijslh5QnLyxQBa1UWdHCCxk11UPGyzhX3iEIKffhX9s4KBz0JFAQoJ7vdGAFpBVNcYGTlxIHH/5qagfIhu0lp5PlWASn3t7aRHCfFclMkERE4aHSB9BujgcjBu61gkknRgoR44NvGVVJzkAUSRxxxmppSIdCJjekp3YscBYS13x4VV1oGjkIvwlp6WWiFiAyYxVMdnIAmzApAUJMlblRQ3gLaIIIYMcd1wfTbj5ppZ8rFCic3bi6dGegFV1iQdJLFLhcYQg4iZ4g7S4qJFJ8EBnVTXeiWNGZCRwHXsjGP/gxHGKXCneqIvWIMepnlQS5gIusToACXN6wgkbGSi6qCC4vrmIB15+mRYbIYA4USMDXBFZJfXx0SwjhBDyrZGDoMDrkp5cwQJGUXXCCbc9cWCri32MS2pzp3biawhkWGQWt75atYG9hChrb3geFEsnJu8uYK1DjYwQRo1XNaKDvfwdrKIgpvLqaxgkUORCFlOpxUYSBwsy77c+PMJrr52EQCZEb4QACSdraZGivYNqfOEiKrzMcCMNSESCFklWlYKo39brs35JuPFyI5iwEAZEZGCn8FUV+Nzp08Qh8kQBJJCRNG+DOfzQjmd70rXPToPNiAx1VEIGCySEsfVarWH/YpNDc/AZ7VUTPE2e3EUEgdUceM/xaJ1V3enQ0W17UrjPqYEdSAaPe7JdCGFEy5hVC/S7kB0NQFL55T6r/LQMLjtnBwtXULWTVXMkwJAWLFyyN+Fg96zxEGCc2sjRnvh+lQDBJiRz5Z6gIDezB/PhwcueLEiGWgiEoJCYcTknPdiDGDzqIhv8PmMnLLCgcBgDKMQGCZwMrtYFcmc8Lg1SYv/TgjKywwCaZ5ARkIEnzmEB01K2Mv0QQXHYg5xPSPCG7CVACwlJHfTS5a3gDaJZffBA59bnoE5QsDAhQ8gCepUeMjBBboyg3qIUgYGARRCBUyJBCOygu4PUjIXOoQMR/2AYrlHJoH8R7NOUENCJBDwsDLWzn1oqgQMY6k9LQ/hCBJ+jPhKYcGYEYQEbfjIjDsAwhuYLj/VGSELP0EYLGDTIDhk2I/zBUBEfdBEiMCDFU+FwLWGYwxvWZZAF+I6NVnFBHsG2iCaMp2D+yQBXtui5yr2BDUQ7SAKSh8iqkEEIMHxCIQ5hCD/4oQpVGA8NtEhJmLnGLp1YgCaBmB5ImBFsgvDDIXbJy10a4QKTgAQkDvmyd0FKWz0syCY3uCQ2BIADQuBDA1VUCCv0spdWkEAmNsHNTFBiEpOQCyc6qcTAVEJbsjTIMukkFUiQwQUMuMAP1LBAFyliCtfkpRUisP8Hbvrzn5vIBDhrNM4p4iw9LPBEMgmyzvS8QVtYsYMWUsAAFRzhD2uagiHyuUsNnAGgIP2nJb4Zzsfoi04JXehAGqokYjkHE2/IwghGkAMkBKI8VBglR28AhZD6FKCZsMQk7PCYGaX0ICu0oRuROKOgXCEEF1DBDqQACI4aAQQ/zSpAJ9HJqiDzIA2ADRst4YJWeiIPZthCCT5AgRxEYQ2HmII2tUrXTVDioBz6qhwJ6hoWlLOYkQCoHsrQggYcoJ911aomLNHUMCj0IGIhY2Ak2spOREITPxUDHBKr2L+uxQ5sgEQ6C3KF2rWtAeo71SS2+dNIwICzWvWsWgS5IB//koCWV3mDFlppCUnQFQa+ha1PudpCu7jgIGLK3uNC0McZcSKwdIVDF4Tr07umxwUmNJ1BUKs6teQBolu8bF01cQLMUheglEitVVL6sE9Q8DEbcoFsZyQJ1ta1C5s97z810VzPlRUBCdFKT+LSE07cdou9hW0kXqDf/UIPJJAoGkLmsACqgIkM24vgc6n7Aug2eBPQ04JEr6AQh12lEiFQr3PEK9w4bOHD3JyvJ9yXAAIahAW7nVIIKPay+uqXBeZt8CSUROPqEAAyTvHJzU6FieCetwxmgPGQPYPhkDCEADzyRCC7smTndMIRH6ZECWA8XxrngSFPoYr71AIUpapl/xKWgHEM7vBhR3jGErQZrUIagYAch8AzceGxVUYK403o4QQflq0WAqfdhVwhAW9pwIDkYglObLjQmxCBk6lr57V0QjcAhlgIrkAGSa/vXXjIRJA/3IYYNNizbAANiR+iBakQAK8zajKmN6EJEQg5MPIN9UOIRpcMq3bXm8DveYO6ljcM8mox8aILNoiVTX9YEg847yT2BgkCSG4iZataV59jXxi3ALGwlUSJslYSMEJETJWgLK88DGM8IFq4U/bJFcLQiQEQkiIg48SieUVoTDtg1XWdMsgAQwYBYATHnsAOryaBcP1CGbaamATI2DBgAeTpIgt6g99UrBYwF1oT2f9OLB5MIBbbJWDWfAEWJOh3qkvDuAR4yKom4gADE2CBDJAIplxUwpE5NMAOxyP5oCdRaDjcu5t6kO4LTHCCMuhBEky6ylM9YqA82MGLqi33efUAgAeI4AQmeAEXzBAH8WpCEkkyS3sv8oYEeN2ldFptg+HgAHqDNBORwLWWJQwTA81hQdSuCouFuwURiH2/ksi3VcCyl9yFtlp0+rJwsb2Fivvzm4Jn34cyQzQXYIJfmXeE50PK9zj8NBOO+B0mGgBz27AgdXtSeif0ntU9iAALqwe8m6tCh9K9ZyBsKB3qKjijSVCiulgQAbq36ghLPI4TLjj68QlyvGqpi9qTsDbHJbjggPyiNxLb7pyB4rj9giRfLKPupCVUb2gsPKANq9ZEJYRpfc/koQE71H4BlgAsQAZIAT3RIQItQGe8NlIDpWILIikCuGfSYRMp0T/NpC5uUQl5AE5wRkfOcSxQ8XET2BBC4SohMAAAaBOhpR7j9hkk4CruVoINsRkLgAAE0BmvYQmJFxQxCDpzR4M1eAVEoYI4NgdUw1hV8S6QABK3dxQFGIRCqBkgIRIkQRInsQDX4QJkgHRT+IVgGIZiOIZkWIZmeIYBAQA7";const wae=We({id:String,text:String,...Ua(Ny({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),dr=vt()({name:"VTooltip",props:wae(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const n=Oi(t,"modelValue"),{scopeId:r}=Np(),s=Ao(),o=W(()=>t.id||`v-tooltip-${s}`),a=ge(),l=W(()=>t.location.split(" ").length>1?t.location:t.location+" center"),c=W(()=>t.origin==="auto"||t.origin==="overlap"||t.origin.split(" ").length>1||t.location.split(" ").length>1?t.origin:t.origin+" center"),u=W(()=>t.transition?t.transition:n.value?"scale-transition":"fade-transition"),h=W(()=>ht({"aria-describedby":o.value},t.activatorProps));return Tt(()=>{const d=dc.filterProps(t);return w(dc,ht({ref:a,class:["v-tooltip",t.class],style:t.style,id:o.value},d,{modelValue:n.value,"onUpdate:modelValue":f=>n.value=f,transition:u.value,absolute:!0,location:l.value,origin:c.value,persistent:!0,role:"tooltip",activatorProps:h.value,_disableGlobalStack:!0},r),{activator:i.activator,default:function(){var v;for(var f=arguments.length,m=new Array(f),g=0;g<f;g++)m[g]=arguments[g];return((v=i.default)==null?void 0:v.call(i,...m))??t.text}})}),_c({},a)}}),Tae={class:"tooltip"},xae=ri({__name:"ToolButton",props:{button:{},selected:{type:Boolean},editing:{type:Boolean},included:{type:Boolean}},setup(t){const{t:e}=qn(),i=t,n=ge(5),r=ge("normal"),s=ge(i.editing),o=W(()=>({fontWeight:r.value})),a=W(()=>i.button.icon??"$"+i.button.action);return H1(()=>{s.value=i.editing,n.value=i.selected?1:5,r.value=i.selected?"bold":"normal"}),(l,c)=>(Te(),qe(uc,{class:"ma-1",variant:l.selected?"outlined":"flat",elevation:"2",rounded:"lg",width:"80px",style:mr({backgroundColor:l.selected?"#002108":"#8CCD8F"}),height:"100px"},{default:U(()=>[tt("div",ht({class:"toolbutton"},i),[w(lt,{class:"toolicon",icon:a.value,style:mr({filter:l.selected?"invert(100%) sepia(17%) saturate(0%) hue-rotate(91deg) brightness(104%) contrast(104%)":""})},null,8,["icon","style"]),tt("span",{class:"tooltext",style:mr([o.value,{color:l.selected?"white":"black"}])},nt(le(e)(l.button.displayedName)),5)],16),w(dc,{contained:"",modelValue:s.value,"onUpdate:modelValue":c[0]||(c[0]=u=>s.value=u),style:mr({backgroundColor:l.selected?"#002108":"#8CCD8F",color:l.selected?"white":"black"}),scrim:i.included?"#00F":"#000"},{default:U(()=>[i.included?(Te(),qe(lt,{key:0,size:"x-large",class:"overlayicon"},{default:U(()=>[$e(" mdi-minus-circle ")],void 0,!0),_:1})):(Te(),qe(lt,{key:1,size:"x-large",class:"overlayicon"},{default:U(()=>[$e("mdi-plus-circle")],void 0,!0),_:1}))],void 0,!0),_:1},8,["modelValue","style","scrim"]),w(dr,{location:"bottom",activator:"parent"},{default:U(()=>[tt("span",Tae,nt(le(e)(l.button.toolTipMessage)),1)],void 0,!0),_:1})],void 0),_:1},8,["variant","style"]))}});const Tn=(t,e)=>{const i=t.__vccOpts||t;for(const[n,r]of e)i[n]=r;return i},kN=Tn(xae,[["__scopeId","data-v-ba80c3cd"]]);var Bc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function IP(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wr=(t=>(t[t.NORTH=0]="NORTH",t[t.SOUTH=1]="SOUTH",t))(wr||{}),Ni=(t=>(t[t.Number=0]="Number",t[t.MultipleOfPi=1]="MultipleOfPi",t[t.DegreeDecimals=2]="DegreeDecimals",t[t.EarthModeMiles=3]="EarthModeMiles",t[t.EarthModeKilos=4]="EarthModeKilos",t))(Ni||{}),Xi=(t=>(t[t.NameOnly=0]="NameOnly",t[t.CaptionOnly=1]="CaptionOnly",t[t.ValueOnly=2]="ValueOnly",t[t.NameAndCaption=3]="NameAndCaption",t[t.NameAndValue=4]="NameAndValue",t))(Xi||{}),Di=(t=>(t[t.NONE=0]="NONE",t[t.LINES=1]="LINES",t[t.POINTS=2]="POINTS",t[t.SEGMENTS=3]="SEGMENTS",t[t.LINEANDSEGMENT=4]="LINEANDSEGMENT",t[t.SEGMENTSORLINEANDSEGMENT=5]="SEGMENTSORLINEANDSEGMENT",t))(Di||{});const S={nearlyAntipodalIdeal:.005,tolerance:1e-11,intersectionTolerance:1e-8,hideObjectHidesLabel:!0,showObjectShowsLabel:!1,decimalPrecision:3,messageTypes:["success","info","error","warning","directive"],style:{backStyleContrast:.5,maxStrokeWidthPercent:200,minStrokeWidthPercent:60,maxPointRadiusPercent:200,minPointRadiusPercent:60,maxAngleMarkerRadiusPercent:200,minAngleMarkerRadiusPercent:60,maxGapLengthOrDashLength:20,sliderStepSize:1,maxLabelTextScalePercent:200,minLabelTextScalePercent:60,swatches:[["#000000","#283593","#1565C0","#388E3C","#F9A825","#EF6C00","#C62828","#AD1457","#6A1B9A","#4527A0"],["#616161","#3949AB","#1E88E5","#66BB6A","#FDD835","#FB8C00","#E53935","#D81B60","#8E24AA","#5E35B1"],["#BDBDBD","#7986CB","#64B5F6","#A5D6A7","#FFF176","#FFB74D","#E57373","#F06292","#BA68C8","#9575CD"],["#FFFFFF","#C5CAE9","#BBDEFB","#E8F5E9","#FFF9C4","#FFE0B2","#FFCDD2","#F8BBD0","#E1BEE7","#D1C4E9"]],greyedOutSwatches:[["#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD"],["#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD"],["#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD"],["#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD","#BDBDBD"]],selectedColor:{front:"hsla(0, 100%, 50%, 0.5)",back:"hsla(0, 100%, 50%, 0.3)"}},zoom:{maxMagnification:10,minMagnification:.8,percentChange:10},rotate:{minAngle:Math.PI/1e3,momentum:{enabled:!0,decayTime:3,framesPerSecond:30,pauseTimeToTemporarilyDisableMomentum:.25}},fill:{lightSource:{x:-250/3,y:250/3},frontWhite:"hsla(0, 0%, 90%, 0.2)",backGray:"hsla(0, 0%, 85%, 0.2)"},boundaryCircle:{radius:250,numPoints:50,color:"hsla(0, 0%, 0%, 1)",lineWidth:3},point:{initialValueDisplayMode:Ni.MultipleOfPi,showLabelsOfFreePointsInitially:!0,showLabelsOfNonFreePointsInitially:!1,showLabelsOfPointOnObjectInitially:!1,showLabelsOfPolarPointInitially:!1,showLabelsOfParametricEndPointsInitially:!0,readingCoordinatesChangesLabelModeTo:Xi.NameAndValue,maxLabelDistance:.1,initialLabelOffset:.2,defaultLabelMode:Xi.NameOnly,hitIdealDistance:.04,dynamicBackStyle:!0,radiusPercent:{front:100,back:90},drawn:{radius:{front:3.5,back:3},fillColor:{front:"hsla(0, 100%, 75%, 1)",frontHSLA:{h:0,s:100,l:75,a:1},back:"hsla(0, 100%, 75%, 1)",backHSLA:{h:0,s:100,l:75,a:1}},strokeColor:{front:"hsla(240, 55%, 55%, 1)",back:"hsla(240, 55%, 75%, 1)"},pointStrokeWidth:{front:2,back:2}},glowing:{annularWidth:3,fillColor:{front:"hsla(0, 100%, 50%, 1)",back:"hsla(0, 100%, 75%, 0.71)"},strokeColor:{front:"hsla(0, 100%, 35%, 1)",back:"hsla(0, 100%, 45%, 0.7)"}},temp:{fillColor:{front:"hsla(0, 0%, 50%, 1)",back:"hsla(0, 0%, 75%, 1)"},strokeColor:{front:"hsla(0, 0%, 0%, 1)",back:"hsla(0, 0%, 50%, 1)"}},nonFree:{scalePercent:90,fillColor:{front:"hsla(0, 50%, 75%, 1)",frontHSLA:{h:0,s:50,l:75,a:1},back:"hsla(0, 25%, 75%, 1)"},strokeColor:{front:"hsla(240, 30%, 55%, 1)",back:"hsla(240, 35%, 75%, 1)"},pointStrokeWidth:{front:2,back:2}}},segment:{showLabelsInitially:!1,maxLabelDistance:.15,defaultLabelMode:Xi.NameOnly,measuringChangesLabelModeTo:Xi.NameAndValue,initialValueDisplayMode:Ni.MultipleOfPi,initialLabelOffset:.02,minimumArcLength:.045,numPoints:60,hitIdealDistance:.03,closeEnoughToPi:.005,dynamicBackStyle:!0,drawn:{strokeColor:{front:"hsla(217, 90%, 61%, 1)",back:"hsla(217, 90%, 80%, 1)"},strokeWidth:{front:2.5,back:2},dashArray:{reverse:{front:!0,back:!0},offset:{front:0,back:0},front:[0,0],back:[5,10]}},glowing:{strokeColor:{front:"hsla(0, 100%, 50%, 1)",back:"hsla(0, 100%, 75%, 0.72)"},edgeWidth:5},temp:{strokeColor:{front:"hsla(0, 0%, 42%, 1)",back:"hsla(0, 0%, 71%, 1)"}},nonFree:{strokeColor:{front:"hsla(200, 90%, 61%, 1)",back:"hsla(200, 90%, 80%, 1)"},scalePercent:85,dashArray:{reverse:{front:!0,back:!0},offset:{front:0,back:0},front:[0,0],back:[5,10]}}},line:{showLabelsInitially:!1,showLabelsOfNonFreeLinesInitially:!1,maxLabelDistance:.08,initialLabelOffset:.02,defaultLabelMode:Xi.NameOnly,minimumLength:.045,numPoints:50,closeEnoughToPi:.005,hitIdealDistance:.03,dynamicBackStyle:!0,drawn:{strokeColor:{front:"hsla(217, 90%, 61%, 1)",back:"hsla(217, 90%, 80%, 1)"},strokeWidth:{front:2.5,back:2},dashArray:{reverse:{front:!0,back:!0},offset:{front:0,back:0},front:[0,0],back:[5,10]}},glowing:{strokeColor:{front:"hsla(0, 100%, 50%, 1)",back:"hsla(0, 100%, 75%, 0.73)"},edgeWidth:5},temp:{strokeColor:{front:"hsla(0, 0%, 42%, 1)",back:"hsla(0, 0%, 71%, 1)"}},nonFree:{strokeColor:{front:"hsla(200, 90%, 61%, 1)",back:"hsla(200, 90%, 80%, 1)"},scalePercent:85,dashArray:{reverse:{front:!0,back:!0},offset:{front:0,back:0},front:[0,0],back:[5,10]}}},circle:{showLabelsInitially:!1,showLabelsOfNonFreeCirclesInitially:!1,maxLabelDistance:.08,initialLabelOffset:.02,defaultLabelMode:Xi.NameOnly,minimumRadius:.045,numPoints:60,hitIdealDistance:.03,dynamicBackStyle:!0,drawn:{fillColor:{front:"hsla(254, 100%, 90%, 0.2)",frontHSLA:{h:254,s:100,l:90,a:.2},back:"hsla(10, 100%, 50%, 0.1)",backHSLA:{h:254,s:100,l:50,a:.2}},strokeColor:{front:"hsla(217, 90%, 61%, 1)",back:"hsla(217, 90%, 80%, 1)"},strokeWidth:{front:2.5,back:2},dashArray:{reverse:{front:!0,back:!0},offset:{front:0,back:0},front:[0,0],back:[5,10]}},glowing:{strokeColor:{front:"hsla(0, 100%, 50%, 1)",back:"hsla(0, 100%, 75%, 0.74)"},edgeWidth:5},temp:{fillColor:{front:"hsla(0, 0%, 90%, 0.3)",back:"hsla(0, 0%, 50%, 0.3)"},strokeColor:{front:"hsla(0, 0%, 0%, 1.0)",back:"hsla(0, 0%, 0%, 0.1)"}},nonFree:{fillColor:{front:"hsla(254, 100%, 90%, 0.2)",frontHSLA:{h:254,s:100,l:90,a:.2},back:"hsla(10, 100%, 50%, 0.1)",backHSLA:{h:254,s:100,l:50,a:.2}},strokeColor:{front:"hsla(200, 90%, 61%, 1)",back:"hsla(200, 90%, 80%, 1)"},scalePercent:85,dashArray:{reverse:{front:!0,back:!0},offset:{front:0,back:0},front:[0,0],back:[5,10]}}},ellipse:{showLabelsInitially:!1,maxLabelDistance:.08,initialLabelOffset:.02,defaultLabelMode:Xi.NameOnly,minimumAngleSumDifference:.01,minimumCreationDistance:.025,numPoints:100,hitIdealDistance:.03,dynamicBackStyle:!0,drawn:{fillColor:{front:"hsla(254, 100%, 90%, 0.2)",frontHSLA:{h:254,s:100,l:90,a:.2},back:"hsla(10, 100%, 50%, 0.1)",backHSLA:{h:254,s:100,l:50,a:.1}},strokeColor:{front:"hsla(217, 90%, 61%, 1)",back:"hsla(217, 90%, 80%, 1)"},strokeWidth:{front:2.5,back:2},dashArray:{reverse:{front:!0,back:!0},offset:{front:0,back:0},front:[0,0],back:[5,10]}},glowing:{strokeColor:{front:"hsla(0, 100%, 50%, 1)",back:"hsla(0, 100%, 75%, 0.74)"},edgeWidth:5},temp:{fillColor:{front:"hsla(0, 0%, 90%, 0.3)",back:"hsla(0, 0%, 50%, 0.3)"},strokeColor:{front:"hsla(0, 0%, 0%, 1.0)",back:"hsla(0, 0%, 0%, 0.1)"}},nonFree:{fillColor:{front:"hsla(254, 100%, 90%, 0.2)",frontHSLA:{h:254,s:100,l:90,a:.2},back:"hsla(10, 100%, 50%, 0.1)",backHSLA:{h:254,s:100,l:50,a:.2}},strokeColor:{front:"hsla(200, 90%, 61%, 1)",back:"hsla(200, 90%, 80%, 1)"},scalePercent:85,dashArray:{reverse:{front:!0,back:!0},offset:{front:0,back:0},front:[0,0],back:[5,10]}}},parametric:{showLabelsInitially:!1,maxLabelDistance:.08,initialLabelOffset:.02,defaultLabelMode:Xi.NameOnly,minimumAngleSumDifference:1e-4,minimumCreationDistance:.025,numPoints:30,evenSphereSampleSize:90,hitIdealDistance:.03,dynamicBackStyle:!0,drawn:{fillColor:{front:"hsla(254, 100%, 90%, 0.2)",back:"hsla(10, 100%, 50%, 0.1)"},strokeColor:{front:"hsla(217, 90%, 61%, 1)",back:"hsla(217, 90%, 80%, 1)"},strokeWidth:{front:2.5,back:2},dashArray:{reverse:{front:!0,back:!0},offset:{front:0,back:0},front:[0,0],back:[5,10]}},glowing:{strokeColor:{front:"hsla(0, 100%, 50%, 1)",back:"hsla(0, 100%, 75%, 0.74)"},edgeWidth:5},temp:{fillColor:{front:"hsla(0, 0%, 90%, 0.3)",back:"hsla(0, 0%, 50%, 0.3)"},strokeColor:{front:"hsla(0, 0%, 0%, 1.0)",back:"hsla(0, 0%, 0%, 0.1)"}}},polygon:{initialValueDisplayMode:Ni.MultipleOfPi,showLabelsInitially:!1,maxLabelDistance:.08,initialLabelOffset:.02,minimumVertexToEdgeThickness:.004,defaultLabelMode:Xi.NameOnly,numPoints:60,measuringChangesLabelModeTo:Xi.NameAndValue,numberOfTemporaryAngleMarkers:15,dynamicBackStyle:!0,drawn:{fillColor:{front:"hsla(254, 100%, 90%, 0.6)",frontHSLA:{h:254,s:100,l:90,a:.6},back:"hsla(10, 100%, 50%, 0.1)",backHSLA:{h:10,s:100,l:50,a:.2}}}},label:{maxLabelDisplayCaptionLength:1e3,maxLabelDisplayTextLength:8,textScalePercent:100,dynamicBackStyle:!0,fontSize:15,fillColor:{front:"hsla(0, 0%, 0%, 1.0)",frontHSLA:{h:0,s:0,l:0,a:1},back:"hsla(0, 0%, 0%, 0.1)",backHSLA:{h:0,s:0,l:0,a:1}},style:"normal",family:"sans/-serif",decoration:"none",rotation:0,glowingStrokeWidth:{front:3,back:3},glowingStrokeColor:{front:"hsla(0, 0%, 70%, 1)",back:"hsla(0, 0%, 85%, 1)"}},angleMarker:{initialValueDisplayMode:Ni.DegreeDecimals,showLabelsInitially:!0,maxLabelDistance:.25,initialLabelOffset:.2,defaultLabelMode:Xi.ValueOnly,turnOffVertexLabelOnCreation:!0,maxGapLengthOrDashLength:2,sliderStepSize:.1,defaultTickMark:!1,defaultDoubleArc:!1,defaultRadius:.08,numCirclePoints:50,numEdgePoints:26,numBoundaryCirclePoints:10,hitIdealDistance:.03,dynamicBackStyle:!0,radiusScalePercent:100,doubleArcGap:.05,arrowHeadTipAngleInner:28*Math.PI/180,arrowHeadRearAngleInner:70*Math.PI/180,arrowHeadTipAngleOuter:28*Math.PI/180,arrowHeadRearAngleOuter:70*Math.PI/180,arrowHeadLength:.01,arrowHeadDisplay:!0,drawn:{fillColor:{front:"hsla(254, 100%, 90%, 0.5)",frontHSLA:{h:254,s:100,l:90,a:.5},back:"hsla(10, 100%, 50%, 0.4)",backHSLA:{h:10,s:100,l:50,a:.4}},strokeColor:{front:"hsla(0, 0%, 0%, 1)",back:"hsla(0, 0%, 0%, 0.3)"},strokeWidth:{circular:{front:4,back:3},straight:{front:2,back:1}},dashArray:{reverse:{front:!0,back:!0},offset:{front:0,back:0},front:[0,0],back:[0,0]}},glowing:{strokeColor:{front:"hsla(0, 100%, 50%, 1)",back:"hsla(0, 100%, 75%, 0.75)"},circular:{edgeWidth:5},straight:{edgeWidth:2}},temp:{fillColor:{front:"hsla(340, 0%, 50%, 0.4)",back:"hsla(0, 0%, 50%, 0.3)"},strokeColor:{front:"hsla(0, 0%, 0%, 0.6)",back:"hsla(0, 0%, 0%, 0.4)"}}},icons:{defaultIconSize:32,defaultInlineIconSize:25,boundaryCircle:{strokeWidth:1.5,color:"hsla(0, 0%, 0%, 1)"},emphasize:{angleMarker:{strokeWidth:{front:2.5,back:2.5},edgeColor:{front:"hsla(0, 0%, 0%, 1)",back:"hsla(0, 0%, 0%, 0.3)"},fillColor:{front:"hsla(254, 100%, 90%, 1)",back:"hsla(10,100%, 50%, 1)"}},circle:{strokeWidth:{front:1,back:1},edgeColor:{front:"hsla(0, 0%, 0%, 1)",back:"hsla(0, 0%, 0%, 1)"},fillColor:{front:"hsla(0, 100%, 75%, 1)",back:"hsla(0, 100%, 75%, 1)"}},ellipse:{strokeWidth:{front:1,back:1},edgeColor:{front:"hsla(0, 0%, 0%, 1)",back:"hsla(0, 0%, 0%, 1)"},fillColor:{front:"hsla(0, 100%, 75%, 1)",back:"hsla(0, 100%, 75%, 1)"}},point:{strokeWidth:{front:.7,back:.7},edgeColor:{front:"hsla(0, 0%, 0%, 1)",back:"hsla(0, 0%, 0%, 1)"},fillColor:{front:"hsla(0, 100%, 75%, 1)",back:"hsla(0, 100%, 75%, 1)"}},line:{strokeWidth:{front:1.5,back:1.5},edgeColor:{front:"hsla(217, 90%, 61%, 1)",back:"hsla(217, 90%, 80%, 1)"}},segment:{strokeWidth:{front:1.5,back:1.5},edgeColor:{front:"hsla(217, 90%, 61%, 1)",back:"hsla(217, 90%, 80%, 1)"}}},normal:{angle:{scale:{front:7,back:5},strokeWidth:{front:1,back:1},edgeColor:{front:"hsla(0, 0%, 40%, 1)",back:"hsla(0, 0%, 60%, 1)"},fillColor:{front:"hsla(0, 0%, 90%, 0.4)",back:"hsla(0, 0%, 100%, 0.2)"}},circle:{strokeWidth:{front:1,back:1},edgeColor:{front:"hsla(0, 0%, 40%, 1)",back:"hsla(0, 0%, 60%, 1)"},fillColor:{front:"hsla(0, 0%, 90%, 0.4)",back:"hsla(0, 0%, 100%, 0.2)"}},ellipse:{strokeWidth:{front:1,back:1},edgeColor:{front:"hsla(0, 0%, 40%, 1)",back:"hsla(0, 0%, 60%, 1)"},fillColor:{front:"hsla(0, 0%, 90%, 0.4)",back:"hsla(0, 0%, 100%, 0.2)"}},point:{scale:{front:7,back:9},strokeWidth:{front:.8,back:.7},edgeColor:{front:"hsla(0, 0%, 40%, 1)",back:"hsla(0, 0%, 60%, 1)"},fillColor:{front:"hsla(0, 0%, 90%, 1)",back:"hsla(0, 0%, 100%, 1)"}},line:{strokeWidth:{front:1,back:1},edgeColor:{front:"hsla(0, 0%, 40%, 1)",back:"hsla(0, 0%, 60%, 1)"}},segment:{strokeWidth:{front:1,back:1},edgeColor:{front:"hsla(0, 0%, 40%, 1)",back:"hsla(0, 0%, 60%, 1)"}}},blank:{props:{emphasizeTypes:[[]],mdiIcon:!1,filePath:"../../icons/iconBlankPaths.svg"}},point:{props:{emphasizeTypes:[["point","front","back"]],mdiIcon:!1,filePath:"../../icons/iconPointPaths.svg"}},line:{props:{mdiIcon:!1,emphasizeTypes:[["line","front","back"],["point","front","back"]],filePath:"../../icons/iconLinePaths.svg"}},segment:{props:{mdiIcon:!1,emphasizeTypes:[["segment","front","back"],["point","front","back"]],filePath:"../../icons/iconSegmentPaths.svg"}},earthLongitude:{props:{mdiIcon:"mdi-longitude",emphasizeTypes:[[]],filePath:""}},circle:{props:{mdiIcon:!1,emphasizeTypes:[["circle","front","back"],["point","front","back"]],filePath:"../../icons/iconCirclePaths.svg"}},earthLatitude:{props:{mdiIcon:"mdi-latitude",emphasizeTypes:[[]],filePath:""}},antipodalPoint:{props:{mdiIcon:!1,emphasizeTypes:[["point","front"]],filePath:"../../icons/iconAntipodalPointPaths.svg"}},earthPoint:{props:{mdiIcon:"mdi-map-marker",emphasizeTypes:[[]],filePath:""}},polar:{props:{mdiIcon:!1,emphasizeTypes:[["point","front"],["line","front"]],filePath:"../../icons/iconPolarPaths.svg"}},perpendicular:{props:{mdiIcon:!1,emphasizeTypes:[["point","front"],["line","front","back"]],filePath:"../../icons/iconPerpendicularPaths.svg"}},tangent:{props:{mdiIcon:!1,emphasizeTypes:[["point","front"],["line","front","back"]],filePath:"../../icons/iconTangentPaths.svg"}},intersect:{props:{mdiIcon:!1,emphasizeTypes:[["point","front"]],filePath:"../../icons/iconIntersectPaths.svg"}},pointOnObject:{props:{mdiIcon:!1,emphasizeTypes:[["point","front"]],filePath:"../../icons/iconPointOnObjectPaths.svg"}},angle:{props:{emphasizeTypes:[["angleMarker","back","front"]],mdiIcon:!1,filePath:"../../icons/iconAnglePaths.svg"}},segmentLength:{props:{mdiIcon:!1,emphasizeTypes:[["segment","back","front"]],filePath:"../../icons/iconSegmentLengthPaths.svg"}},pointDistance:{props:{mdiIcon:!1,emphasizeTypes:[["point","front","back"]],filePath:"../../icons/iconPointDistancePaths.svg"}},ellipse:{props:{mdiIcon:!1,emphasizeTypes:[["point","front","back"]],filePath:"../../icons/iconEllipsePaths.svg"}},parametric:{props:{mdiIcon:!1,emphasizeTypes:[["point","front"],["parametric","front"]],filePath:"../../icons/iconParametricPaths.svg"}},measureTriangle:{props:{mdiIcon:!1,emphasizeTypes:[["point","front"],["angleMarker","back","front"]],filePath:"../../icons/iconMeasureTrianglePaths.svg"}},measurePolygon:{props:{mdiIcon:!1,emphasizeTypes:[["point","front"],["angleMarker","back","front"]],filePath:"../../icons/iconMeasurePolygonPaths.svg"}},midpoint:{props:{mdiIcon:!1,emphasizeTypes:[["segment","front"],["point","front"]],filePath:"../../icons/iconMidpointPaths.svg"}},nSectPoint:{props:{mdiIcon:!1,emphasizeTypes:[["segment","front"],["point","front"]],filePath:"../../icons/iconNSectPointPaths.svg"}},threePointCircle:{props:{mdiIcon:!1,emphasizeTypes:[["point","front"]],filePath:"../../icons/iconThreePointCirclePaths.svg"}},measuredCircle:{props:{mdiIcon:"mdi-swap-horizontal-circle-outline",emphasizeTypes:[["point","front"]],filePath:""}},angleBisector:{props:{mdiIcon:!1,emphasizeTypes:[["line","front","back"],["angleMarker","front"]],filePath:"../../icons/iconAngleBisectorPaths.svg"}},nSectLine:{props:{mdiIcon:!1,emphasizeTypes:[["line","front","back"],["angleMarker","front"]],filePath:"../../icons/iconNSectLinePaths.svg"}},coordinate:{props:{mdiIcon:"mdi-axis-arrow-info",emphasizeTypes:[[]],filePath:""}},delete:{props:{mdiIcon:"mdi-delete",emphasizeTypes:[[]],filePath:""}},hide:{props:{mdiIcon:"mdi-file-hidden",emphasizeTypes:[[]],filePath:""}},iconFactory:{props:{mdiIcon:"mdi-plus",emphasizeTypes:[[]],filePath:""}},move:{props:{mdiIcon:"mdi-cursor-move",emphasizeTypes:[[]],filePath:""}},rotate:{props:{mdiIcon:"mdi-rotate-3d-variant",emphasizeTypes:[[]],filePath:""}},select:{props:{mdiIcon:"mdi-cursor-pointer",emphasizeTypes:[[]],filePath:""}},toggleLabelDisplay:{props:{mdiIcon:"mdi-toggle-switch-off-outline",emphasizeTypes:[[]],filePath:""}},zoomFit:{props:{mdiIcon:"mdi-magnify-scan",emphasizeTypes:[[]],filePath:""}},zoomIn:{props:{mdiIcon:"mdi-magnify-plus-outline",emphasizeTypes:[[]],filePath:""}},zoomOut:{props:{mdiIcon:"mdi-magnify-minus-outline",emphasizeTypes:[[]],filePath:""}},toolsTab:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-tools",filePath:""}},objectsTab:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-format-list-bulleted",filePath:""}},constructionsTab:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-database",filePath:""}},calculationObject:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-calculator-variant",filePath:""}},measurementObject:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-math-compass",filePath:""}},slider:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-slide",filePath:""}},stylePanel:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-palette",filePath:""}},downloadConstruction:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-download",filePath:""}},shareConstruction:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-share-variant",filePath:""}},deleteConstruction:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-trash-can",filePath:""}},cycleNodeValueDisplayMode:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-autorenew",filePath:""}},showNode:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-eye",filePath:""}},hideNode:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-eye-off",filePath:""}},showNodeLabel:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-label-outline",filePath:""}},hideNodeLabel:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-label-off-outline",filePath:""}},deleteNode:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-trash-can-outline",filePath:""}},appSettings:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-cog",filePath:""}},clearConstruction:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-broom",filePath:""}},undo:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-undo",filePath:""}},redo:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-redo",filePath:""}},copyToClipboard:{props:{emphasizeTypes:[[]],mdiIcon:"mdi-content-copy",filePath:""}},translation:{props:{mdiIcon:"mdi-call-made",emphasizeTypes:[[]],filePath:""}},rotation:{props:{mdiIcon:"mdi-screen-rotation",emphasizeTypes:[[]],filePath:""}},pointReflection:{props:{mdiIcon:"mdi-ferris-wheel",emphasizeTypes:[[]],filePath:""}},inversion:{props:{mdiIcon:"mdi-yeast",emphasizeTypes:[[]],filePath:""}},reflection:{props:{mdiIcon:"mdi-mirror",emphasizeTypes:[[]],filePath:""}},transformedPoint:{props:{mdiIcon:"mdi-movie-roll",emphasizeTypes:[[]],filePath:""}},transformedCircle:{props:{mdiIcon:"mdi-movie-roll",emphasizeTypes:[[]],filePath:""}},transformedLine:{props:{mdiIcon:"mdi-movie-roll",emphasizeTypes:[[]],filePath:""}},transformedSegment:{props:{mdiIcon:"mdi-movie-roll",emphasizeTypes:[[]],filePath:""}},transformedEllipse:{props:{mdiIcon:"mdi-movie-roll",emphasizeTypes:[[]],filePath:""}},applyTransformation:{props:{mdiIcon:"mdi-movie-roll",emphasizeTypes:[[]],filePath:""}},notifications:{props:{mdiIcon:"mdi-bell",emphasizeTypes:[[]],filePath:""}}},toolUse:{delay:3e3,display:!0},earthMode:{defaultEarthModeUnits:"km",radiusMiles:3959,radiusKilometers:6371},parameterization:{useNewtonsMethod:!1,subdivisions:80,bisectionMinSize:1e-7,numberOfTestTValues:10,maxNumberOfIterationArcLength:5,maxChangeInArcLength:1e-4},supportedLanguages:[{locale:"en",name:"English"},{locale:"id",name:"Bahasa Indonesia"}]};var st=(t=>(t[t.backgroundAngleMarkersGlowing=0]="backgroundAngleMarkersGlowing",t[t.backgroundAngleMarkers=1]="backgroundAngleMarkers",t[t.backgroundGlowing=2]="backgroundGlowing",t[t.backgroundFills=3]="backgroundFills",t[t.background=4]="background",t[t.backgroundPointsGlowing=5]="backgroundPointsGlowing",t[t.backgroundPoints=6]="backgroundPoints",t[t.backgroundTextGlowing=7]="backgroundTextGlowing",t[t.backgroundText=8]="backgroundText",t[t.midground=9]="midground",t[t.foregroundAngleMarkersGlowing=10]="foregroundAngleMarkersGlowing",t[t.foregroundAngleMarkers=11]="foregroundAngleMarkers",t[t.foregroundGlowing=12]="foregroundGlowing",t[t.foregroundFills=13]="foregroundFills",t[t.foreground=14]="foreground",t[t.foregroundPointsGlowing=15]="foregroundPointsGlowing",t[t.foregroundPoints=16]="foregroundPoints",t[t.foregroundTextGlowing=17]="foregroundTextGlowing",t[t.foregroundText=18]="foregroundText",t))(st||{});let CN=0;const li=class li{constructor(){y(this,"_parents",[]);y(this,"_kids",[]);y(this,"ref");y(this,"tmpVec1",new k);y(this,"tmpVec2",new k);y(this,"id");y(this,"name","");y(this,"_exists",!0);y(this,"_showing",!0);y(this,"_selected",!1);y(this,"_outOfDate",!1);this.id=CN++}static resetAllCounters(){CN=0,li.POINT_COUNT=0,li.LINE_COUNT=0,li.SEGMENT_COUNT=0,li.ANGLEMARKER_COUNT=0,li.CIRCLE_COUNT=0,li.EXPR_COUNT=0,li.ELLIPSE_COUNT=0,li.PARAMETRIC_COUNT=0,li.LABEL_COUNT=0,li.POLYGON_COUNT=0,li.TRANSFORMATION_COUNT=0,li.TRANSLATION_COUNT=0,li.ROTATION_COUNT=0,li.REFLECTION_COUNT=0,li.INVERSION_COUNT=0,li.POINT_REFLECTION_COUNT=0,li.VISIBLE_POINT_COUNT=0}static setGlobalStore(e){li.store=e}updatePlottableStyle(e,i){var n;console.debug(`updatePlottableStyle of ${this.name} ==> ${this.ref}`),(n=this.ref)==null||n.updateStyle(e,i)}markKidsOutOfDate(){this._kids.forEach(e=>{e.setOutOfDate(!0),e.markKidsOutOfDate()})}canUpdateNow(){return!this._parents.some(e=>e.isOutOfDate())}updateKids(e,i){const n=[];this._kids.forEach((r,s)=>{r.canUpdateNow()&&n.push(s)});for(let r=0;r<n.length;r++)this._kids[n[r]].update(e,i)}addParent(e){this._parents.push(e)}removeParent(e){const i=this._parents.findIndex(n=>n.id===e.id);i>=0&&this._parents.splice(i,1)}addKid(e){this._kids.push(e)}removeKid(e){const i=this._kids.findIndex(n=>n.id===e.id);i>=0&&this._kids.splice(i,1)}registerChild(e){this.addKid(e),e.addParent(this)}unregisterChild(e){this.removeKid(e),e.removeParent(this)}removeThisNode(){for(this._parents.forEach(e=>{e.unregisterChild(this)});this._kids.length>0;)this._kids[0].removeThisNode()}setOutOfDate(e){this._outOfDate=e}isOutOfDate(){return this._outOfDate}isPointOnOneDimensional(){return!1}isFreePoint(){return!1}isNonFreePoint(){return!1}isPoint(){return!1}isNonFreeLine(){return!1}isLabel(){return!1}isOneDimensional(){return!1}isLabelable(){return!1}isSegmentOfLengthPi(){return!1}isLineWithAntipodalPoints(){return!1}isFreeToMove(){return this.isFreePoint()||this.isPointOnOneDimensional()||this.isLabel()||this.isSegmentOfLengthPi()||this.isLineWithAntipodalPoints()?!0:this.isNonFreeLine()||this.isNonFreePoint()||this.isNonFreeCircle()||this.isNonFreeSegment()||this.isNonFreeEllipse()?!1:this._parents.every(e=>e.isFreePoint())}isMeasurable(){return!1}isNonFreeCircle(){return!1}isNonFreeSegment(){return!1}isNonFreeEllipse(){return!1}isTransformation(){return!1}isPolygon(){return!1}set exists(e){this._exists=e}get exists(){return this._exists}get kids(){return this._kids}get parents(){return this._parents}set showing(e){var i;this._showing=e,(i=this.ref)==null||i.setVisible(e)}get showing(){return this._showing}set glowing(e){var i,n;this._showing&&(e?(i=this.ref)==null||i.glowingDisplay():(n=this.ref)==null||n.normalDisplay())}set selected(e){var i,n;console.log("SENodule::selected() arg",e),this._showing&&(this._selected=e,e?(i=this.ref)==null||i.glowingDisplay():(n=this.ref)==null||n.normalDisplay())}get selected(){return this._selected}static closestVectorParametrically(e,i,n,r,s){const o=function(u){return Math.acos(Math.max(Math.min(e(u).dot(n),1),-1))},a=function(u){return i(u).dot(n)};let l;s!==void 0?l=function(u){return s(u).dot(n)}:l=void 0;const c=this.findZerosParametrically(a,r,l);if(c.length>0){let u=c[0];return c.forEach(d=>{o(d)<o(u)&&(u=d)}),{vector:e(u),tVal:u}}else{const u=r[0],h=r[r.length-1],d=o(u),f=o(h);return d<f?{vector:e(u),tVal:d}:{vector:e(u),tVal:f}}}get visiblePointCount(){return li.VISIBLE_POINT_COUNT}decrementVisiblePointCount(){li.VISIBLE_POINT_COUNT--}incrementVisiblePointCount(){li.VISIBLE_POINT_COUNT++}static bisection(e,i,n){let r=e(i);e(n);let s;for(;Math.abs(n-i)>=S.parameterization.bisectionMinSize;){s=(i+n)/2;const o=e(s);if(Math.abs(o)<S.tolerance/1e3)return s;r*o<0?n=s:(i=s,r=o)}return(i+n)/2}static getNormalsToPerpendicularLinesThruParametrically(e,i,n,r,s){const o=function(u){return i(u).dot(n)};let a;return s!==void 0?a=function(u){return s(u).dot(n)}:a=void 0,this.findZerosParametrically(o,r,a).map(u=>({normal:i(u).clone().normalize(),normalAt:e(u).clone().normalize()})).filter(u=>!u.normal.isZero())}static getNormalsToTangentLinesThruParametrically(e,i,n,r,s){const o=function(c){const u=new k;return u.crossVectors(e(c),n),u.dot(i(c))};let a;return s!==void 0?a=function(c){const u=new k;return u.crossVectors(e(c),s(c)),u.dot(n)}:a=void 0,this.findZerosParametrically(o,r,a).map(c=>{const u=new k;return u.copy(e(c).cross(n)),{normal:u,tangentAt:e(c).clone()}})}static findZerosParametrically(e,i,n){const r=[],s=[];Math.abs(e(i[0]))<S.tolerance/1e3&&s.push(i[0]);for(let o=1;o<i.length;o++)Math.abs(e(i[o]))<S.tolerance/1e3?s.push(i[o]):e(i[o-1])*e(i[o])<0&&r.push(o-1);return r.length===0&&s.length===0?[]:(r.forEach(o=>{try{if(!(S.parameterization.useNewtonsMethod&&n!==void 0)){const a=li.bisection(e,i[o],i[o+1]);typeof a=="number"&&s.push(a)}}catch(a){console.debug("Newton's method error",a)}}),s)}};y(li,"POINT_COUNT",0),y(li,"SEGMENT_COUNT",0),y(li,"LINE_COUNT",0),y(li,"CIRCLE_COUNT",0),y(li,"ANGLEMARKER_COUNT",0),y(li,"EXPR_COUNT",0),y(li,"ELLIPSE_COUNT",0),y(li,"PARAMETRIC_COUNT",0),y(li,"LABEL_COUNT",0),y(li,"POLYGON_COUNT",0),y(li,"TRANSFORMATION_COUNT",0),y(li,"TRANSLATION_COUNT",0),y(li,"ROTATION_COUNT",0),y(li,"REFLECTION_COUNT",0),y(li,"INVERSION_COUNT",0),y(li,"POINT_REFLECTION_COUNT",0),y(li,"VISIBLE_POINT_COUNT",0),y(li,"store"),y(li,"unregisteredSEPointNorthPole"),y(li,"unregisteredSEPointSouthPole");let Xe=li;const kae={headingNames:{allToolsName:t=>{const{normalize:e}=t;return e(["All Tools"])},topLeftCorner:t=>{const{normalize:e}=t;return e(["Top-Left Corner"])},topRightCorner:t=>{const{normalize:e}=t;return e(["Top-Right Corner"])},bottomLeftCorner:t=>{const{normalize:e}=t;return e(["Bottom-Left Corner"])},bottomRightCorner:t=>{const{normalize:e}=t;return e(["Bottom-Right Corner"])}},account:{createError:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Unable to create a new account: ",i(n("error"))])},emailNotVerified:t=>{const{normalize:e}=t;return e(["Your account is not yet verified. Please check your email"])},emailVerification:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Verification email has been sent to ",i(n("emailAddr"))])},loginError:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Unable to login: ",i(n("error"))])},passwordReset:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Check your email (",i(n("emailAddr")),") to reset password"])}},main:{ConstructionsTabToolTip:t=>{const{normalize:e}=t;return e(["Saved Constructions"])},ObjectsTabToolTip:t=>{const{normalize:e}=t;return e(["Objects"])},SphericalEaselMainTitle:t=>{const{normalize:e}=t;return e(["Spherical Easel"])},ToolsTabToolTip:t=>{const{normalize:e}=t;return e(["Tools"])}},toolGroups:{EditTools:t=>{const{normalize:e}=t;return e(["Edit Tools"])},DisplayTools:t=>{const{normalize:e}=t;return e(["Display Tools"])},BasicTools:t=>{const{normalize:e}=t;return e(["Basic Tools"])},ConicTools:t=>{const{normalize:e}=t;return e(["Conic Tools"])},ConstructionTools:t=>{const{normalize:e}=t;return e(["Construction Tools"])},AdvancedTools:t=>{const{normalize:e}=t;return e(["Advanced Tools"])},TransformationTools:t=>{const{normalize:e}=t;return e(["Transformational Tools"])},MeasurementTools:t=>{const{normalize:e}=t;return e(["Measurement Tools"])},MeasuredObjectTools:t=>{const{normalize:e}=t;return e(["Measured Objects Tools"])},DeveloperOnlyTools:t=>{const{normalize:e}=t;return e(["Developer Only Tools"])}},buttons:{CurrentTool:t=>{const{normalize:e}=t;return e(["Current Tool"])},NoToolSelected:t=>{const{normalize:e}=t;return e(["No Tool Selected"])},RedoLastActionDisplayedName:t=>{const{normalize:e}=t;return e(["Redo Action"])},RedoLastActionToolTipMessage:t=>{const{normalize:e}=t;return e(["Redo the last action"])},RedoLastActionToolUseMessage:t=>{const{normalize:e}=t;return e(["Click to redo your last action"])},UndoLastActionDisplayedName:t=>{const{normalize:e}=t;return e(["Undo Action"])},UndoLastActionToolTipMessage:t=>{const{normalize:e}=t;return e(["Undo the last action"])},UndoLastActionToolUseMessage:t=>{const{normalize:e}=t;return e(["Click to undo your last action"])},MeasureTriangleDisplayedName:t=>{const{normalize:e}=t;return e(["Measure Triangle"])},MeasureTriangleToolTipMessage:t=>{const{normalize:e}=t;return e(["Measure the angles and sides of a triangle."])},MeasureTriangleToolUseMessage:t=>{const{normalize:e}=t;return e(["Select three line segments that make a triangle."])},MeasurePolygonDisplayedName:t=>{const{normalize:e}=t;return e(["Measure Polygon"])},MeasurePolygonToolTipMessage:t=>{const{normalize:e}=t;return e(["Measure the angles and sides of a polygon."])},MeasurePolygonToolUseMessage:t=>{const{normalize:e}=t;return e(["Select three or more line segments that make a polygon with out crossing."])},CreateAngleDisplayedName:t=>{const{normalize:e}=t;return e(["Measure Angle"])},CreateAngleToolTipMessage:t=>{const{normalize:e}=t;return e(["Calculate Angle"])},CreateAngleToolUseMessage:t=>{const{normalize:e}=t;return e(["Select two lines/segments or three points to calculate an angle."])},CreateAntipodalPointDisplayedName:t=>{const{normalize:e}=t;return e(["Antipodal Point"])},CreateAntipodalPointToolTipMessage:t=>{const{normalize:e}=t;return e(["Create Antipode"])},CreateAntipodalPointToolUseMessage:t=>{const{normalize:e}=t;return e(["Select a location to create a point (if necessary) and its antipode"])},CreatePolarDisplayedName:t=>{const{normalize:e}=t;return e(["Polar"])},CreatePolarToolTipMessage:t=>{const{normalize:e}=t;return e(["Create polar line or polar points"])},CreatePolarToolUseMessage:t=>{const{normalize:e}=t;return e(["Select a location to create a point (if necessary) and its polar line or select a line segment or line to create both polar points"])},CreateMidpointDisplayedName:t=>{const{normalize:e}=t;return e(["Midpoint"])},CreateMidpointToolTipMessage:t=>{const{normalize:e}=t;return e(["Create the midpoint of a line segment."])},CreateMidpointToolUseMessage:t=>{const{normalize:e}=t;return e(["Select a line segment to create its midpoint."])},CreateAngleBisectorDisplayedName:t=>{const{normalize:e}=t;return e(["Angle Bisector"])},CreateAngleBisectorToolTipMessage:t=>{const{normalize:e}=t;return e(["Create the angle bisector of a measured angle."])},CreateAngleBisectorToolUseMessage:t=>{const{normalize:e}=t;return e(["You must first measure an angle with the Measure Angle tool and then select it to create its bisector."])},CreateNSectAngleDisplayedName:t=>{const{normalize:e}=t;return e(["N-Sect Angle"])},CreateNSectAngleToolTipMessage:t=>{const{normalize:e}=t;return e(["Divide an angle into N equal pieces."])},CreateNSectAngleToolUseMessage:t=>{const{normalize:e}=t;return e(["Use a number key to select a number then select an angle to divide into that many equal pieces."])},CreateNSectSegmentDisplayedName:t=>{const{normalize:e}=t;return e(["N-Sect Segment"])},CreateNSectSegmentToolTipMessage:t=>{const{normalize:e}=t;return e(["Divide a line segment into N equal pieces."])},CreateNSectSegmentToolUseMessage:t=>{const{normalize:e}=t;return e(["Use a number key to select a number then select a line segment to divide into that many equal pieces."])},CreateThreePointCircleDisplayedName:t=>{const{normalize:e}=t;return e(["Three Point Circle"])},CreateThreePointCircleToolTipMessage:t=>{const{normalize:e}=t;return e(["Create a circle from three points."])},CreateThreePointCircleToolUseMessage:t=>{const{normalize:e}=t;return e(["Select three points (not all the same or antipodal) to create the circle through them."])},CreateCircleDisplayedName:t=>{const{normalize:e}=t;return e(["Create Circle"])},CreateCircleToolTipMessage:t=>{const{normalize:e}=t;return e(["Insert circle"])},CreateCircleToolUseMessage:t=>{const{normalize:e}=t;return e(["Click to insert a circle with a given center point and through a second point."])},CreateCoordinateDisplayedName:t=>{const{normalize:e}=t;return e(["Coordinates"])},CreateCoordinateToolTipMessage:t=>{const{normalize:e}=t;return e(["Measure x,y,z coordinates"])},CreateCoordinateToolUseMessage:t=>{const{normalize:e}=t;return e(["Select a point to measure its x,y,z coordinates on the sphere"])},CreateEllipseDisplayedName:t=>{const{normalize:e}=t;return e(["Ellipse"])},CreateEllipseToolTipMessage:t=>{const{normalize:e}=t;return e(["Insert ellipse"])},CreateEllipseToolUseMessage:t=>{const{normalize:e}=t;return e(["Select two distinct non-antipodal points and another point on the ellipse"])},CreateTranslationDisplayedName:t=>{const{normalize:e}=t;return e(["Create Translation"])},CreateTranslationToolTipMessage:t=>{const{normalize:e}=t;return e(["Create a translation mapping."])},CreateTranslationToolUseMessage:t=>{const{normalize:e}=t;return e(["Create a translation mapping object by selecting a line segment or line to translate along and then a measurement or measurable object to determine the length of translation."])},CreateRotationDisplayedName:t=>{const{normalize:e}=t;return e(["Create Rotation"])},CreateRotationToolTipMessage:t=>{const{normalize:e}=t;return e(["Create a rotation mapping."])},CreateRotationToolUseMessage:t=>{const{normalize:e}=t;return e(["Create a rotation transformation object by selecting a point to rotate about and then a measurement or measurable object to determine the angle of rotation."])},CreatePointReflectionDisplayedName:t=>{const{normalize:e}=t;return e(["Create Point Reflection"])},CreatePointReflectionToolTipMessage:t=>{const{normalize:e}=t;return e(["Create a point reflection mapping."])},CreatePointReflectionToolUseMessage:t=>{const{normalize:e}=t;return e(["Create a point reflection transformation object by selecting a point to reflect through."])},CreateReflectionDisplayedName:t=>{const{normalize:e}=t;return e(["Create Reflection"])},CreateReflectionToolTipMessage:t=>{const{normalize:e}=t;return e(["Create a reflection mapping."])},CreateReflectionToolUseMessage:t=>{const{normalize:e}=t;return e(["Create a reflection transformation object by selecting a line or line segment to reflect through."])},CreateInversionDisplayedName:t=>{const{normalize:e}=t;return e(["Create Inversion"])},CreateInversionToolTipMessage:t=>{const{normalize:e}=t;return e(["Create a inversion mapping."])},CreateInversionToolUseMessage:t=>{const{normalize:e}=t;return e(["Create a inversion transformation object by selecting a circle to invert over."])},ApplyTransformationDisplayedName:t=>{const{normalize:e}=t;return e(["Apply Transformation"])},ApplyTransformationToolTipMessage:t=>{const{normalize:e}=t;return e(["Apply a transformation."])},ApplyTransformationToolUseMessage:t=>{const{normalize:e}=t;return e(["Apply a transformation by first selecting transformation object and then selecting geometric objects to apply it to."])},CreateMeasuredCircleDisplayedName:t=>{const{normalize:e}=t;return e(["Measured Circle"])},CreateMeasuredCircleToolTipMessage:t=>{const{normalize:e}=t;return e(["Insert Measured Circle"])},CreateMeasuredCircleToolUseMessage:t=>{const{normalize:e}=t;return e(["Select a center point and a measurement or measurable object to determine the radius."])},CreateIntersectionDisplayedName:t=>{const{normalize:e}=t;return e(["Intersection Point(s)"])},CreateIntersectionToolTipMessage:t=>{const{normalize:e}=t;return e(["Intersect two one-dimensional objects"])},CreateIntersectionToolUseMessage:t=>{const{normalize:e}=t;return e(["Select two one-dimensional objects to create their intersection point(s)."])},CreateLineSegmentDisplayedName:t=>{const{normalize:e}=t;return e(["Create Line Segment"])},CreateLineSegmentToolTipMessage:t=>{const{normalize:e}=t;return e(["Insert line segment"])},CreateLineSegmentToolUseMessage:t=>{const{normalize:e}=t;return e(["Click to insert line segment defined by two points."])},CreateLineDisplayedName:t=>{const{normalize:e}=t;return e(["Create Line"])},CreateLineToolTipMessage:t=>{const{normalize:e}=t;return e(["Insert line"])},CreateLineToolUseMessage:t=>{const{normalize:e}=t;return e(["Click to insert a line defined by two points."])},CreatePointDistanceDisplayedName:t=>{const{normalize:e}=t;return e(["Point Distance"])},CreatePointDistanceToolTipMessage:t=>{const{normalize:e}=t;return e(["Distance of Two Points"])},CreatePointDistanceToolUseMessage:t=>{const{normalize:e}=t;return e(["Select two points to measure the distance between them"])},CreatePointOnOneDimDisplayedName:t=>{const{normalize:e}=t;return e(["Point On Object"])},CreatePointOnOneDimToolTipMessage:t=>{const{normalize:e}=t;return e(["Select a one-dimensional object to place a point on"])},CreatePointOnOneDimToolUseMessage:t=>{const{normalize:e}=t;return e(["Select a one-dimensional object to add a point to."])},CreatePointDisplayedName:t=>{const{normalize:e}=t;return e(["Create Point"])},CreatePointToolTipMessage:t=>{const{normalize:e}=t;return e(["Insert point"])},CreatePointToolUseMessage:t=>{const{normalize:e}=t;return e(["Click to insert a free point."])},CreateSegmentLengthDisplayedName:t=>{const{normalize:e}=t;return e(["Line Segment Length"])},CreateSegmentLengthToolTipMessage:t=>{const{normalize:e}=t;return e(["Length of Line Segment"])},CreateSegmentLengthToolUseMessage:t=>{const{normalize:e}=t;return e(["Click this button to compute the length of Line Segment"])},CreateSliderDisplayedName:t=>{const{normalize:e}=t;return e(["Measurement Slider"])},CreateSliderToolTipMessage:t=>{const{normalize:e}=t;return e(["User Controlled Value"])},CreateSliderToolUseMessage:t=>{const{normalize:e}=t;return e(["Click this button to create a value slider "])},CreateTangentDisplayedName:t=>{const{normalize:e}=t;return e(["Tangents"])},CreateTangentToolTipMessage:t=>{const{normalize:e}=t;return e(["Tangents through a point"])},CreateTangentToolUseMessage:t=>{const{normalize:e}=t;return e(["Create the tangent lines to a selected non-straight one-dimensional object and selected location."])},CreatePerpendicularDisplayedName:t=>{const{normalize:e}=t;return e(["Perpendicular"])},CreatePerpendicularToolTipMessage:t=>{const{normalize:e}=t;return e(["Perpendicular(s) through a point"])},CreatePerpendicularToolUseMessage:t=>{const{normalize:e}=t;return e(["Create the perpendicular line(s) to a selected one-dimensional object and selected location."])},DeleteDisplayedName:t=>{const{normalize:e}=t;return e(["Delete"])},DeleteToolTipMessage:t=>{const{normalize:e}=t;return e(["Delete Objects"])},DeleteToolUseMessage:t=>{const{normalize:e}=t;return e(["Select objects to delete. Hold the SHIFT key to select from the back of the sphere."])},HideDisplayedName:t=>{const{normalize:e}=t;return e(["Hide Objects"])},HideObjectToolTipMessage:t=>{const{normalize:e}=t;return e(["Hide objects"])},HideObjectToolUseMessage:t=>{const{normalize:e}=t;return e(["Select objects to hide. Hold the SHIFT key to select from the back of the sphere."])},MoveDisplayedName:t=>{const{normalize:e}=t;return e(["Move Objects"])},MoveObjectToolTipMessage:t=>{const{normalize:e}=t;return e(["Move object"])},MoveObjectToolUseMessage:t=>{const{normalize:e}=t;return e(["Click and drag an object to move it. Movable objects include labels, free points, and line segments with antipodal endpoints. Hold the SHIFT key to select from the back of the sphere."])},PanZoomInDisplayedName:t=>{const{normalize:e}=t;return e(["Zoom In/Pan"])},PanZoomInToolTipMessage:t=>{const{normalize:e}=t;return e(["Pan or Zoom In"])},PanZoomInToolUseMessage:t=>{const{normalize:e}=t;return e(["Click to zoom in at the location of the mouse. Click and drag to pan the current view."])},PanZoomOutDisplayedName:t=>{const{normalize:e}=t;return e(["Zoom Out/Pan"])},PanZoomOutToolTipMessage:t=>{const{normalize:e}=t;return e(["Pan or Zoom Out"])},PanZoomOutToolUseMessage:t=>{const{normalize:e}=t;return e(["Click to zoom out at the location of the mouse. Click and drag to pan the current view."])},ZoomFitDisplayedName:t=>{const{normalize:e}=t;return e(["Zoom Fit"])},ZoomFitToolTipMessage:t=>{const{normalize:e}=t;return e(["Zoom Fit"])},ZoomFitToolUseMessage:t=>{const{normalize:e}=t;return e(["Fits the sphere in the available space."])},RotateDisplayedName:t=>{const{normalize:e}=t;return e(["Rotate Sphere"])},RotateSphereToolTipMessage:t=>{const{normalize:e}=t;return e(["Rotate Sphere"])},RotateSphereToolUseMessage:t=>{const{normalize:e}=t;return e(["Click and drag to rotate the sphere."])},SelectDisplayedName:t=>{const{normalize:e}=t;return e(["Select Objects"])},SelectToolTipMessage:t=>{const{normalize:e}=t;return e(["Select Objects"])},SelectToolUseMessage:t=>{const{normalize:e}=t;return e(["Click on objects to select them, hold the Alt/Option key to add to your selection."])},ToggleLabelDisplayedName:t=>{const{normalize:e}=t;return e(["Toggle Label Display"])},ToggleLabelToolTipMessage:t=>{const{normalize:e}=t;return e(["Toggle Display Of Labels"])},ToggleLabelToolUseMessage:t=>{const{normalize:e}=t;return e(["Click on objects to toggle the display of their labels."])},CreateIconDisplayedName:t=>{const{normalize:e}=t;return e(["Create Icon"])},CreateIconToolTipMessage:t=>{const{normalize:e}=t;return e(["Create Icon SVG Paths"])},CreateIconToolUseMessage:t=>{const{normalize:e}=t;return e(["Click to create an the SVG paths for an icon from current view."])},ResetSphereActionDisplayedName:t=>{const{normalize:e}=t;return e(["Clear Canvas"])},ResetSphereActionToolTipMessage:t=>{const{normalize:e}=t;return e(["Clear the canvas"])},ResetSphereActionToolUseMessage:t=>{const{normalize:e}=t;return e(["Click to clear the canvas of all drawings"])},"":t=>{const{normalize:e}=t;return e([])}},settings:{title:t=>{const{normalize:e}=t;return e(["Preferences"])}},objects:{objects:t=>{const{normalize:e,plural:i}=t;return i([e(["Objects"]),e(["Object"]),e(["object"]),e(["objects"])])},points:t=>{const{normalize:e,plural:i}=t;return i([e(["Points"]),e(["Point"]),e(["point"]),e(["points"])])},lines:t=>{const{normalize:e,plural:i}=t;return i([e(["Lines"]),e(["Line"]),e(["line"]),e(["lines"])])},circles:t=>{const{normalize:e,plural:i}=t;return i([e(["Circles"]),e(["Circle"]),e(["circle"]),e(["circles"])])},segments:t=>{const{normalize:e,plural:i}=t;return i([e(["Line Segments"]),e(["Line Segment"]),e(["line segment"]),e(["line segments"])])},measurements:t=>{const{normalize:e,plural:i}=t;return i([e(["Measurements"]),e(["Measurement"]),e(["measurement"]),e(["measurements"])])},calculations:t=>{const{normalize:e,plural:i}=t;return i([e(["Calculations"]),e(["Calculation"]),e(["calculation"]),e(["calculations"])])},transformations:t=>{const{normalize:e,plural:i}=t;return i([e(["Transformations"]),e(["Transformation"]),e(["transformation"]),e(["transformations"])])},ellipses:t=>{const{normalize:e,plural:i}=t;return i([e(["Ellipses"]),e(["Ellipse"]),e(["ellipse"]),e(["ellipses"])])},parametrics:t=>{const{normalize:e,plural:i}=t;return i([e(["Parametrics"]),e(["Parametric"]),e(["parametric"]),e(["parametrics"])])},triangles:t=>{const{normalize:e,plural:i}=t;return i([e(["Triangles"]),e(["Triangle"]),e(["triangle"]),e(["triangles"])])},polygons:t=>{const{normalize:e,plural:i}=t;return i([e(["Polygons"]),e(["Polygon"]),e(["polygon"]),e(["polygons"])])},angleMarkers:t=>{const{normalize:e,plural:i}=t;return i([e(["Angle Markers"]),e(["Angle Marker"]),e(["angle marker"]),e(["angle markers"])])},translations:t=>{const{normalize:e,plural:i}=t;return i([e(["Translations"]),e(["Translation"]),e(["translation"]),e(["translations"])])},rotations:t=>{const{normalize:e,plural:i}=t;return i([e(["Rotations"]),e(["Rotation"]),e(["rotation"]),e(["rotations"])])},reflections:t=>{const{normalize:e,plural:i}=t;return i([e(["Reflections"]),e(["Reflection"]),e(["reflection"]),e(["reflections"])])},pointReflections:t=>{const{normalize:e,plural:i}=t;return i([e(["Point Reflections"]),e(["Point Reflection"]),e(["point reflection"]),e(["point reflections"])])},inversions:t=>{const{normalize:e,plural:i}=t;return i([e(["Inversions"]),e(["Inversion"]),e(["inversion"]),e(["inversions"])])},selectTransformation:t=>{const{normalize:e}=t;return e(["Select A Transformation"])}},style:{back:t=>{const{normalize:e}=t;return e(["Back"])},front:t=>{const{normalize:e}=t;return e(["Front"])},value:t=>{const{normalize:e}=t;return e(["Value"])},frontAndBack:t=>{const{normalize:e}=t;return e(["Front and Back"])},point:t=>{const{normalize:e,interpolate:i,named:n,plural:r}=t;return r([e(["1 Point"]),e([i(n("count"))," Points"])])},line:t=>{const{normalize:e,interpolate:i,named:n,plural:r}=t;return r([e(["1 Line"]),e([i(n("count"))," Lines"])])},segment:t=>{const{normalize:e,interpolate:i,named:n,plural:r}=t;return r([e(["1 Segment"]),e([i(n("count"))," Segments"])])},circle:t=>{const{normalize:e,interpolate:i,named:n,plural:r}=t;return r([e(["1 Circle"]),e([i(n("count"))," Circles"])])},label:t=>{const{normalize:e,interpolate:i,named:n,plural:r}=t;return r([e(["1 Label"]),e([i(n("count"))," Labels"])])},angleMarker:t=>{const{normalize:e,interpolate:i,named:n,plural:r}=t;return r([e(["1 Angle Marker"]),e([i(n("count"))," Angle Markers"])])},ellipse:t=>{const{normalize:e,interpolate:i,named:n,plural:r}=t;return r([e(["1 Ellipse"]),e([i(n("count"))," Ellipses"])])},parametric:t=>{const{normalize:e,interpolate:i,named:n,plural:r}=t;return r([e(["1 Parametric"]),e([i(n("count"))," Parametrics"])])},polygon:t=>{const{normalize:e,interpolate:i,named:n,plural:r}=t;return r([e(["1 Polygon"]),e([i(n("count"))," Polygons"])])},showLabels:t=>{const{normalize:e}=t;return e(["Show Label(s)"])},showObjects:t=>{const{normalize:e}=t;return e(["Show Object(s)"])},noFill:t=>{const{normalize:e}=t;return e(["No Fill"])},noStroke:t=>{const{normalize:e}=t;return e(["No Stroke"])},noFillLabelTip:t=>{const{normalize:e}=t;return e(["If you want to make the labels only appear on the front of the sphere disable automatic back styling and check 'No Fill' on the Label Back Fill Color. Similarly, to make the labels only appear on the back of the sphere disable automatic back styling and check 'No Fill' on the Label Front Fill Color."])},noFillTip:t=>{const{normalize:e}=t;return e(["Check this to remove the fill or stoke from the selected object(s)."])},selectAnObject:t=>{const{normalize:e}=t;return e(["Select Object(s) To Style"])},closeOrSelect:t=>{const{normalize:e}=t;return e(["Close the style panel or select object(s)."])},toSelectObjects:t=>{const{normalize:e}=t;return e(["To select objects:"])},selectionDirection1:t=>{const{normalize:e}=t;return e(["Click on glowing objects to select them."])},selectionDirection2:t=>{const{normalize:e}=t;return e(["Hold the Alt/Option key to add or subtract from your selection."])},selectionDirection3:t=>{const{normalize:e}=t;return e(["Press a number key to select an object at that depth."])},selectionDirection4Mac:t=>{const{normalize:e}=t;return e(["Press the p key and click in any empty location to add all points. Similar for lines (l), line segments (s), circles (c), ellipses (e), angle markers (A), parametrics (P), polygons (O), or all objects (command+a)."])},selectionDirection4PC:t=>{const{normalize:e}=t;return e(["Press the p key and click in any empty location to add all points. Similar for lines (l), line segments (s), circles (c), ellipses (e), angle markers (A), parametrics (P), polygons (O), or all objects (ctrl+a)."])},closeStylingPanel:t=>{const{normalize:e}=t;return e(["Close Style Panel"])},noSelectionToolTip:t=>{const{normalize:e}=t;return e(["No objects are currently selected. Either select objects with the selection tool or click this button to close the style panel."])},labelsNotShowingToolTip:t=>{const{normalize:e}=t;return e(["Not all labels in the current selection are visible. Click this button to make them visible and then they will be styleable."])},objectNotVisible:t=>{const{normalize:e}=t;return e(["Object(s) not visible."])},clickToMakeObjectsVisible:t=>{const{normalize:e}=t;return e(["Click the button below to make all objects visible and then to style them."])},makeObjectsVisible:t=>{const{normalize:e}=t;return e(["Make Object(s) Visible"])},objectsNotShowingToolTip:t=>{const{normalize:e}=t;return e(["Not all objects in the current selection are visible. Click this button to make them visible and then they will be styleable."])},backStyleDifferentValuesToolTip:t=>{const{normalize:e}=t;return e(["The selected objects have different automatic back styling settings. At least one is using automatic back styling and at least is not. Click the button make the automatic back styling the same for all selected objects."])},styleDisagreement:t=>{const{normalize:e}=t;return e(["Common Style Disagreement"])},differentValues:t=>{const{normalize:e}=t;return e(["The selected objects have different values for at least one of these style options. Click the button and edit a style to make all selected objects have that style value in common."])},differentValuesToolTip:t=>{const{normalize:e}=t;return e(["The selected objects have different values for at least one style option. Click the button and edit a style to make *all* selected objects have *all* the styles in this block have a common value(s)."])},singleLabelTextToolTip:t=>{const{normalize:e}=t;return e(["Enter a label text."])},multiLabelTextToolTip:t=>{const{normalize:e}=t;return e(["You cannot edit the text of more than one label at a time."])},dynamicBackStyleHeader:t=>{const{normalize:e}=t;return e(["Automatic Back Styling"])},disableDynamicBackStyle:t=>{const{normalize:e}=t;return e(["Disable"])},enableDynamicBackStyle:t=>{const{normalize:e}=t;return e(["Enable"])},disableDynamicBackStyleToolTip:t=>{const{normalize:e}=t;return e(["The styling of objects on the back of the sphere is handled automatically unless disabled. The automatic style depends on a Global Back Styling Contrast percent and the front styling. The contrast is a global variable and applies to all objects the have Dynamic Back Styling enabled. If the contrast is 100%, then there is no difference between the styling of objects on the front and the back of the sphere. If the contrast is 0%, then colors on back of sphere are almost transparent and size reduction is maximized for points and thicknesses. Dash pattern is not effected by the contrast. The Back Contrast percent may be set in the Background Style panel."])},clearChanges:t=>{const{normalize:e}=t;return e(["Undo"])},clearChangesToolTip:t=>{const{normalize:e}=t;return e(["Revert the selected object(s) back to the style they had when they were *first* selected."])},restoreDefaults:t=>{const{normalize:e}=t;return e(["Apply Defaults"])},restoreDefaultsToolTip:t=>{const{normalize:e}=t;return e(["Revert the selected object(s) back to their default(s)."])},showColorInputs:t=>{const{normalize:e}=t;return e(["Color Inputs"])},showColorInputsToolTip:t=>{const{normalize:e}=t;return e(["Click this to enter color code values directly."])},disableBackStyleContrastSlider:t=>{const{normalize:e}=t;return e(["Click To Disable Dynamic Back Style For Selected Object(s)"])},disableBackStyleContrastSliderToolTip:t=>{const{normalize:e}=t;return e(["The selected objects have dynamic back style enabled. Click this button disable it for only the selected object(s). Then you can change the back style of the selected object(s) using the style options in this panel."])},disableDashPatternSlider:t=>{const{normalize:e}=t;return e(["Set No Dash Pattern"])},disableDashPatternSliderToolTip:t=>{const{normalize:e}=t;return e(["Click this button to set no dash pattern on all selected object(s)."])},enableBackStyleContrastSlider:t=>{const{normalize:e}=t;return e(["Click To Enable Dynamic Back Style For Selected Object(s)"])},enableBackStyleContrastSliderToolTip:t=>{const{normalize:e}=t;return e(["The selected objects do not have dynamic back style enabled. Click this button enable it and adjust the Back Contrast Slider."])},toggleStyleOptionsToolTip:t=>{const{normalize:e}=t;return e(["More/Less label styling options."])},angleMarkerOptions:t=>{const{normalize:e}=t;return e(["Angle Marker Options"])},dynamicBackStyle:t=>{const{normalize:e}=t;return e(["Dynamic Back Style"])},labelStyleOptions:t=>{const{normalize:e}=t;return e(["Label Text Options"])},renameLabels:t=>{const{normalize:e}=t;return e(["Rename All"])},labelDisplayText:t=>{const{normalize:e}=t;return e(["Label Text"])},labelDisplayCaption:t=>{const{normalize:e}=t;return e(["Label Caption"])},labelObjectVisibility:t=>{const{normalize:e}=t;return e(["Label And Object Visibility"])},selectObjectsToShow:t=>{const{normalize:e}=t;return e(["Select Objects to Show"])},labelVisible:t=>{const{normalize:e}=t;return e(["Label Visible"])},objectVisible:t=>{const{normalize:e}=t;return e(["Object Visible"])},cannotSelectLabels:t=>{const{normalize:e}=t;return e(["Labels are not selectable. To style a label, select and style the object it labels and use the Label Style panel."])}},handlers:{transformCreatesSecondPoint:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Transforming point ",i(n("preimagePt"))," using ",i(n("type"))," ",i(n("trans"))," would create a second point on top of point ",i(n("existingPt")),"."])},pointDoesNotMoveUnderTransformation:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Applying ",i(n("type"))," ",i(n("trans"))," to point ",i(n("pt"))," will never move it to a different location."])},duplicateTransformedObject:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The ",i(n("object"))," ",i(n("name"))," has already been transformed by ",i(n("type"))," ",i(n("trans"))," or transforming ",i(n("object"))," ",i(n("name"))," using ",i(n("type"))," ",i(n("trans"))," would create a second ",i(n("object"))," on top of ",i(n("name")),"."])},newIsometrySegmentAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New isometry line segment ",i(n("name"))," added."])},newIsometryLineAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New isometry line ",i(n("name"))," added."])},newInvertedLineOrCircleAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New inverted circle ",i(n("name"))," added."])},newIsometryCircleAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New isometry circle ",i(n("name"))," added."])},newIsometryEllipseAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New isometry ellipse ",i(n("name"))," added."])},newTransformedPointAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New transformed point ",i(n("name"))," added."])},newEarthPointAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New earth point ",i(n("name"))," added at (",i(n("lat")),",",i(n("long")),")"])},newLatitudeAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New latitude ",i(n("name"))," at ",i(n("lat")),"."])},latitudeCreationAttemptDuplicate:t=>{const{normalize:e}=t;return e(["This latitude has already been created."])},latitudeWithZeroRadius:t=>{const{normalize:e}=t;return e(["Latitudes must have a non-zero radius."])},newLongitudeAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New Longitude ",i(n("name"))," at ",i(n("long")),"."])},longitudeCreationAttemptDuplicate:t=>{const{normalize:e}=t;return e(["This longitude has already been created."])},applyTransformationSelectTransformation:t=>{const{normalize:e}=t;return e(["You must select a transformation before you can use this tool."])},nEqualOneAngleNSect:t=>{const{normalize:e}=t;return e(["You must choose to divide angles into more than 1 equal pieces."])},nSetAngleNSect:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["You are dividing angles into ",i(n("number"))," equal pieces."])},bisectedAngleAlready:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Angle ",i(n("angle"))," has already been bisected. Choose another angle or divide this one into more than two equal pieces."])},nSectedAngleAlready:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Angle ",i(n("angle"))," has already been divided into ",i(n("number"))," equal pieces. Choose another angle or divide it into something other than ",i(n("number"))," equal pieces."])},angleSuccessfullyBisected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Angle ",i(n("angle"))," has be successfully bisected"])},angleSuccessfullyNSected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Angle ",i(n("angle"))," has be successfully divided into ",i(n("number"))," equal pieces."])},nEqualOneSegmentNSect:t=>{const{normalize:e}=t;return e(["You must choose to divide segments into more than 1 equal pieces."])},nSetSegmentNSect:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["You are dividing segments into ",i(n("number"))," equal pieces."])},bisectedSegmentAlready:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Segment ",i(n("segment"))," has already been bisected. Choose another segment or divide this one into more than two equal pieces."])},nSectedSegmentAlready:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Segment ",i(n("segment"))," has already been divided into ",i(n("number"))," equal pieces. Choose another segment or divide it into something other than ",i(n("number"))," equal pieces."])},segmentSuccessfullyBisected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Segment ",i(n("segment"))," has be successfully bisected"])},segmentSuccessfullyNSected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Segment ",i(n("segment"))," has be successfully divided into ",i(n("number"))," equal pieces."])},ellipseAntipodalSelected:t=>{const{normalize:e}=t;return e(["The foci of an ellipse are not allowed to be antipodal or identical. Select another location."])},ellipseFocus2Selected:t=>{const{normalize:e}=t;return e(["All foci of the ellipse selected. Now select a point on the ellipse."])},ellipseFocus1Selected:t=>{const{normalize:e}=t;return e(["One focus of the ellipse selected. Now select a second non-antipodal focus."])},ellipseInitiallyToSmall:t=>{const{normalize:e}=t;return e(["To create an ellipse initially you must select a point on the ellipse that is further away from each focus. Select a different location further from the foci."])},threePointCircleRepeatPointSelected:t=>{const{normalize:e}=t;return e(["The two points of three points that determine a three point circle are not allowed to be identical. Select another location."])},threePointCircleFirstPointSelected:t=>{const{normalize:e}=t;return e(["The first point of the three point circle have been selected. Now select another."])},threePointCircleSecondPointSelected:t=>{const{normalize:e}=t;return e(["The second point of the three point circle have been selected. Now select another."])},measuredCircleCenterSelected:t=>{const{normalize:e}=t;return e(["Center of circle selected. Now select a measurement, measurable object, or measurement label."])},firstMustCreateMeasurable:t=>{const{normalize:e}=t;return e(["To use this tool you must first create a measurement or measurable object."])},measuredCircleSelect:t=>{const{normalize:e}=t;return e(["Select a circle or a line segment to create the measurement object to use to determine the radius."])},rotationPointSelected:t=>{const{normalize:e}=t;return e(["Rotation point selected. Now select a measurement, measurable object, or measurement label."])},translationLineOrSegmentSelected:t=>{const{normalize:e}=t;return e(["Axis of translation selected. Now select a measurement, measurable object, or measurement label."])},circleCenterSelected:t=>{const{normalize:e}=t;return e(["Center of circle selected. Now select a point on the circle."])},duplicatePointMessage:t=>{const{normalize:e}=t;return e(["Duplicate point. Select another."])},pointDistanceHandlerNoPoint:t=>{const{normalize:e}=t;return e(["Before using this tool you must create at least two points."])},pointDistanceMeasurementAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Distance measurement ",i(n("measurementName"))," from ",i(n("p0Name"))," to ",i(n("p1Name"))," added."])},duplicatePointDistanceMeasurement:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The distance between points ",i(n("pt0Name"))," and ",i(n("pt1Name"))," has already been measured. This distance is measurement ",i(n("measurementName")),"."])},newMeasurementAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New measurement ",i(n("name"))," added."])},selectAnotherPoint:t=>{const{normalize:e}=t;return e(["Select the next point."])},newSegmentMeasurementAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New measurement ",i(n("name"))," added."])},newTranslationAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New translation ",i(n("name"))," added."])},newInversionAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New inversion ",i(n("name"))," added."])},newPointReflectionAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New point reflection ",i(n("name"))," added."])},newReflectionAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New reflection ",i(n("name"))," added."])},newRotationAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New rotation ",i(n("name"))," added."])},duplicatePointCoordinateMeasurement:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The coordinates of point ",i(n("ptName"))," have already been measured."])},duplicateInversion:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The selected circle already defines the inversion ",i(n("trans")),"."])},greatCircleInversion:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Inversion over the line ",i(n("name"))," is the same transformation as reflection. Use the reflection tool instead."])},duplicatePointReflection:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The selected point already defines the point reflection ",i(n("trans")),"."])},duplicateReflectionLine:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The selected line already defines the reflection ",i(n("trans")),"."])},duplicateReflectionSegment:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The selected segment already defines the reflection ",i(n("trans")),"."])},duplicateRotation:t=>{const{normalize:e}=t;return e(["The selected point and rotation able already defines a rotation."])},duplicateTranslation:t=>{const{normalize:e}=t;return e(["The selected axis and translation distance able already defines a translation."])},duplicateSegmentMeasurement:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The selected line segment has already been measured. The length of segment ",i(n("segName"))," is measurement ",i(n("measurementName")),"."])},duplicateLineMessage:t=>{const{normalize:e}=t;return e(["Duplicate line. Select another."])},duplicateLineAngleMeasurement:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The angle between lines ",i(n("line0Name"))," and ",i(n("line1Name"))," has already been measured. This angle is measurement ",i(n("measurementName")),"."])},duplicateSegmentMessage:t=>{const{normalize:e}=t;return e(["Duplicate segment. Select another."])},duplicateSegmentAngleMeasurement:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The angle between segments ",i(n("seg0Name"))," and ",i(n("seg1Name"))," has already been measured. This angle is measurement ",i(n("measurementName")),"."])},segmentsWithOutCommonEndpoint:t=>{const{normalize:e}=t;return e(["The selected segment does not have a common endpoint with the previously selected one. Select another."])},segmentWithOutEndpointOnLine:t=>{const{normalize:e}=t;return e(["The selected segment does not have a endpoint on the previously selected line. Select another."])},lineDoesNotContainEndpointOfSegment:t=>{const{normalize:e}=t;return e(["The selected line does contain an endpoint on the previously selected segment. Select another."])},duplicateSegmentLineAngleMeasurement:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The angle between segment ",i(n("segName"))," and line ",i(n("lineName"))," has already been measured. This angle is measurement ",i(n("measurementName")),"."])},antipodalPointMessage:t=>{const{normalize:e}=t;return e(["The selected point is antipodal or equal to the first selected point. Select another."])},antipodalPointMessage2:t=>{const{normalize:e}=t;return e(["The selected point is antipodal or equal to the second selected point. Select another."])},newAngleAdded:t=>{const{normalize:e}=t;return e(["New angle measure added."])},newAngleAddedV2:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["New angle measure ",i(n("name"))," added."])},duplicateThreePointAngleMeasurement:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The angle with vertex ",i(n("pt1Name")),", from ",i(n("pt0Name"))," and to ",i(n("pt2Name"))," has already been measured. This angle is measurement ",i(n("measurementName")),"."])},selectMorePoints:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Select ",i(n("needed"))," more point(s)."])},selectAnotherLineOrSegment:t=>{const{normalize:e}=t;return e(["Select 1 more line or segment."])},newCoordinatePointMeasurementAdded:t=>{const{normalize:e}=t;return e(["New coordinate measurements added"])},intersectionOneDimensionalSelected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["One dimensional object ",i(n("name"))," selected. Select another."])},intersectionOneDimensionalDuplicate:t=>{const{normalize:e}=t;return e(["Duplicate object. Select another."])},intersectionOneDimensionalNotIntersect:t=>{const{normalize:e}=t;return e(["Selected objects do not intersect."])},intersectionOneDimensionalAlreadyExists:t=>{const{normalize:e}=t;return e(["Intersection point already exists."])},intersectionOneDimensionalPointCreated:t=>{const{normalize:e}=t;return e(["One intersection point successfully created."])},moveHandlerNothingSelected:t=>{const{normalize:e}=t;return e(["No object selected. Rotating Sphere."])},moveHandlerObjectOnBackOfSphere:t=>{const{normalize:e}=t;return e(["Were you trying to move an object on the back of the sphere?  If so, press and hold the shift key to select objects on the back of the sphere."])},panZoomHandlerZoomInLimitReached:t=>{const{normalize:e}=t;return e(["Zoom in limit reached."])},panZoomHandlerZoomOutLimitReached:t=>{const{normalize:e}=t;return e(["Zoom out limit reached."])},selectionUpdate:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Selection Update: ",i(n("number"))," objects selected. Hold the Alt/Option key to add or subtract from the current selection."])},selectionUpdateNothingSelected:t=>{const{normalize:e}=t;return e(["No objects selected."])},pointCreationAttemptDuplicate:t=>{const{normalize:e}=t;return e(["There is already a point at this location."])},circleCreationAttemptDuplicate:t=>{const{normalize:e}=t;return e(["There is already a circle with this center and radius."])},measuredCircleCreationAttemptDuplicate:t=>{const{normalize:e}=t;return e(["There is already a circle with this center and measurement for the radius."])},ellipseCreationAttemptDuplicate:t=>{const{normalize:e}=t;return e(["There is already an ellipse with these foci and angle sum."])},threePointCircleCreationAttemptDuplicate:t=>{const{normalize:e}=t;return e(["There is already circle with this center and radius."])},segmentCreationAttemptDuplicate:t=>{const{normalize:e}=t;return e(["There is already a line segment with these endpoints, this normal vector, and length."])},lineCreationAttemptDuplicate:t=>{const{normalize:e}=t;return e(["There is already a line with this normal vector."])},lineThruPointPointSelected:t=>{const{normalize:e}=t;return e(["Point selected. Now select a one dimensional object to determine the perpendicular."])},lineThruPointLineSelected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Line ",i(n("name"))," selected. Now select a location to create a new point or to create a point on an object."])},lineThruPointSegmentSelected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Segment ",i(n("name"))," selected. Now select a location to create a new point or to create a point on an object."])},lineThruPointCircleSelected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Circle ",i(n("name"))," selected. Now select a location to create a new point or to create a point on an object."])},lineThruPointEllipseSelected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Ellipse ",i(n("name"))," selected. Now select a location to create a new point or to create a point on an object."])},lineThruPointParametricSelected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Parametric ",i(n("name"))," selected. Now select a location to create a new point or to create a point on an object."])},antipodeDuplicate:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The antipode of the selected point is the point ",i(n("pointName"))," and has already been created."])},polarLineDuplicate:t=>{const{normalize:e}=t;return e(["The polar line of this point has already been created."])},polarPointDuplicate:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The polar points of this ",i(n("object"))," has already been created."])},newSegmentIntersectsOrToClose:t=>{const{normalize:e}=t;return e(["The selected segment intersects the previously selected segments or the free endpoint of the selected segment is too close to one of the previously selected segments."])},newSegmentMustHaveEndpointInCommon:t=>{const{normalize:e}=t;return e(["The selected segment doesn't have an endpoint in common with the end point of the previously selected segments."])},newSegmentMustCloseTriangle:t=>{const{normalize:e}=t;return e(["The selected segment doesn't form a triangle with the previously selected segments."])},previouslyMeasuredPolygon:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["This polygon was measured previously.  See measurement ",i(n("token")),"."])},newPolygonAdded:t=>{const{normalize:e}=t;return e(["A new polygon was created."])},deletedNodes:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Successfully deleted ",i(n("type"))," ",i(n("name"))," and ",i(n("number"))," ",i(n("objects"))," that depend on it."])},deletedNumberNodes:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Successfully deleted ",i(n("number"))," ",i(n("objects")),"."])},rotationObjectUpdate:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Rotating about ",i(n("type"))," ",i(n("name")),"."])},rotationNoObjectUpdate:t=>{const{normalize:e}=t;return e(["Mouse location determines the rotation. No object selected to rotate about."])},rotationAboutEquator:t=>{const{normalize:e}=t;return e(["Rotating about the north pole of the screen sphere."])}},objectTree:{aMidLineOf:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The line bisecting angle ",i(n("angle")),"."])},anNsectLineOf:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Angle ",i(n("angle"))," is divided into ",i(n("N"))," equal parts and this is the line with index ",i(n("index")),"."])},aMidPointOf:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["A midpoint of segment ",i(n("segment"))])},anNsectPointOf:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Segment ",i(n("segment"))," is divided into ",i(n("N"))," equal parts and this is the point with index ",i(n("index")),"."])},bigonWithEdges:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The area of a bi-gon with ordered edges ",i(n("edges")),". Area: ",i(n("val"))])},triangleWithEdges:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The area of a triangle with ordered edges ",i(n("edges")),". Area: ",i(n("val"))])},polygonWithEdges:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The area of a polygon with ordered edges ",i(n("edges")),". Area: ",i(n("val"))])},expression:t=>{const{normalize:e}=t;return e(["Expression"])},parserError:t=>{const{normalize:e}=t;return e(["Reached end of input while parsing expression"])},expectedRightParenthesis:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Expected ')' at ",i(n("text"))])},expectedLeftParenthesis:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Expected '(' at function name ",i(n("text"))])},expectedRightButParenthesis:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Expected ')', but received ",i(n("text"))])},unexpectedInput:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Unexpected input at ",i(n("text"))])},unexpectedToken:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Unexpected token at ",i(n("text"))])},nonNumericExponents:t=>{const{normalize:e}=t;return e(["Can't handle non-numeric exponents"])},unknownFunction:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Unknown mathematical function ",i(n("text")),"."])},unhandledTokenType:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Unhandled token type ",i(n("text"))," ",i(n("text2"))])},undefinedVariable:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Undefined variable ",i(n("text"))])},divideByZero:t=>{const{normalize:e}=t;return e(["Attempted to divide by zero."])},startOfInput:t=>{const{normalize:e}=t;return e(["Start of input"])},cycleValueDisplayMode:t=>{const{normalize:e}=t;return e(["Click to cycle to the next value display mode including multiples of pi and degrees."])},copyToClipboard:t=>{const{normalize:e}=t;return e(["Copy the value of the measurement to the clipboard."])},copiedMeasurementSuccessfullyToClipboard:t=>{const{normalize:e}=t;return e(["Successfully copied the measurement value to the clipboard!"])},toggleDisplay:t=>{const{normalize:e}=t;return e(["Toggle the display of the corresponding object."])},toggleLabelDisplay:t=>{const{normalize:e}=t;return e(["Toggle the  display of the corresponding object's label."])},slider:t=>{const{normalize:e}=t;return e(["Slider"])},sliderValue:t=>{const{normalize:e,interpolate:i,named:n}=t;return e([i(n("token")),": Slider: ",i(n("val"))])},noObjectsInDatabase:t=>{const{normalize:e}=t;return e(["No objects in database"])},result:t=>{const{normalize:e}=t;return e(["Result"])},calculationExpression:t=>{const{normalize:e}=t;return e(["Calculation Expression"])},min:t=>{const{normalize:e}=t;return e(["Min"])},max:t=>{const{normalize:e}=t;return e(["Max"])},step:t=>{const{normalize:e}=t;return e(["Step"])},create:t=>{const{normalize:e}=t;return e(["Create"])},anglePoints:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Angle formed by points ",i(n("p1")),", ",i(n("p2")),", and ",i(n("p3"))," with measure ",i(n("val")),"."])},angleSegments:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Angle formed by segments ",i(n("seg1"))," and ",i(n("seg2"))," with measure ",i(n("val")),"."])},angleLines:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Angle formed by lines ",i(n("line1"))," and ",i(n("line2"))," with measure ",i(n("val")),"."])},angleSegmentLine:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Angle formed by segment ",i(n("seg"))," and line ",i(n("line"))," with measure ",i(n("val")),"."])},angleLineSegment:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Angle formed by line ",i(n("line"))," and segment ",i(n("seg"))," with measure ",i(n("val")),"."])},calculationDescription:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Calculation based on expression ",i(n("str"))," with value ",i(n("val"))])},calculationValue:t=>{const{normalize:e,interpolate:i,named:n}=t;return e([i(n("token")),": Calc: ",i(n("val"))])},coordinateOf:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The ",i(n("axisName"))," coordinate of point ",i(n("pt")),": ",i(n("val"))])},coordOf:t=>{const{normalize:e,interpolate:i,named:n}=t;return e([i(n("token")),": ",i(n("pt"))," ",i(n("axisName")),": ",i(n("val"))])},x:t=>{const{normalize:e}=t;return e(["x"])},y:t=>{const{normalize:e}=t;return e(["y"])},z:t=>{const{normalize:e}=t;return e(["z"])},distanceBetweenPts:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Distance between points ",i(n("pt1"))," and ",i(n("pt2")),". Distance: ",i(n("val"))])},distanceValue:t=>{const{normalize:e,interpolate:i,named:n}=t;return e([i(n("token")),": Dist: ",i(n("val"))])},segmentLength:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Length of segment ",i(n("seg")),". Length: ",i(n("val"))])},antipodeOf:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Antipode of point ",i(n("pt"))])},centerOfTransformedCircleUnderInversion:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Point that is the center of the image of ",i(n("circleOrLine"))," ",i(n("circleOrLineName"))," under inversion ",i(n("inversionName")),"."])},centerOfThreePointCircle:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Center of circle through ",i(n("pt1")),", ",i(n("pt2")),", and ",i(n("pt3")),"."])},aPolarPointOf:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Polar point of line ",i(n("line"))," with index ",i(n("index")),"."])},circleThrough:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Circle with center ",i(n("center"))," through point ",i(n("through"))])},latitudeCircle:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Fixed earth ",i(n("degree"))," latitude"])},longitudeSegment:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Fixed earth ",i(n("degree"))," longitude"])},equatorCircle:t=>{const{normalize:e}=t;return e(["Equator"])},primeMeridian:t=>{const{normalize:e}=t;return e(["Prime Meridian"])},inversionImageOfACircle:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Image of ",i(n("circleOrLine"))," ",i(n("circleOrLineParentName"))," under inversion ",i(n("inversionParentName")),"."])},threePointCircleThrough:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Circle through the points ",i(n("pt1")),", ",i(n("pt2")),", and ",i(n("pt3")),"."])},measuredCircle:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Circle with center ",i(n("center"))," with radius ",i(n("measurementToken"))])},ellipseThrough:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Ellipse with foci ",i(n("focus1"))," and ",i(n("focus2"))," through point ",i(n("through"))])},intersectionPoint:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Intersection of ",i(n("typeParent1"))," ",i(n("parent1"))," and ",i(n("typeParent2"))," ",i(n("parent2"))," with index ",i(n("index"))])},transformationObject:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The image of ",i(n("object"))," ",i(n("name"))," under ",i(n("transType"))," ",i(n("trans")),"."])},lineThrough:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Line through points ",i(n("pt1"))," and ",i(n("pt2"))," with normal vector <",i(n("normalX")),",",i(n("normalY")),",",i(n("normalZ")),">"])},polarLine:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Polar line to point ",i(n("pt"))," with normal vector <",i(n("normalX")),",",i(n("normalY")),",",i(n("normalZ")),">"])},segmentThrough:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Line segment with endpoints ",i(n("pt1"))," and ",i(n("pt2"))," and normal vector <",i(n("normalX")),",",i(n("normalY")),",",i(n("normalZ")),">"])},pointOnOneDimensional:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Point on ",i(n("typeParent"))," ",i(n("parent"))])},freePoint:t=>{const{normalize:e}=t;return e(["Free point"])},earthPoint:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Fixed earth location with latitude ",i(n("lat"))," and longitude ",i(n("long")),"."])},earthPointPole:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Pole with latitude ",i(n("lat")),"."])},perpendicularLineThru:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Perpendicular line to ",i(n("oneDimensionalParentType"))," ",i(n("oneDimensional"))," through point ",i(n("pt"))," with index ",i(n("index"))])},tangentLineThru:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Tangent line to ",i(n("oneDimensionalParentType"))," ",i(n("oneDimensional"))," through point ",i(n("pt"))," with index ",i(n("index"))])},deleteNode:t=>{const{normalize:e}=t;return e(["Delete the selected object."])},parametricCurves:t=>{const{normalize:e}=t;return e(["Parametric Curves"])},parametricCoordinates:t=>{const{normalize:e}=t;return e(["Parametric Formulas"])},xParametricCoordinate:t=>{const{normalize:e}=t;return e(["X(t) formula"])},yParametricCoordinate:t=>{const{normalize:e}=t;return e(["Y(t) formula"])},zParametricCoordinate:t=>{const{normalize:e}=t;return e(["Z(t) formula"])},xCoordExpressionTip:t=>{const{normalize:e}=t;return e(["An expression (possibly depending on measurement tokens) for the x coordinate for the parametric curve."])},yCoordExpressionTip:t=>{const{normalize:e}=t;return e(["An expression (possibly depending on measurement tokens) for the y coordinate for the parametric curve."])},zCoordExpressionTip:t=>{const{normalize:e}=t;return e(["An expression (possibly depending on measurement tokens) for the z coordinate for the parametric curve."])},tExpressionData:t=>{const{normalize:e}=t;return e(["Optional Tracing Expressions"])},tMinExpression:t=>{const{normalize:e}=t;return e(["Minimum Parameter Tracing Expression"])},tMinExpressionTip:t=>{const{normalize:e}=t;return e(["An optional expression (that MUST depend on measurements tokens) that gives the starting t value when tracing the parametric curve. This value is always evaluated to be greater than or equal to the minimum parameter value."])},tMaxExpression:t=>{const{normalize:e}=t;return e(["Maximum Parameter Tracing Expression"])},tMaxExpressionTip:t=>{const{normalize:e}=t;return e(["An optional expression (that MUST depend on measurements tokens) that gives the ending t value when tracing the parametric curve. This value is always evaluated to be less than or equal to the maximum parameter value."])},exactlyOneEmptyTExpression:t=>{const{normalize:e}=t;return e(["Maximum and Minimum Parameter Tracing Expression must either both be empty or both be defined."])},tMinNumber:t=>{const{normalize:e}=t;return e(["Minimum parameter(t) Value"])},tMinNumberTip:t=>{const{normalize:e}=t;return e(["A required absolute minimum t (must be a number) value for tracing the parametric curve that is the lower bound for the optional tMin Tracing Expression."])},tMaxNumber:t=>{const{normalize:e}=t;return e(["Maximum parameter(t) Value"])},tMaxNumberTip:t=>{const{normalize:e}=t;return e(["A required absolute minimum t (must be a number) value for tracing the parametric curve that is the upper bound for the optional tMax Tracing Expression."])},cuspParameterValues:t=>{const{normalize:e}=t;return e(["Cusp t values (if any)"])},cuspParameterValuesTip:t=>{const{normalize:e}=t;return e(["The comma separated list of the t (each must be a number) values of the parameter (if any) where the parametric curve has cusps. If the curve is closed and their is a cusp point at the point of closure, include both the minimum and maximum parameter value."])},cuspValuesOutOfBounds:t=>{const{normalize:e}=t;return e(["At least one of the cusp parameter values is not between the minimum and maximum parameter values. Check the cusp parameter values."])},currentTValue:t=>{const{normalize:e}=t;return e(["Current Value: "])},tMinNotLessThantMax:t=>{const{normalize:e}=t;return e(["The minimum t value must be less than the maximum t value for at least one set of measurements. Change at least one t value expressions."])},notAUnitParametricCurve:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Parametric curves must on the unit sphere; this curve was not unit at a t value of ",i(n("tVal")),". Check the coordinates of the parametric formulas."])},notPerpCurveAndDerivative:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The parametric derivative must be perpendicular to the the unit parametric curve vector; these were not perpendicular at a t value of ",i(n("tVal")),"."])},endPointOfParametric:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The ",i(n("end"))," point of parametric curve ",i(n("parent")),"."])},tracePointOfParametric:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["The trace point of parametric curve ",i(n("parent")),"."])},parametricDescription:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Parametric curve with coordinates (",i(n("xExpression")),", ",i(n("yExpression")),", ",i(n("zExpression")),") for t from ",i(n("tMinNumber"))," to ",i(n("tMaxNumber")),"."])},duplicateParametricCurve:t=>{const{normalize:e}=t;return e(["Duplicate parametric curves are not allowed."])},unableToComputeTheDerivativeOf:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["We were unable to compute the derivative of one of the coordinate expressions. Error: ",i(n("error"))])},createMeasurementForMeasuredCircle:t=>{const{normalize:e}=t;return e(["Create a measurement to use as the radius of a measured circle."])},createMeasurementForTranslation:t=>{const{normalize:e}=t;return e(["Create a measurement to use as the translation distance."])},createMeasurementForRotation:t=>{const{normalize:e}=t;return e(["Create a measurement to use as the angle of rotation."])},selectAMeasurementForMeasuredCircle:t=>{const{normalize:e}=t;return e(["After selecting a center point, select a measurement to use as the radius of a measured circle."])},selectATransformation:t=>{const{normalize:e}=t;return e(["Select a transformation to apply."])},selectAMeasurementForTranslation:t=>{const{normalize:e}=t;return e(["After selecting an axis (line or line segment) of translation, select a measurement to use as the distance of translation."])},selectAMeasurementForRotation:t=>{const{normalize:e}=t;return e(["After selecting a rotation point, select a measurement to use as the angle of rotation."])},translationAlongLineSegment:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Translation along axis (line or line segment) ",i(n("along"))," by angle ",i(n("angle")),"."])},transformedPoint:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Image of point ",i(n("pt"))," under the transformation ",i(n("trans")),"."])},rotationAboutPoint:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Rotation about point ",i(n("pt"))," by angle ",i(n("angle")),"."])},reflectionOverLine:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Reflection over the line ",i(n("line")),"."])},reflectOverPoint:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Reflection over the point ",i(n("pt")),"."])},invertOverCircle:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Inversion over the circle ",i(n("circle")),"."])},createATransformation:t=>{const{normalize:e}=t;return e(["To apply a transformation you must first create a transformation object."])}},constructions:{save:t=>{const{normalize:e}=t;return e(["Save"])},cancel:t=>{const{normalize:e}=t;return e(["Cancel"])},keep:t=>{const{normalize:e}=t;return e(["Keep"])},discard:t=>{const{normalize:e}=t;return e(["Discard"])},description:t=>{const{normalize:e}=t;return e(["Description"])},proceed:t=>{const{normalize:e}=t;return e(["Proceed"])},resetSphere:t=>{const{normalize:e}=t;return e(["Reset Sphere"])},confirmReset:t=>{const{normalize:e}=t;return e(["Confirm Reset Sphere"])},confirmation:t=>{const{normalize:e}=t;return e(["Confirmation Required"])},confirmLogout:t=>{const{normalize:e}=t;return e(["Confirm Logout"])},saveConstruction:t=>{const{normalize:e}=t;return e(["Save Construction"])},clearConstructionMsg:t=>{const{normalize:e}=t;return e(["You are about to clear your construction. This action cannot be undone and any unsaved work will be discarded."])},makePublic:t=>{const{normalize:e}=t;return e(["Available to public"])},privateConstructions:t=>{const{normalize:e}=t;return e(["Private Constructions"])},publicConstructions:t=>{const{normalize:e}=t;return e(["Public Constructions"])},logoutDialog:t=>{const{normalize:e}=t;return e(["You are about to logout, any unsaved constructions will be discarded."])},saveConstructionDialog:t=>{const{normalize:e}=t;return e(["Please provide a short description for your construction."])},shareLinkReference:t=>{const{normalize:e}=t;return e(["--placeholder share--"])},shareConstructionDialog:t=>{const{normalize:e}=t;return e(["Share your construction"])},exportConstructionDialog:t=>{const{normalize:e}=t;return e(["Export"])},selectedSVGExport:t=>{const{normalize:e}=t;return e(["SVG was selected."])},selectedPNGExport:t=>{const{normalize:e}=t;return e(["PNG was selected."])},selectedGIFExport:t=>{const{normalize:e}=t;return e(["GIF was selected."])},sliderFileDimensions:t=>{const{normalize:e}=t;return e(["File dimensions in pixels:"])},displaySlider:t=>{const{normalize:e}=t;return e(["Slider???"])},exportDimensionsInvalidWarning:t=>{const{normalize:e}=t;return e(["Export dimensions must be between 200px and 1200px. Please try again."])},shareLinkDialog:t=>{const{normalize:e}=t;return e(["Share your construction link here"])},unsavedConstructionMsg:t=>{const{normalize:e}=t;return e(["You have unsaved work. Do you want to stay on this page and keep your work or switch to another page and discard your work."])},unsavedObjectsMsg:t=>{const{normalize:e}=t;return e(["You have unsaved work. Loading a new construction will remove all the current ones. Do you want to proceed or cancel?"])},firestoreConstructionLoaded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Construction ",i(n("docId"))," successfully loaded."])},firestoreConstructionSaved:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Construction ",i(n("docId"))," successfully saved."])},firestoreConstructionDeleted:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Construction ",i(n("docId"))," successfully deleted."])},firestoreSaveError:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Construction was not saved: ",i(n("error"))])},constructionNotFound:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Construction ",i(n("docId"))," not found."])}},units:{km:t=>{const{normalize:e}=t;return e(["km"])},mi:t=>{const{normalize:e}=t;return e(["mi"])}},key:t=>{const{normalize:e}=t;return e([])},selectLanguage:t=>{const{normalize:e}=t;return e([])},selectAll:t=>{const{normalize:e}=t;return e([])},deleteWarning:t=>{const{normalize:e}=t;return e([])},undo:t=>{const{normalize:e}=t;return e([])},selectMsgType:t=>{const{normalize:e}=t;return e([])},i18nListTitle:t=>{const{normalize:e}=t;return e([])},labelText:t=>{const{normalize:e}=t;return e([])},labelCaption:t=>{const{normalize:e}=t;return e([])},labelTextScale:t=>{const{normalize:e}=t;return e([])},labelTextRotation:t=>{const{normalize:e}=t;return e([])},labelTextFamily:t=>{const{normalize:e}=t;return e([])},labelTextStyle:t=>{const{normalize:e}=t;return e([])},labelTextDecoration:t=>{const{normalize:e}=t;return e([])},labelDisplayMode:t=>{const{normalize:e}=t;return e([])},labelFrontFillColor:t=>{const{normalize:e}=t;return e([])},labelBackFillColor:t=>{const{normalize:e}=t;return e([])},commonLabelText:t=>{const{normalize:e}=t;return e(["Common Label Text"])},captionText:t=>{const{normalize:e}=t;return e(["Caption Text"])}},Cae={account:{createError:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Pembuatan akun baru tidak berhasil: ",i(n("error"))])},emailNotVerified:t=>{const{normalize:e}=t;return e(["Akun anda belum diverifikasi. Periksalah email anda"])},emailVerification:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Email untuk verifikasi akun telah dikirim ke ",i(n("emailAddr"))])},loginError:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Login tidak berhasil: ",i(n("error"))])},passwordReset:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Periksalah email and (",i(n("emailAddr")),") untuk mereset password"])}},buttons:{CreateAngleDisplayedName:t=>{const{normalize:e}=t;return e(["Sudut"])},CreateAngleToolTipMessage:t=>{const{normalize:e}=t;return e(["Hitung Sudut"])},CreateAngleToolUseMessage:t=>{const{normalize:e}=t;return e(["Gunakan tombol ini untuk menghitung sudut antara dua garis atau 3 titik."])},CreateAntipodalPointDisplayedName:t=>{const{normalize:e}=t;return e(["Titik Antipodal"])},CreateAntipodalPointToolTipMessage:t=>{const{normalize:e}=t;return e(["Pilih titik"])},CreateAntipodalPointToolUseMessage:t=>{const{normalize:e}=t;return e(["Pilih salah satu titik untuk menciptakan titik pasangan antipodal"])},CreateCircleDisplayedName:t=>{const{normalize:e}=t;return e(["Lingkaran"])},CreateCircleToolTipMessage:t=>{const{normalize:e}=t;return e(["Tambahkan lingkaran"])},CreateCircleToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan dan geser untuk tambahkan lingkaran dengan titik pusat dan titik luar."])},CreateCoordinateDisplayedName:t=>{const{normalize:e}=t;return e(["Coordinates"])},CreateCoordinateToolTipMessage:t=>{const{normalize:e}=t;return e(["Measure x,y,z coordinates"])},CreateCoordinateToolUseMessage:t=>{const{normalize:e}=t;return e(["Select a point to measure its x,y,z coordinates on the sphere"])},CreateIntersectionDisplayedName:t=>{const{normalize:e}=t;return e(["Titik potong"])},CreateIntersectionToolTipMessage:t=>{const{normalize:e}=t;return e(["Tentukan titik potong dua objek"])},CreateIntersectionToolUseMessage:t=>{const{normalize:e}=t;return e(["Pilih dua objek satu dimensi untuk menentukan titik potongnya"])},CreateLineDisplayedName:t=>{const{normalize:e}=t;return e(["Garis"])},CreateLineSegmentDisplayedName:t=>{const{normalize:e}=t;return e(["Segmen Garis"])},CreateLineSegmentToolTipMessage:t=>{const{normalize:e}=t;return e(["Tambahkan segmen garis"])},CreateLineSegmentToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan dan geser mouse umtuk tambahkan segmen garis melewati dua titik."])},CreateLineToolTipMessage:t=>{const{normalize:e}=t;return e(["Tambahkan garis"])},CreateLineToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan dan geser mouse untuk tambahkan garis melewati dua titik."])},CreatePerpendicularDisplayedName:t=>{const{normalize:e}=t;return e(["Perpendicular"])},CreatePerpendicularToolTipMessage:t=>{const{normalize:e}=t;return e(["Perpendicular Through Point"])},CreatePerpendicularToolUseMessage:t=>{const{normalize:e}=t;return e(["Create a perpendicular line to a selected one-dimensional object and selected location."])},CreatePointDisplayedName:t=>{const{normalize:e}=t;return e(["Titik"])},CreatePointDistanceDisplayedName:t=>{const{normalize:e}=t;return e(["Jarak Dua Titik"])},CreatePointDistanceToolTipMessage:t=>{const{normalize:e}=t;return e(["Jarak Dua Titik"])},CreatePointDistanceToolUseMessage:t=>{const{normalize:e}=t;return e(["Pilih dua titik dan tentukan jarak antara keduanya"])},CreatePointOnOneDimDisplayedName:t=>{const{normalize:e}=t;return e(["Titik pada Objek Satu Dimensi"])},CreatePointOnOneDimToolTipMessage:t=>{const{normalize:e}=t;return e(["Pilih objek satu dimensi untuk penempatan titik"])},CreatePointOnOneDimToolUseMessage:t=>{const{normalize:e}=t;return e(["Pilih objek satu dimensi untuk penempatan titik"])},CreatePointToolTipMessage:t=>{const{normalize:e}=t;return e(["Tambahkan titik"])},CreatePointToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan mouse untuk tambahkan titik bebas."])},CreateSegmentLengthDisplayedName:t=>{const{normalize:e}=t;return e(["Panjang Segment Garis"])},CreateSegmentLengthToolTipMessage:t=>{const{normalize:e}=t;return e(["Panjang Segment Garis"])},CreateSegmentLengthToolUseMessage:t=>{const{normalize:e}=t;return e(["Gunakan tombol ini untuk menentukan panjang segmen garis"])},CreateSliderDisplayedName:t=>{const{normalize:e}=t;return e(["Variable Bebas"])},CreateSliderToolTipMessage:t=>{const{normalize:e}=t;return e(["Variable Bebas"])},CreateSliderToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan tombol ini untuk menambahkan variable bebas"])},CurrentTool:t=>{const{normalize:e}=t;return e(["Current Tool"])},DeleteDisplayedName:t=>{const{normalize:e}=t;return e(["Hapus"])},DeleteToolTipMessage:t=>{const{normalize:e}=t;return e(["Hapus objek"])},DeleteToolUseMessage:t=>{const{normalize:e}=t;return e(["Pilih objek untuk dihapus"])},HideDisplayedName:t=>{const{normalize:e}=t;return e(["Sembunyikan"])},HideObjectToolTipMessage:t=>{const{normalize:e}=t;return e(["Sembunyikan objek"])},HideObjectToolUseMessage:t=>{const{normalize:e}=t;return e(["Pilih objek untuk disembunyikan"])},MoveDisplayedName:t=>{const{normalize:e}=t;return e(["Geser"])},MoveObjectToolTipMessage:t=>{const{normalize:e}=t;return e(["Geser Objek"])},MoveObjectToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan dan geser tetikus untuk pindahkan objek (label, titik bebas, garis, titik antipodal. Gunakan tombol SHIFT untuk menggeser objek disisi belakang bola."])},NoToolSelected:t=>{const{normalize:e}=t;return e(["Pilihan perkakas nihil"])},PanZoomInDisplayedName:t=>{const{normalize:e}=t;return e(["Geser/Perbesar"])},PanZoomInToolTipMessage:t=>{const{normalize:e}=t;return e(["Geser/Perbesar Gambar"])},PanZoomInToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan tetikus untuk memperbesar gambar bermula dari lokasi tetikus. Teken dan geser untuk menggeser gambar."])},PanZoomOutDisplayedName:t=>{const{normalize:e}=t;return e(["Geser/Perkecil"])},PanZoomOutToolTipMessage:t=>{const{normalize:e}=t;return e(["Geser/Perkecil Gambar"])},PanZoomOutToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan tetikus untuk memperkecil gambar bermula dari lokasi tetikus. Teken dan geser untuk menggeser gambar."])},RotateDisplayedName:t=>{const{normalize:e}=t;return e(["Putar Bola"])},RotateSphereToolTipMessage:t=>{const{normalize:e}=t;return e(["Putar Bola"])},RotateSphereToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan dan geser tetikus untuk memutar bola."])},SelectDisplayedName:t=>{const{normalize:e}=t;return e(["Pilih"])},SelectToolTipMessage:t=>{const{normalize:e}=t;return e(["Pilih Objek"])},SelectToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan object untuk menyertakan ke dalam pilihan"])},ToggleLabelDisplayedName:t=>{const{normalize:e}=t;return e(["Tampilkan/Sembunyikan Label"])},ToggleLabelToolTipMessage:t=>{const{normalize:e}=t;return e(["Tampilkan/Sembunyikan Label"])},ToggleLabelToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan salah satu objek untuk mengganti tampilan labelnya"])},ZoomFitDisplayedName:t=>{const{normalize:e}=t;return e(["Tampilkan Bola Seutuhnya"])},ZoomFitToolTipMessage:t=>{const{normalize:e}=t;return e(["Tampilkan Bola Seutuhnya"])},ZoomFitToolUseMessage:t=>{const{normalize:e}=t;return e(["Tekan tombol ini untuk menampilkan bola seutuhnya"])},"":t=>{const{normalize:e}=t;return e(["buttons."])}},handlers:{antipodalPointMessage:t=>{const{normalize:e}=t;return e(["Titik yang dipilih adalah antipodal atau titik yang sama dengan titik pertama. Pilih titik yang lain"])},antipodalPointMessage2:t=>{const{normalize:e}=t;return e(["Titik yang dipilah antipodal atau identik dengan titik kedua yang dipilih. Pilih yang lain."])},antipodeDuplicate:t=>{const{normalize:e}=t;return e(["Titik antipode dari titik yang dipilih sudah ada sebelumnya."])},duplicateLineMessage:t=>{const{normalize:e}=t;return e(["Garis duplikat. Pilih yang lain"])},duplicatePointMessage:t=>{const{normalize:e}=t;return e(["Titik duuplikat. Pilih yang lain."])},duplicateSegmentMessage:t=>{const{normalize:e}=t;return e(["Segmen duplikat. Pilih yang lain"])},intersectionOneDimensionalAlreadyExists:t=>{const{normalize:e}=t;return e(["Titik potong sudah ada sebelumnya"])},intersectionOneDimensionalDuplicate:t=>{const{normalize:e}=t;return e(["Objek duplikat. Pilih yang lain"])},intersectionOneDimensionalNotIntersect:t=>{const{normalize:e}=t;return e(["Object yang dipilih tidak berpotongan."])},intersectionOneDimensionalPointCreated:t=>{const{normalize:e}=t;return e(["Titik perpotongan berhasil diciptakan."])},intersectionOneDimensionalSelected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Objek satu dimensi ",i(n("name"))," dipilih. Pilih objek berikutnya"])},lineDoesNotContainEndpointOfSegment:t=>{const{normalize:e}=t;return e(["Garis yang dipilih melewati titik pada segment yang dipilih sebelumnya. Pilih yang lain"])},moveHandlerNothingSelected:t=>{const{normalize:e}=t;return e(["Tidak ada object dipilih. Perputaran bola"])},newAngleAdded:t=>{const{normalize:e}=t;return e(["Ukuran sudut diciptakan"])},newAngleAddedV2:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Ukuran sudut ",i(n("name"))," diciptakan"])},newCoordinatePointMeasurementAdded:t=>{const{normalize:e}=t;return e(["Pengukuran koordinat diciptakan"])},newMeasurementAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Pengukuran baru ",i(n("name"))," diciptakan"])},newSegmentMeasurementAdded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Pengukuran segment ",i(n("name"))," diciptakan"])},panZoomHandlerZoomInLimitReached:t=>{const{normalize:e}=t;return e(["Batas zoom in sudah maksimal"])},panZoomHandlerZoomOutLimitReached:t=>{const{normalize:e}=t;return e(["Batas zoom out sudah maksimal"])},perpendicularLineThruPointCircleSelected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Lingkaran ",i(n("name"))," dipilih. Pilih lokasi untuk titik baru (titik bebas atau titik pada object)"])},perpendicularLineThruPointLineSelected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Garis ",i(n("name"))," dipilih. Pilih lokasi untuk titik baru (titik bebas atau titik pada object)"])},perpendicularLineThruPointPointSelected:t=>{const{normalize:e}=t;return e(["Titik dipilih. Pilih lokasi untuk titik baru (titik bebas atau titik pada object)"])},perpendicularLineThruPointSegmentSelected:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Segmen ",i(n("name"))," dipilih. Pilih lokasi untuk titik baru (titik bebas atau titik pada object)"])},pointCreationAttemptDuplicate:t=>{const{normalize:e}=t;return e(["Sudah ada titik pada lokasi ini"])},segmentWithOutEndpointOnLine:t=>{const{normalize:e}=t;return e(["Segmen yang dipiliih tidak melewati titik pada garis yang dipilih sebelumnya. Pilih yang lain"])},segmentsWithOutCommonEndpoint:t=>{const{normalize:e}=t;return e(["Segmen yang dipilih tidak memiliki titik yang sama dengan yang dipilih sebelumnya. Pilih yang lain"])},segmentsWithOutEndpointOnLine:t=>{const{normalize:e}=t;return e(["Segmen yang dipilih tidak memiliki titik ujung pada garis yang dipilih sebelumnya. Pilih yang lain"])},selectAnotherLine:t=>{const{normalize:e}=t;return e(["Pilih satu garus lagi"])},selectAnotherLineOrSegment:t=>{const{normalize:e}=t;return e(["Pilih satu garus atau segment"])},selectAnotherPoint:t=>{const{normalize:e}=t;return e(["Pilih titik berikutnya"])},selectMorePoints:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Pilih ",i(n("needed"))," titik lagi"])},selectionUpdate:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Pembaruan pilihan: ",i(n("number"))," objek dipilih. Tekan tombol Alt/Option untuk menambah/mengurani pilihan"])},selectionUpdateNothingSelected:t=>{const{normalize:e}=t;return e(["Tidak ada object yang dipiliah"])}},main:{ConstructionsTabToolTip:t=>{const{normalize:e}=t;return e(["Pustaka Konstruksi"])},ObjectsTabToolTip:t=>{const{normalize:e}=t;return e(["Objek"])},RedoLastAction:t=>{const{normalize:e}=t;return e(["Ulang Aksi Terakhir"])},SphericalEaselMainTitle:t=>{const{normalize:e}=t;return e(["Spherical Easel"])},ToolsTabToolTip:t=>{const{normalize:e}=t;return e(["Alat"])},UndoLastAction:t=>{const{normalize:e}=t;return e(["Batalkan Aksi Terakhir"])}},objectTree:{calculationExpression:t=>{const{normalize:e}=t;return e(["Calculation Expression"])},create:t=>{const{normalize:e}=t;return e(["Create"])},expression:t=>{const{normalize:e}=t;return e(["Ekspresi"])},firestoreConstructionDeleted:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Konstruksi ",i(n("docId"))," dihapus Firestore"])},firestoreConstructionLoaded:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Konstrksi ",i(n("docId"))," dimuat dari Firestore"])},firestoreConstructionSaved:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Konstruksi disimpan ke Firestore ",i(n("docId"))])},firestoreLoadError:t=>{const{normalize:e,interpolate:i,named:n}=t;return e(["Gagal memuat data ",i(n("docId"))," dari Firestore"])},firestoreSaveError:t=>{const{normalize:e}=t;return e(["Gagal menyimpan data ke Firestore"])},max:t=>{const{normalize:e}=t;return e(["Maks"])},min:t=>{const{normalize:e}=t;return e(["Min"])},multipleOfPiToggle:t=>{const{normalize:e}=t;return e(["Hasil kalkulasi ditampilkan sebagai kelipatan "])},noObjectsInDatabase:t=>{const{normalize:e}=t;return e(["Database kosong"])},parserError:t=>{const{normalize:e}=t;return e(["Ekspresi tidak lengkap"])},result:t=>{const{normalize:e}=t;return e(["Hasil"])},slider:t=>{const{normalize:e}=t;return e(["Tombol Geser"])},step:t=>{const{normalize:e}=t;return e(["Step"])},toggleDisplay:t=>{const{normalize:e}=t;return e(["Toggle penampilan object"])},parametricCurves:t=>{const{normalize:e}=t;return e(["objectTree.parametricCurves"])},currentTValue:t=>{const{normalize:e}=t;return e(["objectTree.currentTValue"])},copyToClipboard:t=>{const{normalize:e}=t;return e(["objectTree.copyToClipboard"])},cycleValueDisplayMode:t=>{const{normalize:e}=t;return e(["objectTree.cycleValueDisplayMode"])},toggleLabelDisplay:t=>{const{normalize:e}=t;return e(["objectTree.toggleLabelDisplay"])},deleteNode:t=>{const{normalize:e}=t;return e(["objectTree.deleteNode"])},startOfInput:t=>{const{normalize:e}=t;return e(["objectTree.startOfInput"])},expectedRightParenthesis:t=>{const{normalize:e}=t;return e(["objectTree.expectedRightParenthesis"])},expectedLeftParenthesis:t=>{const{normalize:e}=t;return e(["objectTree.expectedLeftParenthesis"])},expectedRightButParenthesis:t=>{const{normalize:e}=t;return e(["objectTree.expectedRightButParenthesis"])},unexpectedInput:t=>{const{normalize:e}=t;return e(["objectTree.unexpectedInput"])},unexpectedToken:t=>{const{normalize:e}=t;return e(["objectTree.unexpectedToken"])},unknownFunction:t=>{const{normalize:e}=t;return e(["objectTree.unknownFunction"])},unhandledTokenType:t=>{const{normalize:e}=t;return e(["objectTree.unhandledTokenType"])},undefinedVariable:t=>{const{normalize:e}=t;return e(["objectTree.undefinedVariable"])},divideByZero:t=>{const{normalize:e}=t;return e(["objectTree.divideByZero"])},anglePoints:t=>{const{normalize:e}=t;return e(["objectTree.anglePoints"])},angleSegments:t=>{const{normalize:e}=t;return e(["objectTree.angleSegments"])},angleLines:t=>{const{normalize:e}=t;return e(["objectTree.angleLines"])},angleLineSegment:t=>{const{normalize:e}=t;return e(["objectTree.angleLineSegment"])},angleSegmentLine:t=>{const{normalize:e}=t;return e(["objectTree.angleSegmentLine"])},antipodeOf:t=>{const{normalize:e}=t;return e(["objectTree.antipodeOf"])},calculationDescription:t=>{const{normalize:e}=t;return e(["objectTree.calculationDescription"])},calculationValue:t=>{const{normalize:e}=t;return e(["objectTree.calculationValue"])},threePointCircleThrough:t=>{const{normalize:e}=t;return e(["objectTree.threePointCircleThrough"])},inversionImageOfACircle:t=>{const{normalize:e}=t;return e(["objectTree.inversionImageOfACircle"])},circleThrough:t=>{const{normalize:e}=t;return e(["objectTree.circleThrough"])},ellipseThrough:t=>{const{normalize:e}=t;return e(["objectTree.ellipseThrough"])},intersectionPoint:t=>{const{normalize:e}=t;return e(["objectTree.intersectionPoint"])},invertOverCircle:t=>{const{normalize:e}=t;return e(["objectTree.invertOverCircle"])},centerOfTransformedCircleUnderInversion:t=>{const{normalize:e}=t;return e(["objectTree.centerOfTransformedCircleUnderInversion"])},transformationObject:t=>{const{normalize:e}=t;return e(["objectTree.transformationObject"])},lineThrough:t=>{const{normalize:e}=t;return e(["objectTree.lineThrough"])},measuredCircle:t=>{const{normalize:e}=t;return e(["objectTree.measuredCircle"])},aMidLineOf:t=>{const{normalize:e}=t;return e(["objectTree.aMidLineOf"])},anNsectLineOf:t=>{const{normalize:e}=t;return e(["objectTree.anNsectLineOf"])},aMidPointOf:t=>{const{normalize:e}=t;return e(["objectTree.aMidPointOf"])},anNsectPointOf:t=>{const{normalize:e}=t;return e(["objectTree.anNsectPointOf"])},parametricDescription:t=>{const{normalize:e}=t;return e(["objectTree.parametricDescription"])},endPointOfParametric:t=>{const{normalize:e}=t;return e(["objectTree.endPointOfParametric"])},tracePointOfParametric:t=>{const{normalize:e}=t;return e(["objectTree.tracePointOfParametric"])},perpendicularLineThru:t=>{const{normalize:e}=t;return e(["objectTree.perpendicularLineThru"])},freePoint:t=>{const{normalize:e}=t;return e(["objectTree.freePoint"])},coordinateOf:t=>{const{normalize:e}=t;return e(["objectTree.coordinateOf"])},x:t=>{const{normalize:e}=t;return e(["objectTree.x"])},y:t=>{const{normalize:e}=t;return e(["objectTree.y"])},z:t=>{const{normalize:e}=t;return e(["objectTree.z"])},coordOf:t=>{const{normalize:e}=t;return e(["objectTree.coordOf"])},distanceBetweenPts:t=>{const{normalize:e}=t;return e(["objectTree.distanceBetweenPts"])},distanceValue:t=>{const{normalize:e}=t;return e(["objectTree.distanceValue"])},pointOnOneDimensional:t=>{const{normalize:e}=t;return e(["objectTree.pointOnOneDimensional"])},reflectOverPoint:t=>{const{normalize:e}=t;return e(["objectTree.reflectOverPoint"])},polarLine:t=>{const{normalize:e}=t;return e(["objectTree.polarLine"])},aPolarPointOf:t=>{const{normalize:e}=t;return e(["objectTree.aPolarPointOf"])},bigonWithEdges:t=>{const{normalize:e}=t;return e(["objectTree.bigonWithEdges"])},triangleWithEdges:t=>{const{normalize:e}=t;return e(["objectTree.triangleWithEdges"])},polygonWithEdges:t=>{const{normalize:e}=t;return e(["objectTree.polygonWithEdges"])},reflectionOverLine:t=>{const{normalize:e}=t;return e(["objectTree.reflectionOverLine"])},rotationAboutPoint:t=>{const{normalize:e}=t;return e(["objectTree.rotationAboutPoint"])},segmentThrough:t=>{const{normalize:e}=t;return e(["objectTree.segmentThrough"])},segmentLength:t=>{const{normalize:e}=t;return e(["objectTree.segmentLength"])},sliderValue:t=>{const{normalize:e}=t;return e(["objectTree.sliderValue"])},tangentLineThru:t=>{const{normalize:e}=t;return e(["objectTree.tangentLineThru"])},centerOfThreePointCircle:t=>{const{normalize:e}=t;return e(["objectTree.centerOfThreePointCircle"])},translationAlongLineSegment:t=>{const{normalize:e}=t;return e(["objectTree.translationAlongLineSegment"])}},objects:{circles:t=>{const{normalize:e}=t;return e(["Lingkaran"])},lines:t=>{const{normalize:e}=t;return e(["Garis"])},measurements:t=>{const{normalize:e}=t;return e(["Pengukuran"])},points:t=>{const{normalize:e}=t;return e(["Titik"])},segments:t=>{const{normalize:e}=t;return e(["Segmen Garis"])},selectTransformation:t=>{const{normalize:e}=t;return e(["objects.selectTransformation"])},angleMarkers:t=>{const{normalize:e}=t;return e(["objects.angleMarkers"])},ellipses:t=>{const{normalize:e}=t;return e(["objects.ellipses"])},transformations:t=>{const{normalize:e}=t;return e(["objects.transformations"])},triangles:t=>{const{normalize:e}=t;return e(["objects.triangles"])},calculations:t=>{const{normalize:e}=t;return e(["objects.calculations"])},parametrics:t=>{const{normalize:e}=t;return e(["objects.parametrics"])},objects:t=>{const{normalize:e}=t;return e(["objects.objects"])},translations:t=>{const{normalize:e}=t;return e(["objects.translations"])},pointReflections:t=>{const{normalize:e}=t;return e(["objects.pointReflections"])},reflections:t=>{const{normalize:e}=t;return e(["objects.reflections"])},rotations:t=>{const{normalize:e}=t;return e(["objects.rotations"])},inversions:t=>{const{normalize:e}=t;return e(["objects.inversions"])},polygons:t=>{const{normalize:e}=t;return e(["objects.polygons"])}},settings:{title:t=>{const{normalize:e}=t;return e(["Setelan"])}},style:{DIFFERINGSTYLESDETECTED:t=>{const{normalize:e}=t;return e(["Gaya tampilan"])},advancedStyle:t=>{const{normalize:e}=t;return e(["Gaya tampilan lanjut"])},back:t=>{const{normalize:e}=t;return e(["Latar Belakang"])},backStyleContrast:t=>{const{normalize:e}=t;return e(["Kontras Latar Belakang"])},backStyleContrastToolTip:t=>{const{normalize:e}=t;return e(["Gaya tampilan latar belakang ditentukan oleh gaya tampilan latar muka dan besarnya nilai Kontras Latar Belakang. Nilai kontras 1 menyatakan tidak ada perbedaan warna antara latar muka dan latar belakang. Dengan nilai kontras 0 objek akan tampak hampir hilang"])},backStyleDisagreement:t=>{const{normalize:e}=t;return e(["Gaya tampilan latar belakang "])},backgroundStyle:t=>{const{normalize:e}=t;return e(["Gaya Tampilan Latar Belakang"])},basicStyle:t=>{const{normalize:e}=t;return e(["Basic Style"])},clearChanges:t=>{const{normalize:e}=t;return e(["Batalkan perubahan"])},clearChangesToolTip:t=>{const{normalize:e}=t;return e(["Tekan tombol ini untuk kembali ke tampilan semula"])},clickToMakeLabelsVisible:t=>{const{normalize:e}=t;return e([])},clickToMakeObjectsVisible:t=>{const{normalize:e}=t;return e([])},closeOrSelect:t=>{const{normalize:e}=t;return e([])},closeStylingPanel:t=>{const{normalize:e}=t;return e([])},dashPattern:t=>{const{normalize:e}=t;return e(["Pola garis putus"])},dashPatternCheckBoxToolTip:t=>{const{normalize:e}=t;return e([])},differentValues:t=>{const{normalize:e}=t;return e([])},differentValuesToolTip:t=>{const{normalize:e}=t;return e([])},differingStylesDetected:t=>{const{normalize:e}=t;return e(["Gaya tampilah tidak sepadan"])},differingStylesDetectedToolTip:t=>{const{normalize:e}=t;return e(["Object yang dipilih memiliki gaya tampilah yang tidak sepadan. Gunakan tombol ini untuk menyamakan gaya tampilah"])},disableBackStyleContrastSlider:t=>{const{normalize:e}=t;return e(["Matikan gaya tampil latar belakang untuk objek terpilih"])},disableBackStyleContrastSliderToolTip:t=>{const{normalize:e}=t;return e(["Objek yang dipilih disetel unruk latar belakang dinamis. Tekan tombol ini tuntuk mematikan fitur ini"])},disableDashPatternSlider:t=>{const{normalize:e}=t;return e(["Hilangkan Pola Garis Putus"])},disableDashPatternSliderToolTip:t=>{const{normalize:e}=t;return e(["Gunakan tombol ini untuk menghilangkan pola garis putus"])},disableDynamicBackStyle:t=>{const{normalize:e}=t;return e([])},disableDynamicBackStyleToolTip:t=>{const{normalize:e}=t;return e([])},dynamicBackStyle:t=>{const{normalize:e}=t;return e(["Latar Belakang disetel secara dinamis"])},dynamicBackStyleHeader:t=>{const{normalize:e}=t;return e([])},editMultipleBasicPropertiesMessage:t=>{const{normalize:e}=t;return e(["To edit multiple labels simultaneously select the labels directly."])},enableBackStyleContrastSlider:t=>{const{normalize:e}=t;return e(["Aktifkan gaya tampil latar belakang untuk objek terpilih"])},enableBackStyleContrastSliderToolTip:t=>{const{normalize:e}=t;return e(["Objek yang dipilih tidak disetel dengan latar belakang dinamis. Tekan tombol ini tuntuk aktifkan gaya tampil latar belakang dinamis untuk objek terpilih"])},enableCommonStyle:t=>{const{normalize:e}=t;return e([])},enableDashPatternSlider:t=>{const{normalize:e}=t;return e(["Aktifkan Pola Garis Putus"])},enableDashPatternSliderToolTip:t=>{const{normalize:e}=t;return e(["Object terpilih tidak memiliki pola garis putus. Gunakan tombol ini untuk menyetel pola garis putus"])},enableDynamicBackStyle:t=>{const{normalize:e}=t;return e([])},fillColor:t=>{const{normalize:e}=t;return e(["Warna pengisi"])},foregroundStyle:t=>{const{normalize:e}=t;return e(["Gaya tampilan latar muka"])},front:t=>{const{normalize:e}=t;return e(["Latar Muka"])},labelDisplayText:t=>{const{normalize:e}=t;return e(["Label Text"])},labelHidden:t=>{const{normalize:e}=t;return e(["Label Hidden"])},labelObjectVisibility:t=>{const{normalize:e}=t;return e(["Label And Object Visibility"])},labelStyleOptions:t=>{const{normalize:e}=t;return e(["Label Text Options"])},moreThanOneItemSelected:t=>{const{normalize:e}=t;return e(["Multiple Selected Objects Detected -- Select only one."])},moreThanOneItemSelectedToolTip:t=>{const{normalize:e}=t;return e(["More than one object is selected, please only select one geometric object to edit its label or select the label directly."])},objectHidden:t=>{const{normalize:e}=t;return e(["Object Hidden"])},opacity:t=>{const{normalize:e}=t;return e(["Tingkat transparansi"])},pointRadiusPercent:t=>{const{normalize:e}=t;return e(["Persentase Jejari Titik"])},renameLabels:t=>{const{normalize:e}=t;return e(["No Blank Labels"])},restoreDefaults:t=>{const{normalize:e}=t;return e(["Kembali ke tempilan standar"])},restoreDefaultsToolTip:t=>{const{normalize:e}=t;return e(["Tekan tombol ini untuk kembali ke tampilan standar"])},selectAnObject:t=>{const{normalize:e}=t;return e(["Pilih objek"])},selectObjectsToHide:t=>{const{normalize:e}=t;return e(["Select Objects to Hide"])},showColorPresets:t=>{const{normalize:e}=t;return e(["Warna standar"])},showColorPresetsToolTip:t=>{const{normalize:e}=t;return e(["Tekan tombol ini untuk memasukan warna HSLA atau memilih warna standar"])},stokeWidthPercent:t=>{const{normalize:e}=t;return e(["Persentase Tebal Garis"])},strikethrough:t=>{const{normalize:e}=t;return e(["Strikethrough"])},strokeColor:t=>{const{normalize:e}=t;return e(["Warna garis"])},value:t=>{const{normalize:e}=t;return e(["Nilai"])},globalBackStyleContrast:t=>{const{normalize:e}=t;return e(["style.globalBackStyleContrast"])},labelStyleOptionsMultiple:t=>{const{normalize:e}=t;return e(["style.labelStyleOptionsMultiple"])},dashArrayReverse:t=>{const{normalize:e}=t;return e(["style.dashArrayReverse"])},dashPatternReverseArrayToolTip:t=>{const{normalize:e}=t;return e(["style.dashPatternReverseArrayToolTip"])},angleMarkerOptions:t=>{const{normalize:e}=t;return e(["style.angleMarkerOptions"])},angleMarkerTickMark:t=>{const{normalize:e}=t;return e(["style.angleMarkerTickMark"])},angleMarkerDoubleArc:t=>{const{normalize:e}=t;return e(["style.angleMarkerDoubleArc"])},angleMarkerArrowHeads:t=>{const{normalize:e}=t;return e(["style.angleMarkerArrowHeads"])},toggleStyleOptionsToolTip:t=>{const{normalize:e}=t;return e(["style.toggleStyleOptionsToolTip"])},labelNotVisible:t=>{const{normalize:e}=t;return e(["style.labelNotVisible"])},noFillLabelTip:t=>{const{normalize:e}=t;return e(["style.noFillLabelTip"])},noFillTip:t=>{const{normalize:e}=t;return e(["style.noFillTip"])},noFill:t=>{const{normalize:e}=t;return e(["style.noFill"])},noStroke:t=>{const{normalize:e}=t;return e(["style.noStroke"])},showLabels:t=>{const{normalize:e}=t;return e(["style.showLabels"])},showObjects:t=>{const{normalize:e}=t;return e(["style.showObjects"])},toSelectObjects:t=>{const{normalize:e}=t;return e(["style.toSelectObjects"])}},toolGroups:{AdvancedTools:t=>{const{normalize:e}=t;return e(["Perangkat Tambahan"])},BasicTools:t=>{const{normalize:e}=t;return e(["Perangkat Dasar"])},ConstructionTools:t=>{const{normalize:e}=t;return e(["Perangkat Konstruksi"])},DisplayTools:t=>{const{normalize:e}=t;return e(["Perangkat Tampilan"])},EditTools:t=>{const{normalize:e}=t;return e(["Suntingan"])},KeyShortCut:t=>{const{normalize:e}=t;return e(["Tombol"])},MeasurementTools:t=>{const{normalize:e}=t;return e([])},TransformationalTools:t=>{const{normalize:e}=t;return e(["Transformasi"])},ConicTools:t=>{const{normalize:e}=t;return e(["toolGroups.ConicTools"])},TransformationTools:t=>{const{normalize:e}=t;return e(["toolGroups.TransformationTools"])},MeasuredObjectTools:t=>{const{normalize:e}=t;return e(["toolGroups.MeasuredObjectTools"])},DeveloperOnlyTools:t=>{const{normalize:e}=t;return e(["toolGroups.DeveloperOnlyTools"])}},key:t=>{const{normalize:e}=t;return e(["key"])},constructions:{confirmLogout:t=>{const{normalize:e}=t;return e(["Logout?"])},proceed:t=>{const{normalize:e}=t;return e(["Lanjutkan"])},cancel:t=>{const{normalize:e}=t;return e(["Batal"])},logoutDialog:t=>{const{normalize:e}=t;return e(["Anda akan segera logout, suntingan yang belum tersimpan akan hilang"])},privateConstructions:t=>{const{normalize:e}=t;return e(["constructions.privateConstructions"])},publicConstructions:t=>{const{normalize:e}=t;return e(["constructions.publicConstructions"])},unsavedObjectsMsg:t=>{const{normalize:e}=t;return e(["constructions.unsavedObjectsMsg"])},confirmation:t=>{const{normalize:e}=t;return e(["constructions.confirmation"])},keep:t=>{const{normalize:e}=t;return e(["constructions.keep"])},discard:t=>{const{normalize:e}=t;return e(["constructions.discard"])},unsavedConstructionMsg:t=>{const{normalize:e}=t;return e(["constructions.unsavedConstructionMsg"])},confirmReset:t=>{const{normalize:e}=t;return e(["constructions.confirmReset"])},clearConstructionMsg:t=>{const{normalize:e}=t;return e(["constructions.clearConstructionMsg"])}},headingNames:{allToolsName:t=>{const{normalize:e}=t;return e(["headingNames.allToolsName"])},topLeftCorner:t=>{const{normalize:e}=t;return e(["headingNames.topLeftCorner"])},topRightCorner:t=>{const{normalize:e}=t;return e(["headingNames.topRightCorner"])},bottomLeftCorner:t=>{const{normalize:e}=t;return e(["headingNames.bottomLeftCorner"])},bottomRightCorner:t=>{const{normalize:e}=t;return e(["headingNames.bottomRightCorner"])}},selectLanguage:t=>{const{normalize:e}=t;return e(["selectLanguage"])},selectAll:t=>{const{normalize:e}=t;return e(["selectAll"])},deleteWarning:t=>{const{normalize:e}=t;return e(["deleteWarning"])},undo:t=>{const{normalize:e}=t;return e(["undo"])},selectMsgType:t=>{const{normalize:e}=t;return e(["selectMsgType"])},i18nListTitle:t=>{const{normalize:e}=t;return e(["i18nListTitle"])},labelText:t=>{const{normalize:e}=t;return e(["labelText"])},labelCaption:t=>{const{normalize:e}=t;return e(["labelCaption"])},labelTextScale:t=>{const{normalize:e}=t;return e(["labelTextScale"])},labelTextRotation:t=>{const{normalize:e}=t;return e(["labelTextRotation"])},labelTextFamily:t=>{const{normalize:e}=t;return e(["labelTextFamily"])},labelTextStyle:t=>{const{normalize:e}=t;return e(["labelTextStyle"])},labelTextDecoration:t=>{const{normalize:e}=t;return e(["labelTextDecoration"])},labelDisplayMode:t=>{const{normalize:e}=t;return e(["labelDisplayMode"])},labelFrontFillColor:t=>{const{normalize:e}=t;return e(["labelFrontFillColor"])},labelBackFillColor:t=>{const{normalize:e}=t;return e(["labelBackFillColor"])}},_e=Qse({locale:"en",allowComposition:!0,legacy:!1,messages:{en:kae,id:Cae},fallbackWarn:!1,missingWarn:!1});class On extends Xe{constructor(){super();y(this,"_valueDisplayMode",Ni.Number);y(this,"_preEarthModeValueDisplayMode",Ni.Number);y(this,"_postEarthModeValueDisplayMode",Ni.EarthModeKilos);On.EXPR_COUNT++,this.name=`M${On.EXPR_COUNT}`}get preEarthModeValueDisplayMode(){return this._preEarthModeValueDisplayMode}get postEarthModeValueDisplayMode(){return this._postEarthModeValueDisplayMode}recordCurrentValueDisplayModeAndUpdate(i){return i?(this._preEarthModeValueDisplayMode=this._valueDisplayMode,this._valueDisplayMode=this._postEarthModeValueDisplayMode,[this._preEarthModeValueDisplayMode,this._valueDisplayMode]):(this._postEarthModeValueDisplayMode=this._valueDisplayMode,this._valueDisplayMode=this._preEarthModeValueDisplayMode,[this._postEarthModeValueDisplayMode,this._valueDisplayMode])}accept(i){return!1}prettyValue(i=!1){switch(this._valueDisplayMode){case Ni.Number:return String(this.value.toFixed(i?20:S.decimalPrecision));case Ni.MultipleOfPi:return(this.value/Math.PI).toFixed(i?20:S.decimalPrecision)+"";case Ni.DegreeDecimals:return this.value.toDegrees().toFixed(i?20:S.decimalPrecision)+"";case Ni.EarthModeMiles:return this.isPolygon()?(this.value*S.earthMode.radiusMiles*S.earthMode.radiusMiles).toFixed(i?20:S.decimalPrecision)+_e.global.t("units.mi")+"":(this.value*S.earthMode.radiusMiles).toFixed(i?20:S.decimalPrecision)+_e.global.t("units.mi");case Ni.EarthModeKilos:return this.isPolygon()?(this.value*S.earthMode.radiusKilometers*S.earthMode.radiusKilometers).toFixed(i?20:S.decimalPrecision)+_e.global.t("units.km")+"":(this.value*S.earthMode.radiusKilometers).toFixed(i?20:S.decimalPrecision)+_e.global.t("units.km")}}isHitAt(i,n){return!1}isMeasurable(){return!0}}var Vt=(t=>(t[t.ApplyTemporaryVariables=0]="ApplyTemporaryVariables",t[t.ApplyCurrentVariables=1]="ApplyCurrentVariables",t))(Vt||{});new k;const Zn=class Zn{constructor(){y(this,"styleOptions",new Map)}static setGlobalStore(e){Zn.store=e}static resetIdPlottableDescriptionMap(){Zn.idPlottableDescriptionMap.clear()}static setBackStyleContrast(e){this.globalBackStyleContrast=e}static getBackStyleContrast(){return this.globalBackStyleContrast}static contrastFillColor(e){if(Zn.hslaIsNoFillOrNoStroke(e)||Zn.globalBackStyleContrast===0)return"hsla(0,0%,0%,0)";const i=Zn.convertStringToHSLAObject(e);return i.l=1-(1-i.l)*Zn.globalBackStyleContrast,Zn.convertHSLAObjectToString(i)}static contrastStrokeColor(e){if(Zn.hslaIsNoFillOrNoStroke(e)||Zn.globalBackStyleContrast===0)return"hsla(0,0%,0%,0)";const i=Zn.convertStringToHSLAObject(e);return i.l=1-(1-i.l)*Zn.globalBackStyleContrast,Zn.convertHSLAObjectToString(i)}static contrastStrokeWidthPercent(e){return e-20*Zn.globalBackStyleContrast}static contrastPointRadiusPercent(e){return e-20*(1-Zn.globalBackStyleContrast)}static contrastTextScalePercent(e){return e-20*(1-Zn.globalBackStyleContrast)}static convertStringToHSLAObject(e){if(e){const n=e.slice(5,-1).split(",").map(r=>r.replace("%","").trim());return Number(n[3])<=0&&(n[3]="0"),{h:Number(n[0]),s:Number(n[1])/100,l:Number(n[2])/100,a:Number(n[3])}}else throw new Error("Color string is undefined")}static hslaIsNoFillOrNoStroke(e){if(e){const i=Zn.convertStringToHSLAObject(e);return Math.max(i.h,i.s,i.l,i.a)<S.tolerance}else throw new Error("Color string is undefined")}static convertHSLAObjectToString(e){return"hsla("+e.h+", "+e.s*100+"%, "+e.l*100+"%, "+e.a+")"}currentStyleState(e){return this.styleOptions.get(e)??{}}updateStyle(e,i){const n=this.styleOptions.get(e);this.styleOptions.set(e,{...n,...i}),this.stylize(1),this.adjustSize()}};y(Zn,"store"),y(Zn,"globalBackStyleContrast",S.style.backStyleContrast),y(Zn,"idPlottableDescriptionMap",new Map);let pe=Zn;var q=(t=>(t[t.Label=0]="Label",t[t.Front=1]="Front",t[t.Back=2]="Back",t[t.Advanced=3]="Advanced",t))(q||{});const $k={fillColor:S.point.drawn.fillColor.front,pointRadiusPercent:S.point.radiusPercent.front,strokeColor:S.point.drawn.strokeColor.front},Wk={dynamicBackStyle:S.point.dynamicBackStyle,fillColor:S.point.drawn.fillColor.back,pointRadiusPercent:S.point.radiusPercent.back,strokeColor:S.point.drawn.strokeColor.back},MN={fillColor:S.point.nonFree.fillColor.front,strokeColor:S.point.nonFree.strokeColor.front,pointRadiusPercent:S.point.nonFree.scalePercent},AN={fillColor:S.point.nonFree.fillColor.back,strokeColor:S.point.nonFree.strokeColor.back,pointRadiusPercent:S.point.nonFree.scalePercent,dynamicBackStyle:S.point.dynamicBackStyle},Bv={strokeColor:S.line.drawn.strokeColor.front,strokeWidthPercent:100,dashArray:S.line.drawn.dashArray.front,reverseDashArray:S.line.drawn.dashArray.reverse.front},jv={dynamicBackStyle:S.line.dynamicBackStyle,strokeColor:S.line.drawn.strokeColor.back,strokeWidthPercent:100,dashArray:S.line.drawn.dashArray.back,reverseDashArray:S.line.drawn.dashArray.reverse.back},VN={strokeColor:S.line.nonFree.strokeColor.front,dashArray:S.line.nonFree.dashArray.front,reverseDashArray:S.line.nonFree.dashArray.reverse.front,strokeWidthPercent:S.line.nonFree.scalePercent},LN={strokeColor:S.line.nonFree.strokeColor.back,strokeWidthPercent:S.line.nonFree.scalePercent,dashArray:S.line.nonFree.dashArray.back,reverseDashArray:S.line.nonFree.dashArray.reverse.back,dynamicBackStyle:S.line.dynamicBackStyle},Gk={strokeColor:S.segment.drawn.strokeColor.front,strokeWidthPercent:100,dashArray:S.segment.drawn.dashArray.front,reverseDashArray:S.segment.drawn.dashArray.reverse.front},Hk={strokeColor:S.segment.drawn.strokeColor.back,strokeWidthPercent:100,dashArray:S.segment.drawn.dashArray.back,reverseDashArray:S.segment.drawn.dashArray.reverse.back,dynamicBackStyle:S.segment.dynamicBackStyle},IN={strokeColor:S.segment.nonFree.strokeColor.front,dashArray:S.segment.nonFree.dashArray.front,reverseDashArray:S.segment.nonFree.dashArray.reverse.front,strokeWidthPercent:S.segment.nonFree.scalePercent},ON={strokeColor:S.segment.nonFree.strokeColor.back,strokeWidthPercent:S.segment.nonFree.scalePercent,dashArray:S.segment.nonFree.dashArray.back,reverseDashArray:S.segment.nonFree.dashArray.reverse.back,dynamicBackStyle:S.segment.dynamicBackStyle},qk={fillColor:S.circle.drawn.fillColor.front,strokeColor:S.circle.drawn.strokeColor.front,strokeWidthPercent:100,dashArray:S.circle.drawn.dashArray.front,reverseDashArray:S.circle.drawn.dashArray.reverse.front},Kk={dynamicBackStyle:S.circle.dynamicBackStyle,fillColor:S.circle.drawn.fillColor.back,strokeColor:S.circle.drawn.strokeColor.back,strokeWidthPercent:100,dashArray:S.circle.drawn.dashArray.back,reverseDashArray:S.circle.drawn.dashArray.reverse.back},DN={strokeColor:S.circle.nonFree.strokeColor.front,fillColor:S.circle.nonFree.fillColor.front,dashArray:S.circle.nonFree.dashArray.front,reverseDashArray:S.circle.nonFree.dashArray.reverse.front,strokeWidthPercent:S.circle.nonFree.scalePercent},NN={strokeColor:S.circle.nonFree.strokeColor.back,fillColor:S.circle.nonFree.fillColor.back,strokeWidthPercent:S.circle.nonFree.scalePercent,dashArray:S.circle.nonFree.dashArray.back,reverseDashArray:S.circle.nonFree.dashArray.reverse.back,dynamicBackStyle:S.circle.dynamicBackStyle},Xk={fillColor:S.ellipse.drawn.fillColor.front,strokeColor:S.ellipse.drawn.strokeColor.front,strokeWidthPercent:100,dashArray:S.ellipse.drawn.dashArray.front,reverseDashArray:S.ellipse.drawn.dashArray.reverse.front},Yk={dynamicBackStyle:S.ellipse.dynamicBackStyle,fillColor:S.ellipse.drawn.fillColor.back,strokeColor:S.ellipse.drawn.strokeColor.back,strokeWidthPercent:100,dashArray:S.ellipse.drawn.dashArray.back,reverseDashArray:S.ellipse.drawn.dashArray.reverse.back},RN={strokeColor:S.ellipse.nonFree.strokeColor.front,fillColor:S.ellipse.nonFree.fillColor.front,dashArray:S.ellipse.nonFree.dashArray.front,reverseDashArray:S.ellipse.nonFree.dashArray.reverse.front,strokeWidthPercent:S.ellipse.nonFree.scalePercent},FN={strokeColor:S.ellipse.nonFree.strokeColor.back,fillColor:S.ellipse.nonFree.fillColor.back,strokeWidthPercent:S.ellipse.nonFree.scalePercent,dashArray:S.ellipse.nonFree.dashArray.back,reverseDashArray:S.ellipse.nonFree.dashArray.reverse.back,dynamicBackStyle:S.ellipse.dynamicBackStyle},Zk={fillColor:S.polygon.drawn.fillColor.front},Jk={dynamicBackStyle:S.polygon.dynamicBackStyle,fillColor:S.polygon.drawn.fillColor.back},Qk={fillColor:S.angleMarker.drawn.fillColor.front,strokeColor:S.angleMarker.drawn.strokeColor.front,strokeWidthPercent:100,dashArray:S.angleMarker.drawn.dashArray.front,reverseDashArray:S.angleMarker.drawn.dashArray.reverse.front,angleMarkerTickMark:S.angleMarker.defaultTickMark,angleMarkerDoubleArc:S.angleMarker.defaultDoubleArc,angleMarkerArrowHeads:S.angleMarker.arrowHeadDisplay,angleMarkerRadiusPercent:100},eC={fillColor:S.angleMarker.drawn.fillColor.back,strokeColor:S.angleMarker.drawn.strokeColor.back,strokeWidthPercent:100,dashArray:S.angleMarker.drawn.dashArray.back,reverseDashArray:S.angleMarker.drawn.dashArray.reverse.back,angleMarkerRadiusPercent:100,dynamicBackStyle:S.angleMarker.dynamicBackStyle},tC={labelDisplayMode:Xi.NameOnly,labelDisplayText:"",labelDisplayCaption:"",labelTextFamily:S.label.family,labelTextStyle:S.label.style,labelTextDecoration:S.label.decoration,labelTextScalePercent:100,labelTextRotation:0,labelFrontFillColor:S.label.fillColor.front,labelBackFillColor:S.label.fillColor.back,labelDynamicBackStyle:S.label.dynamicBackStyle},iC={strokeColor:S.parametric.drawn.strokeColor.front,strokeWidthPercent:100,dashArray:S.parametric.drawn.dashArray.front,reverseDashArray:S.parametric.drawn.dashArray.reverse.front},nC={dynamicBackStyle:S.parametric.dynamicBackStyle,strokeColor:S.parametric.drawn.strokeColor.back,strokeWidthPercent:100,dashArray:S.parametric.drawn.dashArray.back,reverseDashArray:S.parametric.drawn.dashArray.reverse.front};var at={move:"M",line:"L",curve:"C",arc:"A",close:"Z"},y0;typeof window<"u"?y0=window:typeof global<"u"?y0=global:typeof self<"u"&&(y0=self);var tr=y0,n5,bs=Math.PI*2,xr=Math.PI*.5,$v=function(t,e,i,n,r,s){var o;return arguments.length<=1?(o=t.a,e=t.b,i=t.c,n=t.d,r=t.e,s=t.f):o=t,{translateX:r,translateY:s,scaleX:Math.sqrt(o*o+e*e),scaleY:Math.sqrt(i*i+n*n),rotation:180*Math.atan2(e,o)/Math.PI}},r5=function(t){n5=t},Wp=function(t,e){e=e&&e.identity()||new n5;for(var i=t,n=[];i&&i._matrix;)n.push(i._matrix),i=i.parent;n.reverse();for(var r=0;r<n.length;r++){var s=n[r],o=s.elements;e.multiply(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9])}return e},Ro=function(t,e,i){return i*(e-t)+t},wT=[2,4,8,16,32,64,128,256,512,1024,2048,4096],s5=function(t){for(var e=0;wT[e]&&wT[e]<t;)e++;return wT[e]},ea=function(t,e){for(;t<0;)t+=e;return t%e},ql=tr.Float32Array||Array,Mae=Math.floor,zn=function(t){return Mae(t*1e6)/1e6},Aae=Object.freeze({__proto__:null,decomposeMatrix:$v,getComputedMatrix:Wp,getPoT:s5,setMatrix:r5,lerp:Ro,mod:ea,NumArray:ql,toFixed:zn,TWO_PI:bs,HALF_PI:xr}),zN=Array.prototype.slice,Vae=function(t){if(t==null)return!1;var e=t.length;return typeof e=="number"&&e>=0&&e<4294967296},Ce={isNaN:function(t){return typeof t=="number"&&t!==+t},isElement:function(t){return!!(t&&t.nodeType===1)},isObject:function(t){var e=typeof t;return e==="function"||e==="object"&&!!t},extend:function(t){for(var e=zN.call(arguments,1),i=0;i<e.length;i++){var n=e[i];for(var r in n)t[r]=n[r]}return t},defaults:function(t){for(var e=zN.call(arguments,1),i=0;i<e.length;i++){var n=e[i];for(var r in n)t[r]===void 0&&(t[r]=n[r])}return t},each:function(t,e,i){for(var n=i||this,r=!Vae(t)&&Object.keys(t),s=(r||t).length,o=0;o<s;o++){var a=r?r[o]:o;e.call(n,t[a],a,t)}return t},performance:tr.performance&&tr.performance.now?tr.performance:Date},Be={on:o5,off:a5,trigger:function(t){var e=this;if(!e._events)return e;var i=Array.prototype.slice.call(arguments,1),n=e._events[t];return n&&Lae(e,n,i),e},listen:function(t,e,i){var n=this;if(t){var r=function(){i.apply(n,arguments)};r.obj=t,r.name=e,r.handler=i,t.on(e,r)}return n},ignore:function(t,e,i){var n=this;return t.off(e,i),n},Types:{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert",order:"order",load:"load"}};Be.bind=o5;Be.unbind=a5;function o5(t,e){var i=this;i._events||(i._events={});var n=i._events[t]||(i._events[t]=[]);return n.push(e),i}function a5(t,e){var i=this;if(!i._events)return i;if(!t&&!e)return i._events={},i;for(var n=t?[t]:Object.keys(i._events),r=0,s=n.length;r<s;r++){t=n[r];var o=i._events[t];if(o){var a=[];if(e)for(var l=0,c=o.length;l<c;l++){var u=o[l];u=u.handler?u.handler:u,e!==u&&a.push(u)}i._events[t]=a}}return i}function Lae(t,e,i){var n;switch(i.length){case 0:n=function(s){e[s].call(t,i[0])};break;case 1:n=function(s){e[s].call(t,i[0],i[1])};break;case 2:n=function(s){e[s].call(t,i[0],i[1],i[2])};break;case 3:n=function(s){e[s].call(t,i[0],i[1],i[2],i[3])};break;default:n=function(s){e[s].apply(t,i)}}for(var r=0;r<e.length;r++)n(r)}function ot(t,e){this.x=t||0,this.y=e||0}Ce.extend(ot,{zero:new ot,add:function(t,e){return new ot(t.x+e.x,t.y+e.y)},sub:function(t,e){return new ot(t.x-e.x,t.y-e.y)},subtract:function(t,e){return ot.sub(t,e)},ratioBetween:function(t,e){return(t.x*e.x+t.y*e.y)/(t.length()*e.length())},angleBetween:function(t,e){var i,n;return arguments.length>=4?(i=arguments[0]-arguments[2],n=arguments[1]-arguments[3],Math.atan2(n,i)):(i=t.x-e.x,n=t.y-e.y,Math.atan2(n,i))},distanceBetween:function(t,e){return Math.sqrt(ot.distanceBetweenSquared(t,e))},distanceBetweenSquared:function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},MakeObservable:function(t){t.bind=t.on=function(){return this._bound||(this._x=this.x,this._y=this.y,Object.defineProperty(this,"x",Oae),Object.defineProperty(this,"y",Dae),Ce.extend(this,Iae),this._bound=!0),Be.bind.apply(this,arguments),this}}});Ce.extend(ot.prototype,Be,{constructor:ot,set:function(t,e){return this.x=t,this.y=e,this},copy:function(t){return this.x=t.x,this.y=t.y,this},clear:function(){return this.x=0,this.y=0,this},clone:function(){return new ot(this.x,this.y)},add:function(t,e){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x+=t,this.y+=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x+=t.x,this.y+=t.y):(this.x+=t,this.y+=e),this)},addSelf:function(t){return this.add.apply(this,arguments)},sub:function(t,e){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x-=t,this.y-=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x-=t.x,this.y-=t.y):(this.x-=t,this.y-=e),this)},subtract:function(){return this.sub.apply(this,arguments)},subSelf:function(t){return this.sub.apply(this,arguments)},subtractSelf:function(t){return this.sub.apply(this,arguments)},multiply:function(t,e){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x*=t,this.y*=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x*=t.x,this.y*=t.y):(this.x*=t,this.y*=e),this)},multiplySelf:function(t){return this.multiply.apply(this,arguments)},multiplyScalar:function(t){return this.multiply(t)},divide:function(t,e){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x/=t,this.y/=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x/=t.x,this.y/=t.y):(this.x/=t,this.y/=e),Ce.isNaN(this.x)&&(this.x=0),Ce.isNaN(this.y)&&(this.y=0),this)},divideSelf:function(t){return this.divide.apply(this,arguments)},divideScalar:function(t){return this.divide(t)},negate:function(){return this.multiply(-1)},dot:function(t){return this.x*t.x+this.y*t.y},length:function(){return Math.sqrt(this.lengthSquared())},lengthSquared:function(){return this.x*this.x+this.y*this.y},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},setLength:function(t){return this.normalize().multiplyScalar(t)},equals:function(t,e){return e=typeof e>"u"?1e-4:e,this.distanceTo(t)<e},lerp:function(t,e){var i=(t.x-this.x)*e+this.x,n=(t.y-this.y)*e+this.y;return this.set(i,n)},isZero:function(t){return t=typeof t>"u"?1e-4:t,this.length()<t},toString:function(){return this.x+", "+this.y},toObject:function(){return{x:this.x,y:this.y}},rotate:function(t){var e=Math.cos(t),i=Math.sin(t);return this.x=this.x*e-this.y*i,this.y=this.x*i+this.y*e,this}});var Iae={constructor:ot,set:function(t,e){return this._x=t,this._y=e,this.trigger(Be.Types.change)},copy:function(t){return this._x=t.x,this._y=t.y,this.trigger(Be.Types.change)},clear:function(){return this._x=0,this._y=0,this.trigger(Be.Types.change)},clone:function(){return new ot(this._x,this._y)},add:function(t,e){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this._x+=t,this._y+=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this._x+=t.x,this._y+=t.y):(this._x+=t,this._y+=e),this.trigger(Be.Types.change))},sub:function(t,e){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this._x-=t,this._y-=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this._x-=t.x,this._y-=t.y):(this._x-=t,this._y-=e),this.trigger(Be.Types.change))},multiply:function(t,e){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this._x*=t,this._y*=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this._x*=t.x,this._y*=t.y):(this._x*=t,this._y*=e),this.trigger(Be.Types.change))},divide:function(t,e){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this._x/=t,this._y/=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this._x/=t.x,this._y/=t.y):(this._x/=t,this._y/=e),Ce.isNaN(this._x)&&(this._x=0),Ce.isNaN(this._y)&&(this._y=0),this.trigger(Be.Types.change))},dot:function(t){return this._x*t.x+this._y*t.y},lengthSquared:function(){return this._x*this._x+this._y*this._y},distanceToSquared:function(t){var e=this._x-t.x,i=this._y-t.y;return e*e+i*i},lerp:function(t,e){var i=(t.x-this._x)*e+this._x,n=(t.y-this._y)*e+this._y;return this.set(i,n)},toString:function(){return this._x+", "+this._y},toObject:function(){return{x:this._x,y:this._y}},rotate:function(t){var e=Math.cos(t),i=Math.sin(t);return this._x=this._x*e-this._y*i,this._y=this._x*i+this._y*e,this}},Oae={enumerable:!0,get:function(){return this._x},set:function(t){this._x=t,this.trigger(Be.Types.change,"x")}},Dae={enumerable:!0,get:function(){return this._y},set:function(t){this._y=t,this.trigger(Be.Types.change,"y")}};ot.MakeObservable(ot.prototype);function Ot(t,e,i,n,r,s,o){ot.call(this,t,e),this._broadcast=(function(){this.trigger(Be.Types.change)}).bind(this),this._command=o||at.move,this._relative=!0;var a=typeof i=="number",l=typeof n=="number",c=typeof r=="number",u=typeof s=="number";(a||l||c||u)&&Ot.AppendCurveProperties(this),a&&(this.controls.left.x=i),l&&(this.controls.left.y=n),c&&(this.controls.right.x=r),u&&(this.controls.right.y=s)}Ce.extend(Ot,{AppendCurveProperties:function(t){t.relative=!0,t.controls={},t.controls.left=new ot(0,0),t.controls.right=new ot(0,0)},MakeObservable:function(t){Object.defineProperty(t,"command",{enumerable:!0,get:function(){return this._command},set:function(e){this._command=e,this._command===at.curve&&!Ce.isObject(this.controls)&&Ot.AppendCurveProperties(this),this.trigger(Be.Types.change)}}),Object.defineProperty(t,"relative",{enumerable:!0,get:function(){return this._relative},set:function(e){this._relative!=e&&(this._relative=!!e,this.trigger(Be.Types.change))}}),Ce.extend(t,ot.prototype,UN),t.bind=t.on=function(){var e=this._bound;ot.prototype.bind.apply(this,arguments),e||Ce.extend(this,UN)}}});var UN={constructor:Ot,listen:function(){return Ce.isObject(this.controls)||Ot.AppendCurveProperties(this),this.controls.left.bind(Be.Types.change,this._broadcast),this.controls.right.bind(Be.Types.change,this._broadcast),this},ignore:function(){return this.controls.left.unbind(Be.Types.change,this._broadcast),this.controls.right.unbind(Be.Types.change,this._broadcast),this},copy:function(t){return this.x=t.x,this.y=t.y,typeof t.command=="string"&&(this.command=t.command),Ce.isObject(t.controls)&&(Ce.isObject(this.controls)||Ot.AppendCurveProperties(this),this.controls.left.copy(t.controls.left),this.controls.right.copy(t.controls.right)),typeof t.relative=="boolean"&&(this.relative=t.relative),this.command===at.arc&&(this.rx=t.rx,this.ry=t.ry,this.xAxisRotation=t.xAxisRotation,this.largeArcFlag=t.largeArcFlag,this.sweepFlag=t.sweepFlag),this},clone:function(){var t=this.controls,e=new Ot(this.x,this.y,t&&t.left.x,t&&t.left.y,t&&t.right.x,t&&t.right.y,this.command);return e.relative=this._relative,e},toObject:function(){var t={x:this.x,y:this.y};return this._command&&(t.command=this._command),this._relative&&(t.relative=this._relative),this.controls&&(t.controls={left:this.controls.left.toObject(),right:this.controls.right.toObject()}),t},toString:function(){return this.controls?[this._x,this._y,this.controls.left.x,this.controls.left.y,this.controls.right.x,this.controls.right.y,this._command,this._relative?1:0].join(", "):[this._x,this._y].join(", ")}};Ot.MakeObservable(Ot.prototype);var Nae=0,Ra={nextFrameID:null,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.7.13",PublishDate:"2021-12-15T21:23:06.163Z",Identifier:"two-",Resolution:12,AutoCalculateImportedMatrices:!0,Instances:[],uniqueId:function(){return Nae++}},op={CollinearityEpsilon:Math.pow(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:Number.EPSILON},abscissas:[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights:[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]]},Wv=function(t,e,i,n,r){var s=1-t;return s*s*s*e+3*s*s*t*i+3*s*t*t*n+t*t*t*r},GM=function(t,e,i,n,r,s,o,a,l){l=l||op.RecursionLimit;var c=l+1;if(Math.abs(t-o)<.001&&Math.abs(e-a)<.001)return[new Ot(o,a)];for(var u=[],h=0;h<c;h++){var d=h/c,f=Wv(d,t,i,r,o),m=Wv(d,e,n,s,a);u.push(new Ot(f,m))}return u},l5=function(t,e,i,n,r,s,o,a,l){if(t===i&&e===n&&r===o&&s===a){var c=o-t,u=a-e;return Math.sqrt(c*c+u*u)}var h=9*(i-r)+3*(o-t),d=6*(t+r)-12*i,f=3*(i-t),m=9*(n-s)+3*(a-e),g=6*(e+s)-12*n,v=3*(n-e),p=function(b){var _=(h*b+d)*b+f,P=(m*b+g)*b+v;return Math.sqrt(_*_+P*P)};return h5(p,0,1,l||op.RecursionLimit)},c5=function(t,e,i,n,r,s,o,a){for(var l=[],c=[[],[]],u,h,d,f,m,g,v,p,b=0;b<2;++b){if(b==0?(h=6*t-12*i+6*r,u=-3*t+9*i-9*r+3*o,d=3*i-3*t):(h=6*e-12*n+6*s,u=-3*e+9*n-9*s+3*a,d=3*n-3*e),Math.abs(u)<1e-12){if(Math.abs(h)<1e-12)continue;f=-d/h,0<f&&f<1&&l.push(f);continue}v=h*h-4*d*u,p=Math.sqrt(v),!(v<0)&&(m=(-h+p)/(2*u),0<m&&m<1&&l.push(m),g=(-h-p)/(2*u),0<g&&g<1&&l.push(g))}for(var _=l.length,P=_,E;_--;)f=l[_],E=1-f,c[0][_]=E*E*E*t+3*E*E*f*i+3*E*f*f*r+f*f*f*o,c[1][_]=E*E*E*e+3*E*E*f*n+3*E*f*f*s+f*f*f*a;return c[0][P]=t,c[1][P]=e,c[0][P+1]=o,c[1][P+1]=a,c[0].length=c[1].length=P+2,{min:{x:Math.min.apply(0,c[0]),y:Math.min.apply(0,c[1])},max:{x:Math.max.apply(0,c[0]),y:Math.max.apply(0,c[1])}}},h5=function(t,e,i,n){for(var r=op.abscissas[n-2],s=op.weights[n-2],o=.5*(i-e),a=o+e,l=0,c=n+1>>1,u=n&1?s[l++]*t(a):0;l<c;){var h=o*r[l];u+=s[l++]*(t(a+h)+t(a-h))}return o*u},u5=function(t,e){for(var i=t.length,n=i-1,r=0;r<i;r++){var s=t[r];Ce.isObject(s.controls)||Ot.AppendCurveProperties(s);var o=e?ea(r-1,i):Math.max(r-1,0),a=e?ea(r+1,i):Math.min(r+1,n),l=t[o],c=s,u=t[a];d5(l,c,u),c.command=r===0?at.move:at.curve}},d5=function(t,e,i){var n=ot.angleBetween(t,e),r=ot.angleBetween(i,e),s=ot.distanceBetween(t,e),o=ot.distanceBetween(i,e),a=(n+r)/2;return s<1e-4||o<1e-4?(typeof e.relative=="boolean"&&!e.relative&&(e.controls.left.copy(e),e.controls.right.copy(e)),e):(s*=.33,o*=.33,r<n?a+=xr:a-=xr,e.controls.left.x=Math.cos(a)*s,e.controls.left.y=Math.sin(a)*s,a-=Math.PI,e.controls.right.x=Math.cos(a)*o,e.controls.right.y=Math.sin(a)*o,typeof e.relative=="boolean"&&!e.relative&&(e.controls.left.x+=e.x,e.controls.left.y+=e.y,e.controls.right.x+=e.x,e.controls.right.y+=e.y),e)},rC=function(t,e,i){return new ot(2*t.x-(e.x+t.x)-(i?t.x:0),2*t.y-(e.y+t.y)-(i?t.y:0))},Rae=function(t,e,i,n,r,s,o){for(var a=Ra.Resolution,l=0;l<a;l++){var c=(l+1)/a;o&&(c=1-c);var u=c*s+r,h=i*Math.cos(u),d=n*Math.sin(u),f=new Ot(h,d);Ot.AppendCurveProperties(f),f.command=at.line}},Fae=Object.freeze({__proto__:null,Curve:op,getComponentOnCubicBezier:Wv,subdivide:GM,getCurveLength:l5,getCurveBoundingBox:c5,integrate:h5,getCurveFromPoints:u5,getControlPoints:d5,getReflection:rC,getAnchorsFromArcData:Rae}),zae=tr.devicePixelRatio||1,Uae=function(t){return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1},HM=function(t){return zae/Uae(t)},Bae=Math.cos,jae=Math.sin,BN=Math.tan,TT=[];function Jn(t,e,i,n,r,s){this.elements=new ql(9);var o=t;Array.isArray(o)||(o=Array.prototype.slice.call(arguments)),this.identity(),o.length>0&&this.set(o)}r5(Jn);Ce.extend(Jn,{Identity:[1,0,0,0,1,0,0,0,1],Multiply:function(t,e,i){if(e.length<=3){var n,r,s,o=t,a=e[0]||0,l=e[1]||0,c=e[2]||0;return n=o[0]*a+o[1]*l+o[2]*c,r=o[3]*a+o[4]*l+o[5]*c,s=o[6]*a+o[7]*l+o[8]*c,{x:n,y:r,z:s}}var u=t[0],h=t[1],d=t[2],f=t[3],m=t[4],g=t[5],v=t[6],p=t[7],b=t[8],_=e[0],P=e[1],E=e[2],T=e[3],C=e[4],M=e[5],x=e[6],V=e[7],N=e[8];return i=i||new ql(9),i[0]=u*_+h*T+d*x,i[1]=u*P+h*C+d*V,i[2]=u*E+h*M+d*N,i[3]=f*_+m*T+g*x,i[4]=f*P+m*C+g*V,i[5]=f*E+m*M+g*N,i[6]=v*_+p*T+b*x,i[7]=v*P+p*C+b*V,i[8]=v*E+p*M+b*N,i}});Ce.extend(Jn.prototype,Be,{constructor:Jn,manual:!1,set:function(t,e,i,n,r,s,o,a,l){var c;return typeof e>"u"&&(c=t,t=c[0],e=c[1],i=c[2],n=c[3],r=c[4],s=c[5],o=c[6],a=c[7],l=c[8]),this.elements[0]=t,this.elements[1]=e,this.elements[2]=i,this.elements[3]=n,this.elements[4]=r,this.elements[5]=s,this.elements[6]=o,this.elements[7]=a,this.elements[8]=l,this.trigger(Be.Types.change)},copy:function(t){return this.elements[0]=t.elements[0],this.elements[1]=t.elements[1],this.elements[2]=t.elements[2],this.elements[3]=t.elements[3],this.elements[4]=t.elements[4],this.elements[5]=t.elements[5],this.elements[6]=t.elements[6],this.elements[7]=t.elements[7],this.elements[8]=t.elements[8],this.manual=t.manual,this.trigger(Be.Types.change)},identity:function(){return this.elements[0]=Jn.Identity[0],this.elements[1]=Jn.Identity[1],this.elements[2]=Jn.Identity[2],this.elements[3]=Jn.Identity[3],this.elements[4]=Jn.Identity[4],this.elements[5]=Jn.Identity[5],this.elements[6]=Jn.Identity[6],this.elements[7]=Jn.Identity[7],this.elements[8]=Jn.Identity[8],this.trigger(Be.Types.change)},multiply:function(t,e,i,n,r,s,o,a,l){if(typeof e>"u")return this.elements[0]*=t,this.elements[1]*=t,this.elements[2]*=t,this.elements[3]*=t,this.elements[4]*=t,this.elements[5]*=t,this.elements[6]*=t,this.elements[7]*=t,this.elements[8]*=t,this.trigger(Be.Types.change);if(typeof n>"u"){var c,u,h;return t=t||0,e=e||0,i=i||0,r=this.elements,c=r[0]*t+r[1]*e+r[2]*i,u=r[3]*t+r[4]*e+r[5]*i,h=r[6]*t+r[7]*e+r[8]*i,{x:c,y:u,z:h}}var d=this.elements,f=[t,e,i,n,r,s,o,a,l],m=d[0],g=d[1],v=d[2],p=d[3],b=d[4],_=d[5],P=d[6],E=d[7],T=d[8],C=f[0],M=f[1],x=f[2],V=f[3],N=f[4],D=f[5],O=f[6],F=f[7],X=f[8];return this.elements[0]=m*C+g*V+v*O,this.elements[1]=m*M+g*N+v*F,this.elements[2]=m*x+g*D+v*X,this.elements[3]=p*C+b*V+_*O,this.elements[4]=p*M+b*N+_*F,this.elements[5]=p*x+b*D+_*X,this.elements[6]=P*C+E*V+T*O,this.elements[7]=P*M+E*N+T*F,this.elements[8]=P*x+E*D+T*X,this.trigger(Be.Types.change)},inverse:function(t){var e=this.elements;t=t||new Jn;var i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=-u*s+a*l,f=c*s-o*l,m=i*h+n*d+r*f;return m?(m=1/m,t.elements[0]=h*m,t.elements[1]=(-u*n+r*c)*m,t.elements[2]=(a*n-r*o)*m,t.elements[3]=d*m,t.elements[4]=(u*i-r*l)*m,t.elements[5]=(-a*i+r*s)*m,t.elements[6]=f*m,t.elements[7]=(-c*i+n*l)*m,t.elements[8]=(o*i-n*s)*m,t):null},scale:function(t,e){var i=arguments.length;return i<=1&&(e=t),this.multiply(t,0,0,0,e,0,0,0,1)},rotate:function(t){var e=Bae(t),i=jae(t);return this.multiply(e,-i,0,i,e,0,0,0,1)},translate:function(t,e){return this.multiply(1,0,t,0,1,e,0,0,1)},skewX:function(t){var e=BN(t);return this.multiply(1,e,0,0,1,0,0,0,1)},skewY:function(t){var e=BN(t);return this.multiply(1,0,0,e,1,0,0,0,1)},toString:function(t){return TT.length=0,this.toTransformArray(t,TT),TT.map(zn).join(" ")},toTransformArray:function(t,e){var i=this.elements,n=!!e,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5];if(t){var u=i[6],h=i[7],d=i[8];if(n){e[0]=r,e[1]=a,e[2]=u,e[3]=s,e[4]=l,e[5]=h,e[6]=o,e[7]=c,e[8]=d;return}return[r,a,u,s,l,h,o,c,d]}if(n){e[0]=r,e[1]=a,e[2]=s,e[3]=l,e[4]=o,e[5]=c;return}return[r,a,s,l,o,c]},toArray:function(t,e){var i=this.elements,n=!!e,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5];if(t){var u=i[6],h=i[7],d=i[8];if(n){e[0]=r,e[1]=s,e[2]=o,e[3]=a,e[4]=l,e[5]=c,e[6]=u,e[7]=h,e[8]=d;return}return[r,s,o,a,l,c,u,h,d]}if(n){e[0]=r,e[1]=s,e[2]=o,e[3]=a,e[4]=l,e[5]=c;return}return[r,s,o,a,l,c]},toObject:function(){return{elements:this.toArray(!0),manual:!!this.manual}},clone:function(){return new Jn().copy(this)}});function rn(){this.renderer={},this._renderer.flagMatrix=rn.FlagMatrix.bind(this),this.isShape=!0,this.id=Ra.Identifier+Ra.uniqueId(),this.classList=[],this.matrix=new Jn,this.translation=new ot,this.rotation=0,this.scale=1,this.skewX=0,this.skewY=0}Ce.extend(rn,{FlagMatrix:function(){this._flagMatrix=!0},MakeObservable:function(t){var e={enumerable:!1,get:function(){return this._translation},set:function(i){this._translation&&this._translation.unbind(Be.Types.change,this._renderer.flagMatrix),this._translation=i,this._translation.bind(Be.Types.change,this._renderer.flagMatrix),rn.FlagMatrix.call(this)}};Object.defineProperty(t,"translation",e),Object.defineProperty(t,"position",e),Object.defineProperty(t,"rotation",{enumerable:!0,get:function(){return this._rotation},set:function(i){this._rotation=i,this._flagMatrix=!0}}),Object.defineProperty(t,"scale",{enumerable:!0,get:function(){return this._scale},set:function(i){this._scale instanceof ot&&this._scale.unbind(Be.Types.change,this._renderer.flagMatrix),this._scale=i,this._scale instanceof ot&&this._scale.bind(Be.Types.change,this._renderer.flagMatrix),this._flagMatrix=!0,this._flagScale=!0}}),Object.defineProperty(t,"skewX",{enumerable:!0,get:function(){return this._skewX},set:function(i){this._skewX=i,this._flagMatrix=!0}}),Object.defineProperty(t,"skewY",{enumerable:!0,get:function(){return this._skewY},set:function(i){this._skewY=i,this._flagMatrix=!0}}),Object.defineProperty(t,"matrix",{enumerable:!0,get:function(){return this._matrix},set:function(i){this._matrix=i,this._flagMatrix=!0}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return this._id},set:function(i){var n=this._id;i!==this._id&&(this._id=i,this._flagId=!0,this.parent&&(delete this.parent.children.ids[n],this.parent.children.ids[this._id]=this))}}),Object.defineProperty(t,"className",{enumerable:!0,get:function(){return this._className},set:function(i){if(this._flagClassName=this._className!==i,this._flagClassName){for(var n=this._className.split(/\s+?/),r=i.split(/\s+?/),s=0;s<n.length;s++){var o=n[s],a=Array.prototype.indexOf.call(this.classList,o);a>=0&&this.classList.splice(a,1)}this.classList=this.classList.concat(r)}this._className=i}}),Object.defineProperty(t,"renderer",{enumerable:!1,get:function(){return this._renderer},set:function(i){this._renderer=i}})}});Ce.extend(rn.prototype,Be,{constructor:rn,_flagId:!0,_flagMatrix:!0,_flagScale:!1,_flagClassName:!1,_id:"",_translation:null,_rotation:0,_scale:1,_skewX:0,_skewY:0,_className:"",addTo:function(t){return t.add(this),this},clone:function(t){var e=new rn;return e.translation.copy(this.translation),e.rotation=this.rotation,e.scale=this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&e.matrix.copy(this.matrix),t&&t.add(e),e._update()},_update:function(t){return!this._matrix.manual&&this._flagMatrix&&(this._matrix.identity().translate(this.translation.x,this.translation.y),this._scale instanceof ot?this._matrix.scale(this._scale.x,this._scale.y):this._matrix.scale(this._scale),this._matrix.rotate(this.rotation),this._matrix.skewX(this.skewX),this._matrix.skewY(this.skewY)),t&&this.parent&&this.parent._update&&this.parent._update(),this},flagReset:function(){return this._flagId=this._flagMatrix=this._flagScale=this._flagClassName=!1,this}});rn.MakeObservable(rn.prototype);function Fa(){Array.call(this),arguments[0]&&Array.isArray(arguments[0])?arguments[0].length>0&&Array.prototype.push.apply(this,arguments[0]):arguments.length>0&&Array.prototype.push.apply(this,arguments)}Fa.prototype=new Array;Ce.extend(Fa.prototype,Be,{constructor:Fa,pop:function(){var t=Array.prototype.pop.apply(this,arguments);return this.trigger(Be.Types.remove,[t]),t},shift:function(){var t=Array.prototype.shift.apply(this,arguments);return this.trigger(Be.Types.remove,[t]),t},push:function(){var t=Array.prototype.push.apply(this,arguments);return this.trigger(Be.Types.insert,arguments),t},unshift:function(){var t=Array.prototype.unshift.apply(this,arguments);return this.trigger(Be.Types.insert,arguments),t},splice:function(){var t=Array.prototype.splice.apply(this,arguments),e;return this.trigger(Be.Types.remove,t),arguments.length>2&&(e=this.slice(arguments[0],arguments[0]+arguments.length-2),this.trigger(Be.Types.insert,e),this.trigger(Be.Types.order)),t},sort:function(){return Array.prototype.sort.apply(this,arguments),this.trigger(Be.Types.order),this},reverse:function(){return Array.prototype.reverse.apply(this,arguments),this.trigger(Be.Types.order),this},indexOf:function(){return Array.prototype.indexOf.apply(this,arguments)}});function Gv(t){Fa.apply(this,arguments),Object.defineProperty(this,"_events",{value:{},enumerable:!1}),this.ids={},this.attach(Array.isArray(t)?t:Array.prototype.slice.call(arguments)),this.on(Be.Types.insert,this.attach),this.on(Be.Types.remove,this.detach)}Gv.prototype=new Fa;Ce.extend(Gv.prototype,{constructor:Gv,attach:function(t){for(var e=0;e<t.length;e++){var i=t[e];i&&i.id&&(this.ids[i.id]=i)}return this},detach:function(t){for(var e=0;e<t.length;e++)delete this.ids[t[e].id];return this}});var fb=Math.min,mb=Math.max;function mn(t){rn.call(this),this._renderer.type="group",this.additions=[],this.subtractions=[],this.children=Array.isArray(t)?t:Array.prototype.slice.call(arguments)}Ce.extend(mn,{Children:Gv,InsertChildren:function(t){for(var e=0;e<t.length;e++)jN.call(this,t[e],this)},RemoveChildren:function(t){for(var e=0;e<t.length;e++)jN.call(this,t[e])},OrderChildren:function(t){this._flagOrder=!0},Properties:["fill","stroke","linewidth","cap","join","miter","closed","curved","automatic"],MakeObservable:function(t){var e=mn.Properties;Object.defineProperty(t,"visible",{enumerable:!0,get:function(){return this._visible},set:function(i){this._flagVisible=this._visible!==i||this._flagVisible,this._visible=i}}),Object.defineProperty(t,"opacity",{enumerable:!0,get:function(){return this._opacity},set:function(i){this._flagOpacity=this._opacity!==i||this._flagOpacity,this._opacity=i}}),Object.defineProperty(t,"beginning",{enumerable:!0,get:function(){return this._beginning},set:function(i){this._flagBeginning=this._beginning!==i||this._flagBeginning,this._beginning=i}}),Object.defineProperty(t,"ending",{enumerable:!0,get:function(){return this._ending},set:function(i){this._flagEnding=this._ending!==i||this._flagEnding,this._ending=i}}),Object.defineProperty(t,"length",{enumerable:!0,get:function(){if(this._flagLength||this._length<=0){if(this._length=0,!this.children)return this._length;for(var i=0;i<this.children.length;i++){var n=this.children[i];this._length+=n.length}}return this._length}}),rn.MakeObservable(t),mn.MakeGetterSetters(t,e),Object.defineProperty(t,"children",{enumerable:!0,get:function(){return this._children},set:function(i){var n=mn.InsertChildren.bind(this),r=mn.RemoveChildren.bind(this),s=mn.OrderChildren.bind(this);this._children&&(this._children.unbind(),this._children.length>0&&r(this._children)),this._children=new Gv(i),this._children.bind(Be.Types.insert,n),this._children.bind(Be.Types.remove,r),this._children.bind(Be.Types.order,s),i.length>0&&n(i)}}),Object.defineProperty(t,"mask",{enumerable:!0,get:function(){return this._mask},set:function(i){this._mask&&(this._mask.clip=!1),this._mask=i,this._flagMask=!0,i&&!i.clip&&(i.clip=!0)}})},MakeGetterSetters:function(t,e){Array.isArray(e)||(e=[e]),Ce.each(e,function(i){mn.MakeGetterSetter(t,i)})},MakeGetterSetter:function(t,e){var i="_"+e;Object.defineProperty(t,e,{enumerable:!0,get:function(){return this[i]},set:function(n){this[i]=n;for(var r=0;r<this.children.length;r++){var s=this.children[r];s[e]=n}}})}});Ce.extend(mn.prototype,rn.prototype,{constructor:mn,_flagAdditions:!1,_flagSubtractions:!1,_flagOrder:!1,_flagOpacity:!0,_flagBeginning:!1,_flagEnding:!1,_flagLength:!1,_flagMask:!1,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,_length:0,_mask:null,clone:function(t){var e=new mn,i=this.children.map(function(n){return n.clone()});return e.add(i),e.opacity=this.opacity,this.mask&&(e.mask=this.mask),e.translation.copy(this.translation),e.rotation=this.rotation,e.scale=this.scale,e.className=this.className,this.matrix.manual&&e.matrix.copy(this.matrix),t&&t.add(e),e._update()},toObject:function(){var t={children:[],translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale instanceof ot?this.scale.toObject():this.scale,opacity:this.opacity,className:this.className,mask:this.mask?this.mask.toObject():null};return this.matrix.manual&&(t.matrix=this.matrix.toObject()),Ce.each(this.children,function(e,i){t.children[i]=e.toObject()},this),t},corner:function(){for(var t=this.getBoundingClientRect(!0),e=0;e<this.children.length;e++){var i=this.children[e];i.translation.x-=t.left,i.translation.y-=t.top}return this.mask&&(this.mask.translation.x-=t.left,this.mask.translation.y-=t.top),this},center:function(){for(var t=this.getBoundingClientRect(!0),e=t.left+t.width/2-this.translation.x,i=t.top+t.height/2-this.translation.y,n=0;n<this.children.length;n++){var r=this.children[n];r.isShape&&(r.translation.x-=e,r.translation.y-=i)}return this.mask&&(this.mask.translation.x-=e,this.mask.translation.y-=i),this},getById:function(t){var e=null;function i(n){if(n.id===t)return n;if(n.children){for(var r=0;r<n.children.length;r++)if(e=i(n.children[r]),e)return e}return null}return i(this)},getByClassName:function(t){var e=[];function i(n){if(Array.prototype.indexOf.call(n.classList,t)>=0&&e.push(n),n.children)for(var r=0;r<n.children.length;r++){var s=n.children[r];i(s)}return e}return i(this)},getByType:function(t){var e=[];function i(n){if(n instanceof t&&e.push(n),n.children)for(var r=0;r<n.children.length;r++){var s=n.children[r];i(s)}return e}return i(this)},add:function(t){t instanceof Array?t=t.slice():t=Array.prototype.slice.call(arguments);for(var e=0;e<t.length;e++){var i=t[e];if(i&&i.id){var n=Array.prototype.indexOf.call(this.children,i);n>=0&&this.children.splice(n,1),this.children.push(i)}}return this},remove:function(t){var e=arguments.length,i=this.parent;if(e<=0&&i)return i.remove(this),this;t instanceof Array?t=t.slice():t=Array.prototype.slice.call(arguments);for(var n=0;n<t.length;n++){var r=t[n];if(!(!r||!this.children.ids[r.id])){var s=this.children.indexOf(r);s>=0&&this.children.splice(s,1)}}return this},getBoundingClientRect:function(t){var e,i,n,r,s,o,a,l,c,u;this._update(!0);var h=1/0,d=-1/0,f=1/0,m=-1/0,g=/texture|gradient/i;i=t?this._matrix:Wp(this);for(var v=0;v<this.children.length;v++){var p=this.children[v];!p.visible||g.test(p._renderer.type)||(e=p.getBoundingClientRect(t),a=typeof e.top!="number"||Ce.isNaN(e.top)||!isFinite(e.top),l=typeof e.left!="number"||Ce.isNaN(e.left)||!isFinite(e.left),c=typeof e.right!="number"||Ce.isNaN(e.right)||!isFinite(e.right),u=typeof e.bottom!="number"||Ce.isNaN(e.bottom)||!isFinite(e.bottom),!(a||l||c||u)&&(f=fb(e.top,f),h=fb(e.left,h),d=mb(e.right,d),m=mb(e.bottom,m)))}return t&&(n=i.multiply(h,f,1),r=i.multiply(h,m,1),s=i.multiply(d,f,1),o=i.multiply(d,m,1),f=fb(n.y,r.y,s.y,o.y),h=fb(n.x,r.x,s.x,o.x),d=mb(n.x,r.x,s.x,o.x),m=mb(n.y,r.y,s.y,o.y)),{top:f,left:h,right:d,bottom:m,width:d-h,height:m-f}},noFill:function(){return this.children.forEach(function(t){t.noFill()}),this},noStroke:function(){return this.children.forEach(function(t){t.noStroke()}),this},subdivide:function(){var t=arguments;return this.children.forEach(function(e){e.subdivide.apply(e,t)}),this},_update:function(){var t,e,i;if(this._flagBeginning||this._flagEnding){var n=Math.min(this._beginning,this._ending),r=Math.max(this._beginning,this._ending),s=this.length,o=0,a=n*s,l=r*s;for(t=0;t<this.children.length;t++)i=this.children[t],e=i.length,a>o+e?(i.beginning=1,i.ending=1):l<o?(i.beginning=0,i.ending=0):a>o&&a<o+e?(i.beginning=(a-o)/e,i.ending=1):l>o&&l<o+e?(i.beginning=0,i.ending=(l-o)/e):(i.beginning=0,i.ending=1),o+=e}return rn.prototype._update.apply(this,arguments)},flagReset:function(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),this._flagOrder=this._flagMask=this._flagOpacity=this._flagBeginning=this._flagEnding=!1,rn.prototype.flagReset.call(this),this}});mn.MakeObservable(mn.prototype);function jN(t,e){var i=t.parent,n;if(i===e){r();return}if(i&&i.children.ids[t.id]&&(n=Array.prototype.indexOf.call(i.children,t),i.children.splice(n,1),s()),e){r();return}s(),i._flagAdditions&&i.additions.length===0&&(i._flagAdditions=!1),i._flagSubtractions&&i.subtractions.length===0&&(i._flagSubtractions=!1),delete t.parent;function r(){e.subtractions.length>0&&(n=Array.prototype.indexOf.call(e.subtractions,t),n>=0&&e.subtractions.splice(n,1)),e.additions.length>0&&(n=Array.prototype.indexOf.call(e.additions,t),n>=0&&e.additions.splice(n,1)),t.parent=e,e.additions.push(t),e._flagAdditions=!0}function s(){n=Array.prototype.indexOf.call(i.additions,t),n>=0&&i.additions.splice(n,1),n=Array.prototype.indexOf.call(i.subtractions,t),n<0&&(i.subtractions.push(t),i._flagSubtractions=!0)}}var $N=new Jn,xT=[],sC=Math.max,$ae=Math.min,WN=Math.abs,pb=Math.sin,gb=Math.cos,Wae=Math.acos,h_=Math.sqrt,vb=function(t){return t[0]==1&&t[3]==0&&t[1]==0&&t[4]==1&&t[2]==0&&t[5]==0},Xn={isHidden:/(undefined|none|transparent)/i,alignments:{left:"start",middle:"center",right:"end"},shim:function(t,e){return t.tagName=t.nodeName=e||"canvas",t.nodeType=1,t.getAttribute=function(i){return this[i]},t.setAttribute=function(i,n){return this[i]=n,this},t},group:{renderChild:function(t){Xn[t._renderer.type].render.call(t,this.ctx,!0,this.clip)},render:function(t){if(!this._visible)return this;this._update();var e=this._matrix.elements,i=this.parent;this._renderer.opacity=this._opacity*(i&&i._renderer?i._renderer.opacity:1);var n=this._mask,r=vb(e),s=!r||!!n;if(this._renderer.context||(this._renderer.context={}),this._renderer.context.ctx=t,s&&(t.save(),r||t.transform(e[0],e[3],e[1],e[4],e[2],e[5])),n&&Xn[n._renderer.type].render.call(n,t,!0),this._opacity>0&&this._scale!==0)for(var o=0;o<this.children.length;o++){var a=this.children[o];Xn[a._renderer.type].render.call(a,t)}return s&&t.restore(),this.flagReset()}},path:{render:function(t,e,i){var n,r,s,o,a,l,c,u,h,d,f,m,g,v,p,b,_,P,E,T,C,M,x,V,N,D,O,F,X,Z,K,z,H,re;if(re=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,X=this._mask,Z=this._clip,a=this._opacity*(re||1),l=this._visible,!e&&(!l||Z||a===0))return this;this._update(),n=this._matrix.elements,r=this._stroke,s=this._linewidth,o=this._fill,c=this._cap,u=this._join,h=this._miter,d=this._closed,f=this._renderer.vertices,m=f.length,g=m-1,K=vb(n),H=this.dashes,K||(t.save(),t.transform(n[0],n[3],n[1],n[4],n[2],n[5])),X&&Xn[X._renderer.type].render.call(X,t,!0),o&&(typeof o=="string"?t.fillStyle=o:(Xn[o._renderer.type].render.call(o,t,this),t.fillStyle=o._renderer.effect)),r&&(typeof r=="string"?t.strokeStyle=r:(Xn[r._renderer.type].render.call(r,t,this),t.strokeStyle=r._renderer.effect),s&&(t.lineWidth=s),h&&(t.miterLimit=h),u&&(t.lineJoin=u),!d&&c&&(t.lineCap=c)),typeof a=="number"&&(t.globalAlpha=a),H&&H.length>0&&(t.lineDashOffset=H.offset||0,t.setLineDash(H)),t.beginPath();for(var ne=0;ne<m;ne++)switch(b=f[ne],O=b.x,F=b.y,b.command){case at.close:t.closePath();break;case at.arc:var B=b.rx,Q=b.ry,fe=b.xAxisRotation,ie=b.largeArcFlag,se=b.sweepFlag;v=d?ea(ne-1,m):sC(ne-1,0),p=f[v];var ee=p.x,de=p.y;Xn.renderSvgArcCommand(t,ee,de,B,Q,ie,se,fe,O,F);break;case at.curve:v=d?ea(ne-1,m):Math.max(ne-1,0),p=f[v],x=p.controls&&p.controls.right||ot.zero,V=b.controls&&b.controls.left||ot.zero,p._relative?(C=x.x+p.x,M=x.y+p.y):(C=x.x,M=x.y),b._relative?(E=V.x+b.x,T=V.y+b.y):(E=V.x,T=V.y),t.bezierCurveTo(C,M,E,T,O,F),ne>=g&&d&&(_=P,N=b.controls&&b.controls.right||ot.zero,D=_.controls&&_.controls.left||ot.zero,b._relative?(C=N.x+b.x,M=N.y+b.y):(C=N.x,M=N.y),_._relative?(E=D.x+_.x,T=D.y+_.y):(E=D.x,T=D.y),O=_.x,F=_.y,t.bezierCurveTo(C,M,E,T,O,F));break;case at.line:t.lineTo(O,F);break;case at.move:P=b,t.moveTo(O,F);break}return d&&t.closePath(),!Z&&!i&&(Xn.isHidden.test(o)||(z=o._renderer&&o._renderer.offset,z&&(t.save(),t.translate(-o._renderer.offset.x,-o._renderer.offset.y),t.scale(o._renderer.scale.x,o._renderer.scale.y)),t.fill(),z&&t.restore()),Xn.isHidden.test(r)||(z=r._renderer&&r._renderer.offset,z&&(t.save(),t.translate(-r._renderer.offset.x,-r._renderer.offset.y),t.scale(r._renderer.scale.x,r._renderer.scale.y),t.lineWidth=s/r._renderer.scale.x),t.stroke(),z&&t.restore())),K||t.restore(),Z&&!i&&t.clip(),H&&H.length>0&&t.setLineDash(xT),this.flagReset()}},points:{render:function(t,e,i){var n,r,s,o,a,l,c,u,h,d,f,m,g,v,p,b;if(b=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,a=this._opacity*(b||1),l=this._visible,!e&&(!l||a===0))return this;this._update(),n=this._matrix.elements,r=this._stroke,s=this._linewidth,o=this._fill,u=this._renderer.collection,h=u.length,g=vb(n),p=this.dashes,c=this._size,g||(t.save(),t.transform(n[0],n[3],n[1],n[4],n[2],n[5])),o&&(typeof o=="string"?t.fillStyle=o:(Xn[o._renderer.type].render.call(o,t,this),t.fillStyle=o._renderer.effect)),r&&(typeof r=="string"?t.strokeStyle=r:(Xn[r._renderer.type].render.call(r,t,this),t.strokeStyle=r._renderer.effect),s&&(t.lineWidth=s)),typeof a=="number"&&(t.globalAlpha=a),p&&p.length>0&&(t.lineDashOffset=p.offset||0,t.setLineDash(p)),t.beginPath();var _=c*.5,P;this._sizeAttenuation||(Wp(this,$N),P=$N.elements,P=$v(P[0],P[3],P[1],P[4],P[2],P[5]),_/=Math.max(P.scaleX,P.scaleY));for(var E=0;E<h;E++)d=u[E],f=d.x,m=d.y,t.moveTo(f+_,m),t.arc(f,m,_,0,bs);return i||(Xn.isHidden.test(o)||(v=o._renderer&&o._renderer.offset,v&&(t.save(),t.translate(-o._renderer.offset.x,-o._renderer.offset.y),t.scale(o._renderer.scale.x,o._renderer.scale.y)),t.fill(),v&&t.restore()),Xn.isHidden.test(r)||(v=r._renderer&&r._renderer.offset,v&&(t.save(),t.translate(-r._renderer.offset.x,-r._renderer.offset.y),t.scale(r._renderer.scale.x,r._renderer.scale.y),t.lineWidth=s/r._renderer.scale.x),t.stroke(),v&&t.restore())),g||t.restore(),p&&p.length>0&&t.setLineDash(xT),this.flagReset()}},text:{render:function(t,e,i){var n=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,r=this._opacity*n,s=this._visible,o=this._mask,a=this._clip;if(!e&&(!s||a||r===0))return this;this._update();var l=this._matrix.elements,c=this._stroke,u=this._linewidth,h=this._fill,d=this._decoration,f=vb(l),m=h._renderer&&h._renderer.offset&&c._renderer&&c._renderer.offset,g=this.dashes,v=Xn.alignments[this._alignment]||this._alignment,p=this._baseline,b,_,P,E,T,C,M,x,V,N,D;if(f||(t.save(),t.transform(l[0],l[3],l[1],l[4],l[2],l[5])),o&&Xn[o._renderer.type].render.call(o,t,!0),m||(t.font=[this._style,this._weight,this._size+"px/"+this._leading+"px",this._family].join(" ")),t.textAlign=v,t.textBaseline=p,h&&(typeof h=="string"?t.fillStyle=h:(Xn[h._renderer.type].render.call(h,t,this),t.fillStyle=h._renderer.effect)),c&&(typeof c=="string"?t.strokeStyle=c:(Xn[c._renderer.type].render.call(c,t,this),t.strokeStyle=c._renderer.effect),u&&(t.lineWidth=u)),typeof r=="number"&&(t.globalAlpha=r),g&&g.length>0&&(t.lineDashOffset=g.offset||0,t.setLineDash(g)),!a&&!i&&(Xn.isHidden.test(h)||(h._renderer&&h._renderer.offset?(C=h._renderer.scale.x,M=h._renderer.scale.y,t.save(),t.translate(-h._renderer.offset.x,-h._renderer.offset.y),t.scale(C,M),b=this._size/h._renderer.scale.y,_=this._leading/h._renderer.scale.y,t.font=[this._style,this._weight,b+"px/",_+"px",this._family].join(" "),P=h._renderer.offset.x/h._renderer.scale.x,E=h._renderer.offset.y/h._renderer.scale.y,t.fillText(this.value,P,E),t.restore()):t.fillText(this.value,0,0)),Xn.isHidden.test(c)||(c._renderer&&c._renderer.offset?(C=c._renderer.scale.x,M=c._renderer.scale.y,t.save(),t.translate(-c._renderer.offset.x,-c._renderer.offset.y),t.scale(C,M),b=this._size/c._renderer.scale.y,_=this._leading/c._renderer.scale.y,t.font=[this._style,this._weight,b+"px/",_+"px",this._family].join(" "),P=c._renderer.offset.x/c._renderer.scale.x,E=c._renderer.offset.y/c._renderer.scale.y,T=u/c._renderer.scale.x,t.lineWidth=T,t.strokeText(this.value,P,E),t.restore()):t.strokeText(this.value,0,0))),/(underline|strikethrough)/i.test(d)){var O=t.measureText(this.value),F=1;switch(d){case"underline":V=O.actualBoundingBoxAscent,D=O.actualBoundingBoxAscent;break;case"strikethrough":V=0,D=0,F=.5;break}switch(p){case"top":V+=this._size*F,D+=this._size*F;break;case"baseline":case"bottom":V-=this._size*F,D-=this._size*F;break}switch(v){case"left":case"start":x=0,N=O.width;break;case"right":case"end":x=-O.width,N=0;break;default:x=-O.width/2,N=O.width/2}t.lineWidth=Math.max(Math.floor(this._size/15),1),t.strokeStyle=t.fillStyle,t.beginPath(),t.moveTo(x,V),t.lineTo(N,D),t.stroke()}return f||t.restore(),a&&!i&&t.clip(),g&&g.length>0&&t.setLineDash(xT),this.flagReset()}},"linear-gradient":{render:function(t,e){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){var i,n=this.left._x,r=this.left._y,s=this.right._x,o=this.right._y;/objectBoundingBox/i.test(this._units)&&(i=e.getBoundingClientRect(!0),n=(n-.5)*i.width,r=(r-.5)*i.height,s=(s-.5)*i.width,o=(o-.5)*i.height),this._renderer.effect=t.createLinearGradient(n,r,s,o);for(var a=0;a<this.stops.length;a++){var l=this.stops[a];this._renderer.effect.addColorStop(l._offset,l._color)}}return this.flagReset()}},"radial-gradient":{render:function(t,e){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){var i,n=this.center._x,r=this.center._y,s=this.focal._x,o=this.focal._y;/objectBoundingBox/i.test(this._units)&&(i=e.getBoundingClientRect(!0),n=(n-.5)*i.width,r=(r-.5)*i.height,s=(s-.5)*i.width,o=(o-.5)*i.height),this._renderer.effect=t.createRadialGradient(n,r,0,s,o,this._radius);for(var a=0;a<this.stops.length;a++){var l=this.stops[a];this._renderer.effect.addColorStop(l._offset,l._color)}}return this.flagReset()}},texture:{render:function(t){this._update();var e=this.image;return(!this._renderer.effect||(this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)&&(this._renderer.effect=t.createPattern(this.image,this._repeat)),(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof ot||(this._renderer.offset=new ot),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,e&&(this._renderer.offset.x+=e.width/2,this._renderer.offset.y+=e.height/2,this._scale instanceof ot?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof ot||(this._renderer.scale=new ot),this._scale instanceof ot?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},renderSvgArcCommand:function(t,e,i,n,r,s,o,a,l,c){a=a*Math.PI/180,n=WN(n),r=WN(r);var u=(e-l)/2,h=(i-c)/2,d=gb(a)*u+pb(a)*h,f=-pb(a)*u+gb(a)*h,m=n*n,g=r*r,v=d*d,p=f*f,b=v/m+p/g;if(b>1){var _=h_(b);n=_*n,r=_*r,m=n*n,g=r*r}var P=m*p+g*v,E=(m*g-P)/P,T=h_(sC(0,E));s===o&&(T=-T);var C=T*n*f/r,M=-T*r*d/n,x=gb(a)*C-pb(a)*M+(e+l)/2,V=pb(a)*C+gb(a)*M+(i+c)/2,N=GN(1,0,(d-C)/n,(f-M)/r),D=GN((d-C)/n,(f-M)/r,(-d-C)/n,(-f-M)/r)%bs,O=N+D,F=o===0;Gae(t,x,V,n,r,N,O,F,a)}};function Wd(t){var e=t.smoothing!==!1;this.domElement=t.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=t.overdraw||!1,typeof this.ctx.imageSmoothingEnabled<"u"&&(this.ctx.imageSmoothingEnabled=e),this.scene=new mn,this.scene.parent=this}Ce.extend(Wd,{Utils:Xn});Ce.extend(Wd.prototype,Be,{constructor:Wd,setSize:function(t,e,i){return this.width=t,this.height=e,this.ratio=typeof i>"u"?HM(this.ctx):i,this.domElement.width=t*this.ratio,this.domElement.height=e*this.ratio,this.domElement.style&&Ce.extend(this.domElement.style,{width:t+"px",height:e+"px"}),this.trigger(Be.Types.resize,t,e,i)},render:function(){var t=this.ratio===1;return t||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),Xn.group.render.call(this.scene,this.ctx),t||this.ctx.restore(),this}});function Gae(t,e,i,n,r,s,o,a,l){var c=op.Tolerance.epsilon,u=o-s,h=Math.abs(u)<c;u=ea(u,bs),u<c&&(h?u=0:u=bs),a===!0&&!h&&(u===bs?u=-bs:u=u-bs);for(var d=0;d<Ra.Resolution;d++){var f=d/(Ra.Resolution-1),m=s+f*u,g=e+n*Math.cos(m),v=i+r*Math.sin(m);if(l!==0){var p=Math.cos(l),b=Math.sin(l),_=g-e,P=v-i;g=_*p-P*b+e,v=_*b+P*p+i}t.lineTo(g,v)}}function GN(t,e,i,n){var r=t*i+e*n,s=h_(t*t+e*e)*h_(i*i+n*n),o=Wae(sC(-1,$ae(1,r/s)));return t*n-e*i<0&&(o=-o),o}var Fo={Image:null,isHeadless:!1,shim:function(t,e){return Wd.Utils.shim(t),typeof e<"u"&&(Fo.Image=e),Fo.isHeadless=!0,t}},Bo={hasEventListeners:typeof tr.addEventListener=="function",bind:function(t,e,i,n){return this.hasEventListeners?t.addEventListener(e,i,!!n):t.attachEvent("on"+e,i),Bo},unbind:function(t,e,i,n){return Bo.hasEventListeners?t.removeEventListeners(e,i,!!n):t.detachEvent("on"+e,i),Bo},getRequestAnimationFrame:function(){var t=0,e=["ms","moz","webkit","o"],i=tr.requestAnimationFrame,n;if(!i){for(var r=0;r<e.length;r++)i=tr[e[r]+"RequestAnimationFrame"]||i,n=tr[e[r]+"CancelAnimationFrame"]||tr[e[r]+"CancelRequestAnimationFrame"]||n;i=i||function(s,o){var a=new Date().getTime(),l=Math.max(0,16-(a-t)),c=tr.setTimeout(function(){s(a+l)},l);return t=a+l,c}}return i}},am=tr.document?tr.document.createElement("div"):{};am.id="help-two-load";Object.defineProperty(Bo,"temp",{enumerable:!0,get:function(){return Ce.isElement(am)&&!tr.document.head.contains(am)&&(Ce.extend(am.style,{display:"none"}),tr.document.head.appendChild(am)),am}});function Po(t){this.name="Two.js",this.message=t}Po.prototype=new Error;Ce.extend(Po.prototype,{constructor:Po});var Vs=function(t){var e=this,i="_"+t,n="_flag"+t.charAt(0).toUpperCase()+t.slice(1);Object.defineProperty(e,t,{enumerable:!0,get:function(){return this[i]},set:function(r){this[i]=r,this[n]=!0}})};function ap(){this.map={}}Ce.extend(ap.prototype,{constructor:ap,add:function(t,e){return this.map[t]=e,this},remove:function(t){return delete this.map[t],this},get:function(t){return this.map[t]},contains:function(t){return t in this.map}});function Cr(t,e,i){this.renderer={},this._renderer.type="stop",this.offset=typeof t=="number"?t:Cr.Index<=0?0:1,this.opacity=typeof i=="number"?i:1,this.color=typeof e=="string"?e:Cr.Index<=0?"#fff":"#000",Cr.Index=(Cr.Index+1)%2}Ce.extend(Cr,{Index:0,Properties:["offset","opacity","color"],MakeObservable:function(t){Ce.each(Cr.Properties,function(e){var i=this,n="_"+e,r="_flag"+e.charAt(0).toUpperCase()+e.slice(1);Object.defineProperty(i,e,{enumerable:!0,get:function(){return this[n]},set:function(s){this[n]=s,this[r]=!0,this.parent&&(this.parent._flagStops=!0)}})},t),Object.defineProperty(t,"renderer",{enumerable:!1,get:function(){return this._renderer},set:function(e){this._renderer=e}})}});Ce.extend(Cr.prototype,Be,{constructor:Cr,clone:function(){var t=new Cr;return Ce.each(Cr.Properties,function(e){t[e]=this[e]},this),t},toObject:function(){var t={};return Ce.each(Cr.Properties,function(e){t[e]=this[e]},this),t},flagReset:function(){return this._flagOffset=this._flagColor=this._flagOpacity=!1,this}});Cr.MakeObservable(Cr.prototype);function Ai(t){this.renderer={},this._renderer.type="gradient",this.id=Ra.Identifier+Ra.uniqueId(),this.classList=[],this._renderer.flagStops=Ai.FlagStops.bind(this),this._renderer.bindStops=Ai.BindStops.bind(this),this._renderer.unbindStops=Ai.UnbindStops.bind(this),this.spread="pad",this.units="objectBoundingBox",t&&(this.stops=t)}Ce.extend(Ai,{Stop:Cr,Properties:["spread","units"],MakeObservable:function(t){Ce.each(Ai.Properties,Vs,t),Object.defineProperty(t,"stops",{enumerable:!0,get:function(){return this._stops},set:function(e){var i=this._renderer.bindStops,n=this._renderer.unbindStops;this._stops&&this._stops.unbind(Be.Types.insert,i).unbind(Be.Types.remove,n),this._stops=new Fa((e||[]).slice(0)),this._stops.bind(Be.Types.insert,i).bind(Be.Types.remove,n),i(this._stops)}}),Object.defineProperty(t,"renderer",{enumerable:!1,get:function(){return this._renderer},set:function(e){this._renderer=e}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return this._id},set:function(e){this._id=e}})},FlagStops:function(){this._flagStops=!0},BindStops:function(t){for(var e=t.length;e--;)t[e].bind(Be.Types.change,this._renderer.flagStops),t[e].parent=this;this._renderer.flagStops()},UnbindStops:function(t){for(var e=t.length;e--;)t[e].unbind(Be.Types.change,this._renderer.flagStops),delete t[e].parent;this._renderer.flagStops()}});Ce.extend(Ai.prototype,Be,{constructor:Ai,_flagId:!1,_flagStops:!1,_flagSpread:!1,_flagUnits:!1,_id:"",_spread:"",_units:"",clone:function(t){var e=this.stops.map(function(n){return n.clone()}),i=new Ai(e);return Ce.each(Ai.Properties,function(n){i[n]=this[n]},this),t&&t.add(i),i},toObject:function(){var t={stops:this.stops.map(function(e){return e.toObject()})};return Ce.each(Ai.Properties,function(e){t[e]=this[e]},this),t},_update:function(){return(this._flagSpread||this._flagStops)&&this.trigger(Be.Types.change),this},flagReset:function(){return this._flagSpread=this._flagUnits=this._flagStops=!1,this}});Ai.MakeObservable(Ai.prototype);function nn(t,e,i,n,r){Ai.call(this,r),this._renderer.type="linear-gradient";var s=nn.FlagEndPoints.bind(this);this.left=new ot().bind(Be.Types.change,s),this.right=new ot().bind(Be.Types.change,s),typeof t=="number"&&(this.left.x=t),typeof e=="number"&&(this.left.y=e),typeof i=="number"&&(this.right.x=i),typeof n=="number"&&(this.right.y=n)}Ce.extend(nn,{Stop:Cr,MakeObservable:function(t){Ai.MakeObservable(t)},FlagEndPoints:function(){this._flagEndPoints=!0}});Ce.extend(nn.prototype,Ai.prototype,{constructor:nn,_flagEndPoints:!1,clone:function(t){var e=this.stops.map(function(n){return n.clone()}),i=new nn(this.left._x,this.left._y,this.right._x,this.right._y,e);return Ce.each(Ai.Properties,function(n){i[n]=this[n]},this),t&&t.add(i),i},toObject:function(){var t=Ai.prototype.toObject.call(this);return t.left=this.left.toObject(),t.right=this.right.toObject(),t},_update:function(){return(this._flagEndPoints||this._flagSpread||this._flagStops)&&this.trigger(Be.Types.change),this},flagReset:function(){return this._flagEndPoints=!1,Ai.prototype.flagReset.call(this),this}});nn.MakeObservable(nn.prototype);function Zi(t,e,i,n,r,s){Ai.call(this,n),this._renderer.type="radial-gradient",this.center=new ot().bind(Be.Types.change,(function(){this._flagCenter=!0}).bind(this)),this.radius=typeof i=="number"?i:20,this.focal=new ot().bind(Be.Types.change,(function(){this._flagFocal=!0}).bind(this)),typeof t=="number"&&(this.center.x=t),typeof e=="number"&&(this.center.y=e),this.focal.copy(this.center),typeof r=="number"&&(this.focal.x=r),typeof s=="number"&&(this.focal.y=s)}Ce.extend(Zi,{Stop:Cr,Properties:["radius"],MakeObservable:function(t){Ai.MakeObservable(t),Ce.each(Zi.Properties,Vs,t)}});Ce.extend(Zi.prototype,Ai.prototype,{constructor:Zi,_flagRadius:!1,_flagCenter:!1,_flagFocal:!1,clone:function(t){var e=this.stops.map(function(n){return n.clone()}),i=new Zi(this.center._x,this.center._y,this._radius,e,this.focal._x,this.focal._y);return Ce.each(Ai.Properties.concat(Zi.Properties),function(n){i[n]=this[n]},this),t&&t.add(i),i},toObject:function(){var t=Ai.prototype.toObject.call(this);return Ce.each(Zi.Properties,function(e){t[e]=this[e]},this),t.center=this.center.toObject(),t.focal=this.focal.toObject(),t},_update:function(){return(this._flagRadius||this._flatCenter||this._flagFocal||this._flagSpread||this._flagStops)&&this.trigger(Be.Types.change),this},flagReset:function(){return this._flagRadius=this._flagCenter=this._flagFocal=!1,Ai.prototype.flagReset.call(this),this}});Zi.MakeObservable(Zi.prototype);var S0,HN={video:/\.(mp4|webm|ogg)$/i,image:/\.(jpe?g|png|gif|tiff|webp)$/i,effect:/texture|gradient/i};tr.document&&(S0=document.createElement("a"));function jt(t,e){if(this.renderer={},this._renderer.type="texture",this._renderer.flagOffset=jt.FlagOffset.bind(this),this._renderer.flagScale=jt.FlagScale.bind(this),this.id=Ra.Identifier+Ra.uniqueId(),this.classList=[],this.loaded=!1,this.repeat="no-repeat",this.offset=new ot,typeof e=="function"){var i=(function(){this.unbind(Be.Types.load,i),typeof e=="function"&&e()}).bind(this);this.bind(Be.Types.load,i)}if(typeof t=="string")this.src=t;else if(typeof t=="object"){var n=Object.prototype.toString.call(t);(n==="[object HTMLImageElement]"||n==="[object HTMLCanvasElement]"||n==="[object HTMLVideoElement]"||n==="[object Image]")&&(this.image=t)}this._update()}Ce.extend(jt,{Properties:["id","src","loaded","repeat"],RegularExpressions:HN,ImageRegistry:new ap,getAbsoluteURL:function(t){return S0?(S0.href=t,S0.href):t},loadHeadlessBuffer:function(t,e){t.image.onload=e,t.image.src=t.src},getTag:function(t){return t&&t.nodeName&&t.nodeName.toLowerCase()||"img"},getImage:function(t){var e=jt.getAbsoluteURL(t);if(jt.ImageRegistry.contains(e))return jt.ImageRegistry.get(e);var i;return Fo.Image?(i=new Fo.Image,Wd.Utils.shim(i,"img")):tr.document?HN.video.test(e)?i=document.createElement("video"):i=document.createElement("img"):console.warn("Two.js: no prototypical image defined for Two.Texture"),i.crossOrigin="anonymous",i},Register:{canvas:function(t,e){t._src="#"+t.id,jt.ImageRegistry.add(t.src,t.image),typeof e=="function"&&e()},img:function(t,e){var i=t.image,n=function(s){!Fo.isHeadless&&i.removeEventListener&&typeof i.removeEventListener=="function"&&(i.removeEventListener("load",n,!1),i.removeEventListener("error",r,!1)),typeof e=="function"&&e()},r=function(s){throw!Fo.isHeadless&&typeof i.removeEventListener=="function"&&(i.removeEventListener("load",n,!1),i.removeEventListener("error",r,!1)),new Po("unable to load "+t.src)};typeof i.width=="number"&&i.width>0&&typeof i.height=="number"&&i.height>0?n():!Fo.isHeadless&&typeof i.addEventListener=="function"&&(i.addEventListener("load",n,!1),i.addEventListener("error",r,!1)),t._src=jt.getAbsoluteURL(t._src),!(!Fo.isHeadless&&i&&i.getAttribute("two-src"))&&(Fo.isHeadless||i.setAttribute("two-src",t.src),jt.ImageRegistry.add(t.src,i),Fo.isHeadless?jt.loadHeadlessBuffer(t,n):t.image.src=t.src)},video:function(t,e){if(Fo.isHeadless)throw new Po("video textures are not implemented in headless environments.");var i=function(r){t.image.removeEventListener("canplaythrough",i,!1),t.image.removeEventListener("error",n,!1),t.image.width=t.image.videoWidth,t.image.height=t.image.videoHeight,typeof e=="function"&&e()},n=function(r){throw t.image.removeEventListener("canplaythrough",i,!1),t.image.removeEventListener("error",n,!1),new Po("unable to load "+t.src)};t._src=jt.getAbsoluteURL(t._src),t.image.getAttribute("two-src")||(t.image.setAttribute("two-src",t.src),jt.ImageRegistry.add(t.src,t.image)),t.image.readyState>=4?i():(t.image.addEventListener("canplaythrough",i,!1),t.image.addEventListener("error",n,!1),t.image.src=t.src,t.image.load())}},load:function(t,e){var i=t.image,n=jt.getTag(i);t._flagImage&&(/canvas/i.test(n)?jt.Register.canvas(t,e):(t._src=!Fo.isHeadless&&i.getAttribute("two-src")||i.src,jt.Register[n](t,e))),t._flagSrc&&(i||(i=jt.getImage(t.src),t.image=i),n=jt.getTag(i),jt.Register[n](t,e))},FlagOffset:function(){this._flagOffset=!0},FlagScale:function(){this._flagScale=!0},MakeObservable:function(t){Ce.each(jt.Properties,Vs,t),Object.defineProperty(t,"image",{enumerable:!0,get:function(){return this._image},set:function(e){var i=jt.getTag(e),n;switch(i){case"canvas":n="#"+e.id;break;default:n=e.src}jt.ImageRegistry.contains(n)?this._image=jt.ImageRegistry.get(e.src):this._image=e,this._flagImage=!0}}),Object.defineProperty(t,"offset",{enumerable:!0,get:function(){return this._offset},set:function(e){this._offset&&this._offset.unbind(Be.Types.change,this._renderer.flagOffset),this._offset=e,this._offset.bind(Be.Types.change,this._renderer.flagOffset),this._flagOffset=!0}}),Object.defineProperty(t,"scale",{enumerable:!0,get:function(){return this._scale},set:function(e){this._scale instanceof ot&&this._scale.unbind(Be.Types.change,this._renderer.flagScale),this._scale=e,this._scale instanceof ot&&this._scale.bind(Be.Types.change,this._renderer.flagScale),this._flagScale=!0}}),Object.defineProperty(t,"renderer",{enumerable:!1,get:function(){return this._renderer},set:function(e){this._renderer=e}})}});Ce.extend(jt.prototype,Be,rn.prototype,{constructor:jt,_flagId:!1,_flagSrc:!1,_flagImage:!1,_flagVideo:!1,_flagLoaded:!1,_flagRepeat:!1,_flagOffset:!1,_flagScale:!1,_id:"",_src:"",_image:null,_loaded:!1,_repeat:"no-repeat",_scale:1,_offset:null,clone:function(){var t=new jt(this.src);return t.repeat=this.repeat,t.offset.copy(this.origin),t.scale=this.scale,t},toObject:function(){return{src:this.src,repeat:this.repeat,origin:this.origin.toObject(),scale:typeof this.scale=="number"?this.scale:this.scale.toObject()}},_update:function(){return(this._flagSrc||this._flagImage)&&(this.trigger(Be.Types.change),(this._flagSrc||this._flagImage)&&(this.loaded=!1,jt.load(this,(function(){this.loaded=!0,this.trigger(Be.Types.change).trigger(Be.Types.load)}).bind(this)))),this._image&&this._image.readyState>=4&&(this._flagVideo=!0),this},flagReset:function(){return this._flagSrc=this._flagImage=this._flagLoaded=this._flagVideo=this._flagScale=this._flagOffset=!1,this}});jt.MakeObservable(jt.prototype);var Dh=Math.min,Nh=Math.max,Hae=Math.ceil,qae=Math.floor;function ct(t,e,i,n){rn.call(this),this._renderer.type="path",this._renderer.flagVertices=ct.FlagVertices.bind(this),this._renderer.bindVertices=ct.BindVertices.bind(this),this._renderer.unbindVertices=ct.UnbindVertices.bind(this),this._renderer.flagFill=ct.FlagFill.bind(this),this._renderer.flagStroke=ct.FlagStroke.bind(this),this._renderer.vertices=[],this._renderer.collection=[],this._closed=!!e,this._curved=!!i,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.className="",this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this.vertices=t,this.automatic=!n,this.dashes=[],this.dashes.offset=0}Ce.extend(ct,{Properties:["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"],Utils:{getCurveLength:oC},FlagVertices:function(){this._flagVertices=!0,this._flagLength=!0,this.parent&&(this.parent._flagLength=!0)},BindVertices:function(t){for(var e=t.length;e--;)t[e].bind(Be.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()},UnbindVertices:function(t){for(var e=t.length;e--;)t[e].unbind(Be.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()},FlagFill:function(){this._flagFill=!0},FlagStroke:function(){this._flagStroke=!0},MakeObservable:function(t){rn.MakeObservable(t),Ce.each(ct.Properties.slice(2,8),Vs,t),Object.defineProperty(t,"fill",{enumerable:!0,get:function(){return this._fill},set:function(e){(this._fill instanceof Ai||this._fill instanceof nn||this._fill instanceof Zi||this._fill instanceof jt)&&this._fill.unbind(Be.Types.change,this._renderer.flagFill),this._fill=e,this._flagFill=!0,(this._fill instanceof Ai||this._fill instanceof nn||this._fill instanceof Zi||this._fill instanceof jt)&&this._fill.bind(Be.Types.change,this._renderer.flagFill)}}),Object.defineProperty(t,"stroke",{enumerable:!0,get:function(){return this._stroke},set:function(e){(this._stroke instanceof Ai||this._stroke instanceof nn||this._stroke instanceof Zi||this._stroke instanceof jt)&&this._stroke.unbind(Be.Types.change,this._renderer.flagStroke),this._stroke=e,this._flagStroke=!0,(this._stroke instanceof Ai||this._stroke instanceof nn||this._stroke instanceof Zi||this._stroke instanceof jt)&&this._stroke.bind(Be.Types.change,this._renderer.flagStroke)}}),Object.defineProperty(t,"length",{get:function(){return this._flagLength&&this._updateLength(),this._length}}),Object.defineProperty(t,"closed",{enumerable:!0,get:function(){return this._closed},set:function(e){this._closed=!!e,this._flagVertices=!0}}),Object.defineProperty(t,"curved",{enumerable:!0,get:function(){return this._curved},set:function(e){this._curved=!!e,this._flagVertices=!0}}),Object.defineProperty(t,"automatic",{enumerable:!0,get:function(){return this._automatic},set:function(e){if(e!==this._automatic){this._automatic=!!e;var i=this._automatic?"ignore":"listen";Ce.each(this.vertices,function(n){n[i]()})}}}),Object.defineProperty(t,"beginning",{enumerable:!0,get:function(){return this._beginning},set:function(e){this._beginning=e,this._flagVertices=!0}}),Object.defineProperty(t,"ending",{enumerable:!0,get:function(){return this._ending},set:function(e){this._ending=e,this._flagVertices=!0}}),Object.defineProperty(t,"vertices",{enumerable:!0,get:function(){return this._collection},set:function(e){var i=this._renderer.bindVertices,n=this._renderer.unbindVertices;this._collection&&this._collection.unbind(Be.Types.insert,i).unbind(Be.Types.remove,n),e instanceof Fa?this._collection=e:this._collection=new Fa(e||[]),this._collection.bind(Be.Types.insert,i).bind(Be.Types.remove,n),i(this._collection)}}),Object.defineProperty(t,"mask",{enumerable:!0,get:function(){return this._mask},set:function(e){this._mask&&(this._mask.clip=!1),this._mask=e,this._flagMask=!0,e&&!e.clip&&(e.clip=!0)}}),Object.defineProperty(t,"clip",{enumerable:!0,get:function(){return this._clip},set:function(e){this._clip=e,this._flagClip=!0}}),Object.defineProperty(t,"dashes",{enumerable:!0,get:function(){return this._dashes},set:function(e){typeof e.offset!="number"&&(e.offset=this.dashes&&this._dashes.offset||0),this._dashes=e}})}});Ce.extend(ct.prototype,rn.prototype,{constructor:ct,_flagVertices:!0,_flagLength:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagCap:!0,_flagJoin:!0,_flagMiter:!0,_flagMask:!1,_flagClip:!1,_length:0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_cap:"round",_join:"round",_miter:4,_closed:!0,_curved:!1,_automatic:!0,_beginning:0,_ending:1,_mask:null,_clip:!1,_dashes:null,clone:function(t){for(var e=new ct,i=0;i<this.vertices.length;i++)e.vertices.push(this.vertices[i].clone());for(var n=0;n<ct.Properties.length;n++){var r=ct.Properties[n];e[r]=this[r]}return e.className=this.className,e.translation.copy(this.translation),e.rotation=this.rotation,e.scale=this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&e.matrix.copy(this.matrix),t&&t.add(e),e._update()},toObject:function(){var t={vertices:this.vertices.map(function(e){return e.toObject()})};return Ce.each(ct.Properties,function(e){typeof this[e]<"u"&&(this[e].toObject?t[e]=this[e].toObject():t[e]=this[e])},this),t.className=this.className,t.translation=this.translation.toObject(),t.rotation=this.rotation,t.scale=this.scale instanceof ot?this.scale.toObject():this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&(t.matrix=this.matrix.toObject()),t},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke=void 0,this},corner:function(){for(var t=this.getBoundingClientRect(!0),e=t.width/2,i=t.height/2,n=t.left+t.width/2,r=t.top+t.height/2,s=0;s<this.vertices.length;s++){var o=this.vertices[s];o.x-=n,o.y-=r,o.x+=e,o.y+=i}return this.mask&&(this.mask.translation.x-=n,this.mask.translation.x+=e,this.mask.translation.y-=r,this.mask.translation.y+=i),this},center:function(){for(var t=this.getBoundingClientRect(!0),e=t.left+t.width/2-this.translation.x,i=t.top+t.height/2-this.translation.y,n=0;n<this.vertices.length;n++){var r=this.vertices[n];r.x-=e,r.y-=i}return this.mask&&(this.mask.translation.x-=e,this.mask.translation.y-=i),this},remove:function(){return this.parent?(this.parent.remove(this),this):this},getBoundingClientRect:function(t){var e,i,n,r,s,o,a,l,c,u,h,d,f,m,g=1/0,v=-1/0,p=1/0,b=-1/0;if(this._update(!0),e=t?this._matrix:Wp(this),i=(this.linewidth||0)/2,n=this._renderer.vertices.length,n<=0)return{width:0,height:0};for(r=0;r<n;r++)if(o=this._renderer.vertices[r],s=this._renderer.vertices[(r+n-1)%n],s.controls&&o.controls){a=s.controls.right.x,l=s.controls.right.y,s.relative&&(a+=s.x,l+=s.y),c=o.controls.left.x,u=o.controls.left.y,o.relative&&(c+=o.x,u+=o.y);var _=c5(s.x,s.y,a,l,c,u,o.x,o.y);p=Dh(_.min.y-i,p),g=Dh(_.min.x-i,g),v=Nh(_.max.x+i,v),b=Nh(_.max.y+i,b)}else r<=1&&(p=Dh(s.y-i,p),g=Dh(s.x-i,g),v=Nh(s.x+i,v),b=Nh(s.y+i,b)),p=Dh(o.y-i,p),g=Dh(o.x-i,g),v=Nh(o.x+i,v),b=Nh(o.y+i,b);return h=e.multiply(g,p,1),d=e.multiply(g,b,1),f=e.multiply(v,p,1),m=e.multiply(v,b,1),p=Dh(h.y,d.y,f.y,m.y),g=Dh(h.x,d.x,f.x,m.x),v=Nh(h.x,d.x,f.x,m.x),b=Nh(h.y,d.y,f.y,m.y),{top:p,left:g,right:v,bottom:b,width:v-g,height:b-p}},getPointAt:function(t,e){for(var i,n,r,s,o,a,l,c,u,h,d,f,m,g,v,p=this.length*Math.min(Math.max(t,0),1),b=this.vertices.length,_=b-1,P=null,E=null,T=0,C=this._lengths.length,M=0;T<C;T++){if(M+this._lengths[T]>=p){this._closed?(i=ea(T,b),n=ea(T-1,b),T===0&&(i=n,n=T)):(i=T,n=Math.min(Math.max(T-1,0),_)),P=this.vertices[i],E=this.vertices[n],p-=M,this._lengths[T]!==0?t=p/this._lengths[T]:t=0;break}M+=this._lengths[T]}if(P===null||E===null)return null;if(P){if(!E)return P}else return E;v=E.controls&&E.controls.right,g=P.controls&&P.controls.left,o=E.x,h=E.y,a=(v||E).x,d=(v||E).y,l=(g||P).x,f=(g||P).y,c=P.x,m=P.y,v&&E.relative&&(a+=E.x,d+=E.y),g&&P.relative&&(l+=P.x,f+=P.y),s=Wv(t,o,a,l,c),u=Wv(t,h,d,f,m);var x=Ro(o,a,t),V=Ro(h,d,t),N=Ro(a,l,t),D=Ro(d,f,t),O=Ro(l,c,t),F=Ro(f,m,t),X=Ro(x,N,t),Z=Ro(V,D,t),K=Ro(N,O,t),z=Ro(D,F,t);return Ce.isObject(e)?(e.x=s,e.y=u,Ce.isObject(e.controls)||Ot.AppendCurveProperties(e),e.controls.left.x=X,e.controls.left.y=Z,e.controls.right.x=K,e.controls.right.y=z,(typeof e.relative!="boolean"||e.relative)&&(e.controls.left.x-=s,e.controls.left.y-=u,e.controls.right.x-=s,e.controls.right.y-=u),e.t=t,e):(r=new Ot(s,u,X-s,Z-u,K-s,z-u,this._curved?at.curve:at.line),r.t=t,r)},plot:function(){if(this.curved)return u5(this._collection,this.closed),this;for(var t=0;t<this._collection.length;t++)this._collection[t].command=t===0?at.move:at.line;return this},subdivide:function(t){this._update();var e=this.vertices.length-1,i=this.vertices[e],n=this._closed||this.vertices[e]._command===at.close,r=[];return Ce.each(this.vertices,function(s,o){if(o<=0&&!n){i=s;return}if(s.command===at.move){r.push(new Ot(i.x,i.y)),o>0&&(r[r.length-1].command=at.line),i=s;return}var a=KN(s,i,t);r=r.concat(a),Ce.each(a,function(l,c){c<=0&&i.command===at.move?l.command=at.move:l.command=at.line}),o>=e&&(this._closed&&this._automatic?(i=s,a=KN(s,i,t),r=r.concat(a),Ce.each(a,function(l,c){c<=0&&i.command===at.move?l.command=at.move:l.command=at.line})):n&&r.push(new Ot(s.x,s.y)),r[r.length-1].command=n?at.close:at.line),i=s},this),this._automatic=!1,this._curved=!1,this.vertices=r,this},_updateLength:function(t,e){e||this._update();var i=this.vertices.length,n=i-1,r=this.vertices[n],s=!1,o=0;return typeof this._lengths>"u"&&(this._lengths=[]),Ce.each(this.vertices,function(a,l){if(l<=0&&!s||a.command===at.move){r=a,this._lengths[l]=0;return}this._lengths[l]=oC(a,r,t),o+=this._lengths[l],l>=n&&s&&(r=this.vertices[(l+1)%i],this._lengths[l+1]=oC(a,r,t),o+=this._lengths[l+1]),r=a},this),this._length=o,this._flagLength=!1,this},_update:function(){if(this._flagVertices){this._automatic&&this.plot(),this._flagLength&&this._updateLength(void 0,!0);var t=this._collection.length,e=this._closed,i=Math.min(this._beginning,this._ending),n=Math.max(this._beginning,this._ending),r=u_(this,i*this._length),s=u_(this,n*this._length),o=Hae(r),a=qae(s),l,c,u,h,d;this._renderer.vertices.length=0;for(var f=0;f<t;f++)this._renderer.collection.length<=f&&this._renderer.collection.push(new Ot),f>a&&!c?(d=this._renderer.collection[f],d.copy(this._collection[f]),this.getPointAt(n,d),d.command=this._renderer.collection[f].command,this._renderer.vertices.push(d),c=d,u=this._collection[f-1],u&&u.controls&&(d.controls.right.clear(),this._renderer.collection[f-1].controls.right.clear().lerp(u.controls.right,d.t))):f>=o&&f<=a&&(d=this._renderer.collection[f].copy(this._collection[f]),this._renderer.vertices.push(d),f===a&&qN(this,n)?(c=d,!e&&c.controls&&c.controls.right.clear()):f===o&&qN(this,i)&&(l=d,l.command=at.move,!e&&l.controls&&l.controls.left.clear()));o>0&&!l&&(f=o-1,d=this._renderer.collection[f],d.copy(this._collection[f]),this.getPointAt(i,d),d.command=at.move,this._renderer.vertices.unshift(d),h=this._collection[f+1],h&&h.controls&&(d.controls.left.clear(),this._renderer.collection[f+1].controls.left.copy(h.controls.left).lerp(ot.zero,d.t)))}return rn.prototype._update.apply(this,arguments),this},flagReset:function(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=!1,rn.prototype.flagReset.call(this),this}});ct.MakeObservable(ct.prototype);function qN(t,e){if(e===0||e===1)return!0;for(var i=t._length,n=i*e,r=0,s=0;s<t._lengths.length;s++){var o=t._lengths[s];if(r>=n)return n-r>=0;r+=o}return!1}function u_(t,e){var i=t._length;if(e<=0)return 0;if(e>=i)return t._lengths.length-1;for(var n=0,r=0;n<t._lengths.length;n++){if(r+t._lengths[n]>=e)return e-=r,Math.max(n-1,0)+e/t._lengths[n];r+=t._lengths[n]}return-1}function oC(t,e,i){var n,r,s,o,a,l,c,u,h=e.controls&&e.controls.right,d=t.controls&&t.controls.left;return n=e.x,a=e.y,r=(h||e).x,l=(h||e).y,s=(d||t).x,c=(d||t).y,o=t.x,u=t.y,h&&e._relative&&(r+=e.x,l+=e.y),d&&t._relative&&(s+=t.x,c+=t.y),l5(n,a,r,l,s,c,o,u,i)}function KN(t,e,i){var n,r,s,o,a,l,c,u,h=e.controls&&e.controls.right,d=t.controls&&t.controls.left;return n=e.x,a=e.y,r=(h||e).x,l=(h||e).y,s=(d||t).x,c=(d||t).y,o=t.x,u=t.y,h&&e._relative&&(r+=e.x,l+=e.y),d&&t._relative&&(s+=t.x,c+=t.y),GM(n,a,r,l,s,c,o,u,i)}function sr(t,e,i,n){ct.call(this,[new Ot,new Ot,new Ot,new Ot],!0,!1,!0),this.width=i,this.height=n,this.origin=new ot,this.translation.set(t,e),this._update()}Ce.extend(sr,{Properties:["width","height"],MakeObservable:function(t){ct.MakeObservable(t),Ce.each(sr.Properties,Vs,t),Object.defineProperty(t,"origin",{enumerable:!0,get:function(){return this._origin},set:function(e){this._origin&&this._origin.unbind(Be.Types.change,this._renderer.flagVertices),this._origin=e,this._origin.bind(Be.Types.change,this._renderer.flagVertices),this._renderer.flagVertices()}})}});Ce.extend(sr.prototype,ct.prototype,{constructor:sr,_flagWidth:0,_flagHeight:0,_width:0,_height:0,_origin:null,_update:function(){if(this._flagVertices||this._flagWidth||this._flagHeight){var t=this._width/2,e=this._height/2;!this._closed&&this.vertices.length===4&&this.vertices.push(new Ot),this.vertices[0].set(-t,-e).sub(this._origin).command=at.move,this.vertices[1].set(t,-e).sub(this._origin).command=at.line,this.vertices[2].set(t,e).sub(this._origin).command=at.line,this.vertices[3].set(-t,e).sub(this._origin).command=at.line,this.vertices[4]&&(this.vertices[4].set(-t,-e).sub(this._origin).command=at.line)}return ct.prototype._update.call(this),this},flagReset:function(){return this._flagWidth=this._flagHeight=!1,ct.prototype.flagReset.call(this),this},clone:function(t){var e=new sr(0,0,this.width,this.height);return e.translation.copy(this.translation),e.rotation=this.rotation,e.scale=this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&e.matrix.copy(this.matrix),Ce.each(ct.Properties,function(i){e[i]=this[i]},this),t&&t.add(e),e},toObject:function(){var t=ct.prototype.toObject.call(this);return t.width=this.width,t.height=this.height,t.origin=this.origin.toObject(),t}});sr.MakeObservable(sr.prototype);function lc(t,e,i,n,r,s){ct.call(this,[new Ot,new Ot,new Ot,new Ot],!0),this.noStroke(),this.noFill(),t instanceof jt?this.texture=t:typeof t=="string"&&(this.texture=new jt(t)),this.origin=new ot,this._update(),this.translation.set(e||0,i||0),typeof n=="number"&&(this.columns=n),typeof r=="number"&&(this.rows=r),typeof s=="number"&&(this.frameRate=s),this.index=0}Ce.extend(lc,{Properties:["texture","columns","rows","frameRate","index"],MakeObservable:function(t){sr.MakeObservable(t),Ce.each(lc.Properties,Vs,t)}});Ce.extend(lc.prototype,sr.prototype,{constructor:lc,_flagTexture:!1,_flagColumns:!1,_flagRows:!1,_flagFrameRate:!1,flagIndex:!1,_amount:1,_duration:0,_startTime:0,_playing:!1,_firstFrame:0,_lastFrame:0,_loop:!0,_texture:null,_columns:1,_rows:1,_frameRate:0,_index:0,_origin:null,play:function(t,e,i){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=Ce.performance.now(),typeof t=="number"&&(this._firstFrame=t),typeof e=="number"&&(this._lastFrame=e),typeof i=="function"?this._onLastFrame=i:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this},pause:function(){return this._playing=!1,this},stop:function(){return this._playing=!1,this._index=0,this},clone:function(t){var e=new lc(this.texture,this.translation.x,this.translation.y,this.columns,this.rows,this.frameRate);return this.playing&&(e.play(this._firstFrame,this._lastFrame),e._loop=this._loop),t&&t.add(e),e},toObject:function(){var t=sr.prototype.toObject.call(this);return t.texture=this.texture.toObject(),t.columns=this.columns,t.rows=this.rows,t.frameRate=this.frameRate,t.index=this.index,t._firstFrame=this._firstFrame,t._lastFrame=this._lastFrame,t._loop=this._loop,t},_update:function(){var t=this._texture,e=this._columns,i=this._rows,n,r,s,o,a,l,c,u,h;if((this._flagColumns||this._flagRows)&&(this._amount=this._columns*this._rows),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._flagTexture&&(this.fill=this._texture),this._texture.loaded){c=t.image.width,u=t.image.height,n=c/e,r=u/i,o=this._amount,this.width!==n&&(this.width=n),this.height!==r&&(this.height=r),this._playing&&this._frameRate>0&&(Ce.isNaN(this._lastFrame)&&(this._lastFrame=o-1),s=Ce.performance.now()-this._startTime,h=this._lastFrame+1,a=1e3*(h-this._firstFrame)/this._frameRate,this._loop?s=s%a:s=Math.min(s,a),l=Ro(this._firstFrame,h,s/a),l=Math.floor(l),l!==this._index&&(this._index=l,l>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()));var d=this._index%e,f=Math.floor(this._index/e),m=-n*d+(c-n)/2,g=-r*f+(u-r)/2;m!==t.offset.x&&(t.offset.x=m),g!==t.offset.y&&(t.offset.y=g)}return sr.prototype._update.call(this),this},flagReset:function(){return this._flagTexture=this._flagColumns=this._flagRows=this._flagFrameRate=!1,sr.prototype.flagReset.call(this),this}});lc.MakeObservable(lc.prototype);var kT=Math.cos,CT=Math.sin;function cl(t,e,i,n){for(var r=n?Math.max(n,2):4,s=[],o=0;o<r;o++)s.push(new Ot(0,0,0,0,0,0));ct.call(this,s,!0,!0,!0),typeof i=="number"&&(this.radius=i),this._update(),typeof t=="number"&&(this.translation.x=t),typeof e=="number"&&(this.translation.y=e)}Ce.extend(cl,{Properties:["radius"],MakeObservable:function(t){ct.MakeObservable(t),Ce.each(cl.Properties,Vs,t)}});Ce.extend(cl.prototype,ct.prototype,{constructor:cl,_flagRadius:!1,_radius:0,_update:function(){if(this._flagVertices||this._flagRadius){var t=this.vertices.length;!this._closed&&t>2&&(t-=1);for(var e=4/3*Math.tan(Math.PI/(t*2)),i=this._radius,n=i*e,r=0;r<this.vertices.length;r++){var s=r/t,o=s*bs,a=i*kT(o),l=i*CT(o),c=n*kT(o-xr),u=n*CT(o-xr),h=n*kT(o+xr),d=n*CT(o+xr),f=this.vertices[r];f.command=r===0?at.move:at.curve,f.set(a,l),f.controls.left.set(c,u),f.controls.right.set(h,d)}}return ct.prototype._update.call(this),this},flagReset:function(){return this._flagRadius=!1,ct.prototype.flagReset.call(this),this},clone:function(t){var e=new cl(0,0,this.radius,this.vertices.length);return e.translation.copy(this.translation),e.rotation=this.rotation,e.scale=this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&e.matrix.copy(this.matrix),Ce.each(ct.Properties,function(i){e[i]=this[i]},this),t&&t.add(e),e},toObject:function(){var t=ct.prototype.toObject.call(this);return Ce.each(cl.Properties,function(e){t[e]=this[e]},this),t}});cl.MakeObservable(cl.prototype);var MT=Math.cos,AT=Math.sin;function hl(t,e,i,n,r){typeof n!="number"&&typeof i=="number"&&(n=i);for(var s=r?Math.max(r,2):4,o=[],a=0;a<s;a++)o.push(new Ot);ct.call(this,o,!0,!0,!0),typeof i=="number"&&(this.width=i*2),typeof n=="number"&&(this.height=n*2),this._update(),this.translation.set(t,e)}Ce.extend(hl,{Properties:["width","height"],MakeObservable:function(t){ct.MakeObservable(t),Ce.each(hl.Properties,Vs,t)}});Ce.extend(hl.prototype,ct.prototype,{_flagWidth:!1,_flagHeight:!1,_width:0,_height:0,constructor:hl,_update:function(){if(this._flagVertices||this._flagWidth||this._flagHeight){var t=this.vertices.length;!this._closed&&t>2&&(t-=1);for(var e=4/3*Math.tan(Math.PI/(this.vertices.length*2)),i=this._width/2,n=this._height/2,r=0;r<this.vertices.length;r++){var s=r/t,o=s*bs,a=i*MT(o),l=n*AT(o),c=i*e*MT(o-xr),u=n*e*AT(o-xr),h=i*e*MT(o+xr),d=n*e*AT(o+xr),f=this.vertices[r];f.command=r===0?at.move:at.curve,f.set(a,l),f.controls.left.set(c,u),f.controls.right.set(h,d)}}return ct.prototype._update.call(this),this},flagReset:function(){return this._flagWidth=this._flagHeight=!1,ct.prototype.flagReset.call(this),this},clone:function(t){var e=this.width/2,i=this.height/2,n=this.vertices.length,r=new hl(0,0,e,i,n);return r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix),Ce.each(ct.Properties,function(s){r[s]=this[s]},this),t&&t.add(r),r},toObject:function(){var t=ct.prototype.toObject.call(this);return Ce.each(hl.Properties,function(e){t[e]=this[e]},this),t}});hl.MakeObservable(hl.prototype);function lp(t,e,i,n){ct.call(this,[new Ot(t,e),new Ot(i,n)]),this.vertices[0].command=at.move,this.vertices[1].command=at.line,this.automatic=!1}Ce.extend(lp.prototype,ct.prototype,{constructor:lp});ct.MakeObservable(lp.prototype);function wa(t,e,i,n,r){typeof r>"u"&&typeof i=="number"&&typeof n=="number"&&(r=Math.floor(Math.min(i,n)/12));for(var s=10,o=[],a=0;a<s;a++)o.push(new Ot(0,0,0,0,0,0,a===0?at.move:at.curve));ct.call(this,o),this.closed=!0,this.automatic=!1,this._renderer.flagRadius=wa.FlagRadius.bind(this),typeof i=="number"&&(this.width=i),typeof n=="number"&&(this.height=n),typeof r=="number"&&(this.radius=r),this._update(),this.translation.set(t,e)}Ce.extend(wa,{Properties:["width","height"],FlagRadius:function(){this._flagRadius=!0},MakeObservable:function(t){ct.MakeObservable(t),Ce.each(wa.Properties,Vs,t),Object.defineProperty(t,"radius",{enumerable:!0,get:function(){return this._radius},set:function(e){this._radius instanceof ot&&this._radius.unbind(Be.Types.change,this._renderer.flagRadius),this._radius=e,this._radius instanceof ot&&this._radius.bind(Be.Types.change,this._renderer.flagRadius),this._flagRadius=!0}})}});Ce.extend(wa.prototype,ct.prototype,{constructor:wa,_flagWidth:!1,_flagHeight:!1,_flagRadius:!1,_width:0,_height:0,_radius:12,_update:function(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagRadius){var t=this._width,e=this._height,i,n;this._radius instanceof ot?(i=this._radius.x,n=this._radius.y):(i=this._radius,n=this._radius);var r,s=t/2,o=e/2;r=this.vertices[0],r.x=-(s-i),r.y=-o,r=this.vertices[1],r.x=s-i,r.y=-o,r.controls.left.clear(),r.controls.right.x=i,r.controls.right.y=0,r=this.vertices[2],r.x=s,r.y=-(o-n),r.controls.right.clear(),r.controls.left.clear(),r=this.vertices[3],r.x=s,r.y=o-n,r.controls.left.clear(),r.controls.right.x=0,r.controls.right.y=n,r=this.vertices[4],r.x=s-i,r.y=o,r.controls.right.clear(),r.controls.left.clear(),r=this.vertices[5],r.x=-(s-i),r.y=o,r.controls.left.clear(),r.controls.right.x=-i,r.controls.right.y=0,r=this.vertices[6],r.x=-s,r.y=o-n,r.controls.left.clear(),r.controls.right.clear(),r=this.vertices[7],r.x=-s,r.y=-(o-n),r.controls.left.clear(),r.controls.right.x=0,r.controls.right.y=-n,r=this.vertices[8],r.x=-(s-i),r.y=-o,r.controls.left.clear(),r.controls.right.clear(),r=this.vertices[9],r.copy(this.vertices[8])}return ct.prototype._update.call(this),this},flagReset:function(){return this._flagWidth=this._flagHeight=this._flagRadius=!1,ct.prototype.flagReset.call(this),this},clone:function(t){var e=this.width,i=this.height,n=this.radius,r=new wa(0,0,e,i,n);return r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix),Ce.each(ct.Properties,function(s){r[s]=this[s]},this),t&&t.add(r),r},toObject:function(){var t=ct.prototype.toObject.call(this);return Ce.each(wa.Properties,function(e){t[e]=this[e]},this),t.radius=typeof this.radius=="number"?this.radius:this.radius.toObject(),t}});wa.MakeObservable(wa.prototype);var XN=Math.min,YN=Math.max;function Bn(t,e,i,n){if(rn.call(this),this._renderer.type="text",this._renderer.flagFill=Bn.FlagFill.bind(this),this._renderer.flagStroke=Bn.FlagStroke.bind(this),this.value=t,typeof e=="number"&&(this.translation.x=e),typeof i=="number"&&(this.translation.y=i),this.dashes=[],this.dashes.offset=0,!Ce.isObject(n))return this;Ce.each(Bn.Properties,function(r){r in n&&(this[r]=n[r])},this)}Ce.extend(Bn,{Ratio:.6,Properties:["value","family","size","leading","alignment","linewidth","style","weight","decoration","baseline","opacity","visible","className","fill","stroke"],FlagFill:function(){this._flagFill=!0},FlagStroke:function(){this._flagStroke=!0},MakeObservable:function(t){rn.MakeObservable(t),Ce.each(Bn.Properties.slice(0,12),Vs,t),Object.defineProperty(t,"fill",{enumerable:!0,get:function(){return this._fill},set:function(e){(this._fill instanceof Ai||this._fill instanceof nn||this._fill instanceof Zi||this._fill instanceof jt)&&this._fill.unbind(Be.Types.change,this._renderer.flagFill),this._fill=e,this._flagFill=!0,(this._fill instanceof Ai||this._fill instanceof nn||this._fill instanceof Zi||this._fill instanceof jt)&&this._fill.bind(Be.Types.change,this._renderer.flagFill)}}),Object.defineProperty(t,"stroke",{enumerable:!0,get:function(){return this._stroke},set:function(e){(this._stroke instanceof Ai||this._stroke instanceof nn||this._stroke instanceof Zi||this._stroke instanceof jt)&&this._stroke.unbind(Be.Types.change,this._renderer.flagStroke),this._stroke=e,this._flagStroke=!0,(this._stroke instanceof Ai||this._stroke instanceof nn||this._stroke instanceof Zi||this._stroke instanceof jt)&&this._stroke.bind(Be.Types.change,this._renderer.flagStroke)}}),Object.defineProperty(t,"mask",{enumerable:!0,get:function(){return this._mask},set:function(e){this._mask&&(this._mask.clip=!1),this._mask=e,this._flagMask=!0,e&&!e.clip&&(e.clip=!0)}}),Object.defineProperty(t,"clip",{enumerable:!0,get:function(){return this._clip},set:function(e){this._clip=e,this._flagClip=!0}}),Object.defineProperty(t,"dashes",{enumerable:!0,get:function(){return this._dashes},set:function(e){typeof e.offset!="number"&&(e.offset=this.dashes&&this._dashes.offset||0),this._dashes=e}})}});Ce.extend(Bn.prototype,rn.prototype,{constructor:Bn,_flagValue:!0,_flagFamily:!0,_flagSize:!0,_flagLeading:!0,_flagAlignment:!0,_flagBaseline:!0,_flagStyle:!0,_flagWeight:!0,_flagDecoration:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagClassName:!0,_flagVisible:!0,_flagMask:!1,_flagClip:!1,_value:"",_family:"sans-serif",_size:13,_leading:17,_alignment:"center",_baseline:"middle",_style:"normal",_weight:500,_decoration:"none",_fill:"#000",_stroke:"transparent",_linewidth:1,_opacity:1,_className:"",_visible:!0,_mask:null,_clip:!1,_dashes:null,remove:function(){return this.parent?(this.parent.remove(this),this):this},clone:function(t){var e=new Bn(this.value);return e.translation.copy(this.translation),e.rotation=this.rotation,e.scale=this.scale,Ce.each(Bn.Properties,function(i){e[i]=this[i]},this),this.matrix.manual&&e.matrix.copy(this.matrix),t&&t.add(e),e._update()},toObject:function(){var t={translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};return this.matrix.manual&&(t.matrix=this.matrix.toObject()),Ce.each(Bn.Properties,function(e){t[e]=this[e]},this),t},noFill:function(){return this.fill="transparent",this},noStroke:function(){return this.stroke=void 0,this.linewidth=void 0,this},getBoundingClientRect:function(t){var e,i,n,r,s,o,a,l,c;this._update(!0),e=t?this._matrix:Wp(this);var u=this.leading,h=this.value.length*this.size*Bn.Ratio,d=(this._linewidth||0)/2;switch(this.alignment){case"left":o=-d,a=h+d;break;case"right":o=-(h+d),a=d;break;default:o=-(h/2+d),a=h/2+d}switch(this.baseline){case"top":l=-d,c=u+d;break;case"bottom":l=-(u+d),c=d;break;default:l=-(u/2+d),c=u/2+d}return i=e.multiply(o,l,1),n=e.multiply(o,c,1),r=e.multiply(a,l,1),s=e.multiply(a,c,1),l=XN(i.y,n.y,r.y,s.y),o=XN(i.x,n.x,r.x,s.x),a=YN(i.x,n.x,r.x,s.x),c=YN(i.y,n.y,r.y,s.y),{top:l,left:o,right:a,bottom:c,width:a-o,height:c-l}},flagReset:function(){return this._flagValue=this._flagFamily=this._flagSize=this._flagLeading=this._flagAlignment=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagClip=this._flagDecoration=this._flagClassName=this._flagBaseline=this._flagWeight=this._flagStyle=!1,rn.prototype.flagReset.call(this),this}});Bn.MakeObservable(Bn.prototype);var Fl={path:/[+-]?(?:\d*\.\d+|\d+)(?:[eE][+-]\d+)?/g,cssBackgroundImage:/url\(['"]?#([\w\d-_]*)['"]?\)/i,unitSuffix:/[a-zA-Z%]*/i},Kae={start:"left",middle:"center",end:"right"},Xae=function(t){return Kae[t]},Yae=function(t){var e=t.getAttribute("dominant-baseline"),i=t.getAttribute("alignment-baseline");return e||i},Hv=function(t){return t.replace(/svg:/ig,"").toLowerCase()},ZN=function(t,e){if(e.x+=t.translateX,e.y+=t.translateY,e.x*=t.scaleX,e.y*=t.scaleY,t.rotation!==0){var i=e.length();e.x=i*Math.cos(t.rotation),e.y=i*Math.sin(t.rotation)}},Zae=function(t,e){var i,n,r,s;e||(e={}),i=t.split(";");for(var o=0;o<i.length;o++)n=i[o].split(":"),r=n[0],s=n[1],!(typeof r>"u"||typeof s>"u")&&(e[r]=s.replace(/\s/,""));return e},Jae=function(t){for(var e={},i=Qae(t),n=Math.max(i.length,t.style.length),r=0;r<n;r++){var s=t.style[r],o=i[r];s&&(e[s]=t.style[s]),o&&(e[o]=t.getAttribute(o))}return e},Qae=function(t){for(var e=t.getAttributeNames(),i=["id","class","transform","xmlns","viewBox"],n=0;n<i.length;n++){var r=i[n],s=Array.prototype.indexOf.call(e,r);s>=0&&e.splice(s,1)}return e},ele=function(t,e){var i=e.split(/[\s,]/),n=-parseFloat(i[0]),r=-parseFloat(i[1]),s=parseFloat(i[2]),o=parseFloat(i[3]);if(n&&r)for(var a=0;a<t.children.length;a++){var l=t.children[a];"translation"in l?l.translation.add(n,r):"x"in l?l.x=n:"y"in l&&(l.y=r)}var c=typeof t.x=="number",u=typeof t.y=="number",h=typeof t.width=="number",d=typeof t.height=="number";return c&&(t.translation.x+=t.x),u&&(t.translation.y+=t.y),(h||d)&&(t.scale=new ot(1,1)),h&&(t.scale.x=t.width/s),d&&(t.scale.y=t.height/o),t.mask=new sr(0,0,s,o),t.mask.origin.set(-s/2,-o/2),t},aa=function(t,e,i){var n={},r={},s={},o,a,l,c,u,h,d,f,m,g,v,p,b;if(tr.getComputedStyle){var _=tr.getComputedStyle(t);for(o=_.length;o--;)l=_[o],c=_[l],typeof c<"u"&&(n[l]=c)}for(o=0;o<t.attributes.length;o++)h=t.attributes[o],/style/i.test(h.nodeName)?Zae(h.value,s):r[h.nodeName]=h.value;typeof n.opacity<"u"&&(n["stroke-opacity"]=n.opacity,n["fill-opacity"]=n.opacity,delete n.opacity),i&&Ce.defaults(n,i),Ce.extend(n,s,r),n.visible=!(typeof n.display>"u"&&/none/i.test(n.display))||typeof n.visibility>"u"&&/hidden/i.test(n.visibility);for(l in n)switch(c=n[l],l){case"gradientTransform":if(/none/i.test(c)||(a=t.gradientTransform&&t.gradientTransform.baseVal&&t.gradientTransform.baseVal.length>0?t.gradientTransform.baseVal[0].matrix:t.getCTM?t.getCTM():null,a===null))break;switch(d=$v(a),e._renderer.type){case"linear-gradient":ZN(d,e.left),ZN(d,e.right);break;case"radial-gradient":e.center.x+=d.translateX,e.center.y+=d.translateY,e.focal.x+=d.translateX,e.focal.y+=d.translateY,e.radius*=Math.max(d.scaleX,d.scaleY);break}break;case"transform":if(/none/i.test(c)||(a=t.transform&&t.transform.baseVal&&t.transform.baseVal.length>0?t.transform.baseVal[0].matrix:t.getCTM?t.getCTM():null,a===null))break;Ra.AutoCalculateImportedMatrices?(d=$v(a),e.translation.set(d.translateX,d.translateY),e.rotation=Math.PI*(d.rotation/180),e.scale=new ot(d.scaleX,d.scaleY),f=parseFloat((n.x+"").replace("px")),m=parseFloat((n.y+"").replace("px")),f&&(e.translation.x=f),m&&(e.translation.y=m)):(a=t.getCTM(),e._matrix.manual=!0,e._matrix.set(a.a,a.b,a.c,a.d,a.e,a.f));break;case"visible":if(e instanceof mn){e._visible=c;break}e.visible=c;break;case"stroke-linecap":if(e instanceof mn){e._cap=c;break}e.cap=c;break;case"stroke-linejoin":if(e instanceof mn){e._join=c;break}e.join=c;break;case"stroke-miterlimit":if(e instanceof mn){e._miter=c;break}e.miter=c;break;case"stroke-width":if(e instanceof mn){e._linewidth=parseFloat(c);break}e.linewidth=parseFloat(c);break;case"opacity":case"stroke-opacity":case"fill-opacity":if(e instanceof mn){e._opacity=parseFloat(c);break}e.opacity=parseFloat(c);break;case"clip-path":if(Fl.cssBackgroundImage.test(c)&&(g=c.replace(Fl.cssBackgroundImage,"$1"),xn.defs.current&&xn.defs.current.contains(g)&&(p=xn.defs.current.get(g),p&&p.childNodes.length>0)))switch(p=p.childNodes[0],b=Hv(p.nodeName),e.mask=xn[b].call(this,p,{}),e._renderer.type){case"text":case"path":e.position.add(e.mask.position),e.mask.position.clear();break}break;case"fill":case"stroke":u=(e instanceof mn?"_":"")+l,Fl.cssBackgroundImage.test(c)?(g=c.replace(Fl.cssBackgroundImage,"$1"),xn.defs.current&&xn.defs.current.contains(g)?(p=xn.defs.current.get(g),p.object||(b=Hv(p.nodeName),p.object=xn[b].call(this,p,{})),p=p.object):(v=ile(this),p=v.getById(g)),e[u]=p):e[u]=/none/i.test(c)?"transparent":c;break;case"id":e.id=c;break;case"class":case"className":e.classList=c.split(" ");break;case"x":case"y":var P=e instanceof Ai,E=e instanceof nn,T=e instanceof Zi;if(P||E||T)break;if(c.match("[a-z%]$")&&!c.endsWith("px")){var C=new Po("only pixel values are supported with the "+l+" attribute.");console.warn(C.name,C.message)}e.translation[l]=parseFloat(c);break;case"font-family":e instanceof Bn&&(e.family=c);break;case"font-size":e instanceof Bn&&(e.size=c);break;case"font-weight":e instanceof Bn&&(e.weight=c);break;case"font-style":e instanceof Bn&&(e.style=c);break;case"text-decoration":e instanceof Bn&&(e.decoration=c);break;case"line-height":e instanceof Bn&&(e.leading=c);break}return n},tle=function(t,e){for(var i=0,n=t.childNodes.length;i<n;i++){var r=t.childNodes[i];if(r.id){var s=Hv(t.nodeName);s!=="#text"&&e.add(r.id,r)}}},ile=function(t){for(;t.parent;)t=t.parent;return t.scene},xn={svg:function(t){for(var e=xn.defs.current=new ap,i=t.getElementsByTagName("defs"),n=0;n<i.length;n++)tle(i[n],e);var r=xn.g.call(this,t),s=t.getAttribute("viewBox"),o=t.getAttribute("x"),a=t.getAttribute("y"),l=t.getAttribute("width"),c=t.getAttribute("height");r.defs=e;var u=s!==null,h=o!==null,d=a!==null,f=l!==null,m=c!==null;return h&&(r.x=parseFloat(o.replace(Fl.unitSuffix,""))),d&&(r.y=parseFloat(a.replace(Fl.unitSuffix,""))),f&&(r.width=parseFloat(l.replace(Fl.unitSuffix,""))),m&&(r.height=parseFloat(c.replace(Fl.unitSuffix,""))),u&&ele(r,s),delete xn.defs.current,r},defs:function(t){return null},use:function(t,e){var i,n=t.getAttribute("href")||t.getAttribute("xlink:href");if(!n)return i=new Po("encountered <use /> with no href."),console.warn(i.name,i.message),null;var r=n.slice(1);if(!xn.defs.current.contains(r))return i=new Po("unable to find element for reference "+n+"."),console.warn(i.name,i.message),null;for(var s=xn.defs.current.get(r),o=s.cloneNode(!0),a=["x","y","width","height","href","xlink:href"],l=0;l<t.attributes.length;l++){var c=t.attributes[l],u=a.includes(c.nodeName),h=!o.hasAttribute(c.nodeName);(u||h)&&o.setAttribute(c.nodeName,c.value)}var d=Hv(o.nodeName);return xn[d].call(this,o,e)},g:function(t,e){var i,n=new mn;aa.call(this,t,n,e),this.add(n),i=Jae.call(this,t);for(var r=0,s=t.childNodes.length;r<s;r++){var o=t.childNodes[r],a=o.nodeName;if(!a)return;var l=Hv(a);if(l in xn){var c=xn[l].call(n,o,i);c&&!c.parent&&n.add(c)}}return n},polygon:function(t,e){var i=t.getAttribute("points"),n=[];i.replace(/(-?[\d.eE-]+)[,|\s](-?[\d.eE-]+)/g,function(s,o,a){n.push(new Ot(parseFloat(o),parseFloat(a)))});var r=new ct(n,!0).noStroke();return r.fill="black",aa.call(this,t,r,e),r},polyline:function(t,e){var i=xn.polygon.call(this,t,e);return i.closed=!1,i},path:function(t,e){var i=t.getAttribute("d"),n=[],r=!1,s=!1;if(i){var o=new Ot,a,l,c=i.match(/[a-df-z][^a-df-z]*/ig),u=c.length-1;Ce.each(c.slice(0),function(d,f){var m=d.slice(1).trim().match(Fl.path),g=d[0],v=g.toLowerCase(),p,b,_,P,E,T=[];switch(f===0&&(c=[]),v){case"h":case"v":m.length>1&&(p=1);break;case"m":case"l":case"t":m.length>2&&(p=2);break;case"s":case"q":m.length>4&&(p=4);break;case"c":m.length>6&&(p=6);break;case"a":m.length>7&&(p=7);break}if(p){for(b=0,_=m.length,E=0;b<_;b+=p){if(P=g,E>0)switch(g){case"m":P="l";break;case"M":P="L";break}T.push(P+m.slice(b,b+p).join(" ")),E++}c=Array.prototype.concat.apply(c,T)}else c.push(d)}),Ce.each(c,function(d,f){var m,g,v,p=d[0],b=p.toLowerCase();l=d.slice(1).trim().match(Fl.path),s=p===b;var _,P,E,T,C,M,x,V,N;switch(b){case"z":if(f>=u)r=!0;else{g=o.x,v=o.y,m=new Ot(g,v,void 0,void 0,void 0,void 0,at.close);for(var D=n.length-1;D>=0;D--){var O=n[D];if(/m/i.test(O.command)){o=O;break}}}break;case"m":case"l":a=void 0,g=parseFloat(l[0]),v=parseFloat(l[1]),m=new Ot(g,v,void 0,void 0,void 0,void 0,/m/i.test(b)?at.move:at.line),s&&m.addSelf(o),o=m;break;case"h":case"v":var F=/h/i.test(b)?"x":"y",X=/x/i.test(F)?"y":"x";m=new Ot(void 0,void 0,void 0,void 0,void 0,void 0,at.line),m[F]=parseFloat(l[0]),m[X]=o[X],s&&(m[F]+=o[F]),o=m;break;case"c":case"s":_=o.x,P=o.y,a||(a=new ot),/c/i.test(b)?(E=parseFloat(l[0]),T=parseFloat(l[1]),C=parseFloat(l[2]),M=parseFloat(l[3]),x=parseFloat(l[4]),V=parseFloat(l[5])):(N=rC(o,a,s),E=N.x,T=N.y,C=parseFloat(l[0]),M=parseFloat(l[1]),x=parseFloat(l[2]),V=parseFloat(l[3])),s&&(E+=_,T+=P,C+=_,M+=P,x+=_,V+=P),Ce.isObject(o.controls)||Ot.AppendCurveProperties(o),o.controls.right.set(E-o.x,T-o.y),m=new Ot(x,V,C-x,M-V,void 0,void 0,at.curve),o=m,a=m.controls.left;break;case"t":case"q":_=o.x,P=o.y,a||(a=new ot),/q/i.test(b)?(E=parseFloat(l[0]),T=parseFloat(l[1]),C=parseFloat(l[0]),M=parseFloat(l[1]),x=parseFloat(l[2]),V=parseFloat(l[3])):(N=rC(o,a,s),E=N.x,T=N.y,C=N.x,M=N.y,x=parseFloat(l[0]),V=parseFloat(l[1])),s&&(E+=_,T+=P,C+=_,M+=P,x+=_,V+=P),Ce.isObject(o.controls)||Ot.AppendCurveProperties(o),o.controls.right.set((E-o.x)*.33,(T-o.y)*.33),m=new Ot(x,V,C-x,M-V,void 0,void 0,at.curve),o=m,a=m.controls.left;break;case"a":_=o.x,P=o.y;var Z=parseFloat(l[0]),K=parseFloat(l[1]),z=parseFloat(l[2]),H=parseFloat(l[3]),re=parseFloat(l[4]);x=parseFloat(l[5]),V=parseFloat(l[6]),s&&(x+=_,V+=P);var ne=new Ot(x,V);ne.command=at.arc,ne.rx=Z,ne.ry=K,ne.xAxisRotation=z,ne.largeArcFlag=H,ne.sweepFlag=re,m=ne,o=ne,a=void 0;break}m&&(Array.isArray(m)?n=n.concat(m):n.push(m))})}i=new ct(n,r,void 0,!0).noStroke(),i.fill="black";var h=i.getBoundingClientRect(!0);return h.centroid={x:h.left+h.width/2,y:h.top+h.height/2},Ce.each(i.vertices,function(d){d.subSelf(h.centroid)}),aa.call(this,t,i,e),i.translation.addSelf(h.centroid),i},circle:function(t,e){var i=parseFloat(t.getAttribute("cx")),n=parseFloat(t.getAttribute("cy")),r=parseFloat(t.getAttribute("r")),s=new cl(0,0,r).noStroke();return s.fill="black",aa.call(this,t,s,e),s.translation.x=i,s.translation.y=n,s},ellipse:function(t,e){var i=parseFloat(t.getAttribute("cx")),n=parseFloat(t.getAttribute("cy")),r=parseFloat(t.getAttribute("rx")),s=parseFloat(t.getAttribute("ry")),o=new hl(0,0,r,s).noStroke();return o.fill="black",aa.call(this,t,o,e),o.translation.x=i,o.translation.y=n,o},rect:function(t,e){var i=parseFloat(t.getAttribute("rx")),n=parseFloat(t.getAttribute("ry"));if(!Ce.isNaN(i)||!Ce.isNaN(n))return xn["rounded-rect"](t);var r=parseFloat(t.getAttribute("width")),s=parseFloat(t.getAttribute("height")),o=r/2,a=s/2,l=new sr(0,0,r,s).noStroke();return l.fill="black",aa.call(this,t,l,e),l.translation.x+=o,l.translation.y+=a,l},"rounded-rect":function(t,e){var i=parseFloat(t.getAttribute("rx"))||0,n=parseFloat(t.getAttribute("ry"))||0,r=parseFloat(t.getAttribute("width")),s=parseFloat(t.getAttribute("height")),o=r/2,a=s/2,l=new ot(i,n),c=new wa(0,0,r,s,l).noStroke();return c.fill="black",aa.call(this,t,c,e),c.translation.x+=o,c.translation.y+=a,c},line:function(t,e){var i=parseFloat(t.getAttribute("x1")),n=parseFloat(t.getAttribute("y1")),r=parseFloat(t.getAttribute("x2")),s=parseFloat(t.getAttribute("y2")),o=new lp(i,n,r,s).noFill();return aa.call(this,t,o,e),o},lineargradient:function(t,e){var i=t.getAttribute("gradientUnits"),n=t.getAttribute("spreadMethod");i||(i="objectBoundingBox"),n||(n="pad");var r=parseFloat(t.getAttribute("x1")||0),s=parseFloat(t.getAttribute("y1")||0),o=parseFloat(t.getAttribute("x2")||0),a=parseFloat(t.getAttribute("y2")||0),l=(o+r)/2,c=(a+s)/2;/userSpaceOnUse/i.test(i)&&(r-=l,s-=c,o-=l,a-=c);for(var u=[],h=0;h<t.children.length;h++){var d=t.children[h],f=d.getAttribute("offset");/%/ig.test(f)&&(f=parseFloat(f.replace(/%/ig,""))/100),f=parseFloat(f);var m=d.getAttribute("stop-color"),g=d.getAttribute("stop-opacity"),v=d.getAttribute("style"),p;m===null&&(p=v?v.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,m=p&&p.length>1?p[1]:void 0),g===null?(p=v?v.match(/stop-opacity:\s?([0-9.-]*)/):!1,g=p&&p.length>1?parseFloat(p[1]):1):g=parseFloat(g),u.push(new Cr(f,m,g))}var b=new nn(r,s,o,a,u);return b.spread=n,b.units=i,aa.call(this,t,b,e),b},radialgradient:function(t,e){var i=t.getAttribute("gradientUnits");t.getAttribute("spreadMethod"),i||(i="objectBoundingBox");var n=parseFloat(t.getAttribute("cx"))||0,r=parseFloat(t.getAttribute("cy"))||0,s=parseFloat(t.getAttribute("r")),o=parseFloat(t.getAttribute("fx")),a=parseFloat(t.getAttribute("fy"));Ce.isNaN(o)&&(o=n),Ce.isNaN(a)&&(a=r);var l=Math.abs(n+o)/2,c=Math.abs(r+a)/2;/userSpaceOnUse/i.test(i)&&(n-=l,r-=c,o-=l,a-=c);for(var u=[],h=0;h<t.children.length;h++){var d=t.children[h],f=d.getAttribute("offset");/%/ig.test(f)&&(f=parseFloat(f.replace(/%/ig,""))/100),f=parseFloat(f);var m=d.getAttribute("stop-color"),g=d.getAttribute("stop-opacity"),v=d.getAttribute("style"),p;m===null&&(p=v?v.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,m=p&&p.length>1?p[1]:void 0),g===null?(p=v?v.match(/stop-opacity:\s?([0-9.-]*)/):!1,g=p&&p.length>1?parseFloat(p[1]):1):g=parseFloat(g),u.push(new Cr(f,m,g))}var b=new Zi(n,r,s,u,o,a);return aa.call(this,t,b,e),b},text:function(t,e){var i=Xae(t.getAttribute("text-anchor"))||"left",n=Yae(t)||"baseline",r=t.textContent,s=new Bn(r);return aa.call(this,t,s,e),s.alignment=i,s.baseline=n,s},clippath:function(t,e){return xn.defs.current&&!xn.defs.current.contains(t.id)&&xn.defs.current.add(t.id,t),null},image:function(t,e){var i=t.getAttribute("href")||t.getAttribute("xlink:href");if(!i){var n=new Po("encountered <image /> with no href.");return console.warn(n.name,n.message),null}var r=parseFloat(t.getAttribute("x"))||0,s=parseFloat(t.getAttribute("y"))||0,o=parseFloat(t.getAttribute("width")),a=parseFloat(t.getAttribute("height")),l=new lc(i,r,s);return Ce.isNaN(o)||(l.width=o),Ce.isNaN(a)||(l.height=a),aa.call(this,t,l,e),l}};function f5(t,e){var i=new XMLHttpRequest;return i.open("GET",t),i.onreadystatechange=function(){i.readyState===4&&i.status===200&&e(i.responseText)},i.send(),i}function qs(t,e,i,n){ct.call(this,[new Ot,new Ot,new Ot,new Ot],!0),this._renderer.flagTextures=qs.FlagTextures.bind(this),this._renderer.bindTextures=qs.BindTextures.bind(this),this._renderer.unbindTextures=qs.UnbindTextures.bind(this),this.noStroke(),this.noFill(),Array.isArray(t)?this.textures=t.map(qs.GenerateTexture.bind(this)):this.textures=[qs.GenerateTexture(t)],this.origin=new ot,this._update(),this.translation.set(e||0,i||0),typeof n=="number"?this.frameRate=n:this.frameRate=qs.DefaultFrameRate,this.index=0}Ce.extend(qs,{Properties:["frameRate","index"],DefaultFrameRate:30,FlagTextures:function(){this._flagTextures=!0},BindTextures:function(t){for(var e=t.length;e--;)t[e].bind(Be.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()},UnbindTextures:function(t){for(var e=t.length;e--;)t[e].unbind(Be.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()},MakeObservable:function(t){sr.MakeObservable(t),Ce.each(qs.Properties,Vs,t),Object.defineProperty(t,"textures",{enumerable:!0,get:function(){return this._textures},set:function(e){var i=this._renderer.bindTextures,n=this._renderer.unbindTextures;this._textures&&this._textures.unbind(Be.Types.insert,i).unbind(Be.Types.remove,n),this._textures=new Fa((e||[]).slice(0)),this._textures.bind(Be.Types.insert,i).bind(Be.Types.remove,n),i(this._textures)}})},GenerateTexture:function(t){if(t instanceof jt)return t;if(typeof t=="string")return new jt(t)}});Ce.extend(qs.prototype,sr.prototype,{constructor:qs,_flagTextures:!1,_flagFrameRate:!1,_flagIndex:!1,_amount:1,_duration:0,_index:0,_startTime:0,_playing:!1,_firstFrame:0,_lastFrame:0,_loop:!0,_textures:null,_frameRate:0,_origin:null,play:function(t,e,i){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=Ce.performance.now(),typeof t=="number"&&(this._firstFrame=t),typeof e=="number"&&(this._lastFrame=e),typeof i=="function"?this._onLastFrame=i:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this},pause:function(){return this._playing=!1,this},stop:function(){return this._playing=!1,this._index=this._firstFrame,this},clone:function(t){var e=new qs(this.textures,this.translation.x,this.translation.y,this.frameRate);return e._loop=this._loop,this._playing&&e.play(),t&&t.add(e),e},toObject:function(){var t=sr.prototype.toObject.call(this);return t.textures=this.textures.map(function(e){return e.toObject()}),t.frameRate=this.frameRate,t.index=this.index,t._firstFrame=this._firstFrame,t._lastFrame=this._lastFrame,t._loop=this._loop,t},_update:function(){var t=this._textures,e,i,n,r,s,o,a,l;return this._flagTextures&&(this._amount=t.length),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._playing&&this._frameRate>0?(r=this._amount,Ce.isNaN(this._lastFrame)&&(this._lastFrame=r-1),n=Ce.performance.now()-this._startTime,l=this._lastFrame+1,s=1e3*(l-this._firstFrame)/this._frameRate,this._loop?n=n%s:n=Math.min(n,s),a=Ro(this._firstFrame,l,n/s),a=Math.floor(a),a!==this._index&&(this._index=a,o=t[this._index],o.loaded&&(e=o.image.width,i=o.image.height,this.width!==e&&(this.width=e),this.height!==i&&(this.height=i),this.fill=o,a>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()))):(this._flagIndex||!(this.fill instanceof jt))&&(o=t[this._index],o.loaded&&(e=o.image.width,i=o.image.height,this.width!==e&&(this.width=e),this.height!==i&&(this.height=i)),this.fill=o),sr.prototype._update.call(this),this},flagReset:function(){return this._flagTextures=this._flagFrameRate=!1,sr.prototype.flagReset.call(this),this}});qs.MakeObservable(qs.prototype);function Kl(t,e,i,n,r,s,o){for(var a=o||Ra.Resolution*3,l=[],c=0;c<a;c++)l.push(new Ot);ct.call(this,l,!0,!1,!0),typeof i=="number"&&(this.innerRadius=i),typeof n=="number"&&(this.outerRadius=n),typeof r=="number"&&(this.startAngle=r),typeof s=="number"&&(this.endAngle=s),this._update(),typeof t=="number"&&(this.translation.x=t),typeof e=="number"&&(this.translation.y=e)}Ce.extend(Kl,{Properties:["startAngle","endAngle","innerRadius","outerRadius"],MakeObservable:function(t){ct.MakeObservable(t),Ce.each(Kl.Properties,Vs,t)}});Ce.extend(Kl.prototype,ct.prototype,{constructor:Kl,_flagStartAngle:!1,_flagEndAngle:!1,_flagInnerRadius:!1,_flagOuterRadius:!1,_startAngle:0,_endAngle:bs,_innerRadius:0,_outerRadius:0,_update:function(){if(this._flagVertices||this._flagStartAngle||this._flagEndAngle||this._flagInnerRadius||this._flagOuterRadius){var t=this._startAngle,e=this._endAngle,i=this._innerRadius,n=this._outerRadius,r=ea(t,bs)===ea(e,bs),s=i>0,o=this.vertices,a=s?o.length/2:o.length,l,c=0;r?a--:s||(a-=2);for(var u=0,h=a-1;u<a;u++){var d=u/h,f=o[c],m=d*(e-t)+t,g=(e-t)/a,v=n*Math.cos(m),p=n*Math.sin(m);switch(u){case 0:l=at.move;break;default:l=at.curve}if(f.command=l,f.x=v,f.y=p,f.controls.left.clear(),f.controls.right.clear(),f.command===at.curve){var b=n*g/Math.PI;f.controls.left.x=b*Math.cos(m-xr),f.controls.left.y=b*Math.sin(m-xr),f.controls.right.x=b*Math.cos(m+xr),f.controls.right.y=b*Math.sin(m+xr),u===1&&f.controls.left.multiplyScalar(2),u===h&&f.controls.right.multiplyScalar(2)}c++}if(s){for(r?(o[c].command=at.close,c++):(a--,h=a-1),u=0;u<a;u++)d=u/h,f=o[c],m=(1-d)*(e-t)+t,g=(e-t)/a,v=i*Math.cos(m),p=i*Math.sin(m),l=at.curve,u<=0&&(l=r?at.move:at.line),f.command=l,f.x=v,f.y=p,f.controls.left.clear(),f.controls.right.clear(),f.command===at.curve&&(b=i*g/Math.PI,f.controls.left.x=b*Math.cos(m+xr),f.controls.left.y=b*Math.sin(m+xr),f.controls.right.x=b*Math.cos(m-xr),f.controls.right.y=b*Math.sin(m-xr),u===1&&f.controls.left.multiplyScalar(2),u===h&&f.controls.right.multiplyScalar(2)),c++;o[c].copy(o[0]),o[c].command=at.line}else r||(o[c].command=at.line,o[c].x=0,o[c].y=0,c++,o[c].copy(o[0]),o[c].command=at.line)}return ct.prototype._update.call(this),this},flagReset:function(){return ct.prototype.flagReset.call(this),this._flagStartAngle=this._flagEndAngle=this._flagInnerRadius=this._flagOuterRadius=!1,this},clone:function(t){var e=this.innerRadius,i=this.outerRadius,n=this.startAngle,r=this.endAngle,s=this.vertices.length,o=new Kl(0,0,e,i,n,r,s);return o.translation.copy(this.translation),o.rotation=this.rotation,o.scale=this.scale,o.skewX=this.skewX,o.skewY=this.skewY,this.matrix.manual&&o.matrix.copy(this.matrix),Ce.each(ct.Properties,function(a){o[a]=this[a]},this),t&&t.add(o),o},toObject:function(){var t=ct.prototype.toObject.call(this);return Ce.each(Kl.Properties,function(e){t[e]=this[e]},this),t}});Kl.MakeObservable(Kl.prototype);var nle=Math.ceil,rle=Math.floor;function ya(t){rn.call(this),this._renderer.type="points",this._renderer.flagVertices=ct.FlagVertices.bind(this),this._renderer.bindVertices=ct.BindVertices.bind(this),this._renderer.unbindVertices=ct.UnbindVertices.bind(this),this._renderer.flagFill=ct.FlagFill.bind(this),this._renderer.flagStroke=ct.FlagStroke.bind(this),this._renderer.vertices=null,this._renderer.collection=null,this.sizeAttenuation=!1,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.className="",this.visible=!0,this.vertices=t,this.dashes=[],this.dashes.offset=0}Ce.extend(ya,{Properties:["fill","stroke","linewidth","opacity","visible","size","sizeAttenuation","beginning","ending"],MakeObservable:function(t){rn.MakeObservable(t),Ce.each(ya.Properties.slice(2,7),Vs,t),Object.defineProperty(t,"fill",{enumerable:!0,get:function(){return this._fill},set:function(e){(this._fill instanceof Ai||this._fill instanceof nn||this._fill instanceof Zi||this._fill instanceof jt)&&this._fill.unbind(Be.Types.change,this._renderer.flagFill),this._fill=e,this._flagFill=!0,(this._fill instanceof Ai||this._fill instanceof nn||this._fill instanceof Zi||this._fill instanceof jt)&&this._fill.bind(Be.Types.change,this._renderer.flagFill)}}),Object.defineProperty(t,"stroke",{enumerable:!0,get:function(){return this._stroke},set:function(e){(this._stroke instanceof Ai||this._stroke instanceof nn||this._stroke instanceof Zi||this._stroke instanceof jt)&&this._stroke.unbind(Be.Types.change,this._renderer.flagStroke),this._stroke=e,this._flagStroke=!0,(this._stroke instanceof Ai||this._stroke instanceof nn||this._stroke instanceof Zi||this._stroke instanceof jt)&&this._stroke.bind(Be.Types.change,this._renderer.flagStroke)}}),Object.defineProperty(t,"length",{get:function(){return this._flagLength&&this._updateLength(),this._length}}),Object.defineProperty(t,"beginning",{enumerable:!0,get:function(){return this._beginning},set:function(e){this._beginning=e,this._flagVertices=!0}}),Object.defineProperty(t,"ending",{enumerable:!0,get:function(){return this._ending},set:function(e){this._ending=e,this._flagVertices=!0}}),Object.defineProperty(t,"vertices",{enumerable:!0,get:function(){return this._collection},set:function(e){var i=this._renderer.bindVertices,n=this._renderer.unbindVertices;this._collection&&this._collection.unbind(Be.Types.insert,i).unbind(Be.Types.remove,n),e instanceof Fa?this._collection=e:this._collection=new Fa(e||[]),this._collection.bind(Be.Types.insert,i).bind(Be.Types.remove,n),i(this._collection)}}),Object.defineProperty(t,"dashes",{enumerable:!0,get:function(){return this._dashes},set:function(e){typeof e.offset!="number"&&(e.offset=this.dashes&&this._dashes.offset||0),this._dashes=e}})}});Ce.extend(ya.prototype,rn.prototype,{constructor:ya,_flagVertices:!0,_flagLength:!0,_flagFill:!0,_flagStroke:!0,_flagLinewidth:!0,_flagOpacity:!0,_flagVisible:!0,_flagSize:!0,_flagSizeAttenuation:!0,_length:0,_fill:"#fff",_stroke:"#000",_linewidth:1,_opacity:1,_visible:!0,_size:1,_sizeAttenuation:!1,_beginning:0,_ending:1,_dashes:null,clone:function(t){for(var e=new ya,i=0;i<this.vertices.length;i++)e.vertices.push(this.vertices[i].clone());for(var n=0;n<ya.Properties.length;n++){var r=ya.Properties[n];e[r]=this[r]}return e.className=this.className,e.translation.copy(this.translation),e.rotation=this.rotation,e.scale=this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&e.matrix.copy(this.matrix),t&&t.add(e),e._update()},toObject:function(){var t={vertices:this.vertices.map(function(e){return e.toObject()})};return Ce.each(ya.Properties,function(e){t[e]=this[e]},this),t.className=this.className,t.translation=this.translation.toObject(),t.rotation=this.rotation,t.scale=this.scale instanceof ot?this.scale.toObject():this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&(t.matrix=this.matrix.toObject()),t},noFill:ct.prototype.noFill,noStroke:ct.prototype.noStroke,corner:ct.prototype.corner,center:ct.prototype.center,remove:ct.prototype.remove,getBoundingClientRect:ct.prototype.getBoundingClientRect,subdivide:function(t){this._update();for(var e=[],i=0;i<this.vertices.length;i++){var n=this.vertices[i],r=this.vertices[i-1];if(r){var s=n.x,o=n.y,a=r.x,l=r.y,c=GM(s,o,s,o,a,l,a,l,t);e=e.concat(c)}}return this.vertices=e,this},_updateLength:ct.prototype._updateLength,_update:function(){if(this._flagVertices){this._flagLength&&this._updateLength(void 0,!0);var t=Math.min(this._beginning,this._ending),e=Math.max(this._beginning,this._ending),i=u_(this,t*this._length),n=u_(this,e*this._length),r=nle(i),s=rle(n);this._renderer.vertices=[],this._renderer.collection=[];for(var o=0,a,l=0;l<this._collection.length;l++)l>=r&&l<=s&&(a=this._collection[l],this._renderer.collection.push(a),this._renderer.vertices[o*2+0]=a.x,this._renderer.vertices[o*2+1]=a.y,o++)}return rn.prototype._update.apply(this,arguments),this},flagReset:function(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagSize=this._flagSizeAttenuation=!1,rn.prototype.flagReset.call(this),this}});ya.MakeObservable(ya.prototype);var sle=Math.cos,ole=Math.sin;function Xl(t,e,i,n){n=Math.max(n||0,3),ct.call(this),this.closed=!0,this.automatic=!1,typeof i=="number"&&(this.width=i*2),typeof i=="number"&&(this.height=i*2),typeof n=="number"&&(this.sides=n),this._update(),typeof t=="number"&&(this.translation.x=t),typeof e=="number"&&(this.translation.y=e)}Ce.extend(Xl,{Properties:["width","height","sides"],MakeObservable:function(t){ct.MakeObservable(t),Ce.each(Xl.Properties,Vs,t)}});Ce.extend(Xl.prototype,ct.prototype,{constructor:Xl,_flagWidth:!1,_flagHeight:!1,_flagSides:!1,_width:0,_height:0,_sides:0,_update:function(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagSides){var t=this._sides,e=t+1,i=this.vertices.length;i>t&&(this.vertices.splice(t-1,i-t),i=t);for(var n=0;n<e;n++){var r=(n+.5)/t,s=bs*r+Math.PI/2,o=this._width*sle(s)/2,a=this._height*ole(s)/2;n>=i?this.vertices.push(new Ot(o,a)):this.vertices[n].set(o,a),this.vertices[n].command=n===0?at.move:at.line}}return ct.prototype._update.call(this),this},flagReset:function(){return this._flagWidth=this._flagHeight=this._flagSides=!1,ct.prototype.flagReset.call(this),this},clone:function(t){var e=new Xl(0,0,this.radius,this.sides);return e.translation.copy(this.translation),e.rotation=this.rotation,e.scale=this.scale,e.skewX=this.skewX,e.skewY=this.skewY,this.matrix.manual&&e.matrix.copy(this.matrix),Ce.each(ct.Properties,function(i){e[i]=this[i]},this),t&&t.add(e),e},toObject:function(){var t=ct.prototype.toObject.call(this);return Ce.each(Xl.Properties,function(e){t[e]=this[e]},this),t}});Xl.MakeObservable(Xl.prototype);var ale=Math.cos,lle=Math.sin;function Yl(t,e,i,n,r){arguments.length<=3&&(n=i,i=n/2),(typeof r!="number"||r<=0)&&(r=5),ct.call(this),this.closed=!0,this.automatic=!1,typeof i=="number"&&(this.innerRadius=i),typeof n=="number"&&(this.outerRadius=n),typeof r=="number"&&(this.sides=r),this._update(),typeof t=="number"&&(this.translation.x=t),typeof e=="number"&&(this.translation.y=e)}Ce.extend(Yl,{Properties:["innerRadius","outerRadius","sides"],MakeObservable:function(t){ct.MakeObservable(t),Ce.each(Yl.Properties,Vs,t)}});Ce.extend(Yl.prototype,ct.prototype,{constructor:Yl,_flagInnerRadius:!1,_flagOuterRadius:!1,_flagSides:!1,_innerRadius:0,_outerRadius:0,_sides:0,_update:function(){if(this._flagVertices||this._flagInnerRadius||this._flagOuterRadius||this._flagSides){var t=this._sides*2,e=t+1,i=this.vertices.length;i>t&&(this.vertices.splice(t-1,i-t),i=t);for(var n=0;n<e;n++){var r=(n+.5)/t,s=bs*r,o=(n%2?this._outerRadius:this._innerRadius)/2,a=o*ale(s),l=o*lle(s);n>=i?this.vertices.push(new Ot(a,l)):this.vertices[n].set(a,l),this.vertices[n].command=n===0?at.move:at.line}}return ct.prototype._update.call(this),this},flagReset:function(){return this._flagInnerRadius=this._flagOuterRadius=this._flagSides=!1,ct.prototype.flagReset.call(this),this},clone:function(t){var e=this.innerRadius,i=this.outerRadius,n=this.sides,r=new Yl(0,0,e,i,n);return r.translation.copy(this.translation),r.rotation=this.rotation,r.scale=this.scale,r.skewX=this.skewX,r.skewY=this.skewY,this.matrix.manual&&r.matrix.copy(this.matrix),Ce.each(ct.Properties,function(s){r[s]=this[s]},this),t&&t.add(r),r},toObject:function(){var t=ct.prototype.toObject.call(this);return Ce.each(Yl.Properties,function(e){t[e]=this[e]},this),t}});Yl.MakeObservable(Yl.prototype);var JN=new Jn,Zt={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",alignments:{left:"start",center:"middle",right:"end"},createElement:function(t,e){var i=t,n=document.createElementNS(Zt.ns,i);return i==="svg"&&(e=Ce.defaults(e||{},{version:Zt.version})),e&&Object.keys(e).length>0&&Zt.setAttributes(n,e),n},setAttributes:function(t,e){for(var i=Object.keys(e),n=0;n<i.length;n++)/href/.test(i[n])?t.setAttributeNS(Zt.xlink,i[n],e[i[n]]):t.setAttribute(i[n],e[i[n]]);return this},removeAttributes:function(t,e){for(var i in e)t.removeAttribute(i);return this},toString:function(t,e){for(var i=t.length,n=i-1,r,s="",o=0;o<i;o++){var a=t[o],l,c=e?ea(o-1,i):Math.max(o-1,0),u=t[c],h,d,f,m,g,v,p,b,_,P,E,T,C,M,x=zn(a.x),V=zn(a.y);switch(a.command){case at.close:l=at.close;break;case at.arc:P=a.rx,E=a.ry,T=a.xAxisRotation,C=a.largeArcFlag,M=a.sweepFlag,l=at.arc+" "+P+" "+E+" "+T+" "+C+" "+M+" "+x+" "+V;break;case at.curve:g=u.controls&&u.controls.right||ot.zero,v=a.controls&&a.controls.left||ot.zero,u.relative?(h=zn(g.x+u.x),d=zn(g.y+u.y)):(h=zn(g.x),d=zn(g.y)),a.relative?(f=zn(v.x+a.x),m=zn(v.y+a.y)):(f=zn(v.x),m=zn(v.y)),l=(o===0?at.move:at.curve)+" "+h+" "+d+" "+f+" "+m+" "+x+" "+V;break;case at.move:r=a,l=at.move+" "+x+" "+V;break;default:l=a.command+" "+x+" "+V}o>=n&&e&&(a.command===at.curve&&(b=r,p=a.controls&&a.controls.right||a,_=b.controls&&b.controls.left||b,a.relative?(h=zn(p.x+a.x),d=zn(p.y+a.y)):(h=zn(p.x),d=zn(p.y)),b.relative?(f=zn(_.x+b.x),m=zn(_.y+b.y)):(f=zn(_.x),m=zn(_.y)),x=zn(b.x),V=zn(b.y),l+=" C "+h+" "+d+" "+f+" "+m+" "+x+" "+V),a.command!==at.close&&(l+=" Z")),s+=l+" "}return s},pointsToString:function(t,e){for(var i="",n=e*.5,r=0;r<t.length;r++){var s=t[r].x,o=t[r].y-n;i+=at.move+" "+s+" "+o+" ",i+="a "+n+" "+n+" 0 1 0 0.001 0 Z"}return i},getClip:function(t,e){var i=t._renderer.clip;return i||(i=t._renderer.clip=Zt.createElement("clipPath",{"clip-rule":"nonzero"}),e.defs.appendChild(i)),i},group:{appendChild:function(t){var e=t._renderer.elem;if(e){var i=e.nodeName;!i||/(radial|linear)gradient/i.test(i)||t._clip||this.elem.appendChild(e)}},removeChild:function(t){var e=t._renderer.elem;if(!(!e||e.parentNode!=this.elem)){var i=e.nodeName;i&&(t._clip||this.elem.removeChild(e))}},orderChild:function(t){this.elem.appendChild(t._renderer.elem)},renderChild:function(t){Zt[t._renderer.type].render.call(t,this)},render:function(t){if(!this._visible&&!this._flagVisible||this._opacity===0&&!this._flagOpacity)return this;this._update(),this._renderer.elem||(this._renderer.elem=Zt.createElement("g",{id:this.id}),t.appendChild(this._renderer.elem));var e=this._matrix.manual||this._flagMatrix,i={domElement:t,elem:this._renderer.elem};e&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");for(var n=0;n<this.children.length;n++){var r=this.children[n];Zt[r._renderer.type].render.call(r,t)}return this._flagId&&this._renderer.elem.setAttribute("id",this._id),this._flagOpacity&&this._renderer.elem.setAttribute("opacity",this._opacity),this._flagVisible&&this._renderer.elem.setAttribute("display",this._visible?"inline":"none"),this._flagClassName&&this._renderer.elem.setAttribute("class",this.classList.join(" ")),this._flagAdditions&&this.additions.forEach(Zt.group.appendChild,i),this._flagSubtractions&&this.subtractions.forEach(Zt.group.removeChild,i),this._flagOrder&&this.children.forEach(Zt.group.orderChild,i),this._flagMask&&(this._mask?(Zt[this._mask._renderer.type].render.call(this._mask,t),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},path:{render:function(t){if(this._opacity===0&&!this._flagOpacity)return this;this._update();var e={},i=this._matrix.manual||this._flagMatrix;if(i&&(e.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(e.id=this._id),this._flagVertices){var n=Zt.toString(this._renderer.vertices,this._closed);e.d=n}if(this._fill&&this._fill._renderer&&(this._fill._update(),Zt[this._fill._renderer.type].render.call(this._fill,t,!0)),this._flagFill&&(e.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),Zt[this._stroke._renderer.type].render.call(this._stroke,t,!0)),this._flagStroke&&(e.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(e["stroke-width"]=this._linewidth),this._flagOpacity&&(e["stroke-opacity"]=this._opacity,e["fill-opacity"]=this._opacity),this._flagClassName&&(e.class=this.classList.join(" ")),this._flagVisible&&(e.visibility=this._visible?"visible":"hidden"),this._flagCap&&(e["stroke-linecap"]=this._cap),this._flagJoin&&(e["stroke-linejoin"]=this._join),this._flagMiter&&(e["stroke-miterlimit"]=this._miter),this.dashes&&this.dashes.length>0&&(e["stroke-dasharray"]=this.dashes.join(" "),e["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?Zt.setAttributes(this._renderer.elem,e):(e.id=this._id,this._renderer.elem=Zt.createElement("path",e),t.appendChild(this._renderer.elem)),this._flagClip){var r=Zt.getClip(this,t),s=this._renderer.elem;this._clip?(s.removeAttribute("id"),r.setAttribute("id",this.id),r.appendChild(s)):(r.removeAttribute("id"),s.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(s))}return this._flagMask&&(this._mask?(Zt[this._mask._renderer.type].render.call(this._mask,t),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},points:{render:function(t){if(this._opacity===0&&!this._flagOpacity)return this;this._update();var e={},i=this._matrix.manual||this._flagMatrix;if(i&&(e.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(e.id=this._id),this._flagVertices||this._flagSize||this._flagSizeAttenuation){var n=this._size;if(!this._sizeAttenuation){Wp(this,JN);var r=JN.elements,s=$v(r[0],r[3],r[1],r[4],r[2],r[5]);n/=Math.max(s.scaleX,s.scaleY)}var o=Zt.pointsToString(this._renderer.collection,n);e.d=o}return this._fill&&this._fill._renderer&&(this._fill._update(),Zt[this._fill._renderer.type].render.call(this._fill,t,!0)),this._flagFill&&(e.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),Zt[this._stroke._renderer.type].render.call(this._stroke,t,!0)),this._flagStroke&&(e.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(e["stroke-width"]=this._linewidth),this._flagOpacity&&(e["stroke-opacity"]=this._opacity,e["fill-opacity"]=this._opacity),this._flagClassName&&(e.class=this.classList.join(" ")),this._flagVisible&&(e.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(e["stroke-dasharray"]=this.dashes.join(" "),e["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?Zt.setAttributes(this._renderer.elem,e):(e.id=this._id,this._renderer.elem=Zt.createElement("path",e),t.appendChild(this._renderer.elem)),this.flagReset()}},text:{render:function(t){this._update();var e={},i=this._matrix.manual||this._flagMatrix;if(i&&(e.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(e.id=this._id),this._flagFamily&&(e["font-family"]=this._family),this._flagSize&&(e["font-size"]=this._size),this._flagLeading&&(e["line-height"]=this._leading),this._flagAlignment&&(e["text-anchor"]=Zt.alignments[this._alignment]||this._alignment),this._flagBaseline&&(e["alignment-baseline"]=e["dominant-baseline"]=this._baseline),this._flagStyle&&(e["font-style"]=this._style),this._flagWeight&&(e["font-weight"]=this._weight),this._flagDecoration&&(e["text-decoration"]=this._decoration),this._fill&&this._fill._renderer&&(this._fill._update(),Zt[this._fill._renderer.type].render.call(this._fill,t,!0)),this._flagFill&&(e.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),Zt[this._stroke._renderer.type].render.call(this._stroke,t,!0)),this._flagStroke&&(e.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(e["stroke-width"]=this._linewidth),this._flagOpacity&&(e.opacity=this._opacity),this._flagClassName&&(e.class=this.classList.join(" ")),this._flagVisible&&(e.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(e["stroke-dasharray"]=this.dashes.join(" "),e["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?Zt.setAttributes(this._renderer.elem,e):(e.id=this._id,this._renderer.elem=Zt.createElement("text",e),t.defs.appendChild(this._renderer.elem)),this._flagClip){var n=Zt.getClip(this,t),r=this._renderer.elem;this._clip?(r.removeAttribute("id"),n.setAttribute("id",this.id),n.appendChild(r)):(n.removeAttribute("id"),r.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(r))}return this._flagMask&&(this._mask?(Zt[this._mask._renderer.type].render.call(this._mask,t),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this._flagValue&&(this._renderer.elem.textContent=this._value),this.flagReset()}},"linear-gradient":{render:function(t,e){e||this._update();var i={};if(this._flagId&&(i.id=this._id),this._flagEndPoints&&(i.x1=this.left._x,i.y1=this.left._y,i.x2=this.right._x,i.y2=this.right._y),this._flagSpread&&(i.spreadMethod=this._spread),this._flagUnits&&(i.gradientUnits=this._units),this._renderer.elem?Zt.setAttributes(this._renderer.elem,i):(i.id=this._id,this._renderer.elem=Zt.createElement("linearGradient",i),t.defs.appendChild(this._renderer.elem)),this._flagStops){var n=this._renderer.elem.childNodes.length!==this.stops.length;if(n)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(var r=0;r<this.stops.length;r++){var s=this.stops[r],o={};s._flagOffset&&(o.offset=100*s._offset+"%"),s._flagColor&&(o["stop-color"]=s._color),s._flagOpacity&&(o["stop-opacity"]=s._opacity),s._renderer.elem?Zt.setAttributes(s._renderer.elem,o):s._renderer.elem=Zt.createElement("stop",o),n&&this._renderer.elem.appendChild(s._renderer.elem),s.flagReset()}}return this.flagReset()}},"radial-gradient":{render:function(t,e){e||this._update();var i={};if(this._flagId&&(i.id=this._id),this._flagCenter&&(i.cx=this.center._x,i.cy=this.center._y),this._flagFocal&&(i.fx=this.focal._x,i.fy=this.focal._y),this._flagRadius&&(i.r=this._radius),this._flagSpread&&(i.spreadMethod=this._spread),this._flagUnits&&(i.gradientUnits=this._units),this._renderer.elem?Zt.setAttributes(this._renderer.elem,i):(i.id=this._id,this._renderer.elem=Zt.createElement("radialGradient",i),t.defs.appendChild(this._renderer.elem)),this._flagStops){var n=this._renderer.elem.childNodes.length!==this.stops.length;if(n)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(var r=0;r<this.stops.length;r++){var s=this.stops[r],o={};s._flagOffset&&(o.offset=100*s._offset+"%"),s._flagColor&&(o["stop-color"]=s._color),s._flagOpacity&&(o["stop-opacity"]=s._opacity),s._renderer.elem?Zt.setAttributes(s._renderer.elem,o):s._renderer.elem=Zt.createElement("stop",o),n&&this._renderer.elem.appendChild(s._renderer.elem),s.flagReset()}}return this.flagReset()}},texture:{render:function(t,e){e||this._update();var i={},n={x:0,y:0},r=this.image;if(this._flagId&&(i.id=this._id),this._flagLoaded&&this.loaded)switch(r.nodeName.toLowerCase()){case"canvas":n.href=n["xlink:href"]=r.toDataURL("image/png");break;case"img":case"image":n.href=n["xlink:href"]=this.src;break}if((this._flagOffset||this._flagLoaded||this._flagScale)&&(i.x=this._offset.x,i.y=this._offset.y,r&&(i.x-=r.width/2,i.y-=r.height/2,this._scale instanceof ot?(i.x*=this._scale.x,i.y*=this._scale.y):(i.x*=this._scale,i.y*=this._scale)),i.x>0&&(i.x*=-1),i.y>0&&(i.y*=-1)),(this._flagScale||this._flagLoaded||this._flagRepeat)&&(i.width=0,i.height=0,r)){switch(n.width=i.width=r.width,n.height=i.height=r.height,this._repeat){case"no-repeat":i.width+=1,i.height+=1;break}this._scale instanceof ot?(i.width*=this._scale.x,i.height*=this._scale.y):(i.width*=this._scale,i.height*=this._scale)}return(this._flagScale||this._flagLoaded)&&(this._renderer.image?Zt.setAttributes(this._renderer.image,n):this._renderer.image=Zt.createElement("image",n)),this._renderer.elem?Object.keys(i).length!==0&&Zt.setAttributes(this._renderer.elem,i):(i.id=this._id,i.patternUnits="userSpaceOnUse",this._renderer.elem=Zt.createElement("pattern",i),t.defs.appendChild(this._renderer.elem)),this._renderer.elem&&this._renderer.image&&!this._renderer.appended&&(this._renderer.elem.appendChild(this._renderer.image),this._renderer.appended=!0),this.flagReset()}}};function d_(t){this.domElement=t.domElement||Zt.createElement("svg"),this.scene=new mn,this.scene.parent=this,this.defs=Zt.createElement("defs"),this.domElement.appendChild(this.defs),this.domElement.defs=this.defs,this.domElement.style.overflow="hidden"}Ce.extend(d_,{Utils:Zt});Ce.extend(d_.prototype,Be,{constructor:d_,setSize:function(t,e){return this.width=t,this.height=e,Zt.setAttributes(this.domElement,{width:t,height:e}),this.trigger(Be.Types.resize,t,e)},render:function(){return Zt.group.render.call(this.scene,this.domElement),this}});var la={create:function(t,e,i){var n,r,s;if(n=t.createShader(t[i]),t.shaderSource(n,e),t.compileShader(n),r=t.getShaderParameter(n,t.COMPILE_STATUS),!r)throw s=t.getShaderInfoLog(n),t.deleteShader(n),new Po("unable to compile shader "+n+": "+s);return n},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},path:{vertex:`
      precision mediump float;
      attribute vec2 a_position;

      uniform mat3 u_matrix;
      uniform vec2 u_resolution;
      uniform vec4 u_rect;

      varying vec2 v_textureCoords;

      void main() {
        vec2 rectCoords = (a_position * (u_rect.zw - u_rect.xy)) + u_rect.xy;
        vec2 projected = (u_matrix * vec3(rectCoords, 1.0)).xy;
        vec2 normal = projected / u_resolution;
        vec2 clipspace = (normal * 2.0) - 1.0;

        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);
        v_textureCoords = a_position;
      }
    `,fragment:`
      precision mediump float;

      uniform sampler2D u_image;
      varying vec2 v_textureCoords;

      void main() {
        vec4 texel = texture2D(u_image, v_textureCoords);
        if (texel.a == 0.0) {
          discard;
        }
        gl_FragColor = texel;
      }
    `},points:{vertex:`
      precision mediump float;
      attribute vec2 a_position;

      uniform float u_size;
      uniform mat3 u_matrix;
      uniform vec2 u_resolution;

      varying vec2 v_textureCoords;

      void main() {
        vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;
        vec2 normal = projected / u_resolution;
        vec2 clipspace = (normal * 2.0) - 1.0;

        gl_PointSize = u_size;
        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);
        v_textureCoords = a_position;
      }
    `,fragment:`
      precision mediump float;

      uniform sampler2D u_image;

      void main() {
        vec4 texel = texture2D(u_image, gl_PointCoord);
        if (texel.a == 0.0) {
          discard;
        }
        gl_FragColor = texel;
      }
    `}},yb=Jn.Multiply,cle=[1,0,0,0,1,0,0,0,1],Rh=new ql(9),hle=Wd.Utils,aC=new ql([0,0,1,0,0,1,0,1,1,0,1,1]),ii={precision:.9,isHidden:/(undefined|none|transparent)/i,canvas:tr.document?tr.document.createElement("canvas"):{getContext:function(){}},alignments:{left:"start",middle:"center",right:"end"},matrix:new Jn,group:{removeChild:function(t,e){if(t.children)for(var i=0;i<t.children.length;i++)ii.group.removeChild(t.children[i],e);t._renderer.texture&&(e.deleteTexture(t._renderer.texture),delete t._renderer.texture),t._renderer.positionBuffer&&(e.deleteBuffer(t._renderer.positionBuffer),delete t._renderer.positionBuffer)},render:function(t,e){if(this._visible){this._update();var i=this.parent,n=i._matrix&&i._matrix.manual||i._flagMatrix,r=this._matrix.manual||this._flagMatrix;(n||r)&&(this._renderer.matrix||(this._renderer.matrix=new ql(9)),this._matrix.toTransformArray(!0,Rh),yb(Rh,i._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof ot||(this._renderer.scale=new ot),this._scale instanceof ot?(this._renderer.scale.x=this._scale.x,this._renderer.scale.y=this._scale.y):(this._renderer.scale.x=this._scale,this._renderer.scale.y=this._scale),/renderer/i.test(i._renderer.type)||(this._renderer.scale.x*=i._renderer.scale.x,this._renderer.scale.y*=i._renderer.scale.y),n&&(this._flagMatrix=!0)),this._mask&&(t.clear(t.STENCIL_BUFFER_BIT),t.enable(t.STENCIL_TEST),t.stencilFunc(t.ALWAYS,1,0),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.colorMask(!1,!1,!1,!1),ii[this._mask._renderer.type].render.call(this._mask,t,e,this),t.stencilFunc(t.EQUAL,1,255),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.colorMask(!0,!0,!0,!0)),this._flagOpacity=i._flagOpacity||this._flagOpacity,this._renderer.opacity=this._opacity*(i&&i._renderer?i._renderer.opacity:1);var s;if(this._flagSubtractions)for(s=0;s<this.subtractions.length;s++)ii.group.removeChild(this.subtractions[s],t);for(s=0;s<this.children.length;s++){var o=this.children[s];ii[o._renderer.type].render.call(o,t,e)}return this._mask&&t.disable(t.STENCIL_TEST),this.flagReset()}}},path:{updateCanvas:function(t){var e,i,n,r,s,o,a,l,c,u,h,d,f,m,g=t._renderer.vertices,v=this.canvas,p=this.ctx,b=t._renderer.scale,_=t._stroke,P=t._linewidth,E=t._fill,T=t._renderer.opacity||t._opacity,C=t._cap,M=t._join,x=t._miter,V=t._closed,N=t.dashes,D=g.length,O=D-1;v.width=Math.max(Math.ceil(t._renderer.rect.width*b.x),1),v.height=Math.max(Math.ceil(t._renderer.rect.height*b.y),1);var F=t._renderer.rect.centroid,X=F.x,Z=F.y;p.clearRect(0,0,v.width,v.height),E&&(typeof E=="string"?p.fillStyle=E:(ii[E._renderer.type].render.call(E,p,t),p.fillStyle=E._renderer.effect)),_&&(typeof _=="string"?p.strokeStyle=_:(ii[_._renderer.type].render.call(_,p,t),p.strokeStyle=_._renderer.effect),P&&(p.lineWidth=P),x&&(p.miterLimit=x),M&&(p.lineJoin=M),!V&&C&&(p.lineCap=C)),typeof T=="number"&&(p.globalAlpha=T),N&&N.length>0&&(p.lineDashOffset=N.offset||0,p.setLineDash(N));var K;p.save(),p.scale(b.x,b.y),p.translate(X,Z),p.beginPath();for(var z=0;z<g.length;z++){var H=g[z];switch(d=H.x,f=H.y,H.command){case at.close:p.closePath();break;case at.arc:var re=H.rx,ne=H.ry,B=H.xAxisRotation,Q=H.largeArcFlag,fe=H.sweepFlag;e=V?ea(z-1,D):Math.max(z-1,0),i=g[e];var ie=i.x,se=i.y;hle.renderSvgArcCommand(p,ie,se,re,ne,Q,fe,B,d,f);break;case at.curve:e=V?ea(z-1,D):Math.max(z-1,0),i=g[e],l=i.controls&&i.controls.right||ot.zero,c=H.controls&&H.controls.left||ot.zero,i._relative?(o=l.x+i.x,a=l.y+i.y):(o=l.x,a=l.y),H._relative?(r=c.x+H.x,s=c.y+H.y):(r=c.x,s=c.y),p.bezierCurveTo(o,a,r,s,d,f),z>=O&&V&&(n=K,u=H.controls&&H.controls.right||ot.zero,h=n.controls&&n.controls.left||ot.zero,H._relative?(o=u.x+H.x,a=u.y+H.y):(o=u.x,a=u.y),n._relative?(r=h.x+n.x,s=h.y+n.y):(r=h.x,s=h.y),d=n.x,f=n.y,p.bezierCurveTo(o,a,r,s,d,f));break;case at.line:p.lineTo(d,f);break;case at.move:K=H,p.moveTo(d,f);break}}V&&p.closePath(),ii.isHidden.test(E)||(m=E._renderer&&E._renderer.offset,m&&(p.save(),p.translate(-E._renderer.offset.x,-E._renderer.offset.y),p.scale(E._renderer.scale.x,E._renderer.scale.y)),p.fill(),m&&p.restore()),ii.isHidden.test(_)||(m=_._renderer&&_._renderer.offset,m&&(p.save(),p.translate(-_._renderer.offset.x,-_._renderer.offset.y),p.scale(_._renderer.scale.x,_._renderer.scale.y),p.lineWidth=P/_._renderer.scale.x),p.stroke(),m&&p.restore()),p.restore()},getBoundingClientRect:function(t,e,i){var n=1/0,r=-1/0,s=1/0,o=-1/0,a,l;t.forEach(function(c){var u=c.x,h=c.y,d=c.controls,f,m,g,v,p,b;s=Math.min(h,s),n=Math.min(u,n),r=Math.max(u,r),o=Math.max(h,o),c.controls&&(p=d.left,b=d.right,!(!p||!b)&&(f=c._relative?p.x+u:p.x,m=c._relative?p.y+h:p.y,g=c._relative?b.x+u:b.x,v=c._relative?b.y+h:b.y,!(!f||!m||!g||!v)&&(s=Math.min(m,v,s),n=Math.min(f,g,n),r=Math.max(f,g,r),o=Math.max(m,v,o))))}),typeof e=="number"&&(s-=e,n-=e,r+=e,o+=e),a=r-n,l=o-s,i.top=s,i.left=n,i.right=r,i.bottom=o,i.width=a,i.height=l,i.centroid||(i.centroid={}),i.centroid.x=-n,i.centroid.y=-s},render:function(t,e,i){if(!this._visible||!this._opacity)return this;this._update();var n=i||this.parent,r=e[this._renderer.type],s=n._matrix.manual||n._flagMatrix,o=this._matrix.manual||this._flagMatrix,a=this._renderer.parent!==n,l=this._flagVertices||this._flagFill||this._fill instanceof nn&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof Zi&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof jt&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof nn&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof Zi&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof jt&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||n._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((s||o||a)&&(this._renderer.matrix||(this._renderer.matrix=new ql(9)),this._matrix.toTransformArray(!0,Rh),yb(Rh,n._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof ot||(this._renderer.scale=new ot),this._scale instanceof ot?(this._renderer.scale.x=this._scale.x*n._renderer.scale.x,this._renderer.scale.y=this._scale.y*n._renderer.scale.y):(this._renderer.scale.x=this._scale*n._renderer.scale.x,this._renderer.scale.y=this._scale*n._renderer.scale.y),a&&(this._renderer.parent=n)),this._mask&&(t.clear(t.STENCIL_BUFFER_BIT),t.enable(t.STENCIL_TEST),t.stencilFunc(t.ALWAYS,1,0),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.colorMask(!1,!1,!1,!1),ii[this._mask._renderer.type].render.call(this._mask,t,e,this),t.stencilFunc(t.EQUAL,1,255),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.colorMask(!0,!0,!0,!0)),l?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*n._renderer.opacity,ii.path.getBoundingClientRect(this._renderer.vertices,this._linewidth,this._renderer.rect),ii.updateTexture.call(ii,t,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!i||!this._renderer.texture)return this;e.current!==r&&(t.useProgram(r),t.bindBuffer(t.ARRAY_BUFFER,e.buffers.position),t.vertexAttribPointer(r.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r.position),t.bufferData(t.ARRAY_BUFFER,aC,t.STATIC_DRAW),e.resolution.flagged||t.uniform2f(t.getUniformLocation(r,"u_resolution"),e.resolution.width,e.resolution.height),e.current=r),e.resolution.flagged&&t.uniform2f(t.getUniformLocation(r,"u_resolution"),e.resolution.width,e.resolution.height),t.bindTexture(t.TEXTURE_2D,this._renderer.texture);var c=this._renderer.rect;return t.uniformMatrix3fv(r.matrix,!1,this._renderer.matrix),t.uniform4f(r.rect,c.left,c.top,c.right,c.bottom),t.drawArrays(t.TRIANGLES,0,6),this._mask&&t.disable(t.STENCIL_TEST),this.flagReset()}},points:{updateCanvas:function(t){var e,i=this.canvas,n=this.ctx,r=t._stroke,s=t._linewidth,o=t._fill,a=t._renderer.opacity||t._opacity,l=t.dashes,c=t._size,u=c;ii.isHidden.test(r)||(u+=s),i.width=s5(u),i.height=i.width;var h=u/i.width,d=i.width/2,f=i.height/2;n.clearRect(0,0,i.width,i.height),o&&(typeof o=="string"?n.fillStyle=o:(ii[o._renderer.type].render.call(o,n,t),n.fillStyle=o._renderer.effect)),r&&(typeof r=="string"?n.strokeStyle=r:(ii[r._renderer.type].render.call(r,n,t),n.strokeStyle=r._renderer.effect),s&&(n.lineWidth=s/h)),typeof a=="number"&&(n.globalAlpha=a),l&&l.length>0&&(n.lineDashOffset=l.offset||0,n.setLineDash(l)),n.save(),n.translate(d,f),n.scale(ii.precision,ii.precision),n.beginPath(),n.arc(0,0,c/h*.5,0,bs),n.restore(),closed&&n.closePath(),ii.isHidden.test(o)||(e=o._renderer&&o._renderer.offset,e&&(n.save(),n.translate(-o._renderer.offset.x,-o._renderer.offset.y),n.scale(o._renderer.scale.x,o._renderer.scale.y)),n.fill(),e&&n.restore()),ii.isHidden.test(r)||(e=r._renderer&&r._renderer.offset,e&&(n.save(),n.translate(-r._renderer.offset.x,-r._renderer.offset.y),n.scale(r._renderer.scale.x,r._renderer.scale.y),n.lineWidth=s/r._renderer.scale.x),n.stroke(),e&&n.restore())},render:function(t,e,i){if(!this._visible||!this._opacity)return this;this._update();var n=i||this.parent,r=e[this._renderer.type],s=this._size,o=this._sizeAttenuation,a=this._stroke,l=this._linewidth,c=n._matrix.manual||n._flagMatrix,u=this._matrix.manual||this._flagMatrix,h=this._renderer.parent!==n,d=this._renderer.vertices,f=this._renderer.collection.length,m=this._flagVertices,g=this._flagFill||this._fill instanceof nn&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof Zi&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof jt&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof nn&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof Zi&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof jt&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||n._flagOpacity||this._flagVisible||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((c||u||h)&&(this._renderer.matrix||(this._renderer.matrix=new ql(9)),this._matrix.toTransformArray(!0,Rh),yb(Rh,n._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof ot||(this._renderer.scale=new ot),this._scale instanceof ot?(this._renderer.scale.x=this._scale.x*n._renderer.scale.x,this._renderer.scale.y=this._scale.y*n._renderer.scale.y):(this._renderer.scale.x=this._scale*n._renderer.scale.x,this._renderer.scale.y=this._scale*n._renderer.scale.y),h&&(this._renderer.parent=n)),m){var v=this._renderer.positionBuffer;v&&t.deleteBuffer(v),this._renderer.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._renderer.positionBuffer),t.vertexAttribPointer(r.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r.position),t.bufferData(t.ARRAY_BUFFER,d,t.STATIC_DRAW)}return g?(this._renderer.opacity=this._opacity*n._renderer.opacity,ii.updateTexture.call(ii,t,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!i||!this._renderer.texture?this:(ii.isHidden.test(a)||(s+=l),s/=ii.precision,o&&(s*=Math.max(this._renderer.scale.x,this._renderer.scale.y)),e.current!==r&&(t.useProgram(r),e.resolution.flagged||t.uniform2f(t.getUniformLocation(r,"u_resolution"),e.resolution.width,e.resolution.height),e.current=r),e.resolution.flagged&&t.uniform2f(t.getUniformLocation(r,"u_resolution"),e.resolution.width,e.resolution.height),t.bindTexture(t.TEXTURE_2D,this._renderer.texture),t.uniformMatrix3fv(r.matrix,!1,this._renderer.matrix),t.uniform1f(r.size,s*e.resolution.ratio),t.drawArrays(t.POINTS,0,f),this.flagReset())}},text:{updateCanvas:function(t){var e=this.canvas,i=this.ctx,n=t._renderer.scale,r=t._stroke,s=t._linewidth*n,o=t._fill,a=t._renderer.opacity||t._opacity,l=t.dashes,c=t._decoration;e.width=Math.max(Math.ceil(t._renderer.rect.width*n.x),1),e.height=Math.max(Math.ceil(t._renderer.rect.height*n.y),1);var u=t._renderer.rect.centroid,h=u.x,d=u.y,f,m,g,v,p,b,_,P,E,T,C,M=o._renderer&&o._renderer.offset&&r._renderer&&r._renderer.offset;if(i.clearRect(0,0,e.width,e.height),M||(i.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" ")),i.textAlign="center",i.textBaseline="middle",o&&(typeof o=="string"?i.fillStyle=o:(ii[o._renderer.type].render.call(o,i,t),i.fillStyle=o._renderer.effect)),r&&(typeof r=="string"?i.strokeStyle=r:(ii[r._renderer.type].render.call(r,i,t),i.strokeStyle=r._renderer.effect),s&&(i.lineWidth=s)),typeof a=="number"&&(i.globalAlpha=a),l&&l.length>0&&(i.lineDashOffset=l.offset||0,i.setLineDash(l)),i.save(),i.scale(n.x,n.y),i.translate(h,d),ii.isHidden.test(o)||(o._renderer&&o._renderer.offset?(b=o._renderer.scale.x,_=o._renderer.scale.y,i.save(),i.translate(-o._renderer.offset.x,-o._renderer.offset.y),i.scale(b,_),f=t._size/o._renderer.scale.y,m=t._leading/o._renderer.scale.y,i.font=[t._style,t._weight,f+"px/",m+"px",t._family].join(" "),g=o._renderer.offset.x/o._renderer.scale.x,v=o._renderer.offset.y/o._renderer.scale.y,i.fillText(t.value,g,v),i.restore()):i.fillText(t.value,0,0)),ii.isHidden.test(r)||(r._renderer&&r._renderer.offset?(b=r._renderer.scale.x,_=r._renderer.scale.y,i.save(),i.translate(-r._renderer.offset.x,-r._renderer.offset.y),i.scale(b,_),f=t._size/r._renderer.scale.y,m=t._leading/r._renderer.scale.y,i.font=[t._style,t._weight,f+"px/",m+"px",t._family].join(" "),g=r._renderer.offset.x/r._renderer.scale.x,v=r._renderer.offset.y/r._renderer.scale.y,p=s/r._renderer.scale.x,i.lineWidth=p,i.strokeText(t.value,g,v),i.restore()):i.strokeText(t.value,0,0)),/(underline|strikethrough)/i.test(c)){var x=i.measureText(t.value);switch(c){case"underline":E=x.actualBoundingBoxAscent,C=x.actualBoundingBoxAscent;break;case"strikethrough":E=0,C=0;break}P=-x.width/2,T=x.width/2,i.lineWidth=Math.max(Math.floor(t._size/15),1),i.strokeStyle=i.fillStyle,i.beginPath(),i.moveTo(P,E),i.lineTo(T,C),i.stroke()}i.restore()},getBoundingClientRect:function(t,e){var i=ii.ctx;i.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" "),i.textAlign="center",i.textBaseline=t._baseline;var n=i.measureText(t._value).width*1.25,r=Math.max(t._size,t._leading)*1.25;this._linewidth&&!ii.isHidden.test(this._stroke)&&(n+=this._linewidth*2,r+=this._linewidth*2);var s=n/2,o=r/2;switch(ii.alignments[t._alignment]||t._alignment){case ii.alignments.left:e.left=0,e.right=n;break;case ii.alignments.right:e.left=-n,e.right=0;break;default:e.left=-s,e.right=s}switch(t._baseline){case"bottom":e.top=-r,e.bottom=0;break;case"top":e.top=0,e.bottom=r;break;default:e.top=-o,e.bottom=o}e.width=n,e.height=r,e.centroid||(e.centroid={}),e.centroid.x=s,e.centroid.y=o},render:function(t,e,i){if(!this._visible||!this._opacity)return this;this._update();var n=i||this.parent,r=e[this._renderer.type],s=n._matrix.manual||n._flagMatrix,o=this._matrix.manual||this._flagMatrix,a=this._renderer.parent!==n,l=this._flagVertices||this._flagFill||this._fill instanceof nn&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof Zi&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof jt&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof nn&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof Zi&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof jt&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||n._flagOpacity||this._flagVisible||this._flagScale||this._flagValue||this._flagFamily||this._flagSize||this._flagLeading||this._flagAlignment||this._flagBaseline||this._flagStyle||this._flagWeight||this._flagDecoration||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((s||o||a)&&(this._renderer.matrix||(this._renderer.matrix=new ql(9)),this._matrix.toTransformArray(!0,Rh),yb(Rh,n._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof ot||(this._renderer.scale=new ot),this._scale instanceof ot?(this._renderer.scale.x=this._scale.x*n._renderer.scale.x,this._renderer.scale.y=this._scale.y*n._renderer.scale.y):(this._renderer.scale.x=this._scale*n._renderer.scale.x,this._renderer.scale.y=this._scale*n._renderer.scale.y),a&&(this._renderer.parent=n)),this._mask&&(t.clear(t.STENCIL_BUFFER_BIT),t.enable(t.STENCIL_TEST),t.stencilFunc(t.ALWAYS,1,0),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.colorMask(!1,!1,!1,!1),ii[this._mask._renderer.type].render.call(this._mask,t,e,this),t.stencilFunc(t.EQUAL,1,255),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.colorMask(!0,!0,!0,!0)),l?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*n._renderer.opacity,ii.text.getBoundingClientRect(this,this._renderer.rect),ii.updateTexture.call(ii,t,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!i||!this._renderer.texture)return this;e.current!==r&&(t.useProgram(r),t.bindBuffer(t.ARRAY_BUFFER,e.buffers.position),t.vertexAttribPointer(r.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r.position),t.bufferData(t.ARRAY_BUFFER,aC,t.STATIC_DRAW),e.resolution.flagged||t.uniform2f(t.getUniformLocation(r,"u_resolution"),e.resolution.width,e.resolution.height),e.current=r),e.resolution.flagged&&t.uniform2f(t.getUniformLocation(r,"u_resolution"),e.resolution.width,e.resolution.height),t.bindTexture(t.TEXTURE_2D,this._renderer.texture);var c=this._renderer.rect;return t.uniformMatrix3fv(r.matrix,!1,this._renderer.matrix),t.uniform4f(r.rect,c.left,c.top,c.right,c.bottom),t.drawArrays(t.TRIANGLES,0,6),this._mask&&t.disable(t.STENCIL_TEST),this.flagReset()}},"linear-gradient":{render:function(t,e){if(t.canvas.getContext("2d")){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){var i,n=this.left._x,r=this.left._y,s=this.right._x,o=this.right._y;/objectBoundingBox/i.test(this._units)&&(i=e.getBoundingClientRect(!0),n=(n-.5)*i.width,r=(r-.5)*i.height,s=(s-.5)*i.width,o=(o-.5)*i.height),this._renderer.effect=t.createLinearGradient(n,r,s,o);for(var a=0;a<this.stops.length;a++){var l=this.stops[a];this._renderer.effect.addColorStop(l._offset,l._color)}}return this.flagReset()}}},"radial-gradient":{render:function(t,e){if(t.canvas.getContext("2d")){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){var i,n=this.center._x,r=this.center._y,s=this.focal._x,o=this.focal._y;/objectBoundingBox/i.test(this._units)&&(i=e.getBoundingClientRect(!0),n=(n-.5)*i.width,r=(r-.5)*i.height,s=(s-.5)*i.width,o=(o-.5)*i.height),this._renderer.effect=t.createRadialGradient(n,r,0,s,o,this._radius);for(var a=0;a<this.stops.length;a++){var l=this.stops[a];this._renderer.effect.addColorStop(l._offset,l._color)}}return this.flagReset()}}},texture:{render:function(t,e){if(t.canvas.getContext("2d")){this._update();var i=this.image;if((this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)this._renderer.effect=t.createPattern(i,this._repeat);else if(!this._renderer.effect)return this.flagReset();return(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof ot||(this._renderer.offset=new ot),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,i&&(this._renderer.offset.x+=i.width/2,this._renderer.offset.y+=i.height/2,this._scale instanceof ot?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof ot||(this._renderer.scale=new ot),this._scale instanceof ot?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}}},updateTexture:function(t,e){if(this[e._renderer.type].updateCanvas.call(ii,e),this.canvas.width<=0||this.canvas.height<=0){e._renderer.texture&&t.deleteTexture(e._renderer.texture),delete e._renderer.texture;return}e._renderer.texture||(e._renderer.texture=t.createTexture()),t.bindTexture(t.TEXTURE_2D,e._renderer.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.canvas)},program:{create:function(t,e){var i,n,r;if(i=t.createProgram(),Ce.each(e,function(s){t.attachShader(i,s)}),t.linkProgram(i),n=t.getProgramParameter(i,t.LINK_STATUS),!n)throw r=t.getProgramInfoLog(i),t.deleteProgram(i),new Po("unable to link program: "+r);return i}},TextureRegistry:new ap};ii.ctx=ii.canvas.getContext("2d");function f_(t){var e,i,n,r;if(this.domElement=t.domElement||document.createElement("canvas"),typeof t.offscreenElement<"u"&&(ii.canvas=t.offscreenElement,ii.ctx=ii.canvas.getContext("2d")),this.scene=new mn,this.scene.parent=this,this._renderer={type:"renderer",matrix:new ql(cle),scale:1,opacity:1},this._flagMatrix=!0,t=Ce.defaults(t||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=t.overdraw,e=this.ctx=this.domElement.getContext("webgl",t)||this.domElement.getContext("experimental-webgl",t),!this.ctx)throw new Po("unable to create a webgl context. Try using another renderer.");n=la.create(e,la.path.vertex,la.types.vertex),r=la.create(e,la.path.fragment,la.types.fragment),this.programs={current:null,buffers:{position:e.createBuffer()},resolution:{width:0,height:0,ratio:1,flagged:!1}},i=this.programs.path=ii.program.create(e,[n,r]),this.programs.text=this.programs.path,i.position=e.getAttribLocation(i,"a_position"),i.matrix=e.getUniformLocation(i,"u_matrix"),i.rect=e.getUniformLocation(i,"u_rect");var s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.vertexAttribPointer(i.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(i.position),e.bufferData(e.ARRAY_BUFFER,aC,e.STATIC_DRAW),n=la.create(e,la.points.vertex,la.types.vertex),r=la.create(e,la.points.fragment,la.types.fragment),i=this.programs.points=ii.program.create(e,[n,r]),i.position=e.getAttribLocation(i,"a_position"),i.matrix=e.getUniformLocation(i,"u_matrix"),i.size=e.getUniformLocation(i,"u_size"),e.enable(e.BLEND),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)}Ce.extend(f_,{Utils:ii});Ce.extend(f_.prototype,Be,{constructor:f_,setSize:function(t,e,i){var n,r,s=this.ctx;return this.width=t,this.height=e,this.ratio=typeof i>"u"?HM(s):i,this.domElement.width=t*this.ratio,this.domElement.height=e*this.ratio,Ce.isObject(this.domElement.style)&&Ce.extend(this.domElement.style,{width:t+"px",height:e+"px"}),this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,n=t*this.ratio,r=e*this.ratio,s.viewport(0,0,n,r),this.programs.resolution.width=n,this.programs.resolution.height=r,this.programs.resolution.ratio=this.ratio,this.programs.resolution.flagged=!0,this.trigger(Be.Types.resize,t,e,i)},render:function(){var t=this.ctx;return this.overdraw||t.clear(t.COLOR_BUFFER_BIT),ii.group.render.call(this.scene,t,this.programs),this._flagMatrix=!1,this.programs.resolution.flagged=!0,this}});function it(t){var e=Ce.defaults(t||{},{fullscreen:!1,fitted:!1,width:640,height:480,type:it.Types.svg,autostart:!1});if(Ce.each(e,function(n,r){/fullscreen/i.test(r)||/autostart/i.test(r)||(this[r]=n)},this),Ce.isElement(e.domElement)){var i=e.domElement.tagName.toLowerCase();/^(CanvasRenderer-canvas|WebGLRenderer-canvas|SVGRenderer-svg)$/.test(this.type+"-"+i)||(this.type=it.Types[i])}this.renderer=new it[this.type](this),this.setPlaying(e.autostart),this.frameCount=0,e.fullscreen?(this.fit=ule.bind(this),this.fit.domElement=window,this.fit.attached=!0,Ce.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),Ce.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),Bo.bind(this.fit.domElement,"resize",this.fit),this.fit()):e.fitted?(this.fit=dle.bind(this),Ce.extend(this.renderer.domElement.style,{display:"block"})):Ce.isElement(e.domElement)||(this.renderer.setSize(e.width,e.height,this.ratio),this.width=e.width,this.height=e.height),this.renderer.bind(Be.Types.resize,fle.bind(this)),this.scene=this.renderer.scene,it.Instances.push(this),e.autostart&&qv.init()}Ce.extend(it,Ra);Ce.extend(it.prototype,Be,{constructor:it,type:"",renderer:null,scene:null,width:0,height:0,frameCount:0,timeDelta:0,playing:!1,appendTo:function(t){return t.appendChild(this.renderer.domElement),this.fit&&(this.fit.domElement!==window&&(this.fit.domElement=t,this.fit.attached=!1),this.update()),this},play:function(){return this.playing=!0,qv.init(),this.trigger(Be.Types.play)},pause:function(){return this.playing=!1,this.trigger(Be.Types.pause)},setPlaying:function(t){this.playing=t},release:function(t){var e,i,n;if(!Ce.isObject(t))return this.release(this.scene);if(typeof t.unbind=="function"&&t.unbind(),t.vertices)for(typeof t.vertices.unbind=="function"&&t.vertices.unbind(),e=0;e<t.vertices.length;e++)i=t.vertices[e],typeof i.unbind=="function"&&i.unbind(),i.controls&&(i.controls.left&&typeof i.controls.left.unbind=="function"&&i.controls.left.unbind(),i.controls.right&&typeof i.controls.right.unbind=="function"&&i.controls.right.unbind());if(t.children){for(e=0;e<t.children.length;e++)n=t.children[e],this.release(n);typeof t.children.unbind=="function"&&t.children.unbind()}return t},update:function(){var t=!!this._lastFrame,e=Ce.performance.now();t&&(this.timeDelta=parseFloat((e-this._lastFrame).toFixed(3))),this._lastFrame=e,this.fit&&this.fit.domElement&&!this.fit.attached&&(Bo.bind(this.fit.domElement,"resize",this.fit),this.fit.attached=!0,this.fit());var i=this.width,n=this.height,r=this.renderer;return(i!==r.width||n!==r.height)&&r.setSize(i,n,this.ratio),this.trigger(Be.Types.update,this.frameCount,this.timeDelta),this.render()},render:function(){return this.renderer.render(),this.trigger(Be.Types.render,this.frameCount++)},add:function(t){var e=t;return e instanceof Array||(e=Array.prototype.slice.call(arguments)),this.scene.add(e),this},remove:function(t){var e=t;return e instanceof Array||(e=Array.prototype.slice.call(arguments)),this.scene.remove(e),this},clear:function(){return this.scene.remove(this.scene.children),this},makeLine:function(t,e,i,n){var r=new lp(t,e,i,n);return this.scene.add(r),r},makeArrow:function(t,e,i,n,r){var s=typeof r=="number"?r:10,o=Math.atan2(n-e,i-t),a=[new Ot(t,e,void 0,void 0,void 0,void 0,at.move),new Ot(i,n,void 0,void 0,void 0,void 0,at.line),new Ot(i-s*Math.cos(o-Math.PI/4),n-s*Math.sin(o-Math.PI/4),void 0,void 0,void 0,void 0,at.line),new Ot(i,n,void 0,void 0,void 0,void 0,at.move),new Ot(i-s*Math.cos(o+Math.PI/4),n-s*Math.sin(o+Math.PI/4),void 0,void 0,void 0,void 0,at.line)],l=new ct(a,!1,!1,!0);return l.noFill(),l.cap="round",l.join="round",this.scene.add(l),l},makeRectangle:function(t,e,i,n){var r=new sr(t,e,i,n);return this.scene.add(r),r},makeRoundedRectangle:function(t,e,i,n,r){var s=new wa(t,e,i,n,r);return this.scene.add(s),s},makeCircle:function(t,e,i,n){var r=new cl(t,e,i,n);return this.scene.add(r),r},makeEllipse:function(t,e,i,n,r){var s=new hl(t,e,i,n,r);return this.scene.add(s),s},makeStar:function(t,e,i,n,r){var s=new Yl(t,e,i,n,r);return this.scene.add(s),s},makeCurve:function(t){var e=arguments.length,i=t;if(!Array.isArray(t)){i=[];for(var n=0;n<e;n+=2){var r=arguments[n];if(typeof r!="number")break;var s=arguments[n+1];i.push(new Ot(r,s))}}var o=arguments[e-1],a=new ct(i,!(typeof o=="boolean"&&o),!0),l=a.getBoundingClientRect();return a.center().translation.set(l.left+l.width/2,l.top+l.height/2),this.scene.add(a),a},makePolygon:function(t,e,i,n){var r=new Xl(t,e,i,n);return this.scene.add(r),r},makeArcSegment:function(t,e,i,n,r,s,o){var a=new Kl(t,e,i,n,r,s,o);return this.scene.add(a),a},makePoints:function(t){var e=arguments.length,i=t;if(!Array.isArray(t)){i=[];for(var n=0;n<e;n+=2){var r=arguments[n];if(typeof r!="number")break;var s=arguments[n+1];i.push(new ot(r,s))}}var o=new ya(i);return this.scene.add(o),o},makePath:function(t){var e=arguments.length,i=t;if(!Array.isArray(t)){i=[];for(var n=0;n<e;n+=2){var r=arguments[n];if(typeof r!="number")break;var s=arguments[n+1];i.push(new Ot(r,s))}}var o=arguments[e-1],a=new ct(i,!(typeof o=="boolean"&&o)),l=a.getBoundingClientRect();return typeof l.top=="number"&&typeof l.left=="number"&&typeof l.right=="number"&&typeof l.bottom=="number"&&a.center().translation.set(l.left+l.width/2,l.top+l.height/2),this.scene.add(a),a},makeText:function(t,e,i,n){var r=new Bn(t,e,i,n);return this.add(r),r},makeLinearGradient:function(t,e,i,n){var r=Array.prototype.slice.call(arguments,4),s=new nn(t,e,i,n,r);return this.add(s),s},makeRadialGradient:function(t,e,i){var n=Array.prototype.slice.call(arguments,3),r=new Zi(t,e,i,n);return this.add(r),r},makeSprite:function(t,e,i,n,r,s,o){var a=new lc(t,e,i,n,r,s);return o&&a.play(),this.add(a),a},makeImageSequence:function(t,e,i,n,r){var s=new qs(t,e,i,n);return r&&s.play(),this.add(s),s},makeTexture:function(t,e){var i=new jt(t,e);return i},makeGroup:function(t){var e=t;e instanceof Array||(e=Array.prototype.slice.call(arguments));var i=new mn;return this.scene.add(i),i.add(e),i},interpret:function(t,e,i){var n=t.tagName.toLowerCase();if(i=typeof i<"u"?i:!0,!(n in xn))return null;var r=xn[n].call(this,t);return i?this.add(e&&r instanceof mn?r.children:r):r.parent&&r.remove(),r},load:function(t,e){var i=new mn,n,r,s,o=(function(a){for(Bo.temp.innerHTML=a,r=0;r<Bo.temp.children.length;r++)n=Bo.temp.children[r],s=this.interpret(n,!1,!1),s!==null&&i.add(s);if(typeof e=="function"){var l=Bo.temp.children.length<=1?Bo.temp.children[0]:Bo.temp.children;e(i,l)}}).bind(this);return/.*\.svg/ig.test(t)?(f5(t,o),i):(o(t),i)}});function ule(){var t=document.body.getBoundingClientRect(),e=this.width=t.width,i=this.height=t.height;this.renderer.setSize(e,i,this.ratio)}function dle(){var t=this.renderer.domElement.parentElement;if(!t){console.warn("Two.js: Attempting to fit to parent, but no parent found.");return}var e=t.getBoundingClientRect(),i=this.width=e.width,n=this.height=e.height;this.renderer.setSize(i,n,this.ratio)}function fle(t,e){this.width=t,this.height=e,this.trigger(Be.Types.resize,t,e)}var qv=Bo.getRequestAnimationFrame();function m5(){for(var t=0;t<it.Instances.length;t++){var e=it.Instances[t];e.playing&&e.update()}it.nextFrameID=qv(m5)}qv.init=function(){m5(),qv.init=function(){}};Ce.extend(it,{Anchor:Ot,Collection:Fa,Events:Be,Group:mn,Matrix:Jn,Path:ct,Registry:ap,Shape:rn,Text:Bn,Vector:ot,Gradient:Ai,ImageSequence:qs,LinearGradient:nn,RadialGradient:Zi,Sprite:lc,Stop:Cr,Texture:jt,ArcSegment:Kl,Circle:cl,Ellipse:hl,Line:lp,Points:ya,Polygon:Xl,Rectangle:sr,RoundedRectangle:wa,Star:Yl,CanvasRenderer:Wd,SVGRenderer:d_,WebGLRenderer:f_,Commands:at,Utils:Ce.extend({Error:Po,getRatio:HM,defineGetterSetter:Vs,read:xn,xhr:f5},Ce,Fo,Fae,Aae)});const Ha=new k,Fh=new k,Al=new k,bg=new Pt,Sb=new Pt,QN=new Pt,eR=new Pt,jf=S.angleMarker.numCirclePoints,$f=S.angleMarker.numEdgePoints,Vl=S.angleMarker.numBoundaryCirclePoints,Et=class Et extends pe{constructor(){super();y(this,"_vertexVector",new k);y(this,"_startVector",new k);y(this,"_endVector",new k);y(this,"_angleMarkerRadius",S.angleMarker.defaultRadius);y(this,"_angleMarkerRadiusDoubleArc",S.angleMarker.defaultRadius+S.angleMarker.doubleArcGap);y(this,"frontCirclePathStart");y(this,"frontCirclePathTail");y(this,"backCirclePathStart");y(this,"backCirclePathTail");y(this,"frontCirclePathDoubleArcStart");y(this,"frontCirclePathDoubleArcTail");y(this,"backCirclePathDoubleArcStart");y(this,"backCirclePathDoubleArcTail");y(this,"glowingFrontCirclePathStart");y(this,"glowingFrontCirclePathTail");y(this,"glowingBackCirclePathStart");y(this,"glowingBackCirclePathTail");y(this,"glowingFrontCirclePathDoubleArcStart");y(this,"glowingFrontCirclePathDoubleArcTail");y(this,"glowingBackCirclePathDoubleArcStart");y(this,"glowingBackCirclePathDoubleArcTail");y(this,"frontStraightStart");y(this,"backStraightStart");y(this,"frontStraightEnd");y(this,"backStraightEnd");y(this,"glowingFrontStraightStart");y(this,"glowingBackStraightStart");y(this,"glowingFrontStraightEnd");y(this,"glowingBackStraightEnd");y(this,"frontArrowHeadPath");y(this,"backArrowHeadPath");y(this,"glowingFrontArrowHeadPath");y(this,"glowingBackArrowHeadPath");y(this,"angleIsBigEnoughToDrawArrowHeads",!0);y(this,"frontFill1");y(this,"backFill1");y(this,"frontFill2");y(this,"backFill2");y(this,"fillStorageAnchors",[]);y(this,"glowingStrokeColorFront",S.angleMarker.glowing.strokeColor.front);y(this,"glowingStrokeColorBack",S.angleMarker.glowing.strokeColor.back);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpMatrix",new Pt);y(this,"tmpVectorDA",new k);y(this,"tmpMatrixDA",new Pt);y(this,"tmpVectorStraight",new k);y(this,"tmpArrowHeadTip",new k);y(this,"tmpArrowHeadRear",new k);y(this,"tmpArrowHeadInner",new k);y(this,"tmpArrowHeadOuter",new k);y(this,"tmpNormal1",new k);y(this,"tmpNormal2",new k);y(this,"tmpNormal",new k);const i=[];for(let o=0;o<jf;o++)i.push(new it.Vector(0,0));this.frontCirclePathStart=new it.Path(i,!1,!1),this.frontCirclePathDoubleArcStart=this.frontCirclePathStart.clone(),this.frontCirclePathTail=this.frontCirclePathStart.clone(),this.frontCirclePathDoubleArcTail=this.frontCirclePathStart.clone(),this.backCirclePathStart=this.frontCirclePathStart.clone(),this.backCirclePathDoubleArcStart=this.frontCirclePathStart.clone(),this.backCirclePathTail=this.frontCirclePathStart.clone(),this.backCirclePathDoubleArcTail=this.frontCirclePathStart.clone(),this.glowingFrontCirclePathStart=this.frontCirclePathStart.clone(),this.glowingFrontCirclePathDoubleArcStart=this.frontCirclePathStart.clone(),this.glowingFrontCirclePathTail=this.frontCirclePathStart.clone(),this.glowingFrontCirclePathDoubleArcTail=this.frontCirclePathStart.clone(),this.glowingBackCirclePathStart=this.frontCirclePathStart.clone(),this.glowingBackCirclePathDoubleArcStart=this.frontCirclePathStart.clone(),this.glowingBackCirclePathTail=this.frontCirclePathStart.clone(),this.glowingBackCirclePathDoubleArcTail=this.frontCirclePathStart.clone(),pe.idPlottableDescriptionMap.set(String(this.frontCirclePathStart.id),{type:"angleMarker",side:"front",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.frontCirclePathTail.id),{type:"angleMarker",side:"front",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.frontCirclePathDoubleArcStart.id),{type:"angleMarker",side:"front",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.frontCirclePathDoubleArcTail.id),{type:"angleMarker",side:"front",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.backCirclePathStart.id),{type:"angleMarker",side:"back",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.backCirclePathTail.id),{type:"angleMarker",side:"back",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.backCirclePathDoubleArcStart.id),{type:"angleMarker",side:"back",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.backCirclePathDoubleArcTail.id),{type:"angleMarker",side:"back",fill:!1,part:""}),this.frontCirclePathTail.vertices.splice(0),this.frontCirclePathDoubleArcTail.vertices.splice(0),this.backCirclePathTail.vertices.splice(0),this.backCirclePathDoubleArcTail.vertices.splice(0),this.glowingFrontCirclePathTail.vertices.splice(0),this.glowingFrontCirclePathDoubleArcTail.vertices.splice(0),this.glowingBackCirclePathTail.vertices.splice(0),this.glowingBackCirclePathDoubleArcTail.vertices.splice(0),this.frontCirclePathStart.noFill(),this.frontCirclePathDoubleArcStart.noFill(),this.frontCirclePathTail.noFill(),this.frontCirclePathDoubleArcTail.noFill(),this.backCirclePathStart.noFill(),this.backCirclePathDoubleArcStart.noFill(),this.backCirclePathTail.noFill(),this.backCirclePathDoubleArcTail.noFill(),this.glowingFrontCirclePathStart.noFill(),this.glowingFrontCirclePathDoubleArcStart.noFill(),this.glowingFrontCirclePathTail.noFill(),this.glowingFrontCirclePathDoubleArcTail.noFill(),this.glowingBackCirclePathStart.noFill(),this.glowingBackCirclePathDoubleArcStart.noFill(),this.glowingBackCirclePathTail.noFill(),this.glowingBackCirclePathDoubleArcTail.noFill(),this.frontCirclePathStart.cap="butt",this.frontCirclePathDoubleArcStart.cap="butt",this.frontCirclePathTail.cap="butt",this.frontCirclePathDoubleArcTail.cap="butt",this.backCirclePathStart.cap="butt",this.backCirclePathDoubleArcStart.cap="butt",this.backCirclePathTail.cap="butt",this.backCirclePathDoubleArcTail.cap="butt",this.glowingFrontCirclePathStart.cap="butt",this.glowingFrontCirclePathDoubleArcStart.cap="butt",this.glowingFrontCirclePathTail.cap="butt",this.glowingFrontCirclePathDoubleArcTail.cap="butt",this.glowingBackCirclePathStart.cap="butt",this.glowingBackCirclePathDoubleArcStart.cap="butt",this.glowingBackCirclePathTail.cap="butt",this.glowingBackCirclePathDoubleArcTail.cap="butt",this.frontCirclePathStart.visible=!0,this.frontCirclePathDoubleArcStart.visible=!0,this.frontCirclePathTail.visible=!0,this.frontCirclePathDoubleArcTail.visible=!0,this.backCirclePathStart.visible=!0,this.backCirclePathDoubleArcStart.visible=!0,this.backCirclePathTail.visible=!0,this.backCirclePathDoubleArcTail.visible=!0,this.glowingFrontCirclePathStart.visible=!1,this.glowingFrontCirclePathDoubleArcStart.visible=!1,this.glowingFrontCirclePathTail.visible=!1,this.glowingFrontCirclePathDoubleArcTail.visible=!1,this.glowingBackCirclePathStart.visible=!1,this.glowingBackCirclePathDoubleArcStart.visible=!1,this.glowingBackCirclePathTail.visible=!1,this.glowingBackCirclePathDoubleArcTail.visible=!1;const n=[];for(let o=0;o<$f;o++)n.push(new it.Vector(0,0));this.frontStraightStart=new it.Path(n,!1,!1),this.backStraightStart=this.frontStraightStart.clone(),this.frontStraightEnd=this.frontStraightStart.clone(),this.backStraightEnd=this.frontStraightStart.clone(),this.glowingFrontStraightStart=this.frontStraightStart.clone(),this.glowingBackStraightStart=this.frontStraightStart.clone(),this.glowingFrontStraightEnd=this.frontStraightStart.clone(),this.glowingBackStraightEnd=this.frontStraightStart.clone(),pe.idPlottableDescriptionMap.set(String(this.frontStraightStart.id),{type:"angleMarker",side:"front",fill:!1,part:"edge"}),pe.idPlottableDescriptionMap.set(String(this.frontStraightEnd.id),{type:"angleMarker",side:"front",fill:!1,part:"edge"}),pe.idPlottableDescriptionMap.set(String(this.backStraightStart.id),{type:"angleMarker",side:"back",fill:!1,part:"edge"}),pe.idPlottableDescriptionMap.set(String(this.backStraightEnd.id),{type:"angleMarker",side:"back",fill:!1,part:"edge"}),this.frontStraightStart.noFill(),this.backStraightStart.noFill(),this.frontStraightEnd.noFill(),this.backStraightEnd.noFill(),this.glowingFrontStraightStart.noFill(),this.glowingBackStraightStart.noFill(),this.glowingFrontStraightEnd.noFill(),this.glowingBackStraightEnd.noFill(),this.frontStraightStart.cap="square",this.backStraightStart.cap="square",this.frontStraightEnd.cap="square",this.backStraightEnd.cap="square",this.glowingFrontStraightStart.cap="square",this.glowingBackStraightStart.cap="square",this.glowingFrontStraightEnd.cap="square",this.glowingBackStraightEnd.cap="square",this.frontStraightStart.visible=!0,this.backStraightStart.visible=!0,this.frontStraightEnd.visible=!0,this.backStraightEnd.visible=!0,this.glowingFrontStraightStart.visible=!1,this.glowingBackStraightStart.visible=!1,this.glowingFrontStraightEnd.visible=!1,this.glowingBackStraightEnd.visible=!1;const r=[];for(let o=0;o<4;o++)r.push(new it.Vector(0,0));this.frontArrowHeadPath=new it.Path(r,!0,!1),this.glowingFrontArrowHeadPath=this.frontArrowHeadPath.clone(),this.backArrowHeadPath=this.frontArrowHeadPath.clone(),this.glowingBackArrowHeadPath=this.frontArrowHeadPath.clone(),pe.idPlottableDescriptionMap.set(String(this.frontArrowHeadPath.id),{type:"angleMarker",side:"front",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.backArrowHeadPath.id),{type:"angleMarker",side:"back",fill:!1,part:""}),this.frontArrowHeadPath.join="miter",this.backArrowHeadPath.join="miter",this.glowingFrontArrowHeadPath.join="miter",this.glowingBackArrowHeadPath.join="miter",this.glowingFrontArrowHeadPath.noFill(),this.glowingBackArrowHeadPath.noFill(),this.frontArrowHeadPath.visible=!0,this.backArrowHeadPath.visible=!0,this.glowingFrontArrowHeadPath.visible=!1,this.glowingBackArrowHeadPath.visible=!1;const s=[];for(let o=0;o<jf+2*$f+Vl;o++)s.push(new it.Vector(0,0));this.frontFill1=new it.Path(s,!0,!1),this.frontFill2=this.frontFill1.clone(),this.backFill1=this.frontFill1.clone(),this.backFill2=this.frontFill1.clone(),pe.idPlottableDescriptionMap.set(String(this.frontFill1.id),{type:"angleMarker",side:"front",fill:!0,part:""}),pe.idPlottableDescriptionMap.set(String(this.frontFill2.id),{type:"angleMarker",side:"front",fill:!0,part:""}),pe.idPlottableDescriptionMap.set(String(this.backFill1.id),{type:"angleMarker",side:"back",fill:!0,part:""}),pe.idPlottableDescriptionMap.set(String(this.backFill2.id),{type:"angleMarker",side:"back",fill:!0,part:""}),this.frontFill2.vertices.splice(0),this.backFill2.vertices.splice(0),this.frontFill1.noStroke(),this.frontFill2.noStroke(),this.backFill1.noStroke(),this.backFill2.noStroke(),this.frontFill1.visible=!0,this.frontFill2.visible=!0,this.backFill1.visible=!0,this.backFill2.visible=!0,this.styleOptions.set(q.Front,Qk),this.styleOptions.set(q.Back,eC)}static updateCurrentStrokeWidthAndRadiusForZoom(i){Et.currentAngleMarkerCircularStrokeWidthFront*=i,Et.currentAngleMarkerCircularStrokeWidthBack*=i,Et.currentGlowingAngleMarkerCircularStrokeWidthFront*=i,Et.currentGlowingAngleMarkerCircularStrokeWidthBack*=i,Et.currentAngleMarkerStraightStrokeWidthFront*=i,Et.currentAngleMarkerStraightStrokeWidthBack*=i,Et.currentGlowingAngleMarkerStraightStrokeWidthFront*=i,Et.currentGlowingAngleMarkerStraightStrokeWidthBack*=i,Et.currentAngleMarkerRadius*=i,Et.currentAngleMarkerRadiusDoubleArc*=i,Et.currentAngleMarkerArrowHeadLength*=i}updateDisplay(){Al.copy(this._vertexVector).normalize(),this.tmpVector.crossVectors(this._vertexVector,this._startVector).normalize(),Ha.crossVectors(this.tmpVector,this._vertexVector).normalize(),Fh.crossVectors(Al,Ha).normalize(),bg.makeBasis(Ha,Fh,Al),Sb.makeBasis(Ha,Fh,Al);const i=Math.cos(this._angleMarkerRadius),n=Math.cos(this._angleMarkerRadiusDoubleArc);this.tmpMatrix.makeTranslation(0,0,i*S.boundaryCircle.radius),this.tmpMatrixDA.makeTranslation(0,0,n*S.boundaryCircle.radius),bg.multiply(this.tmpMatrix),Sb.multiply(this.tmpMatrixDA),this.tmpMatrix.makeScale(Math.sin(this._angleMarkerRadius),Math.sin(this._angleMarkerRadius),1),this.tmpMatrixDA.makeScale(Math.sin(this._angleMarkerRadiusDoubleArc),Math.sin(this._angleMarkerRadiusDoubleArc),1),bg.multiply(this.tmpMatrix),Sb.multiply(this.tmpMatrixDA),this.tmpVector.copy(this._endVector),this.tmpVector.addScaledVector(this._vertexVector,-1*this._vertexVector.dot(this._endVector));const r=Math.atan2(Fh.dot(this.tmpVector),Ha.dot(this.tmpVector)).modTwoPi(),s=this.frontArrowHeadPath.linewidth/(2*S.boundaryCircle.radius*Math.sin((S.angleMarker.arrowHeadTipAngleInner+S.angleMarker.arrowHeadTipAngleOuter)/2)),o=Math.atan(Math.tan(Et.currentAngleMarkerArrowHeadLength+s)/Math.sin(this._angleMarkerRadius)),a=this.styleOptions.get(q.Front);let l;r>2*o&&(a!=null&&a.angleMarkerArrowHeads)&&a.angleMarkerArrowHeads===!0?(l=r-o,this.angleIsBigEnoughToDrawArrowHeads=!0):(l=r,this.angleIsBigEnoughToDrawArrowHeads=!1);const c=[];c.push(...this.frontCirclePathStart.vertices.splice(0)),c.push(...this.frontCirclePathTail.vertices.splice(0)),c.push(...this.backCirclePathStart.vertices.splice(0)),c.push(...this.backCirclePathTail.vertices.splice(0));const u=[];u.push(...this.glowingFrontCirclePathStart.vertices.splice(0)),u.push(...this.glowingFrontCirclePathTail.vertices.splice(0)),u.push(...this.glowingBackCirclePathStart.vertices.splice(0)),u.push(...this.glowingBackCirclePathTail.vertices.splice(0));const h=[],d=[];let f=0,m=0,g=0,v=this.frontCirclePathStart.vertices,p=this.backCirclePathStart.vertices,b=this.glowingFrontCirclePathStart.vertices,_=this.glowingBackCirclePathStart.vertices;for(let me=0;me<2*jf;me++){const Ne=me/(2*jf-1)*l;this.tmpVector.set(Math.cos(Ne),Math.sin(Ne),0).multiplyScalar(S.boundaryCircle.radius),this.tmpVector.applyMatrix4(bg);const ze=Math.sign(this.tmpVector.z);if(g!==ze&&(ze>0&&(h.length>0&&(v=this.frontCirclePathTail.vertices,b=this.glowingFrontCirclePathTail.vertices,f=0),h.push(me)),ze<0&&(d.length>0&&(p=this.backCirclePathTail.vertices,_=this.glowingBackCirclePathTail.vertices,m=0),d.push(me))),g=ze,this.tmpVector.z>0){if(f===v.length){const ke=c.pop();ke&&v.push(ke);const pt=u.pop();pt&&b.push(pt)}v[f].x=this.tmpVector.x,v[f].y=this.tmpVector.y,b[f].x=this.tmpVector.x,b[f].y=this.tmpVector.y,f++}else{if(m===p.length){const ke=c.pop();ke&&p.push(ke);const pt=u.pop();pt&&_.push(pt)}p[m].x=this.tmpVector.x,p[m].y=this.tmpVector.y,_[m].x=this.tmpVector.x,_[m].y=this.tmpVector.y,m++}}this.tmpArrowHeadRear.set(Math.cos(l),Math.sin(l),0).multiplyScalar(S.boundaryCircle.radius).applyMatrix4(bg),this.tmpVector.crossVectors(this.tmpArrowHeadRear,this._vertexVector),this.tmpVector.cross(this.tmpArrowHeadRear).normalize(),this.tmpVector1.crossVectors(this.tmpVector,this.tmpArrowHeadRear).normalize().multiplyScalar(S.boundaryCircle.radius),this.tmpArrowHeadTip.copy(this.tmpArrowHeadRear).multiplyScalar(Math.cos(Et.currentAngleMarkerArrowHeadLength)),this.tmpArrowHeadTip.addScaledVector(this.tmpVector1,Math.sin(Et.currentAngleMarkerArrowHeadLength)),this.tmpNormal.crossVectors(this.tmpArrowHeadRear,this.tmpArrowHeadTip).normalize(),this.tmpNormal1.crossVectors(this.tmpNormal,this.tmpArrowHeadTip).normalize(),this.tmpNormal1.multiplyScalar(Math.sin(S.angleMarker.arrowHeadTipAngleInner)).addScaledVector(this.tmpNormal,Math.cos(S.angleMarker.arrowHeadTipAngleInner)),this.tmpNormal2.crossVectors(this.tmpNormal,this.tmpArrowHeadRear).normalize(),this.tmpNormal2.multiplyScalar(Math.sin(S.angleMarker.arrowHeadRearAngleInner)).addScaledVector(this.tmpNormal,Math.cos(S.angleMarker.arrowHeadRearAngleInner)),this.tmpArrowHeadInner.crossVectors(this.tmpNormal1,this.tmpNormal2).normalize().multiplyScalar(S.boundaryCircle.radius),this.tmpArrowHeadTip.dot(this.tmpArrowHeadInner)<0&&this.tmpArrowHeadInner.multiplyScalar(-1),this.tmpNormal1.crossVectors(this.tmpNormal,this.tmpArrowHeadTip).normalize(),this.tmpNormal1.multiplyScalar(Math.sin(-S.angleMarker.arrowHeadTipAngleOuter)).addScaledVector(this.tmpNormal,Math.cos(-S.angleMarker.arrowHeadTipAngleOuter)),this.tmpNormal2.crossVectors(this.tmpNormal,this.tmpArrowHeadRear).normalize(),this.tmpNormal2.multiplyScalar(Math.sin(-S.angleMarker.arrowHeadRearAngleOuter)).addScaledVector(this.tmpNormal,Math.cos(-S.angleMarker.arrowHeadRearAngleOuter)),this.tmpArrowHeadOuter.crossVectors(this.tmpNormal1,this.tmpNormal2).normalize().multiplyScalar(S.boundaryCircle.radius),this.tmpArrowHeadTip.dot(this.tmpArrowHeadOuter)<0&&this.tmpArrowHeadOuter.multiplyScalar(-1),Math.sign(this.tmpArrowHeadTip.z)>0?(this.frontArrowHeadPath.vertices[0].x=this.tmpArrowHeadTip.x,this.frontArrowHeadPath.vertices[0].y=this.tmpArrowHeadTip.y,this.frontArrowHeadPath.vertices[1].x=this.tmpArrowHeadInner.x,this.frontArrowHeadPath.vertices[1].y=this.tmpArrowHeadInner.y,this.frontArrowHeadPath.vertices[2].x=this.tmpArrowHeadRear.x,this.frontArrowHeadPath.vertices[2].y=this.tmpArrowHeadRear.y,this.frontArrowHeadPath.vertices[3].x=this.tmpArrowHeadOuter.x,this.frontArrowHeadPath.vertices[3].y=this.tmpArrowHeadOuter.y,this.glowingFrontArrowHeadPath.vertices[0].x=this.tmpArrowHeadTip.x,this.glowingFrontArrowHeadPath.vertices[0].y=this.tmpArrowHeadTip.y,this.glowingFrontArrowHeadPath.vertices[1].x=this.tmpArrowHeadInner.x,this.glowingFrontArrowHeadPath.vertices[1].y=this.tmpArrowHeadInner.y,this.glowingFrontArrowHeadPath.vertices[2].x=this.tmpArrowHeadRear.x,this.glowingFrontArrowHeadPath.vertices[2].y=this.tmpArrowHeadRear.y,this.glowingFrontArrowHeadPath.vertices[3].x=this.tmpArrowHeadOuter.x,this.glowingFrontArrowHeadPath.vertices[3].y=this.tmpArrowHeadOuter.y):(this.backArrowHeadPath.vertices[0].x=this.tmpArrowHeadTip.x,this.backArrowHeadPath.vertices[0].y=this.tmpArrowHeadTip.y,this.backArrowHeadPath.vertices[1].x=this.tmpArrowHeadInner.x,this.backArrowHeadPath.vertices[1].y=this.tmpArrowHeadInner.y,this.backArrowHeadPath.vertices[2].x=this.tmpArrowHeadRear.x,this.backArrowHeadPath.vertices[2].y=this.tmpArrowHeadRear.y,this.backArrowHeadPath.vertices[3].x=this.tmpArrowHeadOuter.x,this.backArrowHeadPath.vertices[3].y=this.tmpArrowHeadOuter.y,this.glowingBackArrowHeadPath.vertices[0].x=this.tmpArrowHeadTip.x,this.glowingBackArrowHeadPath.vertices[0].y=this.tmpArrowHeadTip.y,this.glowingBackArrowHeadPath.vertices[1].x=this.tmpArrowHeadInner.x,this.glowingBackArrowHeadPath.vertices[1].y=this.tmpArrowHeadInner.y,this.glowingBackArrowHeadPath.vertices[2].x=this.tmpArrowHeadRear.x,this.glowingBackArrowHeadPath.vertices[2].y=this.tmpArrowHeadRear.y,this.glowingBackArrowHeadPath.vertices[3].x=this.tmpArrowHeadOuter.x,this.glowingBackArrowHeadPath.vertices[3].y=this.tmpArrowHeadOuter.y);const P=[];P.push(...this.frontCirclePathDoubleArcStart.vertices.splice(0)),P.push(...this.frontCirclePathDoubleArcTail.vertices.splice(0)),P.push(...this.backCirclePathDoubleArcStart.vertices.splice(0)),P.push(...this.backCirclePathDoubleArcTail.vertices.splice(0));const E=[];E.push(...this.glowingFrontCirclePathDoubleArcStart.vertices.splice(0)),E.push(...this.glowingFrontCirclePathDoubleArcTail.vertices.splice(0)),E.push(...this.glowingBackCirclePathDoubleArcStart.vertices.splice(0)),E.push(...this.glowingBackCirclePathDoubleArcTail.vertices.splice(0));const T=[],C=[];let M=0,x=0,V=0,N=this.frontCirclePathDoubleArcStart.vertices,D=this.backCirclePathDoubleArcStart.vertices,O=this.glowingFrontCirclePathDoubleArcStart.vertices,F=this.glowingBackCirclePathDoubleArcStart.vertices;for(let me=0;me<2*jf;me++){const Ne=me/(2*jf-1)*Math.abs(r);this.tmpVectorDA.set(Math.cos(Ne),Math.sin(Ne),0).multiplyScalar(S.boundaryCircle.radius),this.tmpVectorDA.applyMatrix4(Sb);const ze=Math.sign(this.tmpVectorDA.z);if(V!==ze&&(ze>0&&(T.length>0&&(N=this.frontCirclePathDoubleArcTail.vertices,O=this.glowingFrontCirclePathDoubleArcTail.vertices,M=0),T.push(me)),ze<0&&(C.length>0&&(D=this.backCirclePathDoubleArcTail.vertices,F=this.glowingBackCirclePathDoubleArcTail.vertices,x=0),C.push(me))),V=ze,this.tmpVectorDA.z>0){if(M===N.length){const ke=P.pop();ke&&N.push(ke);const pt=E.pop();pt&&O.push(pt)}N[M].x=this.tmpVectorDA.x,N[M].y=this.tmpVectorDA.y,O[M].x=this.tmpVectorDA.x,O[M].y=this.tmpVectorDA.y,M++}else{if(x===D.length){const ke=P.pop();ke&&D.push(ke);const pt=E.pop();pt&&F.push(pt)}D[x].x=this.tmpVectorDA.x,D[x].y=this.tmpVectorDA.y,F[x].x=this.tmpVectorDA.x,F[x].y=this.tmpVectorDA.y,x++}}Al.crossVectors(this._vertexVector,this._startVector).normalize(),Ha.copy(this._vertexVector),Fh.crossVectors(Al,Ha).normalize(),QN.makeBasis(Ha,Fh,Al);const X=this._vertexVector.angleTo(this._startVector),Z=[];Z.push(...this.frontStraightStart.vertices.splice(0)),Z.push(...this.backStraightStart.vertices.splice(0));const K=[];K.push(...this.glowingFrontStraightStart.vertices.splice(0)),K.push(...this.glowingBackStraightStart.vertices.splice(0));let z=0,H=0;for(let me=0;me<2*$f;me++){const Ne=me/(2*$f-1)*Math.abs(X);if(this.tmpVectorStraight.set(Math.cos(Ne),Math.sin(Ne),0).multiplyScalar(S.boundaryCircle.radius),this.tmpVectorStraight.applyMatrix4(QN),this.tmpVectorStraight.z>0){if(z===this.frontStraightStart.vertices.length){const ze=Z.pop();ze&&this.frontStraightStart.vertices.push(ze);const ke=K.pop();ke&&this.glowingFrontStraightStart.vertices.push(ke)}this.frontStraightStart.vertices[z].x=this.tmpVectorStraight.x,this.frontStraightStart.vertices[z].y=this.tmpVectorStraight.y,this.glowingFrontStraightStart.vertices[z].x=this.tmpVectorStraight.x,this.glowingFrontStraightStart.vertices[z].y=this.tmpVectorStraight.y,z++}else{if(H===this.backStraightStart.vertices.length){const ze=Z.pop();ze&&this.backStraightStart.vertices.push(ze);const ke=K.pop();ke&&this.glowingBackStraightStart.vertices.push(ke)}this.backStraightStart.vertices[H].x=this.tmpVectorStraight.x,this.backStraightStart.vertices[H].y=this.tmpVectorStraight.y,this.glowingBackStraightStart.vertices[H].x=this.tmpVectorStraight.x,this.glowingBackStraightStart.vertices[H].y=this.tmpVectorStraight.y,H++}}Al.crossVectors(this._endVector,this._vertexVector).normalize(),Ha.copy(this._endVector),Fh.crossVectors(Al,Ha).normalize(),eR.makeBasis(Ha,Fh,Al);const re=[];re.push(...this.frontStraightEnd.vertices.splice(0)),re.push(...this.backStraightEnd.vertices.splice(0));const ne=[];ne.push(...this.glowingFrontStraightEnd.vertices.splice(0)),ne.push(...this.glowingBackStraightEnd.vertices.splice(0)),z=0,H=0;for(let me=0;me<2*$f;me++){const Ne=me/(2*$f-1)*Math.abs(X);if(this.tmpVectorStraight.set(Math.cos(Ne),Math.sin(Ne),0).multiplyScalar(S.boundaryCircle.radius),this.tmpVectorStraight.applyMatrix4(eR),this.tmpVectorStraight.z>0){if(z===this.frontStraightEnd.vertices.length){const ze=re.pop();ze&&this.frontStraightEnd.vertices.push(ze);const ke=ne.pop();ke&&this.glowingFrontStraightEnd.vertices.push(ke)}this.frontStraightEnd.vertices[z].x=this.tmpVectorStraight.x,this.frontStraightEnd.vertices[z].y=this.tmpVectorStraight.y,this.glowingFrontStraightEnd.vertices[z].x=this.tmpVectorStraight.x,this.glowingFrontStraightEnd.vertices[z].y=this.tmpVectorStraight.y,z++}else{if(H===this.backStraightEnd.vertices.length){const ze=re.pop();ze&&this.backStraightEnd.vertices.push(ze);const ke=ne.pop();ke&&this.glowingBackStraightEnd.vertices.push(ke)}this.backStraightEnd.vertices[H].x=this.tmpVectorStraight.x,this.backStraightEnd.vertices[H].y=this.tmpVectorStraight.y,this.glowingBackStraightEnd.vertices[H].x=this.tmpVectorStraight.x,this.glowingBackStraightEnd.vertices[H].y=this.tmpVectorStraight.y,H++}}const B=[];B.push(...this.fillStorageAnchors.splice(0)),B.push(...this.frontFill1.vertices.splice(0)),B.push(...this.frontFill2.vertices.splice(0)),B.push(...this.backFill1.vertices.splice(0)),B.push(...this.backFill2.vertices.splice(0));const Q=[];this.frontStraightStart.vertices.forEach(me=>Q.push([me.x,me.y]));const fe=[];this.backStraightStart.vertices.forEach(me=>fe.push([me.x,me.y]));const ie=[];this.frontCirclePathStart.vertices.forEach(me=>ie.push([me.x,me.y]));const se=[];this.backCirclePathStart.vertices.forEach(me=>se.push([me.x,me.y]));const ee=[];this.frontCirclePathTail.vertices.forEach(me=>ee.push([me.x,me.y]));const de=[];this.backCirclePathTail.vertices.forEach(me=>de.push([me.x,me.y]));const Y=[];this.frontStraightEnd.vertices.forEach(me=>Y.push([me.x,me.y]));const te=[];this.backStraightEnd.vertices.forEach(me=>te.push([me.x,me.y]));let he=[],ae=[];const A=[],I=[],G=[];let ue=[],Se=[],Ee=[],Oe=[],ye=0,Pe=0,we=0,j=[],R=-1;if(r<=Math.PI)switch(j=[[1,0,1,0,0,0,1,0],[1,-1,-1,0,0,0,-1,1],[1,-1,-1,1,0,0,1,0],[1,0,1,-1,0,0,-1,1],[1,0,1,-1,1,0,1,0]],this._vertexVector.z<0&&(j=j.map(me=>me.map(Ne=>-1*Ne))),R=j.findIndex(me=>{if(me[0]*me[1]===0){if(me[0]===0&&me[1]===0){if(Q.length!==0||fe.length!==0)return!1}else if(me[0]===1&&fe.length!==0||me[0]===-1&&Q.length!==0)return!1}if(me[2]*me[3]===0){if(me[2]===0&&me[3]===0){if(ie.length!==0||se.length!==0)return!1}else if(me[2]===1&&se.length!==0||me[2]===-1&&ie.length!==0)return!1}if(me[4]*me[5]===0){if(me[4]===0&&me[5]===0){if(ee.length!==0||de.length!==0)return!1}else if(me[4]===1&&de.length!==0||me[4]===-1&&ee.length!==0)return!1}if(me[6]*me[7]===0){if(me[6]===0&&me[7]===0){if(Y.length!==0||te.length!==0)return!1}else if(me[6]===1&&te.length!==0||me[6]===-1&&Y.length!==0)return!1}return!0}),R===-1&&console.log("Angle Marker Error - Convex Pattern not found!"),R){case 0:{j[R][0]===1?(A.push(...Q),A.push(...ie),A.push(...Y),ye=1):(A.push(...fe),A.push(...se),A.push(...te),ye=-1);break}case 1:{j[R][0]===1?(A.push(...Y),A.push(...Q),ue=Q.slice(-1)[0],Se=Y[0],ye=1,I.push(...fe),I.push(...se),I.push(...te),Pe=-1):(A.push(...te),A.push(...fe),ue=fe.slice(-1)[0],Se=te[0],ye=-1,I.push(...Q),I.push(...ie),I.push(...Y),Pe=1),he=this.boundaryCircleCoordinates(ue,Se,Vl),A.push(...he),I.push(...he.reverse());break}case 2:{j[R][0]===1?(A.push(...ie),A.push(...Y),A.push(...Q),ue=Q.slice(-1)[0],Se=ie[0],ye=1,I.push(...fe),I.push(...se),Pe=-1):(A.push(...se),A.push(...te),A.push(...fe),ue=fe.slice(-1)[0],Se=se[0],ye=-1,I.push(...Q),I.push(...ie),Pe=1),he=this.boundaryCircleCoordinates(ue,Se,Vl),A.push(...he),I.push(...he.reverse());break}case 3:{j[R][0]===1?(A.push(...Y),A.push(...Q),A.push(...ie),ue=ie.slice(-1)[0],Se=Y[0],ye=1,I.push(...se),I.push(...te),Pe=-1):(A.push(...te),A.push(...fe),A.push(...se),ue=se.slice(-1)[0],Se=te[0],ye=-1,I.push(...ie),I.push(...Y),Pe=1),he=this.boundaryCircleCoordinates(ue,Se,Vl),A.push(...he),I.push(...he.reverse());break}case 4:{j[R][0]===1?(A.push(...ee),A.push(...Y),A.push(...Q),A.push(...ie),ue=ie.slice(-1)[0],Se=ee[0],ye=1,I.push(...se),Pe=-1):(A.push(...de),A.push(...te),A.push(...fe),A.push(...se),ue=se.slice(-1)[0],Se=de[0],ye=-1,I.push(...ie),Pe=1),he=this.boundaryCircleCoordinates(ue,Se,Vl),A.push(...he),I.push(...he.reverse());break}}else switch(j=[[1,0,1,0,0,0,1,0],[1,0,1,-1,0,0,-1,1],[1,-1,-1,1,0,0,1,0],[1,0,1,-1,1,0,1,0],[1,-1,-1,1,-1,0,-1,1]],this._vertexVector.z<0&&(j=j.map(me=>me.map(Ne=>-1*Ne))),R=j.findIndex(me=>{if(me[0]*me[1]===0){if(me[0]===0&&me[1]===0){if(Q.length!==0||fe.length!==0)return!1}else if(me[0]===1&&fe.length!==0||me[0]===-1&&Q.length!==0)return!1}if(me[2]*me[3]===0){if(me[2]===0&&me[3]===0){if(ie.length!==0||se.length!==0)return!1}else if(me[2]===1&&se.length!==0||me[2]===-1&&ie.length!==0)return!1}if(me[4]*me[5]===0){if(me[4]===0&&me[5]===0){if(ee.length!==0||de.length!==0)return!1}else if(me[4]===1&&de.length!==0||me[4]===-1&&ee.length!==0)return!1}if(me[6]*me[7]===0){if(me[6]===0&&me[7]===0){if(Y.length!==0||te.length!==0)return!1}else if(me[6]===1&&te.length!==0||me[6]===-1&&Y.length!==0)return!1}return!0}),R===-1&&console.log("Angle Marker Error - Non-Convex Pattern not found!"),R){case 0:{j[R][0]===1?(A.push(...Q),A.push(...ie),A.push(...Y),ye=1):(A.push(...fe),A.push(...se),A.push(...te),ye=-1);break}case 1:{j[R][0]===1?(A.push(...Y),A.push(...Q),A.push(...ie),ue=ie.slice(-1)[0],Se=Y[0],ye=1,I.push(...se),I.push(...te),Pe=-1):(A.push(...te),A.push(...fe),A.push(...se),ue=se.slice(-1)[0],Se=te[0],ye=-1,I.push(...ie),I.push(...Y),Pe=1),he=this.boundaryCircleCoordinates(ue,Se,Vl),A.push(...he),I.push(...he.reverse());break}case 2:{j[R][0]===1?(A.push(...ie),A.push(...Y),A.push(...Q),ue=Q.slice(-1)[0],Se=ie[0],ye=1,I.push(...fe),I.push(...se),Pe=-1):(A.push(...se),A.push(...te),A.push(...fe),ue=fe.slice(-1)[0],Se=se[0],ye=-1,I.push(...Q),I.push(...ie),Pe=1),he=this.boundaryCircleCoordinates(ue,Se,Vl),A.push(...he),I.push(...he.reverse());break}case 3:{j[R][0]===1?(A.push(...ee),A.push(...Y),A.push(...Q),A.push(...ie),ue=ie.slice(-1)[0],Se=ee[0],ye=1,I.push(...se),Pe=-1):(A.push(...de),A.push(...te),A.push(...fe),A.push(...se),ue=se.slice(-1)[0],Se=de[0],ye=-1,I.push(...ie),Pe=1),he=this.boundaryCircleCoordinates(ue,Se,Vl),A.push(...he),I.push(...he.reverse());break}case 4:{j[R][0]===1?(A.push(...fe),A.push(...se),ue=se.slice(-1)[0],Se=fe[0],ye=-1,I.push(...de),I.push(...te),Ee=te.slice(-1)[0],Oe=de[0],Pe=-1):(A.push(...Q),A.push(...ie),ue=ie.slice(-1)[0],Se=Q[0],ye=1,I.push(...ee),I.push(...Y),Ee=Y.slice(-1)[0],Oe=ee[0],Pe=1),he=this.boundaryCircleCoordinates(ue,Se,Vl/2),ae=this.boundaryCircleCoordinates(Ee,Oe,Vl/2),A.push(...he),I.push(...ae),j[R][0]===1?(G.push(...Q),G.push(...he.reverse()),G.push(...ie),G.push(...ae.reverse()),G.push(...Y),we=1):(G.push(...fe),G.push(...he.reverse()),G.push(...se),G.push(...ae.reverse()),G.push(...te),we=-1);break}}let J=0;A.length!==0&&(ye===1?A.forEach(me=>{if(J===this.frontFill1.vertices.length){const Ne=B.pop();Ne&&this.frontFill1.vertices.push(Ne)}this.frontFill1.vertices[J].x=me[0],this.frontFill1.vertices[J].y=me[1],J++}):A.forEach(me=>{if(J===this.backFill1.vertices.length){const Ne=B.pop();Ne&&this.backFill1.vertices.push(Ne)}this.backFill1.vertices[J].x=me[0],this.backFill1.vertices[J].y=me[1],J++}));let ve=0;I.length!==0&&(Pe===1?I.forEach(me=>{if(ve===this.frontFill2.vertices.length){const Ne=B.pop();Ne&&this.frontFill2.vertices.push(Ne)}this.frontFill2.vertices[ve].x=me[0],this.frontFill2.vertices[ve].y=me[1],ve++}):I.forEach(me=>{if(ve===this.backFill2.vertices.length){const Ne=B.pop();Ne&&this.backFill2.vertices.push(Ne)}this.backFill2.vertices[ve].x=me[0],this.backFill2.vertices[ve].y=me[1],ve++}));let xe=0;G.length!==0&&(we===1?G.forEach(me=>{if(xe===this.frontFill2.vertices.length){const Ne=B.pop();Ne&&this.frontFill2.vertices.push(Ne)}this.frontFill2.vertices[xe].x=me[0],this.frontFill2.vertices[xe].y=me[1],xe++}):G.forEach(me=>{if(xe===this.backFill2.vertices.length){const Ne=B.pop();Ne&&this.backFill2.vertices.push(Ne)}this.backFill2.vertices[xe].x=me[0],this.backFill2.vertices[xe].y=me[1],xe++})),this.fillStorageAnchors.push(...B.splice(0))}boundaryCircleCoordinates(i,n,r){if(i===void 0||n===void 0)return[];const s=new k(i[0],i[1],0).normalize(),o=new k(n[0],n[1],0).normalize(),a=s.angleTo(o),l=new k(-s.y,s.x,0);l.dot(o)<0&&l.multiplyScalar(-1);const c=[];for(let u=0;u<r;u++)this.tmpVector.set(0,0,0),this.tmpVector.addScaledVector(s,Math.cos((u+1)*(a/(r+1)))),this.tmpVector.addScaledVector(l,Math.sin((u+1)*(a/(r+1)))),this.tmpVector.normalize().multiplyScalar(S.boundaryCircle.radius),c.push([this.tmpVector.x,this.tmpVector.y]);return c}set vertexVector(i){this._vertexVector.copy(i)}get vertexVector(){return this._vertexVector}set startVector(i){this._startVector.copy(i)}get startVector(){return this._startVector}set endVector(i){this._endVector.copy(i)}get endVector(){return this._endVector}get angleMarkerRadius(){return this._angleMarkerRadius}setAngleMarkerFromThreeVectors(i,n,r,s){return this._vertexVector.copy(n).normalize(),this.tmpVector.crossVectors(this._vertexVector,i).normalize(),this.tmpVector.crossVectors(this.tmpVector,this._vertexVector).normalize(),this._startVector.set(0,0,0),this._startVector.addScaledVector(this._vertexVector,Math.cos(s)),this._startVector.addScaledVector(this.tmpVector,Math.sin(s)).normalize(),this.tmpVector.crossVectors(this._vertexVector,r).normalize(),this.tmpVector.crossVectors(this.tmpVector,this._vertexVector).normalize(),this._endVector.set(0,0,0),this._endVector.addScaledVector(this._vertexVector,Math.cos(s)),this._endVector.addScaledVector(this.tmpVector,Math.sin(s)).normalize(),[this._startVector,this._vertexVector,this._endVector]}frontGlowingDisplay(){this.frontCirclePathStart.visible=!0,this.frontCirclePathTail.visible=!0,this.frontStraightStart.visible=!0,this.frontStraightEnd.visible=!0,this.frontFill1.visible=this.frontFill1.vertices.length>0,this.frontFill2.visible=this.frontFill2.vertices.length>0,this.glowingFrontCirclePathStart.visible=!0,this.glowingFrontCirclePathTail.visible=!0,this.glowingFrontStraightStart.visible=!0,this.glowingFrontStraightEnd.visible=!0;const i=this.styleOptions.get(q.Front);i!=null&&i.angleMarkerDoubleArc&&i.angleMarkerDoubleArc===!0?(this.frontCirclePathDoubleArcStart.visible=!0,this.frontCirclePathDoubleArcTail.visible=!0,this.glowingFrontCirclePathDoubleArcStart.visible=!0,this.glowingFrontCirclePathDoubleArcTail.visible=!0):(this.frontCirclePathDoubleArcStart.visible=!1,this.frontCirclePathDoubleArcTail.visible=!1,this.glowingFrontCirclePathDoubleArcStart.visible=!1,this.glowingFrontCirclePathDoubleArcTail.visible=!1),i!=null&&i.angleMarkerArrowHeads&&i.angleMarkerArrowHeads===!0&&this.angleIsBigEnoughToDrawArrowHeads===!0?(this.frontArrowHeadPath.visible=!0,this.glowingFrontArrowHeadPath.visible=!0):(this.frontArrowHeadPath.visible=!1,this.glowingFrontArrowHeadPath.visible=!1)}backGlowingDisplay(){this.backCirclePathStart.visible=!0,this.backCirclePathTail.visible=!0,this.backStraightStart.visible=!0,this.backStraightEnd.visible=!0,this.backFill1.visible=this.backFill1.vertices.length>0,this.backFill2.visible=this.backFill2.vertices.length>0,this.glowingBackCirclePathStart.visible=!0,this.glowingBackCirclePathTail.visible=!0,this.glowingBackStraightStart.visible=!0,this.glowingBackStraightEnd.visible=!0;const i=this.styleOptions.get(q.Front);i!=null&&i.angleMarkerDoubleArc&&i.angleMarkerDoubleArc===!0?(this.backCirclePathDoubleArcStart.visible=!0,this.backCirclePathDoubleArcTail.visible=!0,this.glowingBackCirclePathDoubleArcStart.visible=!0,this.glowingBackCirclePathDoubleArcTail.visible=!0):(this.backCirclePathDoubleArcStart.visible=!1,this.backCirclePathDoubleArcTail.visible=!1,this.glowingBackCirclePathDoubleArcStart.visible=!1,this.glowingBackCirclePathDoubleArcTail.visible=!1),i!=null&&i.angleMarkerArrowHeads&&i.angleMarkerArrowHeads===!0&&this.angleIsBigEnoughToDrawArrowHeads===!0?(this.backArrowHeadPath.visible=!0,this.glowingBackArrowHeadPath.visible=!0):(this.backArrowHeadPath.visible=!1,this.glowingBackArrowHeadPath.visible=!1)}glowingDisplay(){this.frontGlowingDisplay(),this.backGlowingDisplay()}frontNormalDisplay(){this.frontCirclePathStart.visible=!0,this.frontCirclePathTail.visible=!0,this.frontStraightStart.visible=!0,this.frontStraightEnd.visible=!0,this.frontFill1.visible=this.frontFill1.vertices.length>0,this.frontFill2.visible=this.frontFill2.vertices.length>0,this.glowingFrontCirclePathStart.visible=!1,this.glowingFrontCirclePathTail.visible=!1,this.glowingFrontStraightStart.visible=!1,this.glowingFrontStraightEnd.visible=!1;const i=this.styleOptions.get(q.Front);i!=null&&i.angleMarkerDoubleArc&&i.angleMarkerDoubleArc===!0?(this.frontCirclePathDoubleArcStart.visible=!0,this.frontCirclePathDoubleArcTail.visible=!0,this.glowingFrontCirclePathDoubleArcStart.visible=!1,this.glowingFrontCirclePathDoubleArcTail.visible=!1):(this.frontCirclePathDoubleArcStart.visible=!1,this.frontCirclePathDoubleArcTail.visible=!1,this.glowingFrontCirclePathDoubleArcStart.visible=!1,this.glowingFrontCirclePathDoubleArcTail.visible=!1),i!=null&&i.angleMarkerArrowHeads&&i.angleMarkerArrowHeads===!0&&this.angleIsBigEnoughToDrawArrowHeads?(this.frontArrowHeadPath.visible=!0,this.glowingFrontArrowHeadPath.visible=!1):(this.frontArrowHeadPath.visible=!1,this.glowingFrontArrowHeadPath.visible=!1)}backNormalDisplay(){this.backCirclePathStart.visible=!0,this.backCirclePathTail.visible=!0,this.backStraightStart.visible=!0,this.backStraightEnd.visible=!0,this.backFill1.visible=this.backFill1.vertices.length>0,this.backFill2.visible=this.backFill2.vertices.length>0,this.glowingBackCirclePathStart.visible=!1,this.glowingBackCirclePathTail.visible=!1,this.glowingBackStraightStart.visible=!1,this.glowingBackStraightEnd.visible=!1;const i=this.styleOptions.get(q.Front);i!=null&&i.angleMarkerDoubleArc&&i.angleMarkerDoubleArc===!0?(this.backCirclePathDoubleArcStart.visible=!0,this.backCirclePathDoubleArcTail.visible=!0,this.glowingBackCirclePathDoubleArcStart.visible=!1,this.glowingBackCirclePathDoubleArcTail.visible=!1):(this.backCirclePathDoubleArcStart.visible=!1,this.backCirclePathDoubleArcTail.visible=!1,this.glowingBackCirclePathDoubleArcStart.visible=!1,this.glowingBackCirclePathDoubleArcTail.visible=!1),i!=null&&i.angleMarkerArrowHeads&&i.angleMarkerArrowHeads===!0&&this.angleIsBigEnoughToDrawArrowHeads?(this.backArrowHeadPath.visible=!0,this.glowingBackArrowHeadPath.visible=!1):(this.backArrowHeadPath.visible=!1,this.glowingBackArrowHeadPath.visible=!1)}normalDisplay(){this.frontNormalDisplay(),this.backNormalDisplay()}setVisible(i){i?this.normalDisplay():(this.frontCirclePathStart.visible=!1,this.frontCirclePathTail.visible=!1,this.backCirclePathStart.visible=!1,this.backCirclePathTail.visible=!1,this.frontStraightStart.visible=!1,this.frontStraightEnd.visible=!1,this.backStraightStart.visible=!1,this.backStraightEnd.visible=!1,this.frontFill1.visible=!1,this.frontFill2.visible=!1,this.backFill1.visible=!1,this.backFill2.visible=!1,this.frontCirclePathDoubleArcStart.visible=!1,this.frontCirclePathDoubleArcTail.visible=!1,this.backCirclePathDoubleArcStart.visible=!1,this.backCirclePathDoubleArcTail.visible=!1,this.glowingFrontCirclePathStart.visible=!1,this.glowingFrontCirclePathTail.visible=!1,this.glowingBackCirclePathStart.visible=!1,this.glowingBackCirclePathTail.visible=!1,this.glowingFrontStraightStart.visible=!1,this.glowingFrontStraightEnd.visible=!1,this.glowingBackStraightStart.visible=!1,this.glowingBackStraightEnd.visible=!1,this.glowingFrontCirclePathDoubleArcStart.visible=!1,this.glowingFrontCirclePathDoubleArcTail.visible=!1,this.glowingBackCirclePathDoubleArcStart.visible=!1,this.glowingBackCirclePathDoubleArcTail.visible=!1,this.frontArrowHeadPath.visible=!1,this.backArrowHeadPath.visible=!1,this.glowingFrontArrowHeadPath.visible=!1,this.glowingBackArrowHeadPath.visible=!1)}setSelectedColoring(i){i?(this.glowingStrokeColorFront=S.style.selectedColor.front,this.glowingStrokeColorBack=S.style.selectedColor.back):(this.glowingStrokeColorFront=S.angleMarker.glowing.strokeColor.front,this.glowingStrokeColorBack=S.angleMarker.glowing.strokeColor.back),this.stylize(Vt.ApplyCurrentVariables)}clone(){const i=new Et;for(i._vertexVector.copy(this._vertexVector),i._startVector.copy(this._startVector),i._endVector.copy(this._endVector),i.frontCirclePathStart.rotation=this.frontCirclePathStart.rotation,i.frontCirclePathStart.translation.copy(this.frontCirclePathStart.translation),i.backCirclePathStart.rotation=this.backCirclePathStart.rotation,i.backCirclePathStart.translation.copy(this.backCirclePathStart.translation),i.glowingFrontCirclePathStart.rotation=this.glowingFrontCirclePathStart.rotation,i.glowingFrontCirclePathStart.translation.copy(this.glowingFrontCirclePathStart.translation),i.glowingBackCirclePathStart.rotation=this.glowingBackCirclePathStart.rotation,i.glowingBackCirclePathStart.translation.copy(this.glowingBackCirclePathStart.translation),i.frontStraightStart.rotation=this.frontStraightStart.rotation,i.frontStraightStart.translation.copy(this.frontStraightStart.translation),i.backStraightStart.rotation=this.backStraightStart.rotation,i.backStraightStart.translation.copy(this.backStraightStart.translation),i.glowingFrontStraightStart.rotation=this.glowingFrontStraightStart.rotation,i.glowingFrontStraightStart.translation.copy(this.glowingFrontStraightStart.translation),i.glowingBackStraightStart.rotation=this.glowingBackStraightStart.rotation,i.glowingBackStraightStart.translation.copy(this.glowingBackStraightStart.translation),i.frontCirclePathDoubleArcStart.rotation=this.frontCirclePathDoubleArcStart.rotation,i.frontCirclePathDoubleArcStart.translation.copy(this.frontCirclePathDoubleArcStart.translation),i.backCirclePathDoubleArcStart.rotation=this.backCirclePathDoubleArcStart.rotation,i.backCirclePathDoubleArcStart.translation.copy(this.backCirclePathDoubleArcStart.translation),i.glowingFrontCirclePathDoubleArcStart.rotation=this.glowingFrontCirclePathDoubleArcStart.rotation,i.glowingFrontCirclePathDoubleArcStart.translation.copy(this.glowingFrontCirclePathDoubleArcStart.translation),i.glowingBackCirclePathDoubleArcStart.rotation=this.glowingBackCirclePathDoubleArcStart.rotation,i.glowingBackCirclePathDoubleArcStart.translation.copy(this.glowingBackCirclePathDoubleArcStart.translation),i.frontCirclePathTail.rotation=this.frontCirclePathTail.rotation,i.frontCirclePathTail.translation.copy(this.frontCirclePathTail.translation),i.backCirclePathTail.rotation=this.backCirclePathTail.rotation,i.backCirclePathTail.translation.copy(this.backCirclePathTail.translation),i.glowingFrontCirclePathTail.rotation=this.glowingFrontCirclePathTail.rotation,i.glowingFrontCirclePathTail.translation.copy(this.glowingFrontCirclePathTail.translation),i.glowingBackCirclePathTail.rotation=this.glowingBackCirclePathTail.rotation,i.glowingBackCirclePathTail.translation.copy(this.glowingBackCirclePathTail.translation),i.frontStraightEnd.rotation=this.frontStraightEnd.rotation,i.frontStraightEnd.translation.copy(this.frontStraightEnd.translation),i.backStraightEnd.rotation=this.backStraightEnd.rotation,i.backStraightEnd.translation.copy(this.backStraightEnd.translation),i.glowingFrontStraightEnd.rotation=this.glowingFrontStraightEnd.rotation,i.glowingFrontStraightEnd.translation.copy(this.glowingFrontStraightEnd.translation),i.glowingBackStraightEnd.rotation=this.glowingBackStraightEnd.rotation,i.glowingBackStraightEnd.translation.copy(this.glowingBackStraightEnd.translation),i.frontCirclePathDoubleArcTail.rotation=this.frontCirclePathDoubleArcTail.rotation,i.frontCirclePathDoubleArcTail.translation.copy(this.frontCirclePathDoubleArcTail.translation),i.backCirclePathDoubleArcTail.rotation=this.backCirclePathDoubleArcTail.rotation,i.backCirclePathDoubleArcTail.translation.copy(this.backCirclePathDoubleArcTail.translation),i.glowingFrontCirclePathDoubleArcTail.rotation=this.glowingFrontCirclePathDoubleArcTail.rotation,i.glowingFrontCirclePathDoubleArcTail.translation.copy(this.glowingFrontCirclePathDoubleArcTail.translation),i.glowingBackCirclePathDoubleArcTail.rotation=this.glowingBackCirclePathDoubleArcTail.rotation,i.glowingBackCirclePathDoubleArcTail.translation.copy(this.glowingBackCirclePathDoubleArcTail.translation),i.frontArrowHeadPath.rotation=this.frontArrowHeadPath.rotation,i.frontArrowHeadPath.translation.copy(this.frontArrowHeadPath.translation),i.backArrowHeadPath.rotation=this.backArrowHeadPath.rotation,i.backArrowHeadPath.translation.copy(this.backArrowHeadPath.translation),i.glowingFrontArrowHeadPath.rotation=this.glowingFrontArrowHeadPath.rotation,i.glowingFrontArrowHeadPath.translation.copy(this.glowingFrontArrowHeadPath.translation),i.glowingBackArrowHeadPath.rotation=this.glowingBackArrowHeadPath.rotation,i.glowingBackArrowHeadPath.translation.copy(this.glowingBackArrowHeadPath.translation);i.frontCirclePathStart.vertices.length>this.frontCirclePathStart.vertices.length;){const r=i.frontCirclePathStart.vertices.pop();r&&i.backCirclePathStart.vertices.push(r);const s=i.glowingFrontCirclePathStart.vertices.pop();s&&i.glowingBackCirclePathStart.vertices.push(s)}for(;i.frontStraightStart.vertices.length>this.frontStraightStart.vertices.length;){const r=i.frontStraightStart.vertices.pop();r&&i.backStraightStart.vertices.push(r);const s=i.glowingFrontStraightStart.vertices.pop();s&&i.glowingBackStraightStart.vertices.push(s)}for(;i.frontCirclePathDoubleArcStart.vertices.length>this.frontCirclePathDoubleArcStart.vertices.length;){const r=i.frontCirclePathDoubleArcStart.vertices.pop();r&&i.backCirclePathDoubleArcStart.vertices.push(r);const s=i.glowingFrontCirclePathDoubleArcStart.vertices.pop();s&&i.glowingBackCirclePathDoubleArcStart.vertices.push(s)}for(;i.frontCirclePathTail.vertices.length>this.frontCirclePathTail.vertices.length;){const r=i.frontCirclePathTail.vertices.pop();r&&i.backCirclePathTail.vertices.push(r);const s=i.glowingFrontCirclePathTail.vertices.pop();s&&i.glowingBackCirclePathTail.vertices.push(s)}for(;i.frontStraightEnd.vertices.length>this.frontStraightEnd.vertices.length;){const r=i.frontStraightEnd.vertices.pop();r&&i.backStraightEnd.vertices.push(r);const s=i.glowingFrontStraightEnd.vertices.pop();s&&i.glowingBackStraightEnd.vertices.push(s)}for(;i.frontCirclePathDoubleArcTail.vertices.length>this.frontCirclePathDoubleArcTail.vertices.length;){const r=i.frontCirclePathDoubleArcTail.vertices.pop();r&&i.backCirclePathDoubleArcTail.vertices.push(r);const s=i.glowingFrontCirclePathDoubleArcTail.vertices.pop();s&&i.glowingBackCirclePathDoubleArcTail.vertices.push(s)}const n=[];for(n.push(...i.frontFill1.vertices.splice(0)),n.push(...i.frontFill2.vertices.splice(0)),n.push(...i.backFill1.vertices.splice(0)),n.push(...i.backFill2.vertices.splice(0)),n.push(...i.fillStorageAnchors.splice(0));i.frontFill1.vertices.length<this.frontFill1.vertices.length;){const r=n.pop();r&&i.frontFill1.vertices.push(r)}for(;i.frontFill2.vertices.length<this.frontFill2.vertices.length;){const r=n.pop();r&&i.frontFill2.vertices.push(r)}for(;i.backFill1.vertices.length<this.backFill1.vertices.length;){const r=n.pop();r&&i.backFill1.vertices.push(r)}for(;i.backFill2.vertices.length<this.backFill2.vertices.length;){const r=n.pop();r&&i.backFill2.vertices.push(r)}for(i.fillStorageAnchors.push(...n.splice(0));i.frontCirclePathStart.vertices.length<this.frontCirclePathStart.vertices.length;){const r=i.backCirclePathStart.vertices.pop();r&&i.frontCirclePathStart.vertices.push(r);const s=i.glowingBackCirclePathStart.vertices.pop();s&&i.glowingFrontCirclePathStart.vertices.push(s)}for(;i.frontStraightStart.vertices.length<this.frontStraightStart.vertices.length;){const r=i.backStraightStart.vertices.pop();r&&i.frontStraightStart.vertices.push(r);const s=i.glowingBackStraightStart.vertices.pop();s&&i.glowingFrontStraightStart.vertices.push(s)}for(;i.frontCirclePathDoubleArcStart.vertices.length<this.frontCirclePathDoubleArcStart.vertices.length;){const r=i.backCirclePathDoubleArcStart.vertices.pop();r&&i.frontCirclePathDoubleArcStart.vertices.push(r);const s=i.glowingBackCirclePathDoubleArcStart.vertices.pop();s&&i.glowingFrontCirclePathDoubleArcStart.vertices.push(s)}for(;i.frontCirclePathTail.vertices.length<this.frontCirclePathTail.vertices.length;){const r=i.backCirclePathTail.vertices.pop();r&&i.frontCirclePathTail.vertices.push(r);const s=i.glowingBackCirclePathTail.vertices.pop();s&&i.glowingFrontCirclePathTail.vertices.push(s)}for(;i.frontStraightEnd.vertices.length<this.frontStraightEnd.vertices.length;){const r=i.backStraightEnd.vertices.pop();r&&i.frontStraightEnd.vertices.push(r);const s=i.glowingBackStraightEnd.vertices.pop();s&&i.glowingFrontStraightEnd.vertices.push(s)}for(;i.frontCirclePathDoubleArcTail.vertices.length<this.frontCirclePathDoubleArcTail.vertices.length;){const r=i.backCirclePathDoubleArcTail.vertices.pop();r&&i.frontCirclePathDoubleArcTail.vertices.push(r);const s=i.glowingBackCirclePathDoubleArcTail.vertices.pop();s&&i.glowingFrontCirclePathDoubleArcTail.vertices.push(s)}return i.frontCirclePathStart.vertices.forEach((r,s)=>{r.copy(this.frontCirclePathStart.vertices[s])}),i.backCirclePathStart.vertices.forEach((r,s)=>{r.copy(this.backCirclePathStart.vertices[s])}),i.glowingFrontCirclePathStart.vertices.forEach((r,s)=>{r.copy(this.glowingFrontCirclePathStart.vertices[s])}),i.glowingBackCirclePathStart.vertices.forEach((r,s)=>{r.copy(this.glowingBackCirclePathStart.vertices[s])}),i.frontStraightStart.vertices.forEach((r,s)=>{r.copy(this.frontStraightStart.vertices[s])}),i.backStraightStart.vertices.forEach((r,s)=>{r.copy(this.backCirclePathStart.vertices[s])}),i.glowingFrontStraightStart.vertices.forEach((r,s)=>{r.copy(this.glowingFrontStraightStart.vertices[s])}),i.glowingBackStraightStart.vertices.forEach((r,s)=>{r.copy(this.glowingBackStraightStart.vertices[s])}),i.frontCirclePathDoubleArcStart.vertices.forEach((r,s)=>{r.copy(this.frontCirclePathDoubleArcStart.vertices[s])}),i.backCirclePathDoubleArcStart.vertices.forEach((r,s)=>{r.copy(this.backCirclePathDoubleArcStart.vertices[s])}),i.glowingFrontCirclePathDoubleArcStart.vertices.forEach((r,s)=>{r.copy(this.glowingFrontCirclePathDoubleArcStart.vertices[s])}),i.glowingBackCirclePathDoubleArcStart.vertices.forEach((r,s)=>{r.copy(this.glowingBackCirclePathDoubleArcStart.vertices[s])}),i.frontCirclePathTail.vertices.forEach((r,s)=>{r.copy(this.frontCirclePathTail.vertices[s])}),i.backCirclePathTail.vertices.forEach((r,s)=>{r.copy(this.backCirclePathTail.vertices[s])}),i.glowingFrontCirclePathTail.vertices.forEach((r,s)=>{r.copy(this.glowingFrontCirclePathTail.vertices[s])}),i.glowingBackCirclePathTail.vertices.forEach((r,s)=>{r.copy(this.glowingBackCirclePathTail.vertices[s])}),i.frontStraightEnd.vertices.forEach((r,s)=>{r.copy(this.frontStraightEnd.vertices[s])}),i.backStraightEnd.vertices.forEach((r,s)=>{r.copy(this.backStraightEnd.vertices[s])}),i.glowingFrontStraightEnd.vertices.forEach((r,s)=>{r.copy(this.glowingFrontStraightEnd.vertices[s])}),i.glowingBackStraightEnd.vertices.forEach((r,s)=>{r.copy(this.glowingBackStraightEnd.vertices[s])}),i.frontCirclePathDoubleArcTail.vertices.forEach((r,s)=>{r.copy(this.frontCirclePathDoubleArcTail.vertices[s])}),i.backCirclePathDoubleArcTail.vertices.forEach((r,s)=>{r.copy(this.backCirclePathDoubleArcTail.vertices[s])}),i.glowingFrontCirclePathDoubleArcTail.vertices.forEach((r,s)=>{r.copy(this.glowingFrontCirclePathDoubleArcTail.vertices[s])}),i.glowingBackCirclePathDoubleArcTail.vertices.forEach((r,s)=>{r.copy(this.glowingBackCirclePathDoubleArcTail.vertices[s])}),i.frontFill1.vertices.forEach((r,s)=>{r.copy(this.frontFill1.vertices[s])}),i.frontFill2.vertices.forEach((r,s)=>{r.copy(this.frontFill2.vertices[s])}),i.backFill1.vertices.forEach((r,s)=>{r.copy(this.backFill1.vertices[s])}),i.backFill2.vertices.forEach((r,s)=>{r.copy(this.backFill2.vertices[s])}),i.frontArrowHeadPath.vertices.forEach((r,s)=>{r.copy(this.frontArrowHeadPath.vertices[s])}),i.backArrowHeadPath.vertices.forEach((r,s)=>{r.copy(this.backArrowHeadPath.vertices[s])}),i.glowingFrontArrowHeadPath.vertices.forEach((r,s)=>{r.copy(this.glowingFrontArrowHeadPath.vertices[s])}),i.glowingBackArrowHeadPath.vertices.forEach((r,s)=>{r.copy(this.glowingBackArrowHeadPath.vertices[s])}),i}addToLayers(i){this.frontFill1.addTo(i[st.foregroundAngleMarkers]),this.frontFill2.addTo(i[st.foregroundAngleMarkers]),this.frontStraightStart.addTo(i[st.foregroundAngleMarkers]),this.glowingFrontStraightStart.addTo(i[st.foregroundAngleMarkersGlowing]),this.frontStraightEnd.addTo(i[st.foregroundAngleMarkers]),this.glowingFrontStraightEnd.addTo(i[st.foregroundAngleMarkersGlowing]),this.frontCirclePathTail.addTo(i[st.foregroundAngleMarkers]),this.glowingFrontCirclePathTail.addTo(i[st.foregroundAngleMarkersGlowing]),this.frontCirclePathStart.addTo(i[st.foregroundAngleMarkers]),this.glowingFrontCirclePathStart.addTo(i[st.foregroundAngleMarkersGlowing]),this.frontArrowHeadPath.addTo(i[st.foregroundAngleMarkers]),this.glowingFrontArrowHeadPath.addTo(i[st.foregroundAngleMarkersGlowing]),this.frontCirclePathDoubleArcStart.addTo(i[st.foregroundAngleMarkers]),this.glowingFrontCirclePathDoubleArcStart.addTo(i[st.foregroundAngleMarkersGlowing]),this.frontCirclePathDoubleArcTail.addTo(i[st.foregroundAngleMarkers]),this.glowingFrontCirclePathDoubleArcTail.addTo(i[st.foregroundAngleMarkersGlowing]),this.backFill1.addTo(i[st.backgroundAngleMarkers]),this.backFill2.addTo(i[st.backgroundAngleMarkers]),this.backStraightStart.addTo(i[st.backgroundAngleMarkers]),this.glowingBackStraightStart.addTo(i[st.backgroundAngleMarkersGlowing]),this.backStraightEnd.addTo(i[st.backgroundAngleMarkers]),this.glowingBackStraightEnd.addTo(i[st.backgroundAngleMarkersGlowing]),this.backCirclePathStart.addTo(i[st.backgroundAngleMarkers]),this.glowingBackCirclePathStart.addTo(i[st.backgroundAngleMarkersGlowing]),this.backCirclePathTail.addTo(i[st.backgroundAngleMarkers]),this.glowingBackCirclePathTail.addTo(i[st.backgroundAngleMarkersGlowing]),this.backArrowHeadPath.addTo(i[st.backgroundAngleMarkers]),this.glowingBackArrowHeadPath.addTo(i[st.backgroundAngleMarkersGlowing]),this.backCirclePathDoubleArcStart.addTo(i[st.backgroundAngleMarkers]),this.glowingBackCirclePathDoubleArcStart.addTo(i[st.backgroundAngleMarkersGlowing]),this.backCirclePathDoubleArcTail.addTo(i[st.backgroundAngleMarkers]),this.glowingBackCirclePathDoubleArcTail.addTo(i[st.backgroundAngleMarkersGlowing])}removeFromLayers(){this.frontArrowHeadPath.remove(),this.frontCirclePathStart.remove(),this.frontCirclePathDoubleArcStart.remove(),this.glowingFrontArrowHeadPath.remove(),this.glowingFrontCirclePathStart.remove(),this.glowingFrontCirclePathDoubleArcStart.remove(),this.backArrowHeadPath.remove(),this.backCirclePathStart.remove(),this.backCirclePathDoubleArcStart.remove(),this.glowingBackArrowHeadPath.remove(),this.glowingBackCirclePathStart.remove(),this.glowingBackCirclePathDoubleArcStart.remove(),this.frontCirclePathTail.remove(),this.frontCirclePathDoubleArcTail.remove(),this.glowingFrontCirclePathTail.remove(),this.glowingFrontCirclePathDoubleArcTail.remove(),this.backCirclePathTail.remove(),this.backCirclePathDoubleArcTail.remove(),this.glowingBackCirclePathTail.remove(),this.glowingBackCirclePathDoubleArcTail.remove(),this.frontStraightStart.remove(),this.glowingFrontStraightStart.remove(),this.backStraightStart.remove(),this.glowingBackStraightStart.remove(),this.frontStraightEnd.remove(),this.glowingFrontStraightEnd.remove(),this.backStraightEnd.remove(),this.glowingBackStraightEnd.remove(),this.frontFill1.remove(),this.frontFill2.remove(),this.backFill1.remove(),this.backFill2.remove()}updateStyle(i,n){super.updateStyle(i,n),this.setVisible(!0)}defaultStyleState(i){switch(i){case q.Front:return Qk;case q.Back:return{...eC,strokeWidthPercent:pe.contrastStrokeWidthPercent(100),strokeColor:pe.contrastStrokeColor(S.angleMarker.drawn.strokeColor.front),fillColor:pe.contrastStrokeColor(S.angleMarker.drawn.fillColor.front)};default:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.strokeWidthPercent)??100,s=(n==null?void 0:n.strokeWidthPercent)??100;this.frontCirclePathStart.linewidth=Et.currentAngleMarkerCircularStrokeWidthFront*r/100,this.frontArrowHeadPath.linewidth=Et.currentAngleMarkerCircularStrokeWidthFront*r/100,this.frontCirclePathTail.linewidth=Et.currentAngleMarkerCircularStrokeWidthFront*r/100,this.frontCirclePathDoubleArcStart.linewidth=Et.currentAngleMarkerCircularStrokeWidthFront*r/100,this.frontCirclePathDoubleArcTail.linewidth=Et.currentAngleMarkerCircularStrokeWidthFront*r/100,this.backCirclePathStart.linewidth=Et.currentAngleMarkerCircularStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.backArrowHeadPath.linewidth=Et.currentAngleMarkerCircularStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.backCirclePathTail.linewidth=Et.currentAngleMarkerCircularStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.backCirclePathDoubleArcStart.linewidth=Et.currentAngleMarkerCircularStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.backCirclePathDoubleArcTail.linewidth=Et.currentAngleMarkerCircularStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingFrontCirclePathStart.linewidth=Et.currentGlowingAngleMarkerCircularStrokeWidthFront*r/100,this.glowingFrontArrowHeadPath.linewidth=Et.currentGlowingAngleMarkerCircularStrokeWidthFront*r/100,this.glowingFrontCirclePathTail.linewidth=Et.currentGlowingAngleMarkerCircularStrokeWidthFront*r/100,this.glowingFrontCirclePathDoubleArcStart.linewidth=Et.currentGlowingAngleMarkerCircularStrokeWidthFront*r/100,this.glowingFrontCirclePathDoubleArcTail.linewidth=Et.currentGlowingAngleMarkerCircularStrokeWidthFront*r/100,this.glowingBackCirclePathStart.linewidth=Et.currentGlowingAngleMarkerCircularStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingBackArrowHeadPath.linewidth=Et.currentGlowingAngleMarkerCircularStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingBackCirclePathTail.linewidth=Et.currentGlowingAngleMarkerCircularStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingBackCirclePathDoubleArcStart.linewidth=Et.currentGlowingAngleMarkerCircularStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingBackCirclePathDoubleArcTail.linewidth=Et.currentGlowingAngleMarkerCircularStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.frontStraightStart.linewidth=Et.currentAngleMarkerStraightStrokeWidthFront*r/100,this.frontStraightEnd.linewidth=Et.currentAngleMarkerStraightStrokeWidthFront*r/100,this.backStraightStart.linewidth=Et.currentAngleMarkerStraightStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.backStraightEnd.linewidth=Et.currentAngleMarkerStraightStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingFrontStraightStart.linewidth=Et.currentGlowingAngleMarkerStraightStrokeWidthFront*r/100,this.glowingFrontStraightEnd.linewidth=Et.currentGlowingAngleMarkerStraightStrokeWidthFront*r/100,this.glowingBackStraightStart.linewidth=Et.currentGlowingAngleMarkerStraightStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingBackStraightEnd.linewidth=Et.currentGlowingAngleMarkerStraightStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this._angleMarkerRadius=Et.currentAngleMarkerRadius*((i==null?void 0:i.angleMarkerRadiusPercent)??100)/100,this._angleMarkerRadiusDoubleArc=Et.currentAngleMarkerRadiusDoubleArc*((i==null?void 0:i.angleMarkerRadiusPercent)??100)/100,this.setAngleMarkerFromThreeVectors(this._startVector,this._vertexVector,this._endVector,this._angleMarkerRadius),this.updateDisplay()}stylize(i){switch(i){case Vt.ApplyTemporaryVariables:{pe.hslaIsNoFillOrNoStroke(S.angleMarker.temp.fillColor.front)?(this.frontFill1.noFill(),this.frontFill2.noFill()):(this.frontFill1.fill=S.angleMarker.temp.fillColor.front,this.frontFill2.fill=S.angleMarker.temp.fillColor.front),pe.hslaIsNoFillOrNoStroke(S.angleMarker.temp.strokeColor.front)?(this.frontCirclePathStart.noStroke(),this.frontCirclePathTail.noStroke(),this.frontStraightStart.noStroke(),this.frontStraightEnd.noStroke(),this.frontArrowHeadPath.noStroke(),this.frontArrowHeadPath.noFill()):(this.frontCirclePathStart.stroke=S.angleMarker.temp.strokeColor.front,this.frontCirclePathTail.stroke=S.angleMarker.temp.strokeColor.front,this.frontStraightStart.stroke=S.angleMarker.temp.strokeColor.front,this.frontStraightEnd.stroke=S.angleMarker.temp.strokeColor.front,this.frontArrowHeadPath.stroke=S.angleMarker.temp.strokeColor.front,this.frontArrowHeadPath.fill=S.angleMarker.temp.strokeColor.front),this.frontCirclePathStart.linewidth=Et.currentAngleMarkerCircularStrokeWidthFront,this.frontCirclePathTail.linewidth=Et.currentAngleMarkerCircularStrokeWidthFront,this.frontStraightStart.linewidth=Et.currentAngleMarkerStraightStrokeWidthFront,this.frontStraightEnd.linewidth=Et.currentAngleMarkerStraightStrokeWidthFront,this.backArrowHeadPath.linewidth=Et.currentAngleMarkerCircularStrokeWidthFront,S.angleMarker.drawn.dashArray.front.length>0&&S.angleMarker.drawn.dashArray.front[0]!==0&&S.angleMarker.drawn.dashArray.front[1]!==0&&(this.frontCirclePathStart.dashes.clear(),this.frontCirclePathTail.dashes.clear(),S.angleMarker.drawn.dashArray.front.forEach(n=>{this.frontCirclePathStart.dashes.push(n),this.frontCirclePathTail.dashes.push(n)}),this.frontCirclePathStart.dashes.reverse(),this.frontCirclePathTail.dashes.reverse()),pe.hslaIsNoFillOrNoStroke(S.angleMarker.temp.fillColor.back)?(this.backFill1.noFill(),this.backFill2.noFill()):(this.backFill1.fill=S.angleMarker.temp.fillColor.back,this.backFill2.fill=S.angleMarker.temp.fillColor.back),pe.hslaIsNoFillOrNoStroke(S.angleMarker.temp.strokeColor.back)?(this.backCirclePathStart.noStroke(),this.backCirclePathTail.noStroke(),this.backStraightStart.noStroke(),this.backStraightEnd.noStroke(),this.backArrowHeadPath.noStroke(),this.backArrowHeadPath.noFill()):(this.backCirclePathStart.stroke=S.angleMarker.temp.strokeColor.back,this.backCirclePathTail.stroke=S.angleMarker.temp.strokeColor.back,this.backStraightStart.stroke=S.angleMarker.temp.strokeColor.back,this.backStraightEnd.stroke=S.angleMarker.temp.strokeColor.back,this.backArrowHeadPath.stroke=S.angleMarker.temp.strokeColor.back,this.backArrowHeadPath.fill=S.angleMarker.temp.strokeColor.back),this.backCirclePathStart.linewidth=Et.currentAngleMarkerCircularStrokeWidthBack,this.backCirclePathTail.linewidth=Et.currentAngleMarkerCircularStrokeWidthBack,this.backStraightStart.linewidth=Et.currentAngleMarkerStraightStrokeWidthBack,this.backStraightEnd.linewidth=Et.currentAngleMarkerStraightStrokeWidthBack,this.backArrowHeadPath.linewidth=Et.currentAngleMarkerCircularStrokeWidthBack,S.angleMarker.drawn.dashArray.back.length>0&&S.angleMarker.drawn.dashArray.back[0]!==0&&S.angleMarker.drawn.dashArray.back[1]!==0&&(this.backCirclePathStart.dashes.clear(),this.backCirclePathTail.dashes.clear(),S.angleMarker.drawn.dashArray.back.forEach(n=>{this.backCirclePathStart.dashes.push(n),this.backCirclePathTail.dashes.push(n)}),this.backCirclePathStart.dashes.reverse(),this.backCirclePathTail.dashes.reverse()),this.glowingFrontCirclePathStart.visible=!1,this.glowingBackCirclePathStart.visible=!1,this.glowingFrontStraightStart.visible=!1,this.glowingBackStraightStart.visible=!1,this.glowingFrontCirclePathDoubleArcStart.visible=!1,this.glowingBackCirclePathDoubleArcStart.visible=!1,this.glowingFrontArrowHeadPath.visible=!1,this.glowingBackArrowHeadPath.visible=!1,this.glowingFrontCirclePathTail.visible=!1,this.glowingBackCirclePathTail.visible=!1,this.glowingFrontStraightEnd.visible=!1,this.glowingBackStraightEnd.visible=!1,this.glowingFrontCirclePathDoubleArcTail.visible=!1,this.glowingBackCirclePathDoubleArcTail.visible=!1,this.backCirclePathDoubleArcStart.visible=!1,this.frontCirclePathDoubleArcStart.visible=!1,this.backCirclePathDoubleArcTail.visible=!1,this.frontCirclePathDoubleArcTail.visible=!1;break}case Vt.ApplyCurrentVariables:{const n=this.styleOptions.get(q.Front);pe.hslaIsNoFillOrNoStroke(n==null?void 0:n.fillColor)?(this.frontFill1.noFill(),this.frontFill2.noFill()):(this.frontFill1.fill=(n==null?void 0:n.fillColor)??S.angleMarker.drawn.fillColor.front,this.frontFill2.fill=(n==null?void 0:n.fillColor)??S.angleMarker.drawn.fillColor.front),pe.hslaIsNoFillOrNoStroke(n==null?void 0:n.strokeColor)?(this.frontCirclePathStart.noStroke(),this.frontStraightStart.noStroke(),this.frontCirclePathDoubleArcStart.noStroke(),this.frontCirclePathTail.noStroke(),this.frontStraightEnd.noStroke(),this.frontCirclePathDoubleArcTail.noStroke(),this.frontArrowHeadPath.noStroke(),this.frontArrowHeadPath.noFill()):(this.frontCirclePathStart.stroke=(n==null?void 0:n.strokeColor)??"black",this.frontStraightStart.stroke=(n==null?void 0:n.strokeColor)??"black",this.frontCirclePathDoubleArcStart.stroke=(n==null?void 0:n.strokeColor)??"black",this.frontCirclePathTail.stroke=(n==null?void 0:n.strokeColor)??"black",this.frontStraightEnd.stroke=(n==null?void 0:n.strokeColor)??"black",this.frontCirclePathDoubleArcTail.stroke=(n==null?void 0:n.strokeColor)??"black",this.frontArrowHeadPath.stroke=(n==null?void 0:n.strokeColor)??"black",this.frontArrowHeadPath.fill=(n==null?void 0:n.strokeColor)??"black"),n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&n.dashArray.length>0&&n.dashArray[0]!==0&&n.dashArray[1]!==0?(this.frontCirclePathStart.dashes.clear(),this.frontCirclePathDoubleArcStart.dashes.clear(),this.frontCirclePathTail.dashes.clear(),this.frontCirclePathDoubleArcTail.dashes.clear(),this.frontCirclePathStart.dashes.push(...n.dashArray),this.frontCirclePathDoubleArcStart.dashes.push(...n.dashArray),this.frontCirclePathTail.dashes.push(...n.dashArray),this.frontCirclePathDoubleArcTail.dashes.push(...n.dashArray),n.reverseDashArray&&(this.frontCirclePathStart.dashes.reverse(),this.frontCirclePathDoubleArcStart.dashes.reverse(),this.frontCirclePathTail.dashes.reverse(),this.frontCirclePathDoubleArcTail.dashes.reverse())):(this.frontCirclePathStart.dashes.clear(),this.frontCirclePathStart.dashes.push(0),this.frontCirclePathDoubleArcStart.dashes.clear(),this.frontCirclePathDoubleArcStart.dashes.push(0),this.frontCirclePathTail.dashes.clear(),this.frontCirclePathTail.dashes.push(0),this.frontCirclePathDoubleArcTail.dashes.clear(),this.frontCirclePathDoubleArcTail.dashes.push(0));const r=this.styleOptions.get(q.Back);r!=null&&r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastFillColor(n==null?void 0:n.fillColor))?(this.backFill1.noFill(),this.backFill2.noFill()):(this.backFill1.fill=pe.contrastFillColor((n==null?void 0:n.fillColor)??"black"),this.backFill2.fill=pe.contrastFillColor((n==null?void 0:n.fillColor)??"black")):pe.hslaIsNoFillOrNoStroke(r==null?void 0:r.fillColor)?(this.backFill1.noFill(),this.backFill2.noFill()):(this.backFill1.fill=(r==null?void 0:r.fillColor)??"black",this.backFill2.fill=(r==null?void 0:r.fillColor)??"black"),r!=null&&r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastStrokeColor(n==null?void 0:n.strokeColor))?(this.backCirclePathStart.noStroke(),this.backStraightStart.noStroke(),this.backCirclePathDoubleArcStart.noStroke(),this.backCirclePathTail.noStroke(),this.backStraightEnd.noStroke(),this.backCirclePathDoubleArcTail.noStroke(),this.backArrowHeadPath.noStroke(),this.backArrowHeadPath.noFill()):(this.backCirclePathStart.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"),this.backStraightStart.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"),this.backCirclePathDoubleArcStart.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"),this.backCirclePathTail.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"),this.backStraightEnd.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"),this.backCirclePathDoubleArcTail.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"),this.backArrowHeadPath.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"),this.backArrowHeadPath.fill=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black")):pe.hslaIsNoFillOrNoStroke(r==null?void 0:r.strokeColor)?(this.backCirclePathStart.noStroke(),this.backStraightStart.noStroke(),this.backCirclePathDoubleArcStart.noStroke(),this.backCirclePathTail.noStroke(),this.backStraightEnd.noStroke(),this.backCirclePathDoubleArcTail.noStroke(),this.backArrowHeadPath.noStroke(),this.backArrowHeadPath.noFill()):(this.backCirclePathStart.stroke=(r==null?void 0:r.strokeColor)??"black",this.backStraightStart.stroke=(r==null?void 0:r.strokeColor)??"black",this.backCirclePathDoubleArcStart.stroke=(r==null?void 0:r.strokeColor)??"black",this.backCirclePathTail.stroke=(r==null?void 0:r.strokeColor)??"black",this.backStraightEnd.stroke=(r==null?void 0:r.strokeColor)??"black",this.backCirclePathDoubleArcTail.stroke=(r==null?void 0:r.strokeColor)??"black",this.backArrowHeadPath.stroke=(r==null?void 0:r.strokeColor)??"black",this.backArrowHeadPath.fill=(r==null?void 0:r.strokeColor)??"black"),r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0&&r.dashArray[0]!==0&&r.dashArray[1]!==0?(this.backCirclePathStart.dashes.clear(),this.backCirclePathDoubleArcStart.dashes.clear(),this.backCirclePathTail.dashes.clear(),this.backCirclePathDoubleArcTail.dashes.clear(),this.backCirclePathStart.dashes.push(...r.dashArray),this.backCirclePathDoubleArcStart.dashes.push(...r.dashArray),this.backCirclePathTail.dashes.push(...r.dashArray),this.backCirclePathDoubleArcTail.dashes.push(...r.dashArray),r.reverseDashArray&&(this.backCirclePathStart.dashes.reverse(),this.backCirclePathDoubleArcStart.dashes.reverse(),this.backCirclePathTail.dashes.reverse(),this.backCirclePathDoubleArcTail.dashes.reverse())):(this.backCirclePathStart.dashes.clear(),this.backCirclePathStart.dashes.push(0),this.backCirclePathDoubleArcStart.dashes.clear(),this.backCirclePathDoubleArcStart.dashes.push(0),this.backCirclePathTail.dashes.clear(),this.backCirclePathTail.dashes.push(0),this.backCirclePathDoubleArcTail.dashes.clear(),this.backCirclePathDoubleArcTail.dashes.push(0)),this.glowingFrontCirclePathStart.stroke=this.glowingStrokeColorFront,this.glowingFrontStraightStart.stroke=this.glowingStrokeColorFront,this.glowingFrontCirclePathDoubleArcStart.stroke=this.glowingStrokeColorFront,this.glowingFrontCirclePathTail.stroke=this.glowingStrokeColorFront,this.glowingFrontStraightEnd.stroke=this.glowingStrokeColorFront,this.glowingFrontCirclePathDoubleArcTail.stroke=this.glowingStrokeColorFront,this.glowingFrontArrowHeadPath.stroke=this.glowingStrokeColorFront,n!=null&&n.dashArray&&n.dashArray.length>0&&n.dashArray[0]!==0&&n.dashArray[1]!==0?(this.glowingFrontCirclePathStart.dashes.clear(),this.glowingFrontCirclePathDoubleArcStart.dashes.clear(),this.glowingFrontCirclePathTail.dashes.clear(),this.glowingFrontCirclePathDoubleArcTail.dashes.clear(),this.glowingFrontCirclePathStart.dashes.push(...n.dashArray),this.glowingFrontCirclePathDoubleArcStart.dashes.push(...n.dashArray),this.glowingFrontCirclePathTail.dashes.push(...n.dashArray),this.glowingFrontCirclePathDoubleArcTail.dashes.push(...n.dashArray)):(this.glowingFrontCirclePathStart.dashes.clear(),this.glowingFrontCirclePathStart.dashes.push(0),this.glowingFrontCirclePathDoubleArcStart.dashes.clear(),this.glowingFrontCirclePathDoubleArcStart.dashes.push(0),this.glowingFrontCirclePathTail.dashes.clear(),this.glowingFrontCirclePathTail.dashes.push(0),this.glowingFrontCirclePathDoubleArcTail.dashes.clear(),this.glowingFrontCirclePathDoubleArcTail.dashes.push(0)),this.glowingBackCirclePathStart.stroke=this.glowingStrokeColorBack,this.glowingBackStraightStart.stroke=this.glowingStrokeColorBack,this.glowingBackCirclePathDoubleArcStart.stroke=this.glowingStrokeColorBack,this.glowingBackCirclePathTail.stroke=this.glowingStrokeColorBack,this.glowingBackStraightEnd.stroke=this.glowingStrokeColorBack,this.glowingBackCirclePathDoubleArcTail.stroke=this.glowingStrokeColorBack,this.glowingBackArrowHeadPath.stroke=this.glowingStrokeColorBack,r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0&&r.dashArray[0]!==0&&r.dashArray[1]!==0?(this.glowingBackCirclePathStart.dashes.clear(),this.glowingBackCirclePathDoubleArcStart.dashes.clear(),this.glowingBackCirclePathTail.dashes.clear(),this.glowingBackCirclePathDoubleArcTail.dashes.clear(),this.glowingBackCirclePathStart.dashes.push(...r.dashArray),this.glowingBackCirclePathDoubleArcStart.dashes.push(...r.dashArray),this.glowingBackCirclePathTail.dashes.push(...r.dashArray),this.glowingBackCirclePathDoubleArcTail.dashes.push(...r.dashArray),r.reverseDashArray&&(this.glowingBackCirclePathStart.dashes.reverse(),this.glowingBackCirclePathDoubleArcStart.dashes.reverse(),this.glowingBackCirclePathTail.dashes.reverse(),this.glowingBackCirclePathDoubleArcTail.dashes.reverse())):(this.glowingBackCirclePathStart.dashes.clear(),this.glowingBackCirclePathStart.dashes.push(0),this.glowingBackCirclePathDoubleArcStart.dashes.clear(),this.glowingBackCirclePathDoubleArcStart.dashes.push(0),this.glowingBackCirclePathTail.dashes.clear(),this.glowingBackCirclePathTail.dashes.push(0),this.glowingBackCirclePathDoubleArcTail.dashes.clear(),this.glowingBackCirclePathDoubleArcTail.dashes.push(0));break}}}};y(Et,"currentAngleMarkerStraightStrokeWidthFront",S.angleMarker.drawn.strokeWidth.straight.front),y(Et,"currentAngleMarkerStraightStrokeWidthBack",S.angleMarker.drawn.strokeWidth.straight.back),y(Et,"currentGlowingAngleMarkerStraightStrokeWidthFront",S.angleMarker.drawn.strokeWidth.straight.front+S.angleMarker.glowing.straight.edgeWidth),y(Et,"currentGlowingAngleMarkerStraightStrokeWidthBack",S.angleMarker.drawn.strokeWidth.straight.back+S.angleMarker.glowing.straight.edgeWidth),y(Et,"currentAngleMarkerCircularStrokeWidthFront",S.angleMarker.drawn.strokeWidth.circular.front),y(Et,"currentAngleMarkerCircularStrokeWidthBack",S.angleMarker.drawn.strokeWidth.circular.back),y(Et,"currentGlowingAngleMarkerCircularStrokeWidthFront",S.angleMarker.drawn.strokeWidth.circular.front+S.angleMarker.glowing.circular.edgeWidth),y(Et,"currentGlowingAngleMarkerCircularStrokeWidthBack",S.angleMarker.drawn.strokeWidth.circular.back+S.angleMarker.glowing.circular.edgeWidth),y(Et,"currentAngleMarkerRadius",S.angleMarker.defaultRadius),y(Et,"currentAngleMarkerRadiusDoubleArc",S.angleMarker.defaultRadius+S.angleMarker.doubleArcGap),y(Et,"currentAngleMarkerArrowHeadLength",S.angleMarker.arrowHeadLength);let ih=Et;const mle=new Set([...Object.getOwnPropertyNames(Qk),...Object.getOwnPropertyNames(eC)]);class en extends On{constructor(i,n,r,s,o,a,l){super();y(this,"label");y(this,"_firstSEParent");y(this,"_secondSEParent");y(this,"_thirdSEParent");y(this,"mode",Di.NONE);y(this,"zoomMagnificationFactor");y(this,"changeInPositionRotationMatrix",new Pt);y(this,"desiredZAxis",new k);y(this,"_vertexVector",new k);y(this,"_startVector",new k);y(this,"_endVector",new k);y(this,"_vertexDirectionScalar",0);y(this,"_firstPointDirectionScalar",0);y(this,"_secondPointDirectionScalar",0);y(this,"_sideOfLine1",0);y(this,"_sideOfLine2",0);y(this,"_lineClickLocation1",new k);y(this,"_lineClickLocation2",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"tmpVector3",new k);y(this,"tmpVector4",new k);y(this,"tmpVector5",new k);y(this,"measureTmpVector1",new k);y(this,"measureTmpVector2",new k);y(this,"measureTmpVector3",new k);y(this,"_angleMarkerNumber",0);y(this,"_measure",0);this.ref=new ih,this.ref.updateDisplay(),this.ref.stylize(Vt.ApplyCurrentVariables),this.ref.adjustSize(),this._firstSEParent=r,this._secondSEParent=s,this._thirdSEParent=o,this.zoomMagnificationFactor=n,a&&(this._lineClickLocation1=a),l&&(this._lineClickLocation2=l),this.mode=i,this._valueDisplayMode=S.angleMarker.initialValueDisplayMode,en.ANGLEMARKER_COUNT++,this._angleMarkerNumber=en.ANGLEMARKER_COUNT}customStyles(){return mle}get valueDisplayMode(){return this._valueDisplayMode}set valueDisplayMode(i){console.debug("set the vdm in SEAngleMarker"),this._valueDisplayMode=i,this.label&&(this.label.ref.valueDisplayMode=i)}get angleMarkerNumber(){return this._angleMarkerNumber}get angleMode(){return this.mode}get value(){return this.measureAngle(this._startVector,this._vertexVector,this._endVector)}get noduleDescription(){var i,n,r,s,o,a,l,c,u,h,d;return this._thirdSEParent!==void 0?String(_e.global.t("objectTree.anglePoints",{p1:(i=this._firstSEParent.label)==null?void 0:i.ref.shortUserName,p2:(n=this._secondSEParent.label)==null?void 0:n.ref.shortUserName,p3:(r=this._thirdSEParent.label)==null?void 0:r.ref.shortUserName,val:this._measure})):this._firstSEParent instanceof Jt&&this._secondSEParent instanceof Jt?String(_e.global.t("objectTree.angleSegments",{seg1:(s=this._firstSEParent.label)==null?void 0:s.ref.shortUserName,seg2:(o=this._secondSEParent.label)==null?void 0:o.ref.shortUserName,val:this._measure})):this._firstSEParent instanceof $t&&this._secondSEParent instanceof $t?String(_e.global.t("objectTree.angleLines",{line1:(a=this._firstSEParent.label)==null?void 0:a.ref.shortUserName,line2:(l=this._secondSEParent.label)==null?void 0:l.ref.shortUserName,val:this._measure})):this._firstSEParent instanceof $t&&this._secondSEParent instanceof Jt?String(_e.global.t("objectTree.angleLineSegment",{line1:(c=this._firstSEParent.label)==null?void 0:c.ref.shortUserName,line2:(u=this._secondSEParent.label)==null?void 0:u.ref.shortUserName,val:this._measure})):String(_e.global.t("objectTree.angleSegmentLine",{line1:(h=this._firstSEParent.label)==null?void 0:h.ref.shortUserName,line2:(d=this._secondSEParent.label)==null?void 0:d.ref.shortUserName,val:this._measure}))}get noduleItemText(){var i;return this.name+": "+((i=this.label)==null?void 0:i.ref.shortUserName)+` ${this.prettyValue()}`}get firstSEParent(){return this._firstSEParent}get secondSEParent(){return this._secondSEParent}get vertexVector(){return this._vertexVector}get startVector(){return this._startVector}get endVector(){return this._endVector}get secondPointDirectionScalar(){return this._secondPointDirectionScalar}get firstPointDirectionScalar(){return this._firstPointDirectionScalar}isHitAt(i,n){const r=i.angleTo(this._vertexVector);if(r<S.angleMarker.hitIdealDistance/n)return!0;if(r>this.ref.angleMarkerRadius+S.angleMarker.hitIdealDistance/n)return!1;{const s=this.measureAngle(this._startVector,this._vertexVector,i),o=this.measureAngle(this._startVector,this._vertexVector,this._endVector);return s<=o}}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Anglemarker with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"angleMarker",object:this})}this.setOutOfDate(!1),this.updateKids(i,n)}}shallowUpdate(){if(this._exists=this._firstSEParent.exists&&this._secondSEParent.exists,this._secondSEParent instanceof Ze&&this._firstSEParent instanceof Ze&&this._thirdSEParent instanceof Ze&&(this._exists=this._exists&&this._thirdSEParent.exists,this._exists=this._exists&&!this.tmpVector1.crossVectors(this._firstSEParent.locationVector,this._secondSEParent.locationVector).isZero(S.nearlyAntipodalIdeal/this.zoomMagnificationFactor)&&!this.tmpVector1.crossVectors(this._thirdSEParent.locationVector,this._secondSEParent.locationVector).isZero(S.nearlyAntipodalIdeal/this.zoomMagnificationFactor)),this._exists){if(this._secondSEParent instanceof Ze&&this._firstSEParent instanceof Ze&&this._thirdSEParent instanceof Ze){const i=this.ref.setAngleMarkerFromThreeVectors(this._firstSEParent.locationVector,this._secondSEParent.locationVector,this._thirdSEParent.locationVector,this.ref.angleMarkerRadius);this._startVector.copy(i[0]),this._vertexVector.copy(i[1]),this._endVector.copy(i[2])}else if(this._secondSEParent instanceof $t&&this._firstSEParent instanceof $t)this._firstSEParent.startSEPoint.id===this._secondSEParent.startSEPoint.id||this._firstSEParent.startSEPoint.id===this._secondSEParent.endSEPoint.id?this._vertexVector.copy(this._firstSEParent.startSEPoint.locationVector):this._firstSEParent.endSEPoint.id===this._secondSEParent.startSEPoint.id||this._firstSEParent.endSEPoint.id===this._secondSEParent.endSEPoint.id?this._vertexVector.copy(this._firstSEParent.endSEPoint.locationVector):this._vertexDirectionScalar===0?(this._vertexVector.crossVectors(this._firstSEParent.normalVector,this._secondSEParent.normalVector).normalize(),this._vertexVector.z*this._lineClickLocation1.z<0?(this._vertexVector.multiplyScalar(-1),this._vertexDirectionScalar=-1):this._vertexDirectionScalar=1):this._vertexVector.crossVectors(this._firstSEParent.normalVector,this._secondSEParent.normalVector).multiplyScalar(this._vertexDirectionScalar).normalize(),this._firstPointDirectionScalar===0&&(this.tmpVector1.crossVectors(this._vertexVector,this._firstSEParent.normalVector).normalize(),this.tmpVector1.dot(this._firstSEParent.closestVector(this._lineClickLocation1))<0?this._firstPointDirectionScalar=-1:this._firstPointDirectionScalar=1),this.tmpVector1.crossVectors(this._vertexVector,this._firstSEParent.normalVector).multiplyScalar(this._firstPointDirectionScalar).normalize(),this._startVector.set(0,0,0),this._startVector.addScaledVector(this._vertexVector,Math.cos(this.ref.angleMarkerRadius)),this._startVector.addScaledVector(this.tmpVector1,Math.sin(this.ref.angleMarkerRadius)).normalize(),this.tmpVector1.crossVectors(this._vertexVector,this._secondSEParent.normalVector).normalize(),this.measureAngle(this._startVector,this._vertexVector,this.tmpVector1)>Math.PI&&this.tmpVector1.multiplyScalar(-1),this._endVector.set(0,0,0),this._endVector.addScaledVector(this._vertexVector,Math.cos(this.ref.angleMarkerRadius)),this._endVector.addScaledVector(this.tmpVector1,Math.sin(this.ref.angleMarkerRadius)).normalize(),this.ref.vertexVector=this._vertexVector,this.ref.startVector=this._startVector,this.ref.endVector=this._endVector;else if(this._secondSEParent instanceof Jt&&this._firstSEParent instanceof Jt){this._firstSEParent.startSEPoint.locationVector.equals(this._secondSEParent.startSEPoint.locationVector)?(this._vertexVector.copy(this._firstSEParent.startSEPoint.locationVector),this._startVector.copy(this._firstSEParent.endSEPoint.locationVector).multiplyScalar(this._firstSEParent.arcLength>Math.PI?-1:1),this._endVector.copy(this._secondSEParent.endSEPoint.locationVector).multiplyScalar(this._secondSEParent.arcLength>Math.PI?-1:1)):this._firstSEParent.startSEPoint.locationVector.equals(this._secondSEParent.endSEPoint.locationVector)?(this._vertexVector.copy(this._firstSEParent.startSEPoint.locationVector),this._startVector.copy(this._firstSEParent.endSEPoint.locationVector).multiplyScalar(this._firstSEParent.arcLength>Math.PI?-1:1),this._endVector.copy(this._secondSEParent.startSEPoint.locationVector).multiplyScalar(this._secondSEParent.arcLength>Math.PI?-1:1)):this._firstSEParent.endSEPoint.locationVector.equals(this._secondSEParent.startSEPoint.locationVector)?(this._vertexVector.copy(this._firstSEParent.endSEPoint.locationVector),this._startVector.copy(this._firstSEParent.startSEPoint.locationVector).multiplyScalar(this._firstSEParent.arcLength>Math.PI?-1:1),this._endVector.copy(this._secondSEParent.endSEPoint.locationVector).multiplyScalar(this._secondSEParent.arcLength>Math.PI?-1:1)):this._firstSEParent.endSEPoint.locationVector.equals(this._secondSEParent.endSEPoint.locationVector)&&(this._vertexVector.copy(this._firstSEParent.endSEPoint.locationVector),this._startVector.copy(this._firstSEParent.startSEPoint.locationVector).multiplyScalar(this._firstSEParent.arcLength>Math.PI?-1:1),this._endVector.copy(this._secondSEParent.startSEPoint.locationVector).multiplyScalar(this._secondSEParent.arcLength>Math.PI?-1:1)),this.tmpVector1.crossVectors(this._vertexVector,this._firstSEParent.normalVector).normalize();const i=this.tmpVector1.dot(this._startVector);Math.abs(i)<S.tolerance?this._firstSEParent.closestVector(this.tmpVector1).angleTo(this.tmpVector1)>S.tolerance&&this.tmpVector1.multiplyScalar(-1):i<0&&this.tmpVector1.multiplyScalar(-1),this._startVector.set(0,0,0),this._startVector.addScaledVector(this._vertexVector,Math.cos(this.ref.angleMarkerRadius)),this._startVector.addScaledVector(this.tmpVector1,Math.sin(this.ref.angleMarkerRadius)).normalize(),this.tmpVector1.crossVectors(this._vertexVector,this._secondSEParent.normalVector).normalize();const n=this.tmpVector1.dot(this._endVector);Math.abs(n)<S.tolerance?this._secondSEParent.closestVector(this.tmpVector1).angleTo(this.tmpVector1)>S.tolerance&&this.tmpVector1.multiplyScalar(-1):n<0&&this.tmpVector1.multiplyScalar(-1),this._endVector.set(0,0,0),this._endVector.addScaledVector(this._vertexVector,Math.cos(this.ref.angleMarkerRadius)),this._endVector.addScaledVector(this.tmpVector1,Math.sin(this.ref.angleMarkerRadius)).normalize(),this.ref.vertexVector=this._vertexVector,this.ref.startVector=this._startVector,this.ref.endVector=this._endVector}else(this._secondSEParent instanceof Jt&&this._firstSEParent instanceof $t||this._secondSEParent instanceof $t&&this._firstSEParent instanceof Jt)&&(this._secondSEParent instanceof Jt?(Math.abs(this._secondSEParent.startSEPoint.locationVector.dot(this._firstSEParent.normalVector))<S.tolerance?(this._vertexVector.copy(this._secondSEParent.startSEPoint.locationVector),this.tmpVector1.crossVectors(this._secondSEParent.normalVector,this._vertexVector).multiplyScalar(this._secondSEParent.arcLength>Math.PI?-1:1).normalize()):Math.abs(this._secondSEParent.endSEPoint.locationVector.dot(this._firstSEParent.normalVector))<S.tolerance&&(this._vertexVector.copy(this._secondSEParent.endSEPoint.locationVector),this.tmpVector1.crossVectors(this._vertexVector,this._secondSEParent.normalVector).multiplyScalar(this._secondSEParent.arcLength>Math.PI?-1:1).normalize()),this._endVector.set(0,0,0),this._endVector.addScaledVector(this._vertexVector,Math.cos(this.ref.angleMarkerRadius)),this._endVector.addScaledVector(this.tmpVector1,Math.sin(this.ref.angleMarkerRadius)).normalize(),this.tmpVector2.crossVectors(this._vertexVector,this._firstSEParent.normalVector).normalize(),this.measureAngle(this.tmpVector2,this._vertexVector,this._endVector)>Math.PI&&this.tmpVector2.multiplyScalar(-1),this._startVector.set(0,0,0),this._startVector.addScaledVector(this._vertexVector,Math.cos(this.ref.angleMarkerRadius)),this._startVector.addScaledVector(this.tmpVector2,Math.sin(this.ref.angleMarkerRadius)).normalize()):this._firstSEParent instanceof Jt&&(Math.abs(this._firstSEParent.startSEPoint.locationVector.dot(this._secondSEParent.normalVector))<S.nearlyAntipodalIdeal?(this._vertexVector.copy(this._firstSEParent.startSEPoint.locationVector),this.tmpVector1.crossVectors(this._firstSEParent.normalVector,this._vertexVector).multiplyScalar(this._firstSEParent.arcLength>Math.PI?-1:1).normalize()):Math.abs(this._firstSEParent.endSEPoint.locationVector.dot(this._secondSEParent.normalVector))<S.nearlyAntipodalIdeal&&(this._vertexVector.copy(this._firstSEParent.endSEPoint.locationVector),this.tmpVector1.crossVectors(this._vertexVector,this._firstSEParent.normalVector).multiplyScalar(this._firstSEParent.arcLength>Math.PI?-1:1).normalize()),this._startVector.set(0,0,0),this._startVector.addScaledVector(this._vertexVector,Math.cos(this.ref.angleMarkerRadius)),this._startVector.addScaledVector(this.tmpVector1,Math.sin(this.ref.angleMarkerRadius)).normalize(),this.tmpVector2.crossVectors(this._vertexVector,this._secondSEParent.normalVector).normalize(),this.measureAngle(this._startVector,this._vertexVector,this.tmpVector2)>Math.PI&&this.tmpVector2.multiplyScalar(-1),this._endVector.set(0,0,0),this._endVector.addScaledVector(this._vertexVector,Math.cos(this.ref.angleMarkerRadius)),this._endVector.addScaledVector(this.tmpVector2,Math.sin(this.ref.angleMarkerRadius)).normalize()),this.ref.vertexVector=this._vertexVector,this.ref.startVector=this._startVector,this.ref.endVector=this._endVector);this._measure=this.measureAngle(this._startVector,this._vertexVector,this._endVector),this.ref.updateDisplay()}this.label&&this._exists&&(this.label.ref.value=[this.value]),this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}closestVector(i){if(this.isHitAt(i,this.zoomMagnificationFactor))return i;const n=this.measureAngle(this._startVector,this._vertexVector,this._endVector),r=this.measureAngle(this._startVector,this._vertexVector,i);return r<=n?(this.tmpVector1.crossVectors(this._vertexVector,i).normalize(),this.tmpVector1.crossVectors(this.tmpVector1,this._vertexVector).normalize(),this.tmpVector2.set(0,0,0),this.tmpVector2.addScaledVector(this._vertexVector,Math.cos(this.ref.angleMarkerRadius)),this.tmpVector2.addScaledVector(this.tmpVector1,Math.sin(this.ref.angleMarkerRadius)),this.tmpVector2.normalize()):n<=Math.PI?(this.tmpVector1.addVectors(this._vertexVector,this._endVector).normalize(),this.tmpVector2.crossVectors(this._vertexVector,this._endVector),this.tmpVector3.crossVectors(this.tmpVector1,this.tmpVector2).normalize(),this.tmpVector1.addVectors(this._startVector,this._vertexVector).normalize(),this.tmpVector2.crossVectors(this._startVector,this._vertexVector),this.tmpVector4.crossVectors(this.tmpVector2,this.tmpVector1).normalize(),this.tmpVector5.crossVectors(this.tmpVector3,this.tmpVector4).normalize(),this._vertexVector.dot(this.tmpVector5)>0&&this.tmpVector5.multiplyScalar(-1),this.inRegion(this._vertexVector,this._endVector,this.tmpVector1.crossVectors(this._vertexVector,this._endVector).normalize(),i)?this.projectToSegment(this._vertexVector,this._endVector,i):this.inRegion(this._startVector,this._vertexVector,this.tmpVector1.crossVectors(this._startVector,this._vertexVector).normalize(),i)?this.projectToSegment(this._vertexVector,this._startVector,i):this.inRegion(this._vertexVector,this.tmpVector1.crossVectors(this._vertexVector,this._endVector).normalize(),this.tmpVector2.crossVectors(this._startVector,this._vertexVector).normalize(),i)||this.inRegion(this.tmpVector1.crossVectors(this._vertexVector,this._endVector).normalize(),this.tmpVector5,this.tmpVector2.crossVectors(this._startVector,this._vertexVector).normalize(),i)?this._vertexVector:this.inRegion(this._endVector,this.tmpVector2.set(0,0,0).addScaledVector(this._vertexVector,-1).normalize(),this.tmpVector1.crossVectors(this._vertexVector,this._endVector).normalize(),i)||this.inRegion(this.tmpVector1.crossVectors(this._vertexVector,this._endVector).normalize(),this.tmpVector2.set(0,0,0).addScaledVector(this._vertexVector,-1).normalize(),this.tmpVector5,i)?this._endVector:this._startVector):(this.tmpVector1.crossVectors(this._vertexVector,this._endVector),this.tmpVector2.crossVectors(this._endVector,this.tmpVector1).normalize(),this.tmpVector1.crossVectors(this._startVector,this._vertexVector),this.tmpVector3.crossVectors(this.tmpVector1,this._startVector).normalize(),this.tmpVector5.crossVectors(this.tmpVector2,this.tmpVector3).normalize(),this._vertexVector.dot(this.tmpVector5)>0&&this.tmpVector5.multiplyScalar(-1),this.inRegion(this._vertexVector,this._endVector,this.tmpVector5,i)?this.projectToSegment(this._vertexVector,this._endVector,i):this.inRegion(this._startVector,this._vertexVector,this.tmpVector5,i)?this.projectToSegment(this._vertexVector,this._startVector,i):r<=n/2+Math.PI?this._endVector:this._startVector)}closestLabelLocationVector(i){return this.tmpVector1.copy(this.closestVector(i)),this.tmpVector1.angleTo(i)<S.angleMarker.maxLabelDistance/this.zoomMagnificationFactor?i:(this.tmpVector2.crossVectors(i,this.tmpVector1).normalize(),this.tmpVector3.crossVectors(this.tmpVector1,this.tmpVector2).normalize,this.tmpVector3.multiplyScalar(Math.sin(S.angleMarker.maxLabelDistance/this.zoomMagnificationFactor)),this.tmpVector3.addScaledVector(this.tmpVector1,Math.cos(S.angleMarker.maxLabelDistance/this.zoomMagnificationFactor)).normalize(),this.tmpVector3)}accept(i){return i.actionOnAngleMarker(this)}measureAngle(i,n,r){return this.measureTmpVector1.set(0,0,0),this.measureTmpVector1.copy(r),this.measureTmpVector1.addScaledVector(n,-1*n.dot(r)),this.measureTmpVector2.set(0,0,0),this.measureTmpVector2.copy(i),this.measureTmpVector2.addScaledVector(n,-1*n.dot(i)),this.measureTmpVector2.normalize(),this.measureTmpVector3.set(0,0,0),this.measureTmpVector3.crossVectors(n,this.measureTmpVector2).normalize(),Math.atan2(this.measureTmpVector3.dot(this.measureTmpVector1),this.measureTmpVector2.dot(this.measureTmpVector1)).modTwoPi()}inRegion(i,n,r,s){const o=new k(0,0,0),a=new k(0,0,0),l=new k(0,0,0);return o.crossVectors(i,n),a.crossVectors(n,r),l.crossVectors(r,i),o.dot(s)>=0&&a.dot(s)>=0&&l.dot(s)>=0}projectToSegment(i,n,r){const s=new k;s.crossVectors(i,n).normalize(),s.dot(r)<0&&s.multiplyScalar(-1);const o=new k;return o.crossVectors(s,r),o.length()<S.nearlyAntipodalIdeal?i.add(n).normalize():o.normalize().cross(s)}isLabelable(){return!0}isMeasurable(){return!0}}var p5=(t=>(t[t.PLUS=0]="PLUS",t[t.MINUS=1]="MINUS",t[t.MULT=2]="MULT",t[t.DIV=3]="DIV",t[t.POW=4]="POW",t[t.NUMBER=5]="NUMBER",t[t.MEASUREMENT=6]="MEASUREMENT",t[t.LEFT_PAREN=7]="LEFT_PAREN",t[t.RIGHT_PAREN=8]="RIGHT_PAREN",t[t.MATH_BUILTIN=9]="MATH_BUILTIN",t[t.COMMA=10]="COMMA",t[t.UNKNOWN=11]="UNKNOWN",t[t.EOF=12]="EOF",t))(p5||{});class ple{constructor(e){y(this,"BUILT_IN_MATCH_FNs",["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","ln","max","min","sgn","sin","sqrt","tan"]);y(this,"iterator");y(this,"nextChar");y(this,"prev");y(this,"curr");this.iterator=e[Symbol.iterator](),this.nextChar=this.iterator.next()}lastToken(){var e;return((e=this.prev)==null?void 0:e.text)??String(_e.t("objectTree.startOfInput"))}skipWhiteSpaces(){for(;!this.nextChar.done&&this.nextChar.value.match(/\s/);)this.nextChar=this.iterator.next()}*tokenize(){for(;!this.nextChar.done&&(this.prev=this.curr,this.skipWhiteSpaces(),!this.nextChar.done);)if(this.nextChar.value.match(/[0-9.]/)){let e="";do e+=this.nextChar.value,this.nextChar=this.iterator.next();while(!this.nextChar.done&&this.nextChar.value.match(/[0-9.]/));const i=Number(e);isNaN(i)?yield{kind:11,text:e}:(this.curr={kind:5,text:e,numericValue:Number(e)},yield this.curr)}else if(this.nextChar.value.match(/[a-zA-Z]/)){let e="";do e+=this.nextChar.value,this.nextChar=this.iterator.next();while(!this.nextChar.done&&this.nextChar.value.match(/[a-zA-Z0-9]/));e.toUpperCase()==="PI"?(this.curr={kind:5,text:e,numericValue:Math.PI},yield this.curr):e.toUpperCase()==="E"?(this.curr={kind:5,text:e,numericValue:Math.E},yield this.curr):this.BUILT_IN_MATCH_FNs.findIndex(i=>i===e.toLowerCase())>=0?(this.curr={kind:9,text:e},yield this.curr):(this.curr={kind:6,text:e},yield this.curr)}else if(this.nextChar.value==="+")this.nextChar=this.iterator.next(),this.curr={kind:0,text:"+"},yield this.curr;else if(this.nextChar.value==="-")this.nextChar=this.iterator.next(),this.curr={kind:1,text:"-"},yield this.curr;else if(this.nextChar.value==="*")this.nextChar=this.iterator.next(),this.nextChar.done?this.curr={kind:2,text:"*"}:this.nextChar.value==="*"?(this.nextChar=this.iterator.next(),this.curr={kind:4,text:"**"}):this.curr={kind:2,text:"*"},yield this.curr;else if(this.nextChar.value==="/")this.nextChar=this.iterator.next(),this.curr={kind:3,text:"/"},yield this.curr;else if(this.nextChar.value==="^")this.nextChar=this.iterator.next(),this.curr={kind:4,text:"^"},yield this.curr;else if(this.nextChar.value==="(")this.nextChar=this.iterator.next(),this.curr={kind:7,text:"("},yield this.curr;else if(this.nextChar.value===")")this.nextChar=this.iterator.next(),this.curr={kind:8,text:")"},yield this.curr;else if(this.nextChar.value===",")this.nextChar=this.iterator.next(),this.curr={kind:10,text:","},yield this.curr;else{const e=this.nextChar.value;console.debug("Unknown char",e),this.nextChar=this.iterator.next(),this.curr={kind:11,text:e},yield this.curr}this.curr={kind:12,text:"$"},yield this.curr}}const eu=class eu{constructor(){y(this,"EMPTY_MAP",new Map);y(this,"evaluateWithVars",(e,i)=>eu.evaluate(eu.parse(e),i));y(this,"evaluate",e=>eu.evaluate(eu.parse(e),this.EMPTY_MAP))}static parse(e){const i=new ple(e),n=i.tokenize();let r=n.next();function s(h,d){throw d.kind===12?new SyntaxError(String(_e.t("objectTree.parserError"))):new SyntaxError(h)}function o(){if(r.value.kind===7){r=n.next();const h=c();return r.value.kind===8?(r=n.next(),h):s(String(_e.t("objectTree.expectedRightParenthesis",{text:`${r.value.text}`})),r.value)}if(r.value.kind===1){r=n.next();const h=o();return{node:{kind:1,text:"-"},leftChild:{node:{kind:5,text:"0",numericValue:0}},rightChild:h}}else if(r.value.kind===6){const h=r.value;return r=n.next(),{node:h}}else if(r.value.kind===5){const h=r.value;return r=n.next(),{node:h}}else if(r.value.kind===9){const h=r.value;if(r=n.next(),r.value.kind!==7)return s(String(_e.t("objectTree.expectedLeftParenthesis",{text:`${i.lastToken()}`})),r.value);r=n.next();const f=[c()];for(;r.value.kind===10;)r=n.next(),f.push(c());return r.value.kind===8?(r=n.next(),{node:h,args:f}):s(String(_e.t("objectTree.expectedRightButParenthesis",{text:`${r.value.text}`})),r.value)}else return s(String(_e.t("objectTree.unexpectedInput",{text:`${r.value.text}`})),r.value)}function a(){let h=o();for(;r.value.kind==4;){const d=r.value;r=n.next();const f=o();h={node:d,leftChild:h,rightChild:f}}return h}function l(){let h=a();for(;r.value.kind==2||r.value.kind===3;){const d=r.value;r=n.next();const f=a();h={node:d,leftChild:h,rightChild:f}}return h}function c(){let h=l();for(;r.value.kind==0||r.value.kind===1;){const d=r.value;r=n.next();const f=l();h={node:d,leftChild:h,rightChild:f}}return h}const u=c();if(r.value.kind===12)return u;throw new SyntaxError(String(_e.t("objectTree.unexpectedToken",{text:`${r.value.text}`})))}static simplifiedSumOf(e,i){if(e.node.kind===5&&e.node.text==="0")return i;if(i.node.kind===5&&i.node.text==="0")return e;if(e.node.kind===5&&i.node.kind===5){const n=e.node.numericValue+i.node.numericValue;return{node:{kind:5,numericValue:n,text:n.toFixed(10)}}}return{node:{kind:0,text:""},leftChild:e,rightChild:i}}static simplifiedDifferenceOf(e,i){if(i.node.kind===5&&i.node.text==="0")return e;if(e.node.kind===5&&i.node.kind===5){const n=e.node.numericValue-i.node.numericValue;return{node:{kind:5,numericValue:n,text:n.toFixed(10)}}}return{node:{kind:1,text:""},leftChild:e,rightChild:i}}static simplifiedProductOf(e,i){if(e.node.kind===5&&e.node.text==="0")return e;if(i.node.kind===5&&i.node.text==="0"||e.node.kind===5&&e.node.text==="1")return i;if(i.node.kind===5&&i.node.text==="1")return e;if(e.node.kind===5&&i.node.kind===5){const n=e.node.numericValue*i.node.numericValue;return{node:{kind:5,numericValue:n,text:n.toFixed(10)}}}return{node:{kind:2},leftChild:e,rightChild:i}}static simplifiedQuotientOf(e,i){if(e.node.kind===5&&e.node.text==="0"||i.node.kind===5&&i.node.text==="1")return e;if(e.node.kind===5&&i.node.kind===5){const n=e.node.numericValue/i.node.numericValue;return{node:{kind:5,numericValue:n,text:n.toFixed(10)}}}return{node:{kind:3},leftChild:e,rightChild:i}}static simplifiedPowerOf(e,i){if(i.node.kind===5&&i.node.text==="0")return{node:{kind:5,text:"1"}};if(i.node.kind===5&&i.node.text==="1")return e;if(e.node.kind===5&&i.node.kind===5){const n=Math.pow(e.node.numericValue,i.node.numericValue);return{node:{kind:5,numericValue:n,text:n.toFixed(10)}}}return{node:{kind:4},leftChild:e,rightChild:i}}static differentiate(e,i){if(!e)return eu.NOT_DEFINED;switch(e.node.kind){case 5:return{node:{kind:5,text:"0",numericValue:0}};case 6:return e.node.text===i?{node:{kind:5,text:"1",numericValue:1}}:{node:{kind:5,text:"0",numericValue:0}};case 0:{const n=this.differentiate(e.leftChild,i),r=this.differentiate(e.rightChild,i);return this.simplifiedSumOf(n,r)}case 1:{const n=this.differentiate(e.leftChild,i),r=this.differentiate(e.rightChild,i);return this.simplifiedDifferenceOf(n,r)}case 2:{const n=this.differentiate(e.leftChild,i),r=this.differentiate(e.rightChild,i),s=this.simplifiedProductOf(n,e.rightChild),o=this.simplifiedProductOf(e.leftChild,r);return this.simplifiedSumOf(s,o)}case 3:{const n=this.differentiate(e.leftChild,i),r=this.differentiate(e.rightChild,i),s=this.simplifiedProductOf(n,e.rightChild),o=this.simplifiedProductOf(e.leftChild,r),a=this.simplifiedDifferenceOf(s,o),l=this.simplifiedProductOf(e.rightChild,e.rightChild);return this.simplifiedQuotientOf(a,l)}case 4:{const n=this.differentiate(e.rightChild,i),r=this.simplifiedPowerOf(e.leftChild,n);let s;if(r.node.kind===5)if(r.node.text=="1")s={node:{kind:5,numericValue:0,text:"0"}};else{const h=Math.log(r.node.numericValue);s={node:{kind:5,numericValue:h,text:h.toFixed(10)}}}else s={node:{kind:9,text:"ln"},args:[r]};const o={node:{kind:5,numericValue:1,text:"1"}},a=this.simplifiedPowerOf(e.leftChild,this.simplifiedDifferenceOf(e.rightChild,o)),l=this.differentiate(e.leftChild,i),c=this.simplifiedProductOf(e,s),u=this.simplifiedProductOf(this.simplifiedProductOf(e.rightChild,a),l);return this.simplifiedSumOf(c,u)}case 9:{const n=e.args;switch(e.node.text){case"abs":{const r=this.differentiate(n[0],i);return{node:{kind:2},leftChild:r,rightChild:{node:{kind:3},leftChild:n[0],rightChild:e}}}case"acos":{const r={node:{kind:5,numericValue:1,text:"1"}},s={node:{kind:5,text:"-1",numericValue:-1}},o=this.simplifiedProductOf(n[0],n[0]),a=this.simplifiedDifferenceOf(r,o),l={node:{kind:9,text:"sqrt"},args:[a]},c=this.differentiate(n[0],i);return this.simplifiedProductOf(s,this.simplifiedQuotientOf(c,l))}case"asin":{const r=this.simplifiedProductOf(n[0],n[0]),s=this.simplifiedDifferenceOf({node:{kind:5,text:"1",numericValue:1}},r),o={node:{kind:9,text:"sqrt"},args:[s]},a=this.differentiate(n[0],i);return this.simplifiedQuotientOf(a,o)}case"atan":{const r=this.simplifiedProductOf(n[0],n[0]),s=this.simplifiedSumOf({node:{kind:5,text:"1",numericValue:1}},r),o=this.differentiate(n[0],i);return this.simplifiedQuotientOf(o,s)}case"ceil":return{node:{kind:5,text:"0",numericValue:0}};case"cos":{const r={node:{kind:5,text:"-1",numericValue:-1}},s={node:{kind:9,text:"sin"},args:[n[0]]},o=this.differentiate(n[0],i);return{node:{kind:2},leftChild:r,rightChild:{node:{kind:2},leftChild:s,rightChild:o}}}case"exp":{const r=this.differentiate(n[0],i);return{node:{kind:2},leftChild:e,rightChild:r}}case"floor":return{node:{kind:5,text:"0",numericValue:0}};case"ln":{const r=this.differentiate(n[0],i);return{node:{kind:3},leftChild:r,rightChild:n[0]}}case"sin":{const r={node:{kind:9,text:"cos"},args:[n[0]]},s=this.differentiate(n[0],i);return{node:{kind:2},leftChild:r,rightChild:s}}case"sqrt":{const r={node:{kind:5,text:"2",numericValue:2}},s=this.differentiate(n[0],i);return{node:{kind:3},leftChild:s,rightChild:{node:{kind:2},leftChild:r,rightChild:e}}}case"tan":{const r={node:{kind:9,text:"cos"},args:[n[0]]},s=this.differentiate(n[0],i);return{node:{kind:3},leftChild:s,rightChild:{node:{kind:2},leftChild:r,rightChild:r}}}default:throw new SyntaxError(String(_e.t("objectTree.unknownFunction",{text:`${e.node.text}`})))}}default:throw new Error(String(_e.t("objectTree.unhandledTokenType",{text:`${p5[e.node.kind]}`,text2:`${e.node.text}`})))}}static evaluate(e,i){function n(r){let s;const o=(r==null?void 0:r.node.text)??"n/a";let a;switch(r==null?void 0:r.node.kind){case 5:return r.node.numericValue??0;case 6:if(i.has(o))return i.get(o)??0;throw new Error(String(_e.t("objectTree.undefinedVariable",{text:`${o}`})));case 0:return n(r.leftChild??null)+n(r.rightChild??null);case 1:return n(r.leftChild??null)-n(r.rightChild??null);case 2:return n(r.leftChild??null)*n(r.rightChild??null);case 3:return s=n(r.rightChild??null),Math.abs(s)>1e-4?n(r.leftChild??null)/n(r.rightChild??null):(console.error(String(_e.t("objectTree.divideByZero"))),NaN);case 4:return Math.pow(n(r.leftChild??null),n(r.rightChild??null));case 9:switch(a=r.args,r.node.text){case"max":return Math.max(...a.map(l=>n(l)));case"min":return Math.min(...a.map(l=>n(l)));case"atan2":return Math.atan2(n(a[0]),n(a[1]));case"abs":return Math.abs(n(a[0]));case"acos":return Math.acos(n(a[0]));case"asin":return Math.asin(n(a[0]));case"atan":return Math.atan(n(a[0]));case"ceil":return Math.ceil(n(a[0]));case"cos":return Math.cos(n(a[0]));case"exp":return Math.exp(n(a[0]));case"floor":return Math.floor(n(a[0]));case"ln":return Math.log(n(a[0]));case"sgn":return Math.sign(n(a[0]));case"sin":return Math.sin(n(a[0]));case"sqrt":return Math.sqrt(n(a[0]));case"tan":return Math.tan(n(a[0]));default:throw new SyntaxError(String(_e.t("objectTree.unknownFunction",{text:`${r.node.text}`})))}default:return 0}}return n(e)}};y(eu,"NOT_DEFINED",{node:{kind:11,text:"0",numericValue:0}});let wt=eu;_e.global;const gle=new Set,vle=new wt;class qM extends On{constructor(i){super();y(this,"exprText","");y(this,"computedValue",0);y(this,"_calculationParents",[]);y(this,"customStyles",()=>gle);this.exprText=i;for(const n of i.matchAll(/[Mm][0-9]+/g)){const r=Xe.store.expressions.findIndex(s=>s.name===`${n[0]}`);r>-1&&this._calculationParents.findIndex(o=>o.name===Xe.store.expressions[r].name)<0&&this._calculationParents.push(Xe.store.expressions[r])}}get value(){return this.computedValue}get calculationParents(){return this._calculationParents}recalculate(){const i=new Map;this._calculationParents.filter(n=>n instanceof On).map(n=>n).forEach(n=>{const r=n.name;i.set(r,n.value)}),this.computedValue=vle.evaluateWithVars(this.exprText,i)}get noduleDescription(){return String(_e.global.t("objectTree.calculationDescription",{str:this.exprText,val:this.value}))}get noduleItemText(){return String(_e.global.t("objectTree.calculationValue",{token:this.name,val:this.prettyValue()}))}get valueDisplayMode(){return this._valueDisplayMode}set valueDisplayMode(i){this._valueDisplayMode=i}shallowUpdate(){this.exists=this._calculationParents.every(i=>i.exists),this.exists&&this.recalculate()}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Calculation with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"calculation",object:this})}this.updateKids(i,n)}}}const VT=new k,tR=new k,LT=new k,bb=new Pt,td=S.circle.numPoints,Yr=class Yr extends pe{constructor(){super();y(this,"_centerVector",new k);y(this,"_circleRadius",0);y(this,"projectedRadius",0);y(this,"frontPart");y(this,"backPart");y(this,"glowingFrontPart");y(this,"glowingBackPart");y(this,"frontFill");y(this,"backFill");y(this,"fillStorageAnchors",[]);y(this,"glowingStrokeColorFront",S.circle.glowing.strokeColor.front);y(this,"glowingStrokeColorBack",S.circle.glowing.strokeColor.back);y(this,"frontGradientColorCenter",new it.Stop(0,S.fill.frontWhite,1));y(this,"frontGradientColor",new it.Stop(2*S.boundaryCircle.radius,S.circle.drawn.fillColor.front,1));y(this,"frontGradient",new it.RadialGradient(S.fill.lightSource.x,S.fill.lightSource.y,1*S.boundaryCircle.radius,[this.frontGradientColorCenter,this.frontGradientColor]));y(this,"backGradientColorCenter",new it.Stop(0,S.fill.backGray,1));y(this,"backGradientColor",new it.Stop(1*S.boundaryCircle.radius,S.circle.drawn.fillColor.back,1));y(this,"backGradient",new it.RadialGradient(-S.fill.lightSource.x,-S.fill.lightSource.y,2*S.boundaryCircle.radius,[this.backGradientColorCenter,this.backGradientColor]));y(this,"originalVertices");y(this,"tmpVector",new k);y(this,"tmpMatrix",new Pt);this.originalVertices=[];const i=[];for(let r=0;r<td;r++){i.push(new it.Vector(0,0));const s=2*r/td*Math.PI,o=(2*r+1)/td*Math.PI;this.originalVertices.push(new Pi(S.boundaryCircle.radius*Math.cos(s),S.boundaryCircle.radius*Math.sin(s))),this.originalVertices.push(new Pi(S.boundaryCircle.radius*Math.cos(o),S.boundaryCircle.radius*Math.sin(o)))}this.frontPart=new it.Path(i,!1,!1),this.glowingFrontPart=this.frontPart.clone(),this.backPart=this.frontPart.clone(),this.glowingBackPart=this.frontPart.clone(),pe.idPlottableDescriptionMap.set(String(this.frontPart.id),{type:"circle",side:"front",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.backPart.id),{type:"circle",side:"back",fill:!1,part:""}),this.frontPart.noFill(),this.backPart.noFill(),this.glowingFrontPart.noFill(),this.glowingBackPart.noFill(),this.frontPart.visible=!0,this.backPart.visible=!0,this.glowingBackPart.visible=!1,this.glowingFrontPart.visible=!1;const n=[];for(let r=0;r<2*td+1;r++)n.push(new it.Vector(0,0));this.frontFill=new it.Path(n,!0,!1),this.backFill=this.frontFill.clone(),pe.idPlottableDescriptionMap.set(String(this.frontFill.id),{type:"circle",side:"front",fill:!0,part:""}),pe.idPlottableDescriptionMap.set(String(this.backFill.id),{type:"circle",side:"back",fill:!0,part:""}),this.frontFill.noStroke(),this.backFill.noStroke(),this.frontFill.visible=!0,this.backFill.visible=!0,this.frontGradientColor.color=S.circle.drawn.fillColor.front,this.backGradientColor.color=pe.contrastFillColor(S.circle.drawn.fillColor.front),this.styleOptions.set(q.Front,qk),this.styleOptions.set(q.Back,Kk)}static updateCurrentStrokeWidthForZoom(i){Yr.currentCircleStrokeWidthFront*=i,Yr.currentCircleStrokeWidthBack*=i,Yr.currentGlowingCircleStrokeWidthFront*=i,Yr.currentGlowingCircleStrokeWidthBack*=i}updateDisplay(){LT.copy(this._centerVector).normalize(),VT.set(-this._centerVector.y,this._centerVector.x,0).normalize(),tR.crossVectors(LT,VT),bb.makeBasis(VT,tR,LT);const i=Math.cos(this._circleRadius);this.tmpMatrix.makeTranslation(0,0,i*S.boundaryCircle.radius),bb.multiply(this.tmpMatrix),this.tmpMatrix.makeScale(this.projectedRadius,this.projectedRadius,1),bb.multiply(this.tmpMatrix);let n=0,r=0,s=this.frontPart.vertices.length,o=this.backPart.vertices.length,a=-1,l=-1;this.originalVertices.forEach((f,m)=>{if(this.tmpVector.set(f.x,f.y,0),this.tmpVector.applyMatrix4(bb),this.tmpVector.z>0){if(l===-1&&(l=m),n>=s){const g=this.backPart.vertices.pop(),v=this.glowingBackPart.vertices.pop();g&&v&&(this.frontPart.vertices.push(g),this.glowingFrontPart.vertices.push(v),o--,s++)}this.frontPart.vertices[n].x=this.tmpVector.x,this.frontPart.vertices[n].y=this.tmpVector.y,this.glowingFrontPart.vertices[n].x=this.tmpVector.x,this.glowingFrontPart.vertices[n].y=this.tmpVector.y,n++}else{if(a===-1&&(a=m),r>=o){const g=this.frontPart.vertices.pop(),v=this.glowingFrontPart.vertices.pop();g&&v&&(this.backPart.vertices.push(g),this.glowingBackPart.vertices.push(v),s--,o++)}this.backPart.vertices[r].x=this.tmpVector.x,this.backPart.vertices[r].y=this.tmpVector.y,this.glowingBackPart.vertices[r].x=this.tmpVector.x,this.glowingBackPart.vertices[r].y=this.tmpVector.y,r++}}),a<l&&l<=a+o?(this.backPart.vertices.rotate(l),this.glowingBackPart.vertices.rotate(l)):l<a&&a<=l+s&&(this.frontPart.vertices.rotate(a),this.glowingFrontPart.vertices.rotate(a)),this.frontPart.closed=o===0,this.backPart.closed=s===0,this.glowingFrontPart.closed=o===0,this.glowingBackPart.closed=s===0;const c=[];c.push(...this.frontFill.vertices.splice(0)),c.push(...this.backFill.vertices.splice(0)),c.push(...this.fillStorageAnchors.splice(0));let u=0,h=0,d=[];if(o===0&&this._circleRadius<Math.PI/2)this.frontPart.vertices.forEach(f=>{u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=f.x,this.frontFill.vertices[u].y=f.y,u++}),this.fillStorageAnchors.push(...c.splice(0));else if(o!==0&&s!==0){const f=Math.atan2(this.frontPart.vertices[s-1].y,this.frontPart.vertices[s-1].x);let g=Math.atan2(this.frontPart.vertices[0].y,this.frontPart.vertices[0].x)-f;g<0&&(g+=2*Math.PI);const v=[this.frontPart.vertices[s-1].x,this.frontPart.vertices[s-1].y];let p=[-v[1],v[0]];p[0]*this.frontPart.vertices[0].x+p[1]*this.frontPart.vertices[0].y<0&&(p=[-p[0],-p[1]]),this._circleRadius>Math.PI/2&&(p=[-p[0],-p[1]]),d=this.boundaryCircleCoordinates(v,td+1,p,g),this.frontPart.vertices.forEach(b=>{u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=b.x,this.frontFill.vertices[u].y=b.y,u++}),d.forEach(b=>{u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=b[0],this.frontFill.vertices[u].y=b[1],u++}),this.backPart.vertices.forEach(b=>{h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=b.x,this.backFill.vertices[h].y=b.y,h++}),d.reverse().forEach(b=>{h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=b[0],this.backFill.vertices[h].y=b[1],h++}),this.fillStorageAnchors.push(...c.splice(0))}else if(s===0&&this._circleRadius<Math.PI/2)this.backPart.vertices.forEach((f,m)=>{h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=f.x,this.backFill.vertices[h].y=f.y,h++}),this.fillStorageAnchors.push(...c.splice(0));else if(s===0&&this._circleRadius>Math.PI/2){this.originalVertices.reverse().forEach((v,p)=>{p%2===0&&(u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=v.x,this.frontFill.vertices[u].y=v.y,u++)});const f=Math.floor(Math.atan2(this.backPart.vertices[0].y,this.backPart.vertices[0].x).modTwoPi()/(Math.PI/td));this.originalVertices.reverse().rotate(f).forEach((v,p)=>{p%2===0&&(h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=v.x,this.backFill.vertices[h].y=v.y,h++)}),this.originalVertices.rotate(-f);const m=c.pop();m.x=this.backFill.vertices[0].x,m.y=this.backFill.vertices[0].y,this.backFill.vertices.push(m),h++,this.backPart.vertices.forEach((v,p)=>{h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=v.x,this.backFill.vertices[h].y=v.y,h++});const g=c.pop();g.x=this.backFill.vertices.slice(-1)[0].x,g.y=this.backFill.vertices.slice(-1)[0].y,this.backFill.vertices.push(g),this.fillStorageAnchors.push(...c.splice(0))}else if(o===0&&this._circleRadius>Math.PI/2){this.originalVertices.reverse().forEach((v,p)=>{p%2===0&&(h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=v.x,this.backFill.vertices[h].y=v.y,h++)});const f=Math.floor(Math.atan2(this.frontPart.vertices[0].y,this.frontPart.vertices[0].x).modTwoPi()/(Math.PI/td));this.originalVertices.reverse().rotate(f).forEach((v,p)=>{p%2===0&&(u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=v.x,this.frontFill.vertices[u].y=v.y,u++)}),this.originalVertices.rotate(-f);const m=c.pop();m.x=this.frontFill.vertices[0].x,m.y=this.frontFill.vertices[0].y,this.frontFill.vertices.push(m),u++,this.frontPart.vertices.forEach((v,p)=>{u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=v.x,this.frontFill.vertices[u].y=v.y,u++});const g=c.pop();g.x=this.frontPart.vertices[0].x,g.y=this.frontPart.vertices[0].y,this.frontFill.vertices.push(g),this.fillStorageAnchors.push(...c.splice(0))}}boundaryCircleCoordinates(i,n,r,s){const o=new k(i[0],i[1],0).normalize(),a=new k(r[0],r[1],0).normalize(),l=[];for(let c=0;c<n;c++)this.tmpVector.set(0,0,0),this.tmpVector.addScaledVector(o,Math.cos((c+1)*(s/(n+1)))),this.tmpVector.addScaledVector(a,Math.sin((c+1)*(s/(n+1)))),this.tmpVector.normalize().multiplyScalar(S.boundaryCircle.radius),l.push([this.tmpVector.x,this.tmpVector.y]);return l}set centerVector(i){this._centerVector.copy(i)}get centerVector(){return this._centerVector}set circleRadius(i){this._circleRadius=i,this.projectedRadius=Math.sin(i)}get circleRadius(){return this._circleRadius}frontGlowingDisplay(){this.frontPart.visible=!0,this.glowingFrontPart.visible=!0,this.frontFill.visible=!0}backGlowingDisplay(){this.backPart.visible=!0,this.glowingBackPart.visible=!0,this.backFill.visible=!0}glowingDisplay(){this.frontGlowingDisplay(),this.backGlowingDisplay()}frontNormalDisplay(){this.frontPart.visible=!0,this.glowingFrontPart.visible=!1,this.frontFill.visible=!0}backNormalDisplay(){this.backPart.visible=!0,this.glowingBackPart.visible=!1,this.backFill.visible=!0}normalDisplay(){this.frontNormalDisplay(),this.backNormalDisplay()}setVisible(i){i?this.normalDisplay():(this.frontPart.visible=!1,this.backPart.visible=!1,this.frontFill.visible=!1,this.backFill.visible=!1,this.glowingBackPart.visible=!1,this.glowingFrontPart.visible=!1)}setSelectedColoring(i){i?(this.glowingStrokeColorFront=S.style.selectedColor.front,this.glowingStrokeColorBack=S.style.selectedColor.back):(this.glowingStrokeColorFront=S.circle.glowing.strokeColor.front,this.glowingStrokeColorBack=S.circle.glowing.strokeColor.back),this.stylize(Vt.ApplyCurrentVariables)}clone(){const i=new Yr;for(i._centerVector.copy(this._centerVector),i._circleRadius=this._circleRadius,i.frontPart.closed=this.frontPart.closed,i.frontPart.rotation=this.frontPart.rotation,i.frontPart.translation.copy(this.frontPart.translation),i.backPart.closed=this.backPart.closed,i.backPart.rotation=this.backPart.rotation,i.backPart.translation.copy(this.backPart.translation),i.glowingFrontPart.closed=this.glowingFrontPart.closed,i.glowingFrontPart.rotation=this.glowingFrontPart.rotation,i.glowingFrontPart.translation.copy(this.glowingFrontPart.translation),i.glowingBackPart.closed=this.glowingBackPart.closed,i.glowingBackPart.rotation=this.glowingBackPart.rotation,i.glowingBackPart.translation.copy(this.glowingBackPart.translation);i.frontPart.vertices.length>this.frontPart.vertices.length;)i.backPart.vertices.push(i.frontPart.vertices.pop()),i.glowingBackPart.vertices.push(i.glowingFrontPart.vertices.pop());for(;i.backPart.vertices.length>this.backPart.vertices.length;)i.frontPart.vertices.push(i.backPart.vertices.pop()),i.glowingFrontPart.vertices.push(i.glowingBackPart.vertices.pop());i.frontPart.vertices.forEach((r,s)=>{r.copy(this.frontPart.vertices[s])}),i.backPart.vertices.forEach((r,s)=>{r.copy(this.backPart.vertices[s])}),i.glowingFrontPart.vertices.forEach((r,s)=>{r.copy(this.glowingFrontPart.vertices[s])}),i.glowingBackPart.vertices.forEach((r,s)=>{r.copy(this.glowingBackPart.vertices[s])});const n=[];for(n.push(...i.frontFill.vertices.splice(0)),n.push(...i.backFill.vertices.splice(0)),n.push(...i.fillStorageAnchors.splice(0));i.frontFill.vertices.length<this.frontFill.vertices.length;)i.frontFill.vertices.push(n.pop());for(;i.backFill.vertices.length<this.backFill.vertices.length;)i.backFill.vertices.push(n.pop());return i.fillStorageAnchors.push(...n.splice(0)),i.frontFill.vertices.forEach((r,s)=>{r.copy(this.frontFill.vertices[s])}),i.backFill.vertices.forEach((r,s)=>{r.copy(this.backFill.vertices[s])}),i}addToLayers(i){this.frontFill.addTo(i[st.foregroundFills]),this.frontPart.addTo(i[st.foreground]),this.glowingFrontPart.addTo(i[st.foregroundGlowing]),this.backFill.addTo(i[st.backgroundFills]),this.backPart.addTo(i[st.background]),this.glowingBackPart.addTo(i[st.backgroundGlowing])}removeFromLayers(){this.frontPart.remove(),this.frontFill.remove(),this.glowingFrontPart.remove(),this.backPart.remove(),this.backFill.remove(),this.glowingBackPart.remove()}defaultStyleState(i){switch(i){case q.Front:return qk;case q.Back:return{...Kk,strokeWidthPercent:pe.contrastStrokeWidthPercent(100),strokeColor:pe.contrastStrokeColor(S.circle.drawn.strokeColor.front),fillColor:pe.contrastFillColor(S.circle.drawn.fillColor.front)};default:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.strokeWidthPercent)??100,s=(n==null?void 0:n.strokeWidthPercent)??100;this.frontPart.linewidth=Yr.currentCircleStrokeWidthFront*r/100,this.backPart.linewidth=Yr.currentCircleStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingFrontPart.linewidth=Yr.currentGlowingCircleStrokeWidthFront*r/100,this.glowingBackPart.linewidth=Yr.currentGlowingCircleStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100}stylize(i){switch(i){case Vt.ApplyTemporaryVariables:{pe.hslaIsNoFillOrNoStroke(S.circle.temp.fillColor.front)?this.frontFill.noFill():(this.frontGradientColor.color=S.circle.temp.fillColor.front,this.frontFill.fill=this.frontGradient),pe.hslaIsNoFillOrNoStroke(S.circle.temp.strokeColor.front)?this.frontPart.noStroke():this.frontPart.stroke=S.circle.temp.strokeColor.front,this.frontPart.linewidth=Yr.currentCircleStrokeWidthFront,S.circle.drawn.dashArray.front.length>0&&(this.frontPart.dashes.clear(),S.circle.drawn.dashArray.front.forEach(n=>{this.frontPart.dashes.push(n)}),this.frontPart.dashes.reverse()),pe.hslaIsNoFillOrNoStroke(S.circle.temp.fillColor.back)?this.backFill.noFill():(this.backGradientColor.color=S.circle.temp.fillColor.back,this.backFill.fill=this.backGradient),pe.hslaIsNoFillOrNoStroke(S.circle.temp.strokeColor.back)?this.backPart.noStroke():this.backPart.stroke=S.circle.temp.strokeColor.back,this.backPart.linewidth=Yr.currentCircleStrokeWidthBack,S.circle.drawn.dashArray.back.length>0&&(this.backPart.dashes.clear(),S.circle.drawn.dashArray.back.forEach(n=>{this.backPart.dashes.push(n)}),this.backPart.dashes.reverse()),this.glowingFrontPart.visible=!1,this.glowingBackPart.visible=!1;break}case Vt.ApplyCurrentVariables:{const n=this.styleOptions.get(q.Front);pe.hslaIsNoFillOrNoStroke(n==null?void 0:n.fillColor)?this.frontFill.noFill():(this.frontGradientColor.color=(n==null?void 0:n.fillColor)??S.circle.drawn.fillColor.front,this.frontFill.fill=this.frontGradient),pe.hslaIsNoFillOrNoStroke(n==null?void 0:n.strokeColor)?this.frontPart.noStroke():this.frontPart.stroke=(n==null?void 0:n.strokeColor)??S.circle.drawn.strokeColor.front,n!=null&&n.dashArray&&n.dashArray.length>0?(this.frontPart.dashes.clear(),this.frontPart.dashes.push(...n.dashArray)):(this.frontPart.dashes.clear(),this.frontPart.dashes.push(0));const r=this.styleOptions.get(q.Back);r!=null&&r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastFillColor(n==null?void 0:n.fillColor))?this.backFill.noFill():(this.backGradientColor.color=pe.contrastFillColor((n==null?void 0:n.fillColor)??S.circle.drawn.fillColor.back),this.backFill.fill=this.backGradient):pe.hslaIsNoFillOrNoStroke(r==null?void 0:r.fillColor)?this.backFill.noFill():(this.backGradientColor.color=(r==null?void 0:r.fillColor)??S.circle.drawn.fillColor.back,this.backFill.fill=this.backGradient),r!=null&&r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastStrokeColor(n==null?void 0:n.strokeColor))?this.backPart.noStroke():this.backPart.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??S.circle.drawn.strokeColor.front):pe.hslaIsNoFillOrNoStroke(r==null?void 0:r.strokeColor)?this.backPart.noStroke():this.backPart.stroke=(r==null?void 0:r.strokeColor)??S.circle.drawn.strokeColor.back,r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0?(this.backPart.dashes.clear(),this.backPart.dashes.push(...r.dashArray),r.dashArray&&this.backPart.dashes.reverse()):(this.backPart.dashes.clear(),this.backPart.dashes.push(0)),this.glowingFrontPart.stroke=this.glowingStrokeColorFront,n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&n.dashArray.length>0?(this.glowingFrontPart.dashes.clear(),this.glowingFrontPart.dashes.push(...n.dashArray),n.reverseDashArray&&this.glowingFrontPart.dashes.reverse()):(this.glowingFrontPart.dashes.clear(),this.glowingFrontPart.dashes.push(0)),this.glowingBackPart.stroke=this.glowingStrokeColorBack,r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0?(this.glowingBackPart.dashes.clear(),this.glowingBackPart.dashes.push(...r.dashArray),r.reverseDashArray&&this.glowingBackPart.dashes.reverse()):(this.glowingBackPart.dashes.clear(),this.glowingBackPart.dashes.push(0));break}}}};y(Yr,"currentCircleStrokeWidthFront",S.circle.drawn.strokeWidth.front),y(Yr,"currentCircleStrokeWidthBack",S.circle.drawn.strokeWidth.back),y(Yr,"currentGlowingCircleStrokeWidthFront",S.circle.drawn.strokeWidth.front+S.circle.glowing.edgeWidth),y(Yr,"currentGlowingCircleStrokeWidthBack",S.circle.drawn.strokeWidth.back+S.circle.glowing.edgeWidth);let Sa=Yr;const _b=S.segment.numPoints,In=class In extends pe{constructor(){super();y(this,"_startVector",new k);y(this,"_normalVector",new k);y(this,"_arcLength",0);y(this,"_firstVertexIsOnFront",!1);y(this,"_lastVertexIsOnFront",!1);y(this,"transformMatrix",new Pt);y(this,"_frontPart");y(this,"_frontExtra");y(this,"_backPart");y(this,"_backExtra");y(this,"glowingFrontPart");y(this,"glowingFrontExtra");y(this,"glowingBackPart");y(this,"glowingBackExtra");y(this,"glowingStrokeColorFront",S.segment.glowing.strokeColor.front);y(this,"glowingStrokeColorBack",S.segment.glowing.strokeColor.back);y(this,"tmpMatrix",new Pt);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"desiredXAxis",new k);y(this,"desiredYAxis",new k);const i=[];for(let n=0;n<_b;n++)i.push(new it.Vector(0,0));this._frontPart=new it.Path(i,!1,!1),this.glowingFrontPart=this._frontPart.clone(),this._frontExtra=this._frontPart.clone(),this.glowingFrontExtra=this._frontPart.clone(),this._backPart=this._frontPart.clone(),this.glowingBackPart=this._frontPart.clone(),this._backExtra=this._backPart.clone(),this.glowingBackExtra=this._backPart.clone(),this._frontExtra.vertices.splice(0),this.glowingFrontExtra.vertices.splice(0),this._backExtra.vertices.splice(0),this.glowingBackExtra.vertices.splice(0),pe.idPlottableDescriptionMap.set(String(this._frontPart.id),{type:"segment",side:"front",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this._frontExtra.id),{type:"segment",side:"front",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this._backPart.id),{type:"segment",side:"back",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this._backExtra.id),{type:"segment",side:"back",fill:!1,part:""}),this._frontPart.noFill(),this.glowingFrontPart.noFill(),this._backPart.noFill(),this.glowingBackPart.noFill(),this._frontExtra.noFill(),this.glowingFrontExtra.noFill(),this._backExtra.noFill(),this.glowingBackExtra.noFill(),this._frontPart.visible=!0,this.glowingFrontPart.visible=!1,this._backPart.visible=!0,this.glowingBackPart.visible=!1,this._frontExtra.visible=!0,this.glowingFrontExtra.visible=!1,this._backExtra.visible=!0,this.glowingBackExtra.visible=!1,this.styleOptions.set(q.Front,Gk),this.styleOptions.set(q.Back,Hk)}static updateCurrentStrokeWidthForZoom(i){In.currentSegmentStrokeWidthFront*=i,In.currentSegmentStrokeWidthBack*=i,In.currentGlowingSegmentStrokeWidthFront*=i,In.currentGlowingSegmentStrokeWidthBack*=i}frontGlowingDisplay(){this._frontPart.visible=!0,this.glowingFrontPart.visible=!0,this._frontExtra.visible=!0,this.glowingFrontExtra.visible=!0}backGlowingDisplay(){this._backPart.visible=!0,this.glowingBackPart.visible=!0,this._backExtra.visible=!0,this.glowingBackExtra.visible=!0}backNormalDisplay(){this._backPart.visible=!0,this.glowingBackPart.visible=!1,this._backExtra.visible=!0,this.glowingBackExtra.visible=!1}frontNormalDisplay(){this._frontPart.visible=!0,this.glowingFrontPart.visible=!1,this._frontExtra.visible=!0,this.glowingFrontExtra.visible=!1}normalDisplay(){this.frontNormalDisplay(),this.backNormalDisplay()}glowingDisplay(){this.frontGlowingDisplay(),this.backGlowingDisplay()}updateDisplay(){this.desiredXAxis.copy(this._startVector).normalize(),this.desiredYAxis.crossVectors(this._normalVector,this.desiredXAxis).multiplyScalar(this._arcLength>Math.PI?-1:1).normalize(),this.transformMatrix.makeBasis(this.desiredXAxis,this.desiredYAxis,this._normalVector);const i=[],n=[];let r=0,s=0,o=0;const a=[];a.push(...this._frontPart.vertices.splice(0)),a.push(...this._frontExtra.vertices.splice(0)),a.push(...this._backPart.vertices.splice(0)),a.push(...this._backExtra.vertices.splice(0));const l=[];l.push(...this.glowingFrontPart.vertices.splice(0)),l.push(...this.glowingFrontExtra.vertices.splice(0)),l.push(...this.glowingBackPart.vertices.splice(0)),l.push(...this.glowingBackExtra.vertices.splice(0));let c=this._frontPart.vertices,u=this._backPart.vertices,h=this.glowingFrontPart.vertices,d=this.glowingBackPart.vertices;for(let f=0;f<2*_b;f++){const m=f/(2*_b-1)*Math.abs(this._arcLength);this.tmpVector1.set(Math.cos(m),Math.sin(m),0).multiplyScalar(S.boundaryCircle.radius),this.tmpVector1.applyMatrix4(this.transformMatrix);const g=Math.sign(this.tmpVector1.z);if(f===0&&(this._firstVertexIsOnFront=g===1),f===2*_b-1&&(this._lastVertexIsOnFront=g===1),o!==g&&(g>0&&(i.length>0&&(c=this._frontExtra.vertices,h=this.glowingFrontExtra.vertices,r=0),i.push(f)),g<0&&(n.length>0&&(u=this._backExtra.vertices,d=this.glowingBackExtra.vertices,s=0),n.push(f))),o=g,this.tmpVector1.z>0){if(r===c.length){const v=a.pop();v&&c.push(v);const p=l.pop();p&&h.push(p)}c[r].x=this.tmpVector1.x,c[r].y=this.tmpVector1.y,h[r].x=this.tmpVector1.x,h[r].y=this.tmpVector1.y,r++}else{if(s===u.length){const v=a.pop();v&&u.push(v);const p=l.pop();p&&d.push(p)}u[s].x=this.tmpVector1.x,u[s].y=this.tmpVector1.y,d[s].x=this.tmpVector1.x,d[s].y=this.tmpVector1.y,s++}}}set arcLength(i){this._arcLength=i}set startVector(i){this._startVector.copy(i).normalize()}set normalVector(i){this._normalVector.copy(i).normalize()}get frontPart(){return this._frontPart}get backPart(){return this._backPart}get frontPartExtra(){return this._frontExtra}get backPartExtra(){return this._backExtra}get firstVertexIsOnFront(){return this._firstVertexIsOnFront}get lastVertexIsOnFront(){return this._lastVertexIsOnFront}setVisible(i){i?this.normalDisplay():(this._frontPart.visible=!1,this.glowingFrontPart.visible=!1,this._frontExtra.visible=!1,this.glowingFrontExtra.visible=!1,this._backPart.visible=!1,this.glowingBackPart.visible=!1,this._backExtra.visible=!1,this.glowingBackExtra.visible=!1)}setSelectedColoring(i){i?(this.glowingStrokeColorFront=S.style.selectedColor.front,this.glowingStrokeColorBack=S.style.selectedColor.back):(this.glowingStrokeColorFront=S.segment.glowing.strokeColor.front,this.glowingStrokeColorBack=S.segment.glowing.strokeColor.back),this.stylize(Vt.ApplyCurrentVariables)}clone(){const i=new In;i._arcLength=this._arcLength,i._startVector.copy(this._startVector),i._normalVector.copy(this._normalVector);const n=[];n.push(...i._frontPart.vertices.splice(0)),n.push(...i._backPart.vertices.splice(0)),this._frontPart.vertices.forEach((s,o)=>{const a=n.pop();a&&i._frontPart.vertices.push(a),i._frontPart.vertices[o].copy(s)}),this._frontExtra.vertices.forEach((s,o)=>{const a=n.pop();a&&i._frontExtra.vertices.push(a),i._frontExtra.vertices[o].copy(s)}),this._backPart.vertices.forEach((s,o)=>{const a=n.pop();a&&i._backPart.vertices.push(a),i._backPart.vertices[o].copy(s)}),this._backExtra.vertices.forEach((s,o)=>{const a=n.pop();a&&i._backExtra.vertices.push(a),i._backExtra.vertices[o].copy(s)});const r=[];return r.push(...i.glowingFrontPart.vertices.splice(0)),r.push(...i.glowingBackPart.vertices.splice(0)),this.glowingFrontPart.vertices.forEach((s,o)=>{const a=r.pop();a&&i.glowingFrontPart.vertices.push(a),i.glowingFrontPart.vertices[o].copy(s)}),this.glowingFrontExtra.vertices.forEach((s,o)=>{const a=r.pop();a&&i.glowingFrontExtra.vertices.push(a),i.glowingFrontExtra.vertices[o].copy(s)}),this.glowingBackPart.vertices.forEach((s,o)=>{const a=r.pop();a&&i.glowingBackPart.vertices.push(a),i.glowingBackPart.vertices[o].copy(s)}),this.glowingBackExtra.vertices.forEach((s,o)=>{const a=r.pop();a&&i.glowingBackExtra.vertices.push(a),i.glowingBackExtra.vertices[o].copy(s)}),i}addToLayers(i){this._frontPart.addTo(i[st.foreground]),this._frontExtra.addTo(i[st.foreground]),this._backPart.addTo(i[st.background]),this._backExtra.addTo(i[st.background]),this.glowingFrontPart.addTo(i[st.foregroundGlowing]),this.glowingFrontExtra.addTo(i[st.foregroundGlowing]),this.glowingBackPart.addTo(i[st.backgroundGlowing]),this.glowingBackExtra.addTo(i[st.backgroundGlowing])}removeFromLayers(){this._frontPart.remove(),this._frontExtra.remove(),this._backPart.remove(),this._backExtra.remove(),this.glowingFrontPart.remove(),this.glowingFrontExtra.remove(),this.glowingBackPart.remove(),this.glowingBackExtra.remove()}defaultStyleState(i){switch(i){case q.Front:return Gk;case q.Back:return Hk;default:case q.Label:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.strokeWidthPercent)??100,s=(n==null?void 0:n.strokeWidthPercent)??100;this._frontPart.linewidth=In.currentSegmentStrokeWidthFront*r/100,this._backPart.linewidth=In.currentSegmentStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingFrontPart.linewidth=In.currentGlowingSegmentStrokeWidthFront*r/100,this.glowingBackPart.linewidth=In.currentGlowingSegmentStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this._frontExtra.linewidth=In.currentSegmentStrokeWidthFront*r/100,this._backExtra.linewidth=In.currentSegmentStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingFrontExtra.linewidth=In.currentGlowingSegmentStrokeWidthFront*r/100,this.glowingBackExtra.linewidth=In.currentGlowingSegmentStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100}stylize(i){switch(i){case Vt.ApplyTemporaryVariables:{this._frontPart.stroke=S.segment.temp.strokeColor.front,this._frontPart.linewidth=In.currentSegmentStrokeWidthFront,S.segment.drawn.dashArray.front.length>0&&(this._frontPart.dashes.clear(),S.segment.drawn.dashArray.front.forEach(n=>{this._frontPart.dashes.push(n)}),this._frontPart.dashes.reverse()),this._frontExtra.stroke=S.segment.temp.strokeColor.front,this._frontExtra.linewidth=In.currentSegmentStrokeWidthFront,S.segment.drawn.dashArray.front.length>0&&(this._frontExtra.dashes.clear(),S.segment.drawn.dashArray.front.forEach(n=>{this._frontExtra.dashes.push(n)}),this._frontExtra.dashes.reverse()),this._backPart.stroke=S.segment.temp.strokeColor.back,this._backPart.linewidth=In.currentSegmentStrokeWidthBack,S.segment.drawn.dashArray.back.length>0&&(this._backPart.dashes.clear(),S.segment.drawn.dashArray.back.forEach(n=>{this._backPart.dashes.push(n)}),this._backPart.dashes.reverse()),this._backExtra.stroke=S.segment.temp.strokeColor.back,this._backExtra.linewidth=In.currentSegmentStrokeWidthBack,S.segment.drawn.dashArray.back.length>0&&(this._backExtra.dashes.clear(),S.segment.drawn.dashArray.back.forEach(n=>{this._backExtra.dashes.push(n)}),this._backExtra.dashes.reverse()),this.glowingFrontPart.visible=!1,this.glowingBackPart.visible=!1,this.glowingFrontExtra.visible=!1,this.glowingBackExtra.visible=!1;break}case Vt.ApplyCurrentVariables:{const n=this.styleOptions.get(q.Front);pe.hslaIsNoFillOrNoStroke(n==null?void 0:n.strokeColor)?this._frontPart.noStroke():this._frontPart.stroke=(n==null?void 0:n.strokeColor)??S.segment.drawn.strokeColor.front,n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&n.dashArray.length>0?(this._frontPart.dashes.clear(),this._frontPart.dashes.push(...n.dashArray),n.reverseDashArray&&this._frontPart.dashes.reverse()):(this._frontPart.dashes.clear(),this._frontPart.dashes.push(0)),pe.hslaIsNoFillOrNoStroke(n==null?void 0:n.strokeColor)?this._frontExtra.noStroke():this._frontExtra.stroke=(n==null?void 0:n.strokeColor)??S.segment.drawn.strokeColor.front,n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&n.dashArray.length>0?(this._frontExtra.dashes.clear(),this._frontExtra.dashes.push(...n.dashArray),n.reverseDashArray&&this._frontExtra.dashes.reverse()):(this._frontExtra.dashes.clear(),this._frontExtra.dashes.push(0));const r=this.styleOptions.get(q.Back);r!=null&&r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastStrokeColor(n==null?void 0:n.strokeColor))?this._backPart.noStroke():this._backPart.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"):pe.hslaIsNoFillOrNoStroke(r==null?void 0:r.strokeColor)?this._backPart.noStroke():this._backPart.stroke=(r==null?void 0:r.strokeColor)??S.segment.drawn.strokeColor.back,r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0?(this._backPart.dashes.clear(),this._backPart.dashes.push(...r.dashArray),r.reverseDashArray&&this._backPart.dashes.reverse()):(this._backPart.dashes.clear(),this._backPart.dashes.push(0)),r!=null&&r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastStrokeColor(n==null?void 0:n.strokeColor))?this._backExtra.noStroke():this._backExtra.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"):pe.hslaIsNoFillOrNoStroke(r==null?void 0:r.strokeColor)?this._backExtra.noStroke():this._backExtra.stroke=(r==null?void 0:r.strokeColor)??S.segment.drawn.strokeColor.back,r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0?(this._backExtra.dashes.clear(),this._backExtra.dashes.push(...r.dashArray),r.reverseDashArray&&this._backExtra.dashes.reverse()):(this._backExtra.dashes.clear(),this._backExtra.dashes.push(0)),this.glowingFrontPart.stroke=this.glowingStrokeColorFront,n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&n.dashArray.length>0?(this.glowingFrontPart.dashes.clear(),this.glowingFrontPart.dashes.push(...n.dashArray),n.reverseDashArray&&this.glowingFrontPart.dashes.reverse()):(this.glowingFrontPart.dashes.clear(),this.glowingFrontPart.dashes.push(0)),this.glowingFrontExtra.stroke=this.glowingStrokeColorFront,n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&n.dashArray.length>0?(this.glowingFrontExtra.dashes.clear(),this.glowingFrontExtra.dashes.push(...n.dashArray),n.reverseDashArray&&this.glowingFrontExtra.dashes.reverse()):(this.glowingFrontExtra.dashes.clear(),this.glowingFrontExtra.dashes.push(0)),this.glowingBackPart.stroke=this.glowingStrokeColorBack,r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0?(this.glowingBackPart.dashes.clear(),this.glowingBackPart.dashes.push(...r.dashArray),r.reverseDashArray&&this.glowingBackPart.dashes.reverse()):(this.glowingBackPart.dashes.clear(),this.glowingBackPart.dashes.push(0)),this.glowingBackExtra.stroke=this.glowingStrokeColorBack,r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0?(this.glowingBackExtra.dashes.clear(),this.glowingBackExtra.dashes.push(...r.dashArray),r.reverseDashArray&&this.glowingBackExtra.dashes.reverse()):(this.glowingBackExtra.dashes.clear(),this.glowingBackExtra.dashes.push(0));break}}}};y(In,"currentSegmentStrokeWidthFront",S.segment.drawn.strokeWidth.front),y(In,"currentSegmentStrokeWidthBack",S.segment.drawn.strokeWidth.back),y(In,"currentGlowingSegmentStrokeWidthFront",S.segment.drawn.strokeWidth.front+S.segment.glowing.edgeWidth),y(In,"currentGlowingSegmentStrokeWidthBack",S.segment.drawn.strokeWidth.back+S.segment.glowing.edgeWidth);let Ws=In;class yle extends Ws{constructor(){super();y(this,"nonFreeSegmentScalePercent",S.segment.nonFree.scalePercent);this.styleOptions.set(q.Front,IN),this.styleOptions.set(q.Back,ON)}defaultStyleState(i){switch(i){case q.Front:return IN;case q.Back:return{...ON,strokeWidthPercent:pe.contrastStrokeWidthPercent(this.nonFreeSegmentScalePercent),strokeColor:pe.contrastStrokeColor(S.segment.drawn.strokeColor.front)};default:case q.Label:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.strokeWidthPercent)??100,s=(n==null?void 0:n.strokeWidthPercent)??100;this.frontPart.linewidth=Ws.currentSegmentStrokeWidthFront*r/100*this.nonFreeSegmentScalePercent/100,this.backPart.linewidth=Ws.currentSegmentStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100*this.nonFreeSegmentScalePercent/100,this.glowingFrontPart.linewidth=Ws.currentGlowingSegmentStrokeWidthFront*r/100*this.nonFreeSegmentScalePercent/100,this.glowingBackPart.linewidth=Ws.currentGlowingSegmentStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100*this.nonFreeSegmentScalePercent/100,this._frontExtra.linewidth=Ws.currentSegmentStrokeWidthFront*r/100*this.nonFreeSegmentScalePercent/100,this._backExtra.linewidth=Ws.currentSegmentStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100*this.nonFreeSegmentScalePercent/100,this.glowingFrontExtra.linewidth=Ws.currentGlowingSegmentStrokeWidthFront*r/100*this.nonFreeSegmentScalePercent/100,this.glowingBackExtra.linewidth=Ws.currentGlowingSegmentStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100*this.nonFreeSegmentScalePercent/100}}_e.global;const Sle=new Set([...Object.getOwnPropertyNames(Gk),...Object.getOwnPropertyNames(Hk)]);class Jt extends Xe{constructor(i,n,r,s,o=!1){super();y(this,"label");y(this,"_startSEPoint");y(this,"_endSEPoint");y(this,"_normalVector",new k);y(this,"_arcLength",0);y(this,"_nearlyAntipodal",!1);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"tmpVector3",new k);y(this,"desiredZAxis",new k);y(this,"toVector",new k);this.ref=o?new yle:new Ws,this.ref._startVector.copy(i.locationVector),this.ref._normalVector.copy(n),this.ref.arcLength=r,this.ref.stylize(Vt.ApplyCurrentVariables),this.ref.adjustSize(),this._startSEPoint=i,this._normalVector.copy(n),this._arcLength=r,this._endSEPoint=s,Xe.SEGMENT_COUNT++,this.name=`Ls${Xe.SEGMENT_COUNT}`}customStyles(){return Sle}accept(i){return i.actionOnSegment(this)}get nearlyAntipodal(){return this._nearlyAntipodal}get startSEPoint(){return this._startSEPoint}get endSEPoint(){return this._endSEPoint}set normalVector(i){this._normalVector.copy(i)}get normalVector(){return this._normalVector}get arcLength(){return this._arcLength}set arcLength(i){this._arcLength=i}get longerThanPi(){return this._arcLength>Math.PI}get noduleDescription(){var i,n;return String(_e.global.t("objectTree.segmentThrough",{pt1:(i=this._startSEPoint.label)==null?void 0:i.ref.shortUserName,pt2:(n=this._endSEPoint.label)==null?void 0:n.ref.shortUserName,normalX:this._normalVector.x.toFixed(S.decimalPrecision),normalY:this._normalVector.y.toFixed(S.decimalPrecision),normalZ:this._normalVector.z.toFixed(S.decimalPrecision)}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SELine"}isHitAt(i,n,r){return Math.abs(i.dot(this._normalVector))>S.segment.hitIdealDistance/(r||1)/n?!1:(this.tmpVector.copy(this.getMidPointVector()),this.tmpVector.angleTo(i)<this._arcLength/2)}onSegment(i){return i.isZero(S.tolerance)?!1:this.tmpVector.subVectors(this.startSEPoint.locationVector,i).isZero(S.tolerance/1e4)||this.tmpVector.subVectors(this.endSEPoint.locationVector,i).isZero(S.tolerance/1e4)?!0:(this.tmpVector.copy(this.getMidPointVector()),this.tmpVector.angleTo(i)<=this._arcLength/2)}closestVector(i){return this.tmpVector1.crossVectors(this._normalVector,i),this.tmpVector1.isZero(S.nearlyAntipodalIdeal)?this._endSEPoint.locationVector:(this.tmpVector1.normalize(),this.tmpVector1.cross(this._normalVector).normalize(),this.onSegment(this.tmpVector1)?this.tmpVector1:this.tmpVector1.angleTo(this._startSEPoint.locationVector)<this.tmpVector1.angleTo(this._endSEPoint.locationVector)?this._startSEPoint.locationVector:this._endSEPoint.locationVector)}getNormalsToPerpendicularLinesThru(i,n){this.tmpVector1.crossVectors(i,this._normalVector),this.tmpVector2.crossVectors(this.tmpVector1,this._normalVector),this.tmpVector3.copy(this.tmpVector2).multiplyScalar(-1),this.tmpVector1.isZero(S.nearlyAntipodalIdeal)&&this.tmpVector1.copy(n);const r=[];return this.onSegment(this.tmpVector2)&&r.push({normal:this.tmpVector1.normalize(),normalAt:this.tmpVector2.normalize()}),this.onSegment(this.tmpVector3)&&r.push({normal:this.tmpVector1.normalize(),normalAt:this.tmpVector3.normalize()}),r}shallowUpdate(){if(this._exists=this._startSEPoint.exists&&this._endSEPoint.exists,this._exists){this.tmpVector.crossVectors(this._startSEPoint.locationVector,this._endSEPoint.locationVector),this.tmpVector.isZero(S.nearlyAntipodalIdeal)&&(this._normalVector.length()===0?(this.tmpVector.set(1,0,0),this.tmpVector.crossVectors(this._startSEPoint.locationVector,this.tmpVector),this.tmpVector.isZero()&&(this.tmpVector.set(0,1,0),this.tmpVector.crossVectors(this._startSEPoint.locationVector,this.tmpVector))):(this.tmpVector.crossVectors(this._startSEPoint.locationVector,this._normalVector),this.tmpVector.crossVectors(this.tmpVector,this._startSEPoint.locationVector))),this._normalVector.copy(this.tmpVector.normalize());let i=this._arcLength>Math.PI;this._arcLength=this._startSEPoint.locationVector.angleTo(this._endSEPoint.locationVector),this._startSEPoint.locationVector.angleTo(this._endSEPoint.locationVector)>2&&(this.tmpVector.crossVectors(this._endSEPoint.locationVector,this._startSEPoint.locationVector).isZero(S.nearlyAntipodalIdeal)?this._nearlyAntipodal=!0:(this._nearlyAntipodal&&(i=!i),this._nearlyAntipodal=!1)),i&&(this._arcLength=2*Math.PI-this._arcLength),this.ref.startVector=this._startSEPoint.locationVector,this.ref.arcLength=this._arcLength,this.ref.normalVector=this._normalVector,this.ref.updateDisplay()}this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Segment with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id);const r=new k;r.copy(this._normalVector),i.set(this.id,{kind:"segment",object:this,normalVector:r,arcLength:this.arcLength})}this.updateKids(i,n)}}closestLabelLocationVector(i){this.tmpVector.copy(this.closestVector(i));const n=Xe.store.zoomMagnificationFactor;return this.tmpVector.angleTo(i)<S.segment.maxLabelDistance/n?i:(this.tmpVector1.crossVectors(i,this.tmpVector).normalize(),this.tmpVector2.crossVectors(this.tmpVector,this.tmpVector1).normalize,this.tmpVector2.multiplyScalar(Math.sin(S.segment.maxLabelDistance/n)),this.tmpVector2.addScaledVector(this.tmpVector,Math.cos(S.segment.maxLabelDistance/n)).normalize())}getMidPointVector(){const i=new k;return this.toVector.crossVectors(this._normalVector,this._startSEPoint.locationVector),this._arcLength>Math.PI?this.toVector.dot(this._endSEPoint.locationVector)>0&&this.toVector.multiplyScalar(-1):this._arcLength<Math.PI&&this.toVector.dot(this._endSEPoint.locationVector)<0&&this.toVector.multiplyScalar(-1),i.copy(this._startSEPoint.locationVector).multiplyScalar(Math.cos(this._arcLength/2)),i.addScaledVector(this.toVector,Math.sin(this._arcLength/2)),i.normalize()}move(i,n,r,s){let o;if(s)o=i.angleTo(n),o>S.rotate.minAngle&&(this.desiredZAxis.crossVectors(i,n).normalize(),this.tmpVector1.copy(this.startSEPoint.locationVector).applyAxisAngle(this.desiredZAxis,o),this.startSEPoint.locationVector=this.tmpVector1,this.tmpVector2.copy(this.endSEPoint.locationVector).applyAxisAngle(this.desiredZAxis,o),this.endSEPoint.locationVector=this.tmpVector2,this.endSEPoint.markKidsOutOfDate(),this.startSEPoint.markKidsOutOfDate(),this.endSEPoint.update(),this.startSEPoint.update());else{let a=this.startSEPoint,l=this.endSEPoint;r&&(a=this.endSEPoint,l=this.startSEPoint),this.tmpVector1.crossVectors(a.locationVector,i).normalize(),this.tmpVector2.crossVectors(a.locationVector,n).normalize(),o=this.tmpVector1.angleTo(this.tmpVector2),this.tmpVector1.cross(this.tmpVector2),o*=Math.sign(this.tmpVector1.z),n.z<0&&(o*=-1),n.z*a.locationVector.z<0&&(o*=-1);const c=a.locationVector;this.tmpVector1.crossVectors(l.locationVector,a.locationVector).isZero(S.nearlyAntipodalIdeal)?(o*=n.z<0?-1:1,this.tmpVector1.copy(this.normalVector),this.tmpVector1.applyAxisAngle(c,o),this.normalVector=this.tmpVector1,this.markKidsOutOfDate(),this.update()):(this.tmpVector1.copy(l.locationVector),this.tmpVector1.applyAxisAngle(c,o),l.locationVector=this.tmpVector1,l.markKidsOutOfDate(),a.markKidsOutOfDate(),l.update(),a.update())}}isOneDimensional(){return!0}isSegmentOfLengthPi(){return Math.abs(this._arcLength-Math.PI)<S.segment.closeEnoughToPi}isLabelable(){return!0}isMeasurable(){return!0}}const Wf=S.line.numPoints,Zr=class Zr extends pe{constructor(){super();y(this,"_normalVector");y(this,"frontHalf");y(this,"backHalf");y(this,"glowingFrontHalf");y(this,"glowingBackHalf");y(this,"points");y(this,"glowingStrokeColorFront",S.line.glowing.strokeColor.front);y(this,"glowingStrokeColorBack",S.line.glowing.strokeColor.back);y(this,"tmpVector",new k);y(this,"desiredXAxis",new k);y(this,"desiredYAxis",new k);y(this,"transformMatrix",new Pt);const i=S.boundaryCircle.radius,n=[],r=[];for(let s=0;s<Wf;s++){const o=s*Math.PI/Wf,a=i*Math.cos(o),l=i*Math.sin(o);n.push(new it.Vector(a,l)),r.push(new it.Vector(a,l))}this.frontHalf=new it.Path(n,!1,!1),this.backHalf=this.frontHalf.clone(),this.glowingBackHalf=this.frontHalf.clone(),this.glowingFrontHalf=this.frontHalf.clone(),pe.idPlottableDescriptionMap.set(String(this.frontHalf.id),{type:"line",side:"front",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.backHalf.id),{type:"line",side:"back",fill:!1,part:""}),this.frontHalf.visible=!0,this.backHalf.visible=!0,this.glowingFrontHalf.visible=!1,this.glowingBackHalf.visible=!1,this.frontHalf.noFill(),this.glowingFrontHalf.noFill(),this.backHalf.noFill(),this.glowingBackHalf.noFill(),this._normalVector=new k,this.points=[];for(let s=0;s<2*Wf;s++){const o=2*s*Math.PI/(2*Wf),a=i*Math.cos(o),l=i*Math.sin(o);this.points.push(new k(a,l,0))}this.styleOptions.set(q.Front,Bv),this.styleOptions.set(q.Back,jv)}static updateCurrentStrokeWidthForZoom(i){Zr.currentLineStrokeWidthFront*=i,Zr.currentLineStrokeWidthBack*=i,Zr.currentGlowingLineStrokeWidthFront*=i,Zr.currentGlowingLineStrokeWidthBack*=i}frontGlowingDisplay(){this.frontHalf.visible=!0,this.glowingFrontHalf.visible=!0}backGlowingDisplay(){this.backHalf.visible=!0,this.glowingBackHalf.visible=!0}glowingDisplay(){this.frontGlowingDisplay(),this.backGlowingDisplay()}frontNormalDisplay(){this.frontHalf.visible=!0,this.glowingFrontHalf.visible=!1}backNormalDisplay(){this.backHalf.visible=!0,this.glowingBackHalf.visible=!1}normalDisplay(){this.frontNormalDisplay(),this.backNormalDisplay()}updateDisplay(){this.desiredXAxis.set(-this._normalVector.y,this._normalVector.x,0).normalize(),this.desiredYAxis.crossVectors(this._normalVector,this.desiredXAxis).normalize,this.transformMatrix.makeBasis(this.desiredXAxis,this.desiredYAxis,this._normalVector);let i=-1,n=0,r=-1,s=0,o=0;this.points.forEach((a,l)=>{this.tmpVector.copy(a),this.tmpVector.applyMatrix4(this.transformMatrix);const c=Math.sign(this.tmpVector.z);if(o!==c&&(c>0&&(i=l),c<0&&(r=l)),o=c,this.tmpVector.z>0){if(n===this.frontHalf.vertices.length){let u;u=this.backHalf.vertices.pop(),u&&this.frontHalf.vertices.push(u),u=this.glowingBackHalf.vertices.pop(),u&&this.glowingFrontHalf.vertices.push(u)}this.frontHalf.vertices[n].x=this.tmpVector.x,this.frontHalf.vertices[n].y=this.tmpVector.y,this.glowingFrontHalf.vertices[n].x=this.tmpVector.x,this.glowingFrontHalf.vertices[n].y=this.tmpVector.y,n++}else{if(s===this.backHalf.vertices.length){let u;u=this.frontHalf.vertices.pop(),u&&this.backHalf.vertices.push(u),u=this.glowingFrontHalf.vertices.pop(),u&&this.glowingBackHalf.vertices.push(u)}this.backHalf.vertices[s].x=this.tmpVector.x,this.backHalf.vertices[s].y=this.tmpVector.y,this.glowingBackHalf.vertices[s].x=this.tmpVector.x,this.glowingBackHalf.vertices[s].y=this.tmpVector.y,s++}}),0<i&&i<Wf&&(this.backHalf.vertices.rotate(i),this.glowingBackHalf.vertices.rotate(i)),0<r&&r<Wf&&(this.frontHalf.vertices.rotate(r),this.glowingFrontHalf.vertices.rotate(r))}set normalVector(i){this._normalVector.copy(i).normalize(),this.updateDisplay()}setVisible(i){i?this.normalDisplay():(this.frontHalf.visible=!1,this.glowingFrontHalf.visible=!1,this.backHalf.visible=!1,this.glowingBackHalf.visible=!1)}setSelectedColoring(i){i?(this.glowingStrokeColorFront=S.style.selectedColor.front,this.glowingStrokeColorBack=S.style.selectedColor.back):(this.glowingStrokeColorFront=S.line.glowing.strokeColor.front,this.glowingStrokeColorBack=S.line.glowing.strokeColor.back),this.stylize(Vt.ApplyCurrentVariables)}clone(){const i=new Zr;return i._normalVector.copy(this._normalVector),i.frontHalf.rotation=this.frontHalf.rotation,i.backHalf.rotation=this.backHalf.rotation,i.frontHalf.vertices.forEach((n,r)=>{n.copy(this.frontHalf.vertices[r])}),i.backHalf.vertices.forEach((n,r)=>{n.copy(this.backHalf.vertices[r])}),i.glowingFrontHalf.vertices.forEach((n,r)=>{n.copy(this.glowingFrontHalf.vertices[r])}),i.glowingBackHalf.vertices.forEach((n,r)=>{n.copy(this.glowingBackHalf.vertices[r])}),i}addToLayers(i){this.frontHalf.addTo(i[st.foreground]),this.glowingFrontHalf.addTo(i[st.foregroundGlowing]),this.backHalf.addTo(i[st.background]),this.glowingBackHalf.addTo(i[st.backgroundGlowing])}removeFromLayers(){this.frontHalf.remove(),this.backHalf.remove(),this.glowingFrontHalf.remove(),this.glowingBackHalf.remove()}defaultStyleState(i){switch(i){case q.Front:return Bv;case q.Back:return{...jv,strokeWidthPercent:pe.contrastStrokeWidthPercent(100),strokeColor:pe.contrastStrokeColor(S.line.drawn.strokeColor.front)};default:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.strokeWidthPercent)??100,s=(n==null?void 0:n.strokeWidthPercent)??100;this.frontHalf.linewidth=Zr.currentLineStrokeWidthFront*r/100,this.backHalf.linewidth=Zr.currentLineStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingFrontHalf.linewidth=Zr.currentGlowingLineStrokeWidthFront*r/100,this.glowingBackHalf.linewidth=Zr.currentGlowingLineStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100}stylize(i){switch(i){case Vt.ApplyTemporaryVariables:{pe.hslaIsNoFillOrNoStroke(S.line.temp.strokeColor.front)?this.frontHalf.noStroke():this.frontHalf.stroke=S.line.temp.strokeColor.front,this.frontHalf.linewidth=Zr.currentLineStrokeWidthFront,S.line.drawn.dashArray.front.length>0&&(this.frontHalf.dashes.clear(),S.line.drawn.dashArray.front.forEach(n=>{this.frontHalf.dashes.push(n)}),this.frontHalf.dashes.reverse()),pe.hslaIsNoFillOrNoStroke(S.line.temp.strokeColor.back)?this.backHalf.noStroke():this.backHalf.stroke=S.line.temp.strokeColor.back,this.backHalf.linewidth=Zr.currentLineStrokeWidthBack,S.line.drawn.dashArray.back.length>0&&(this.backHalf.dashes.clear(),S.line.drawn.dashArray.back.forEach(n=>{this.backHalf.dashes.push(n)}),this.backHalf.dashes.reverse()),this.glowingFrontHalf.visible=!1,this.glowingBackHalf.visible=!1;break}case Vt.ApplyCurrentVariables:{const n=this.styleOptions.get(q.Front);pe.hslaIsNoFillOrNoStroke(n==null?void 0:n.strokeColor)?this.frontHalf.noStroke():this.frontHalf.stroke=(n==null?void 0:n.strokeColor)??"black",n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&(n==null?void 0:n.dashArray.length)>0?(this.frontHalf.dashes.clear(),this.frontHalf.dashes.push(...n==null?void 0:n.dashArray),n.reverseDashArray&&this.frontHalf.dashes.reverse()):(this.frontHalf.dashes.clear(),this.frontHalf.dashes.push(0));const r=this.styleOptions.get(q.Back);r!=null&&r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastStrokeColor(n==null?void 0:n.strokeColor))?this.backHalf.noStroke():this.backHalf.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"):pe.hslaIsNoFillOrNoStroke(r==null?void 0:r.strokeColor)?this.backHalf.noStroke():this.backHalf.stroke=(r==null?void 0:r.strokeColor)??"black",r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0?(this.backHalf.dashes.clear(),this.backHalf.dashes.push(...r.dashArray),r.reverseDashArray&&this.backHalf.dashes.reverse()):(this.backHalf.dashes.clear(),this.backHalf.dashes.push(0)),this.glowingFrontHalf.stroke=this.glowingStrokeColorFront,n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&(n==null?void 0:n.dashArray.length)>0?(this.glowingFrontHalf.dashes.clear(),this.glowingFrontHalf.dashes.push(...n==null?void 0:n.dashArray),n.reverseDashArray&&this.glowingFrontHalf.dashes.reverse()):(this.glowingFrontHalf.dashes.clear(),this.glowingFrontHalf.dashes.push(0)),this.glowingBackHalf.stroke=this.glowingStrokeColorBack,r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0?(this.glowingBackHalf.dashes.clear(),this.glowingBackHalf.dashes.push(...r.dashArray),r.reverseDashArray&&this.glowingBackHalf.dashes.reverse()):(this.glowingBackHalf.dashes.clear(),this.glowingBackHalf.dashes.push(0));break}}}};y(Zr,"currentLineStrokeWidthFront",S.line.drawn.strokeWidth.front),y(Zr,"currentLineStrokeWidthBack",S.line.drawn.strokeWidth.back),y(Zr,"currentGlowingLineStrokeWidthFront",S.line.drawn.strokeWidth.front+S.line.glowing.edgeWidth),y(Zr,"currentGlowingLineStrokeWidthBack",S.line.drawn.strokeWidth.back+S.line.glowing.edgeWidth);let _s=Zr;class g5 extends _s{constructor(){super();y(this,"nonFreeLineScalePercent",S.line.nonFree.scalePercent);this.stylize(Vt.ApplyCurrentVariables),this.adjustSize(),this.styleOptions.set(q.Front,VN),this.styleOptions.set(q.Back,LN)}defaultStyleState(i){switch(i){case q.Front:return VN;case q.Back:return{...LN,strokeWidthPercent:pe.contrastStrokeWidthPercent(this.nonFreeLineScalePercent),strokeColor:pe.contrastStrokeColor(S.line.nonFree.strokeColor.front)};default:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.strokeWidthPercent)??100,s=(n==null?void 0:n.strokeWidthPercent)??100;this.frontHalf.linewidth=_s.currentLineStrokeWidthFront*r/100*(this.nonFreeLineScalePercent/100),this.backHalf.linewidth=_s.currentLineStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100*(this.nonFreeLineScalePercent/100),this.glowingFrontHalf.linewidth=_s.currentGlowingLineStrokeWidthFront*r/100*(this.nonFreeLineScalePercent/100),this.glowingBackHalf.linewidth=_s.currentGlowingLineStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100*(this.nonFreeLineScalePercent/100)}}const ble=new Set([...Object.getOwnPropertyNames(Bv),...Object.getOwnPropertyNames(jv)]);_e.global;class $t extends Xe{constructor(i,n,r,s=!1){super();y(this,"label");y(this,"_startSEPoint");y(this,"_endSEPoint");y(this,"_normalVector",new k);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"tmpVector3",new k);y(this,"desiredZAxis",new k);this.ref=s?new g5:new _s,this.ref.normalVector=n,this.ref.updateDisplay(),this.ref.stylize(Vt.ApplyCurrentVariables),this.ref.adjustSize(),this._startSEPoint=i,this._normalVector.copy(n),this._endSEPoint=r,$t.LINE_COUNT++,this.name=`Li${$t.LINE_COUNT}`}customStyles(){return ble}accept(i){return i.actionOnLine(this)}get nearlyAntipodal(){return this.tmpVector.crossVectors(this._endSEPoint.locationVector,this._startSEPoint.locationVector).isZero(S.nearlyAntipodalIdeal)}get normalVector(){return this._normalVector}set normalVector(i){this._normalVector.copy(i)}get startSEPoint(){return this._startSEPoint}get endSEPoint(){return this._endSEPoint}get noduleDescription(){var i,n;return String(_e.global.t("objectTree.lineThrough",{pt1:(i=this._startSEPoint.label)==null?void 0:i.ref.shortUserName,pt2:(n=this._endSEPoint.label)==null?void 0:n.ref.shortUserName,normalX:this._normalVector.x.toFixed(S.decimalPrecision),normalY:this._normalVector.y.toFixed(S.decimalPrecision),normalZ:this._normalVector.z.toFixed(S.decimalPrecision)}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SELine"}isHitAt(i,n){return Math.abs(i.dot(this._normalVector))<S.line.hitIdealDistance/n}closestVector(i){return this.tmpVector.crossVectors(this._normalVector,i),this.tmpVector.isZero(S.nearlyAntipodalIdeal)?this._endSEPoint.locationVector:(this.tmpVector.normalize(),this.tmpVector.cross(this._normalVector).normalize())}closestLabelLocationVector(i,n){return this.tmpVector.copy(this.closestVector(i)),this.tmpVector.angleTo(i)<S.line.maxLabelDistance/n?i:(this.tmpVector1.crossVectors(i,this.tmpVector).normalize(),this.tmpVector2.crossVectors(this.tmpVector,this.tmpVector1).normalize,this.tmpVector2.multiplyScalar(Math.sin(S.line.maxLabelDistance/n)),this.tmpVector2.addScaledVector(this.tmpVector,Math.cos(S.line.maxLabelDistance/n)).normalize())}getNormalsToPerpendicularLinesThru(i,n){return this.tmpVector3.crossVectors(i,this._normalVector),this.tmpVector2.crossVectors(this.tmpVector3,this._normalVector),this.tmpVector2.z<0&&this.tmpVector2.multiplyScalar(-1),this.tmpVector3.isZero(S.nearlyAntipodalIdeal)&&this.tmpVector3.copy(n).addScaledVector(i,-1*n.dot(i)).normalize(),this.tmpVector3.normalize(),this.tmpVector2.normalize(),[{normal:this.tmpVector3,normalAt:this.tmpVector2}]}shallowUpdate(){this._exists=this._startSEPoint.exists&&this._endSEPoint.exists,this._exists&&(this.tmpVector.crossVectors(this._startSEPoint.locationVector,this._endSEPoint.locationVector),this.tmpVector.isZero(S.nearlyAntipodalIdeal)&&(this.tmpVector.crossVectors(this._startSEPoint.locationVector,this._normalVector),this.tmpVector.crossVectors(this.tmpVector,this._startSEPoint.locationVector)),this._normalVector.copy(this.tmpVector).normalize(),this.ref.normalVector=this._normalVector),this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id))return;n.push(this.id);const r=new k;r.copy(this._normalVector),i.set(this.id,{kind:"line",object:this,normalVector:r})}this.updateKids(i,n)}}move(i,n,r,s){let o;if(s)o=i.angleTo(n),o>S.rotate.minAngle&&(this.desiredZAxis.crossVectors(i,n).normalize(),this.tmpVector1.copy(this.startSEPoint.locationVector).applyAxisAngle(this.desiredZAxis,o),this.startSEPoint.locationVector=this.tmpVector1,this.tmpVector2.copy(this.endSEPoint.locationVector).applyAxisAngle(this.desiredZAxis,o),this.endSEPoint.locationVector=this.tmpVector2,this.startSEPoint.markKidsOutOfDate(),this.endSEPoint.markKidsOutOfDate(),this.endSEPoint.update(),this.startSEPoint.update());else{let a=this.startSEPoint,l=this.endSEPoint;r&&(a=this.endSEPoint,l=this.startSEPoint),this.tmpVector1.crossVectors(a.locationVector,i).normalize(),this.tmpVector2.crossVectors(a.locationVector,n).normalize(),o=this.tmpVector1.angleTo(this.tmpVector2),this.tmpVector1.cross(this.tmpVector2),o*=Math.sign(this.tmpVector1.z),n.z<0&&(o*=-1),n.z*a.locationVector.z<0&&(o*=-1);const c=a.locationVector;this.tmpVector1.addVectors(l.locationVector,a.locationVector).isZero(S.nearlyAntipodalIdeal)?(o*=n.z<0?-1:1,this.tmpVector1.copy(this.normalVector),this.tmpVector1.applyAxisAngle(c,o),this.normalVector=this.tmpVector1,this.markKidsOutOfDate(),this.update()):(this.tmpVector1.copy(l.locationVector),this.tmpVector1.applyAxisAngle(c,o),l.locationVector=this.tmpVector1,l.markKidsOutOfDate(),a.markKidsOutOfDate(),l.update(),a.update())}}isOneDimensional(){return!0}isLabelable(){return!0}isLineWithAntipodalPoints(){return Math.abs(this._endSEPoint.locationVector.angleTo(this._startSEPoint.locationVector)-Math.PI)<S.line.closeEnoughToPi}}const iR=new k,IT=new k,OT=new k,nR=new Pt,Ll=S.ellipse.numPoints,Jr=class Jr extends pe{constructor(){super();y(this,"_focus1Vector",new k);y(this,"_focus2Vector",new k);y(this,"_a",0);y(this,"_b",0);y(this,"parameterization",new k);y(this,"_tMin");y(this,"_tMax");y(this,"_closed");y(this,"_periodic");y(this,"_ellipseFrame",new Pt);y(this,"frontPart");y(this,"backPart");y(this,"glowingFrontPart");y(this,"glowingBackPart");y(this,"frontFill");y(this,"backFill");y(this,"fillStorageAnchors",[]);y(this,"glowingStrokeColorFront",S.ellipse.glowing.strokeColor.front);y(this,"glowingStrokeColorBack",S.ellipse.glowing.strokeColor.back);y(this,"frontGradientColorCenter",new it.Stop(0,S.fill.frontWhite,1));y(this,"frontGradientColor",new it.Stop(2*S.boundaryCircle.radius,S.ellipse.drawn.fillColor.front,1));y(this,"frontGradient",new it.RadialGradient(S.fill.lightSource.x,S.fill.lightSource.y,1*S.boundaryCircle.radius,[this.frontGradientColorCenter,this.frontGradientColor]));y(this,"backGradientColorCenter",new it.Stop(0,S.fill.backGray,1));y(this,"backGradientColor",new it.Stop(1*S.boundaryCircle.radius,S.ellipse.drawn.fillColor.front,1));y(this,"backGradient",new it.RadialGradient(-S.fill.lightSource.x,-S.fill.lightSource.y,2*S.boundaryCircle.radius,[this.backGradientColorCenter,this.backGradientColor]));y(this,"originalVertices");y(this,"tmpVector",new k);y(this,"tmpMatrix",new Pt);this._tMax=2*Math.PI,this._tMin=0,this._closed=!0,this._periodic=!0,this.originalVertices=[];for(let r=0;r<Ll;r++){const s=2*r/Ll*Math.PI,o=(2*r+1)/Ll*Math.PI;this.originalVertices.push(new Pi(S.boundaryCircle.radius*Math.cos(s),S.boundaryCircle.radius*Math.sin(s))),this.originalVertices.push(new Pi(S.boundaryCircle.radius*Math.cos(o),S.boundaryCircle.radius*Math.sin(o)))}const i=[];for(let r=0;r<Ll;r++)i.push(new it.Vector(0,0));this.frontPart=new it.Path(i,!1,!1),this.glowingFrontPart=this.frontPart.clone(),this.backPart=this.frontPart.clone(),this.glowingBackPart=this.frontPart.clone(),pe.idPlottableDescriptionMap.set(String(this.frontPart.id),{type:"ellipse",side:"front",fill:!1,part:""}),pe.idPlottableDescriptionMap.set(String(this.backPart.id),{type:"ellipse",side:"back",fill:!1,part:""}),this.frontPart.noFill(),this.backPart.noFill(),this.glowingFrontPart.noFill(),this.glowingBackPart.noFill(),this.frontPart.visible=!0,this.backPart.visible=!0,this.glowingBackPart.visible=!1,this.glowingFrontPart.visible=!1;const n=[];for(let r=0;r<2*Ll+1;r++)n.push(new it.Vector(0,0));this.frontFill=new it.Path(n,!0,!1),this.backFill=this.frontFill.clone(),pe.idPlottableDescriptionMap.set(String(this.frontFill.id),{type:"ellipse",side:"front",fill:!0,part:""}),pe.idPlottableDescriptionMap.set(String(this.backFill.id),{type:"ellipse",side:"back",fill:!0,part:""}),this.frontFill.noStroke(),this.backFill.noStroke(),this.frontFill.visible=!0,this.backFill.visible=!0,this.frontGradientColor.color=S.ellipse.drawn.fillColor.front,this.backGradientColor.color=pe.contrastFillColor(S.ellipse.drawn.fillColor.front),this.styleOptions.set(q.Front,Xk),this.styleOptions.set(q.Back,Yk)}E(i){return this.parameterization.set(Math.sin(this._a)*Math.cos(i),Math.sin(this._b)*Math.sin(i),(this._a>Math.PI/2?-1:1)*Math.sqrt(Math.cos(this._a)*Math.cos(this._a)+Math.sin(this._a-this._b)*Math.sin(this._a+this._b)*Math.sin(i)*Math.sin(i)))}static updateCurrentStrokeWidthForZoom(i){Jr.currentEllipseStrokeWidthFront*=i,Jr.currentEllipseStrokeWidthBack*=i,Jr.currentGlowingEllipseStrokeWidthFront*=i,Jr.currentGlowingEllipseStrokeWidthBack*=i}updateDisplay(){this.tmpVector.addVectors(this._focus1Vector,this._focus2Vector).normalize(),OT.copy(this.tmpVector),this.tmpVector.crossVectors(this._focus1Vector,this._focus2Vector).normalize(),IT.copy(this.tmpVector),iR.crossVectors(IT,OT),this._ellipseFrame.makeBasis(iR,IT,OT),this.tmpMatrix.makeScale(S.boundaryCircle.radius,S.boundaryCircle.radius,S.boundaryCircle.radius),nR.multiplyMatrices(this._ellipseFrame,this.tmpMatrix);let i=0,n=0,r=this.frontPart.vertices.length,s=this.backPart.vertices.length,o=-1,a=-1,l=0;for(let f=0;f<2*Ll;f++)if(l=this._tMin+f/(2*Ll)*(this._tMax-this._tMin),this.tmpVector.copy(this.E(l)),this.tmpVector.applyMatrix4(nR),this.tmpVector.z>0){if(a===-1&&(a=f),i>=r){const m=this.backPart.vertices.pop(),g=this.glowingBackPart.vertices.pop();m&&g&&(this.frontPart.vertices.push(m),this.glowingFrontPart.vertices.push(g),s--,r++)}this.frontPart.vertices[i].x=this.tmpVector.x,this.frontPart.vertices[i].y=this.tmpVector.y,this.glowingFrontPart.vertices[i].x=this.tmpVector.x,this.glowingFrontPart.vertices[i].y=this.tmpVector.y,i++}else{if(o===-1&&(o=f),n>=s){const m=this.frontPart.vertices.pop(),g=this.glowingFrontPart.vertices.pop();m&&g&&(this.backPart.vertices.push(m),this.glowingBackPart.vertices.push(g),r--,s++)}this.backPart.vertices[n].x=this.tmpVector.x,this.backPart.vertices[n].y=this.tmpVector.y,this.glowingBackPart.vertices[n].x=this.tmpVector.x,this.glowingBackPart.vertices[n].y=this.tmpVector.y,n++}o<a&&a<=o+s?(this.backPart.vertices.rotate(a),this.glowingBackPart.vertices.rotate(a)):a<o&&o<=a+r&&(this.frontPart.vertices.rotate(o),this.glowingFrontPart.vertices.rotate(o)),this.frontPart.closed=s===0,this.backPart.closed=r===0,this.glowingFrontPart.closed=s===0,this.glowingBackPart.closed=r===0;const c=[];c.push(...this.frontFill.vertices.splice(0)),c.push(...this.backFill.vertices.splice(0)),c.push(...this.fillStorageAnchors.splice(0));let u=0,h=0,d=[];if(s===0&&this._a<Math.PI/2)this.frontPart.vertices.forEach(f=>{u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=f.x,this.frontFill.vertices[u].y=f.y,u++}),this.fillStorageAnchors.push(...c.splice(0));else if(s!==0&&r!==0){const f=Math.atan2(this.frontPart.vertices[r-1].y,this.frontPart.vertices[r-1].x);let g=Math.atan2(this.frontPart.vertices[0].y,this.frontPart.vertices[0].x)-f;g<0&&(g+=2*Math.PI);const v=[this.frontPart.vertices[r-1].x,this.frontPart.vertices[r-1].y];let p=[-v[1],v[0]];p[0]*this.frontPart.vertices[0].x+p[1]*this.frontPart.vertices[0].y<0&&(p=[-p[0],-p[1]]),this._a>Math.PI/2&&(p=[-p[0],-p[1]]),d=this.boundaryCircleCoordinates(v,Ll+1,p,g),this.frontPart.vertices.forEach(b=>{u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=b.x,this.frontFill.vertices[u].y=b.y,u++}),d.forEach(b=>{u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=b[0],this.frontFill.vertices[u].y=b[1],u++}),this.backPart.vertices.forEach(b=>{h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=b.x,this.backFill.vertices[h].y=b.y,h++}),d.reverse().forEach(b=>{h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=b[0],this.backFill.vertices[h].y=b[1],h++}),this.fillStorageAnchors.push(...c.splice(0))}else if(r===0&&this._a<Math.PI/2)this.backPart.vertices.forEach(f=>{h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=f.x,this.backFill.vertices[h].y=f.y,h++}),this.fillStorageAnchors.push(...c.splice(0));else if(r===0&&this._a>Math.PI/2){this.originalVertices.reverse().forEach((v,p)=>{p%2===0&&(u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=v.x,this.frontFill.vertices[u].y=v.y,u++)});const f=Math.floor(Math.atan2(this.backPart.vertices[0].y,this.backPart.vertices[0].x).modTwoPi()/(Math.PI/Ll));this.originalVertices.reverse().rotate(f).forEach((v,p)=>{p%2===0&&(h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=v.x,this.backFill.vertices[h].y=v.y,h++)}),this.originalVertices.rotate(-f);const m=c.pop();m.x=this.backFill.vertices[0].x,m.y=this.backFill.vertices[0].y,this.backFill.vertices.push(m),h++,this.backPart.vertices.forEach((v,p)=>{h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=v.x,this.backFill.vertices[h].y=v.y,h++});const g=c.pop();g.x=this.backFill.vertices.slice(-1)[0].x,g.y=this.backFill.vertices.slice(-1)[0].y,this.backFill.vertices.push(g),this.fillStorageAnchors.push(...c.splice(0))}else if(s===0&&this._a>Math.PI/2){this.originalVertices.reverse().forEach((v,p)=>{p%2===0&&(h===this.backFill.vertices.length&&this.backFill.vertices.push(c.pop()),this.backFill.vertices[h].x=v.x,this.backFill.vertices[h].y=v.y,h++)});const f=Math.floor(Math.atan2(this.frontPart.vertices[0].y,this.frontPart.vertices[0].x).modTwoPi()/(Math.PI/Ll));this.originalVertices.reverse().rotate(f).forEach((v,p)=>{p%2===0&&(u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=v.x,this.frontFill.vertices[u].y=v.y,u++)}),this.originalVertices.rotate(-f);const m=c.pop();m.x=this.frontFill.vertices[0].x,m.y=this.frontFill.vertices[0].y,this.frontFill.vertices.push(m),u++,this.frontPart.vertices.forEach((v,p)=>{u===this.frontFill.vertices.length&&this.frontFill.vertices.push(c.pop()),this.frontFill.vertices[u].x=v.x,this.frontFill.vertices[u].y=v.y,u++});const g=c.pop();g.x=this.frontPart.vertices[0].x,g.y=this.frontPart.vertices[0].y,this.frontFill.vertices.push(g),this.fillStorageAnchors.push(...c.splice(0))}}boundaryCircleCoordinates(i,n,r,s){const o=new k(i[0],i[1],0).normalize(),a=new k(r[0],r[1],0).normalize(),l=[];for(let c=0;c<n;c++)this.tmpVector.set(0,0,0),this.tmpVector.addScaledVector(o,Math.cos((c+1)*(s/(n+1)))),this.tmpVector.addScaledVector(a,Math.sin((c+1)*(s/(n+1)))),this.tmpVector.normalize().multiplyScalar(S.boundaryCircle.radius),l.push([this.tmpVector.x,this.tmpVector.y]);return l}set focus1Vector(i){this._focus1Vector.copy(i)}get focus1Vector(){return this._focus1Vector}set focus2Vector(i){this._focus2Vector.copy(i)}get focus2Vector(){return this._focus2Vector}get ellipseFrame(){return this._ellipseFrame}set a(i){this._a=i}set b(i){this._b=i}get tMin(){return this._tMin}get tMax(){return this._tMax}get closed(){return this._closed}get periodic(){return this._periodic}frontGlowingDisplay(){this.frontPart.visible=!0,this.glowingFrontPart.visible=!0,this.frontFill.visible=!0}backGlowingDisplay(){this.backPart.visible=!0,this.glowingBackPart.visible=!0,this.backFill.visible=!0}glowingDisplay(){this.frontGlowingDisplay(),this.backGlowingDisplay()}frontNormalDisplay(){this.frontPart.visible=!0,this.glowingFrontPart.visible=!1,this.frontFill.visible=!0}backNormalDisplay(){this.backPart.visible=!0,this.glowingBackPart.visible=!1,this.backFill.visible=!0}normalDisplay(){this.frontNormalDisplay(),this.backNormalDisplay()}setVisible(i){i?this.normalDisplay():(this.frontPart.visible=!1,this.backPart.visible=!1,this.frontFill.visible=!1,this.backFill.visible=!1,this.glowingBackPart.visible=!1,this.glowingFrontPart.visible=!1)}setSelectedColoring(i){i?(this.glowingStrokeColorFront=S.style.selectedColor.front,this.glowingStrokeColorBack=S.style.selectedColor.back):(this.glowingStrokeColorFront=S.ellipse.glowing.strokeColor.front,this.glowingStrokeColorBack=S.ellipse.glowing.strokeColor.back),this.stylize(Vt.ApplyCurrentVariables)}clone(){const i=new Jr;for(i._focus1Vector.copy(this._focus1Vector),i._focus2Vector.copy(this._focus2Vector),i._a=this._a,i._b=this._b,i.frontPart.closed=this.frontPart.closed,i.frontPart.rotation=this.frontPart.rotation,i.frontPart.translation.copy(this.frontPart.translation),i.backPart.closed=this.backPart.closed,i.backPart.rotation=this.backPart.rotation,i.backPart.translation.copy(this.backPart.translation),i.glowingFrontPart.closed=this.glowingFrontPart.closed,i.glowingFrontPart.rotation=this.glowingFrontPart.rotation,i.glowingFrontPart.translation.copy(this.glowingFrontPart.translation),i.glowingBackPart.closed=this.glowingBackPart.closed,i.glowingBackPart.rotation=this.glowingBackPart.rotation,i.glowingBackPart.translation.copy(this.glowingBackPart.translation);i.frontPart.vertices.length>this.frontPart.vertices.length;)i.backPart.vertices.push(i.frontPart.vertices.pop()),i.glowingBackPart.vertices.push(i.glowingFrontPart.vertices.pop());for(;i.backPart.vertices.length>this.backPart.vertices.length;)i.frontPart.vertices.push(i.backPart.vertices.pop()),i.glowingFrontPart.vertices.push(i.glowingBackPart.vertices.pop());i.frontPart.vertices.forEach((r,s)=>{r.copy(this.frontPart.vertices[s])}),i.backPart.vertices.forEach((r,s)=>{r.copy(this.backPart.vertices[s])}),i.glowingFrontPart.vertices.forEach((r,s)=>{r.copy(this.glowingFrontPart.vertices[s])}),i.glowingBackPart.vertices.forEach((r,s)=>{r.copy(this.glowingBackPart.vertices[s])});const n=[];for(n.push(...i.frontFill.vertices.splice(0)),n.push(...i.backFill.vertices.splice(0)),n.push(...i.fillStorageAnchors.splice(0));i.frontFill.vertices.length<this.frontFill.vertices.length;)i.frontFill.vertices.push(n.pop());for(;i.backFill.vertices.length<this.backFill.vertices.length;)i.backFill.vertices.push(n.pop());return i.fillStorageAnchors.push(...n.splice(0)),i.frontFill.vertices.forEach((r,s)=>{r.copy(this.frontFill.vertices[s])}),i.backFill.vertices.forEach((r,s)=>{r.copy(this.backFill.vertices[s])}),i}addToLayers(i){this.frontFill.addTo(i[st.foregroundFills]),this.frontPart.addTo(i[st.foreground]),this.glowingFrontPart.addTo(i[st.foregroundGlowing]),this.backFill.addTo(i[st.backgroundFills]),this.backPart.addTo(i[st.background]),this.glowingBackPart.addTo(i[st.backgroundGlowing])}removeFromLayers(){this.frontPart.remove(),this.frontFill.remove(),this.glowingFrontPart.remove(),this.backPart.remove(),this.backFill.remove(),this.glowingBackPart.remove()}defaultStyleState(i){switch(i){case q.Front:return Xk;case q.Back:return{...Yk,strokeWidthPercent:pe.contrastStrokeWidthPercent(100),strokeColor:pe.contrastStrokeColor(S.ellipse.drawn.strokeColor.front),fillColor:pe.contrastFillColor(S.ellipse.drawn.fillColor.front)};default:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.strokeWidthPercent)??100,s=(n==null?void 0:n.strokeWidthPercent)??100;this.frontPart.linewidth=Jr.currentEllipseStrokeWidthFront*r/100,this.backPart.linewidth=Jr.currentEllipseStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100,this.glowingFrontPart.linewidth=Jr.currentGlowingEllipseStrokeWidthFront*r/100,this.glowingBackPart.linewidth=Jr.currentGlowingEllipseStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100}stylize(i){switch(i){case Vt.ApplyTemporaryVariables:{pe.hslaIsNoFillOrNoStroke(S.ellipse.temp.fillColor.front)?this.frontFill.noFill():(this.frontGradientColor.color=S.ellipse.temp.fillColor.front,this.frontFill.fill=this.frontGradient),pe.hslaIsNoFillOrNoStroke(S.ellipse.temp.strokeColor.front)?this.frontPart.noStroke():this.frontPart.stroke=S.ellipse.temp.strokeColor.front,this.frontPart.linewidth=Jr.currentEllipseStrokeWidthFront,S.ellipse.drawn.dashArray.front.length>0&&(this.frontPart.dashes.clear(),S.ellipse.drawn.dashArray.front.forEach(n=>{this.frontPart.dashes.push(n)}),this.frontPart.dashes.reverse()),pe.hslaIsNoFillOrNoStroke(S.ellipse.temp.fillColor.back)?this.backFill.noFill():(this.backGradientColor.color=S.ellipse.temp.fillColor.back,this.backFill.fill=this.backGradient),pe.hslaIsNoFillOrNoStroke(S.ellipse.temp.strokeColor.back)?this.backPart.noStroke():this.backPart.stroke=S.ellipse.temp.strokeColor.back,this.backPart.linewidth=Jr.currentEllipseStrokeWidthBack,S.ellipse.drawn.dashArray.back.length>0&&(this.backPart.dashes.clear(),S.ellipse.drawn.dashArray.back.forEach(n=>{this.backPart.dashes.push(n)}),this.backPart.dashes.reverse()),this.glowingFrontPart.visible=!1,this.glowingBackPart.visible=!1;break}case Vt.ApplyCurrentVariables:{const n=this.styleOptions.get(q.Front);pe.hslaIsNoFillOrNoStroke(n==null?void 0:n.fillColor)?this.frontFill.noFill():(this.frontGradientColor.color=(n==null?void 0:n.fillColor)??S.ellipse.drawn.fillColor.front,this.frontFill.fill=this.frontGradient),pe.hslaIsNoFillOrNoStroke(n==null?void 0:n.strokeColor)?this.frontPart.noStroke():this.frontPart.stroke=(n==null?void 0:n.strokeColor)??S.ellipse.drawn.strokeColor.front,n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&n.dashArray.length>0?(this.frontPart.dashes.clear(),this.frontPart.dashes.push(...n.dashArray),n.reverseDashArray&&this.frontPart.dashes.reverse()):(this.frontPart.dashes.clear(),this.frontPart.dashes.push(0));const r=this.styleOptions.get(q.Back);r!=null&&r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastFillColor(n==null?void 0:n.fillColor))?this.backFill.noFill():(this.backGradientColor.color=pe.contrastFillColor((n==null?void 0:n.fillColor)??"black"),this.backFill.fill=this.backGradient):pe.hslaIsNoFillOrNoStroke(r==null?void 0:r.fillColor)?this.backFill.noFill():(this.backGradientColor.color=(r==null?void 0:r.fillColor)??"black",this.backFill.fill=this.backGradient),r!=null&&r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastStrokeColor(n==null?void 0:n.strokeColor))?this.backPart.noStroke():this.backPart.stroke=pe.contrastStrokeColor((n==null?void 0:n.strokeColor)??"black"):pe.hslaIsNoFillOrNoStroke(r==null?void 0:r.strokeColor)?this.backPart.noStroke():this.backPart.stroke=(r==null?void 0:r.strokeColor)??"black",r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0?(this.backPart.dashes.clear(),this.backPart.dashes.push(...r.dashArray),r.reverseDashArray&&this.backPart.dashes.reverse()):(this.backPart.dashes.clear(),this.backPart.dashes.push(0)),this.glowingFrontPart.stroke=this.glowingStrokeColorFront,n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&n.dashArray.length>0?(this.glowingFrontPart.dashes.clear(),this.glowingFrontPart.dashes.push(...n.dashArray),n.reverseDashArray&&this.glowingFrontPart.dashes.reverse()):(this.glowingFrontPart.dashes.clear(),this.glowingFrontPart.dashes.push(0)),this.glowingBackPart.stroke=this.glowingStrokeColorBack,r!=null&&r.dashArray&&(r==null?void 0:r.reverseDashArray)!==void 0&&r.dashArray.length>0?(this.glowingBackPart.dashes.clear(),this.glowingBackPart.dashes.push(...r.dashArray),r.reverseDashArray&&this.glowingBackPart.dashes.reverse()):(this.glowingBackPart.dashes.clear(),this.glowingBackPart.dashes.push(0));break}}}};y(Jr,"currentEllipseStrokeWidthFront",S.ellipse.drawn.strokeWidth.front),y(Jr,"currentEllipseStrokeWidthBack",S.ellipse.drawn.strokeWidth.back),y(Jr,"currentGlowingEllipseStrokeWidthFront",S.ellipse.drawn.strokeWidth.front+S.ellipse.glowing.edgeWidth),y(Jr,"currentGlowingEllipseStrokeWidthBack",S.ellipse.drawn.strokeWidth.back+S.ellipse.glowing.edgeWidth);let ll=Jr;class _le extends ll{constructor(){super();y(this,"nonFreeEllipseScalePercent",S.ellipse.nonFree.scalePercent);this.styleOptions.set(q.Front,RN),this.styleOptions.set(q.Back,FN)}defaultStyleState(i){switch(i){case q.Front:return RN;case q.Back:return{...FN,strokeWidthPercent:pe.contrastStrokeWidthPercent(this.nonFreeEllipseScalePercent),strokeColor:pe.contrastStrokeColor(S.ellipse.drawn.strokeColor.front),fillColor:pe.contrastFillColor(S.ellipse.drawn.fillColor.front)};default:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.strokeWidthPercent)??100,s=(n==null?void 0:n.strokeWidthPercent)??100;this.frontPart.linewidth=ll.currentEllipseStrokeWidthFront*r/100*this.nonFreeEllipseScalePercent/100,this.backPart.linewidth=ll.currentEllipseStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100*this.nonFreeEllipseScalePercent/100,this.glowingFrontPart.linewidth=ll.currentGlowingEllipseStrokeWidthFront*r/100*this.nonFreeEllipseScalePercent/100,this.glowingBackPart.linewidth=ll.currentGlowingEllipseStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100*this.nonFreeEllipseScalePercent/100}}_e.global;const Ple=new Set([...Object.getOwnPropertyNames(Xk),...Object.getOwnPropertyNames(Yk)]);class Ii extends Xe{constructor(i,n,r,s){super();y(this,"label");y(this,"_focus1SEPoint");y(this,"_focus2SEPoint");y(this,"_ellipseSEPoint");y(this,"_a");y(this,"_b");y(this,"changeInPositionRotationMatrix",new Pt);y(this,"desiredZAxis",new k);y(this,"tmpVector0",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"tmpVector3",new k);y(this,"tmpMatrix",new Pt);y(this,"parameterizationPrime",new k);y(this,"parameterizationDoublePrime",new k);this._focus1SEPoint=i,this._focus2SEPoint=n,this._ellipseSEPoint=r,this.ref=s?new _le:new ll,this.ref.focus1Vector.copy(i.locationVector),this.ref.focus2Vector.copy(n.locationVector),this.ref.updateDisplay(),this.ref.stylize(Vt.ApplyCurrentVariables),this.ref.adjustSize(),this._a=.5*(i.locationVector.angleTo(r.locationVector)+n.locationVector.angleTo(r.locationVector)),this._b=Math.acos(Math.cos(this._a)/Math.cos(i.locationVector.angleTo(n.locationVector)/2)),this.ref.focus1Vector=this._focus1SEPoint.locationVector,this.ref.focus2Vector=this._focus2SEPoint.locationVector,this.ref.a=this._a,this.ref.b=this._b,this.ref.updateDisplay(),Ii.ELLIPSE_COUNT++,this.name=`E${Ii.ELLIPSE_COUNT}`}customStyles(){return Ple}get focus1SEPoint(){return this._focus1SEPoint}get focus2SEPoint(){return this._focus2SEPoint}get ellipseSEPoint(){return this._ellipseSEPoint}get ellipseAngleSum(){return this._focus1SEPoint.locationVector.angleTo(this._ellipseSEPoint.locationVector)+this._focus2SEPoint.locationVector.angleTo(this._ellipseSEPoint.locationVector)}get a(){return this._a}set a(i){this._a=i}set b(i){this._b=i}get b(){return this._b}get noduleDescription(){var i,n,r;return String(_e.global.t("objectTree.ellipseThrough",{focus1:(i=this._focus1SEPoint.label)==null?void 0:i.ref.shortUserName,focus2:(n=this._focus2SEPoint.label)==null?void 0:n.ref.shortUserName,through:(r=this._ellipseSEPoint.label)==null?void 0:r.ref.shortUserName}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEEllipse"}Ep(i){return this.parameterizationPrime.set(-Math.sin(this._a)*Math.sin(i),Math.sin(this._b)*Math.cos(i),(this._a>Math.PI/2?-1:1)/(2*Math.sqrt(Math.cos(this._a)*Math.cos(this._a)+Math.sin(this._a-this._b)*Math.sin(this._a+this._b)*Math.sin(i)*Math.sin(i)))*Math.sin(this._a-this._b)*Math.sin(this._a+this._b)*Math.sin(2*i))}Epp(i){return this.parameterizationDoublePrime.set(-Math.sin(this._a)*Math.cos(i),-Math.sin(this._b)*Math.sin(i),(this._a>Math.PI/2?-1:1)/Math.sqrt((Math.cos(this._a)*Math.cos(this._a)+Math.sin(this._a-this._b)*Math.sin(this._a+this._b)*Math.sin(i)*Math.sin(i))*(Math.cos(this._a)*Math.cos(this._a)+Math.sin(this._a-this._b)*Math.sin(this._a+this._b)*Math.sin(i)*Math.sin(i))*(Math.cos(this._a)*Math.cos(this._a)+Math.sin(this._a-this._b)*Math.sin(this._a+this._b)*Math.sin(i)*Math.sin(i)))*Math.sin(this._a-this._b)*Math.sin(this._a+this._b)*(Math.cos(this._a)*Math.cos(this._a)*Math.cos(2*i)-Math.sin(this._a-this._b)*Math.sin(this._a+this._b)*Math.sin(i)*Math.sin(i)*Math.sin(i)*Math.sin(i)))}isHitAt(i,n){const r=i.angleTo(this._focus1SEPoint.locationVector)+i.angleTo(this._focus2SEPoint.locationVector);return Math.abs(r-this.ellipseAngleSum)<S.ellipse.hitIdealDistance/n}shallowUpdate(){if(this._exists=this._focus1SEPoint.exists&&this._focus2SEPoint.exists&&this._ellipseSEPoint.exists,this._exists){this._a=.5*(this._focus1SEPoint.locationVector.angleTo(this._ellipseSEPoint.locationVector)+this._focus2SEPoint.locationVector.angleTo(this._ellipseSEPoint.locationVector)),this._b=Math.acos(Math.cos(this._a)/Math.cos(this._focus1SEPoint.locationVector.angleTo(this._focus2SEPoint.locationVector)/2));const i=this.tmpVector2.addVectors(this._focus1SEPoint.locationVector,this._focus2SEPoint.locationVector);this._exists=this._exists&&!i.isZero(S.nearlyAntipodalIdeal),this._exists=this._exists&&this._focus1SEPoint.locationVector.angleTo(this._focus2SEPoint.locationVector)>S.ellipse.minimumAngleSumDifference,this._exists=this._exists&&2*this._a-this._focus1SEPoint.locationVector.angleTo(this._focus2SEPoint.locationVector)>S.ellipse.minimumAngleSumDifference&&2*this._a<2*Math.PI-this._focus1SEPoint.locationVector.angleTo(this._focus2SEPoint.locationVector)-S.ellipse.minimumAngleSumDifference}this._exists&&(this.ref.a=this._a,this.ref.b=this._b,this.ref.focus1Vector=this._focus1SEPoint.locationVector,this.ref.focus2Vector=this._focus2SEPoint.locationVector,this.ref.updateDisplay()),this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Ellipse with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"ellipse",object:this})}this.updateKids(i,n)}}closestVector(i){const n=new k;n.copy(i),n.applyMatrix4(this.tmpMatrix.copy(this.ref.ellipseFrame).invert());const r=new k,s=[];for(let o=0;o<=100;o++)s.push(o*2*Math.PI/100);return r.copy(Xe.closestVectorParametrically(this.ref.E.bind(this.ref),this.Ep.bind(this),n,s,this.Epp.bind(this)).vector),r.applyMatrix4(this.ref.ellipseFrame).normalize()}closestLabelLocationVector(i,n){const r=new k;r.copy(this.closestVector(i));const s=n;return r.angleTo(i)<S.ellipse.maxLabelDistance/s?i:(this.tmpVector1.crossVectors(i,r).normalize(),this.tmpVector2.crossVectors(r,this.tmpVector1).normalize,this.tmpVector2.multiplyScalar(Math.sin(S.ellipse.maxLabelDistance/s)),this.tmpVector2.addScaledVector(r,Math.cos(S.ellipse.maxLabelDistance/s)).normalize())}accept(i){return i.actionOnEllipse(this)}getNormalsToPerpendicularLinesThru(i,n){if(this.tmpVector0.addVectors(this._focus1SEPoint.locationVector,this._focus2SEPoint.locationVector).normalize(),this.tmpVector0.crossVectors(this.tmpVector0,i),this.tmpVector0.isZero(S.nearlyAntipodalIdeal))return this.tmpVector1.crossVectors(this._focus1SEPoint.locationVector,this._focus2SEPoint.locationVector).normalize(),this.tmpVector2.addVectors(this._focus1SEPoint.locationVector,this._focus2SEPoint.locationVector).normalize(),this.tmpVector0.crossVectors(this.tmpVector1,this.tmpVector2),[{normal:this.tmpVector1,normalAt:this.tmpVector3},{normal:this.tmpVector0,normalAt:this.tmpVector2}];{const r=new k;r.copy(i),r.applyMatrix4(this.tmpMatrix.copy(this.ref.ellipseFrame).invert());const s=[];for(let a=0;a<=100;a++)s.push(a*2*Math.PI/100);const o=Xe.getNormalsToPerpendicularLinesThruParametrically(this.ref.E.bind(this.ref),this.Ep.bind(this),r,s,this.Epp.bind(this));return o.forEach(a=>{a.normal.applyMatrix4(this.ref.ellipseFrame).normalize(),a.normalAt.applyMatrix4(this.ref.ellipseFrame).normalize()}),o}}getNormalsToTangentLinesThru(i,n,r){const s=i.angleTo(this._focus1SEPoint.locationVector)+i.angleTo(this._focus2SEPoint.locationVector);this.tmpVector0.copy(this._focus1SEPoint.locationVector),this.tmpVector1.copy(this._focus2SEPoint.locationVector);const o=i.angleTo(this.tmpVector0.multiplyScalar(-1))+i.angleTo(this.tmpVector1.multiplyScalar(-1));if(this._a<Math.PI/2&&(Math.abs(s-this.ellipseAngleSum)<.001/n||Math.abs(o-this.ellipseAngleSum)<.001/n)||this._a>Math.PI/2&&(Math.abs(o-2*Math.PI+this.ellipseAngleSum)<.001/n||Math.abs(s-2*Math.PI+this.ellipseAngleSum)<.001/n)){const u=new k;u.copy(i),u.applyMatrix4(this.tmpMatrix.copy(this.ref.ellipseFrame).invert());const h=[];for(let m=0;m<=100;m++)h.push(m*2*Math.PI/100);const d=Xe.closestVectorParametrically(this.ref.E.bind(this.ref),this.Ep.bind(this),u,h,this.Epp.bind(this)),f=new k;return f.copy(this.Ep(d.tVal)),f.applyMatrix4(this.ref.ellipseFrame),f.cross(i),[{normal:f.normalize(),tangentAt:d.vector}]}if(Math.abs(this._a-Math.PI/2)<S.tolerance||this._a<Math.PI/2&&(s<this.ellipseAngleSum||o<this.ellipseAngleSum)||this._a>Math.PI/2&&(o<2*Math.PI-this.ellipseAngleSum||s<2*Math.PI-this.ellipseAngleSum))return[];const a=new k;a.copy(i),a.applyMatrix4(this.tmpMatrix.copy(this.ref.ellipseFrame).invert());const l=[];for(let u=0;u<=100;u++)l.push(u*2*Math.PI/100);const c=Xe.getNormalsToTangentLinesThruParametrically(this.ref.E.bind(this.ref),this.Ep.bind(this),a,l,this.Epp.bind(this));return c.forEach(u=>{u.normal.applyMatrix4(this.ref.ellipseFrame).normalize(),u.tangentAt.applyMatrix4(this.ref.ellipseFrame).normalize()}),c}move(i,n){const r=i.angleTo(n);Math.abs(r)>S.rotate.minAngle&&(this.desiredZAxis.crossVectors(i,n).normalize(),this.changeInPositionRotationMatrix.makeRotationAxis(this.desiredZAxis,r),this.tmpVector1.copy(this.focus1SEPoint.locationVector).applyMatrix4(this.changeInPositionRotationMatrix),this.focus1SEPoint.locationVector=this.tmpVector1,this.tmpVector1.copy(this.focus2SEPoint.locationVector).applyMatrix4(this.changeInPositionRotationMatrix),this.focus2SEPoint.locationVector=this.tmpVector1,this.tmpVector0.copy(this.ellipseSEPoint.locationVector).applyMatrix4(this.changeInPositionRotationMatrix),this.ellipseSEPoint.locationVector=this.tmpVector0,this.ellipseSEPoint.markKidsOutOfDate(),this.focus1SEPoint.markKidsOutOfDate(),this.focus2SEPoint.markKidsOutOfDate(),this.ellipseSEPoint.update(),this.focus1SEPoint.update(),this.focus2SEPoint.update())}isOneDimensional(){return!0}isLabelable(){return!0}}const ps=class ps extends pe{constructor(i=0,n=1,r=!1){super();y(this,"_closed");y(this,"_tValues",[]);y(this,"_coordValues",[]);y(this,"tMin",0);y(this,"tMax",1);y(this,"frontParts",[]);y(this,"backParts",[]);y(this,"glowingFrontParts",[]);y(this,"glowingBackParts",[]);y(this,"pool",[]);y(this,"glowingPool",[]);y(this,"markers",new it.Group);y(this,"markerPool",[]);y(this,"glowingStrokeColorFront",S.parametric.glowing.strokeColor.front);y(this,"glowingStrokeColorBack",S.parametric.glowing.strokeColor.back);y(this,"foregroundLayer",null);y(this,"backgroundLayer",null);y(this,"glowingFgLayer",null);y(this,"glowingBgLayer",null);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpMatrix",new Pt);this.tMin=i,this.tMax=n,this._closed=r,this.styleOptions.set(q.Front,iC),this.styleOptions.set(q.Back,nC),console.debug("Parametric constructor",i,n,"with rotation")}static updateCurrentStrokeWidthForZoom(i){ps.currentParametricStrokeWidthFront*=i,ps.currentParametricStrokeWidthBack*=i,ps.currentGlowingParametricStrokeWidthFront*=i,ps.currentGlowingParametricStrokeWidthBack*=i}setRangeAndFunctions(i,n,r,s){this.tMin=r,this.tMax=s,this._tValues=i,this._coordValues=n,this.buildCurve()}buildCurve(){const i=this._coordValues.length;if(this.frontParts.length===0){const n=[];for(let r=0;r<i;r++)n.push(new it.Vector(0,0)),this.markerPool.push(new it.Circle(0,0,2));this.frontParts.push(new it.Path(n,!1,!1)),this.glowingFrontParts.push(this.frontParts[0].clone()),this.backParts.push(new it.Path([],!1,!1)),this.glowingBackParts.push(new it.Path([],!1,!1)),pe.idPlottableDescriptionMap.set(String(this.frontParts[0].id),{type:"parametric",side:"front",fill:!1,part:"0"}),pe.idPlottableDescriptionMap.set(String(this.backParts[0].id),{type:"parametric",side:"back",fill:!1,part:"0"}),this.frontParts[0].noFill(),this.backParts[0].noFill(),this.glowingFrontParts[0].noFill(),this.glowingBackParts[0].noFill(),this.frontParts[0].visible=!0,this.backParts[0].visible=!0,this.glowingBackParts[0].visible=!1,this.glowingFrontParts[0].visible=!1}else{console.debug("Parametric::buildCurve(). a rebuild of with number of anchors",i);const n=this.frontParts.map(o=>o.vertices.length).reduce((o,a)=>o+a),r=this.backParts.map(o=>o.vertices.length).reduce((o,a)=>o+a),s=i-(n+r);if(s>0){let o;this.frontParts[0].vertices.length>0?o=this.frontParts[0].vertices[0].clone():o=this.backParts[0].vertices[0].clone();for(let a=0;a<s-1;a++)this.frontParts[0].vertices.push(o.clone()),this.glowingFrontParts[0].vertices.push(o.clone());this.frontParts[0].vertices.push(o.clone()),this.glowingFrontParts[0].vertices.push(o)}else s<0&&console.debug("The curve needs fewer anchor points")}this.stylize(Vt.ApplyCurrentVariables),this.adjustSize()}updateDisplay(){if(this.tmpMatrix.makeScale(S.boundaryCircle.radius,S.boundaryCircle.radius,S.boundaryCircle.radius),this.tMax<=this.tMin)return;this.frontParts.forEach(l=>{this.pool.push(...l.vertices.splice(0))}),this.backParts.forEach(l=>{this.pool.push(...l.vertices.splice(0))}),this.glowingFrontParts.forEach(l=>{this.glowingPool.push(...l.vertices.splice(0))}),this.glowingBackParts.forEach(l=>{this.glowingPool.push(...l.vertices.splice(0))}),this.markers.children.forEach(l=>{this.markerPool.push(l)}),this.markerPool.forEach(l=>{l.remove()}),this.markers.children.clear();let i=-1,n=-1,r=0,s=0,o=!0,a=!0;for(let l=0;l<this._tValues.length;l++)if(this.tmpVector.copy(this._coordValues[l]),this.tmpVector.applyMatrix4(this.tmpMatrix),this.tmpVector.z<0){if(n!==l-1&&!o&&(s++,s>=this.backParts.length)){const h=new it.Path([],!1,!1);this.backParts.push(h),h.noFill(),h.visible=!0,this.backgroundLayer&&h.addTo(this.backgroundLayer);const d=new it.Path([],!1,!1);this.glowingBackParts.push(d),d.noFill(),d.visible=!1,this.glowingBgLayer&&d.addTo(this.glowingBgLayer),pe.idPlottableDescriptionMap.set(String(this.backParts[s-1].id),{type:"parametric",side:"back",fill:!1,part:s.toString()})}o=!1,n=l;const c=this.pool.pop();c!==void 0&&(c.x=this.tmpVector.x,c.y=this.tmpVector.y,this.backParts[s].vertices.push(c));const u=this.glowingPool.pop();u!==void 0&&(u.x=this.tmpVector.x,u.y=this.tmpVector.y,this.glowingBackParts[s].vertices.push(u))}else{const c=this.markerPool.pop();if(c==null||c.translation.set(this.tmpVector.x,this.tmpVector.y),c==null||c.addTo(this.markers),i!==l-1&&!a&&(r++,r>=this.frontParts.length)){const d=new it.Path([],!1,!1);this.frontParts.push(d),d.noFill(),d.visible=!0,this.foregroundLayer&&d.addTo(this.foregroundLayer);const f=new it.Path([],!1,!1);this.glowingFrontParts.push(f),f.noFill(),f.visible=!0,this.glowingFgLayer&&f.addTo(this.glowingFgLayer),pe.idPlottableDescriptionMap.set(String(this.frontParts[r-1].id),{type:"parametric",side:"front",fill:!1,part:r.toString()})}a=!1,i=l;const u=this.pool.pop();u!==void 0&&(u.x=this.tmpVector.x,u.y=this.tmpVector.y,this.frontParts[r].vertices.push(u));const h=this.glowingPool.pop();h!==void 0&&(h.x=this.tmpVector.x,h.y=this.tmpVector.y,this.glowingFrontParts[r].vertices.push(h))}this.stylize(Vt.ApplyCurrentVariables),this.adjustSize()}get closed(){return this._closed}get numberOfParts(){return this.frontParts.filter(i=>i.vertices.length>0).length+this.backParts.filter(i=>i.vertices.length>0).length}frontGlowingDisplay(){this.frontParts.forEach(i=>i.visible=!0),this.glowingFrontParts.forEach(i=>i.visible=!0)}backGlowingDisplay(){this.backParts.forEach(i=>i.visible=!0),this.glowingBackParts.forEach(i=>i.visible=!0)}glowingDisplay(){this.frontGlowingDisplay(),this.backGlowingDisplay()}frontNormalDisplay(){this.frontParts.forEach(i=>{i.visible=!0}),this.glowingFrontParts.forEach(i=>{i.visible=!1})}backNormalDisplay(){this.backParts.forEach(i=>i.visible=!0),this.glowingBackParts.forEach(i=>i.visible=!1)}normalDisplay(){this.frontNormalDisplay(),this.backNormalDisplay()}setVisible(i){i?this.normalDisplay():(this.frontParts.forEach(n=>{n.visible=!1}),this.backParts.forEach(n=>{n.visible=!1}),this.glowingBackParts.forEach(n=>{n.visible=!1}),this.glowingFrontParts.forEach(n=>{n.visible=!1}))}setSelectedColoring(i){i?(this.glowingStrokeColorFront=S.style.selectedColor.front,this.glowingStrokeColorBack=S.style.selectedColor.back):(this.glowingStrokeColorFront=S.parametric.glowing.strokeColor.front,this.glowingStrokeColorBack=S.parametric.glowing.strokeColor.back),this.stylize(Vt.ApplyCurrentVariables)}addToLayers(i){this.foregroundLayer=i[st.foreground],this.backgroundLayer=i[st.background],this.glowingFgLayer=i[st.foregroundGlowing],this.glowingBgLayer=i[st.backgroundGlowing],this.frontParts.forEach(n=>n.addTo(i[st.foreground])),this.glowingFrontParts.forEach(n=>n.addTo(i[st.foregroundGlowing])),this.backParts.forEach(n=>n.addTo(i[st.background])),this.glowingBackParts.forEach(n=>n.addTo(i[st.backgroundGlowing]))}removeFromLayers(){this.frontParts.forEach(i=>i.remove()),this.glowingFrontParts.forEach(i=>i.remove()),this.backParts.forEach(i=>i.remove()),this.glowingBackParts.forEach(i=>i.remove())}defaultStyleState(i){switch(i){case q.Front:return iC;case q.Back:return{...nC,strokeWidthPercent:pe.contrastStrokeWidthPercent(100),strokeColor:pe.contrastStrokeColor(S.parametric.drawn.strokeColor.front),fillColor:pe.contrastFillColor(S.parametric.drawn.fillColor.front)};default:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=(i==null?void 0:i.strokeWidthPercent)??100,r=this.styleOptions.get(q.Back),s=(r==null?void 0:r.strokeWidthPercent)??100;this.frontParts.forEach(o=>o.linewidth=ps.currentParametricStrokeWidthFront*n/100),this.backParts.forEach(o=>o.linewidth=ps.currentParametricStrokeWidthBack*(r!=null&&r.dynamicBackStyle?pe.contrastStrokeWidthPercent(n):s)/100),this.glowingFrontParts.forEach(o=>o.linewidth=ps.currentGlowingParametricStrokeWidthFront*n/100),this.glowingBackParts.forEach(o=>o.linewidth=ps.currentGlowingParametricStrokeWidthBack*(r!=null&&r.dynamicBackStyle?pe.contrastStrokeWidthPercent(n):s)/100)}stylize(i){switch(i){case Vt.ApplyTemporaryVariables:{pe.hslaIsNoFillOrNoStroke(S.parametric.temp.strokeColor.front)?this.frontParts.forEach(n=>n.noStroke()):this.frontParts.forEach(n=>n.stroke=S.parametric.temp.strokeColor.front),this.frontParts.forEach(n=>n.linewidth=ps.currentParametricStrokeWidthFront),S.parametric.drawn.dashArray.front.length>0&&(this.frontParts.forEach(n=>n.dashes.clear()),S.parametric.drawn.dashArray.front.forEach(n=>{this.frontParts.forEach(r=>r.dashes.push(n))}),this.frontParts.forEach(n=>n.dashes.reverse())),pe.hslaIsNoFillOrNoStroke(S.parametric.temp.strokeColor.back)?this.backParts.forEach(n=>n.noStroke()):this.backParts.forEach(n=>n.stroke=S.parametric.temp.strokeColor.back),this.backParts.forEach(n=>n.linewidth=ps.currentParametricStrokeWidthBack),S.parametric.drawn.dashArray.back.length>0&&(this.backParts.forEach(n=>n.dashes.clear()),S.parametric.drawn.dashArray.back.forEach(n=>{this.backParts.forEach(r=>r.dashes.push(n))}),this.backParts.forEach(n=>n.dashes.reverse())),this.glowingFrontParts.forEach(n=>n.visible=!1),this.glowingBackParts.forEach(n=>n.visible=!1);break}case Vt.ApplyCurrentVariables:{const n=this.styleOptions.get(q.Front),r=(n==null?void 0:n.strokeColor)??"black";pe.hslaIsNoFillOrNoStroke(r)?this.frontParts.forEach(a=>a.noStroke()):this.frontParts.forEach(a=>a.stroke=r),n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&n.dashArray.length>0?(this.frontParts.forEach(a=>a.dashes.clear()),n.dashArray.forEach(a=>{this.frontParts.forEach(l=>l.dashes.push(a))}),n.reverseDashArray&&this.frontParts.forEach(a=>a.dashes.reverse())):(this.frontParts.forEach(a=>a.dashes.clear()),this.frontParts.forEach(a=>a.dashes.push(0)));const s=this.styleOptions.get(q.Back),o=(s==null?void 0:s.strokeColor)??"black";s!=null&&s.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastStrokeColor(r))?this.backParts.forEach(a=>a.noStroke()):this.backParts.forEach(a=>a.stroke=pe.contrastStrokeColor(r)):pe.hslaIsNoFillOrNoStroke(o)?this.backParts.forEach(a=>a.noStroke()):this.backParts.forEach(a=>a.stroke=o),s!=null&&s.dashArray&&(s==null?void 0:s.reverseDashArray)!==void 0&&s.dashArray.length>0?(this.backParts.forEach(a=>a.dashes.clear()),s.dashArray.forEach(a=>{this.backParts.forEach(l=>l.dashes.push(a))}),s.reverseDashArray&&this.backParts.forEach(a=>a.dashes.reverse())):(this.backParts.forEach(a=>a.dashes.clear()),this.backParts.forEach(a=>a.dashes.push(0))),this.glowingFrontParts.forEach(a=>a.stroke=this.glowingStrokeColorFront),n!=null&&n.dashArray&&(n==null?void 0:n.reverseDashArray)!==void 0&&n.dashArray.length>0?(this.glowingFrontParts.forEach(a=>a.dashes.clear()),n.dashArray.forEach(a=>{this.glowingFrontParts.forEach(l=>l.dashes.push(a))}),n.reverseDashArray&&this.glowingFrontParts.forEach(a=>a.dashes.reverse())):(this.glowingFrontParts.forEach(a=>a.dashes.clear()),this.glowingFrontParts.forEach(a=>a.dashes.push(0))),this.glowingBackParts.forEach(a=>a.stroke=this.glowingStrokeColorBack),s!=null&&s.dashArray&&(s==null?void 0:s.reverseDashArray)!==void 0&&s.dashArray.length>0?(this.glowingBackParts.forEach(a=>a.dashes.clear()),s.dashArray.forEach(a=>{this.glowingBackParts.forEach(l=>l.dashes.push(a))}),s.reverseDashArray&&this.glowingBackParts.forEach(a=>a.dashes.reverse())):(this.glowingBackParts.forEach(a=>a.dashes.clear()),this.glowingBackParts.forEach(a=>a.dashes.push(0)));break}}}};y(ps,"currentParametricStrokeWidthFront",S.parametric.drawn.strokeWidth.front),y(ps,"currentParametricStrokeWidthBack",S.parametric.drawn.strokeWidth.back),y(ps,"currentGlowingParametricStrokeWidthFront",S.parametric.drawn.strokeWidth.front+S.parametric.glowing.edgeWidth),y(ps,"currentGlowingParametricStrokeWidthBack",S.parametric.drawn.strokeWidth.back+S.parametric.glowing.edgeWidth);let Kv=ps;var KM={};/**
 * @license MIT
 * @copyright 2020 Eyas Ranjous <eyas.ranjous@gmail.com>
 *
 * @class
 */let Ele=class b0{constructor(e,i,n){if(typeof e!="function")throw new Error("Heap constructor expects a compare function");this._compare=e,this._nodes=Array.isArray(i)?i:[],this._leaf=n||null}toArray(){return Array.from(this._nodes)}_hasLeftChild(e){return e*2+1<this.size()}_hasRightChild(e){return e*2+2<this.size()}_compareAt(e,i){return this._compare(this._nodes[e],this._nodes[i])}_swap(e,i){const n=this._nodes[e];this._nodes[e]=this._nodes[i],this._nodes[i]=n}_shouldSwap(e,i){return e<0||e>=this.size()||i<0||i>=this.size()?!1:this._compareAt(e,i)>0}_compareChildrenOf(e){if(!this._hasLeftChild(e)&&!this._hasRightChild(e))return-1;const i=e*2+1,n=e*2+2;return this._hasLeftChild(e)?this._hasRightChild(e)&&this._compareAt(i,n)>0?n:i:n}_compareChildrenBefore(e,i,n){return this._compareAt(n,i)<=0&&n<e?n:i}_heapifyUp(e){let i=e,n=Math.floor((i-1)/2);for(;this._shouldSwap(n,i);)this._swap(n,i),i=n,n=Math.floor((i-1)/2)}_heapifyDown(e){let i=e,n=this._compareChildrenOf(i);for(;this._shouldSwap(i,n);)this._swap(i,n),i=n,n=this._compareChildrenOf(i)}_heapifyDownUntil(e){let i=0,n=1,r=2,s;for(;n<e;)s=this._compareChildrenBefore(e,n,r),this._shouldSwap(i,s)&&this._swap(i,s),i=s,n=i*2+1,r=i*2+2}insert(e){return this._nodes.push(e),this._heapifyUp(this.size()-1),(this._leaf===null||this._compare(e,this._leaf)>0)&&(this._leaf=e),this}push(e){return this.insert(e)}extractRoot(){if(this.isEmpty())return null;const e=this.root();return this._nodes[0]=this._nodes[this.size()-1],this._nodes.pop(),this._heapifyDown(0),e===this._leaf&&(this._leaf=this.root()),e}pop(){return this.extractRoot()}sort(){for(let e=this.size()-1;e>0;e-=1)this._swap(0,e),this._heapifyDownUntil(e);return this._nodes}fix(){for(let e=Math.floor(this.size()/2)-1;e>=0;e-=1)this._heapifyDown(e);for(let e=Math.floor(this.size()/2);e<this.size();e+=1){const i=this._nodes[e];(this._leaf===null||this._compare(i,this._leaf)>0)&&(this._leaf=i)}return this}isValid(){const e=i=>{let n=!0,r=!0;if(this._hasLeftChild(i)){const s=i*2+1;if(this._compareAt(i,s)>0)return!1;n=e(s)}if(this._hasRightChild(i)){const s=i*2+2;if(this._compareAt(i,s)>0)return!1;r=e(s)}return n&&r};return e(0)}clone(){return new b0(this._compare,this._nodes.slice(),this._leaf)}root(){return this.isEmpty()?null:this._nodes[0]}top(){return this.root()}leaf(){return this._leaf}size(){return this._nodes.length}isEmpty(){return this.size()===0}clear(){this._nodes=[],this._leaf=null}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:e===-1})}}static heapify(e,i){if(!Array.isArray(e))throw new Error("Heap.heapify expects an array of values");if(typeof i!="function")throw new Error("Heap.heapify expects a compare function");return new b0(i,e).fix()}static isHeapified(e,i){return new b0(i,e).isValid()}};KM.Heap=Ele;var v5={};/**
 * @license MIT
 * @copyright 2020 Eyas Ranjous <eyas.ranjous@gmail.com>
 */const{Heap:DT}=KM,NT=t=>(e,i)=>{const n=typeof t=="function"?t(e):e,r=typeof t=="function"?t(i):i;return n<=r?-1:1};let wle=class _0{constructor(e,i){this._getCompareValue=e,this._heap=i||new DT(NT(e))}toArray(){return Array.from(this._heap._nodes)}insert(e){return this._heap.insert(e)}push(e){return this.insert(e)}extractRoot(){return this._heap.extractRoot()}pop(){return this.extractRoot()}sort(){return this._heap.sort()}fix(){return this._heap.fix()}isValid(){return this._heap.isValid()}root(){return this._heap.root()}top(){return this.root()}leaf(){return this._heap.leaf()}size(){return this._heap.size()}isEmpty(){return this._heap.isEmpty()}clear(){this._heap.clear()}clone(){return new _0(this._getCompareValue,this._heap.clone())}[Symbol.iterator](){let e=this.size();return{next:()=>(e-=1,{value:this.pop(),done:e===-1})}}static heapify(e,i){if(!Array.isArray(e))throw new Error("MinHeap.heapify expects an array");const n=new DT(NT(i),e);return new _0(i,n).fix()}static isHeapified(e,i){const n=new DT(NT(i),e);return new _0(i,n).isValid()}};v5.MinHeap=wle;const{Heap:Tle}=KM,{MinHeap:xle}=v5;var kle=Tle,Cle=xle;const Mle=new Set([...Object.getOwnPropertyNames(iC),...Object.getOwnPropertyNames(nC)]);_e.global;class tn extends Xe{constructor(i,n,r,s,o,a=!1){var c;super();y(this,"label");y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"pOut",new k);y(this,"pPrimeOut",new k);y(this,"pPrime2Out",new k);y(this,"tmpMatrix",new Pt);y(this,"_endPoints",[]);y(this,"_tracePoint");y(this,"_coordinateExpressions",{x:"",y:"",z:""});y(this,"coordinateSyntaxTrees",{x:wt.NOT_DEFINED,y:wt.NOT_DEFINED,z:wt.NOT_DEFINED});y(this,"primeCoordinateSyntaxTrees",{x:wt.NOT_DEFINED,y:wt.NOT_DEFINED,z:wt.NOT_DEFINED});y(this,"primeX2CoordinateSyntaxTrees",{x:wt.NOT_DEFINED,y:wt.NOT_DEFINED,z:wt.NOT_DEFINED});y(this,"_seParentExpressions",[]);y(this,"_tExpressions",{min:"",max:""});y(this,"_tNumbers",{min:NaN,max:NaN});y(this,"_tNumbersHardLimit",{min:NaN,max:NaN});y(this,"_tValues",[]);y(this,"partitionedTValues",[]);y(this,"_isClosed");y(this,"_fnValues",[]);y(this,"_fnPrimeValues",[]);y(this,"_fnPPrimeValues",[]);y(this,"largestGap",0);y(this,"_c1DiscontinuityParameterValues",[]);y(this,"tSyntaxTrees",{min:wt.NOT_DEFINED,max:wt.NOT_DEFINED});y(this,"varMap",new Map);y(this,"prevVarMap",new Map);this._isClosed=a,this._c1DiscontinuityParameterValues.push(...s),this.ref=new Kv(r.min,r.max,a),this.ref.updateDisplay(),this.ref.stylize(Vt.ApplyCurrentVariables),this.ref.adjustSize(),this.coordinateExpressions.x=i.x,this.coordinateExpressions.y=i.y,this.coordinateExpressions.z=i.z,this.coordinateSyntaxTrees.x=wt.parse(i.x),this.coordinateSyntaxTrees.y=wt.parse(i.y),this.coordinateSyntaxTrees.z=wt.parse(i.z),this.primeCoordinateSyntaxTrees.x=wt.differentiate(this.coordinateSyntaxTrees.x,"t"),this.primeCoordinateSyntaxTrees.y=wt.differentiate(this.coordinateSyntaxTrees.y,"t"),this.primeCoordinateSyntaxTrees.z=wt.differentiate(this.coordinateSyntaxTrees.z,"t"),this.primeX2CoordinateSyntaxTrees.x=wt.differentiate(this.primeCoordinateSyntaxTrees.x,"t"),this.primeX2CoordinateSyntaxTrees.y=wt.differentiate(this.primeCoordinateSyntaxTrees.y,"t"),this.primeX2CoordinateSyntaxTrees.z=wt.differentiate(this.primeCoordinateSyntaxTrees.z,"t"),this._tNumbersHardLimit.min=r.min,this._tNumbersHardLimit.max=r.max;const l=this.tMinMaxExpressionValues();this._tNumbers.min=l[0],this._tNumbers.max=l[1],n.min.trim().length>0&&(this._tExpressions.min=n.min,this.tSyntaxTrees.min=wt.parse(n.min)),n.max.trim().length>0&&(this._tExpressions.max=n.max,this.tSyntaxTrees.max=wt.parse(n.max)),this._seParentExpressions.push(...o),tn.PARAMETRIC_COUNT++,this.name=`Pa${tn.PARAMETRIC_COUNT}`,this._seParentExpressions.forEach(u=>{this.varMap.set(u.name,u.value)}),this.createSamplingPointsAndRecalculateFunctions(),(c=this.ref)==null||c.updateDisplay()}get tRanges(){return this.partitionedTValues}get fnValues(){return this._fnValues}get fnPrimeValues(){return this._fnPrimeValues}get fnPPrimeValues(){return this._fnPPrimeValues}get isClosedCurve(){return this._isClosed}get largestSampleGap(){return this.largestGap}createSamplingPointsAndRecalculateFunctions(){console.debug("SEParametric: createSamplingPointsAnd......");const i=(g,v,p)=>.5*Math.abs(g.value.x*v.value.y+v.value.x*p.value.y+p.value.x*g.value.y-g.value.x*p.value.y-v.value.x*g.value.y-p.value.x*v.value.y),n=5,[r,s]=this.tMinMaxExpressionValues(),o=s-r;let a;const l=[];for(let g=0;g<n;g++){const v=r+g*o/(n-1);this.varMap.set("t",v),a=new k(wt.evaluate(this.coordinateSyntaxTrees.x,this.varMap),wt.evaluate(this.coordinateSyntaxTrees.y,this.varMap),wt.evaluate(this.coordinateSyntaxTrees.z,this.varMap)),l.push({t:v,left:g>0?g-1:this._isClosed?n-1:0,right:g<n-1?g+1:this._isClosed?0:n-1,value:a})}const c=.001,u=[],h=new kle((g,v)=>g.curvature<v.curvature?1:-1,u);let d=l[0],f=l[1];for(let g=2;g<n;g++){const v=l[g],p=i(d,f,v);h.push({index:g-1,curvature:p}),d=f,f=v}for(;h.size()>0;){const v=h.pop().index,p=l[v].left,b=l[p].t,_=l[v].right,P=l[_].t,E=(2*b+P)/3;this.varMap.set("t",E);const T=wt.evaluate(this.coordinateSyntaxTrees.x,this.varMap),C=wt.evaluate(this.coordinateSyntaxTrees.y,this.varMap),M=wt.evaluate(this.coordinateSyntaxTrees.z,this.varMap),x=(b+2*P)/3;this.varMap.set("t",x);const V=wt.evaluate(this.coordinateSyntaxTrees.x,this.varMap),N=wt.evaluate(this.coordinateSyntaxTrees.y,this.varMap),D=wt.evaluate(this.coordinateSyntaxTrees.z,this.varMap),O=l.length,F=v;l[F].t=E,l[F].right=O,l[F].value.set(T,C,M),l.push({t:x,left:F,right:_,value:new k(V,N,D)}),l[_].left=O;let X=!1;const Z=l[p].left,K=i(l[Z],l[p],l[F]),z=u.findIndex(fe=>fe.index==p);z>=0&&(u[z].curvature=K,X=!0);const H=l[_].right,re=i(l[O],l[_],l[H]),ne=u.findIndex(fe=>fe.index==_);ne>=0&&(u[ne].curvature=re,X=!0),X&&h.fix();const B=i(l[p],l[F],l[O]);B>c&&h.push({index:F,curvature:B});const Q=i(l[F],l[O],l[_]);Q>c&&h.push({index:O,curvature:Q})}l.sort((g,v)=>g.t-v.t),this._tValues.splice(0),this._fnValues.splice(0),this._tValues.push(...l.map(g=>g.t)),this._fnValues.push(...l.map(g=>g.value)),this.largestGap=this._fnValues.reduce((g,v,p,b)=>{const _=p+1<b.length?v.distanceTo(b[p+1]):0;return g<_?_:g},0);const m=this._c1DiscontinuityParameterValues.length;if(m===0)this.partitionedTValues.push(this._tValues);else{const g=this._c1DiscontinuityParameterValues.slice(0);this._tNumbers.max>this._c1DiscontinuityParameterValues[m-1]&&g.push(this._tNumbers.max);let v=0;for(const p of g){const b=[];for(;v<this._tValues.length&&this._tValues[v]<p;)b.push(this._tValues[v]),v++;b.length>0&&this.partitionedTValues.push(b.slice(0))}}if(this.tSyntaxTrees.min!==wt.NOT_DEFINED){const g=wt.evaluate(this.tSyntaxTrees.min,this.varMap);this._tNumbers.min=Math.max(this._tNumbersHardLimit.min,g)}else this._tNumbers.min=this._tNumbersHardLimit.min;if(this.tSyntaxTrees.max!==wt.NOT_DEFINED){const g=wt.evaluate(this.tSyntaxTrees.max,this.varMap);this._tNumbers.max=Math.min(this._tNumbersHardLimit.max,g)}else this._tNumbers.max=this._tNumbersHardLimit.max;this.evaluateFunctionAndCache(this._tValues,this.primeCoordinateSyntaxTrees,this._fnPrimeValues),this.evaluateFunctionAndCache(this._tValues,this.primeX2CoordinateSyntaxTrees,this._fnPPrimeValues),this.ref.setRangeAndFunctions(this._tValues,this._fnValues,Math.max(this._tNumbersHardLimit.min,this.tNumbers.min),Math.min(this._tNumbersHardLimit.max,this.tNumbers.max)),this.ref.stylize(Vt.ApplyCurrentVariables),this.ref.adjustSize(),this.varMap.delete("t")}evaluateFunctionAndCache(i,n,r){r.splice(0);let s;for(let o=0;o<i.length;o++){const a=i[o];this.varMap.set("t",a),s=new k(wt.evaluate(n.x,this.varMap),wt.evaluate(n.y,this.varMap),wt.evaluate(n.z,this.varMap)),r.push(s)}this.varMap.delete("t")}lookupFunctionValueAt(i,n,r){n===void 0&&console.debug("I am called by",this.lookupFunctionValueAt.caller.name);const s=n.length;if(s>=2){let o=0;for(;o<s&&i>=this._tValues[o];)o++;if(o--,0<=o&&o+1<s){const a=(i-this._tValues[o])/(this._tValues[o+1]-this._tValues[o]);r.set(0,0,0),r.addScaledVector(n[o],1-a),r.addScaledVector(n[o+1],a)}else o<0?r.copy(n[0]):r.copy(n[s-1])}else console.error(`Attempt to evaluate function value at t=${i} for SEParametric ${this.id} with ${s} fn samples`);return this.tmpVector}P(i){return this.lookupFunctionValueAt(i,this._fnValues,this.pOut).normalize(),this.pOut}PPrime(i){return this.lookupFunctionValueAt(i,this._fnPrimeValues,this.pPrimeOut),this.pPrimeOut}PPPrime(i){return this.lookupFunctionValueAt(i,this._fnPPrimeValues,this.pPrime2Out),this.pPrime2Out}tMinMaxExpressionValues(){if(this.tSyntaxTrees.min===wt.NOT_DEFINED||this.tSyntaxTrees.max===wt.NOT_DEFINED)return[this._tNumbersHardLimit.min,this._tNumbersHardLimit.max];this._seParentExpressions.forEach(r=>{console.debug(`Measurement ${r.name} with value ${r.value}`),this.varMap.set(r.name,r.value)});let i=wt.evaluate(this.tSyntaxTrees.min,this.varMap),n=wt.evaluate(this.tSyntaxTrees.max,this.varMap);return console.debug(`T-min: current=${i} hard limit=${this._tNumbersHardLimit.min}`),console.debug(`T-max: current=${n} hard limit=${this._tNumbersHardLimit.max}`),i=Math.max(i,this._tNumbersHardLimit.min),n=Math.min(n,this._tNumbersHardLimit.max),console.debug(`Effective T-range [${i},${n}]`),[i,n]}customStyles(){return Mle}get noduleDescription(){return String(_e.global.t("objectTree.parametricDescription",{xExpression:this.coordinateExpressions.x,yExpression:this.coordinateExpressions.y,zExpression:this.coordinateExpressions.z,tMinNumber:this.tNumbers.min,tMaxNumber:this.tNumbers.max}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEParametric"}get endPoints(){return this._endPoints}set endPoints(i){this._endPoints.slice(0),this._endPoints.push(...i)}set tracePoint(i){this._tracePoint=i}get tracePoint(){return this._tracePoint}isHitAt(i,n){return this.closestVector(i).distanceTo(i)<S.parametric.hitIdealDistance/n}shallowUpdate(){var r,s,o;this._exists=this._seParentExpressions.every(a=>a.exists);const[i,n]=this.tMinMaxExpressionValues();if(n<=i&&(this._exists=!1),this._exists){this._seParentExpressions.forEach(l=>{this.varMap.set(l.name,l.value)});let a=0;for(const[l,c]of this.varMap){const u=this.prevVarMap.get(l);(!u||Math.abs(c-u)>1e-6)&&(a++,this.prevVarMap.set(l,c))}if(a===0){console.debug("No rebuild of function and its derivatives required");return}a>0&&(console.debug("Recreating sample points due to measurement changes"),this.createSamplingPointsAndRecalculateFunctions()),(r=this.ref)==null||r.updateDisplay()}this.showing&&this._exists?(s=this.ref)==null||s.setVisible(!0):(o=this.ref)==null||o.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Parametric with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"parametric",object:this})}this.updateKids(i,n)}}closestVector(i){let n=0,r=Number.MAX_VALUE;this.fnValues.forEach((u,h)=>{const d=i.distanceTo(u);d<r&&(r=d,n=h)});const s=this._tValues.length,o=this.tmpVector1.copy(i).sub(this.fnValues[n]);let a,l;this._isClosed?(a=(n+1)%s,l=(n-1+s)%s):(n+1<s&&(a=n+1),n>0&&(l=n-1));let c;if(a){const u=this.tmpVector2.copy(this.fnValues[a]).sub(this.fnValues[n]),h=o.dot(u);if(h>=0){c=h/u.lengthSq();const d=(1-c)*this._tValues[n]+c*this._tValues[a];return this.P(d)}}if(l){const u=this.tmpVector2.copy(this.fnValues[l]).sub(this.fnValues[n]),h=o.dot(u);if(h>0){c=h/u.lengthSq();const d=(1-c)*this._tValues[n]+c*this._tValues[l];return this.P(d)}}return this.fnValues[n]}closestLabelLocationVector(i){const n=new k;n.copy(this.closestVector(i));const r=Xe.store.zoomMagnificationFactor;return n.angleTo(i)<S.parametric.maxLabelDistance/r?i:(this.tmpVector1.crossVectors(i,n).normalize(),this.tmpVector2.crossVectors(n,this.tmpVector1).normalize,this.tmpVector2.multiplyScalar(Math.sin(S.parametric.maxLabelDistance/r)),this.tmpVector2.addScaledVector(n,Math.cos(S.parametric.maxLabelDistance/r)).normalize())}accept(i){return i.actionOnParametric(this)}removeDuplicateVectors(i){let n=i.length;const r=[];for(let s=0;s<n;s++){for(let o=s+1;o<n;o++){const a=Math.abs(i[s].normal.dot(i[o].normal));Math.abs(a-1)<1e-6&&r.push(o)}for(let o=r.length-1;o>=0;o--)i.splice(r[o],1),n--;r.splice(0)}}getNormalsToPerpendicularLinesThru(i,n){let r=[];return r=this.partitionedTValues.flatMap(s=>Xe.getNormalsToPerpendicularLinesThruParametrically(this.P.bind(this),this.PPrime.bind(this),i,s,this.PPPrime.bind(this))),this.removeDuplicateVectors(r),r}getNormalsToTangentLinesThru(i,n,r){const[s,o]=r?[this._tNumbersHardLimit.min,this._tNumbersHardLimit.max]:this.tMinMaxExpressionValues();if(o<s)return[];const a=[];if(this.closestVector(i).angleTo(i)<.01/Xe.store.zoomMagnificationFactor){const c=this.partitionedTValues.map(h=>Xe.closestVectorParametrically(this.P.bind(this),this.PPrime.bind(this),i,h,this.PPPrime.bind(this))).reduce((h,d)=>{const f=h.vector.distanceTo(i),m=d.vector.distanceTo(i);return f<m?h:d}).tVal,u=new k;u.copy(this.PPrime(c)),u.cross(this.P(c)),a.push({normal:u.normalize(),tangentAt:this.PPrime(c)})}a.length>0&&console.log("normals to tangent so far",a);const l=this.partitionedTValues.flatMap(c=>Xe.getNormalsToTangentLinesThruParametrically(this.P.bind(this),this.PPrime.bind(this),i,c,this.PPPrime.bind(this))).filter(c=>!c.normal.isZero(S.tolerance/1e3));return l.length>0&&(a.push(...l),console.log("normals to tangent updated",a)),a.forEach((c,u)=>{Math.abs(c.normal.dot(i))>S.tolerance/1e3&&console.log(u,"NOT through point")}),a.length>0&&console.log("unique perpendicular",a),a}get coordinateExpressions(){return this._coordinateExpressions}get c1DiscontinuityParameterValues(){return this._c1DiscontinuityParameterValues}get tExpressions(){return this._tExpressions}get tNumbers(){return this._tNumbers}get seParentExpressions(){return this._seParentExpressions}isOneDimensional(){return!0}isLabelable(){return!0}}_e.global;class Gp extends $t{constructor(i,n,r,s,o){super(n,r,s,!0);y(this,"_seParentOneDimensional");y(this,"_seParentPoint");y(this,"tempVector1",new k);y(this,"_index");this._seParentOneDimensional=i,this._seParentPoint=n,this._index=o}shallowUpdate(){if(this._exists=this._seParentOneDimensional.exists&&this._seParentPoint.exists,this._exists){new k().copy(this._normalVector);const n=this._seParentOneDimensional.getNormalsToTangentLinesThru(this._seParentPoint.locationVector,Xe.store.zoomMagnificationFactor,!0);n[this._index]!==void 0?(this._normalVector.copy(n[this._index].normal),this.tempVector1.crossVectors(this._seParentPoint.locationVector,this._normalVector),this.endSEPoint.locationVector=this.tempVector1.normalize(),this.ref.normalVector=this._normalVector):this._exists=!1}this._exists&&this._showing?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(n.push(this.id),i.has(this.id)){console.log(`Tangent Line Though Point with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"tangentLineThruPoint",object:this})}this.updateKids(i,n)}}set glowing(i){super.glowing=i}get index(){return this._index}get seParentOneDimensional(){return this._seParentOneDimensional}get seParentPoint(){return this._seParentPoint}get noduleDescription(){var n,r;let i;return this._seParentOneDimensional instanceof Kt?i=_e.global.t("objects.circles",3):this._seParentOneDimensional instanceof Ii?i=_e.global.t("objects.ellipses",3):this._seParentOneDimensional instanceof tn&&(i=_e.global.t("objects.parametrics",3)),String(_e.global.t("objectTree.tangentLineThru",{pt:(n=this._seParentPoint.label)==null?void 0:n.ref.shortUserName,oneDimensionalParentType:i,oneDimensionalParent:(r=this._seParentOneDimensional.label)==null?void 0:r.ref.shortUserName,index:this._index}))}isNonFreeLine(){return!0}}const tu=class tu extends pe{constructor(){super();y(this,"_locationVector",new k(1,0,0));y(this,"defaultScreenVectorLocation",new it.Vector(1,0));y(this,"frontPoint");y(this,"backPoint");y(this,"glowingFrontPoint");y(this,"glowingBackPoint");y(this,"glowingFillColorFront",S.point.glowing.fillColor.front);y(this,"glowingStrokeColorFront",S.point.glowing.strokeColor.front);y(this,"glowingFillColorBack",S.point.glowing.fillColor.back);y(this,"glowingStrokeColorBack",S.point.glowing.strokeColor.back);this.frontPoint=new it.Circle(0,0,S.point.drawn.radius.front),this.backPoint=new it.Circle(0,0,S.point.drawn.radius.back),this.glowingFrontPoint=new it.Circle(0,0,S.point.drawn.radius.front+S.point.glowing.annularWidth),this.glowingBackPoint=new it.Circle(0,0,S.point.drawn.radius.back+S.point.glowing.annularWidth),pe.idPlottableDescriptionMap.set(String(this.frontPoint.id),{type:"point",side:"front",fill:!0,part:""}),pe.idPlottableDescriptionMap.set(String(this.backPoint.id),{type:"point",side:"back",fill:!0,part:""}),this.glowingFrontPoint.translation=this.defaultScreenVectorLocation,this.frontPoint.translation=this.defaultScreenVectorLocation,this.glowingBackPoint.translation=this.defaultScreenVectorLocation,this.backPoint.translation=this.defaultScreenVectorLocation,this.frontPoint.linewidth=S.point.drawn.pointStrokeWidth.front,this.backPoint.linewidth=S.point.drawn.pointStrokeWidth.back,this.glowingFrontPoint.linewidth=S.point.drawn.pointStrokeWidth.front,this.glowingBackPoint.linewidth=S.point.drawn.pointStrokeWidth.back,this.styleOptions.set(q.Front,$k),this.styleOptions.set(q.Back,Wk)}static updatePointScaleFactorForZoom(i){tu.pointScaleFactor*=i}set positionVector(i){this._locationVector.copy(i).multiplyScalar(S.boundaryCircle.radius),this.defaultScreenVectorLocation.set(this._locationVector.x,this._locationVector.y),this.updateDisplay()}get positionVector(){return this._locationVector}get pointRadiusPercent(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back);if(!i)return 100;const r=i.pointRadiusPercent??100,s=(n==null?void 0:n.pointRadiusPercent)??90;return this._locationVector.z<0?(n==null?void 0:n.dynamicBackStyle)??!1?pe.contrastPointRadiusPercent(r):s:r}frontGlowingDisplay(){this.frontPoint.visible=!0,this.glowingFrontPoint.visible=!0,this.backPoint.visible=!1,this.glowingBackPoint.visible=!1}backGlowingDisplay(){this.frontPoint.visible=!1,this.glowingFrontPoint.visible=!1,this.backPoint.visible=!0,this.glowingBackPoint.visible=!0}glowingDisplay(){this._locationVector.z>0?this.frontGlowingDisplay():this.backGlowingDisplay()}frontNormalDisplay(){this.frontPoint.visible=!0,this.glowingFrontPoint.visible=!1,this.backPoint.visible=!1,this.glowingBackPoint.visible=!1}backNormalDisplay(){this.frontPoint.visible=!1,this.glowingFrontPoint.visible=!1,this.backPoint.visible=!0,this.glowingBackPoint.visible=!1}normalDisplay(){this._locationVector.z>0?this.frontNormalDisplay():this.backNormalDisplay()}addToLayers(i){this.frontPoint.addTo(i[st.foregroundPoints]),this.glowingFrontPoint.addTo(i[st.foregroundPointsGlowing]),this.backPoint.addTo(i[st.backgroundPoints]),this.glowingBackPoint.addTo(i[st.backgroundPointsGlowing])}removeFromLayers(){this.frontPoint.remove(),this.glowingFrontPoint.remove(),this.backPoint.remove(),this.glowingBackPoint.remove()}updateDisplay(){this.normalDisplay()}setVisible(i){i?this.normalDisplay():(this.frontPoint.visible=!1,this.glowingFrontPoint.visible=!1,this.backPoint.visible=!1,this.glowingBackPoint.visible=!1)}setSelectedColoring(i){i?(this.glowingFillColorFront=S.style.selectedColor.front,this.glowingFillColorBack=S.style.selectedColor.back,this.glowingStrokeColorFront=S.style.selectedColor.front,this.glowingStrokeColorBack=S.style.selectedColor.back):(this.glowingFillColorFront=S.point.glowing.fillColor.front,this.glowingFillColorBack=S.point.glowing.fillColor.back,this.glowingStrokeColorFront=S.point.glowing.strokeColor.front,this.glowingStrokeColorBack=S.point.glowing.strokeColor.back),this.stylize(Vt.ApplyCurrentVariables)}defaultStyleState(i){switch(i){case q.Front:return $k;case q.Back:return{...Wk,pointRadiusPercent:pe.contrastPointRadiusPercent(S.point.radiusPercent.front),strokeColor:pe.contrastStrokeColor(S.point.drawn.strokeColor.front),fillColor:pe.contrastFillColor(S.point.drawn.fillColor.front)};default:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.pointRadiusPercent)??100,s=(n==null?void 0:n.pointRadiusPercent)??90;this.frontPoint.scale=tu.pointScaleFactor*r/100,this.backPoint.scale=tu.pointScaleFactor*((n==null?void 0:n.dynamicBackStyle)??!1?pe.contrastPointRadiusPercent(r):s)/100,this.glowingFrontPoint.scale=tu.pointScaleFactor*r/100,this.glowingBackPoint.scale=tu.pointScaleFactor*((n==null?void 0:n.dynamicBackStyle)??!1?pe.contrastPointRadiusPercent(r):s)/100}stylize(i){switch(i){case Vt.ApplyTemporaryVariables:{pe.hslaIsNoFillOrNoStroke(S.point.temp.fillColor.front)?this.frontPoint.noFill():this.frontPoint.fill=S.point.temp.fillColor.front,this.frontPoint.stroke=S.point.temp.strokeColor.front,pe.hslaIsNoFillOrNoStroke(S.point.temp.fillColor.back)?this.backPoint.noFill():this.backPoint.fill=S.point.temp.fillColor.back,this.backPoint.stroke=S.point.temp.strokeColor.back;break}case Vt.ApplyCurrentVariables:{const n=this.styleOptions.get(q.Front);pe.hslaIsNoFillOrNoStroke(n.fillColor)?this.frontPoint.noFill():this.frontPoint.fill=n.fillColor??S.point.drawn.fillColor.front,pe.hslaIsNoFillOrNoStroke(n.strokeColor)?this.frontPoint.noStroke():this.frontPoint.stroke=n.strokeColor??S.point.drawn.strokeColor.front;const r=this.styleOptions.get(q.Back);r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastFillColor(n.fillColor))?this.backPoint.noFill():this.backPoint.fill=pe.contrastFillColor(n.fillColor):pe.hslaIsNoFillOrNoStroke(r.fillColor)?this.backPoint.noFill():this.backPoint.fill=r.fillColor??S.point.drawn.fillColor.back,r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastStrokeColor(n.strokeColor))?this.backPoint.noStroke():this.backPoint.stroke=pe.contrastStrokeColor(n.strokeColor):pe.hslaIsNoFillOrNoStroke(r.strokeColor)?this.backPoint.noStroke():this.backPoint.stroke=r.strokeColor??S.point.drawn.strokeColor.back,pe.hslaIsNoFillOrNoStroke(this.glowingFillColorFront)?this.glowingFrontPoint.noFill():this.glowingFrontPoint.fill=this.glowingFillColorFront,pe.hslaIsNoFillOrNoStroke(this.glowingStrokeColorBack)?this.glowingFrontPoint.noStroke():this.glowingFrontPoint.stroke=this.glowingStrokeColorBack,pe.hslaIsNoFillOrNoStroke(S.point.glowing.fillColor.back)?this.glowingBackPoint.noFill():this.glowingBackPoint.fill=this.glowingFillColorBack,pe.hslaIsNoFillOrNoStroke(this.glowingStrokeColorBack)?this.glowingBackPoint.noStroke():this.glowingBackPoint.stroke=this.glowingStrokeColorBack;break}}}};y(tu,"pointScaleFactor",1);let mi=tu;class m_ extends mi{constructor(){super();y(this,"nonFreePointScalePercent",S.point.nonFree.scalePercent);this.stylize(Vt.ApplyCurrentVariables),this.adjustSize(),this.styleOptions.set(q.Front,MN),this.styleOptions.set(q.Back,AN)}defaultStyleState(i){switch(i){case q.Front:return MN;case q.Back:return{...AN,pointRadiusPercent:pe.contrastPointRadiusPercent(this.nonFreePointScalePercent),strokeColor:pe.contrastStrokeColor(S.point.nonFree.strokeColor.front),fillColor:pe.contrastFillColor(S.point.nonFree.fillColor.front)};default:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.pointRadiusPercent)??100,s=(n==null?void 0:n.pointRadiusPercent)??90;this.frontPoint.scale=mi.pointScaleFactor*r/100*(this.nonFreePointScalePercent/100),this.backPoint.scale=mi.pointScaleFactor*this.nonFreePointScalePercent/100*((n==null?void 0:n.dynamicBackStyle)??!1?pe.contrastPointRadiusPercent(r):s)/100,this.glowingFrontPoint.scale=mi.pointScaleFactor*this.nonFreePointScalePercent/100*r/100,this.glowingBackPoint.scale=mi.pointScaleFactor*this.nonFreePointScalePercent/100*((n==null?void 0:n.dynamicBackStyle)??!1?pe.contrastStrokeWidthPercent(r):s)/100}}const Ale=new Set([...Object.getOwnPropertyNames($k),...Object.getOwnPropertyNames(Wk)]);class Ze extends Xe{constructor(i=!1){super();y(this,"_pointVisibleBefore",!1);y(this,"label");y(this,"_locationVector",new k);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);const n=i?new m_:new mi;n.stylize(Vt.ApplyCurrentVariables),n.adjustSize(),this.ref=n,Xe.POINT_COUNT++,this.name=`P${Xe.POINT_COUNT}`}customStyles(){return Ale}shallowUpdate(){this.ref.positionVector=this._locationVector,this.showing?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Point with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}const r=new k;r.copy(this._locationVector),n.push(this.id),i.set(this.id,{kind:"point",object:this,locationVector:r})}this.updateKids(i,n)}}set pointVisibleBefore(i){this._pointVisibleBefore=i}get pointVisibleBefore(){return this._pointVisibleBefore}set locationVector(i){this._locationVector.copy(i).normalize(),this.ref.positionVector=this._locationVector}get locationVector(){return this._locationVector}get noduleDescription(){return String(_e.global.t("objectTree.freePoint"))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEPoint"}accept(i){return i.actionOnPoint(this)}closestLabelLocationVector(i,n){const r=n;return this._locationVector.angleTo(i)<S.point.maxLabelDistance/r*this.ref.pointRadiusPercent/100?i:(this.tmpVector1.crossVectors(i,this._locationVector),this.tmpVector1.isZero(S.nearlyAntipodalIdeal)?(this.tmpVector1.set(0,0,1),this.tmpVector2.crossVectors(this._locationVector,this.tmpVector1).isZero(S.nearlyAntipodalIdeal)&&this.tmpVector1.set(0,1,0)):this.tmpVector1.normalize(),this.tmpVector2.crossVectors(this._locationVector,this.tmpVector1).normalize(),this.tmpVector2.multiplyScalar(Math.sin(S.point.maxLabelDistance/r*this.ref.pointRadiusPercent/100)),this.tmpVector2.addScaledVector(this._locationVector,Math.cos(S.point.maxLabelDistance/r*this.ref.pointRadiusPercent/100)).normalize(),this.tmpVector2)}isHitAt(i,n){return this._locationVector.distanceTo(i)<S.point.hitIdealDistance/n*this.ref.pointRadiusPercent/100}isFreePoint(){return!0}isPoint(){return!0}isLabelable(){return!0}}class kt extends Ze{constructor(i){super(!1);y(this,"oneDimensionalParent");y(this,"tmpVector4",new k);this.oneDimensionalParent=i}set locationVector(i){this.oneDimensionalParent.isOutOfDate()?this._locationVector.copy(i):this._locationVector.copy(this.oneDimensionalParent.closestVector(i)).normalize(),this.ref.positionVector=this._locationVector}get locationVector(){return this._locationVector}get noduleDescription(){var n;let i;return this.oneDimensionalParent instanceof Jt?i=_e.global.t("objects.segments",3):this.oneDimensionalParent instanceof $t?i=_e.global.t("objects.lines",3):this.oneDimensionalParent instanceof Kt?i=_e.global.t("objects.circles",3):this.oneDimensionalParent instanceof Ii&&(i=_e.global.t("objects.ellipses",3)),String(_e.global.t("objectTree.pointOnOneDimensional",{parent:(n=this.oneDimensionalParent.label)==null?void 0:n.ref.shortUserName,typeParent:i}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEPointOnOneDimensional"}pointDirectLocationSetter(i){this._locationVector.copy(i).normalize(),this.ref.positionVector=this._locationVector}get parentOneDimensional(){return this.oneDimensionalParent}shallowUpdate(){this._exists=this.oneDimensionalParent.exists,this._exists&&(this._locationVector.copy(this.oneDimensionalParent.closestVector(this._locationVector)).normalize(),this.ref.positionVector=this._locationVector),this._showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Point On One or Two Dimensional with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id);const r=new k;r.copy(this._locationVector),i.set(this.id,{kind:"pointOnOneOrTwoDimensional",object:this,locationVector:r})}this.updateKids(i,n)}}isPointOnOneDimensional(){return!0}}const Pb=new k,id=new k,_g=new k,RT=new k,Es=new k,rs=new k,Xo=new k,rR=new k,ba=new Pt;function y5(t,e,i=!1){const n=[],r={vector:new k,exists:!0},s={vector:new k,exists:!0};if(Es.crossVectors(t.normalVector,e.normalVector).normalize(),r.vector.copy(Es),s.vector.copy(Es.multiplyScalar(-1)),Es.crossVectors(t.normalVector,e.normalVector).isZero(S.nearlyAntipodalIdeal)){if(i)return n;r.exists=!1,s.exists=!1}return n.push(r),n.push(s),n}function lC(t,e,i=!1){const n=[],r={vector:new k,exists:!0},s={vector:new k,exists:!0};if(rs.crossVectors(t.normalVector,e.normalVector).normalize(),Xo.copy(rs).multiplyScalar(-1),r.vector.copy(rs),s.vector.copy(Xo),e.onSegment(rs)||(r.exists=!1),e.onSegment(Xo)||(s.exists=!1),Es.crossVectors(t.normalVector,e.normalVector).isZero(S.nearlyAntipodalIdeal)){if(i)return n;r.exists=!1,s.exists=!1}return n.push(r),n.push(s),n}function cC(t,e){if(t instanceof Gp&&t.seParentOneDimensional.name===e.name){if(t.seParentPoint instanceof kt&&t.seParentPoint.parentOneDimensional.name===e.name)return[];{const i=new k;if(i.crossVectors(t.normalVector,e.centerSEPoint.locationVector),i.cross(t.normalVector),i.dot(e.centerSEPoint.locationVector)>0&&e.circleRadius<=Math.PI/2||i.dot(e.centerSEPoint.locationVector)<0&&e.circleRadius>Math.PI/2)return[{vector:i,exists:!0}];if(i.dot(e.centerSEPoint.locationVector)<0&&e.circleRadius<=Math.PI/2||i.dot(e.centerSEPoint.locationVector)>0&&e.circleRadius>Math.PI/2)return[{vector:i.multiplyScalar(-1),exists:!0}]}}return Ky(t.normalVector,Math.PI/2,e.centerSEPoint.locationVector,e.circleRadius)}function hC(t,e){if(t instanceof Gp&&t.seParentOneDimensional.name===e.name){if(t.seParentPoint instanceof kt&&t.seParentPoint.parentOneDimensional.name===e.name)return[];{const h=new k;h.copy(t.normalVector),h.applyMatrix4(ba.copy(e.ref.ellipseFrame).invert()),h.dot(e.ref.E(1.2312))<0&&h.multiplyScalar(-1);const d=function(b){return e.ref.E(b).dot(h)},f=function(b){return e.Ep(b).dot(h)},m=function(b){return e.Epp(b).dot(h)},g=[];for(let b=0;b<=100;b++)g.push(b*2*Math.PI/100);const v=Xe.findZerosParametrically(f,g,m);let p=v[0];return v.forEach(b=>{d(b)<d(p)&&(p=b)}),h.copy(e.ref.E(p).applyMatrix4(e.ref.ellipseFrame)),[{vector:h,exists:!0}]}}const i=new k;i.copy(t.normalVector),i.applyMatrix4(ba.copy(e.ref.ellipseFrame).invert());const n=function(h){return e.ref.E(h).dot(i)},r=function(h){return e.Ep(h).dot(i)},s=[];for(let h=0;h<=100;h++)s.push(h*2*Math.PI/100);const o=Xe.findZerosParametrically(n,s,r),a=[],l={vector:new k,exists:!1},c={vector:new k,exists:!1};a.push(l),a.push(c);const u=[];return o.forEach(h=>{u.every(d=>(Es.copy(e.ref.E(d)),rs.copy(e.ref.E(h)),Math.abs(h-d)>S.tolerance&&!Xo.subVectors(Es,rs).isZero()))&&u.push(h)}),u.forEach((h,d)=>{d>1?console.debug("Ellipse and Line Intersection still resulted in more than 2 points!",o,u):(a[d].vector.copy(e.ref.E(h).applyMatrix4(e.ref.ellipseFrame)),a[d].exists=!0)}),a}function uC(t,e,i){const[n,r]=e.tMinMaxExpressionValues();if(t instanceof Gp&&t.seParentOneDimensional.name===e.name&&(!(t.seParentPoint instanceof kt)||t.seParentPoint.parentOneDimensional.name!==e.name)){const c=new k;c.copy(t.normalVector),c.applyMatrix4(ba.copy(i).invert());const u=function(g){return e.P(g).dot(c)},h=function(g){return e.PPrime(g).dot(c)},d=function(g){return e.PPrime(g).dot(c)},f=e.tRanges.flatMap(g=>Xe.findZerosParametrically(h,g,d)),m=[];f.forEach(g=>{Math.abs(u(g))<S.tolerance&&n<=g&&g<=r&&m.push(g)}),ba.copy(i).invert(),m.forEach(g=>{new k().copy(e.P(g).applyMatrix4(ba))})}const s=new k;s.copy(t.normalVector),s.applyMatrix4(i);const o=function(c){return e.P(c).dot(s)},a=function(c){return e.PPrime(c).dot(s)},l=e.tRanges.flatMap(c=>Xe.findZerosParametrically(o,c,a));return ba.copy(i).invert(),l.map(c=>{const u=new k;return u.copy(e.P(c)).applyMatrix4(ba),{vector:u,exists:n<=c&&c<=r}})}function S5(t,e,i=!1){const n=[],r={vector:new k,exists:!0},s={vector:new k,exists:!0};if(rs.crossVectors(t.normalVector,e.normalVector).normalize(),Xo.copy(rs).multiplyScalar(-1),r.vector.copy(rs),s.vector.copy(Xo),(!t.onSegment(rs)||!e.onSegment(rs))&&(r.exists=!1),(!t.onSegment(Xo)||!e.onSegment(Xo))&&(s.exists=!1),Es.crossVectors(t.normalVector,e.normalVector).isZero(S.nearlyAntipodalIdeal)){if(i)return n;r.exists=!1,s.exists=!1}return n.push(r),n.push(s),n}function dC(t,e){const i=Ky(t.normalVector,Math.PI/2,e.centerSEPoint.locationVector,e.circleRadius);return i.forEach(n=>{n.vector.isZero()?n.exists=!1:n.exists=t.onSegment(n.vector)}),i}function fC(t,e){const i=new k;i.copy(t.normalVector),i.applyMatrix4(ba.copy(e.ref.ellipseFrame).invert());const n=function(h){return e.ref.E(h).dot(i)},r=function(h){return e.Ep(h).dot(i)},s=[];for(let h=0;h<=100;h++)s.push(h*2*Math.PI/100);const o=Xe.findZerosParametrically(n,s,r),a=[],l={vector:new k,exists:!1},c={vector:new k,exists:!1};a.push(l),a.push(c);const u=[];return o.forEach(h=>{u.every(d=>(Es.copy(e.ref.E(d)),rs.copy(e.ref.E(h)),Math.abs(h-d)>S.tolerance&&!Xo.subVectors(Es,rs).isZero()))&&u.push(h)}),u.forEach((h,d)=>{d>1?console.debug("Ellipse and Segment Intersection still resulted in more than 2 points!",o,u):a[d].vector.copy(e.ref.E(h).applyMatrix4(e.ref.ellipseFrame))}),a.forEach(h=>{h.vector.isZero()?h.exists=!1:h.exists=t.onSegment(h.vector)}),a}function mC(t,e,i){const n=function(a){return e.P(a).dot(t.normalVector)},r=function(a){return e.PPrime(a).dot(t.normalVector)};e.tMinMaxExpressionValues();const s=e.tRanges.flatMap(a=>Xe.findZerosParametrically(n,a,r));return console.log("Number of Para/seg Intersections:",s.length),s.map(a=>{const l=new k;return l.copy(e.P(a)),{vector:l,exists:t.onSegment(l)}})}function Ky(t,e,i,n,r=!1){const s=[],o={vector:new k,exists:!0},a={vector:new k,exists:!0};let l=e;Pb.copy(t).normalize(),e>Math.PI/2&&(l=Math.PI-l,Pb.multiplyScalar(-1));let c=n;id.copy(i).normalize(),n>Math.PI/2&&(c=Math.PI-c,id.multiplyScalar(-1));const u=Pb.angleTo(id);if(r&&(Math.abs(u)<S.tolerance||Math.PI-S.tolerance<Math.abs(u)))return s;if(u<l+c&&l<u+c&&c<u+l){_g.crossVectors(Pb,id).normalize();const h=(l+c+u)/2,d=2*Math.atan(Math.sqrt(Math.sin(h-u)*Math.sin(h-c)/(Math.sin(h)*Math.sin(h-l))));let f,m;return d>0?(f=Math.asin(Math.sin(c)*Math.sin(d)),m=Math.atan(Math.tan(c)*Math.cos(d)),RT.crossVectors(id,_g).normalize()):(f=Math.asin(Math.sin(c)*Math.sin(Math.PI-d)),m=Math.atan(Math.tan(c)*Math.cos(Math.PI-d)),RT.crossVectors(_g,id).normalize()),Es.copy(id).multiplyScalar(Math.cos(m)),Es.addScaledVector(RT,Math.sin(m)),o.vector.copy(Es).multiplyScalar(Math.cos(f)),o.vector.addScaledVector(_g,Math.sin(f)),a.vector.copy(Es).multiplyScalar(Math.cos(-f)),a.vector.addScaledVector(_g,Math.sin(-f)),s.push(o),s.push(a),s}else return o.exists=!1,a.exists=!1,s.push(o),s.push(a),s}function pC(t,e){const i=new k;i.copy(t.centerSEPoint.locationVector),i.applyMatrix4(ba.copy(e.ref.ellipseFrame).invert());const n=t.circleRadius,r=function(f){return Math.acos(Math.max(-1,Math.min(e.ref.E(f).dot(i),1)))-n},s=function(f){return-1*e.Ep(f).dot(i)/Math.sqrt(1-Math.max(-1,Math.min(e.ref.E(f).dot(i),1))*Math.max(-1,Math.min(e.ref.E(f).dot(i),1)))},o=[];for(let f=0;f<=100;f++)o.push(f*2*Math.PI/100);const a=Xe.findZerosParametrically(r,o,s),l=[],c={vector:new k,exists:!1},u={vector:new k,exists:!1},h={vector:new k,exists:!1},d={vector:new k,exists:!1};return l.push(c),l.push(u),l.push(h),l.push(d),a.forEach((f,m)=>{l[m].vector.copy(e.ref.E(f).applyMatrix4(e.ref.ellipseFrame)),l[m].exists=!0}),l}function gC(t,e,i){const n=t.centerSEPoint.locationVector,r=t.circleRadius,s=u=>Math.acos(Math.max(-1,Math.min(e.P(u).dot(n),1)))-r,o=u=>-1*e.PPrime(u).dot(n)/Math.sqrt(1-Math.max(-1,Math.min(e.P(u).dot(n),1))*Math.max(-1,Math.min(e.P(u).dot(n),1))),[a,l]=e.tMinMaxExpressionValues();return e.tRanges.flatMap(u=>Xe.findZerosParametrically(s,u,o)).filter(u=>a<=u&&u<=l).map(u=>({vector:e.P(u).clone(),exists:!0}))}function b5(t,e,i=!1){const n=[];if(i&&(rs.subVectors(t.focus1SEPoint.locationVector,e.focus1SEPoint.locationVector).isZero()&&Xo.subVectors(t.focus2SEPoint.locationVector,e.focus2SEPoint.locationVector).isZero()||rs.subVectors(Es.copy(t.focus1SEPoint.locationVector).multiplyScalar(-1),e.focus2SEPoint.locationVector).isZero()&&Xo.subVectors(rR.copy(t.focus2SEPoint.locationVector).multiplyScalar(-1),e.focus1SEPoint.locationVector).isZero()||rs.subVectors(t.focus1SEPoint.locationVector,e.focus2SEPoint.locationVector).isZero()&&Xo.subVectors(t.focus2SEPoint.locationVector,e.focus1SEPoint.locationVector).isZero()||rs.subVectors(Es.copy(t.focus1SEPoint.locationVector).multiplyScalar(-1),e.focus1SEPoint.locationVector).isZero()&&Xo.subVectors(rR.copy(t.focus2SEPoint.locationVector).multiplyScalar(-1),e.focus2SEPoint.locationVector).isZero()))return n;const r=new k,s=new k;r.copy(t.focus1SEPoint.locationVector),s.copy(t.focus2SEPoint.locationVector),ba.copy(e.ref.ellipseFrame).invert(),r.applyMatrix4(ba),s.applyMatrix4(ba);const o=t.ellipseAngleSum,a=function(g){return Math.acos(Math.max(-1,Math.min(e.ref.E(g).dot(r),1)))+Math.acos(Math.max(-1,Math.min(e.ref.E(g).dot(s),1)))-o},l=function(g){return-1*e.Ep(g).dot(r)/Math.sqrt(1-Math.max(-1,Math.min(e.ref.E(g).dot(r),1))*Math.max(-1,Math.min(e.ref.E(g).dot(r),1)))+-1*e.Ep(g).dot(s)/Math.sqrt(1-Math.max(-1,Math.min(e.ref.E(g).dot(s),1))*Math.max(-1,Math.min(e.ref.E(g).dot(s),1)))},c=[];for(let g=0;g<=100;g++)c.push(g*2*Math.PI/100);const u=Xe.findZerosParametrically(a,c,l),h={vector:new k,exists:!1},d={vector:new k,exists:!1},f={vector:new k,exists:!1},m={vector:new k,exists:!1};return n.push(h),n.push(d),n.push(f),n.push(m),u.forEach((g,v)=>{n[v].vector.copy(e.ref.E(g).applyMatrix4(e.ref.ellipseFrame)),n[v].exists=!0}),n}function vC(t,e,i){const n=t.focus1SEPoint.locationVector,r=t.focus2SEPoint.locationVector,s=t.ellipseAngleSum,o=function(h){return Math.acos(Math.max(-1,Math.min(e.P(h).dot(n),1)))+Math.acos(Math.max(-1,Math.min(e.P(h).dot(r),1)))-s},a=function(h){return-1*e.PPrime(h).dot(n)/Math.sqrt(1-Math.max(-1,Math.min(e.P(h).dot(n),1))*Math.max(-1,Math.min(e.P(h).dot(n),1)))+-1*e.PPrime(h).dot(r)/Math.sqrt(1-Math.max(-1,Math.min(e.P(h).dot(r),1))*Math.max(-1,Math.min(e.P(h).dot(r),1)))},[l,c]=e.tMinMaxExpressionValues();return e.tRanges.flatMap(h=>Xe.findZerosParametrically(o,h,a)).filter(h=>l<=h&&h<=c).map(h=>({vector:e.P(h).clone(),exists:!0}))}function Vle(t,e,i,n,r){const s=new Pi,o=new Pi,a=new k;s.set(i,n);let l,c=0;do{const u=t.PPrime(s.x),h=e.PPrime(s.y);a.subVectors(t.P(s.x),e.P(s.y));const d=u.y*h.x-u.x*h.y,f=(-h.y*a.x+h.x*a.y)/d,m=(-u.y*a.x+u.x*a.y)/d;o.set(s.x-f,s.y-m),l=o.distanceTo(s),s.copy(o),c++}while(l>1e-5&&c<50);if(c<50){const u=t.P(s.x).z,h=e.P(s.y).z;return console.debug(`Nearby (${i}, ${n}) converges to intersection at (S,T) = (${s.x}, ${s.y})`,"Z-check",u,h),u*h>0?{s:s.x,t:s.y,pointDistance:a.length()}:void 0}else{console.debug(`Nearby (${i}, ${n}) does not converge`);return}}function _5(t,e){let i,n;t.tRanges.length>e.tRanges.length?(i=e,n=t):(i=t,n=e);const r=i.largestSampleGap/2,s=n.largestSampleGap/2,o=Math.min(Math.sqrt(r*r+s*s),.01),a=new Cle(h=>h.distance);i.tRanges.forEach((h,d)=>{h.forEach((f,m)=>{const g=i.P(f),v=p=>n.P(p).distanceTo(g);n.tRanges.forEach((p,b)=>{p.forEach((_,P)=>{v(_)<o&&a.push({sPart:d,sIndex:m,tPart:b,tIndex:P,distance:v(_)})})})})}),console.debug(`${t.name}/${e.name} possible intersection`,a.size());const l=[];for(;a.size()>0;){const{sPart:h,sIndex:d,tPart:f,tIndex:m,distance:g}=a.pop(),v=i.tRanges[h][d],p=n.tRanges[f][m];console.debug(`Possible intersection at S-value ${v} and T-value ${p} with distance ${g}`);const b=Vle(i,n,v,p);typeof b<"u"&&l.push(b.s)}l.sort((h,d)=>h-d);let c=Number.POSITIVE_INFINITY;const u=l.filter(h=>Math.abs(h-c)>1e-5?(c=h,!0):!1).map(h=>({exists:!0,vector:i.P(h).clone()}));return console.debug("Computed intersection",u.length),u}function lm(t,e,i){if(console.debug(`Intersect two objects ${t.name} and ${e.name}. order ${t.name<e.name}`),t instanceof $t){if(e instanceof $t)return y5(t,e);if(e instanceof Jt)return lC(t,e);if(e instanceof Kt)return cC(t,e);if(e instanceof Ii)return hC(t,e);if(e instanceof tn)return uC(t,e,i)}else if(t instanceof Jt){if(e instanceof Jt)return S5(t,e);if(e instanceof Kt)return dC(t,e);if(e instanceof Ii)return fC(t,e);if(e instanceof tn)return mC(t,e)}else if(t instanceof Kt){if(e instanceof Kt)return Ky(t.centerSEPoint.locationVector,t.circleRadius,e.centerSEPoint.locationVector,e.circleRadius);if(e instanceof Ii)return pC(t,e);if(e instanceof tn)return gC(t,e)}else if(t instanceof Ii){if(e instanceof Ii)return b5(t,e);if(e instanceof tn)return vC(t,e)}else if(t instanceof tn&&e instanceof tn){const n=_5(t,e);return n.forEach((r,s)=>{console.debug(`Intersection #${s} at ${r.vector.toFixed(4)}`)}),n}throw`Attempted to intersect non-one dimensional objects ${t.name} and ${e.name}`}class P5 extends Sa{constructor(){super();y(this,"nonFreeCircleScalePercent",S.circle.nonFree.scalePercent);this.stylize(Vt.ApplyCurrentVariables),this.adjustSize(),this.styleOptions.set(q.Front,DN),this.styleOptions.set(q.Back,NN)}defaultStyleState(i){switch(i){case q.Front:return DN;case q.Back:return{...NN,strokeWidthPercent:pe.contrastStrokeWidthPercent(this.nonFreeCircleScalePercent),strokeColor:pe.contrastStrokeColor(S.circle.nonFree.strokeColor.front)};default:return{}}}adjustSize(){const i=this.styleOptions.get(q.Front),n=this.styleOptions.get(q.Back),r=(i==null?void 0:i.strokeWidthPercent)??100,s=(n==null?void 0:n.strokeWidthPercent)??100;this.frontPart.linewidth=Sa.currentCircleStrokeWidthFront*r/100*(this.nonFreeCircleScalePercent/100),this.backPart.linewidth=Sa.currentCircleStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100*(this.nonFreeCircleScalePercent/100),this.glowingFrontPart.linewidth=Sa.currentGlowingCircleStrokeWidthFront*r/100*(this.nonFreeCircleScalePercent/100),this.glowingBackPart.linewidth=Sa.currentGlowingCircleStrokeWidthBack*(n!=null&&n.dynamicBackStyle?pe.contrastStrokeWidthPercent(r):s)/100*(this.nonFreeCircleScalePercent/100)}}_e.global;const Lle=new Set([...Object.getOwnPropertyNames(qk),...Object.getOwnPropertyNames(Kk)]);class Kt extends Xe{constructor(i,n,r){super();y(this,"label");y(this,"_centerSEPoint");y(this,"_circleSEPoint");y(this,"changeInPositionRotationMatrix",new Pt);y(this,"desiredZAxis",new k);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);this._centerSEPoint=i,this._circleSEPoint=n,this.ref=r?new P5:new Sa,this.ref.centerVector=i.locationVector,this.ref.circleRadius=this.circleRadius,this.ref.updateDisplay(),this.ref.stylize(Vt.ApplyCurrentVariables),this.ref.adjustSize(),Kt.CIRCLE_COUNT++,this.name=`C${Kt.CIRCLE_COUNT}`}customStyles(){return Lle}get centerSEPoint(){return this._centerSEPoint}get circleSEPoint(){return this._circleSEPoint}get circleRadius(){return this._circleSEPoint.locationVector.angleTo(this._centerSEPoint.locationVector)}get noduleDescription(){var i,n,r,s,o,a;if(this._centerSEPoint instanceof QM){if(Math.abs(this._centerSEPoint.locationVector.angleTo(this._centerSEPoint.seParentPoint1.locationVector)-this.circleRadius)<S.tolerance)return String(_e.global.t("objectTree.threePointCircleThrough",{pt1:(i=this._centerSEPoint.seParentPoint1.label)==null?void 0:i.ref.shortUserName,pt2:(n=this._centerSEPoint.seParentPoint2.label)==null?void 0:n.ref.shortUserName,pt3:(r=this._centerSEPoint.seParentPoint3.label)==null?void 0:r.ref.shortUserName}))}else if(this._centerSEPoint instanceof jc){const l=this._centerSEPoint.seParentCircleOrLine instanceof $t?_e.global.t("objects.lines",3):_e.global.t("objects.circles",3);return String(_e.global.t("objectTree.inversionImageOfACircle",{circleOrLine:l,circleOrLineParentName:(s=this._centerSEPoint.seParentCircleOrLine.label)==null?void 0:s.ref.shortUserName,inversionParentName:this._centerSEPoint.parentTransformation.name}))}return String(_e.global.t("objectTree.circleThrough",{center:(o=this._centerSEPoint.label)==null?void 0:o.ref.shortUserName,through:(a=this._circleSEPoint.label)==null?void 0:a.ref.shortUserName}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SECircle"}isHitAt(i,n){const r=i.angleTo(this._centerSEPoint.locationVector);return Math.abs(r-this.circleRadius)<S.circle.hitIdealDistance/n}shallowUpdate(){if(this._exists=this._centerSEPoint.exists&&this._circleSEPoint.exists,this._exists){const i=this._centerSEPoint.locationVector.angleTo(this._circleSEPoint.locationVector);this.ref.circleRadius=i,this.ref.centerVector=this._centerSEPoint.locationVector,this.ref.updateDisplay()}this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Circle with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"circle",object:this})}this.updateKids(i,n)}}closestVector(i){return this.tmpVector.crossVectors(this._centerSEPoint.locationVector,i),this.tmpVector.isZero(S.nearlyAntipodalIdeal)?this._circleSEPoint.locationVector:(this.tmpVector.normalize(),this.tmpVector.cross(this._centerSEPoint.locationVector).normalize(),this.tmpVector.multiplyScalar(Math.sin(this.circleRadius)),this.tmpVector.addScaledVector(this._centerSEPoint.locationVector,Math.cos(this.circleRadius)).normalize(),this.tmpVector)}closestLabelLocationVector(i,n){this.tmpVector.copy(this.closestVector(i));const r=n;return this.tmpVector.angleTo(i)<S.circle.maxLabelDistance/r?i:(this.tmpVector1.crossVectors(i,this.tmpVector).normalize(),this.tmpVector2.crossVectors(this.tmpVector,this.tmpVector1).normalize,this.tmpVector2.multiplyScalar(Math.sin(S.circle.maxLabelDistance/r)),this.tmpVector2.addScaledVector(this.tmpVector,Math.cos(S.circle.maxLabelDistance/r)).normalize())}accept(i){return i.actionOnCircle(this)}getNormalsToPerpendicularLinesThru(i,n){return this.tmpVector.crossVectors(i,this._centerSEPoint.locationVector).normalize(),this.tmpVector1.copy(this._centerSEPoint.locationVector),this.tmpVector1.applyAxisAngle(this.tmpVector,this.circleRadius),this.tmpVector2.copy(this._centerSEPoint.locationVector),this.tmpVector2.applyAxisAngle(this.tmpVector,-this.circleRadius),this.tmpVector.isZero(S.nearlyAntipodalIdeal)&&this.tmpVector.copy(n).addScaledVector(i,-1*n.dot(i)),[{normal:this.tmpVector,normalAt:this.tmpVector1.normalize()},{normal:this.tmpVector,normalAt:this.tmpVector2.normalize()}]}getNormalsToTangentLinesThru(i,n,r){const s=i.angleTo(this._centerSEPoint.locationVector);if(Math.abs(s-this.circleRadius)<.005/n||Math.abs(s+this.circleRadius-Math.PI)<.005/n){const l=new k;return l.crossVectors(i,this._centerSEPoint.locationVector),l.cross(i),[{normal:l.normalize(),tangentAt:i}]}if(Math.abs(this.circleRadius-Math.PI/2)<S.tolerance||this.circleRadius<Math.PI/2&&(s<this.circleRadius||s>Math.PI-this.circleRadius)||this.circleRadius>Math.PI/2&&(s<Math.PI-this.circleRadius||s>this.circleRadius))return[];let o;this.circleRadius<Math.PI?o=Math.acos(Math.cos(s)/Math.cos(this.circleRadius)):o=Math.acos(Math.cos(s)/Math.cos(Math.PI-this.circleRadius));const a=Ky(this._centerSEPoint.locationVector,this.circleRadius,i,o);return this.tmpVector.crossVectors(a[0].vector,this._centerSEPoint.locationVector),this.tmpVector1.crossVectors(a[1].vector,this._centerSEPoint.locationVector),[{normal:this.tmpVector.cross(a[0].vector).normalize(),tangentAt:a[0].vector},{normal:this.tmpVector1.cross(a[1].vector).normalize(),tangentAt:a[1].vector}]}move(i,n){const r=i.angleTo(n);Math.abs(r)>S.rotate.minAngle&&(this.desiredZAxis.crossVectors(i,n).normalize(),this.changeInPositionRotationMatrix.makeRotationAxis(this.desiredZAxis,r),this.tmpVector1.copy(this.centerSEPoint.locationVector).applyMatrix4(this.changeInPositionRotationMatrix),this.centerSEPoint.locationVector=this.tmpVector1,this.tmpVector.copy(this.circleSEPoint.locationVector).applyMatrix4(this.changeInPositionRotationMatrix),this.circleSEPoint.locationVector=this.tmpVector,this.circleSEPoint.markKidsOutOfDate(),this.centerSEPoint.markKidsOutOfDate(),this.circleSEPoint.update(),this.centerSEPoint.update())}isOneDimensional(){return!0}isLabelable(){return!0}isMeasurable(){return!0}}function Ol(t){return t instanceof $t?1:t instanceof Jt?2:t instanceof Kt?3:t instanceof Ii?4:t instanceof tn?5:Number.MAX_VALUE}function FT(t){const e=[...t];let i=e.length,n=0;for(;n<i;){const r=e[n];n+=1,r.parents.forEach(s=>{e.some(o=>o.id===s.id)||(e.push(s),i+=1)})}return e}function Ile(t){const e=[...t];let i=e.length,n=0;for(;n<i;){const r=e[n];n+=1,r.kids.forEach(s=>{e.some(o=>o.id===s.id)||(e.push(s),i+=1)})}return e}_e.global;class Le extends Ze{constructor(i,n,r,s){super(!0);y(this,"_isUserCreated",!1);y(this,"_isAntipodeMode",!1);y(this,"_antipodalPointId",-1);y(this,"sePrincipleParent1");y(this,"sePrincipleParent2");y(this,"otherSEParents",[]);y(this,"order");y(this,"tempVector",new k);this.ref.stylize(Vt.ApplyTemporaryVariables),this.sePrincipleParent1=i,this.sePrincipleParent2=n,this.order=r,s?(this._isUserCreated=!0,this.showing=!0):(this._isUserCreated=!1,this.showing=!1)}set antipodalPointId(i){if(i===-1)this._antipodalPointId=-1,this._isAntipodeMode=!1;else{const n=Xe.store.getSENoduleById(i);if(n instanceof Le&&!n._isAntipodeMode)this._antipodalPointId=i,this._isAntipodeMode=!0;else throw new Error(`Attempting to set a seIntersectionPoint antipodal with a nonSEIntersection Point (${n instanceof Le}) or the seIntersectionPoint is already in antipode mode`)}}get antipodalPointId(){return this._antipodalPointId}get isAntipodal(){return this._isAntipodeMode}get noduleDescription(){var r,s;let i;this.sePrincipleParent1 instanceof Jt?i=_e.global.t("objects.segments",3):this.sePrincipleParent1 instanceof $t?i=_e.global.t("objects.lines",3):this.sePrincipleParent1 instanceof Kt?i=_e.global.t("objects.circles",3):this.sePrincipleParent1 instanceof Ii&&(i=_e.global.t("objects.ellipses",3));let n;return this.sePrincipleParent2 instanceof Jt?n=_e.global.t("objects.segments",3):this.sePrincipleParent2 instanceof $t?n=_e.global.t("objects.lines",3):this.sePrincipleParent2 instanceof Kt?n=_e.global.t("objects.circles",3):this.sePrincipleParent2 instanceof Ii&&(n=_e.global.t("objects.ellipses",3)),String(_e.global.t("objectTree.intersectionPoint",{parent1:(r=this.sePrincipleParent1.label)==null?void 0:r.ref.shortUserName,typeParent1:i,parent2:(s=this.sePrincipleParent2.label)==null?void 0:s.ref.shortUserName,typeParent2:n,index:this.order}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEIntersectionPoint"}get principleParent1(){return this.sePrincipleParent1}get principleParent2(){return this.sePrincipleParent2}get intersectionOrder(){return this.order}set isUserCreated(i){this._isUserCreated=i}get isUserCreated(){return this._isUserCreated}get otherParentArray(){return this.otherSEParents}addIntersectionOtherParent(i){!this.otherSEParents.some(n=>i.name===n.name)&&i.name!==this.principleParent1.name&&i.name!==this.principleParent2.name?this.otherSEParents.push(i):console.warn(`SEIntersection Point ${this.name}: Attempted to add nodule ${i.name} that was already on the other parent array or is a principle parent.`),this.updateExistenceWithParentChange()}removeIntersectionOtherParent(i){const n=this.otherParentArray.findIndex(r=>r.name===i.name);n>-1?this.otherSEParents.splice(n,1):console.warn(`SEIntersection Point ${this.name}: Attempted to remove nodule ${i.name} that was not on the other parent array.`),this.updateExistenceWithParentChange()}removePrincipleParent(i){if((this.sePrincipleParent1.name===i.name||this.sePrincipleParent2.name===i.name)&&this.otherSEParents.length>0){const n=Ile([this]),r=this.sePrincipleParent1.name===i.name?this.sePrincipleParent2:this.sePrincipleParent1,s=FT([r]);let o=0,a=[...FT([this.otherParentArray[o]]),...s],l=n.filter(f=>!!a.some(m=>m.id===f.id)),c=this.checkIntersectionBetweenTwoPotentialParents(r,this.otherParentArray[o]);for(;l.length>0||c===-1;)if(o+=1,o>this.otherParentArray.length)a=[...FT([this.otherParentArray[o]]),...s],l=n.filter(f=>!!a.some(m=>m.id===f.id)),c=this.checkIntersectionBetweenTwoPotentialParents(r,this.otherParentArray[o]);else return null;const u=this.otherParentArray[o];this.order=c,this.sePrincipleParent1.name===i.name?this.sePrincipleParent1=u:this.sePrincipleParent2=u,this.otherParentArray.splice(o,1);const h=Ol(this.principleParent1),d=Ol(this.principleParent2);if(h===d&&this.sePrincipleParent1.name>this.sePrincipleParent2.name||d<h){const f=this.sePrincipleParent1;this.sePrincipleParent1=this.sePrincipleParent2,this.sePrincipleParent2=f}return this.updateExistenceWithParentChange(),u}else return null}checkIntersectionBetweenTwoPotentialParents(i,n){i.shallowUpdate(),n.shallowUpdate();const r=Ol(i),s=Ol(n),o=[];r===s&&i.name<n.name||r<s?o.push(...lm(i,n,Xe.store.inverseTotalRotationMatrix)):o.push(...lm(n,i,Xe.store.inverseTotalRotationMatrix));let a=-1;return o.forEach((l,c)=>{this.tempVector.subVectors(l.vector,this.locationVector).isZero(S.intersectionTolerance)&&(a=c)}),a}replacePrincipleParent(i,n){if(i.id===this.principleParent1.id)this.sePrincipleParent1=n;else if(i.id===this.principleParent2.id)this.sePrincipleParent2=n;else throw new Error(`SEIntersectionPoint: Using replacePrincipleParent and the existingPrincipleParent ${i.name}is not one of the existing principle parents.`);this.otherParentArray.push(i);const r=Ol(this.principleParent1),s=Ol(this.principleParent2);if(r===s&&this.principleParent2.name>this.principleParent1.name||s<r){const l=this.principleParent1;this.sePrincipleParent1=this.principleParent2,this.sePrincipleParent2=l}this.sePrincipleParent1.shallowUpdate(),this.sePrincipleParent2.shallowUpdate();const o=lm(this.sePrincipleParent1,this.sePrincipleParent2,Xe.store.inverseTotalRotationMatrix);let a=!1;if(o.forEach((l,c)=>{console.debug(`Point ${this.name} x diff ${l.vector.x-this.locationVector.x}, y diff ${l.vector.y-this.locationVector.y}, z diff ${l.vector.z-this.locationVector.z}`),this.tempVector.subVectors(l.vector,this.locationVector).isZero(S.intersectionTolerance)&&(a=!0,this.order=c)}),this.updateExistenceWithParentChange(),!a)throw new Error("Update Intersection Point:  Order update error. Current location not found in intersection between the two new principle parents.")}updateExistenceWithParentChange(){const i=[this.sePrincipleParent1,this.sePrincipleParent2,...this.otherSEParents];for(let n=0;n<i.length;n++)for(let r=n+1;r<i.length;r++){let s=i[n],o=i[r];const a=Ol(s),l=Ol(o);if(a===l&&o.name>s.name||l<a){const u=s;s=o,o=u}const c=lm(s,o,Xe.store.inverseTotalRotationMatrix);if(c[this.order]!==void 0&&(console.debug(`Check existence ${c[this.order].exists}, z component of intersection ${c[this.order].vector.z} order ${this.order}`),this._exists=c[this.order].exists,this._exists))return}}shallowUpdate(){if(this._isAntipodeMode){const i=Xe.store.getSENoduleById(this._antipodalPointId);i instanceof Ze&&(i.shallowUpdate(),this._exists=i.exists,this._exists&&(this.tempVector.copy(i.locationVector).multiplyScalar(-1),this.locationVector=this.tempVector))}else{console.debug("shallow update intersection");const i=lm(this.sePrincipleParent1,this.sePrincipleParent2,Xe.store.inverseTotalRotationMatrix);if(i[this.order]!==void 0)if(this.locationVector.angleTo(i[this.order].vector)<Math.PI/2+S.tolerance)this.locationVector=i[this.order].vector,this._exists=i[this.order].exists;else{let n=-1,r=Math.PI;i.forEach((s,o)=>{const a=s.vector.angleTo(this.locationVector);a<r&&(n=o,r=a)}),this.order=n,this.locationVector=i[this.order].vector,this._exists=i[this.order].exists}else this._exists=!1}this._exists&&this._isUserCreated&&this._showing?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Intersection point with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"intersectionPoint",object:this})}this.updateKids(i,n)}}set glowing(i){this._isUserCreated?super.glowing=i:this.ref.setVisible(i)}isNonFreePoint(){return!0}isFreePoint(){return!1}}const Ole=new Set;class $n extends Xe{constructor(){super();y(this,"customStyles",()=>Ole);$n.TRANSFORMATION_COUNT++}accept(i){return!1}isHitAt(i,n){return!1}isTransformation(){return!0}}_e.global;class zr extends $n{constructor(i){super();y(this,"_circleOfInversion");y(this,"perpVector",new k);y(this,"toVector",new k);this._circleOfInversion=i,this.ref=i.ref,$n.INVERSION_COUNT++,this.name=`In${$n.INVERSION_COUNT}`,this.markKidsOutOfDate(),this.update()}get seCircleOfInversion(){return this._circleOfInversion}get geometricChild(){return this._circleOfInversion}f(i){const n=new k,r=i.angleTo(this._circleOfInversion.centerSEPoint.locationVector);if(r<S.tolerance)n.copy(i).multiplyScalar(-1);else if(r>Math.PI-S.tolerance)n.copy(i);else{const s=2*Math.atan(Math.tan(.5*this._circleOfInversion.circleRadius)*Math.tan(.5*this._circleOfInversion.circleRadius)/Math.tan(.5*r));this.perpVector.crossVectors(i,this._circleOfInversion.centerSEPoint.locationVector).normalize(),this.toVector.crossVectors(this._circleOfInversion.centerSEPoint.locationVector,this.perpVector).normalize(),n.copy(this._circleOfInversion.centerSEPoint.locationVector).multiplyScalar(Math.cos(s)),n.addScaledVector(this.toVector,Math.sin(s))}return n}shallowUpdate(){this._exists=this._circleOfInversion.exists}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Inversion with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"inversion",object:this})}this.updateKids(i,n)}}get noduleItemText(){return this.name??"No Inversion Name In SEInversion"}get noduleDescription(){var i;return String(_e.global.t("objectTree.invertOverCircle",{circle:(i=this._circleOfInversion.label)==null?void 0:i.ref.shortUserName}))}}_e.global;class jc extends Ze{constructor(i,n){super(!0);y(this,"_seCircleOrLineParent");y(this,"_seInversion");y(this,"tempVector1",new k);y(this,"tempVector2",new k);y(this,"tempVector3",new k);this._seCircleOrLineParent=i,this._seInversion=n}get noduleDescription(){var i;return String(_e.global.t("objectTree.centerOfTransformedCircleUnderInversion",{circleOrLine:this._seCircleOrLineParent instanceof $t?_e.global.t("objects.lines",3):_e.global.t("objects.circles",3),circleOrLineName:(i=this._seCircleOrLineParent.label)==null?void 0:i.ref.shortUserName,inversionName:this._seInversion.name}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEThreePointCircleCenter"}get seParentCircleOrLine(){return this._seCircleOrLineParent}get parentTransformation(){return this._seInversion}shallowUpdate(){if(this._exists=this._seCircleOrLineParent.exists&&this._seInversion.exists,this._exists){const i=this._seCircleOrLineParent instanceof Kt?this._seCircleOrLineParent.centerSEPoint.locationVector:this._seCircleOrLineParent.normalVector;if(this.tempVector1.subVectors(i,this._seInversion.seCircleOfInversion.centerSEPoint.locationVector).isZero())this.locationVector=this.tempVector3.copy(i).multiplyScalar(-1);else if(this.tempVector1.addVectors(i,this._seInversion.seCircleOfInversion.centerSEPoint.locationVector).isZero())this.locationVector=this._seInversion.seCircleOfInversion.centerSEPoint.locationVector;else{const n=this._seInversion.seCircleOfInversion.centerSEPoint.locationVector.angleTo(i),r=this._seCircleOrLineParent instanceof Kt?this._seCircleOrLineParent.circleRadius:Math.PI/2,s=this._seInversion.seCircleOfInversion.circleRadius,o=Math.atan(-Math.sin(s)*Math.sin(s)*Math.sin(n)/((1+Math.cos(s)*Math.cos(s))*Math.cos(n)-2*Math.cos(s)*Math.cos(r)));this.tempVector1.crossVectors(i,this._seInversion.seCircleOfInversion.centerSEPoint.locationVector).normalize(),this.tempVector2.crossVectors(this._seInversion.seCircleOfInversion.centerSEPoint.locationVector,this.tempVector1).normalize(),this._locationVector.copy(this._seInversion.seCircleOfInversion.centerSEPoint.locationVector).multiplyScalar(Math.cos(o)),this._locationVector.addScaledVector(this.tempVector2,Math.sin(o))}this.ref.positionVector=this._locationVector,this.ref.updateDisplay()}this._showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Inversion Circle center with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"invertedCircleCenter",object:this})}this.updateKids(i,n)}}isNonFreePoint(){return!0}isFreePoint(){return!1}}_e.global;class Jg extends Kt{constructor(i,n,r,s){super(i,n,!0);y(this,"_seParentCircle");y(this,"_seParentIsometry");y(this,"transType","");this._seParentCircle=r,this._seParentIsometry=s,this._seParentIsometry instanceof is?this.transType=_e.global.t("objects.translations",3):this._seParentIsometry instanceof ts?this.transType=_e.global.t("objects.rotations",3):this._seParentIsometry instanceof Qi?this.transType=_e.global.t("objects.reflections",3):this._seParentIsometry instanceof er&&(this.transType=_e.global.t("objects.pointReflections",3))}get parentCircle(){return this._seParentCircle}get parentIsometry(){return this._seParentIsometry}get noduleDescription(){var i;return String(_e.global.t("objectTree.transformationObject",{object:_e.global.t("objects.circles",3),name:(i=this._seParentCircle.label)==null?void 0:i.ref.shortUserName,trans:this._seParentIsometry.name,transType:this.transType}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SECircle"}shallowUpdate(){if(this._exists=this._seParentCircle.exists&&this._seParentIsometry.exists,this._exists){const i=this._centerSEPoint.locationVector.angleTo(this._circleSEPoint.locationVector);this.ref.circleRadius=i,this.ref.centerVector=this._centerSEPoint.locationVector,this.ref.updateDisplay()}this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Isometry Circle with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"isometryCircle",object:this})}this.updateKids(i,n)}}isNonFreeCircle(){return!0}}_e.global;class Qg extends Ii{constructor(i,n,r,s,o){super(i,n,r,!0);y(this,"_seParentEllipse");y(this,"_seParentIsometry");y(this,"transType","");this._seParentEllipse=s,this._seParentIsometry=o,this._seParentIsometry instanceof is?this.transType=_e.global.t("objects.translations",3):this._seParentIsometry instanceof ts?this.transType=_e.global.t("objects.rotations",3):this._seParentIsometry instanceof Qi?this.transType=_e.global.t("objects.reflections",3):this._seParentIsometry instanceof er&&(this.transType=_e.global.t("objects.pointReflections",3))}get parentEllipse(){return this._seParentEllipse}get parentIsometry(){return this._seParentIsometry}get noduleDescription(){var i;return String(_e.global.t("objectTree.transformationObject",{object:_e.global.t("objects.ellipses",3),name:(i=this._seParentEllipse.label)==null?void 0:i.ref.shortUserName,trans:this._seParentIsometry.name,transType:this.transType}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEIsometryEllipse"}shallowUpdate(){this._exists=this._seParentEllipse.exists&&this._seParentIsometry.exists,this._exists&&(this.a=this._seParentEllipse.a,this.b=this._seParentEllipse.b,this.ref.a=this._seParentEllipse.a,this.ref.b=this._seParentEllipse.b,this.ref.focus1Vector=this.focus1SEPoint.locationVector,this.ref.focus2Vector=this.focus2SEPoint.locationVector,this.ref.updateDisplay()),this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`IsometryEllipse with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"isometryEllipse",object:this})}this.updateKids(i,n)}}isNonFreeEllipse(){return!0}}_e.global;[...Object.getOwnPropertyNames(Bv),...Object.getOwnPropertyNames(jv)];class ev extends $t{constructor(i,n,r,s,o){super(i,n,r,!0);y(this,"_seParentLine");y(this,"_seParentIsometry");y(this,"transType","");this._seParentLine=s,this._seParentIsometry=o,this._seParentIsometry instanceof is?this.transType=_e.global.t("objects.translations",3):this._seParentIsometry instanceof ts?this.transType=_e.global.t("objects.rotations",3):this._seParentIsometry instanceof Qi?this.transType=_e.global.t("objects.reflections",3):this._seParentIsometry instanceof er&&(this.transType=_e.global.t("objects.pointReflections",3))}get parentLine(){return this._seParentLine}get parentIsometry(){return this._seParentIsometry}get noduleDescription(){var i;return String(_e.global.t("objectTree.transformationObject",{object:_e.global.t("objects.lines",3),name:(i=this._seParentLine.label)==null?void 0:i.ref.shortUserName,trans:this._seParentIsometry.name,transType:this.transType}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEIsometryLine"}shallowUpdate(){this._exists=this._seParentIsometry.exists&&this._seParentLine.exists,this._exists&&(this.normalVector.copy(this.parentIsometry.f(this._seParentLine.normalVector)),this.ref.normalVector=this.normalVector),this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Isometry Line with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id);const r=new k;r.copy(this._normalVector),i.set(this.id,{kind:"isometryLine",object:this,normalVector:r})}this.updateKids(i,n)}}isNonFreeLine(){return!0}}_e.global;class tv extends Jt{constructor(i,n,r,s,o,a){var e=(...args)=>{super(...args);y(this,"_seParentSegment");y(this,"_seParentIsometry");y(this,"transType")};console.debug("Type of the parent isometry segment: ",a instanceof Qi),a instanceof Qi?e(s,n,r,i,!0):e(i,n,r,s,!0),this._seParentSegment=o,this._seParentIsometry=a,this._seParentIsometry instanceof is?this.transType=_e.global.t("objects.translations",3):this._seParentIsometry instanceof ts?this.transType=_e.global.t("objects.rotations",3):this._seParentIsometry instanceof Qi?this.transType=_e.global.t("objects.reflections",3):this._seParentIsometry instanceof er?this.transType=_e.global.t("objects.pointReflections",3):this.transType=""}get parentSegment(){return this._seParentSegment}get parentIsometry(){return this._seParentIsometry}get noduleDescription(){var i;return String(_e.global.t("objectTree.transformationObject",{object:_e.global.t("objects.segments",3),name:(i=this._seParentSegment.label)==null?void 0:i.ref.shortUserName,trans:this._seParentIsometry.name,transType:this.transType}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SETransformedSegment"}shallowUpdate(){this._exists=this._seParentSegment.exists&&this._seParentIsometry.exists,this._exists&&(this.normalVector.copy(this.parentIsometry.f(this._seParentSegment.normalVector)),this.arcLength=this._seParentSegment.arcLength,this.ref.startVector=this.startSEPoint.locationVector,this.ref.arcLength=this.arcLength,this.ref.normalVector=this.normalVector,this.ref.updateDisplay()),this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Isometry Segment with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id);const r=new k;r.copy(this.normalVector),i.set(this.id,{kind:"isometrySegment",object:this,normalVector:r,arcLength:this.arcLength})}this.updateKids(i,n)}}isNonFreeSegment(){return!0}}const iu=class iu extends pe{constructor(i){super();y(this,"_locationVector",new k(1,0,0));y(this,"defaultScreenVectorLocation",new it.Vector(1,0));y(this,"frontText",new it.Text("Test",1,0,{size:S.label.fontSize}));y(this,"backText",new it.Text("Test",1,0,{size:S.label.fontSize}));y(this,"glowingFrontText",new it.Text("Test",1,0,{size:S.label.fontSize}));y(this,"glowingBackText",new it.Text("Test",1,0,{size:S.label.fontSize}));y(this,"glowingStrokeColorFront",S.label.glowingStrokeColor.front);y(this,"glowingStrokeColorBack",S.label.glowingStrokeColor.back);y(this,"seLabelParentType","point");y(this,"_valueDisplayMode",Ni.Number);y(this,"_defaultName","");y(this,"_shortUserName","");y(this,"_caption","");y(this,"_value",[]);this.seLabelParentType=i,this.glowingFrontText.translation=this.defaultScreenVectorLocation,this.frontText.translation=this.defaultScreenVectorLocation,this.glowingBackText.translation=this.defaultScreenVectorLocation,this.backText.translation=this.defaultScreenVectorLocation,this.frontText.noStroke(),this.backText.noStroke(),this.glowingFrontText.linewidth=S.label.glowingStrokeWidth.front,this.glowingBackText.linewidth=S.label.glowingStrokeWidth.back,this.styleOptions.set(q.Label,tC)}static updateTextScaleFactorForZoom(i){iu.textScaleFactor*=i}set valueDisplayMode(i){console.log("set vdm in label"),this._valueDisplayMode=i,this.stylize(Vt.ApplyCurrentVariables)}set defaultName(i){this._defaultName=i}set shortUserName(i){this._shortUserName=i,this.updateStyle(q.Label,{labelDisplayText:i}),this.stylize(Vt.ApplyCurrentVariables)}get shortUserName(){return this._shortUserName}get caption(){return this._caption}set caption(i){this._caption=i,this.updateStyle(q.Label,{labelDisplayCaption:i})}set value(i){this._value.splice(0),i.forEach(n=>this._value.push(n)),this.stylize(Vt.ApplyCurrentVariables)}get value(){return this._value}set positionVector(i){this._locationVector.copy(i).multiplyScalar(S.boundaryCircle.radius),this.defaultScreenVectorLocation.set(this._locationVector.x,-this._locationVector.y)}get positionVector(){return this._locationVector}set initialLabelDisplayMode(i){this.updateStyle(q.Label,{labelDisplayMode:i}),this.stylize(Vt.ApplyCurrentVariables)}get labelDisplayMode(){const i=this.styleOptions.get(q.Label);return(i==null?void 0:i.labelDisplayMode)??Xi.NameOnly}get boundingRectangle(){const i=this.frontText.getBoundingClientRect();return{bottom:i.bottom,height:i.height,left:i.left,right:i.right,top:i.top,width:i.width}}frontGlowingDisplay(){this.frontText.visible=!0,this.glowingFrontText.visible=!0,this.backText.visible=!1,this.glowingBackText.visible=!1}backGlowingDisplay(){this.frontText.visible=!1,this.glowingFrontText.visible=!1,this.backText.visible=!0,this.glowingBackText.visible=!0}glowingDisplay(){this._locationVector.z>0?this.frontGlowingDisplay():this.backGlowingDisplay()}frontNormalDisplay(){this.frontText.visible=!0,this.glowingFrontText.visible=!1,this.backText.visible=!1,this.glowingBackText.visible=!1}backNormalDisplay(){this.frontText.visible=!1,this.glowingFrontText.visible=!1,this.backText.visible=!0,this.glowingBackText.visible=!1}normalDisplay(){this._locationVector.z>0?this.frontNormalDisplay():this.backNormalDisplay()}addToLayers(i){i[st.foregroundText].add(this.frontText),i[st.foregroundTextGlowing].add(this.glowingFrontText),i[st.backgroundText].add(this.backText),i[st.backgroundTextGlowing].add(this.glowingBackText)}removeFromLayers(i){i[st.foregroundText].remove(this.frontText),i[st.foregroundTextGlowing].remove(this.glowingFrontText),i[st.backgroundText].remove(this.backText),i[st.backgroundTextGlowing].remove(this.glowingBackText)}updateDisplay(){this.normalDisplay()}setVisible(i){i?this.normalDisplay():(this.frontText.visible=!1,this.glowingFrontText.visible=!1,this.backText.visible=!1,this.glowingBackText.visible=!1)}setSelectedColoring(i){i?(this.glowingStrokeColorFront=S.style.selectedColor.front,this.glowingStrokeColorBack=S.style.selectedColor.back):(this.glowingStrokeColorFront=S.label.glowingStrokeColor.front,this.glowingStrokeColorBack=S.label.glowingStrokeColor.back),this.stylize(Vt.ApplyCurrentVariables)}updateStyle(i,n){super.updateStyle(i,n),n.labelDisplayText&&(this._shortUserName=n.labelDisplayText.slice(0,S.label.maxLabelDisplayTextLength)),n.labelDisplayCaption&&(this._caption=n.labelDisplayCaption.slice(0,S.label.maxLabelDisplayCaptionLength))}defaultStyleState(i){if(i===q.Label){let n=Xi.NameOnly;switch(this.seLabelParentType){case"point":n=S.point.defaultLabelMode;break;case"line":n=S.line.defaultLabelMode;break;case"segment":n=S.segment.defaultLabelMode;break;case"circle":n=S.circle.defaultLabelMode;break;case"angleMarker":n=S.angleMarker.defaultLabelMode;break;case"parametric":n=S.parametric.defaultLabelMode;break;case"ellipse":n=S.ellipse.defaultLabelMode;break;case"polygon":n=S.polygon.defaultLabelMode;break;default:n=Xi.NameOnly}return{...tC,labelDisplayText:this._defaultName,labelDisplayCaption:"",labelDisplayMode:n}}else throw new Error("Called defaultStyleState in Label with non-Label panel.")}adjustSize(){const i=this.styleOptions.get(q.Label),n=(i==null?void 0:i.labelTextScalePercent)??100;this.frontText.scale=iu.textScaleFactor*n/100,this.backText.scale=iu.textScaleFactor*n/100,this.glowingFrontText.scale=iu.textScaleFactor*n/100,this.glowingBackText.scale=iu.textScaleFactor*n/100}stylize(i){switch(i){case Vt.ApplyTemporaryVariables:break;case Vt.ApplyCurrentVariables:{const n=this.styleOptions.get(q.Label);let r="";if(this.value.length>0)if(this.seLabelParentType==="point")pe.store.isEarthMode?r=this.convertXYZtoLatLong(this.value):r=`(${this._value.map(a=>a.toFixed(S.decimalPrecision)).join(",")})`;else switch(this._valueDisplayMode){case Ni.Number:r=this._value[0].toFixed(S.decimalPrecision);break;case Ni.MultipleOfPi:r=(this._value[0]/Math.PI).toFixed(S.decimalPrecision)+"";break;case Ni.DegreeDecimals:r=this._value[0].toDegrees().toFixed(S.decimalPrecision)+"";break;case Ni.EarthModeMiles:if(this.seLabelParentType=="polygon"){r=(this._value[0]*S.earthMode.radiusMiles*S.earthMode.radiusMiles).toFixed(S.decimalPrecision)+" mi";break}else{r=(this._value[0]*S.earthMode.radiusMiles).toFixed(S.decimalPrecision)+" mi";break}case Ni.EarthModeKilos:if(this.seLabelParentType=="polygon"){r=(this._value[0]*S.earthMode.radiusKilometers*S.earthMode.radiusKilometers).toFixed(S.decimalPrecision)+" km";break}else{r=(this._value[0]*S.earthMode.radiusKilometers).toFixed(S.decimalPrecision)+" km";break}}switch(n==null?void 0:n.labelDisplayMode){case Xi.NameOnly:{r=(n==null?void 0:n.labelDisplayText)??"No Label Text1";break}case Xi.CaptionOnly:{r=(n==null?void 0:n.labelDisplayCaption)??"No Caption";break}case Xi.ValueOnly:{this._value.length===0&&(r=(n==null?void 0:n.labelDisplayText)??"No Label Text2");break}case Xi.NameAndCaption:{r=(n==null?void 0:n.labelDisplayText)+": "+(n==null?void 0:n.labelDisplayCaption);break}case Xi.NameAndValue:{this._value.length>0?r=(n==null?void 0:n.labelDisplayText)+": "+r:r=(n==null?void 0:n.labelDisplayText)??"No Label Text3";break}}this.frontText.value=r,this.backText.value=r,this.glowingFrontText.value=r,this.glowingBackText.value=r,(n==null?void 0:n.labelTextStyle)!=="bold"?(this.frontText.style=(n==null?void 0:n.labelTextStyle)??S.label.style,this.backText.style=(n==null?void 0:n.labelTextStyle)??S.label.style,this.glowingFrontText.style=(n==null?void 0:n.labelTextStyle)??S.label.style,this.glowingBackText.style=(n==null?void 0:n.labelTextStyle)??S.label.style,this.frontText.weight=500,this.backText.weight=500,this.glowingFrontText.weight=500,this.glowingBackText.weight=500):(n==null?void 0:n.labelTextStyle)==="bold"&&(this.frontText.weight=1e3,this.backText.weight=1e3,this.glowingFrontText.weight=1e3,this.glowingBackText.weight=1e3),this.frontText.family=(n==null?void 0:n.labelTextFamily)??S.label.family,this.backText.family=(n==null?void 0:n.labelTextFamily)??S.label.family,this.glowingFrontText.family=(n==null?void 0:n.labelTextFamily)??S.label.family,this.glowingBackText.family=(n==null?void 0:n.labelTextFamily)??S.label.family,this.frontText.decoration=(n==null?void 0:n.labelTextDecoration)??S.label.decoration,this.backText.decoration=(n==null?void 0:n.labelTextDecoration)??S.label.decoration,this.glowingFrontText.decoration=(n==null?void 0:n.labelTextDecoration)??S.label.decoration,this.glowingBackText.decoration=(n==null?void 0:n.labelTextDecoration)??S.label.decoration,this.frontText.rotation=(n==null?void 0:n.labelTextRotation)??0,this.backText.rotation=(n==null?void 0:n.labelTextRotation)??0,this.glowingFrontText.rotation=(n==null?void 0:n.labelTextRotation)??0,this.glowingBackText.rotation=(n==null?void 0:n.labelTextRotation)??0;const s=(n==null?void 0:n.labelFrontFillColor)??S.label.fillColor.front,o=(n==null?void 0:n.labelBackFillColor)??S.label.fillColor.back;pe.hslaIsNoFillOrNoStroke(s)?this.frontText.noFill():this.frontText.fill=s,this.glowingFrontText.stroke=this.glowingStrokeColorFront,(n==null?void 0:n.labelDynamicBackStyle)!==void 0&&(n==null?void 0:n.labelDynamicBackStyle)===!0?pe.hslaIsNoFillOrNoStroke(pe.contrastFillColor(s))?this.backText.noFill():this.backText.fill=pe.contrastFillColor(s):pe.hslaIsNoFillOrNoStroke(o)?this.backText.noFill():this.backText.fill=o,this.glowingBackText.stroke=this.glowingStrokeColorBack;break}}}convertXYZtoLatLong(i){const n=Math.asin(i[2]),r=Math.atan2(i[1],i[0]);let s;n<0?s=Math.abs(n).toDegrees().toFixed(S.decimalPrecision)+"S":s=n.toDegrees().toFixed(S.decimalPrecision)+"N";let o;return r<0?o=Math.abs(r).toDegrees().toFixed(S.decimalPrecision)+"W":o=r.toDegrees().toFixed(S.decimalPrecision)+"E","("+s+","+o+")"}};y(iu,"textScaleFactor",1);let p_=iu;class Xc extends Ze{constructor(i,n){super(!0);y(this,"_longitude");y(this,"_latitude");this._longitude=n,this._latitude=i,Xe.store.changeStyle({selected:[this.ref],panel:q.Front,payload:{fillColor:"hsla(200, 80%, 50%, 1)",strokeColor:"hsla(0, 0%, 0%, 1)"}})}get longitude(){return this._longitude}get latitude(){return this._latitude}get noduleDescription(){return Math.abs(this._latitude)!==90?String(_e.global.t("objectTree.earthPoint",{lat:this._latitude+"",long:this._longitude+""})):String(_e.global.t("objectTree.earthPointPole",{lat:this._latitude+""}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEPoint"}isNonFreePoint(){return!0}isFreePoint(){return!1}}function cp(t,e){const i=t.toRadians(),n=e*Math.PI/180,r=Math.cos(i)*Math.cos(n),s=-Math.cos(i)*Math.sin(n),o=Math.sin(i);return[r,o,s]}function XM(){const{inverseTotalRotationMatrix:t}=Ji(An());function e(i,n){console.debug("Fly to",i,n);const r=30,s=new k;s.set(0,0,1),s.applyMatrix4(t.value);const o=new k().fromArray(cp(i,n));console.debug("From "+s.toFixed(2)+" to "+o.toFixed(2));const a=new k,l=new _u,c=new _u,u=new _u,h=new Pt;h.copy(t.value).invert(),h.decompose(a,l,a);const d=o.distanceTo(s),g=1/(d.toDegrees()/r*1e3/20),v=new k().crossVectors(o,s).normalize();return Math.abs(d.toDegrees())<5?Promise.reject():(c.setFromAxisAngle(v,d),new Promise(p=>{let b=0;const _=setInterval(()=>{b+=g,u.slerpQuaternions(l,c,b),h.makeRotationFromQuaternion(u),h.invert(),t.value.copy(h),b>1&&(p(),clearInterval(_))},20)}))}return{geoLocationToUnitSphere:cp,flyTo:e}}class du extends Kt{constructor(i){const n=new k,r=new Pt;if(r.copy(Xe.store.inverseTotalRotationMatrix).invert(),Xe.unregisteredSEPointNorthPole===void 0){Xe.unregisteredSEPointNorthPole=new Ze(!0),Xe.unregisteredSEPointNorthPole.showing=!1,Xe.unregisteredSEPointNorthPole.exists=!0;const l=cp(90,0);n.set(l[0],l[1],l[2]),n.applyMatrix4(r),Xe.unregisteredSEPointNorthPole.locationVector=n}const s=new Ze(!0);s.showing=!1,s.exists=!0;const o=cp(i,0),a=new k(o[0],o[1],o[2]);a.applyMatrix4(r),s.locationVector=a;super(Xe.unregisteredSEPointNorthPole,s,!0);y(this,"_latitude",0);this._latitude=i,Xe.store.changeStyle({selected:[this.ref],panel:q.Front,payload:{strokeColor:"hsla(0, 0%, 0%, 1)",fillColor:"hsla(0, 0%, 0%, 0)"}})}get latitude(){return this._latitude}get noduleDescription(){return this._latitude==0?String(_e.global.t("objectTree.equatorCircle")):String(_e.global.t("objectTree.latitudeCircle",{degree:this._latitude+""}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SECircle"}isFreeToMove(){return!1}isNonFreeCircle(){return!0}}const zT=new k;class fu extends Jt{constructor(i){const n=new Pt;n.copy(Xe.store.inverseTotalRotationMatrix).invert();const r=new k;if(Xe.unregisteredSEPointNorthPole===void 0){Xe.unregisteredSEPointNorthPole=new Ze(!0),Xe.unregisteredSEPointNorthPole.showing=!1,Xe.unregisteredSEPointNorthPole.exists=!0;const a=cp(90,0);r.set(a[0],a[1],a[2]),r.applyMatrix4(n),Xe.unregisteredSEPointNorthPole.locationVector=r}else r.copy(Xe.unregisteredSEPointNorthPole.locationVector);const s=new k;if(Xe.unregisteredSEPointSouthPole===void 0){Xe.unregisteredSEPointSouthPole=new Ze(!0),Xe.unregisteredSEPointSouthPole.showing=!1,Xe.unregisteredSEPointSouthPole.exists=!0;const a=cp(-90,0);s.set(a[0],a[1],a[2]),s.applyMatrix4(n),Xe.unregisteredSEPointSouthPole.locationVector=s}const o=new k;zT.set(Math.cos(i.toRadians()),0,-Math.sin(i.toRadians())),zT.applyMatrix4(n),o.crossVectors(r,zT).normalize();super(Xe.unregisteredSEPointNorthPole,o,Math.PI,Xe.unregisteredSEPointSouthPole,!0);y(this,"_longitude",0);this._longitude=i,Xe.store.changeStyle({selected:[this.ref],panel:q.Front,payload:{strokeColor:"hsla(0, 0%, 0%, 1)",fillColor:"hsla(0, 0%, 0%, 0)"}}),this.update()}get longitude(){return this._longitude}get noduleDescription(){return this._longitude==0?String(_e.global.t("objectTree.primeMeridian")):String(_e.global.t("objectTree.longitudeSegment",{degree:this._longitude+""}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SECircle"}isFreeToMove(){return!1}isNonFreeSegment(){return!0}}const Dle=new Set([...Object.getOwnPropertyNames(tC)]);class De extends Xe{constructor(i,n){super();y(this,"parent");y(this,"_locationVector",new k);y(this,"tmpVector",new k);const r=new p_(i);this.ref=r,this.parent=n,this.parent.label=this,Xe.LABEL_COUNT++,this.name="La"+Xe.LABEL_COUNT,this.parent instanceof en?(r.shortUserName=`Am${this.parent.angleMarkerNumber}`,this.ref.defaultName=`Am${this.parent.angleMarkerNumber}`):this.parent instanceof Ks?(r.shortUserName=`Po${this.parent.polygonNumber}`,this.ref.defaultName=`Po${this.parent.polygonNumber}`):(this.parent instanceof Ze||(r.shortUserName=n.name),this.ref.defaultName=this.parent.name),this.ref.adjustSize(),n instanceof Ze?n instanceof Xc?(this.ref.initialLabelDisplayMode=Xi.CaptionOnly,this.showing=!0):(this.ref.initialLabelDisplayMode=S.point.defaultLabelMode,n.isFreePoint()?this.showing=S.point.showLabelsOfFreePointsInitially:this.showing=S.point.showLabelsOfNonFreePointsInitially):n instanceof $t?(this.ref.initialLabelDisplayMode=S.line.defaultLabelMode,this.showing=S.line.showLabelsInitially):n instanceof Jt?n instanceof fu?(this.ref.initialLabelDisplayMode=Xi.CaptionOnly,this.showing=!0):(this.ref.initialLabelDisplayMode=S.segment.defaultLabelMode,this.showing=S.segment.showLabelsInitially):n instanceof Kt?n instanceof du?(this.ref.initialLabelDisplayMode=Xi.CaptionOnly,this.showing=!0):(this.ref.initialLabelDisplayMode=S.circle.defaultLabelMode,this.showing=S.circle.showLabelsInitially):n instanceof en?(this.ref.initialLabelDisplayMode=S.angleMarker.defaultLabelMode,this.showing=S.angleMarker.showLabelsInitially):n instanceof Ii?(this.ref.initialLabelDisplayMode=S.ellipse.defaultLabelMode,this.showing=S.ellipse.showLabelsInitially):n instanceof tn?(this.ref.initialLabelDisplayMode=S.parametric.defaultLabelMode,this.showing=S.parametric.showLabelsInitially):n instanceof Ks?(this.ref.initialLabelDisplayMode=S.polygon.defaultLabelMode,this.showing=S.polygon.showLabelsInitially):this.showing=!0}customStyles(){return Dle}labelDirectLocationSetter(i){this._locationVector.copy(i).normalize(),this.ref.positionVector=this._locationVector,this.showing&&this.ref.updateDisplay()}accept(i){return i.actionOnLabel(this)}shallowUpdate(){this._exists=this.parent.exists,this._exists&&(this.tmpVector.copy(this._locationVector),this._locationVector.copy(this.parent.closestLabelLocationVector(this.tmpVector,Xe.store.zoomMagnificationFactor)),this.ref.positionVector=this._locationVector,this.showing&&this.ref.updateDisplay()),this._showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Label with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id);const r=new k;r.copy(this._locationVector),i.set(this.id,{kind:"label",object:this,locationVector:r})}this.updateKids(i,n)}}set locationVector(i){this.parent.isOutOfDate()?this._locationVector.copy(i):this._locationVector.copy(this.parent.closestLabelLocationVector(i,Xe.store.zoomMagnificationFactor)).normalize(),this.ref.positionVector=this._locationVector,this.showing&&this.ref.updateDisplay()}get locationVector(){return this._locationVector}get noduleDescription(){throw new Error("SELabel noduleDescription should never be called")}get noduleItemText(){throw new Error("SELabel noduleItemText should never be called")}isHitAt(i,n){if(i.z*this._locationVector.z<0)return!1;const r=this.ref.boundingRectangle,s=Xe.store.canvasWidth,o=Xe.store.canvasHeight,a=Xe.store.zoomTranslation;return r.left-s/2<i.x*S.boundaryCircle.radius*n+a[0]&&i.x*S.boundaryCircle.radius*n+a[0]<r.right-s/2&&r.top-o/2<-i.y*S.boundaryCircle.radius*n+a[1]&&-i.y*S.boundaryCircle.radius*n+a[1]<r.bottom-o/2}isLabel(){return!0}}_e.global;class yC extends Kt{constructor(i,n,r){super(i,n,!0);y(this,"_radiusMeasurementSEExpression");y(this,"tmpPerpVector",new k);y(this,"tempVector",new k);this._radiusMeasurementSEExpression=r}get noduleDescription(){var i;return String(_e.global.t("objectTree.measuredCircle",{center:(i=this._centerSEPoint.label)==null?void 0:i.ref.shortUserName,measurementToken:this._radiusMeasurementSEExpression.name}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEMeasuredCircle"}get radiusMeasurementSEExpression(){return this._radiusMeasurementSEExpression}shallowUpdate(){if(this._exists=this._centerSEPoint.exists&&this._radiusMeasurementSEExpression.exists,this._exists){const i=this._radiusMeasurementSEExpression.value.modPi();this.tmpPerpVector.set(-this._centerSEPoint.locationVector.y,this._centerSEPoint.locationVector.x,0),this.tmpPerpVector.isZero()&&this.tmpPerpVector.set(0,-this._centerSEPoint.locationVector.z,this._centerSEPoint.locationVector.y),this.tmpPerpVector.normalize(),this.tempVector.copy(this._centerSEPoint.locationVector).multiplyScalar(Math.cos(i)),this.tempVector.addScaledVector(this.tmpPerpVector,Math.sin(i)),this.circleSEPoint.locationVector=this.tempVector.normalize(),this.ref.circleRadius=i,this.ref.centerVector=this._centerSEPoint.locationVector,this.ref.updateDisplay()}this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Circle with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"circle",object:this})}this.updateKids(i,n)}}isNonFreeCircle(){return!0}}_e.global;class iv extends $t{constructor(i,n,r,s,o,a){super(i,n,r,!0);y(this,"_seAngleParent");y(this,"_N");y(this,"_index");y(this,"tempVector",new k);this._seAngleParent=s,this._index=o,this._N=a}get noduleDescription(){var i,n;return this._N===2?String(_e.global.t("objectTree.aMidLineOf",{angle:(i=this._seAngleParent.label)==null?void 0:i.ref.shortUserName})):String(_e.global.t("objectTree.anNsectLineOf",{angle:(n=this._seAngleParent.label)==null?void 0:n.ref.shortUserName,index:this._index,N:this._N}))}get seAngleParent(){return this._seAngleParent}get N(){return this._N}get index(){return this._index}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this._exists=this._seAngleParent.exists,this._exists){this.startSEPoint.locationVector=this._seAngleParent.vertexVector;const r=new k;r.copy(this._seAngleParent.startVector),r.addScaledVector(this._seAngleParent.vertexVector,-1*this._seAngleParent.vertexVector.dot(this._seAngleParent.startVector)).normalize();const s=new k;s.crossVectors(this._seAngleParent.vertexVector,r).normalize;const o=this._seAngleParent.value;r.multiplyScalar(Math.cos(o*this._index/this._N)),s.multiplyScalar(Math.sin(o*this._index/this._N)),this.tempVector.addVectors(r,s).normalize(),this.endSEPoint.locationVector=this.tempVector,this.tempVector.crossVectors(this.startSEPoint.locationVector,this.endSEPoint.locationVector).normalize(),this._normalVector.copy(this.tempVector),this.ref.normalVector=this._normalVector}if(this._showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1),i&&n){if(i.has(this.id)){console.log(`nSectLine with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"nSectLine",object:this})}this.updateKids(i,n)}}isNonFreeLine(){return!0}}_e.global;class nv extends Ze{constructor(i,n,r){super(!0);y(this,"_seSegmentParent");y(this,"_N");y(this,"_index");this._seSegmentParent=i,this._index=n,this._N=r}get noduleDescription(){var i,n;return this._N===2?String(_e.global.t("objectTree.aMidPointOf",{segment:(i=this._seSegmentParent.label)==null?void 0:i.ref.shortUserName})):String(_e.global.t("objectTree.anNsectPointOf",{segment:(n=this._seSegmentParent.label)==null?void 0:n.ref.shortUserName,index:this._index,N:this._N}))}get seSegmentParent(){return this._seSegmentParent}get N(){return this._N}get index(){return this._index}shallowUpdate(){if(this._exists=this._seSegmentParent.exists,this._exists){const i=new k;i.copy(this._seSegmentParent.startSEPoint.locationVector);const n=this._seSegmentParent.arcLength,r=this._seSegmentParent.normalVector,s=new k;s.crossVectors(r,i).multiplyScalar(n>Math.PI?-1:1).normalize(),i.multiplyScalar(Math.cos(n*this._index/this._N)),s.multiplyScalar(Math.sin(n*this._index/this._N)),this._locationVector.addVectors(i,s).normalize(),this.ref.positionVector=this._locationVector}this._showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`nSectPoint with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"nSectPoint",object:this})}this.updateKids(i,n)}}isNonFreePoint(){return!0}isFreePoint(){return!1}}_e.global;const Nle=!0;class g_ extends Ze{constructor(i,n){super(!0);y(this,"_parametricParent");y(this,"_isMinPoint",Nle);y(this,"tmpVector4",new k);this._parametricParent=i,this._isMinPoint=n==="min",this._isMinPoint?console.debug(`Point ${this.name} is a minimum endppoint for parametric ${i.name}`):console.debug(`Point ${this.name} is a maximum endppoint for parametric ${i.name}`),this.ref.updateDisplay()}get isMinPoint(){return this._isMinPoint}get noduleDescription(){var n;let i;return this._isMinPoint?i="start":i="end",String(_e.global.t("objectTree.endPointOfParametric",{parent:(n=this._parametricParent.label)==null?void 0:n.ref.shortUserName,end:i}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEParametricEndPoint"}pointDirectLocationSetter(i){this._locationVector.copy(i).normalize(),this.ref.positionVector=this._locationVector}get parametricParent(){return this._parametricParent}shallowUpdate(){this._exists=this.parametricParent.exists;let i;if(this.parents.length>0){const n=this.parents[0];let r;if(this._isMinPoint)r=n.tRanges[0][0];else{const s=n.tRanges.length,o=n.tRanges[s-1].length;r=n.tRanges[s-1][o-1]}i=n.P(r)}i!==void 0&&this._exists?(this._locationVector.copy(i).normalize(),this.ref.positionVector=this._locationVector):this._exists=!1,this._showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Parametric End Point with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"parametricEndPoint",object:this})}this.updateKids(i,n)}}isNonFreePoint(){return!0}isFreePoint(){return!1}}_e.global;class YM extends Ze{constructor(i){super(!0);y(this,"_parametricParent");y(this,"parametricTime",NaN);y(this,"tmpMatrix",new Pt);this._parametricParent=i,this.parametricParent.tracePoint=this;const n=i.tMinMaxExpressionValues()[0];this.parametricTime=n,this.ref.updateDisplay(),console.debug(`Point ${this.name} is a trace point of parametric curve ${i.name}`)}get noduleDescription(){var i;return String(_e.global.t("objectTree.tracePointOfParametric",{parent:(i=this._parametricParent.label)==null?void 0:i.ref.shortUserName}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEParametricEndPoint"}pointDirectLocationSetter(i){this._locationVector.copy(i).normalize(),this.ref.positionVector=this._locationVector}setLocationByTime(i){this.parametricTime=i;const n=this.parametricParent.P(i);this.pointDirectLocationSetter(n),this.markKidsOutOfDate(),this.update()}get parametricParent(){return this._parametricParent}shallowUpdate(){this._exists=this.parametricParent.exists;const i=this._parametricParent.P(this.parametricTime);i!==void 0&&this._exists?(this._locationVector.copy(i).normalize(),this.ref.positionVector=this._locationVector):this._exists=!1,this._showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Parametric Trace Point with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"parametricTracePoint",object:this})}this.updateKids(i,n)}}isNonFreePoint(){return!0}isFreePoint(){return!1}}const Rle=new Set([...Object.getOwnPropertyNames(Bv),...Object.getOwnPropertyNames(jv)]);class Fle extends Xe{constructor(i,n,r){super();y(this,"_commonPoint");y(this,"_commonParent");y(this,"_lines",[]);y(this,"tempVector",new k);this._commonPoint=n,this._commonParent=i,this._lines.push(...r)}accept(i){return!1}shallowUpdate(){const i=this._commonParent.getNormalsToPerpendicularLinesThru(this._commonPoint.locationVector,this._lines[0].normalVector),n=this._lines.length;if(i.length>n){i.length-n;for(let r=n;r<i.length;r++){const s=new Ze(!0);s.showing=!1,s.exists=!0,this.tempVector.crossVectors(this._commonPoint.locationVector,i[r].normal),s.locationVector=this.tempVector.normalize();const o=new OP(this._commonParent,this._commonPoint,i[r].normal,s,r);o.seParentPencil=this,this._commonPoint.registerChild(o),this._commonParent.registerChild(o),this._lines.push(o),Xe.store.addLine(o)}}}update(i,n){this.shallowUpdate()}isHitAt(i,n){return!1}get commonPoint(){return this._commonPoint}get commonParametric(){return this._commonParent}get lines(){return this._lines}customStyles(){return Rle}get noduleDescription(){return"Pencil of lines"}get noduleItemText(){return"Pencil of lines"}isNonFreeLine(){return!0}isOneDimensional(){return!0}}_e.global;class OP extends $t{constructor(i,n,r,s,o){super(n,r,s,!0);y(this,"seParentOneDimensional");y(this,"seParentPencil",null);y(this,"seParentPoint");y(this,"tempVector1",new k);y(this,"_index");this.seParentOneDimensional=i,this.seParentPoint=n,this._index=o}shallowUpdate(){var i,n;if(this._exists=this.seParentOneDimensional.exists&&this.seParentPoint.exists,this._exists){(i=this.seParentPencil)==null||i.markKidsOutOfDate(),(n=this.seParentPencil)==null||n.update(),new k().copy(this._normalVector);const s=this.seParentOneDimensional.getNormalsToPerpendicularLinesThru(this.seParentPoint.locationVector,this._normalVector);s[this._index]!==void 0?(this._normalVector.copy(s[this._index].normal),this.tempVector1.crossVectors(this.seParentPoint.locationVector,this._normalVector),this.endSEPoint.locationVector=this.tempVector1.normalize(),this.ref.normalVector=this._normalVector):this._exists=!1}this._exists&&this._showing?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(!(this.seParentPencil!==null&&!this.canUpdateNow())){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Perpendicular Lint Thru Point with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"perpendicularLineThruPoint",object:this})}this.updateKids(i,n)}}set glowing(i){super.glowing=i}get index(){return this._index}get noduleDescription(){var n,r;let i;return this.seParentOneDimensional instanceof Jt?i=_e.global.t("objects.segments",3):this.seParentOneDimensional instanceof $t?i=_e.global.t("objects.lines",3):this.seParentOneDimensional instanceof Kt?i=_e.global.t("objects.circles",3):this.seParentOneDimensional instanceof Ii?i=_e.global.t("objects.ellipses",3):this.seParentOneDimensional instanceof tn&&(i=_e.global.t("objects.parametrics",3)),String(_e.global.t("objectTree.perpendicularLineThru",{pt:(n=this.seParentPoint.label)==null?void 0:n.ref.shortUserName,oneDimensionalParentType:i,oneDimensionalParent:(r=this.seParentOneDimensional.label)==null?void 0:r.ref.shortUserName,index:this._index}))}isNonFreeLine(){return!0}}const zle=new Set;_e.global;var No=(t=>(t[t.X_VALUE=0]="X_VALUE",t[t.Y_VALUE=1]="Y_VALUE",t[t.Z_VALUE=2]="Z_VALUE",t))(No||{});class ma extends On{constructor(i,n){super();y(this,"selector",0);y(this,"sePoint");y(this,"invMatrix",new Pt);y(this,"valueVector",new k);y(this,"customStyles",()=>zle);this.selector=n,this.sePoint=i}get value(){switch(this.selector){case 0:return this.valueVector.x;case 1:return this.valueVector.y;case 2:return this.valueVector.z;default:return Number.NaN}}get point(){return this.sePoint}get valueDisplayMode(){return this._valueDisplayMode}set valueDisplayMode(i){this._valueDisplayMode=i,this.sePoint.label&&this.selector===2&&(this.sePoint.label.ref.valueDisplayMode=i)}get noduleDescription(){var i,n,r;switch(this.selector){case 0:return String(_e.global.t("objectTree.coordinateOf",{axisName:String(_e.global.t("objectTree.x")),pt:(i=this.sePoint.label)==null?void 0:i.ref.shortUserName,val:this.value}));case 1:return String(_e.global.t("objectTree.coordinateOf",{axisName:String(_e.global.t("objectTree.y")),pt:(n=this.sePoint.label)==null?void 0:n.ref.shortUserName,val:this.value}));case 2:return String(_e.global.t("objectTree.coordinateOf",{axisName:String(_e.global.t("objectTree.z")),pt:(r=this.sePoint.label)==null?void 0:r.ref.shortUserName,val:this.value}));default:return this.name}}get noduleItemText(){var i,n,r;switch(this.selector){case 0:return String(_e.global.t("objectTree.coordOf",{token:this.name,axisName:String(_e.global.t("objectTree.x")),pt:(i=this.sePoint.label)==null?void 0:i.ref.shortUserName,val:this.prettyValue()}));case 1:return String(_e.global.t("objectTree.coordOf",{token:this.name,axisName:String(_e.global.t("objectTree.y")),pt:(n=this.sePoint.label)==null?void 0:n.ref.shortUserName,val:this.prettyValue()}));case 2:return String(_e.global.t("objectTree.coordOf",{token:this.name,axisName:String(_e.global.t("objectTree.z")),pt:(r=this.sePoint.label)==null?void 0:r.ref.shortUserName,val:this.prettyValue()}));default:return this.name}}shallowUpdate(){this.exists=this.sePoint.exists,this.exists&&(this.invMatrix=Xe.store.inverseTotalRotationMatrix,this.valueVector.copy(this.sePoint.locationVector).applyMatrix4(this.invMatrix),this.sePoint.label&&(this.sePoint.label.ref.value=[this.valueVector.x,this.valueVector.y,this.valueVector.z]))}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Point Coordinate with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"pointCoordinate",object:this})}this.updateKids(i,n)}}}_e.global;const Ule=new Set;class Sl extends On{constructor(i,n){super();y(this,"firstSEPoint");y(this,"secondSEPoint");y(this,"customStyles",()=>Ule);this.firstSEPoint=i,this.secondSEPoint=n}get noduleDescription(){var i,n;return String(_e.global.t("objectTree.distanceBetweenPts",{pt1:(i=this.secondSEPoint.label)==null?void 0:i.ref.shortUserName,pt2:(n=this.firstSEPoint.label)==null?void 0:n.ref.shortUserName,val:this.prettyValue()}))}get noduleItemText(){return String(_e.global.t("objectTree.distanceValue",{token:this.name,val:this.prettyValue()}))}get valueDisplayMode(){return this._valueDisplayMode}set valueDisplayMode(i){this._valueDisplayMode=i}shallowUpdate(){this.exists=this.firstSEPoint.exists&&this.secondSEPoint.exists}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Point Distance with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"pointDistance",object:this})}this.updateKids(i,n)}}get value(){return this.firstSEPoint.locationVector.angleTo(this.secondSEPoint.locationVector)}}_e.global;class er extends $n{constructor(i){super();y(this,"_pointOfReflection");y(this,"_matrix",new Pt);this._pointOfReflection=i,this.ref=i.ref,$n.POINT_REFLECTION_COUNT,this.name=`Rp${$n.POINT_REFLECTION_COUNT}`,this.markKidsOutOfDate(),this.update()}get sePointOfReflection(){return this._pointOfReflection}get geometricChild(){return this._pointOfReflection}f(i){const n=new k;return n.copy(i).applyMatrix4(this._matrix),n}shallowUpdate(){this._exists=this._pointOfReflection.exists,this._exists&&this._matrix.makeRotationAxis(this._pointOfReflection.locationVector,Math.PI)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Reflection over point with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"pointReflection",object:this})}this.updateKids(i,n)}}get noduleItemText(){return this.name??"No Point Reflection Name In SEPointReflection"}get noduleDescription(){var i;return String(_e.global.t("objectTree.reflectOverPoint",{pt:(i=this._pointOfReflection.label)==null?void 0:i.ref.shortUserName}))}}_e.global;class ZM extends $t{constructor(i,n,r){super(i,r.locationVector,n,!0);y(this,"polarPointParent");y(this,"tempVector",new k);this.polarPointParent=r}get pointParent(){return this.polarPointParent}get noduleDescription(){var i;return String(_e.global.t("objectTree.polarLine",{pt:(i=this.polarPointParent.label)==null?void 0:i.ref.shortUserName,normalX:this._normalVector.x.toFixed(S.decimalPrecision),normalY:this._normalVector.y.toFixed(S.decimalPrecision),normalZ:this._normalVector.z.toFixed(S.decimalPrecision)}))}shallowUpdate(){this._exists=this.polarPointParent.exists,this._exists&&(this.tempVector.set(-this.polarPointParent.locationVector.y,this.polarPointParent.locationVector.x,0),this.tempVector.isZero()&&this.tempVector.set(0,-this.polarPointParent.locationVector.z,this.polarPointParent.locationVector.y),this.endSEPoint.locationVector=this.tempVector.normalize(),this.tempVector.crossVectors(this.polarPointParent.locationVector,this.endSEPoint.locationVector),this.startSEPoint.locationVector=this.tempVector.normalize(),this._normalVector.copy(this.polarPointParent.locationVector).normalize(),this.ref.normalVector=this._normalVector),this.showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Polar Line with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"polarLine",object:this})}this.updateKids(i,n)}}isNonFreeLine(){return!0}}_e.global;class v_ extends Ze{constructor(i,n){super(!0);y(this,"_polarLineOrSegmentParent");y(this,"index");this._polarLineOrSegmentParent=i,this.index=n}get noduleDescription(){var i;return String(_e.global.t("objectTree.aPolarPointOf",{line:(i=this._polarLineOrSegmentParent.label)==null?void 0:i.ref.shortUserName,index:this.index}))}shallowUpdate(){this._exists=this._polarLineOrSegmentParent.exists,this._exists&&(this._locationVector.copy(this._polarLineOrSegmentParent.normalVector).multiplyScalar(this.index===1?-1:1),this.ref.positionVector=this._locationVector),this._showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Polar Point with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"polarPoint",object:this})}this.updateKids(i,n)}}isNonFreePoint(){return!0}isFreePoint(){return!1}}const Pg=S.polygon.numPoints;class Ble extends pe{constructor(i,n){super();y(this,"segmentIsFlipped",[]);y(this,"seEdgeSegments",[]);y(this,"interiorDirectionMultipliers",[]);y(this,"_area",0);y(this,"frontFills",[]);y(this,"backFills",[]);y(this,"pool",[]);y(this,"frontGradientColorCenter",new it.Stop(0,S.fill.frontWhite,1));y(this,"frontGradientColor",new it.Stop(2*S.boundaryCircle.radius,S.polygon.drawn.fillColor.front,1));y(this,"frontGradient",new it.RadialGradient(S.fill.lightSource.x,S.fill.lightSource.y,1*S.boundaryCircle.radius,[this.frontGradientColorCenter,this.frontGradientColor]));y(this,"backGradientColorCenter",new it.Stop(0,S.fill.backGray,1));y(this,"backGradientColor",new it.Stop(1*S.boundaryCircle.radius,S.polygon.drawn.fillColor.back,1));y(this,"backGradient",new it.RadialGradient(-S.fill.lightSource.x,-S.fill.lightSource.y,2*S.boundaryCircle.radius,[this.backGradientColorCenter,this.backGradientColor]));y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpMatrix",new Pt);this.seEdgeSegments.push(...i),this.segmentIsFlipped.push(...n);const r=[];for(let s=0;s<S.segment.numPoints*this.seEdgeSegments.length+Pg+1;s++)r.push(new it.Vector(0,0));this.frontFills[0]=new it.Path(r,!0,!1);for(let s=0;s<this.seEdgeSegments.length;s++)this.backFills[s]=this.frontFills[0].clone(),s>0&&(this.frontFills[s]=this.frontFills[0].clone(),this.frontFills[s].vertices.splice(0),this.backFills[s].vertices.splice(0)),pe.idPlottableDescriptionMap.set(String(this.frontFills[s].id),{type:"polygon",side:"front",fill:!0,part:""}),pe.idPlottableDescriptionMap.set(String(this.backFills[s].id),{type:"polygon",side:"back",fill:!0,part:""}),this.frontFills[s].noStroke(),this.backFills[s].noStroke(),this.frontFills[s].visible=!0,this.backFills[s].visible=!0;this.frontGradientColor.color=S.polygon.drawn.fillColor.front,this.backGradientColor.color=pe.contrastFillColor(S.polygon.drawn.fillColor.front),this.styleOptions.set(q.Front,Zk),this.styleOptions.set(q.Back,Jk)}updateDisplay(){this.frontFills.forEach(s=>this.pool.push(...s.vertices.splice(0))),this.backFills.forEach(s=>this.pool.push(...s.vertices.splice(0)));const i=[];this.seEdgeSegments.map(s=>s.ref).forEach((s,o)=>{if(this.segmentIsFlipped[o])if(s.lastVertexIsOnFront)if(s.frontPartExtra.vertices.length==0){for(let a=s.frontPart.vertices.length-1;a>-1;a--)i.push({x:s.frontPart.vertices[a].x,y:s.frontPart.vertices[a].y,front:!0});for(let a=s.backPart.vertices.length-1;a>-1;a--)i.push({x:s.backPart.vertices[a].x,y:s.backPart.vertices[a].y,front:!1})}else{for(let a=s.frontPartExtra.vertices.length-1;a>-1;a--)i.push({x:s.frontPartExtra.vertices[a].x,y:s.frontPartExtra.vertices[a].y,front:!0});for(let a=s.backPart.vertices.length-1;a>-1;a--)i.push({x:s.backPart.vertices[a].x,y:s.backPart.vertices[a].y,front:!1});for(let a=s.frontPart.vertices.length-1;a>-1;a--)i.push({x:s.frontPart.vertices[a].x,y:s.frontPart.vertices[a].y,front:!0})}else if(s.backPartExtra.vertices.length===0){for(let a=s.backPart.vertices.length-1;a>-1;a--)i.push({x:s.backPart.vertices[a].x,y:s.backPart.vertices[a].y,front:!1});for(let a=s.frontPart.vertices.length-1;a>-1;a--)i.push({x:s.frontPart.vertices[a].x,y:s.frontPart.vertices[a].y,front:!0})}else{for(let a=s.backPartExtra.vertices.length-1;a>-1;a--)i.push({x:s.backPartExtra.vertices[a].x,y:s.backPartExtra.vertices[a].y,front:!1});for(let a=s.frontPart.vertices.length-1;a>-1;a--)i.push({x:s.frontPart.vertices[a].x,y:s.frontPart.vertices[a].y,front:!0});for(let a=s.backPart.vertices.length-1;a>-1;a--)i.push({x:s.backPart.vertices[a].x,y:s.backPart.vertices[a].y,front:!1})}else if(s.firstVertexIsOnFront){for(let a=0;a<s.frontPart.vertices.length;a++)i.push({x:s.frontPart.vertices[a].x,y:s.frontPart.vertices[a].y,front:!0});for(let a=0;a<s.backPart.vertices.length;a++)i.push({x:s.backPart.vertices[a].x,y:s.backPart.vertices[a].y,front:!1});for(let a=0;a<s.frontPartExtra.vertices.length;a++)i.push({x:s.frontPartExtra.vertices[a].x,y:s.frontPartExtra.vertices[a].y,front:!0})}else{for(let a=0;a<s.backPart.vertices.length;a++)i.push({x:s.backPart.vertices[a].x,y:s.backPart.vertices[a].y,front:!1});for(let a=0;a<s.frontPart.vertices.length;a++)i.push({x:s.frontPart.vertices[a].x,y:s.frontPart.vertices[a].y,front:!0});for(let a=0;a<s.backPartExtra.vertices.length;a++)i.push({x:s.backPartExtra.vertices[a].x,y:s.backPartExtra.vertices[a].y,front:!1})}});const n=i.every(s=>s.front===!0),r=i.every(s=>s.front===!1);if(!n&&!r){const s=[],o=[],a=i.length;i.forEach((d,f)=>{const m=((f-1)%a+a)%a;d.front&&!i[m].front?o.push({index:f,visited:!1}):!d.front&&i[m].front&&s.push({index:f,visited:!1})});const l=[];s.forEach(d=>l.push(Math.atan2(i[d.index].y,i[d.index].x)));const c=[];o.forEach(d=>c.push(Math.atan2(i[d.index].y,i[d.index].x)));let u=-1;for(;o.some(d=>d.visited===!1);){if(u+=1,u===this.frontFills.length)throw new Error("Polygon: Not enough front fill parts allocated in the constructor");let d=o.findIndex(f=>f.visited===!1);for(;o[d].visited===!1;){o[d].visited=!0;let f=o[d].index;for(;i[f].front===!0;){const N=this.pool.pop();if(N!==void 0)N.x=i[f].x,N.y=i[f].y,this.frontFills[u].vertices.push(N);else throw new Error("Polygon: not enough anchors in the pool to trace a front edge.");f=((f+1)%a+a)%a}const m=((f-1)%a+a)%a,g=Math.atan2(i[m].y,i[m].x);let v=g-2*Math.PI,p=-1,b=-2*Math.PI,_=-1;c.forEach((N,D)=>{g>N&&N>v&&(v=N,p=D),N>b&&(b=N,_=D)}),p===-1&&(p=_);const P=o[p].index,E=Math.atan2(i[P].y,i[P].x);let T=g-E;T<0&&(T+=2*Math.PI);const C=Math.sqrt(i[m].x*i[m].x+i[m].y*i[m].y),M=[S.boundaryCircle.radius*(i[m].x*S.boundaryCircle.radius)/C,S.boundaryCircle.radius*(i[m].y*S.boundaryCircle.radius)/C],x=[M[1],-M[0]];this.boundaryCircleCoordinates(M,Math.floor(Pg/this.seEdgeSegments.length),x,T).forEach(N=>{const D=this.pool.pop();if(D!==void 0)D.x=N[0],D.y=N[1],this.frontFills[u].vertices.push(D);else throw new Error("Polygon: not enough anchors in the pool to trace a front boundary circle edge.")}),d=p}}let h=-1;for(;s.some(d=>d.visited===!1);){if(h+=1,h===this.backFills.length)throw new Error("Polygon: Not enough back fill parts allocated in the constructor");let d=s.findIndex(f=>f.visited===!1);for(;s[d].visited===!1;){s[d].visited=!0;let f=s[d].index;for(;i[f].front===!1;){const N=this.pool.pop();if(N!==void 0)N.x=i[f].x,N.y=i[f].y,this.backFills[h].vertices.push(N);else throw new Error("Polygon: not enough anchors in the pool to trace a front edge.");f=((f+1)%a+a)%a}const m=((f-1)%a+a)%a,g=Math.atan2(i[m].y,i[m].x);let v=g+2*Math.PI,p=-1,b=2*Math.PI,_=-1;l.forEach((N,D)=>{g<N&&N<v&&(v=N,p=D),N<b&&(b=N,_=D)}),p===-1&&(p=_);const P=s[p].index,E=Math.atan2(i[P].y,i[P].x);let T=g-E;T<0&&(T+=2*Math.PI),T=2*Math.PI-T;const C=Math.sqrt(i[m].x*i[m].x+i[m].y*i[m].y),M=[S.boundaryCircle.radius*(i[m].x*S.boundaryCircle.radius)/C,S.boundaryCircle.radius*(i[m].y*S.boundaryCircle.radius)/C],x=[-M[1],M[0]];this.boundaryCircleCoordinates(M,Math.floor(Pg/this.seEdgeSegments.length),x,T).forEach(N=>{const D=this.pool.pop();if(D!==void 0)D.x=N[0],D.y=N[1],this.backFills[h].vertices.push(D);else throw new Error("Polygon: not enough anchors in the pool to trace a front boundary circle edge.")}),d=p}}}else if(n&&this._area<2*Math.PI)i.forEach(s=>{const o=this.pool.pop();if(o!==void 0)o.x=s.x,o.y=s.y,this.frontFills[0].vertices.push(o);else throw new Error("Ploygon: Not enough vertices from the fills in the pool!")});else if(r&&this._area<2*Math.PI)i.forEach(s=>{const o=this.pool.pop();if(o!==void 0)o.x=s.x,o.y=s.y,this.backFills[0].vertices.push(o);else throw new Error("Ploygon: Not enough vertices from the fills in the pool!")});else if(r&&this._area>2*Math.PI){const s=Math.sqrt(i[0].x*i[0].x+i[0].y*i[0].y),o=[S.boundaryCircle.radius*(i[0].x*S.boundaryCircle.radius)/s,S.boundaryCircle.radius*(i[0].y*S.boundaryCircle.radius)/s],a=this.boundaryCircleCoordinates(o,Pg,[-o[1],o[0]],2*Math.PI);a.forEach(u=>{const h=this.pool.pop();if(h!==void 0)h.x=u[0],h.y=u[1],this.frontFills[0].vertices.push(h);else throw new Error("Ploygon: Not enough vertices from the fills in the pool!")}),a.reverse().forEach(u=>{const h=this.pool.pop();if(h!==void 0)h.x=u[0],h.y=u[1],this.backFills[0].vertices.push(h);else throw new Error("Ploygon: Not enough vertices from the fills in the pool!")});const l=this.pool.pop();l!==void 0&&(l.x=this.backFills[0].vertices[0].x,l.y=this.backFills[0].vertices[0].y,this.backFills[0].vertices.push(l)),i.forEach(u=>{const h=this.pool.pop();if(h!==void 0)h.x=u.x,h.y=u.y,this.backFills[0].vertices.push(h);else throw new Error("Ploygon: Not enough vertices from the fills in the pool!")});const c=this.pool.pop();c!==void 0&&(c.x=this.backFills[0].vertices.slice(-1)[0].x,c.y=this.backFills[0].vertices.slice(-1)[0].y,this.backFills[0].vertices.push(c))}else if(n&&this._area>2*Math.PI){const s=Math.sqrt(i[0].x*i[0].x+i[0].y*i[0].y),o=[S.boundaryCircle.radius*(i[0].x*S.boundaryCircle.radius)/s,S.boundaryCircle.radius*(i[0].y*S.boundaryCircle.radius)/s],a=this.boundaryCircleCoordinates(o,Pg,[-o[1],o[0]],2*Math.PI);a.forEach(u=>{const h=this.pool.pop();if(h!==void 0)h.x=u[0],h.y=u[1],this.backFills[0].vertices.push(h);else throw new Error("Ploygon: Not enough vertices from the fills in the pool!")}),a.reverse().forEach(u=>{const h=this.pool.pop();if(h!==void 0)h.x=u[0],h.y=u[1],this.frontFills[0].vertices.push(h);else throw new Error("Ploygon: Not enough vertices from the fills in the pool!")});const l=this.pool.pop();if(l!==void 0)l.x=this.frontFills[0].vertices[0].x,l.y=this.frontFills[0].vertices[0].y,this.frontFills[0].vertices.push(l);else throw new Error("Ploygon: Not enough vertices from the fills in the pool!");i.forEach(u=>{const h=this.pool.pop();if(h!==void 0)h.x=u.x,h.y=u.y,this.frontFills[0].vertices.push(h);else throw new Error("Ploygon: Not enough vertices from the fills in the pool!")});const c=this.pool.pop();c!==void 0&&(c.x=this.frontFills[0].vertices.slice(-1)[0].x,c.y=this.frontFills[0].vertices.slice(-1)[0].y,this.frontFills[0].vertices.push(c))}}boundaryCircleCoordinates(i,n,r,s){const o=new k(i[0],i[1],0).normalize(),a=new k(r[0],r[1],0).normalize(),l=[];for(let c=0;c<n;c++)this.tmpVector.set(0,0,0),this.tmpVector.addScaledVector(o,Math.cos((c+1)*(s/(n+1)))),this.tmpVector.addScaledVector(a,Math.sin((c+1)*(s/(n+1)))),this.tmpVector.normalize().multiplyScalar(S.boundaryCircle.radius),l.push([this.tmpVector.x,this.tmpVector.y]);return l}set area(i){this._area=i}frontGlowingDisplay(){this.frontFills.forEach(i=>i.visible=!0),this.seEdgeSegments.forEach(i=>{i.selected||i.ref.frontGlowingDisplay()})}backGlowingDisplay(){this.backFills.forEach(i=>i.visible=!0),this.seEdgeSegments.forEach(i=>{i.selected||i.ref.backGlowingDisplay()})}glowingDisplay(){this.frontGlowingDisplay(),this.backGlowingDisplay()}frontNormalDisplay(){this.frontFills.forEach(i=>i.visible=!0),this.seEdgeSegments.forEach(i=>{i.selected||i.ref.frontNormalDisplay()})}backNormalDisplay(){this.backFills.forEach(i=>i.visible=!0),this.seEdgeSegments.forEach(i=>{i.selected||i.ref.backNormalDisplay()})}normalDisplay(){this.frontNormalDisplay(),this.backNormalDisplay()}setVisible(i){i?this.normalDisplay():(this.frontFills.forEach(n=>n.visible=!1),this.backFills.forEach(n=>n.visible=!1))}setSelectedColoring(i){this.seEdgeSegments.map(n=>n.ref).forEach(n=>n.setSelectedColoring(i))}adjustSize(){}addToLayers(i){this.frontFills.forEach(n=>n.addTo(i[st.foregroundFills])),this.backFills.forEach(n=>n.addTo(i[st.backgroundFills]))}removeFromLayers(){this.frontFills.forEach(i=>i.remove()),this.backFills.forEach(i=>i.remove())}defaultStyleState(i){switch(i){case q.Front:return Zk;case q.Back:return{...Jk,strokeWidthPercent:pe.contrastStrokeWidthPercent(100),strokeColor:pe.contrastStrokeColor(S.parametric.drawn.strokeColor.front),fillColor:pe.contrastFillColor(S.parametric.drawn.fillColor.front)};default:return{}}}stylize(i){switch(i){case Vt.ApplyTemporaryVariables:break;case Vt.ApplyCurrentVariables:{const n=this.styleOptions.get(q.Front);pe.hslaIsNoFillOrNoStroke(n==null?void 0:n.fillColor)?this.frontFills.forEach(s=>s.noFill()):(this.frontGradientColor.color=(n==null?void 0:n.fillColor)??"black",this.frontFills.forEach(s=>{s.fill=this.frontGradient}));const r=this.styleOptions.get(q.Back);r!=null&&r.dynamicBackStyle?pe.hslaIsNoFillOrNoStroke(pe.contrastFillColor(n==null?void 0:n.fillColor))?this.backFills.forEach(s=>s.noFill()):(this.backGradientColor.color=pe.contrastFillColor((n==null?void 0:n.fillColor)??"black"),this.backFills.forEach(s=>{s.fill=this.backGradient})):pe.hslaIsNoFillOrNoStroke(r==null?void 0:r.fillColor)?this.backFills.forEach(s=>s.noFill()):(this.backGradientColor.color=(r==null?void 0:r.fillColor)??"black",this.backFills.forEach(s=>{s.fill=this.backGradient}));break}}}}_e.global;const jle=new Set([...Object.getOwnPropertyNames(Zk),...Object.getOwnPropertyNames(Jk)]);class Ks extends On{constructor(i,n,r){super();y(this,"label");y(this,"_seEdgeSegments",[]);y(this,"_segmentIsFlipped",[]);y(this,"_angleMarkers",[]);y(this,"_polygonNumber",0);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"_n");y(this,"_area",0);this.ref=new Ble(i,n),this.ref.updateDisplay(),this.ref.stylize(Vt.ApplyCurrentVariables),this.ref.adjustSize(),this._seEdgeSegments.push(...i),this._segmentIsFlipped.push(...n),this._angleMarkers.push(...r),this._n=this._seEdgeSegments.length,this._valueDisplayMode=S.polygon.initialValueDisplayMode,Xe.POLYGON_COUNT++,this._polygonNumber=Xe.POLYGON_COUNT}customStyles(){return jle}get seEdgeSegments(){return this._seEdgeSegments}get segmentFlippedList(){return this._segmentIsFlipped}get noduleDescription(){let i="";return this._seEdgeSegments.forEach(n=>{var r;i=i+((r=n.label)==null?void 0:r.ref.shortUserName)+", "}),i=i.substring(0,i.length-2),this._seEdgeSegments.length===2?String(_e.global.t("objectTree.bigonWithEdges",{edges:i,val:Xe.store.isEarthMode?this.prettyValue(!0):this.value})):this._seEdgeSegments.length===3?String(_e.global.t("objectTree.triangleWithEdges",{edges:i,val:Xe.store.isEarthMode?this.prettyValue(!0):this.value})):String(_e.global.t("objectTree.polygonWithEdges",{edges:i,val:Xe.store.isEarthMode?this.prettyValue(!0):this.value}))}get noduleItemText(){var i;return this.name+" - "+((i=this.label)==null?void 0:i.ref.shortUserName)+`: ${this.prettyValue()}`}get valueDisplayMode(){return this._valueDisplayMode}set valueDisplayMode(i){console.log("Set the vdm in polygon"),this._valueDisplayMode=i,this.label&&(this.label.ref.valueDisplayMode=i)}get value(){return this._area}get polygonNumber(){return this._polygonNumber}isHitAt(i,n){if(this._seEdgeSegments.some(g=>g.isHitAt(i,n,1e3)))return!0;const r=new k;let s=-1,o=2*Math.PI;this._seEdgeSegments.forEach((g,v)=>{let p;this.segmentFlippedList[v]?(p=g.startSEPoint.locationVector.angleTo(i),p<o&&(o=p,s=v,r.copy(g.endSEPoint.locationVector))):(p=g.endSEPoint.locationVector.angleTo(i),p<o&&(o=p,s=v,r.copy(g.endSEPoint.locationVector)))});const a=new k,l=new k;this.segmentFlippedList[s]?r.copy(this._seEdgeSegments[s].startSEPoint.locationVector):r.copy(this._seEdgeSegments[s].endSEPoint.locationVector),l.crossVectors(r,this._seEdgeSegments[s].getMidPointVector()).normalize(),a.crossVectors(l,r).normalize();const c=((s+1)%this._n+this._n)%this._n,u=this._angleMarkers[c].value,h=new k(0,0,0);h.addScaledVector(a,Math.sin(S.polygon.minimumVertexToEdgeThickness/2)*Math.cos(u/2)),h.addScaledVector(l,Math.sin(S.polygon.minimumVertexToEdgeThickness/2)*Math.sin(u/2)),h.addScaledVector(r,Math.cos(S.polygon.minimumVertexToEdgeThickness/2)),h.normalize(),o=h.angleTo(i);const d=new k;d.crossVectors(h,i),d.isZero(S.tolerance)&&(d.crossVectors(h,new k(-h.y,h.x,0).normalize()),d.isZero(S.tolerance)&&d.crossVectors(h,new k(-h.z,0,h.x).normalize())),d.normalize();const f=[];this._seEdgeSegments.forEach((g,v)=>{d.dot(g.endSEPoint.locationVector)*d.dot(g.startSEPoint.locationVector)>0&&g.arcLength<Math.PI||(h.dot(g.normalVector)>0?this.tmpVector.copy(g.normalVector):this.tmpVector.copy(g.normalVector).multiplyScalar(-1),!(Math.PI/2-h.angleTo(this.tmpVector)>o)&&f.push(g))});let m=0;return f.forEach(g=>{const v=new k;v.crossVectors(g.normalVector,d).normalize();let p=h.angleTo(v)+i.angleTo(v);g.onSegment(v)&&Math.abs(p-o)<S.tolerance&&(this.tmpVector.subVectors(g.startSEPoint.locationVector,v).isZero(S.tolerance)||this.tmpVector.subVectors(g.endSEPoint.locationVector,v).isZero(S.tolerance)?console.warn("Polygon: The line from a point interior to unitIdealVector passes through a vertex!"):m+=1),v.multiplyScalar(-1),p=h.angleTo(v)+i.angleTo(v),g.onSegment(v)&&Math.abs(p-o)<S.tolerance&&(this.tmpVector.subVectors(g.startSEPoint.locationVector,v).isZero(S.tolerance)||this.tmpVector.subVectors(g.endSEPoint.locationVector,v).isZero(S.tolerance)?console.warn("Polygon: The line from a point interior to unitIdealVector passes through a vertex!"):m+=1)}),m%2===0}shallowUpdate(){if(this._exists=this._seEdgeSegments.every(i=>i.exists===!0),this._exists)for(let i=0;i<this._n;i++){let n;this._segmentIsFlipped[i]?n=this._seEdgeSegments[i].startSEPoint.locationVector:n=this._seEdgeSegments[i].endSEPoint.locationVector;for(let r=0;r<this._n;r++)if(r!==i&&r!==((i+1)%this._n+this._n)%this._n&&this._seEdgeSegments[r].closestVector(n).angleTo(n)<S.polygon.minimumVertexToEdgeThickness){console.log("too close",this._seEdgeSegments[i].name,this._seEdgeSegments[r].name),this._exists=!1;break}if(!this._exists)break}if(this._exists)for(let i=0;i<this._n;i++){for(let n=0;n<this._n;n++)if(n!==((i+1)%this._n+this._n)%this._n&&n!==i&&n!==((i-1)%this._n+this._n)%this._n&&Xe.store.findIntersectionPointsByParent(this._seEdgeSegments[i].name,this._seEdgeSegments[n].name).some(r=>r.exists)){this._exists=!1;break}if(!this._exists)break}if(this._exists&&this._angleMarkers.every(i=>i.exists)){let i=0;this._angleMarkers.forEach(n=>{i+=n.value}),this._area=i-(this._n-2)*Math.PI,this.ref.area=this._area,this.ref.updateDisplay()}this.showing&&this._exists?(this.label&&(this.label.ref.value=[this.value]),this.ref.setVisible(!0)):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Polygon with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"polygon",object:this})}this.updateKids(i,n)}}closestVector(i){if(this.isHitAt(i,Xe.store.zoomMagnificationFactor))return i;let n=2*Math.PI;const r=new k;return this._seEdgeSegments.forEach(s=>{this.tmpVector.copy(s.closestVector(i));const o=this.tmpVector.angleTo(i);o<n&&(n=o,r.copy(this.tmpVector))}),r.normalize()}getNormalsToLineThru(i,n,r){throw new Error("Method not implemented.")}closestLabelLocationVector(i){this.tmpVector.copy(this.closestVector(i));const n=Xe.store.zoomMagnificationFactor;return this.tmpVector.angleTo(i)<S.polygon.maxLabelDistance/n?i:(this.tmpVector1.crossVectors(i,this.tmpVector).normalize(),this.tmpVector2.crossVectors(this.tmpVector,this.tmpVector1).normalize,this.tmpVector2.multiplyScalar(Math.sin(S.polygon.maxLabelDistance/n)),this.tmpVector2.addScaledVector(this.tmpVector,Math.cos(S.polygon.maxLabelDistance/n)).normalize())}accept(i){return i.actionOnPolygon(this)}isLabelable(){return!0}isPolygon(){return!0}}_e.global;class Qi extends $n{constructor(i){super();y(this,"_lineOrSegment");this._lineOrSegment=i,this.ref=i.ref,$n.REFLECTION_COUNT++,this.name=`RL${$n.REFLECTION_COUNT}`,this.markKidsOutOfDate(),this.update()}get seLineOrSegment(){return this._lineOrSegment}get geometricChild(){return this._lineOrSegment}f(i){const n=new k;return n.copy(i).reflect(this._lineOrSegment.normalVector),n}shallowUpdate(){this._exists=this._lineOrSegment.exists}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Reflection with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"reflection",object:this})}this.updateKids(i,n)}}get noduleItemText(){return this.name??"No Reflection Name In SEReflection"}get noduleDescription(){var i;return String(_e.global.t("objectTree.reflectionOverLine",{line:(i=this._lineOrSegment.label)==null?void 0:i.ref.shortUserName}))}}_e.global;class ts extends $n{constructor(i,n){super();y(this,"_rotationPoint");y(this,"_rotationAngleExpression");y(this,"_matrix",new Pt);this._rotationPoint=i,this._rotationAngleExpression=n,this.ref=i.ref,$n.ROTATION_COUNT++,this.name=`Ro${$n.ROTATION_COUNT}`,this.markKidsOutOfDate(),this.update()}get geometricChild(){return this._rotationPoint}get seRotationPoint(){return this._rotationPoint}get seRotationAngleExpression(){return this._rotationAngleExpression}f(i){const n=new k;return n.copy(i).applyMatrix4(this._matrix),n}shallowUpdate(){this._exists=this._rotationPoint.exists,this._exists&&this._matrix.makeRotationAxis(this._rotationPoint.locationVector,this._rotationAngleExpression.value)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),this._exists&&this._matrix.makeRotationAxis(this._rotationPoint.locationVector,this._rotationAngleExpression.value),i&&n){if(i.has(this.id)){console.log(`Rotation with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"rotation",object:this})}this.updateKids(i,n)}}get noduleItemText(){return this.name??"No Rotation Name In SERotation"}get noduleDescription(){var i;return String(_e.global.t("objectTree.rotationAboutPoint",{pt:(i=this._rotationPoint.label)==null?void 0:i.ref.shortUserName,angle:this._rotationAngleExpression.name}))}}const $le=new Set;_e.global;class ws extends On{constructor(i){super();y(this,"seSegment");y(this,"customStyles",()=>$le);this.seSegment=i,this.valueDisplayMode=S.segment.initialValueDisplayMode}get value(){return this.seSegment.arcLength}get valueDisplayMode(){return this._valueDisplayMode}set valueDisplayMode(i){this._valueDisplayMode=i,this.seSegment.label&&(this.seSegment.label.ref.valueDisplayMode=i)}get noduleDescription(){var i;return String(_e.global.t("objectTree.segmentLength",{seg:(i=this.seSegment.label)==null?void 0:i.ref.shortUserName,val:Xe.store.isEarthMode?this.prettyValue(!0):this.value}))}get noduleItemText(){var i;return this.name+": "+((i=this.seSegment.label)==null?void 0:i.ref.shortUserName)+` ${this.prettyValue()}`}shallowUpdate(){this.exists=this.seSegment.exists,this.exists&&this.seSegment.label&&(this.seSegment.label.ref.value=[this.value])}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Segment Length with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"segmentLength",object:this})}this.updateKids(i,n)}}}_e.global;const Wle=new Set;class JM extends On{constructor({min:i,max:n,step:r,value:s}){super();y(this,"min");y(this,"max");y(this,"current");y(this,"step");y(this,"customStyles",()=>Wle);this.min=i,this.max=n,this.step=r,this.current=s,this.showing=!0}get value(){return this.current}set value(i){this.current=i,this.markKidsOutOfDate(),this.update()}get noduleDescription(){return String(_e.global.t("objectTree.slider"))}get noduleItemText(){return String(_e.global.t("objectTree.sliderValue",{token:this.name,val:this.prettyValue()}))}get valueDisplayMode(){return this._valueDisplayMode}set valueDisplayMode(i){this._valueDisplayMode=i}shallowUpdate(){console.error(`*** INCOMPLETE ${this.name} *** or no update is necessary for sliders?`)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),i&&n){if(n.push(this.id),i.has(this.id)){console.log(`Slider with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}i.set(this.id,{kind:"slider",object:this,sliderValue:this.value})}this.updateKids(i,n)}}}class DP extends m_{constructor(){super();y(this,"_vector1",new k);y(this,"_vector2",new k);y(this,"_vector3",new k);y(this,"tempVector1",new k);y(this,"tempVector2",new k);y(this,"tempVector3",new k)}updateDisplay(){this.tempVector1.subVectors(this._vector1,this._vector2).isZero(S.tolerance)?(this.tempVector2.crossVectors(this._vector1,this._vector3).normalize().multiplyScalar(S.boundaryCircle.radius),this.tempVector2.dot(this._locationVector)<0&&this.tempVector2.multiplyScalar(-1),this._locationVector.copy(this.tempVector2)):this.tempVector1.subVectors(this._vector1,this._vector3).isZero(S.tolerance)?(this.tempVector2.crossVectors(this._vector2,this._vector3).normalize().multiplyScalar(S.boundaryCircle.radius),this.tempVector2.dot(this._locationVector)<0&&this.tempVector2.multiplyScalar(-1),this._locationVector.copy(this.tempVector2)):this.tempVector1.subVectors(this._vector2,this._vector3).isZero(S.tolerance)?(this.tempVector2.crossVectors(this._vector1,this._vector3).normalize().multiplyScalar(S.boundaryCircle.radius),this.tempVector2.dot(this._locationVector)<0&&this.tempVector2.multiplyScalar(-1),this._locationVector.copy(this.tempVector2)):this.tempVector1.crossVectors(this._vector1,this._vector3).isZero()?(this.tempVector3.crossVectors(this._vector1,this._vector2).normalize().multiplyScalar(S.boundaryCircle.radius),this.tempVector3.dot(this._locationVector)<0&&this.tempVector3.multiplyScalar(-1),this._locationVector.copy(this.tempVector3)):this.tempVector1.crossVectors(this._vector1,this._vector2).isZero()?(this.tempVector3.crossVectors(this._vector1,this._vector3).normalize().multiplyScalar(S.boundaryCircle.radius),this.tempVector3.dot(this._locationVector)<0&&this.tempVector3.multiplyScalar(-1),this._locationVector.copy(this.tempVector3)):this.tempVector1.crossVectors(this._vector2,this._vector3).isZero()?(this.tempVector3.crossVectors(this._vector1,this._vector3).normalize().multiplyScalar(S.boundaryCircle.radius),this.tempVector3.dot(this._locationVector)<0&&this.tempVector3.multiplyScalar(-1),this._locationVector.copy(this.tempVector3)):(this.tempVector1.subVectors(this._vector1,this._vector3),this.tempVector2.subVectors(this._vector1,this._vector2),this.tempVector3.crossVectors(this.tempVector1,this.tempVector2).normalize().multiplyScalar(S.boundaryCircle.radius),this.tempVector3.dot(this._locationVector)<0&&this.tempVector3.multiplyScalar(-1),this._locationVector.copy(this.tempVector3)),this._locationVector.angleTo(this._vector1)>Math.PI/2+1e-6&&this._locationVector.multiplyScalar(-1),this.defaultScreenVectorLocation.set(this._locationVector.x,this._locationVector.y)}clone(){const i=new DP;return i.vector1=this._vector1,i.vector2=this._vector2,i.vector3=this._vector3,i._locationVector.copy(this._locationVector),i}set vector1(i){this._vector1.copy(i).normalize()}get vector1(){return this._vector1}set vector2(i){this._vector2.copy(i).normalize()}get vector2(){return this._vector2}set vector3(i){this._vector3.copy(i).normalize()}get vector3(){return this._vector3}}_e.global;class QM extends Ze{constructor(i,n,r){super(!0);y(this,"_sePointParent1");y(this,"_sePointParent2");y(this,"_sePointParent3");y(this,"tempVector1",new k);y(this,"tempVector2",new k);y(this,"tempVector3",new k);this.ref=new DP,this._sePointParent1=i,this._sePointParent2=n,this._sePointParent3=r,this._locationVector.copy(this.ref._locationVector)}get noduleDescription(){var i,n,r;return String(_e.global.t("objectTree.centerOfThreePointCircle",{pt1:(i=this._sePointParent1.label)==null?void 0:i.ref.shortUserName,pt2:(n=this._sePointParent2.label)==null?void 0:n.ref.shortUserName,pt3:(r=this._sePointParent3.label)==null?void 0:r.ref.shortUserName}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEThreePointCircleCenter"}get seParentPoint1(){return this._sePointParent1}get seParentPoint2(){return this._sePointParent2}get seParentPoint3(){return this._sePointParent3}shallowUpdate(){if(this._exists=this._sePointParent1.exists&&this._sePointParent2.exists&&this._sePointParent2.exists,this._exists=this._exists&&!(this.tempVector1.subVectors(this._sePointParent1.locationVector,this._sePointParent2.locationVector).isZero()&&this.tempVector2.subVectors(this._sePointParent2.locationVector,this._sePointParent3.locationVector).isZero()),this._exists=this._exists&&!(this.tempVector1.subVectors(this._sePointParent1.locationVector,this._sePointParent2.locationVector).isZero(S.tolerance)&&this.tempVector2.subVectors(this.tempVector3.copy(this._sePointParent2.locationVector).multiplyScalar(-1),this._sePointParent3.locationVector).isZero(S.nearlyAntipodalIdeal)),this._exists=this._exists&&!(this.tempVector1.subVectors(this._sePointParent1.locationVector,this._sePointParent3.locationVector).isZero(S.tolerance)&&this.tempVector2.subVectors(this.tempVector3.copy(this._sePointParent3.locationVector).multiplyScalar(-1),this._sePointParent2.locationVector).isZero(S.nearlyAntipodalIdeal)),this._exists=this._exists&&!(this.tempVector1.subVectors(this._sePointParent3.locationVector,this._sePointParent2.locationVector).isZero(S.tolerance)&&this.tempVector2.subVectors(this.tempVector3.copy(this._sePointParent2.locationVector).multiplyScalar(-1),this._sePointParent1.locationVector).isZero(S.nearlyAntipodalIdeal)),this._exists){const i=this.ref;i.vector1=this._sePointParent1.locationVector,i.vector2=this._sePointParent2.locationVector,i.vector3=this._sePointParent3.locationVector,this.ref.updateDisplay(),this._locationVector.copy(i._locationVector).normalize()}this._showing&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Three Point Circle center with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"threePointCircleCenter",object:this})}this.updateKids(i,n)}}isNonFreePoint(){return!0}isFreePoint(){return!1}}_e.global;class Dr extends Ze{constructor(i,n){super(!0);y(this,"_seParentPoint");y(this,"_seParentTransformation");y(this,"transType","");this._seParentPoint=i,this._seParentTransformation=n,this._seParentTransformation instanceof is?this.transType=_e.global.t("objects.translations",3):this._seParentTransformation instanceof ts?this.transType=_e.global.t("objects.rotations",3):this._seParentTransformation instanceof Qi?this.transType=_e.global.t("objects.reflections",3):this._seParentTransformation instanceof er?this.transType=_e.global.t("objects.pointReflections",3):this._seParentTransformation instanceof zr&&(this.transType=_e.global.t("objects.inversions",3))}get parentPoint(){return this._seParentPoint}get parentTransformation(){return this._seParentTransformation}get noduleDescription(){var i;return String(_e.global.t("objectTree.transformationObject",{object:_e.global.t("objects.points",3),name:(i=this._seParentPoint.label)==null?void 0:i.ref.shortUserName,trans:this._seParentTransformation.name,transType:this.transType}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SETransformedPoint"}shallowUpdate(){this._exists=this._seParentPoint.exists&&this._seParentTransformation.exists,this._exists&&(this.locationVector=this._seParentTransformation.f(this._seParentPoint.locationVector)),this._exists&&this._showing?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Transformed point with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"transformedPoint",object:this})}this.updateKids(i,n)}}isNonFreePoint(){return!0}isFreePoint(){return!1}}_e.global;class is extends $n{constructor(i,n){super();y(this,"_lineOrSegment");y(this,"_translationDistanceExpression");y(this,"_matrix",new Pt);this._lineOrSegment=i,this._translationDistanceExpression=n,this.ref=i.ref,$n.TRANSLATION_COUNT++,this.name=`Tr${$n.TRANSLATION_COUNT}`,this.update()}get geometricChild(){return this._lineOrSegment}get seLineOrSegment(){return this._lineOrSegment}get translationDistanceExpression(){return this._translationDistanceExpression}f(i){const n=new k;return n.copy(i).applyMatrix4(this._matrix),n}shallowUpdate(){this._exists=this._lineOrSegment.exists&&this._translationDistanceExpression.exists,this._exists&&this._matrix.makeRotationAxis(this._lineOrSegment.normalVector,this._translationDistanceExpression.value)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),this._exists&&this._matrix.makeRotationAxis(this._lineOrSegment.normalVector,this._translationDistanceExpression.value),i&&n){if(i.has(this.id)){console.log(`Translation with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"translation",object:this})}this.updateKids(i,n)}}get noduleItemText(){return this.name??"No Translation Name In SETranslation"}get noduleDescription(){var i;return String(_e.global.t("objectTree.translationAlongLineSegment",{along:(i=this._lineOrSegment.label)==null?void 0:i.ref.shortUserName,angle:this._translationDistanceExpression.name}))}}_e.global;class ut extends Ze{constructor(i,n){super(!0);y(this,"_antipodalPointParent");y(this,"_isUserCreated",!1);this._antipodalPointParent=i,n?(this._isUserCreated=!0,this.showing=!0):(this._isUserCreated=!1,this.showing=!1)}get noduleDescription(){var i;return String(_e.global.t("objectTree.antipodeOf",{pt:(i=this._antipodalPointParent.label)==null?void 0:i.ref.shortUserName}))}get noduleItemText(){var i;return((i=this.label)==null?void 0:i.ref.shortUserName)??"No Label Short Name In SEAntipodePoint"}get antipodalParent(){return this._antipodalPointParent}set isUserCreated(i){this._isUserCreated=i}get isUserCreated(){return this._isUserCreated}shallowUpdate(){this._exists=this._antipodalPointParent.exists,this._exists&&(this._locationVector.copy(this._antipodalPointParent.locationVector).multiplyScalar(-1),this.ref.positionVector=this._locationVector),this._showing&&this._isUserCreated&&this._exists?this.ref.setVisible(!0):this.ref.setVisible(!1)}update(i,n){if(this.canUpdateNow()){if(this.setOutOfDate(!1),this.shallowUpdate(),i&&n){if(i.has(this.id)){console.log(`Antipodal point with id ${this.id} has been visited twice proceed no further down this branch of the DAG.`);return}n.push(this.id),i.set(this.id,{kind:"antipodalPoint",object:this})}this.updateKids(i,n)}}set glowing(i){this._isUserCreated?super.glowing=i:this.ref.setVisible(i)}isNonFreePoint(){return!0}isFreePoint(){return!1}}class Gle{constructor(){y(this,"locationVector",new k)}setNewLocation(e){this.locationVector.copy(e)}actionOnLabel(e){return e.labelDirectLocationSetter(this.locationVector),!0}actionOnPoint(e){return!1}actionOnLine(e){return!1}actionOnSegment(e){return!1}actionOnCircle(e){return!1}actionOnEllipse(e){return!1}actionOnAngleMarker(e){return!1}actionOnParametric(e){return!1}actionOnPolygon(e){return!1}}class Hle{constructor(){y(this,"normalVector",new k)}setNewNormal(e){this.normalVector.copy(e)}actionOnPoint(e){return!1}actionOnLine(e){return e.normalVector=this.normalVector,!0}actionOnSegment(e){return!1}actionOnCircle(e){return!1}actionOnLabel(e){return!1}actionOnEllipse(e){return!1}actionOnAngleMarker(e){return!1}actionOnParametric(e){return!1}actionOnPolygon(e){return!1}}class qle{constructor(){y(this,"locationVector",new k)}setNewLocation(e){this.locationVector.copy(e)}actionOnPoint(e){return e instanceof kt?e.pointDirectLocationSetter(this.locationVector):e.locationVector=this.locationVector,e.shallowUpdate(),!0}actionOnLine(e){return!1}actionOnSegment(e){return!1}actionOnCircle(e){return!1}actionOnLabel(e){return!1}actionOnEllipse(e){return!1}actionOnAngleMarker(e){return!1}actionOnParametric(e){return!1}actionOnPolygon(e){return!1}}class Kle{constructor(){y(this,"transformMatrix",new Pt);y(this,"normalMatrix",new Ti);y(this,"tmpVector",new k)}setTransform(e){this.transformMatrix.copy(e),this.normalMatrix.getNormalMatrix(this.transformMatrix)}actionOnPoint(e){return this.tmpVector.copy(e.locationVector),this.tmpVector.applyMatrix4(this.transformMatrix),e instanceof kt?e.pointDirectLocationSetter(this.tmpVector):e.locationVector=this.tmpVector,e.shallowUpdate(),!0}actionOnLine(e){return!1}actionOnSegment(e){return e instanceof fu?(this.tmpVector.copy(e.normalVector),this.tmpVector.applyMatrix4(this.transformMatrix),e.normalVector=this.tmpVector,e.shallowUpdate(),!0):!1}actionOnCircle(e){return e instanceof du?(console.log("SELatitude actionOnCircle"),this.tmpVector.copy(e.circleSEPoint.locationVector),this.tmpVector.applyMatrix4(this.transformMatrix),e.circleSEPoint.locationVector=this.tmpVector,e.shallowUpdate(),!0):!1}actionOnLabel(e){return this.tmpVector.copy(e.locationVector),this.tmpVector.applyMatrix4(this.transformMatrix),e.labelDirectLocationSetter(this.tmpVector),!0}actionOnEllipse(e){return!1}actionOnAngleMarker(e){return!1}actionOnParametric(e){return e.fnValues.forEach(i=>i.applyMatrix4(this.transformMatrix)),e.fnPrimeValues.forEach(i=>i.applyMatrix4(this.transformMatrix)),e.fnPPrimeValues.forEach(i=>i.applyMatrix4(this.transformMatrix)),e.ref.updateDisplay(),!0}actionOnPolygon(e){return e.ref.updateDisplay(),!0}}class Xle{constructor(){y(this,"normalVector",new k);y(this,"arcLength",0)}setNewNormal(e){this.normalVector.copy(e)}setNewArcLength(e){this.arcLength=e}actionOnPoint(e){return!1}actionOnLine(e){return!1}actionOnSegment(e){return e.normalVector=this.normalVector,e.arcLength=this.arcLength,!0}actionOnCircle(e){return!1}actionOnLabel(e){return!1}actionOnEllipse(e){return!1}actionOnAngleMarker(e){return!1}actionOnParametric(e){return!1}actionOnPolygon(e){return!1}}const Mi=[],ca=new Map,qa=new Map,ua=new Map,Ka=new Map,Eg=new Map,zh=new Map,Gf=new Map,Xa=new Map,Ya=new Map,Hf=new Map,wg=new Map,sR=[],lo=[],Eb=new Map,wb=new Map,oR=new Pt,bn=new k,UT=[],aR=new Map,lR=new Map;function Ds(t,e){t.forEach(i=>{const n=e.findIndex(r=>r===i);n>-1&&e.splice(n,1)})}function Kr(t,e){t.forEach(i=>{e.findIndex(r=>r===i)===-1&&e.push(i)})}function Yle(){const t=[];let e=-1;ua.forEach(c=>{t.some(u=>u[0]===c.startSEPoint.id&&u[1]===c.endSEPoint.id||u[0]===c.endSEPoint.id&&u[1]===c.startSEPoint.id)?(t.push([c.startSEPoint.id,e]),t.push([e,c.endSEPoint.id]),e-=1):t.push([c.startSEPoint.id,c.endSEPoint.id])});const i=[],n=[];function r(c){const u=c[0];let h=null,d=[];for(const f of t){const m=f[0],g=f[1];if(u===m||u==g){if(m==u?h=g:h=m,!l(h,c))d=[h],d.push(...c),r(d);else if(c.length>2&&h===c[c.length-1]){const v=o(c),p=s(v);a(v)&&a(p)&&i.push(v)}}}}function s(c){const u=[];return c.forEach(h=>u.unshift(h)),o(u)}function o(c){const u=Math.min(...c),h=c.findIndex(d=>d===u);return c.rotate(h)}function a(c){return c.length===0?!1:i.every(u=>{if(u.length!==c.length)return!0;{const h=u.findIndex(d=>d===c[0]);if(h===-1)return!0;{let d=!0;return c.forEach((f,m)=>{let g=m+h;g>=c.length&&(g=g-c.length),d=d&&f===u[g]}),!d}}})}function l(c,u){return u.includes(c)}for(const c of t)for(const u of c)r([u]);for(const c of i)n.push(c.filter(u=>u>-1).length);return n}const An=D3({id:"se",state:()=>({isEarthMode:!1,actionMode:"rotate",previousActionMode:"rotate",svgCanvas:null,hasUnsavedNodules:!1,zoomMagnificationFactor:1,zoomTranslation:[0,0],canvasWidth:0,canvasHeight:0,sePointIds:[],seLineIds:[],seSegmentIds:[],seCircleIds:[],seEllipseIds:[],seLabelIds:[],seExpressionIds:[],seAngleMarkerIds:[],seParametricIds:[],sePolygonIds:[],seTransformationIds:[],oldSelectedSENoduleIDs:[],styleSavedFromPanel:q.Label,selectedSENoduleIds:[],disabledTools:[],inverseTotalRotationMatrix:new Pt}),actions:{init(){this.actionMode="rotate",Mi.splice(0),this.sePointIds.splice(0),ca.clear(),this.seLineIds.splice(0),qa.clear(),this.seSegmentIds.splice(0),ua.clear(),this.seCircleIds.splice(0),Ka.clear(),this.seAngleMarkerIds.splice(0),Gf.clear(),this.sePolygonIds.splice(0),Hf.clear(),this.seEllipseIds.splice(0),Xa.clear(),this.seParametricIds.splice(0),Ya.clear(),this.seTransformationIds.splice(0),wg.clear(),sR.splice(0),this.seLabelIds.splice(0),Eb.clear(),this.selectedSENoduleIds.splice(0),wb.clear(),this.oldSelectedSENoduleIDs.splice(0),this.seExpressionIds.splice(0),this.hasUnsavedNodules=!1,UT.splice(0),this.inverseTotalRotationMatrix.identity(),this.isEarthMode=!1},setLayers(t){lo.splice(0),lo.push(...t)},setCanvas(t){this.svgCanvas=t},setCanvasDimension(t,e){this.canvasWidth=t,this.canvasHeight=e},setRotationMatrix(t){this.inverseTotalRotationMatrix.copy(t)},setActionMode(t){this.actionMode==="zoomFit"||this.actionMode==="iconFactory"||(this.previousActionMode=this.actionMode),this.actionMode=t},revertActionMode(){this.actionMode=this.previousActionMode},removeAllFromLayers(){Gf.forEach(t=>t.ref.removeFromLayers()),Ka.forEach(t=>t.ref.removeFromLayers()),Xa.forEach(t=>t.ref.removeFromLayers()),Eg.forEach(t=>t.ref.removeFromLayers(lo)),qa.forEach(t=>t.ref.removeFromLayers()),this.sePointIds.forEach(t=>{const e=ca.get(t);e&&e.ref.removeFromLayers()}),ua.forEach(t=>t.ref.removeFromLayers()),Hf.forEach(t=>t.ref.removeFromLayers()),Ya.forEach(t=>{var e;(e=t.ref)==null||e.removeFromLayers()}),sR.forEach(t=>{t.lines.forEach(e=>{e.ref.removeFromLayers()})})},updateDisplay(){this.seNodules.filter(t=>t.isFreeToMove()).forEach(t=>{t.markKidsOutOfDate(),t.update()})},setZoomMagnificationFactor(t){$.fire("magnification-updated",{factor:this.zoomMagnificationFactor/t}),this.zoomMagnificationFactor=t},setZoomTranslation(t){for(let e=0;e<2;e++)this.zoomTranslation[e]=t[e]},addPoint(t){this.sePointIds.push(t.id),ca.set(t.id,t),Mi.push(t),t.ref.addToLayers(lo),this.hasUnsavedNodules=!0,this.updateDisabledTools("point")},removePoint(t){const e=ca.get(t);if(e){e.ref.removeFromLayers();const i=this.sePointIds.findIndex(r=>r===t),n=this.seNodules.findIndex(r=>r.id===t);this.sePointIds.splice(i,1),Mi.splice(n,1),ca.delete(t),this.hasUnsavedNodules=!0,this.updateDisabledTools("point")}},movePoint(t){const e=new qle;e.setNewLocation(t.location);const i=this.sePoints.findIndex(n=>n.id===t.pointId);i>-1&&this.sePoints[i].accept(e)},addLine(t){this.seLineIds.push(t.id),qa.set(t.id,t),Mi.push(t),t.ref.addToLayers(lo),this.hasUnsavedNodules=!0,this.updateDisabledTools("line")},removeLine(t){const e=qa.get(t);if(e){e.ref.removeFromLayers();const i=this.seLineIds.findIndex(r=>r===t),n=Mi.findIndex(r=>r.id===t);qa.delete(t),this.seLineIds.splice(i,1),Mi.splice(n,1),this.hasUnsavedNodules=!0,this.updateDisabledTools("line")}},addCircle(t){this.seCircleIds.push(t.id),Ka.set(t.id,t),Mi.push(t),console.debug(`SEStore: Adding Circle ${t.ref} to layers`),t.ref.addToLayers(lo),this.hasUnsavedNodules=!0,this.updateDisabledTools("circle")},removeCircle(t){const e=Ka.get(t);if(e){e.ref.removeFromLayers();const i=this.seCircleIds.findIndex(r=>r===t),n=Mi.findIndex(r=>r.id===t);this.seCircleIds.splice(i,1),Mi.splice(n,1),Ka.delete(t),this.hasUnsavedNodules=!0,this.updateDisabledTools("circle")}},addTransformation(t){this.seTransformationIds.push(t.id),wg.set(t.id,t),Mi.push(t),this.hasUnsavedNodules=!0,this.updateDisabledTools("transformation")},removeTransformation(t){if(wg.get(t)){const i=this.seTransformationIds.findIndex(r=>r===t),n=Mi.findIndex(r=>r.id===t);this.seTransformationIds.splice(i,1),Mi.splice(n,1),wg.delete(t),this.hasUnsavedNodules=!0,this.updateDisabledTools("transformation")}},addSegment(t){this.seSegmentIds.push(t.id),ua.set(t.id,t),Mi.push(t),t.ref.addToLayers(lo),this.hasUnsavedNodules=!0,this.updateDisabledTools("segment")},removeSegment(t){const e=ua.get(t);if(e){const i=this.seSegmentIds.findIndex(r=>r===t),n=Mi.findIndex(r=>r.id===t);e.ref.removeFromLayers(),this.seSegmentIds.splice(i,1),ua.delete(t),Mi.splice(n,1),this.hasUnsavedNodules=!0,this.updateDisabledTools("segment")}},addEllipse(t){this.seEllipseIds.push(t.id),Xa.set(t.id,t),Mi.push(t),t.ref.addToLayers(lo),this.hasUnsavedNodules=!0,this.updateDisabledTools("ellipse")},removeEllipse(t){const e=Xa.get(t);if(e){e.ref.removeFromLayers();const i=this.seEllipseIds.findIndex(r=>r===t),n=Mi.findIndex(r=>r.id===t);this.seEllipseIds.splice(i,1),Xa.delete(t),Mi.splice(n,1),this.hasUnsavedNodules=!0,this.updateDisabledTools("ellipse")}},addLabel(t){this.seLabelIds.push(t.id),Eg.set(t.id,t),Mi.push(t),t.ref.addToLayers(lo),this.hasUnsavedNodules=!0},removeLabel(t){const e=Eg.get(t);if(e){e.ref.removeFromLayers(lo);const i=this.seLabelIds.findIndex(r=>r===t),n=Mi.findIndex(r=>r.id===t);this.seLabelIds.splice(i,1),Eg.delete(t),Mi.splice(n,1),this.hasUnsavedNodules=!0}},moveLabel(t){const e=new Gle;e.setNewLocation(t.location);const i=this.seLabels.findIndex(n=>n.id===t.labelId);i>-1&&this.seLabels[i].accept(e)},addAngleMarkerAndExpression(t){this.seExpressionIds.push(t.id),this.seAngleMarkerIds.push(t.id),Gf.set(t.id,t),zh.set(t.id,t),Mi.push(t),t.ref.addToLayers(lo),this.hasUnsavedNodules=!0,this.updateDisabledTools("angleMarker")},removeAngleMarkerAndExpression(t){const e=Gf.get(t);if(e){e.ref.removeFromLayers(),Gf.delete(t),zh.delete(t);const i=this.seAngleMarkerIds.findIndex(s=>s===t),n=Mi.findIndex(s=>s.id===t),r=this.seExpressionIds.findIndex(s=>s===t);e.label&&(e.label.ref.value=[]),this.seAngleMarkerIds.splice(i,1),Mi.splice(n,1),this.seExpressionIds.splice(r,1),this.hasUnsavedNodules=!0,this.updateDisabledTools("angleMarker")}},addParametric(t){var e;this.seParametricIds.push(t.id),Ya.set(t.id,t),Mi.push(t),(e=t.ref)==null||e.addToLayers(lo),this.hasUnsavedNodules=!0,this.updateDisabledTools("parametric")},removeParametric(t){var i;const e=Ya.get(t);if(e){const n=this.seParametricIds.findIndex(s=>s===t),r=Mi.findIndex(s=>s.id===t);(i=e.ref)==null||i.removeFromLayers(),this.seParametricIds.splice(n,1),Ya.delete(t),Mi.splice(r,1),this.hasUnsavedNodules=!0,this.updateDisabledTools("parametric")}},addPolygonAndExpression(t){this.seExpressionIds.push(t.id),zh.set(t.id,t),this.sePolygonIds.push(t.id),Hf.set(t.id,t),Mi.push(t),t.ref.addToLayers(lo),this.hasUnsavedNodules=!0,this.updateDisabledTools("polygon")},removePolygonAndExpression(t){const e=Hf.get(t);if(e){const i=this.sePolygonIds.findIndex(s=>s===t),n=Mi.findIndex(s=>s.id===t),r=this.seExpressionIds.findIndex(s=>s===t);e.label&&(e.label.ref.value=[]),e.ref.removeFromLayers(),this.sePolygonIds.splice(i,1),Hf.delete(t),Mi.splice(n,1),this.seExpressionIds.splice(r,1),zh.delete(t),this.hasUnsavedNodules=!0,this.updateDisabledTools("polygon")}},addExpression(t){this.seExpressionIds.push(t.id),zh.set(t.id,t),Mi.push(t),this.hasUnsavedNodules=!0,this.updateDisabledTools("expression")},removeExpression(t){if(zh.get(t)){zh.delete(t);const i=this.seExpressionIds.findIndex(r=>r===t),n=Mi.findIndex(r=>r.id===t);this.seExpressionIds.splice(i,1),Mi.splice(n,1),this.hasUnsavedNodules=!0,this.updateDisabledTools("expression")}},rotateSphere(t){oR.copy(t).invert(),this.inverseTotalRotationMatrix.multiply(oR);const e=new Kle;e.setTransform(t);const i=[];if(Xe.unregisteredSEPointNorthPole!==void 0){const r=new k;r.copy(Xe.unregisteredSEPointNorthPole.locationVector),r.applyMatrix4(t),Xe.unregisteredSEPointNorthPole.locationVector=r}if(Xe.unregisteredSEPointSouthPole!==void 0){const r=new k;r.copy(Xe.unregisteredSEPointSouthPole.locationVector),r.applyMatrix4(t),Xe.unregisteredSEPointSouthPole.locationVector=r}function n(r){r.kids.forEach(s=>{s.exists&&s.canUpdateNow()&&(i.find(o=>o.name===s.name)||i.push(s))})}for(i.push(...Mi.filter(r=>r.parents.length===0));i.length>0;){const r=i.shift();r.accept(e)||r.shallowUpdate(),r.setOutOfDate(!1),r.markKidsOutOfDate(),n(r)}},clearUnsavedFlag(){this.hasUnsavedNodules=!1},changeStyle({selected:t,panel:e,payload:i}){const n={...i};t.forEach(r=>{r.updateStyle(e,n)})},changeBackContrast(t){pe.setBackStyleContrast(t),this.seNodules.forEach(e=>{var i;(i=e.ref)==null||i.stylize(Vt.ApplyCurrentVariables)})},changeSegmentNormalVectorArcLength(t){const e=new Xle;e.setNewNormal(t.normal),e.setNewArcLength(t.arcLength);const i=this.seSegments.findIndex(n=>n.id===t.segmentId);i>=0&&this.seSegments[i].accept(e)},changeLineNormalVector(t){const e=new Hle;e.setNewNormal(t.normal);const i=this.seLines.findIndex(n=>n.id===t.lineId);i>=0&&this.seLines[i].accept(e)},addTemporaryNodule(t){t.stylize(Vt.ApplyTemporaryVariables),t.adjustSize(),UT.push(t)},setSelectedSENodules(t){function e(i,n){if(i.length!=n.length)return!0;const r=i.map(o=>o.id).sort((o,a)=>o-a),s=n.map(o=>o.id).sort((o,a)=>o-a);for(let o=0;o<r.length;o++)if(r[o]!==s[o])return!0;return!1}e(this.selectedSENodules.map(i=>i),t)&&(this.selectedSENodules.forEach(i=>{var n;(n=i.ref)==null||n.setSelectedColoring(!1)}),Eb.clear(),this.selectedSENoduleIds.splice(0),t.forEach(i=>{this.selectedSENoduleIds.push(i.id),Eb.set(i.id,i)}),this.selectedSENodules.forEach(i=>{var n;(n=i.ref)==null||n.setSelectedColoring(!0)}))},setOldSelection(t){wb.clear(),this.oldSelectedSENoduleIDs.splice(0),t.forEach(e=>{this.oldSelectedSENoduleIDs.push(e.id),wb.set(e.id,e)})},recordStyleState(t){console.debug("About to record style",t.selected.length,"objects");const e=t.selected.map(i=>i.currentStyleState(t.panel));console.debug("SEStore recording style of selected objects in",q[t.panel],"with",e),aR.set(t.panel,e),lR.set(t.panel,t.selected.map(i=>i.defaultStyleState(t.panel)))},unglowAllSENodules(){Mi.forEach(t=>{!t.selected&&t.exists&&(t.glowing=!1)})},updateDisabledTools(t){switch(t){case"point":{const e=this.sePoints.filter(i=>!(i instanceof ut||i instanceof Le)||i.isUserCreated).length;e===1?(Ds(["coordinate","pointReflection"],this.disabledTools),Kr(["pointDistance"],this.disabledTools)):e>1?Ds(["pointDistance","coordinate","pointReflection"],this.disabledTools):Kr(["pointDistance","coordinate","pointReflection"],this.disabledTools);break}case"angleMarker":{this.seAngleMarkers.length>0?Ds(["angleBisector","nSectLine"],this.disabledTools):Kr(["angleBisector","nSectLine"],this.disabledTools);break}case"transformation":{this.seTransformations.length>0?Ds(["applyTransformation"],this.disabledTools):Kr(["applyTransformation"],this.disabledTools);break}case"circle":case"segment":case"line":case"ellipse":case"parametric":case"expression":{const e=this.seCircles.length,i=this.seSegments.length,n=this.seLines.length,r=this.seEllipses.length,s=this.seParametrics.length,o=this.expressions.length;if(e>0?Ds(["inversion"],this.disabledTools):Kr(["inversion"],this.disabledTools),o>0?Ds(["measuredCircle"],this.disabledTools):Kr(["measuredCircle"],this.disabledTools),i>0?Ds(["midpoint","nSectPoint","segmentLength"],this.disabledTools):Kr(["midpoint","nSectPoint","segmentLength"],this.disabledTools),e>0||i>0||n>0||r>0||s>0?(Ds(["perpendicular","pointOnObject"],this.disabledTools),e+i+n+r+s>1?Ds(["intersect"],this.disabledTools):Kr(["intersect"],this.disabledTools)):Kr(["perpendicular","pointOnObject","intersect"],this.disabledTools),e>0||r>0||s>0?Ds(["tangent"],this.disabledTools):Kr(["tangent"],this.disabledTools),i+e+o>0?Ds(["rotation"],this.disabledTools):Kr(["rotation"],this.disabledTools),i+n>0?Ds(["reflection"],this.disabledTools):Kr(["reflection"],this.disabledTools),i>0||o>0&&(n>0||i>0)?Ds(["translation"],this.disabledTools):Kr(["translation"],this.disabledTools),i>1){const a=Yle();a.length===0&&Kr(["measurePolygon","measureTriangle"],this.disabledTools),a.includes(2)||Math.max(...a)>3?Ds(["measurePolygon"],this.disabledTools):Kr(["measurePolygon"],this.disabledTools),a.includes(3)?Ds(["measureTriangle"],this.disabledTools):Kr(["measureTriangle"],this.disabledTools)}else Kr(["measurePolygon","measureTriangle"],this.disabledTools);break}default:console.debug(`updateDisabledTools fell through to default. Change was ${t}`)}}},getters:{seNodules:()=>Mi,sePoints:t=>t.sePointIds.map(e=>ca.get(e)),seLines:t=>t.seLineIds.map(e=>qa.get(e)),seCircles:t=>t.seCircleIds.map(e=>Ka.get(e)),seSegments:t=>t.seSegmentIds.map(e=>ua.get(e)),seEllipses:t=>t.seEllipseIds.map(e=>Xa.get(e)),seLabels:t=>t.seLabelIds.map(e=>Eg.get(e)),seAngleMarkers:t=>t.seAngleMarkerIds.map(e=>Gf.get(e)),seParametrics:t=>t.seParametricIds.map(e=>Ya.get(e)),sePolygons:t=>t.sePolygonIds.map(e=>Hf.get(e)),expressions:t=>t.seExpressionIds.map(e=>zh.get(e)),seTransformations:t=>t.seTransformationIds.map(e=>wg.get(e)),selectedSENodules:t=>t.selectedSENoduleIds.map(e=>Eb.get(e)),oldStyleSelections:t=>t.selectedSENoduleIds.map(e=>wb.get(e)),temporaryNodules:()=>UT,layers:()=>lo,initialStyleStatesMap:()=>aR,defaultStyleStatesMap:()=>lR,hasObjects(t){return t.sePointIds.length>0||t.seCircleIds.length>0||t.seSegmentIds.length>0},getSENoduleById(){return t=>Mi.map(e=>e).find(e=>e.id===t)},findNearbySENodules(){return(t,e)=>Mi.filter(i=>i.isHitAt(t,this.zoomMagnificationFactor))},findIntersectionPointsByParent(t){return(e,i)=>{const n=t.sePointIds.map(r=>ca.get(r)).filter(r=>r instanceof Le&&r.parents.some(s=>s.name===e)).map(r=>r);return i?n.filter(r=>r.parents.some(s=>s.name===i)):n}},createAllIntersectionsWithLine(t){return(e,i)=>{const n=[];i&&n.push(...i),ca.forEach(a=>{!a.locationVector.isZero()&&!n.some(l=>l.name===a.name)&&n.push(a)});const r=n.length,s=[];qa.forEach(a=>{if(a.id===e.id)return;const l=y5(a,e,!0);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<r?(s.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)):(s.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,s.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!1})}c=null})}),ua.forEach(a=>{const l=lC(e,a,!0);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<r?(s.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)):(s.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(e,a,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,s.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!1})}c=null})}),Ka.forEach(a=>{const l=cC(e,a);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<r?(s.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)):(s.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(e,a,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,s.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Xa.forEach(a=>{const l=hC(e,a);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<r?(s.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(s.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(e,a,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,s.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Ya.forEach(a=>{const l=uC(e,a,this.inverseTotalRotationMatrix);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<r?(s.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)):(s.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(e,a,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,s.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})});const o=[];return s.forEach(a=>{a.existingIntersectionPoint?!o.some(l=>a.SEIntersectionPoint.id===l.SEIntersectionPoint.id&&a.parent1.id===l.parent1.id)&&a.SEIntersectionPoint.id!==e.startSEPoint.id&&a.SEIntersectionPoint.id!==e.endSEPoint.id&&o.push(a):o.push(a)}),o}},createAllIntersectionsWithSegment(t){return(e,i)=>{const n=[];i&&n.push(...i),ca.forEach(a=>{!a.locationVector.isZero()&&!n.some(l=>l.name===a.name)&&n.push(a)});const r=[],s=n.length;qa.forEach(a=>{const l=lC(a,e,!0);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!1})}c=null})}),ua.forEach(a=>{if(a.id===e.id)return;const l=S5(a,e,!0);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!1})}c=null})}),Ka.forEach(a=>{const l=dC(e,a);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(e,a,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Xa.forEach(a=>{const l=fC(e,a);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(e,a,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Ya.forEach(a=>{const l=mC(e,a,this.inverseTotalRotationMatrix);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(e,a,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})});const o=[];return r.forEach(a=>{a.existingIntersectionPoint?!o.some(l=>a.SEIntersectionPoint.id===l.SEIntersectionPoint.id&&a.parent1.id===l.parent1.id)&&a.SEIntersectionPoint.id!==e.startSEPoint.id&&a.SEIntersectionPoint.id!==e.endSEPoint.id&&o.push(a):o.push(a)}),o}},createAllIntersectionsWithCircle(t){return(e,i)=>{const n=[];i&&n.push(...i),ca.forEach(a=>{!a.locationVector.isZero()&&!n.some(l=>l.name===a.name)&&n.push(a)});const r=[],s=n.length;qa.forEach(a=>{const l=cC(a,e);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),ua.forEach(a=>{const l=dC(a,e);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Ka.forEach(a=>{if(a.id===e.id)return;const l=Ky(a.centerSEPoint.locationVector,a.circleRadius,e.centerSEPoint.locationVector,e.circleRadius,!0);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Xa.forEach(a=>{const l=pC(e,a);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(e,a,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Ya.forEach(a=>{const l=gC(e,a,this.inverseTotalRotationMatrix);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(e,a,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})});const o=[];return r.forEach(a=>{a.existingIntersectionPoint?!o.some(l=>a.SEIntersectionPoint.id===l.SEIntersectionPoint.id&&a.parent1.id===l.parent1.id)&&a.SEIntersectionPoint.id!==e.circleSEPoint.id&&a.SEIntersectionPoint.id!==e.centerSEPoint.id&&o.push(a):o.push(a)}),o}},createAllIntersectionsWithEllipse(t){return(e,i)=>{const n=[];i&&n.push(...i),ca.forEach(a=>{!a.locationVector.isZero()&&!n.some(l=>l.name===a.name)&&n.push(a)});const r=[],s=n.length;qa.forEach(a=>{const l=hC(a,e);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),ua.forEach(a=>{const l=fC(a,e);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Ka.forEach(a=>{const l=pC(a,e);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Xa.forEach(a=>{if(a.id===e.id)return;const l=b5(a,e,!0);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Ya.forEach(a=>{const l=vC(e,a,this.inverseTotalRotationMatrix);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(e,a,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})});const o=[];return r.forEach(a=>{a.existingIntersectionPoint?!o.some(l=>a.SEIntersectionPoint.id===l.SEIntersectionPoint.id&&a.parent1.id===l.parent1.id)&&a.SEIntersectionPoint.id!==e.focus1SEPoint.id&&a.SEIntersectionPoint.id!==e.focus2SEPoint.id&&a.SEIntersectionPoint.id!==e.ellipseSEPoint.id&&o.push(a):o.push(a)}),o}},createAllIntersectionsWithParametric(t){return(e,i)=>{const n=[];i&&n.push(...i),ca.forEach(a=>{!a.locationVector.isZero()&&!n.some(l=>l.name===a.name)&&n.push(a)});const r=[],s=n.length;qa.forEach(a=>{const l=uC(a,e,this.inverseTotalRotationMatrix);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),ua.forEach(a=>{const l=mC(a,e,this.inverseTotalRotationMatrix);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!1}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Ka.forEach(a=>{const l=gC(a,e,this.inverseTotalRotationMatrix);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Xa.forEach(a=>{const l=vC(a,e,this.inverseTotalRotationMatrix);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:a,parent2:e,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})}),Ya.forEach(a=>{if(a.id===e.id)return;const l=_5(a,e);let c=null,u=-1;l.forEach((h,d)=>{if(n.some((f,m)=>bn.subVectors(h.vector,f.locationVector).isZero()&&!f.locationVector.isZero()?(f instanceof Le&&(c=f,u=m),!0):!1))c&&(u<s?(r.push({SEIntersectionPoint:c,parent1:e,parent2:e,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)):(r.push({SEIntersectionPoint:c,parent1:a,parent2:a,existingIntersectionPoint:!0,createAntipodalPoint:!0}),h.exists===!0&&(c.exists=h.exists)));else{const f=new Le(a,e,d,!1);n.push(f),f.locationVector=h.vector,f.exists=h.exists,r.push({SEIntersectionPoint:f,parent1:e,parent2:a,existingIntersectionPoint:!1,createAntipodalPoint:!0})}c=null})});const o=[];return r.forEach(a=>{a.existingIntersectionPoint&&o.some(l=>a.SEIntersectionPoint.id===l.SEIntersectionPoint.id&&a.parent1.id===l.parent1.id)||o.push(a)}),o}}}}),Zle={key:0},Jle={key:0,class:"text-body-1 ml-1"},Qle={class:"text-body-1"},ece={class:"text-body-2"},tce={key:1,class:"text-body-1"},ice=ri({__name:"CurrentToolSelection",setup(t){const e=new Map([["angle","CreateAngleDisplayedName"],["antipodalPoint","CreateAntipodalPointDisplayedName"],["circle","CreateCircleDisplayedName"],["coordinate","CreateCoordinateDisplayedName"],["delete","DeleteDisplayedName"],["ellipse","CreateEllipseDisplayedName"],["hide","HideDisplayedName"],["iconFactory","CreateIconDisplayedName"],["intersect","CreateIntersectionDisplayedName"],["line","CreateLineDisplayedName"],["move","MoveDisplayedName"],["perpendicular","CreatePerpendicularDisplayedName"],["tangent","CreateTangentDisplayedName"],["point","CreatePointDisplayedName"],["pointDistance","CreatePointDistanceDisplayedName"],["pointOnObject","CreatePointOnOneDimDisplayedName"],["polar","CreatePolarDisplayedName"],["rotate","RotateDisplayedName"],["segment","CreateLineSegmentDisplayedName"],["segmentLength","CreateSegmentLengthDisplayedName"],["select","SelectDisplayedName"],["toggleLabelDisplay","ToggleLabelDisplayedName"],["zoomFit","ZoomFitDisplayedName"],["zoomIn","PanZoomInDisplayedName"],["zoomOut","PanZoomOutDisplayedName"],["measureTriangle","MeasureTriangleDisplayedName"],["measurePolygon","MeasurePolygonDisplayedName"],["midpoint","CreateMidpointDisplayedName"],["nSectPoint","CreateNSectSegmentDisplayedName"],["angleBisector","CreateAngleBisectorDisplayedName"],["nSectLine","CreateNSectAngleDisplayedName"],["threePointCircle","CreateThreePointCircleDisplayedName"],["measuredCircle","MeasureCircleDisplayedName"],["translation","CreateTranslationDisplayedName"],["rotation","CreateRotationDisplayedName"],["reflection","CreateReflectionDisplayedName"],["pointReflection","CreatePointReflectionDisplayedName"],["inversion","CreateInversionDisplayedName"],["applyTransformation","ApplyTransformationDisplayedName"]]),i=An(),{actionMode:n}=Ji(i),{t:r}=qn();ge("");const s=W(()=>{const o=e.get(n.value);return o||`Unmapped actionMode ${n.value}`});return(o,a)=>le(n)?(Te(),Ct("span",Zle,[w(Ph,null,{default:U(()=>[w(pr,{align:"center"},{default:U(()=>[w(lt,{class:"mx-3",icon:"$"+le(n)},null,8,["icon"]),le(n)!="applyTransformation"?(Te(),Ct("span",Jle,nt(o.$t(`buttons.${s.value}`,{})),1)):(Te(),Ct(mt,{key:1},[tt("div",Qle,nt(o.$t(`buttons.${s.value}`,{})),1),tt("div",ece,nt(le(r)("objects.selectTransformation")),1)],64))],void 0,!0),_:1})],void 0),_:1})])):(Te(),Ct("span",tce,nt(o.$t("buttons.NoToolSelected",{}).toString()),1))}});var y_={exports:{}};y_.exports;(function(t,e){var i=200,n="__lodash_hash_undefined__",r=9007199254740991,s="[object Arguments]",o="[object Array]",a="[object Boolean]",l="[object Date]",c="[object Error]",u="[object Function]",h="[object GeneratorFunction]",d="[object Map]",f="[object Number]",m="[object Object]",g="[object Promise]",v="[object RegExp]",p="[object Set]",b="[object String]",_="[object Symbol]",P="[object WeakMap]",E="[object ArrayBuffer]",T="[object DataView]",C="[object Float32Array]",M="[object Float64Array]",x="[object Int8Array]",V="[object Int16Array]",N="[object Int32Array]",D="[object Uint8Array]",O="[object Uint8ClampedArray]",F="[object Uint16Array]",X="[object Uint32Array]",Z=/[\\^$.*+?()[\]{}|]/g,K=/\w*$/,z=/^\[object .+?Constructor\]$/,H=/^(?:0|[1-9]\d*)$/,re={};re[s]=re[o]=re[E]=re[T]=re[a]=re[l]=re[C]=re[M]=re[x]=re[V]=re[N]=re[d]=re[f]=re[m]=re[v]=re[p]=re[b]=re[_]=re[D]=re[O]=re[F]=re[X]=!0,re[c]=re[u]=re[P]=!1;var ne=typeof Bc=="object"&&Bc&&Bc.Object===Object&&Bc,B=typeof self=="object"&&self&&self.Object===Object&&self,Q=ne||B||Function("return this")(),fe=e&&!e.nodeType&&e,ie=fe&&!0&&t&&!t.nodeType&&t,se=ie&&ie.exports===fe;function ee(oe,Ve){return oe.set(Ve[0],Ve[1]),oe}function de(oe,Ve){return oe.add(Ve),oe}function Y(oe,Ve){for(var je=-1,Mt=oe?oe.length:0;++je<Mt&&Ve(oe[je],je,oe)!==!1;);return oe}function te(oe,Ve){for(var je=-1,Mt=Ve.length,Lr=oe.length;++je<Mt;)oe[Lr+je]=Ve[je];return oe}function he(oe,Ve,je,Mt){var Lr=-1,Is=oe?oe.length:0;for(Mt&&Is&&(je=oe[++Lr]);++Lr<Is;)je=Ve(je,oe[Lr],Lr,oe);return je}function ae(oe,Ve){for(var je=-1,Mt=Array(oe);++je<oe;)Mt[je]=Ve(je);return Mt}function A(oe,Ve){return oe==null?void 0:oe[Ve]}function I(oe){var Ve=!1;if(oe!=null&&typeof oe.toString!="function")try{Ve=!!(oe+"")}catch{}return Ve}function G(oe){var Ve=-1,je=Array(oe.size);return oe.forEach(function(Mt,Lr){je[++Ve]=[Lr,Mt]}),je}function ue(oe,Ve){return function(je){return oe(Ve(je))}}function Se(oe){var Ve=-1,je=Array(oe.size);return oe.forEach(function(Mt){je[++Ve]=Mt}),je}var Ee=Array.prototype,Oe=Function.prototype,ye=Object.prototype,Pe=Q["__core-js_shared__"],we=function(){var oe=/[^.]+$/.exec(Pe&&Pe.keys&&Pe.keys.IE_PROTO||"");return oe?"Symbol(src)_1."+oe:""}(),j=Oe.toString,R=ye.hasOwnProperty,J=ye.toString,ve=RegExp("^"+j.call(R).replace(Z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xe=se?Q.Buffer:void 0,me=Q.Symbol,Ne=Q.Uint8Array,ze=ue(Object.getPrototypeOf,Object),ke=Object.create,pt=ye.propertyIsEnumerable,Ue=Ee.splice,Ye=Object.getOwnPropertySymbols,Je=xe?xe.isBuffer:void 0,Ge=ue(Object.keys,Object),St=bf(Q,"DataView"),Ft=bf(Q,"Map"),be=bf(Q,"Promise"),et=bf(Q,"Set"),Ie=bf(Q,"WeakMap"),rt=bf(Object,"create"),Ke=Wu(St),Nt=Wu(Ft),zi=Wu(be),gn=Wu(et),wc=Wu(Ie),Sn=me?me.prototype:void 0,Vo=Sn?Sn.valueOf:void 0;function Vn(oe){var Ve=-1,je=oe?oe.length:0;for(this.clear();++Ve<je;){var Mt=oe[Ve];this.set(Mt[0],Mt[1])}}function bS(){this.__data__=rt?rt(null):{}}function _S(oe){return this.has(oe)&&delete this.__data__[oe]}function tw(oe){var Ve=this.__data__;if(rt){var je=Ve[oe];return je===n?void 0:je}return R.call(Ve,oe)?Ve[oe]:void 0}function Sf(oe){var Ve=this.__data__;return rt?Ve[oe]!==void 0:R.call(Ve,oe)}function PS(oe,Ve){var je=this.__data__;return je[oe]=rt&&Ve===void 0?n:Ve,this}Vn.prototype.clear=bS,Vn.prototype.delete=_S,Vn.prototype.get=tw,Vn.prototype.has=Sf,Vn.prototype.set=PS;function no(oe){var Ve=-1,je=oe?oe.length:0;for(this.clear();++Ve<je;){var Mt=oe[Ve];this.set(Mt[0],Mt[1])}}function ES(){this.__data__=[]}function iw(oe){var Ve=this.__data__,je=so(Ve,oe);if(je<0)return!1;var Mt=Ve.length-1;return je==Mt?Ve.pop():Ue.call(Ve,je,1),!0}function nw(oe){var Ve=this.__data__,je=so(Ve,oe);return je<0?void 0:Ve[je][1]}function rw(oe){return so(this.__data__,oe)>-1}function ce(oe,Ve){var je=this.__data__,Mt=so(je,oe);return Mt<0?je.push([oe,Ve]):je[Mt][1]=Ve,this}no.prototype.clear=ES,no.prototype.delete=iw,no.prototype.get=nw,no.prototype.has=rw,no.prototype.set=ce;function Ae(oe){var Ve=-1,je=oe?oe.length:0;for(this.clear();++Ve<je;){var Mt=oe[Ve];this.set(Mt[0],Mt[1])}}function Re(){this.__data__={hash:new Vn,map:new(Ft||no),string:new Vn}}function Me(oe){return xS(this,oe).delete(oe)}function Fe(oe){return xS(this,oe).get(oe)}function xt(oe){return xS(this,oe).has(oe)}function Wt(oe,Ve){return xS(this,oe).set(oe,Ve),this}Ae.prototype.clear=Re,Ae.prototype.delete=Me,Ae.prototype.get=Fe,Ae.prototype.has=xt,Ae.prototype.set=Wt;function Gt(oe){this.__data__=new no(oe)}function ti(){this.__data__=new no}function Ei(oe){return this.__data__.delete(oe)}function ai(oe){return this.__data__.get(oe)}function ui(oe){return this.__data__.has(oe)}function dn(oe,Ve){var je=this.__data__;if(je instanceof no){var Mt=je.__data__;if(!Ft||Mt.length<i-1)return Mt.push([oe,Ve]),this;je=this.__data__=new Ae(Mt)}return je.set(oe,Ve),this}Gt.prototype.clear=ti,Gt.prototype.delete=Ei,Gt.prototype.get=ai,Gt.prototype.has=ui,Gt.prototype.set=dn;function Ln(oe,Ve){var je=ow(oe)||t8(oe)?ae(oe.length,String):[],Mt=je.length,Lr=!!Mt;for(var Is in oe)(Ve||R.call(oe,Is))&&!(Lr&&(Is=="length"||ZH(Is,Mt)))&&je.push(Is);return je}function ro(oe,Ve,je){var Mt=oe[Ve];(!(R.call(oe,Ve)&&ZV(Mt,je))||je===void 0&&!(Ve in oe))&&(oe[Ve]=je)}function so(oe,Ve){for(var je=oe.length;je--;)if(ZV(oe[je][0],Ve))return je;return-1}function Rn(oe,Ve){return oe&&KV(Ve,aw(Ve),oe)}function Ci(oe,Ve,je,Mt,Lr,Is,ra){var oo;if(Mt&&(oo=Is?Mt(oe,Lr,Is,ra):Mt(oe)),oo!==void 0)return oo;if(!kS(oe))return oe;var eL=ow(oe);if(eL){if(oo=KH(oe),!Ve)return GH(oe,oo)}else{var _f=$u(oe),tL=_f==u||_f==h;if(n8(oe))return ag(oe,Ve);if(_f==m||_f==s||tL&&!Is){if(I(oe))return Is?oe:{};if(oo=XH(tL?{}:oe),!Ve)return HH(oe,Rn(oo,oe))}else{if(!re[_f])return Is?oe:{};oo=YH(oe,_f,Ci,Ve)}}ra||(ra=new Gt);var iL=ra.get(oe);if(iL)return iL;if(ra.set(oe,oo),!eL)var nL=je?qH(oe):aw(oe);return Y(nL||oe,function(lw,CS){nL&&(CS=lw,lw=oe[CS]),ro(oo,CS,Ci(lw,Ve,je,Mt,CS,oe,ra))}),oo}function og(oe){return kS(oe)?ke(oe):{}}function or(oe,Ve,je){var Mt=Ve(oe);return ow(oe)?Mt:te(Mt,je(oe))}function Tc(oe){return J.call(oe)}function wS(oe){if(!kS(oe)||QH(oe))return!1;var Ve=QV(oe)||I(oe)?ve:z;return Ve.test(Wu(oe))}function ju(oe){if(!YV(oe))return Ge(oe);var Ve=[];for(var je in Object(oe))R.call(oe,je)&&je!="constructor"&&Ve.push(je);return Ve}function ag(oe,Ve){if(Ve)return oe.slice();var je=new oe.constructor(oe.length);return oe.copy(je),je}function _r(oe){var Ve=new oe.constructor(oe.byteLength);return new Ne(Ve).set(new Ne(oe)),Ve}function xc(oe,Ve){var je=Ve?_r(oe.buffer):oe.buffer;return new oe.constructor(je,oe.byteOffset,oe.byteLength)}function lg(oe,Ve,je){var Mt=Ve?je(G(oe),!0):G(oe);return he(Mt,ee,new oe.constructor)}function Ls(oe){var Ve=new oe.constructor(oe.source,K.exec(oe));return Ve.lastIndex=oe.lastIndex,Ve}function cg(oe,Ve,je){var Mt=Ve?je(Se(oe),!0):Se(oe);return he(Mt,de,new oe.constructor)}function sw(oe){return Vo?Object(Vo.call(oe)):{}}function TS(oe,Ve){var je=Ve?_r(oe.buffer):oe.buffer;return new oe.constructor(je,oe.byteOffset,oe.length)}function GH(oe,Ve){var je=-1,Mt=oe.length;for(Ve||(Ve=Array(Mt));++je<Mt;)Ve[je]=oe[je];return Ve}function KV(oe,Ve,je,Mt){je||(je={});for(var Lr=-1,Is=Ve.length;++Lr<Is;){var ra=Ve[Lr],oo=Mt?Mt(je[ra],oe[ra],ra,je,oe):void 0;ro(je,ra,oo===void 0?oe[ra]:oo)}return je}function HH(oe,Ve){return KV(oe,XV(oe),Ve)}function qH(oe){return or(oe,aw,XV)}function xS(oe,Ve){var je=oe.__data__;return JH(Ve)?je[typeof Ve=="string"?"string":"hash"]:je.map}function bf(oe,Ve){var je=A(oe,Ve);return wS(je)?je:void 0}var XV=Ye?ue(Ye,Object):o8,$u=Tc;(St&&$u(new St(new ArrayBuffer(1)))!=T||Ft&&$u(new Ft)!=d||be&&$u(be.resolve())!=g||et&&$u(new et)!=p||Ie&&$u(new Ie)!=P)&&($u=function(oe){var Ve=J.call(oe),je=Ve==m?oe.constructor:void 0,Mt=je?Wu(je):void 0;if(Mt)switch(Mt){case Ke:return T;case Nt:return d;case zi:return g;case gn:return p;case wc:return P}return Ve});function KH(oe){var Ve=oe.length,je=oe.constructor(Ve);return Ve&&typeof oe[0]=="string"&&R.call(oe,"index")&&(je.index=oe.index,je.input=oe.input),je}function XH(oe){return typeof oe.constructor=="function"&&!YV(oe)?og(ze(oe)):{}}function YH(oe,Ve,je,Mt){var Lr=oe.constructor;switch(Ve){case E:return _r(oe);case a:case l:return new Lr(+oe);case T:return xc(oe,Mt);case C:case M:case x:case V:case N:case D:case O:case F:case X:return TS(oe,Mt);case d:return lg(oe,Mt,je);case f:case b:return new Lr(oe);case v:return Ls(oe);case p:return cg(oe,Mt,je);case _:return sw(oe)}}function ZH(oe,Ve){return Ve=Ve??r,!!Ve&&(typeof oe=="number"||H.test(oe))&&oe>-1&&oe%1==0&&oe<Ve}function JH(oe){var Ve=typeof oe;return Ve=="string"||Ve=="number"||Ve=="symbol"||Ve=="boolean"?oe!=="__proto__":oe===null}function QH(oe){return!!we&&we in oe}function YV(oe){var Ve=oe&&oe.constructor,je=typeof Ve=="function"&&Ve.prototype||ye;return oe===je}function Wu(oe){if(oe!=null){try{return j.call(oe)}catch{}try{return oe+""}catch{}}return""}function e8(oe){return Ci(oe,!0,!0)}function ZV(oe,Ve){return oe===Ve||oe!==oe&&Ve!==Ve}function t8(oe){return i8(oe)&&R.call(oe,"callee")&&(!pt.call(oe,"callee")||J.call(oe)==s)}var ow=Array.isArray;function JV(oe){return oe!=null&&r8(oe.length)&&!QV(oe)}function i8(oe){return s8(oe)&&JV(oe)}var n8=Je||a8;function QV(oe){var Ve=kS(oe)?J.call(oe):"";return Ve==u||Ve==h}function r8(oe){return typeof oe=="number"&&oe>-1&&oe%1==0&&oe<=r}function kS(oe){var Ve=typeof oe;return!!oe&&(Ve=="object"||Ve=="function")}function s8(oe){return!!oe&&typeof oe=="object"}function aw(oe){return JV(oe)?Ln(oe):ju(oe)}function o8(){return[]}function a8(){return!1}t.exports=e8})(y_,y_.exports);var nce=y_.exports;const rce=IP(nce);const Xv=Symbol.for("vuetify:v-expansion-panel"),sce=["default","accordion","inset","popout"],oce=We({color:String,static:Boolean,variant:{type:String,default:"default",validator:t=>sce.includes(t)},readonly:Boolean,...Ut(),...My(),...pn(),...wn()},"VExpansionPanels"),ul=vt()({name:"VExpansionPanels",props:oce(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;Ip(t,Xv);const{themeClasses:n}=Hn(t),r=W(()=>t.variant&&`v-expansion-panels--variant-${t.variant}`);return Pl({VExpansionPanel:{color:bt(t,"color"),readonly:bt(t,"readonly"),static:bt(t,"static")}}),Tt(()=>w(t.tag,{class:["v-expansion-panels",n.value,r.value,t.class],style:t.style},i)),{}}}),ace=We({...Ut(),...yP()},"VExpansionPanelText"),gl=vt()({name:"VExpansionPanelText",props:ace(),setup(t,e){let{slots:i}=e;const n=xi(Xv);if(!n)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:r,onAfterLeave:s}=mM(t,n.isSelected);return Tt(()=>w(vB,{onAfterLeave:s},{default:()=>{var o;return[fi(w("div",{class:["v-expansion-panel-text",t.class],style:t.style},[i.default&&r.value&&w("div",{class:"v-expansion-panel-text__wrapper"},[(o=i.default)==null?void 0:o.call(i)])]),[[ln,n.isSelected.value]])]}})),{}}}),E5=We({color:String,expandIcon:{type:ji,default:"$expand"},collapseIcon:{type:ji,default:"$collapse"},hideActions:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...Ut()},"VExpansionPanelTitle"),cc=vt()({name:"VExpansionPanelTitle",directives:{Ripple:of},props:E5(),setup(t,e){let{slots:i}=e;const n=xi(Xv);if(!n)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:r,backgroundColorStyles:s}=Cs(t,"color"),o=W(()=>({collapseIcon:t.collapseIcon,disabled:n.disabled.value,expanded:n.isSelected.value,expandIcon:t.expandIcon,readonly:t.readonly}));return Tt(()=>{var a;return fi(w("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":n.isSelected.value,"v-expansion-panel-title--static":t.static},r.value,t.class],style:[s.value,t.style],type:"button",tabindex:n.disabled.value?-1:void 0,disabled:n.disabled.value,"aria-expanded":n.isSelected.value,onClick:t.readonly?void 0:n.toggle},[w("span",{class:"v-expansion-panel-title__overlay"},null),(a=i.default)==null?void 0:a.call(i,o.value),!t.hideActions&&w("span",{class:"v-expansion-panel-title__icon"},[i.actions?i.actions(o.value):w(lt,{icon:n.isSelected.value?t.collapseIcon:t.expandIcon},null)])]),[[Mo("ripple"),t.ripple]])}),{}}}),lce=We({title:String,text:String,bgColor:String,...Ut(),...Tl(),...Ay(),...yP(),...cs(),...pn(),...E5()},"VExpansionPanel"),nh=vt()({name:"VExpansionPanel",props:lce(),emits:{"group:selected":t=>!0},setup(t,e){let{slots:i}=e;const n=Vy(t,Xv),{backgroundColorClasses:r,backgroundColorStyles:s}=Cs(t,"bgColor"),{elevationClasses:o}=xl(t),{roundedClasses:a}=hs(t),l=W(()=>(n==null?void 0:n.disabled.value)||t.disabled),c=W(()=>n.group.items.value.reduce((d,f,m)=>(n.group.selected.value.includes(f.id)&&d.push(m),d),[])),u=W(()=>{const d=n.group.items.value.findIndex(f=>f.id===n.id);return!n.isSelected.value&&c.value.some(f=>f-d===1)}),h=W(()=>{const d=n.group.items.value.findIndex(f=>f.id===n.id);return!n.isSelected.value&&c.value.some(f=>f-d===-1)});return jn(Xv,n),Pl({VExpansionPanelText:{eager:bt(t,"eager")},VExpansionPanelTitle:{readonly:bt(t,"readonly")}}),Tt(()=>{const d=!!(i.text||t.text),f=!!(i.title||t.title);return w(t.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":n.isSelected.value,"v-expansion-panel--before-active":u.value,"v-expansion-panel--after-active":h.value,"v-expansion-panel--disabled":l.value},a.value,r.value,t.class],style:[s.value,t.style]},{default:()=>{var m;return[w("div",{class:["v-expansion-panel__shadow",...o.value]},null),f&&w(cc,{key:"title",collapseIcon:t.collapseIcon,color:t.color,expandIcon:t.expandIcon,hideActions:t.hideActions,ripple:t.ripple},{default:()=>[i.title?i.title():t.title]}),d&&w(gl,{key:"text"},{default:()=>[i.text?i.text():t.text]}),(m=i.default)==null?void 0:m.call(i)]}})}),{}}});const w5=Symbol.for("vuetify:v-item-group"),cce=We({...Ut(),...My({selectedClass:"v-item--selected"}),...pn(),...wn()},"VItemGroup"),hce=vt()({name:"VItemGroup",props:cce(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const{themeClasses:n}=Hn(t),{isSelected:r,select:s,next:o,prev:a,selected:l}=Ip(t,w5);return()=>w(t.tag,{class:["v-item-group",n.value,t.class],style:t.style},{default:()=>{var c;return[(c=i.default)==null?void 0:c.call(i,{isSelected:r,select:s,next:o,prev:a,selected:l.value})]}})}}),cR=vt()({name:"VItem",props:Ay(),emits:{"group:selected":t=>!0},setup(t,e){let{slots:i}=e;const{isSelected:n,select:r,toggle:s,selectedClass:o,value:a,disabled:l}=Vy(t,w5);return()=>{var c;return(c=i.default)==null?void 0:c.call(i,{isSelected:n.value,selectedClass:o.value,select:r,toggle:s,value:a.value,disabled:l.value})}}}),uce={key:0},dce={class:"body-1 font-weight-bold button-group-heading"},fce={class:"button-group"},mce={class:"body-1 font-weight-bold"},pce=ri({__name:"ToolGroups",setup(t){const e=Eh(),{userRole:i,includedTools:n}=Ji(e),r=An(),{expressions:s,seTransformations:o,actionMode:a}=Ji(r),l=ge(!1),c=ge(!1),u=ge([]),h=[],d=ge("rotate");let f=null;to(()=>{l.value=!0,u.value.push(...p0),u.value.forEach(_=>{_.children.sort((P,E)=>P.id-E.id)}),h.push(...n.value)}),He(()=>a.value,_=>{d.value!==_&&(d.value=_),m()});function m(){switch(a.value){case"measuredCircle":s.value.length>0?($.fire("left-panel-set-active-tab",{tabNumber:1}),$.fire("expand-measurement-sheet",{})):$.fire("show-alert",{key:"objectTree.createMeasurementForMeasuredCircle",type:"info"});break;case"translation":s.value.length>0?($.fire("left-panel-set-active-tab",{tabNumber:1}),$.fire("expand-measurement-sheet",{})):$.fire("show-alert",{key:"objectTree.createMeasurementForTranslation",type:"info"});break;case"rotation":s.value.length>0?($.fire("left-panel-set-active-tab",{tabNumber:1}),$.fire("expand-measurement-sheet",{})):$.fire("show-alert",{key:"objectTree.createMeasurementForRotation",type:"info"});break;case"applyTransformation":o.value.length>0?($.fire("left-panel-set-active-tab",{tabNumber:1}),$.fire("expand-transformation-sheet",{})):$.fire("show-alert",{key:"objectTree.createATransformation",type:"error"});break}}function g(){if(!c.value)u.value.flatMap(P=>P.children).find(P=>P.action==d.value)&&r.setActionMode(d.value);else{const _=d.value?d.value:f;n.value.includes(_)?e.excludeToolName(_):e.includeToolName(_)}d.value&&(f=d.value)}function v(){if(c.value=!c.value,u.value.splice(0),c.value)u.value.push(...p0);else{const _=rce(p0);_.forEach(P=>{P.children=P.children.filter(E=>n.value.includes(E.action))}),u.value.push(..._)}}function p(_){return n.value.findIndex(P=>P===_)>=0}const b=[{id:0,action:"iconFactory",displayedName:"buttons.CreateIconDisplayedName",toolTipMessage:"buttons.CreateIconToolTipMessage",toolUseMessage:"buttons.CreateIconToolUseMessage"}];return(_,P)=>(Te(),Ct(mt,null,[le(i)&&le(i)==="instructor"?(Te(),qe(Qt,{key:0,elevation:"2",fab:"",size:"small",color:"primary",onClick:v},{default:U(()=>[c.value?(Te(),qe(lt,{key:0},{default:U(()=>[$e("mdi-check")],void 0,!0),_:1})):(Te(),qe(lt,{key:1},{default:U(()=>[$e("mdi-pencil")],void 0,!0),_:1}))],void 0),_:1})):Vi("",!0),w(ice),w(hce,{modelValue:d.value,"onUpdate:modelValue":[P[0]||(P[0]=E=>d.value=E),g]},{default:U(()=>[w(ul,{style:{gap:"10px","padding-right":"8px"}},{default:U(()=>[(Te(!0),Ct(mt,null,Zs(u.value,(E,T)=>(Te(),qe(ul,{key:T},{default:U(()=>[w(nh,{style:{"border-radius":"8px"}},{default:U(()=>[E.children.length>0?(Te(),Ct("div",uce)):Vi("",!0),w(cc,null,{default:U(()=>[tt("h3",dce,nt(_.$t(`toolGroups.${E.group}`)),1)],void 0,!0),_:2},1024),w(gl,null,{default:U(()=>[tt("div",fce,[(Te(!0),Ct(mt,null,Zs(E.children,C=>(Te(),qe(cR,{key:C.action,value:C.action},{default:U(({isSelected:M,toggle:x})=>[w(kN,{onClick:x,button:C,selected:M,included:p(C.action),editing:c.value},null,8,["onClick","button","selected","included","editing"])]),_:2},1032,["value"]))),128))])],void 0,!0),_:2},1024)],void 0,!0),_:2},1024)],void 0,!0),_:2},1024))),128)),fi(w(ul,{id:"DeveloperToolGroup"},{default:U(()=>[w(nh,{style:{"border-radius":"8px"}},{default:U(()=>[w(cc,null,{default:U(()=>[tt("h3",mce,nt(_.$t("toolGroups.DeveloperOnlyTools")),1)],void 0,!0),_:1}),w(gl,null,{default:U(()=>[w(cR,null,{default:U(({isSelected:E,toggle:T})=>[(Te(),Ct(mt,null,Zs(b,(C,M)=>w(kN,{onClick:T,key:M,button:C,editing:c.value,selected:E,included:!0},null,8,["onClick","button","editing","selected"])),64))]),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1},512),[[ln,b.length>0&&!l.value]])],void 0,!0),_:1})],void 0),_:1},8,["modelValue"])],64))}});const gce=Tn(pce,[["__scopeId","data-v-5a1bef7c"]]);class qi extends L{constructor(i,n){var r;super();y(this,"seNodule");y(this,"showing");y(this,"initialLabelShowingValue");this.seNodule=i,this.showing=n,this.seNodule.isLabelable()&&(this.initialLabelShowingValue=(r=this.seNodule.label)==null?void 0:r.showing)}do(){this.seNodule.showing=this.showing,this.showing===!1&&this.initialLabelShowingValue===!0&&(this.seNodule.label.showing=!1)}saveState(){this.lastState=this.seNodule.id}restoreState(){this.seNodule.showing=!this.showing,this.initialLabelShowingValue!==void 0&&(this.seNodule.label.showing=this.initialLabelShowingValue)}toOpcode(){return["SetNoduleDisplay","objectName="+L.symbolToASCIIDec(this.seNodule.name),"objectShowing="+this.showing].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((a,l)=>{if(l===0)return;const c=a.split("=");s.set(c[0],L.asciiDecToSymbol(c[1]))});const o=n.get(s.get("objectName")??"");if(o)return new qi(o,s.get("objectShowing")==="true");throw new Error(`SetNoduleDisplayCommand: nodule with name ${s.get("objectName")} is undefined`)}}class Hp extends L{constructor(i,n,r){super();y(this,"seExpression");y(this,"newValueDisplayMode");y(this,"oldValueDisplayMode");this.seExpression=i,this.oldValueDisplayMode=n,this.newValueDisplayMode=r}do(){this.seExpression.valueDisplayMode=this.newValueDisplayMode}saveState(){this.lastState=this.seExpression.id}restoreState(){this.seExpression.valueDisplayMode=this.oldValueDisplayMode}toOpcode(){return["SetValueDisplayMode","objectName="+L.symbolToASCIIDec(this.seExpression.name),"setValueDisplayModeOldValue="+this.oldValueDisplayMode,"setValueDisplayModeNewValue="+this.newValueDisplayMode].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((c,u)=>{if(u===0)return;const h=c.split("=");s.set(h[0],L.asciiDecToSymbol(h[1]))});const o=n.get(s.get("objectName")??""),a=s.get("setValueDisplayModeOldValue"),l=s.get("setValueDisplayModeNewValue");if(o&&a&&l)return new Hp(o,a,l);throw new Error(`SetValueDisplayModeCommand: Expression ${o} or Value Display Mode: Old ${a} or New ${l} are undefined`)}}const vce={class:"text-truncate ml-1"},yce=ri({__name:"SENoduleItem",props:{node:{}},emits:["object-select"],setup(t,{emit:e}){const i=An(),{actionMode:n,isEarthMode:r,inverseTotalRotationMatrix:s}=Ji(i),o=t,a=e,{t:l}=qn(),c=ge(1),u=ge(1),h=ge("mdi-help");let d="",f="",m=!1,g=!1,v=!1,p=!1,b=null,_=null;const P=ge(0),E=ge(0),T=ge(1),C=ge(.01),M=ge(!1),x=new k;to(()=>{var ee;navigator.clipboard&&(M.value=!0),o.node.isLabelable()?d=((ee=o.node.label)==null?void 0:ee.ref.shortUserName)??"":d=o.node.name,o.node instanceof Ze&&(x.copy(o.node.locationVector),x.applyMatrix4(s.value),Math.abs(x.y-1)<S.tolerance?(console.log("object tree - found north pole"),m=!0):Math.abs(x.y+1)<S.tolerance&&(console.log("object tree - found south pole"),g=!0)),o.node instanceof Xc?(h.value="$earthPoint",f=l("objects.points",3)):o.node instanceof ut?(h.value="$antipodalPoint",f=l("objects.points",3)):o.node instanceof Le?(h.value="$intersect",f=l("objects.points",3)):o.node instanceof nv?(h.value=o.node.N===2?"$midpoint":"$nSectPoint",f=l("objects.points",3)):o.node instanceof v_?(h.value="$polar",f=l("objects.points",3)):o.node instanceof Dr||o.node instanceof jc?(h.value="$transformedPoint",f=l("objects.points",3)):o.node instanceof kt?(h.value="$pointOnObject",f=l("objects.points",3)):o.node instanceof Ze?(h.value="$point",f=l("objects.points",3)):o.node instanceof Jg||o.node instanceof Kt&&o.node.circleSEPoint instanceof Dr&&o.node.centerSEPoint instanceof jc&&o.node.centerSEPoint.parentTransformation.name===o.node.circleSEPoint.parentTransformation.name?(h.value="$transformedCircle",f=l("objects.circles",3)):o.node instanceof du?(h.value="$earthLatitude",f=l("objects.circle",3),o.node.latitude==0&&(v=!0)):o.node instanceof Kt?(h.value="$circle",f=l("objects.circles",3)):o.node instanceof Qg?(h.value="$transformedEllipse",f=l("objects.ellipses",3)):o.node instanceof Ii?(h.value="$ellipse",f=l("objects.ellipses",3)):o.node instanceof zr?(h.value="$inversion",f=l("objects.transformations",3)):o.node instanceof er?(h.value="$pointReflection",f=l("objects.transformations",3)):o.node instanceof Qi?(h.value="$reflection",f=l("objects.transformations",3)):o.node instanceof ts?(h.value="$rotation",f=l("objects.transformations",3)):o.node instanceof is?(h.value="$translation",f=l("objects.transformations",3)):o.node instanceof OP?(h.value="$perpendicular",f=l("objects.lines",3)):o.node instanceof ev?(h.value="$transformedLine",d=o.node.name,f=l("objects.lines",3)):o.node instanceof iv?(h.value=o.node.N===2?"$angleBisector":"$nSectLine",f=l("objects.lines",3)):o.node instanceof ZM?(h.value="$polar",f=l("objects.lines",3)):o.node instanceof Gp?(h.value="$tangent",f=l("objects.lines",3)):o.node instanceof $t?(h.value="$line",f=l("objects.lines",3)):o.node instanceof tv?(h.value="$transformedSegment",d=o.node.name,f=l("objects.segments",3)):o.node instanceof fu?(h.value="$earthLongitude",f=l("objects.segments",3),o.node.longitude==0&&(p=!0)):o.node instanceof Jt?(h.value="$segment",f=l("objects.segments",3)):o.node instanceof en?(h.value="$angle",f=l("objects.angleMarkers",3)):o.node instanceof Ks?(h.value=o.node.seEdgeSegments.length===3?"$measureTriangle":"$measurePolygon",f=l("objects.triangles",3)):o.node instanceof ws?(h.value="$segmentLength",f=l("objects.measurements",3)):o.node instanceof Sl?(h.value="$pointDistance",d=o.node.name,f=l("objects.measurements",3)):o.node instanceof qM?(h.value="$calculationObject",d=o.node.name,f=l("objects.calculations",3)):o.node instanceof On&&(h.value="$measurementObject",d=o.node.name,f=l("objects.measurements",3))}),ki(()=>{if(o.node instanceof tn){b=o.node,_=b.tracePoint;const[ee,de]=b.tMinMaxExpressionValues();E.value=ee,T.value=de,C.value=(de-ee)/100,z(ee)}$.listen("update-label-and-showing-display",V)});function V(){c.value=1-c.value,u.value=c.value}an(()=>{$.unlisten("update-label-and-showing-display")});function N(ee){if(B.value)o.node.glowing=ee;else if(o.node instanceof ws){const de=o.node.parents[0];de.glowing=ee}else if(o.node instanceof Sl)o.node.parents.map(de=>de).forEach(de=>{de.glowing=ee});else if(o.node instanceof Ks)o.node.seEdgeSegments.map(de=>de).forEach(de=>{de.glowing=ee});else if(o.node instanceof ma){const de=o.node.point;de.glowing=ee}else if(o.node instanceof is){const de=o.node.seLineOrSegment;de.glowing=ee}else if(o.node instanceof er){const de=o.node.sePointOfReflection;de.glowing=ee}else if(o.node instanceof Qi){const de=o.node.seLineOrSegment;de.glowing=ee}else if(o.node instanceof ts){const de=o.node.seRotationPoint;de.glowing=ee}else if(o.node instanceof zr){const de=o.node.seCircleOfInversion;de.glowing=ee}o.node instanceof On&&$.fire("measured-circle-set-temporary-radius",{display:ee,radius:o.node.value})}function D(){o.node instanceof On?(a("object-select",{id:o.node.id}),$.fire("set-expression-for-tool",{expression:o.node})):o.node instanceof $n&&$.fire("set-transformation-for-tool",{transformation:o.node})}function O(){new qi(o.node,!o.node.showing).execute(),V(),m?$.fire("update-pole-switch",{pole:wr.NORTH,val:o.node.showing}):g?$.fire("update-pole-switch",{pole:wr.SOUTH,val:o.node.showing}):v?$.fire("update-equator-switch",{val:o.node.showing}):p&&$.fire("update-prime-meridian-switch",{val:o.node.showing})}function F(){(o.node instanceof Ze||o.node instanceof $t||o.node instanceof Jt||o.node instanceof Kt||o.node instanceof Ii||o.node instanceof en||o.node instanceof tn||o.node instanceof Ks)&&o.node.label&&new qi(o.node.label,!o.node.label.showing).execute(),V()}function X(){o.node instanceof On&&navigator.clipboard.writeText(String(o.node.value)).then(()=>$.fire("show-alert",{key:"objectTree.copiedMeasurementSuccessfullyToClipboard",type:"success"}))}function Z(){$.fire("delete-node",{victim:o.node,victimName:d,victimType:f}),i.unglowAllSENodules()}function K(){o.node instanceof en?o.node.label&&(o.node.label.showing||new qi(o.node.label,!0).execute()):o.node instanceof ws?o.node.seSegment.label&&(o.node.seSegment.label.showing||new qi(o.node.seSegment.label,!0).execute()):o.node instanceof Ks&&o.node.label&&(o.node.label.showing||new qi(o.node.label,!0).execute());const ee=o.node.valueDisplayMode;let de;if(r.value&&!(o.node instanceof en))switch(ee){case Ni.Number:case Ni.MultipleOfPi:case Ni.DegreeDecimals:de=o.node.postEarthModeValueDisplayMode;break;case Ni.EarthModeKilos:de=Ni.EarthModeMiles;break;case Ni.EarthModeMiles:de=Ni.EarthModeKilos;break}else switch(ee){case Ni.Number:de=Ni.MultipleOfPi;break;case Ni.MultipleOfPi:de=Ni.DegreeDecimals;break;case Ni.DegreeDecimals:de=Ni.Number;break;case Ni.EarthModeKilos:case Ni.EarthModeMiles:de=o.node.preEarthModeValueDisplayMode;break}new Hp(o.node,ee,de).execute()}He(()=>P.value,z);function z(ee){b&&_&&(_.setLocationByTime(ee),_.markKidsOutOfDate(),_.update())}W(()=>!o.node.showing);const H=()=>{var ee;return o.node instanceof Ze||o.node instanceof $t||o.node instanceof Jt||o.node instanceof Kt||o.node instanceof Ii||o.node instanceof en||o.node instanceof tn||o.node instanceof Ks?!((ee=o.node.label)!=null&&ee.showing):!1},re=W(()=>r?o.node instanceof On:o.node instanceof On&&!(o.node instanceof ma)),ne=W(()=>o.node instanceof On);W(()=>{var ee;return o.node instanceof tn?(d=((ee=o.node.label)==null?void 0:ee.ref.shortUserName)??"",f=l("objects.parametrics",3),!0):!1});const B=W(()=>o.node instanceof Ze||o.node instanceof $t||o.node instanceof Jt||o.node instanceof Kt||o.node instanceof Ii||o.node instanceof en||o.node instanceof tn||o.node instanceof Ks),Q=W(()=>o.node.showing?"visibleNode":"invisibleNode"),fe=W(()=>n.value==="measuredCircle"&&o.node instanceof Ii||n.value==="applyTransformation"&&o.node instanceof $n?"shake":""),ie=W(()=>n.value==="measuredCircle"&&o.node instanceof On?"shake":""),se=W(()=>n.value==="applyTransformation"&&o.node instanceof $n?"shake":"");return(ee,de)=>(Te(),Ct("div",null,[w(Ph,{class:"node",onMouseenter:de[0]||(de[0]=Y=>N(!0)),onMouseleave:de[1]||(de[1]=Y=>N(!1))},{default:U(()=>[w(pr,{density:"compact",justify:"start",class:"pa-0"},{default:U(()=>[w(Si,{cols:"auto"},{default:U(()=>[w(lt,{size:"medium",icon:h.value,class:Gs(fe.value)},null,8,["icon","class"])],void 0,!0),_:1}),w(Si,{class:"text-truncate"},{default:U(()=>[w(dr,{location:"end"},{activator:U(({props:Y})=>[tt("div",ht({id:"_test_selection",class:"contentText",onClick:D},Y,{class:[Q.value,ie.value,se.value]}),[tt("span",vce,nt(ee.node.noduleItemText),1)],16)]),default:U(()=>[tt("span",null,nt(ee.node.noduleDescription)+"/ "+nt(le(d)),1)],void 0,!0),_:1})],void 0,!0),_:1}),w(Si,{justify:"end"},{default:U(()=>[w(pr,{align:"center","no-gutters":""},{default:U(()=>[w(Si,null,{default:U(()=>[w(dr,{location:"end"},{activator:U(({props:Y})=>[ne.value&&M.value?(Te(),Ct("div",ht({key:0,id:"_test_copy_to_clipboard"},Y,{onClick:X}),[w(lt,{size:"small"},{default:U(()=>[$e("$copyToClipboard")],void 0,!0),_:1})],16)):Vi("",!0)]),default:U(()=>[tt("span",null,nt(ee.$t("objectTree.copyToClipboard")),1)],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),w(Si,null,{default:U(()=>[w(dr,{location:"end"},{activator:U(({props:Y})=>[re.value?(Te(),Ct("div",ht({key:0,id:"_test_toggle_format"},Y,{onClick:K}),[w(lt,{size:"small"},{default:U(()=>[$e("$cycleNodeValueDisplayMode")],void 0,!0),_:1})],16)):Vi("",!0)]),default:U(()=>[tt("span",null,nt(ee.$t("objectTree.cycleValueDisplayMode")),1)],void 0,!0),_:1})],void 0,!0),_:1}),w(Si,null,{default:U(()=>[w(dr,{location:"end"},{activator:U(({props:Y})=>[B.value?(Te(),qe(lt,ht({key:0,id:"_test_toggle_visibility"},Y,{onClick:O,size:"tiny",icon:ee.node.showing?"$hideNode":"$showNode",key:c.value,style:{color:ee.node.showing?"gray":"black"}}),null,16,["icon","style"])):Vi("",!0)]),default:U(()=>[tt("span",null,nt(ee.$t("objectTree.toggleDisplay")),1)],void 0,!0),_:1})],void 0,!0),_:1}),w(Si,null,{default:U(()=>[w(dr,{location:"end"},{activator:U(({props:Y})=>[B.value?(Te(),qe(lt,ht({key:0,id:"_toggle_label_display"},Y,{onClick:F,size:"small",icon:H()?"$showNodeLabel":"$hideNodeLabel",style:{color:H()?"inherit":"gray"},key:u.value}),null,16,["icon","style"])):Vi("",!0)]),default:U(()=>[tt("span",null,nt(ee.$t("objectTree.toggleLabelDisplay")),1)],void 0,!0),_:1})],void 0,!0),_:1}),w(Si,null,{default:U(()=>[w(dr,{location:"end"},{activator:U(({props:Y})=>[tt("div",ht({id:"_delete_node"},Y,{onClick:Z}),[w(lt,{size:"small",icon:"$deleteNode"})],16)]),default:U(()=>[tt("span",null,nt(ee.$t("objectTree.deleteNode")),1)],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1})]))}});const Sce=Tn(yce,[["__scopeId","data-v-8f07a44f"]]),bce={id:"header",class:"accent"},_ce={key:0,class:"text-subtitle-1"},Pce={key:1,class:"text-subtitle-1"},Ece=ri({__name:"SENoduleList",props:{children:{},i18LabelKey:{}},setup(t){const e=t,i=An(),{actionMode:n}=Ji(i),r=ge(!1);to(()=>{$.listen("expand-measurement-sheet",a),$.listen("expand-transformation-sheet",l)});const s=W(()=>(console.debug(" length",o.value.length),o.value.forEach(h=>console.debug(h.name)),o.value.length>0)),o=W(()=>e.children.filter(h=>h instanceof Le||h instanceof ut?h.isUserCreated&&h.exists:h.exists).sort((h,d)=>{let f=h.name,m=d.name;return h.isLabelable()&&d.isLabelable()&&(f=h.label.ref.shortUserName,m=d.label.ref.shortUserName),f.length<m.length?-1:f.length>m.length?1:f<m?-1:1}));function a(){if(e.i18LabelKey==="objects.measurements"){if(s)switch(r.value=!0,n.value){case"measuredCircle":$.fire("show-alert",{key:"objectTree.selectAMeasurementForMeasuredCircle",type:"info"});break;case"translation":$.fire("show-alert",{key:"objectTree.selectAMeasurementForTranslation",type:"info"});break;case"rotation":$.fire("show-alert",{key:"objectTree.selectAMeasurementForRotation",type:"info"});break}}else r.value=!1}function l(){if(e.i18LabelKey==="objects.transformations"){if(s)switch(r.value=!0,n.value){case"applyTransformation":$.fire("show-alert",{key:"objectTree.selectATransformation",type:"info"});break}}else r.value=!1}function c(h){const d=e.children.findIndex(f=>f.id===h.id);d>=0&&$.fire("measurement-selected",e.children[d].name)}function u(h){return h instanceof JM}return an(()=>{$.unlisten("expand-measurement-sheet"),$.unlisten("expand-transformation-sheet")}),(h,d)=>(Te(),Ct("div",null,[tt("div",bce,[h.children.length===1?(Te(),Ct("span",_ce,nt(h.$t(h.i18LabelKey,1)),1)):(Te(),Ct("span",Pce,nt(h.$t(h.i18LabelKey,0)),1)),fi(w(Qt,{size:"small",onClick:d[0]||(d[0]=f=>r.value=!r.value)},{default:U(()=>[r.value?(Te(),qe(lt,{key:1},{default:U(()=>[$e("mdi-chevron-down")],void 0,!0),_:1})):(Te(),qe(lt,{key:0},{default:U(()=>[$e("mdi-chevron-right")],void 0,!0),_:1}))],void 0),_:1},512),[[ln,s.value]])]),w(xo,{name:"slide-right"},{default:U(()=>[fi(tt("div",null,[(Te(!0),Ct(mt,null,Zs(o.value,f=>(Te(),Ct(mt,{key:f.id},[u(f)?Vi("",!0):(Te(),qe(Sce,{key:0,node:f,onObjectSelect:c},null,8,["node"]))],64))),128))],512),[[ln,r.value]])],void 0),_:1})]))}});const Uh=Tn(Ece,[["__scopeId","data-v-3e1a4036"]]);class Xy extends L{constructor(i,n){super();y(this,"seExpression");y(this,"parents",[]);this.seExpression=i,n!==void 0&&this.parents.push(...n)}do(){this.parents.forEach(i=>i.registerChild(this.seExpression)),L.store.addExpression(this.seExpression)}saveState(){this.lastState=this.seExpression.id}restoreState(){L.store.removeExpression(this.lastState),this.parents.forEach(i=>i.unregisterChild(this.seExpression))}}class NP extends Xy{constructor(i,n,r){super(i,r);y(this,"arithmeticExpression");this.arithmeticExpression=n}toOpcode(){return["AddCalculation","objectName="+L.symbolToASCIIDec(this.seExpression.name),"objectExists="+this.seExpression.exists,"objectShowing="+this.seExpression.showing,"calculationExpressionString="+L.symbolToASCIIDec(this.arithmeticExpression),"calculationParentsNames="+this.parents.map(i=>L.symbolToASCIIDec(i.name)).join("@"),"valueDisplayMode="+this.seExpression.valueDisplayMode].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((u,h)=>{if(h===0)return;const d=u.split("=");s.set(d[0],L.asciiDecToSymbol(d[1]))});const o=s.get("calculationParentsNames"),a=[],l=Number(s.get("valueDisplayMode"));o&&o.split("@").forEach(u=>a.push(n.get(u)));const c=s.get("calculationExpressionString");if(a.every(u=>u!==void 0)&&c&&typeof l=="number"){const u=new qM(c);if(u.valueDisplayMode=l,s.get("objectName")!==void 0)u.name=s.get("objectName")??"",u.showing=s.get("objectShowing")==="true",u.exists=s.get("objectExists")==="true",n.set(u.name,u);else throw new Error("AddCalculationCommand:  calculation name doesn't exist");return new NP(u,c,a.map(h=>h))}throw new Error(`AddCalculationCommand: ${c} is undefined`)}}const wce=We({active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...Ut(),...af({transition:{component:gB}})},"VCounter"),T5=vt()({name:"VCounter",functional:!0,props:wce(),setup(t,e){let{slots:i}=e;const n=W(()=>t.max?`${t.value} / ${t.max}`:String(t.value));return Tt(()=>w(Gl,{transition:t.transition},{default:()=>[fi(w("div",{class:["v-counter",t.class],style:t.style},[i.default?i.default({counter:n.value,max:t.max,value:t.value}):n.value]),[[ln,t.active]])]})),{}}});const Tce=We({text:String,onClick:pl(),...Ut(),...wn()},"VLabel"),RP=vt()({name:"VLabel",props:Tce(),setup(t,e){let{slots:i}=e;return Tt(()=>{var n;return w("label",{class:["v-label",{"v-label--clickable":!!t.onClick},t.class],style:t.style,onClick:t.onClick},[t.text,(n=i.default)==null?void 0:n.call(i)])}),{}}}),xce=We({floating:Boolean,...Ut()},"VFieldLabel"),Tb=vt()({name:"VFieldLabel",props:xce(),setup(t,e){let{slots:i}=e;return Tt(()=>w(RP,{class:["v-field-label",{"v-field-label--floating":t.floating},t.class],style:t.style,"aria-hidden":t.floating||void 0},i)),{}}});function x5(t){const{t:e}=nf();function i(n){let{name:r}=n;const s={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[r],o=t[`onClick:${r}`],a=o&&s?e(`$vuetify.input.${s}`,t.label??""):void 0;return w(lt,{icon:t[`${r}Icon`],"aria-label":a,onClick:o},null)}return{InputIcon:i}}const FP=We({focused:Boolean,"onUpdate:focused":pl()},"focus");function uf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sc();const i=Oi(t,"focused"),n=W(()=>({[`${e}--focused`]:i.value}));function r(){i.value=!0}function s(){i.value=!1}return{focusClasses:n,isFocused:i,focus:r,blur:s}}const kce=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],eA=We({appendInnerIcon:ji,bgColor:String,clearable:Boolean,clearIcon:{type:ji,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,dirty:Boolean,disabled:{type:Boolean,default:null},error:Boolean,flat:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:ji,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:t=>kce.includes(t)},"onClick:clear":pl(),"onClick:appendInner":pl(),"onClick:prependInner":pl(),...Ut(),...hM(),...cs(),...wn()},"VField"),tA=vt()({name:"VField",inheritAttrs:!1,props:{id:String,...FP(),...eA()},emits:{"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,e){let{attrs:i,emit:n,slots:r}=e;const{themeClasses:s}=Hn(t),{loaderClasses:o}=fP(t),{focusClasses:a,isFocused:l,focus:c,blur:u}=uf(t),{InputIcon:h}=x5(t),{roundedClasses:d}=hs(t),{rtlClasses:f}=io(),m=W(()=>t.dirty||t.active),g=W(()=>!t.singleLine&&!!(t.label||r.label)),v=Ao(),p=W(()=>t.id||`input-${v}`),b=W(()=>`${p.value}-messages`),_=ge(),P=ge(),E=ge(),T=W(()=>["plain","underlined"].includes(t.variant)),{backgroundColorClasses:C,backgroundColorStyles:M}=Cs(bt(t,"bgColor")),{textColorClasses:x,textColorStyles:V}=ko(W(()=>t.error||t.disabled?void 0:m.value&&l.value?t.color:t.baseColor));He(m,O=>{if(g.value){const F=_.value.$el,X=P.value.$el;requestAnimationFrame(()=>{const Z=rM(F),K=X.getBoundingClientRect(),z=K.x-Z.x,H=K.y-Z.y-(Z.height/2-K.height/2),re=K.width/.75,ne=Math.abs(re-Z.width)>1?{maxWidth:Lt(re)}:void 0,B=getComputedStyle(F),Q=getComputedStyle(X),fe=parseFloat(B.transitionDuration)*1e3||150,ie=parseFloat(Q.getPropertyValue("--v-field-label-scale")),se=Q.getPropertyValue("color");F.style.visibility="visible",X.style.visibility="hidden",pd(F,{transform:`translate(${z}px, ${H}px) scale(${ie})`,color:se,...ne},{duration:fe,easing:xv,direction:O?"normal":"reverse"}).finished.then(()=>{F.style.removeProperty("visibility"),X.style.removeProperty("visibility")})})}},{flush:"post"});const N=W(()=>({isActive:m,isFocused:l,controlRef:E,blur:u,focus:c}));function D(O){O.target!==document.activeElement&&O.preventDefault()}return Tt(()=>{var z,H,re;const O=t.variant==="outlined",F=r["prepend-inner"]||t.prependInnerIcon,X=!!(t.clearable||r.clear),Z=!!(r["append-inner"]||t.appendInnerIcon||X),K=()=>r.label?r.label({...N.value,label:t.label,props:{for:p.value}}):t.label;return w("div",ht({class:["v-field",{"v-field--active":m.value,"v-field--appended":Z,"v-field--center-affix":t.centerAffix??!T.value,"v-field--disabled":t.disabled,"v-field--dirty":t.dirty,"v-field--error":t.error,"v-field--flat":t.flat,"v-field--has-background":!!t.bgColor,"v-field--persistent-clear":t.persistentClear,"v-field--prepended":F,"v-field--reverse":t.reverse,"v-field--single-line":t.singleLine,"v-field--no-label":!K(),[`v-field--variant-${t.variant}`]:!0},s.value,C.value,a.value,o.value,d.value,f.value,t.class],style:[M.value,t.style],onClick:D},i),[w("div",{class:"v-field__overlay"},null),w(uM,{name:"v-field",active:!!t.loading,color:t.error?"error":typeof t.loading=="string"?t.loading:t.color},{default:r.loader}),F&&w("div",{key:"prepend",class:"v-field__prepend-inner"},[t.prependInnerIcon&&w(h,{key:"prepend-icon",name:"prependInner"},null),(z=r["prepend-inner"])==null?void 0:z.call(r,N.value)]),w("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(t.variant)&&g.value&&w(Tb,{key:"floating-label",ref:P,class:[x.value],floating:!0,for:p.value,style:V.value},{default:()=>[K()]}),w(Tb,{ref:_,for:p.value},{default:()=>[K()]}),(H=r.default)==null?void 0:H.call(r,{...N.value,props:{id:p.value,class:"v-field__input","aria-describedby":b.value},focus:c,blur:u})]),X&&w(yB,{key:"clear"},{default:()=>[fi(w("div",{class:"v-field__clearable",onMousedown:ne=>{ne.preventDefault(),ne.stopPropagation()}},[r.clear?r.clear():w(h,{name:"clear"},null)]),[[ln,t.dirty]])]}),Z&&w("div",{key:"append",class:"v-field__append-inner"},[(re=r["append-inner"])==null?void 0:re.call(r,N.value),t.appendInnerIcon&&w(h,{key:"append-icon",name:"appendInner"},null)]),w("div",{class:["v-field__outline",x.value],style:V.value},[O&&w(mt,null,[w("div",{class:"v-field__outline__start"},null),g.value&&w("div",{class:"v-field__outline__notch"},[w(Tb,{ref:P,floating:!0,for:p.value},{default:()=>[K()]})]),w("div",{class:"v-field__outline__end"},null)]),T.value&&g.value&&w(Tb,{ref:P,floating:!0,for:p.value},{default:()=>[K()]})])])}),{controlRef:E}}});function k5(t){const e=Object.keys(tA.props).filter(i=>!tM(i)&&i!=="class"&&i!=="style");return _U(t,e)}const Cce=We({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...Ut(),...af({transition:{component:gB,leaveAbsolute:!0,group:!0}})},"VMessages"),Mce=vt()({name:"VMessages",props:Cce(),setup(t,e){let{slots:i}=e;const n=W(()=>Aa(t.messages)),{textColorClasses:r,textColorStyles:s}=ko(W(()=>t.color));return Tt(()=>w(Gl,{transition:t.transition,tag:"div",class:["v-messages",r.value,t.class],style:[s.value,t.style],role:"alert","aria-live":"polite"},{default:()=>[t.active&&n.value.map((o,a)=>w("div",{class:"v-messages__message",key:`${a}-${n.value}`},[i.message?i.message({message:o}):o]))]})),{}}}),C5=Symbol.for("vuetify:form"),Ace=We({disabled:Boolean,fastFail:Boolean,readonly:Boolean,modelValue:{type:Boolean,default:null},validateOn:{type:String,default:"input"}},"form");function Vce(t){const e=Oi(t,"modelValue"),i=W(()=>t.disabled),n=W(()=>t.readonly),r=_t(!1),s=ge([]),o=ge([]);async function a(){const u=[];let h=!0;o.value=[],r.value=!0;for(const d of s.value){const f=await d.validate();if(f.length>0&&(h=!1,u.push({id:d.id,errorMessages:f})),!h&&t.fastFail)break}return o.value=u,r.value=!1,{valid:h,errors:o.value}}function l(){s.value.forEach(u=>u.reset())}function c(){s.value.forEach(u=>u.resetValidation())}return He(s,()=>{let u=0,h=0;const d=[];for(const f of s.value)f.isValid===!1?(h++,d.push({id:f.id,errorMessages:f.errorMessages})):f.isValid===!0&&u++;o.value=d,e.value=h>0?!1:u===s.value.length?!0:null},{deep:!0}),jn(C5,{register:u=>{let{id:h,validate:d,reset:f,resetValidation:m}=u;s.value.some(g=>g.id===h),s.value.push({id:h,validate:d,reset:f,resetValidation:m,isValid:null,errorMessages:[]})},unregister:u=>{s.value=s.value.filter(h=>h.id!==u)},update:(u,h,d)=>{const f=s.value.find(m=>m.id===u);f&&(f.isValid=h,f.errorMessages=d)},isDisabled:i,isReadonly:n,isValidating:r,isValid:e,items:s,validateOn:bt(t,"validateOn")}),{errors:o,isDisabled:i,isReadonly:n,isValidating:r,isValid:e,items:s,validate:a,reset:l,resetValidation:c}}function iA(){return xi(C5,null)}const Lce=We({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...FP()},"validation");function Ice(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sc(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ao();const n=Oi(t,"modelValue"),r=W(()=>t.validationValue===void 0?n.value:t.validationValue),s=iA(),o=ge([]),a=_t(!0),l=W(()=>!!(Aa(n.value===""?null:n.value).length||Aa(r.value===""?null:r.value).length)),c=W(()=>!!(t.disabled??(s==null?void 0:s.isDisabled.value))),u=W(()=>!!(t.readonly??(s==null?void 0:s.isReadonly.value))),h=W(()=>{var P;return(P=t.errorMessages)!=null&&P.length?Aa(t.errorMessages).concat(o.value).slice(0,Math.max(0,+t.maxErrors)):o.value}),d=W(()=>{let P=(t.validateOn??(s==null?void 0:s.validateOn.value))||"input";P==="lazy"&&(P="input lazy");const E=new Set((P==null?void 0:P.split(" "))??[]);return{blur:E.has("blur")||E.has("input"),input:E.has("input"),submit:E.has("submit"),lazy:E.has("lazy")}}),f=W(()=>{var P;return t.error||(P=t.errorMessages)!=null&&P.length?!1:t.rules.length?a.value?o.value.length||d.value.lazy?null:!0:!o.value.length:!0}),m=_t(!1),g=W(()=>({[`${e}--error`]:f.value===!1,[`${e}--dirty`]:l.value,[`${e}--disabled`]:c.value,[`${e}--readonly`]:u.value})),v=W(()=>t.name??le(i));to(()=>{s==null||s.register({id:v.value,validate:_,reset:p,resetValidation:b})}),an(()=>{s==null||s.unregister(v.value)}),ki(async()=>{d.value.lazy||await _(!0),s==null||s.update(v.value,f.value,h.value)}),ec(()=>d.value.input,()=>{He(r,()=>{if(r.value!=null)_();else if(t.focused){const P=He(()=>t.focused,E=>{E||_(),P()})}})}),ec(()=>d.value.blur,()=>{He(()=>t.focused,P=>{P||_()})}),He([f,h],()=>{s==null||s.update(v.value,f.value,h.value)});function p(){n.value=null,vn(b)}function b(){a.value=!0,d.value.lazy?o.value=[]:_(!0)}async function _(){let P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const E=[];m.value=!0;for(const T of t.rules){if(E.length>=+(t.maxErrors??1))break;const M=await(typeof T=="function"?T:()=>T)(r.value);if(M!==!0){if(M!==!1&&typeof M!="string"){console.warn(`${M} is not a valid value. Rule functions must return boolean true or a string.`);continue}E.push(M||"")}}return o.value=E,m.value=!1,a.value=P,o.value}return{errorMessages:h,isDirty:l,isDisabled:c,isReadonly:u,isPristine:a,isValid:f,isValidating:m,reset:p,resetValidation:b,validate:_,validationClasses:g}}const df=We({id:String,appendIcon:ji,centerAffix:{type:Boolean,default:!0},prependIcon:ji,hideDetails:[Boolean,String],hideSpinButtons:Boolean,hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:t=>["horizontal","vertical"].includes(t)},"onClick:prepend":pl(),"onClick:append":pl(),...Ut(),...Ba(),...Lce()},"VInput"),za=vt()({name:"VInput",props:{...df()},emits:{"update:modelValue":t=>!0},setup(t,e){let{attrs:i,slots:n,emit:r}=e;const{densityClasses:s}=wl(t),{rtlClasses:o}=io(),{InputIcon:a}=x5(t),l=Ao(),c=W(()=>t.id||`input-${l}`),u=W(()=>`${c.value}-messages`),{errorMessages:h,isDirty:d,isDisabled:f,isReadonly:m,isPristine:g,isValid:v,isValidating:p,reset:b,resetValidation:_,validate:P,validationClasses:E}=Ice(t,"v-input",c),T=W(()=>({id:c,messagesId:u,isDirty:d,isDisabled:f,isReadonly:m,isPristine:g,isValid:v,isValidating:p,reset:b,resetValidation:_,validate:P})),C=W(()=>{var M;return(M=t.errorMessages)!=null&&M.length||!g.value&&h.value.length?h.value:t.hint&&(t.persistentHint||t.focused)?t.hint:t.messages});return Tt(()=>{var D,O,F,X;const M=!!(n.prepend||t.prependIcon),x=!!(n.append||t.appendIcon),V=C.value.length>0,N=!t.hideDetails||t.hideDetails==="auto"&&(V||!!n.details);return w("div",{class:["v-input",`v-input--${t.direction}`,{"v-input--center-affix":t.centerAffix,"v-input--hide-spin-buttons":t.hideSpinButtons},s.value,o.value,E.value,t.class],style:t.style},[M&&w("div",{key:"prepend",class:"v-input__prepend"},[(D=n.prepend)==null?void 0:D.call(n,T.value),t.prependIcon&&w(a,{key:"prepend-icon",name:"prepend"},null)]),n.default&&w("div",{class:"v-input__control"},[(O=n.default)==null?void 0:O.call(n,T.value)]),x&&w("div",{key:"append",class:"v-input__append"},[t.appendIcon&&w(a,{key:"append-icon",name:"append"},null),(F=n.append)==null?void 0:F.call(n,T.value)]),N&&w("div",{class:"v-input__details"},[w(Mce,{id:u.value,active:V,messages:C.value},{message:n.message}),(X=n.details)==null?void 0:X.call(n,T.value)])])}),{reset:b,resetValidation:_,validate:P,isValid:v,errorMessages:h}}}),Oce=["color","file","time","date","datetime-local","week","month"],nA=We({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:[Number,Function],prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,role:String,type:{type:String,default:"text"},modelModifiers:Object,...df(),...eA()},"VTextField"),vr=vt()({name:"VTextField",directives:{Intersect:dM},inheritAttrs:!1,props:nA(),emits:{"click:control":t=>!0,"mousedown:control":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,e){let{attrs:i,emit:n,slots:r}=e;const s=Oi(t,"modelValue"),{isFocused:o,focus:a,blur:l}=uf(t),c=W(()=>typeof t.counterValue=="function"?t.counterValue(s.value):typeof t.counterValue=="number"?t.counterValue:(s.value??"").toString().length),u=W(()=>{if(i.maxlength)return i.maxlength;if(!(!t.counter||typeof t.counter!="number"&&typeof t.counter!="string"))return t.counter}),h=W(()=>["plain","underlined"].includes(t.variant));function d(T,C){var M,x;!t.autofocus||!T||(x=(M=C[0].target)==null?void 0:M.focus)==null||x.call(M)}const f=ge(),m=ge(),g=ge(),v=W(()=>Oce.includes(t.type)||t.persistentPlaceholder||o.value||t.active);function p(){var T;g.value!==document.activeElement&&((T=g.value)==null||T.focus()),o.value||a()}function b(T){n("mousedown:control",T),T.target!==g.value&&(p(),T.preventDefault())}function _(T){p(),n("click:control",T)}function P(T){T.stopPropagation(),p(),vn(()=>{s.value=null,TU(t["onClick:clear"],T)})}function E(T){var M;const C=T.target;if(s.value=C.value,(M=t.modelModifiers)!=null&&M.trim&&["text","search","password","tel","url"].includes(t.type)){const x=[C.selectionStart,C.selectionEnd];vn(()=>{C.selectionStart=x[0],C.selectionEnd=x[1]})}}return Tt(()=>{const T=!!(r.counter||t.counter!==!1&&t.counter!=null),C=!!(T||r.details),[M,x]=Cy(i),{modelValue:V,...N}=za.filterProps(t),D=k5(t);return w(za,ht({ref:f,modelValue:s.value,"onUpdate:modelValue":O=>s.value=O,class:["v-text-field",{"v-text-field--prefixed":t.prefix,"v-text-field--suffixed":t.suffix,"v-input--plain-underlined":h.value},t.class],style:t.style},M,N,{centerAffix:!h.value,focused:o.value}),{...r,default:O=>{let{id:F,isDisabled:X,isDirty:Z,isReadonly:K,isValid:z}=O;return w(tA,ht({ref:m,onMousedown:b,onClick:_,"onClick:clear":P,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"],role:t.role},D,{id:F.value,active:v.value||Z.value,dirty:Z.value||t.dirty,disabled:X.value,focused:o.value,error:z.value===!1}),{...r,default:H=>{let{props:{class:re,...ne}}=H;const B=fi(w("input",ht({ref:g,value:s.value,onInput:E,autofocus:t.autofocus,readonly:K.value,disabled:X.value,name:t.name,placeholder:t.placeholder,size:1,type:t.type,onFocus:p,onBlur:l},ne,x),null),[[Mo("intersect"),{handler:d},null,{once:!0}]]);return w(mt,null,[t.prefix&&w("span",{class:"v-text-field__prefix"},[w("span",{class:"v-text-field__prefix__text"},[t.prefix])]),r.default?w("div",{class:re,"data-no-activator":""},[r.default(),B]):sh(B,{class:re}),t.suffix&&w("span",{class:"v-text-field__suffix"},[w("span",{class:"v-text-field__suffix__text"},[t.suffix])])])}})},details:C?O=>{var F;return w(mt,null,[(F=r.details)==null?void 0:F.call(r,O),T&&w(mt,null,[w("span",null,null),w(T5,{active:t.persistentCounter||o.value,value:c.value,max:u.value},r.counter)])])}:void 0})}),_c({},f,m,g)}});const Dce=We({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:t=>!isNaN(parseFloat(t))},maxRows:{type:[Number,String],validator:t=>!isNaN(parseFloat(t))},suffix:String,modelModifiers:Object,...df(),...eA()},"VTextarea"),M5=vt()({name:"VTextarea",directives:{Intersect:dM},inheritAttrs:!1,props:Dce(),emits:{"click:control":t=>!0,"mousedown:control":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,e){let{attrs:i,emit:n,slots:r}=e;const s=Oi(t,"modelValue"),{isFocused:o,focus:a,blur:l}=uf(t),c=W(()=>typeof t.counterValue=="function"?t.counterValue(s.value):(s.value||"").toString().length),u=W(()=>{if(i.maxlength)return i.maxlength;if(!(!t.counter||typeof t.counter!="number"&&typeof t.counter!="string"))return t.counter});function h(N,D){var O,F;!t.autofocus||!N||(F=(O=D[0].target)==null?void 0:O.focus)==null||F.call(O)}const d=ge(),f=ge(),m=_t(""),g=ge(),v=W(()=>t.persistentPlaceholder||o.value||t.active);function p(){var N;g.value!==document.activeElement&&((N=g.value)==null||N.focus()),o.value||a()}function b(N){p(),n("click:control",N)}function _(N){n("mousedown:control",N)}function P(N){N.stopPropagation(),p(),vn(()=>{s.value="",TU(t["onClick:clear"],N)})}function E(N){var O;const D=N.target;if(s.value=D.value,(O=t.modelModifiers)!=null&&O.trim){const F=[D.selectionStart,D.selectionEnd];vn(()=>{D.selectionStart=F[0],D.selectionEnd=F[1]})}}const T=ge(),C=ge(+t.rows),M=W(()=>["plain","underlined"].includes(t.variant));Oa(()=>{t.autoGrow||(C.value=+t.rows)});function x(){t.autoGrow&&vn(()=>{if(!T.value||!f.value)return;const N=getComputedStyle(T.value),D=getComputedStyle(f.value.$el),O=parseFloat(N.getPropertyValue("--v-field-padding-top"))+parseFloat(N.getPropertyValue("--v-input-padding-top"))+parseFloat(N.getPropertyValue("--v-field-padding-bottom")),F=T.value.scrollHeight,X=parseFloat(N.lineHeight),Z=Math.max(parseFloat(t.rows)*X+O,parseFloat(D.getPropertyValue("--v-input-control-height"))),K=parseFloat(t.maxRows)*X+O||1/0,z=So(F??0,Z,K);C.value=Math.floor((z-O)/X),m.value=Lt(z)})}ki(x),He(s,x),He(()=>t.rows,x),He(()=>t.maxRows,x),He(()=>t.density,x);let V;return He(T,N=>{N?(V=new ResizeObserver(x),V.observe(T.value)):V==null||V.disconnect()}),an(()=>{V==null||V.disconnect()}),Tt(()=>{const N=!!(r.counter||t.counter||t.counterValue),D=!!(N||r.details),[O,F]=Cy(i),{modelValue:X,...Z}=za.filterProps(t),K=k5(t);return w(za,ht({ref:d,modelValue:s.value,"onUpdate:modelValue":z=>s.value=z,class:["v-textarea v-text-field",{"v-textarea--prefixed":t.prefix,"v-textarea--suffixed":t.suffix,"v-text-field--prefixed":t.prefix,"v-text-field--suffixed":t.suffix,"v-textarea--auto-grow":t.autoGrow,"v-textarea--no-resize":t.noResize||t.autoGrow,"v-input--plain-underlined":M.value},t.class],style:t.style},O,Z,{centerAffix:C.value===1&&!M.value,focused:o.value}),{...r,default:z=>{let{id:H,isDisabled:re,isDirty:ne,isReadonly:B,isValid:Q}=z;return w(tA,ht({ref:f,style:{"--v-textarea-control-height":m.value},onClick:b,onMousedown:_,"onClick:clear":P,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"]},K,{id:H.value,active:v.value||ne.value,centerAffix:C.value===1&&!M.value,dirty:ne.value||t.dirty,disabled:re.value,focused:o.value,error:Q.value===!1}),{...r,default:fe=>{let{props:{class:ie,...se}}=fe;return w(mt,null,[t.prefix&&w("span",{class:"v-text-field__prefix"},[t.prefix]),fi(w("textarea",ht({ref:g,class:ie,value:s.value,onInput:E,autofocus:t.autofocus,readonly:B.value,disabled:re.value,placeholder:t.placeholder,rows:t.rows,name:t.name,onFocus:p,onBlur:l},se,F),null),[[Mo("intersect"),{handler:h},null,{once:!0}]]),t.autoGrow&&fi(w("textarea",{class:[ie,"v-textarea__sizer"],id:`${se.id}-sizer`,"onUpdate:modelValue":ee=>s.value=ee,ref:T,readonly:!0,"aria-hidden":"true"},null),[[O9,s.value]]),t.suffix&&w("span",{class:"v-text-field__suffix"},[t.suffix])])}})},details:D?z=>{var H;return w(mt,null,[(H=r.details)==null?void 0:H.call(r,z),N&&w(mt,null,[w("span",null,null),w(T5,{active:t.persistentCounter||o.value,value:c.value,max:u.value},r.counter)])])}:void 0})}),_c({},d,f,g)}}),Nce=ri({__name:"ExpressionForm",setup(t){const e=An(),{expressions:i}=Ji(e);let n=new wt;const r=ge(""),s=ge(0),o=ge("");let a=null;const l=new Map;ki(()=>{$.listen("measurement-selected",u)});function c(){r.value="",s.value=0}function u(f){r.value+=f,h()}function h(){o.value="",a&&clearTimeout(a),a=setTimeout(()=>{try{i.value.forEach(f=>{const m=f.name;l.set(m,f.value)}),s.value=r.value.length>0?n.evaluateWithVars(r.value,l):0}catch(f){o.value=f.message}},1e3)}function d(){const f=new qM(r.value);new NP(f,r.value,f.calculationParents).execute(),f.markKidsOutOfDate(),f.update(),c(),l.clear(),i.value.forEach(m=>{const g=m.name;l.set(g,m.value)})}return(f,m)=>(Te(),Ct("div",null,[w(uc,{raised:"",variant:"outlined"},{default:U(()=>[w(lh,null,{default:U(()=>[w(Ph,null,{default:U(()=>[w(pr,null,{default:U(()=>[w(Si,{cols:"12"},{default:U(()=>[w(M5,{id:"_test_input_expr","auto-grow":"",density:"compact","full-width":"",variant:"outlined",clearable:"",rows:"3",label:f.$t("objectTree.calculationExpression"),placeholder:"cos(pi/2)*M1",class:"ma-0",modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=g=>r.value=g),"error-messages":o.value,onKeydown:h,"onClick:clear":c},null,8,["label","modelValue","error-messages"])],void 0,!0),_:1})],void 0,!0),_:1}),w(vr,{id:"_test_output_result",density:"compact",variant:"outlined",readonly:"",label:f.$t("objectTree.result"),placeholder:"0",modelValue:s.value,"onUpdate:modelValue":m[1]||(m[1]=g=>s.value=g)},null,8,["label","modelValue"])],void 0,!0),_:1})],void 0,!0),_:1}),w(Op,null,{default:U(()=>[w(Ry),w(Qt,{id:"_test_add_expr",size:"small",fab:"",right:"",color:"accent",disabled:r.value.length===0||o.value.length>0,onClick:d},{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-plus")],void 0,!0),_:1})],void 0,!0),_:1},8,["disabled"])],void 0,!0),_:1})],void 0),_:1})]))}}),Rce=ri({__name:"ParametricCoordinate",props:{i18nToolTip:{},i18nKey:{},placeholder:{},name:{}},setup(t){const e=An(),{expressions:i}=Ji(e);let n=new wt;const r=ge("");let s=0,o=0;const a=ge("");let l=null;const c=new Map;ki(()=>{$.listen("measurement-selected",d.bind(this)),$.listen("test-t-value",u),$.listen("parametric-clear-data",h)});function u(m){o=m.val}function h(){r.value="",a.value=""}function d(m){console.debug("Variable selected",m,"Todo:  only add this variable to the text area/ field that is in focus.")}function f(){a.value="",l&&clearTimeout(l),l=setTimeout(()=>{try{i.value.forEach(m=>{const g=m.name;c.set(g,m.value)}),c.set("t",o),s=r.value.length>0?n.evaluateWithVars(r.value,c):0,$.fire("parametric-data-update",{name:r.value})}catch(m){a.value=m.message,$.fire("parametric-data-update",{name:""})}},1e3)}return(m,g)=>(Te(),Ct("div",null,[w(uc,{raised:"",variant:"outlined"},{default:U(()=>[w(lh,null,{default:U(()=>[w(Ph,null,{default:U(()=>[w(pr,null,{default:U(()=>[w(Si,{cols:"12"},{default:U(()=>[w(dr,{bottom:"","max-width":"400px"},{activator:U(({props:v})=>[w(M5,ht({label:m.$t(m.i18nKey)},v,{"auto-growdensity":"compact",variant:"outlined",clearable:"",rows:"2",placeholder:m.placeholder,class:"ma-0",modelValue:r.value,"onUpdate:modelValue":g[0]||(g[0]=p=>r.value=p),"error-messages":a.value,onKeydown:f,"onClick:clear":h}),null,16,["label","placeholder","modelValue","error-messages"])]),default:U(()=>[$e(" "+nt(m.$t(m.i18nToolTip)),1)],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1})]))}}),Fce={id:"header",class:"accent"},zce={class:"text-subtitle-1"},Uce=ri({__name:"ParametricCoordinates",props:{coordinateData:{},i18LabelKey:{}},setup(t){const e=ge(!1);return(i,n)=>(Te(),Ct("div",null,[tt("div",Fce,[tt("span",zce,nt(i.$t(i.i18LabelKey)),1),w(Qt,{size:"small",onClick:n[0]||(n[0]=r=>e.value=!e.value)},{default:U(()=>[e.value?(Te(),qe(lt,{key:1},{default:U(()=>[$e("mdi-chevron-down")],void 0,!0),_:1})):(Te(),qe(lt,{key:0},{default:U(()=>[$e("mdi-chevron-right")],void 0,!0),_:1}))],void 0),_:1})]),w(xo,{name:"slide-right"},{default:U(()=>[fi(tt("div",null,[(Te(!0),Ct(mt,null,Zs(i.coordinateData,(r,s)=>(Te(),qe(Rce,{key:s,placeholder:r.placeholder,i18nKey:r.i18n_key,i18nToolTip:r.i18nToolTip,name:r.name},null,8,["placeholder","i18nKey","i18nToolTip","name"]))),128))],512),[[ln,e.value]])],void 0),_:1})]))}});const Bce=Tn(Uce,[["__scopeId","data-v-0db1a694"]]),jce=ri({__name:"ParametricTExpression",props:{i18nToolTip:{},i18nLabelKey:{},placeholder:{},name:{}},setup(t){const e=An(),{expressions:i}=Ji(e),{t:n}=qn(),r=t;let s=new wt;const o=ge("");let a=0;const l=ge(""),c=ge("");let u=null;const h=new Map;ki(()=>{$.listen("measurement-selected",f),$.listen("parametric-clear-data",d)});function d(){o.value="",l.value="",c.value=""}function f(g){console.debug("Variable selected",g,"Todo:  only add this varaible to the text area/ field that is in focus."),m()}function m(){c.value="",u&&clearTimeout(u),u=setTimeout(()=>{try{i.value.forEach(g=>{const v=g.name;h.set(v,g.value)}),a=o.value.length>0?s.evaluateWithVars(o.value,h):0,l.value=n("objectTree.currentTValue")+a.toFixed(S.decimalPrecision),$.fire("parametric-data-update",{[r.name]:o.value})}catch(g){console.debug("Got an error",g),c.value=g.message,$.fire("parametric-data-update",{[r.name]:""}),$.fire("test-t-value",{val:0})}},1e3)}return(g,v)=>(Te(),Ct("div",null,[w(uc,{raised:"",variant:"outlined"},{default:U(()=>[w(lh,null,{default:U(()=>[w(Ph,null,{default:U(()=>[w(pr,null,{default:U(()=>[w(Si,{cols:"12"},{default:U(()=>[w(dr,{bottom:"","max-width":"400px"},{activator:U(({props:p})=>[w(vr,ht({modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=b=>o.value=b)},p,{density:"compact",label:g.$t(g.i18nLabelKey),placeholder:g.placeholder,"error-messages":c.value,onKeydown:m,variant:"outlined",clearable:"",hint:l.value,"persistent-hint":""}),null,16,["modelValue","label","placeholder","error-messages","hint"])]),default:U(()=>[$e(" "+nt(g.$t(g.i18nToolTip)),1)],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1})]))}}),$ce={id:"header",class:"accent"},Wce={class:"text-subtitle-1"},Gce=ri({__name:"ParametricTracingExpressions",props:{tExpressionData:{},i18LabelKey:{}},setup(t){const e=ge(!1);return(i,n)=>(Te(),Ct("div",null,[tt("div",$ce,[tt("span",Wce,nt(i.$t(i.i18LabelKey)),1),w(Qt,{size:"small",onClick:n[0]||(n[0]=r=>e.value=!e.value)},{default:U(()=>[e.value?(Te(),qe(lt,{key:1},{default:U(()=>[$e("mdi-chevron-down")],void 0,!0),_:1})):(Te(),qe(lt,{key:0},{default:U(()=>[$e("mdi-chevron-right")],void 0,!0),_:1}))],void 0),_:1})]),w(xo,{name:"slide-right"},{default:U(()=>[fi(tt("div",null,[(Te(!0),Ct(mt,null,Zs(i.tExpressionData,(r,s)=>(Te(),qe(jce,{key:s+2,placeholder:r.placeholder,i18nLabelKey:r.i18nLabelkey,i18nToolTip:r.i18nToolTip,name:r.name},null,8,["placeholder","i18nLabelKey","i18nToolTip","name"]))),128))],512),[[ln,e.value]])],void 0),_:1})]))}});const Hce=Tn(Gce,[["__scopeId","data-v-1d30a6fb"]]),qce=ri({__name:"ParametricTNumber",props:{i18nToolTip:{},i18nLabelKey:{},placeholder:{},name:{}},setup(t){const e=t;let i=new wt;const n=ge("");let r=0;const s=ge("");let o=null;ki(()=>{$.listen("measurement-selected",l),$.listen("parametric-clear-data",a)});function a(){n.value="",s.value=""}function l(u){console.debug("Variable selected",u,"Todo:  only add this varaible to the text area/ field that is in focus."),c()}function c(){s.value="",o&&clearTimeout(o),o=window.setTimeout(()=>{try{r=n.value.length>0?i.evaluate(n.value):0,$.fire("parametric-data-update",{[e.name]:r}),$.fire("test-t-value",{val:r})}catch(u){console.debug("Got an error",u),s.value=u.message,$.fire("parametric-data-update",{[e.name]:NaN}),$.fire("test-t-value",{val:0})}},1e3)}return(u,h)=>(Te(),Ct("div",null,[w(dr,{bottom:"","max-width":"400px"},{activator:U(({props:d})=>[w(vr,ht({modelValue:n.value,"onUpdate:modelValue":h[0]||(h[0]=f=>n.value=f)},d,{density:"compact",label:u.$t(u.i18nLabelKey),placeholder:u.placeholder,"error-messages":s.value,onKeydown:c,variant:"outlined",clearable:""}),null,16,["modelValue","label","placeholder","error-messages"])]),default:U(()=>[$e(" "+nt(u.$t(u.i18nToolTip)),1)],void 0),_:1})]))}}),Kce=ri({__name:"ParametricCuspParameterValues",props:{i18nToolTip:{},i18nLabelKey:{},name:{}},setup(t){let e=new wt;const i=ge("");let n=[];const r=ge("");let s=null;ki(()=>{$.listen("measurement-selected",a.bind(this)),$.listen("parametric-clear-data",o)});function o(){i.value="",r.value=""}function a(c){console.debug("Variable selected",c,"Todo:  only add this varaible to the text area/ field that is in focus."),l()}function l(){r.value="",s&&clearTimeout(s),s=setTimeout(()=>{try{i.value.length>0&&(n.splice(0),i.value.split(",").forEach((u,h)=>{n[h]=e.evaluate(u)})),$.fire("parametric-data-update",{name:n})}catch(c){console.debug("Got an error",c),r.value=c.message}},1e3)}return(c,u)=>(Te(),Ct("div",null,[w(dr,{bottom:"","max-width":"400px"},{activator:U(({props:h})=>[w(vr,ht({modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=d=>i.value=d)},h,{density:"compact",label:c.$t(c.i18nLabelKey),"error-messages":r.value,onKeydown:l,variant:"outlined",clearable:""}),null,16,["modelValue","label","error-messages"])]),default:U(()=>[$e(" "+nt(c.$t(c.i18nToolTip)),1)],void 0),_:1})]))}});class Dt extends L{constructor(){super(...arguments);y(this,"subCommands",[])}addCommand(i){return this.subCommands.push(i),this}restoreState(){for(let i=this.subCommands.length-1;i>=0;i--)this.subCommands[i].restoreState()}saveState(){this.subCommands.forEach(i=>{i.saveState()})}do(){this.subCommands.forEach(i=>{i.do()})}toOpcode(){const i=[];return this.subCommands.forEach(n=>{const r=n.toOpcode();r!==null&&i.push(r)}),(i==null?void 0:i.length)>0?i:null}}class zP extends L{constructor(i,n,r){super();y(this,"seParametric");y(this,"seExpressionParents",[]);y(this,"seLabel");this.seParametric=i,this.seExpressionParents.push(...n),this.seLabel=r}do(){this.seExpressionParents.forEach(i=>i.registerChild(this.seParametric)),this.seParametric.registerChild(this.seLabel),L.store.addParametric(this.seParametric),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seParametric.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeParametric(this.lastState),this.seParametric.unregisterChild(this.seLabel),this.seExpressionParents.forEach(i=>i.unregisterChild(this.seParametric))}toOpcode(){var i,n;return["AddParametric","objectName="+L.symbolToASCIIDec(this.seParametric.name),"objectExists="+this.seParametric.exists,"objectShowing="+this.seParametric.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify((i=this.seParametric.ref)==null?void 0:i.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify((n=this.seParametric.ref)==null?void 0:n.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"parametricXCoordinateExpression="+L.symbolToASCIIDec(this.seParametric.coordinateExpressions.x),"parametricYCoordinateExpression="+L.symbolToASCIIDec(this.seParametric.coordinateExpressions.y),"parametricZCoordinateExpression="+L.symbolToASCIIDec(this.seParametric.coordinateExpressions.z),"parametricMinExpression="+L.symbolToASCIIDec(this.seParametric.tExpressions.min),"parametricMaxExpression="+L.symbolToASCIIDec(this.seParametric.tExpressions.max),"parametricMinNumber="+this.seParametric.tNumbers.min,"parametricMaxNumber="+this.seParametric.tNumbers.max,"parametricCurveClosed="+this.seParametric.isClosedCurve,"parametricExpressionParentsNames="+this.seParametric.seParentExpressions.map(r=>L.symbolToASCIIDec(r.name)).join("@"),"parametricCuspParameterValues="+this.seParametric.c1DiscontinuityParameterValues.map(r=>L.symbolToASCIIDec(r.toString())).join("@"),"inverseRotationMatrix="+L.store.inverseTotalRotationMatrix.elements.join(",")].join("&")}static parse(i,n){const r=i.split("&");console.debug("Parsing",r[0]);const s=new Map;r.forEach((b,_)=>{if(_===0)return;const P=b.split("=");s.set(P[0],L.asciiDecToSymbol(P[1]))});const o=s.get("parametricXCoordinateExpression"),a=s.get("parametricYCoordinateExpression"),l=s.get("parametricZCoordinateExpression"),c=s.get("parametricMinExpression"),u=s.get("parametricMaxExpression"),h=Number(s.get("parametricMinNumber")),d=Number(s.get("parametricMaxNumber")),f=s.get("parametricCurveClosed"),m=s.get("parametricExpressionParentsNames"),g=[];m&&m.split("@").forEach(b=>g.push(n.get(b)));const v=s.get("parametricCuspParameterValues"),p=[];if(v&&v.split("@").forEach(b=>p.push(Number(L.asciiDecToSymbol(b)))),o!==void 0&&a!==void 0&&l!==void 0&&c!==void 0&&u!==void 0&&!isNaN(h)&&!isNaN(d)&&g.every(b=>b!==void 0)&&p.every(b=>!isNaN(b))){const b={x:o,y:a,z:l},_={min:c,max:u},P={min:h,max:d},E=new tn(b,_,P,p,g.map(V=>V),f==="true"),T=s.get("inverseRotationMatrix");if(T){const V=new Pt,N=T.split(",").map(Number);V.elements.splice(0),V.elements.push(...N),V.invert(),E.fnValues.forEach(D=>D.applyMatrix4(V)),E.fnPrimeValues.forEach(D=>D.applyMatrix4(V)),E.fnPrimeValues.forEach(D=>D.applyMatrix4(V)),E.ref.updateDisplay()}const C=new De("parametric",E),M=new k;M.from(s.get("labelVector")),C.locationVector.copy(M);const x=s.get("labelStyle");if(x!==void 0&&C.updatePlottableStyle(q.Label,JSON.parse(x)),s.get("objectName")!==void 0)E.name=s.get("objectName")??"",E.showing=s.get("objectShowing")==="true",E.exists=s.get("objectExists")==="true",n.set(E.name,E);else throw new Error("AddParametricCommand:  Parametric name doesn't exist");if(s.get("labelName")!==void 0)C.name=s.get("labelName")??"",C.showing=s.get("labelShowing")==="true",C.exists=s.get("labelExists")==="true",n.set(C.name,C);else throw new Error("AddParametricCommand: Label Name doesn't exist");return new zP(E,g.map(V=>V),C)}throw new Error(`AddParametric:
      ${o},
      ${a},
      ${l},
      ${c},
      ${u},
      ${h},
      ${d},
      ${g},
      or
      ${p}
       is undefined`)}}class UP extends L{constructor(i,n,r,s,o,a,l,c){super();y(this,"seStartEndPoint");y(this,"seEndEndPoint");y(this,"seTracePoint");y(this,"parametricParent");y(this,"seStartLabel");y(this,"seEndLabel");y(this,"seTraceLabel");y(this,"useVisiblePointCountToRename");this.seStartEndPoint=n,this.seEndEndPoint=s,this.parametricParent=i,this.seStartLabel=r,this.seEndLabel=o,this.seTracePoint=a,this.seTraceLabel=l,c!==void 0?this.useVisiblePointCountToRename=c:this.useVisiblePointCountToRename=!0}do(){this.parametricParent.registerChild(this.seStartEndPoint),this.parametricParent.registerChild(this.seEndEndPoint),this.parametricParent.registerChild(this.seTracePoint),this.seStartEndPoint.registerChild(this.seStartLabel),this.seEndEndPoint.registerChild(this.seEndLabel),this.seTracePoint.registerChild(this.seTraceLabel),this.seStartLabel.showing=!0,this.seEndLabel.showing=!0,this.seTraceLabel.showing=!0,L.store.addPoint(this.seStartEndPoint),L.store.addPoint(this.seEndEndPoint),L.store.addPoint(this.seTracePoint),L.store.addLabel(this.seStartLabel),L.store.addLabel(this.seEndLabel),L.store.addLabel(this.seTraceLabel),this.seStartEndPoint.pointVisibleBefore=!0,this.seStartEndPoint.incrementVisiblePointCount(),this.seStartEndPoint.label&&this.useVisiblePointCountToRename&&(this.seStartEndPoint.label.ref.shortUserName=`P${this.seStartEndPoint.visiblePointCount}`),this.seTracePoint.pointVisibleBefore=!0,this.seTracePoint.incrementVisiblePointCount(),this.seTracePoint.label&&this.useVisiblePointCountToRename&&(this.seTracePoint.label.ref.shortUserName=`P${this.seTracePoint.visiblePointCount}`),this.seEndEndPoint.pointVisibleBefore=!0,this.seEndEndPoint.incrementVisiblePointCount(),this.seEndEndPoint.label&&this.useVisiblePointCountToRename&&(this.seEndEndPoint.label.ref.shortUserName=`P${this.seEndEndPoint.visiblePointCount}`)}saveState(){this.lastState=this.seStartEndPoint.id}restoreState(){this.seStartEndPoint.decrementVisiblePointCount(),this.seStartEndPoint.label&&this.useVisiblePointCountToRename&&(this.seStartEndPoint.label.ref.shortUserName=`P${this.seStartEndPoint.visiblePointCount}`),this.seStartEndPoint.pointVisibleBefore=!1,this.seTracePoint.decrementVisiblePointCount(),this.seTracePoint.label&&this.useVisiblePointCountToRename&&(this.seTracePoint.label.ref.shortUserName=`P${this.seTracePoint.visiblePointCount}`),this.seTracePoint.pointVisibleBefore=!1,this.seEndEndPoint.decrementVisiblePointCount(),this.seEndEndPoint.label&&this.useVisiblePointCountToRename&&(this.seEndEndPoint.label.ref.shortUserName=`P${this.seEndEndPoint.visiblePointCount}`),this.seEndEndPoint.pointVisibleBefore=!1,L.store.removeLabel(this.seEndLabel.id),L.store.removeLabel(this.seStartLabel.id),L.store.removeLabel(this.seTraceLabel.id),L.store.removePoint(this.seEndEndPoint.id),L.store.removePoint(this.seStartEndPoint.id),L.store.removePoint(this.seTracePoint.id),this.seEndEndPoint.unregisterChild(this.seEndLabel),this.seStartEndPoint.unregisterChild(this.seStartLabel),this.seTracePoint.unregisterChild(this.seTraceLabel),this.parametricParent.unregisterChild(this.seEndEndPoint),this.parametricParent.unregisterChild(this.seStartEndPoint),this.parametricParent.unregisterChild(this.seTracePoint)}toOpcode(){const i=L.store.inverseTotalRotationMatrix,n=this.parametricParent.tracePoint.locationVector.clone().applyMatrix4(i),r=this.parametricParent.tracePoint.label.locationVector.clone().applyMatrix4(i),[s,o]=this.parametricParent.endPoints,a=s.locationVector.clone().applyMatrix4(i);console.debug("Saved min point at",a.toFixed(4));const l=s.label.locationVector.clone().applyMatrix4(i),c=o.locationVector.clone().applyMatrix4(i);console.debug("Saved max point at",c.toFixed(4));const u=o.label.locationVector.clone().applyMatrix4(i);return["AddParametricEndPoints","parametricEndPointParametricParentName="+L.symbolToASCIIDec(this.parametricParent.name),"parametricEndPointseStartEndPointName="+L.symbolToASCIIDec(this.seStartEndPoint.name),"parametricEndPointseStartEndPointLocationVector="+a.toFixed(7),"parametricEndPointseStartEndPointShowing="+this.seStartEndPoint.showing,"parametricEndPointseStartEndPointExists="+this.seStartEndPoint.exists,"parametricEndPointseStartEndPointFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seStartEndPoint.ref.currentStyleState(q.Front))),"parametricEndPointseStartEndPointBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seStartEndPoint.ref.currentStyleState(q.Back))),"parametricEndPointseEndEndPointName="+L.symbolToASCIIDec(this.seEndEndPoint.name),"parametricEndPointseEndEndPointLocationVector="+c.toFixed(7),"parametricEndPointseEndEndPointShowing="+this.seEndEndPoint.showing,"parametricEndPointseEndEndPointExists="+this.seEndEndPoint.exists,"parametricEndPointseEndEndPointFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seEndEndPoint.ref.currentStyleState(q.Front))),"parametricEndPointseEndEndPointBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seEndEndPoint.ref.currentStyleState(q.Back))),"parametricEndPointseTracePointName="+L.symbolToASCIIDec(this.seTracePoint.name),"parametricEndPointseTracePointLocationVector="+n.toFixed(7),"parametricEndPointseTracePointShowing="+this.seTracePoint.showing,"parametricEndPointseTracePointExists="+this.seTracePoint.exists,"parametricEndPointseTracePointFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seTracePoint.ref.currentStyleState(q.Front))),"parametricEndPointseTracePointBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seTracePoint.ref.currentStyleState(q.Back))),"parametricEndPointseStartLabelName="+L.symbolToASCIIDec(this.seStartLabel.name),"parametricEndPointseStartLabelLocationVector="+l.toFixed(7),"parametricEndPointseStartLabelShowing="+this.seStartLabel.showing,"parametricEndPointseStartLabelExists="+this.seStartLabel.exists,"parametricEndPointseStartLabelLabelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seStartLabel.ref.currentStyleState(q.Label))),"parametricEndPointseEndLabelName="+L.symbolToASCIIDec(this.seEndLabel.name),"parametricEndPointseEndLabelLocationVector="+u.toFixed(7),"parametricEndPointseEndLabelShowing="+this.seEndLabel.showing,"parametricEndPointseEndLabelExists="+this.seEndLabel.exists,"parametricEndPointseEndLabelLabelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seEndLabel.ref.currentStyleState(q.Label))),"parametricEndPointseTraceLabelName="+L.symbolToASCIIDec(this.seTraceLabel.name),"parametricEndPointseTraceLabelLocationVector="+r.toFixed(7),"parametricEndPointseTraceLabelShowing="+this.seTraceLabel.showing,"parametricEndPointseTraceLabelExists="+this.seTraceLabel.exists,"parametricEndPointseTraceLabelLabelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seTraceLabel.ref.currentStyleState(q.Label)))].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((a,l)=>{if(l===0)return;const c=a.split("=");s.set(c[0],L.asciiDecToSymbol(c[1]))});const o=n.get(s.get("parametricEndPointParametricParentName")??"");if(o!==void 0){const a=new g_(o,"min"),l=new k;l.from(s.get("parametricEndPointseStartEndPointLocationVector")),console.debug("Loaded min point at",l.toFixed(4)),a.locationVector.copy(l);let c=s.get("parametricEndPointseStartEndPointFrontStyle");c!==void 0&&a.updatePlottableStyle(q.Front,JSON.parse(c));let u=s.get("parametricEndPointseStartEndPointBackStyle");u!==void 0&&a.updatePlottableStyle(q.Back,JSON.parse(u));const h=new De("point",a),d=new k;d.from(s.get("parametricEndPointseStartLabelLocationVector")),h.locationVector.copy(d);let f=s.get("parametricEndPointseStartLabelLabelStyle");if(f!==void 0&&h.updatePlottableStyle(q.Label,JSON.parse(f)),s.get("parametricEndPointseStartEndPointName")!==void 0)a.name=s.get("parametricEndPointseStartEndPointName")??"",a.showing=s.get("parametricEndPointseStartEndPointShowing")==="true",a.exists=s.get("parametricEndPointseStartEndPointExists")==="true",n.set(a.name,a);else throw new Error(`AddParametricEndPoint: Start End Point Name doesn't exist ${s.get("parametricEndPointseStartEndPointName")}`);if(s.get("parametricEndPointseStartLabelName")!==void 0)h.name=s.get("parametricEndPointseStartLabelName")??"",h.showing=s.get("parametricEndPointseStartLabelShowing")==="true",h.exists=s.get("parametricEndPointseStartLabelExists")==="true",n.set(h.name,h);else throw new Error("AddParametricEndPoint: Start End Point Label Name doesn't exist");a.ref.updateDisplay();const m=new g_(o,"max"),g=new k;g.from(s.get("parametricEndPointseEndEndPointLocationVector")),console.debug("Loaded max point at",g.toFixed(4)),m.locationVector.copy(g),c=s.get("parametricEndPointseEndEndPointFrontStyle"),c!==void 0&&m.updatePlottableStyle(q.Front,JSON.parse(c)),u=s.get("parametricEndPointseEndEndPointBackStyle"),u!==void 0&&m.updatePlottableStyle(q.Back,JSON.parse(u));const v=new De("point",m),p=new k;if(p.from(s.get("parametricEndPointseEndLabelLocationVector")),v.locationVector.copy(p),f=s.get("parametricEndPointseEndLabelLabelStyle"),f!==void 0&&v.updatePlottableStyle(q.Label,JSON.parse(f)),s.get("parametricEndPointseEndEndPointName")!==void 0)m.name=s.get("parametricEndPointseEndEndPointName")??"",m.showing=s.get("parametricEndPointseEndEndPointShowing")==="true",m.exists=s.get("parametricEndPointseEndEndPointExists")==="true",n.set(m.name,m);else throw new Error("AddParametricEndPoint: End End Point Name doesn't exist");if(s.get("parametricEndPointseEndLabelName")!==void 0)v.name=s.get("parametricEndPointseEndLabelName")??"",v.showing=s.get("parametricEndPointseEndLabelShowing")==="true",v.exists=s.get("parametricEndPointseEndLabelExists")==="true",n.set(v.name,v);else throw new Error("AddParametricEndPoint: End End Point Label Name doesn't exist");m.ref.updateDisplay();const b=new YM(o),_=new k;_.from(s.get("parametricEndPointseTracePointLocationVector")),b.locationVector.copy(_),c=s.get("parametricEndPointseTracePointFrontStyle"),c!==void 0&&b.updatePlottableStyle(q.Front,JSON.parse(c)),u=s.get("parametricEndPointseTracePointBackStyle"),u!==void 0&&b.updatePlottableStyle(q.Back,JSON.parse(u));const P=new De("point",b),E=new k;if(p.from(s.get("parametricEndPointseTraceLabelLocationVector")),P.locationVector.copy(E),f=s.get("parametricEndPointseTraceLabelLabelStyle"),f!==void 0&&P.updatePlottableStyle(q.Label,JSON.parse(f)),s.get("parametricEndPointseTracePointName")!==void 0)b.name=s.get("parametricEndPointseTracePointName")??"",b.showing=s.get("parametricEndPointseTracePointShowing")==="true",b.exists=s.get("parametricEndPointseTracePointExists")==="true",n.set(b.name,b);else throw new Error("AddParametricEndPoint: Trace Point Name doesn't exist");if(s.get("parametricEndPointseTraceLabelName")!==void 0)P.name=s.get("parametricEndPointseTraceLabelName")??"",P.showing=s.get("parametricEndPointseTraceLabelShowing")==="true",P.exists=s.get("parametricEndPointseTraceLabelExists")==="true",n.set(P.name,P);else throw new Error("AddParametricEndPoint: Trace Point Label Name doesn't exist");return new UP(o,a,h,m,v,b,P,!1)}else throw new Error(`AddParametricEndPoints: parametric parent ${o} is undefined`)}}class BP extends L{constructor(i,n,r,s){super();y(this,"seTracePoint");y(this,"parametricParent");y(this,"seTraceLabel");y(this,"useVisiblePointCountToRename");this.parametricParent=i,this.seTracePoint=n,this.seTraceLabel=r,s!==void 0?this.useVisiblePointCountToRename=s:this.useVisiblePointCountToRename=!0}do(){this.parametricParent.registerChild(this.seTracePoint),this.seTracePoint.registerChild(this.seTraceLabel),this.seTraceLabel.showing=!0,L.store.addPoint(this.seTracePoint),L.store.addLabel(this.seTraceLabel),this.seTracePoint.pointVisibleBefore=!0,this.seTracePoint.incrementVisiblePointCount(),this.seTracePoint.label&&this.useVisiblePointCountToRename&&(this.seTracePoint.label.ref.shortUserName=`P${this.seTracePoint.visiblePointCount}`)}saveState(){}restoreState(){this.seTracePoint.decrementVisiblePointCount(),this.seTracePoint.label&&this.useVisiblePointCountToRename&&(this.seTracePoint.label.ref.shortUserName=`P${this.seTracePoint.visiblePointCount}`),this.seTracePoint.pointVisibleBefore=!1,L.store.removeLabel(this.seTraceLabel.id),L.store.removePoint(this.seTracePoint.id),this.seTracePoint.unregisterChild(this.seTraceLabel),this.parametricParent.unregisterChild(this.seTracePoint)}toOpcode(){const i=L.store.inverseTotalRotationMatrix,n=this.parametricParent.tracePoint.locationVector.clone().applyMatrix4(i),r=this.parametricParent.tracePoint.label.locationVector.clone().applyMatrix4(i);return["AddParametricTracePoint","parametricEndPointParametricParentName="+L.symbolToASCIIDec(this.parametricParent.name),"parametricEndPointseTracePointName="+L.symbolToASCIIDec(this.seTracePoint.name),"parametricEndPointseTracePointLocationVector="+n.toFixed(7),"parametricEndPointseTracePointShowing="+this.seTracePoint.showing,"parametricEndPointseTracePointExists="+this.seTracePoint.exists,"parametricEndPointseTracePointFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seTracePoint.ref.currentStyleState(q.Front))),"parametricEndPointseTracePointBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seTracePoint.ref.currentStyleState(q.Back))),"parametricEndPointseTraceLabelName="+L.symbolToASCIIDec(this.seTraceLabel.name),"parametricEndPointseTraceLabelLocationVector="+r.toFixed(7),"parametricEndPointseTraceLabelShowing="+this.seTraceLabel.showing,"parametricEndPointseTraceLabelExists="+this.seTraceLabel.exists,"parametricEndPointseTraceLabelLabelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seTraceLabel.ref.currentStyleState(q.Label)))].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((a,l)=>{if(l===0)return;const c=a.split("=");s.set(c[0],L.asciiDecToSymbol(c[1]))});const o=n.get(s.get("parametricEndPointParametricParentName")??"");if(o!==void 0){const a=new YM(o),l=new k;l.from(s.get("parametricEndPointseTracePointLocationVector")),a.locationVector.copy(l);const c=s.get("parametricEndPointseTracePointFrontStyle");c!==void 0&&a.updatePlottableStyle(q.Front,JSON.parse(c));const u=s.get("parametricEndPointseTracePointBackStyle");u!==void 0&&a.updatePlottableStyle(q.Back,JSON.parse(u));const h=new De("point",a),d=new k;d.from(s.get("parametricEndPointseTraceLabelLocationVector")),h.locationVector.copy(d);const f=s.get("parametricEndPointseTraceLabelLabelStyle");if(f!==void 0&&h.updatePlottableStyle(q.Label,JSON.parse(f)),s.get("parametricEndPointseTracePointName")!==void 0)a.name=s.get("parametricEndPointseTracePointName")??"",a.showing=s.get("parametricEndPointseTracePointShowing")==="true",a.exists=s.get("parametricEndPointseTracePointExists")==="true",n.set(a.name,a);else throw new Error("AddParametricTracePoint: Trace Point Name doesn't exist");if(s.get("parametricEndPointseTraceLabelName")!==void 0)h.name=s.get("parametricEndPointseTraceLabelName")??"",h.showing=s.get("parametricEndPointseTraceLabelShowing")==="true",h.exists=s.get("parametricEndPointseTraceLabelExists")==="true",n.set(h.name,h);else throw new Error("AddParametricTracePoint: Trace Point Label Name doesn't exist");return new BP(o,a,h,!1)}else throw new Error(`AddParametricTracePoint: parametric parent ${o} is undefined`)}}class ir extends L{constructor(i,n,r,s){super();y(this,"seIntersectionPoint");y(this,"principleParent1");y(this,"principleParent2");y(this,"seLabel");this.seIntersectionPoint=i,this.principleParent1=n,this.principleParent2=r,this.seLabel=s}do(){this.principleParent1.registerChild(this.seIntersectionPoint),this.principleParent2.registerChild(this.seIntersectionPoint),this.seIntersectionPoint.registerChild(this.seLabel),L.store.addPoint(this.seIntersectionPoint),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seIntersectionPoint.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removePoint(this.lastState),this.seIntersectionPoint.unregisterChild(this.seLabel),this.principleParent1.unregisterChild(this.seIntersectionPoint),this.principleParent2.unregisterChild(this.seIntersectionPoint)}toOpcode(){return["AddIntersectionPoint","objectName="+L.symbolToASCIIDec(this.seIntersectionPoint.name),"objectExists="+this.seIntersectionPoint.exists,"objectShowing="+this.seIntersectionPoint.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seIntersectionPoint.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seIntersectionPoint.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"intersectionPointPrincipleParent1Name="+this.principleParent1.name,"intersectionPointPrincipleParent2Name="+this.principleParent2.name,"intersectionPointUserCreated="+this.seIntersectionPoint.isUserCreated,"intersectionPointOrder="+this.seIntersectionPoint.intersectionOrder,"intersectionPointVector="+this.seIntersectionPoint.locationVector.toFixed(9)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((h,d)=>{if(d===0)return;const f=h.split("=");f[0]!=="intersectionPointOtherParentArrayNameList"?s.set(f[0],L.asciiDecToSymbol(f[1])):s.set(f[0],f[1])});const o=n.get(s.get("intersectionPointPrincipleParent1Name")??""),a=n.get(s.get("intersectionPointPrincipleParent2Name")??""),l=new k;l.from(s.get("intersectionPointVector"));const c=Number(s.get("intersectionPointOrder")),u=s.get("intersectionPointUserCreated")==="true";if(a&&o&&l.z!==1&&!isNaN(c)){const h=new Le(o,a,c,u);h.locationVector=l;const d=s.get("objectFrontStyle");d!==void 0&&h.updatePlottableStyle(q.Front,JSON.parse(d));const f=s.get("objectBackStyle");f!==void 0&&h.updatePlottableStyle(q.Back,JSON.parse(f));const m=new De("point",h),g=new k;g.from(s.get("labelVector")),m.locationVector.copy(g);const v=s.get("labelStyle");if(v!==void 0&&m.updatePlottableStyle(q.Label,JSON.parse(v)),s.get("objectName")!==void 0)h.name=s.get("objectName")??"",h.showing=s.get("objectShowing")==="true",h.exists=s.get("objectExists")==="true",n.set(h.name,h);else throw new Error("AddIntersectionPoint: Intersection point Name doesn't exist");if(s.get("labelName")!==void 0)m.name=s.get("labelName")??"",m.showing=s.get("labelShowing")==="true",m.exists=s.get("labelExists")==="true",n.set(m.name,m);else throw new Error("AddIntersectionPoint: Label Name doesn't exist");return new ir(h,o,a,m)}throw new Error(`AddIntersectionPointCommand: HERE ${o==null?void 0:o.name}, ${a==null?void 0:a.name},  ${l}, ${c}, or some element of the other parent array is undefined`)}}class nr extends L{constructor(i,n){super();y(this,"seOtherParent");y(this,"seIntersectionPoint");this.seOtherParent=n,this.seIntersectionPoint=i}do(){this.seIntersectionPoint.addIntersectionOtherParent(this.seOtherParent)}saveState(){this.lastState=this.seIntersectionPoint.id}restoreState(){this.seIntersectionPoint.removeIntersectionOtherParent(this.seOtherParent)}toOpcode(){return["AddIntersectionPointOtherParent","intersectionPointName="+this.seIntersectionPoint.name,"intersectionPointOtherParentName="+this.seOtherParent.name].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("intersectionPointName")??""),a=n.get(s.get("intersectionPointOtherParentName")??"");if(o&&a)return new nr(o,a);throw new Error(`AddIntersectionPointOtherParentCommand: ${o} or ${a} is undefined`)}}class qp extends L{constructor(i,n,r){super();y(this,"seAntipodalPoint");y(this,"parentSEPoint");y(this,"seLabel");this.seAntipodalPoint=i,this.parentSEPoint=n,this.seLabel=r}do(){this.parentSEPoint.registerChild(this.seAntipodalPoint),this.seAntipodalPoint.registerChild(this.seLabel),L.store.addPoint(this.seAntipodalPoint),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seAntipodalPoint.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removePoint(this.lastState),this.seAntipodalPoint.unregisterChild(this.seLabel),this.parentSEPoint.unregisterChild(this.seAntipodalPoint)}toOpcode(){return["AddAntipodalPoint","objectName="+L.symbolToASCIIDec(this.seAntipodalPoint.name),"objectExists="+this.seAntipodalPoint.exists,"objectShowing="+this.seAntipodalPoint.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seAntipodalPoint.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seAntipodalPoint.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"pointVector="+this.seAntipodalPoint.locationVector.toFixed(9),"antipodalPointsParentName="+this.parentSEPoint.name,"antipodalPointIsUserCreated="+this.seAntipodalPoint.isUserCreated].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((a,l)=>{if(l===0)return;const c=a.split("=");s.set(c[0],L.asciiDecToSymbol(c[1]))});const o=n.get(s.get("antipodalPointsParentName")??"");if(o){const a=s.get("antipodalPointIsUserCreated")==="true",l=new ut(o,a),c=new k;c.from(s.get("pointVector")),l.locationVector.copy(c);const u=s.get("objectFrontStyle");u!==void 0&&l.updatePlottableStyle(q.Front,JSON.parse(u));const h=s.get("objectBackStyle");h!==void 0&&l.updatePlottableStyle(q.Back,JSON.parse(h));const d=new De("point",l),f=new k;f.from(s.get("labelVector")),d.locationVector.copy(f);const m=s.get("labelStyle");if(m!==void 0&&d.updatePlottableStyle(q.Label,JSON.parse(m)),s.get("objectName")!==void 0)l.name=s.get("objectName")??"",l.showing=s.get("objectShowing")==="true",l.exists=s.get("objectExists")==="true",n.set(l.name,l);else throw new Error("AddAntipodalPoint: Point Name doesn't exist");if(s.get("labelName")!==void 0)d.name=s.get("labelName")??"",d.showing=s.get("labelShowing")==="true",d.exists=s.get("labelExists")==="true",n.set(d.name,d);else throw new Error("AddAntipodalPoint: Label Name doesn't exist");return new qp(l,o,d)}else throw new Error(`AddAntipodalPoint: parent point ${s.get("antipodalPointsParentName")} is undefined`)}}const A5=We({color:String,...Lu(),...Ut(),...bh(),...Tl(),...rf(),...Oy(),...cs(),...pn(),...wn()},"VSheet"),mo=vt()({name:"VSheet",props:A5(),setup(t,e){let{slots:i}=e;const{themeClasses:n}=Hn(t),{backgroundColorClasses:r,backgroundColorStyles:s}=Cs(bt(t,"color")),{borderClasses:o}=Iu(t),{dimensionStyles:a}=_h(t),{elevationClasses:l}=xl(t),{locationStyles:c}=sf(t),{positionClasses:u}=Dy(t),{roundedClasses:h}=hs(t);return Tt(()=>w(t.tag,{class:["v-sheet",n.value,r.value,o.value,l.value,u.value,h.value,t.class],style:[s.value,a.value,c.value,t.style]},i)),{}}}),Xce=tt("ul",null,[tt("li",null,"Ctrl-Alt-C: Circle"),tt("li",null,"Ctrl-Alt-S: Spiral"),tt("li",null,"Ctrl-Alt-T: Trochoid"),tt("li",null,"Ctrl-Alt-Y: Cycloid with cusp points"),tt("li",null,"Ctrl-Alt-E: Ellipse (M1 & M2)"),tt("li",null,"Ctrl-Alt-L: Loxodrome (M1)"),tt("li",null,"Ctrl-Alt-R: Cardioid (M1)")],-1),Yce=ri({__name:"ParametricForm",setup(t){const e=An(),{expressions:i,seParametrics:n}=Ji(e);let r={x:"",y:"",z:""},s={min:"",max:""},o={min:NaN,max:NaN},a=[],l=new wt;const c=new Map,u=new k,h=new k,d=[{i18nLabelkey:"objectTree.tMinExpression",i18nToolTip:"objectTree.tMinExpressionTip",placeholder:"0",name:"tMinExpression"},{i18nLabelkey:"objectTree.tMaxExpression",i18nToolTip:"objectTree.tMaxExpressionTip",placeholder:"2*M1",name:"tMaxExpression"}],f=[{i18nLabelkey:"objectTree.tMinNumber",i18nToolTip:"objectTree.tMinNumberTip",placeholder:"0",name:"tMinNumber"},{i18nLabelkey:"objectTree.tMaxNumber",i18nToolTip:"objectTree.tMaxNumberTip",placeholder:"2*pi",name:"tMaxNumber"}],m=[{i18n_key:"objectTree.xParametricCoordinate",i18nToolTip:"objectTree.xCoordExpressionTip",placeholder:"sin(M1)*cos(t)",name:"xCoord"},{i18n_key:"objectTree.yParametricCoordinate",i18nToolTip:"objectTree.yCoordExpressionTip",placeholder:"sin(M1)*sin(t)",name:"yCoord"},{i18n_key:"objectTree.zParametricCoordinate",i18nToolTip:"objectTree.zCoordExpressionTip",placeholder:"cos(M1)",name:"zCoord"}],g={i18nLabelKey:"objectTree.cuspParameterValues",i18nToolTip:"objectTree.cuspParameterValuesTip",name:"cuspParameterValues"};to(()=>{window.addEventListener("keydown",p)}),ki(()=>{$.listen("parametric-data-update",x)});const v=W(()=>!0);function p(O){O.repeat||O.altKey&&O.ctrlKey&&(a.splice(0),O.code==="KeyC"?(b(),N()):O.code==="KeyE"?(_(),N()):O.code==="KeyR"?(P(),N()):O.code==="KeyS"?(E(),N()):O.code==="KeyL"?(T(),N()):O.code==="KeyY"?(C(),N()):O.code==="KeyT"&&(M(),N()))}function b(){o.min=0,o.max=2*Math.PI,r.x="sin(pi/4)*cos(t)",r.y="sin(pi/4)*sin(t)",r.z="cos(pi/4)"}function _(){o.min=0,o.max=2*Math.PI,r.x="sin(M1)*cos(t)",r.y="sin(M2)*sin(t)",r.z="sqrt(cos(M1)^2 +sin(M1-M2)*sin(M1+M2)*sin(t)^2)"}function P(){o.min=0,o.max=2*Math.PI,r.x="sin(M1)+2*cos(M1)^2*sin(M1)*(cos(t)-cos(t)^2)",r.y="2*cos(M1)^2*sin(M1)*sin(t)*(1-cos(t))",r.z="cos(M1)-2*cos(M1)*sin(M1)^2*(1-cos(t))",a.push(0,2*Math.PI)}function E(){o.min=0,o.max=.9,r.x="sqrt(1-t^2)*cos(4*pi*t)",r.y="sqrt(1-t^2)*sin(4*pi*t)",r.z="t"}function T(){o.min=-6,o.max=6,s.min="-1*abs(M1)",s.max="abs(M1)",r.x="cos(t)/sqrt(1+4*t^2)",r.y="sin(t)/sqrt(1+4*t^2)",r.z="-2*t/sqrt(1+4*t^2)"}function C(){const O="(-1*((2/tan(w)*1/sin(w))*1/b)+1/sin(w)^2+1/sin(w)^2*1/b^2)^(-1/2)",F="0.7227342478",X="0.75";o.min=0,o.max=8*Math.PI,a.push(0,1*8/6*Math.PI,2*8/6*Math.PI,3*8/6*Math.PI,4*8/6*Math.PI,5*8/6*Math.PI,8*Math.PI),r.x="(1/b)*((b-cos(w))*cos(t)+cos(w)*cos(t)*cos(b*t)+sin(t)*sin(b*t))*a".replaceAll("a",O).replaceAll("w",F).replaceAll("b",X),r.y="(1/b)*((b-cos(w))*sin(t)+cos(w)*sin(t)*cos(b*t)-cos(t)*sin(b*t))*a".replaceAll("a",O).replaceAll("w",F).replaceAll("b",X),r.z="(1/b)*sin(w)*(1-cos(b*t))*a-((a/b)-a*cos(w))/sin(w)".replaceAll("a",O).replaceAll("w",F).replaceAll("b",X)}function M(){const O="(2)^(1/2)*(-4*b^2*q*cos(w)/sin(w)*1/sin(w)^2+b^2*1/sin(w)^2+d^2*1/sin(w)^2+2*b^2*q^2*1/sin(w)^2+b^2*cos(2*w)*1/sin(w)^2-d^2*cos(2*w)*1/sin(w)^2)^(-1/2)",F="0.5",X="1",Z="pi/2",K="3";o.min=0,o.max=2*Math.PI,a.splice(0),r.x="e*((q*b-b*cos(w)+d*cos(w)*cos(q*t))*cos(t)+d*sin(t)*sin(q*t))".replaceAll("e",O).replaceAll("b",F).replaceAll("d",X).replaceAll("q",K).replaceAll("w",Z),r.y="e*((q*b-b*cos(w)+d*cos(w)*cos(q*t))*sin(t)-d*cos(t)*sin(q*t))".replaceAll("e",O).replaceAll("b",F).replaceAll("d",X).replaceAll("q",K).replaceAll("w",Z),r.z="e*(sin(w)*(b-d*cos(q*t))-(b-b*q*cos(w))/sin(w))".replaceAll("e",O).replaceAll("b",F).replaceAll("d",X).replaceAll("q",K).replaceAll("w",Z)}an(()=>{window.removeEventListener("keydown",p)});function x(O){O.tMinNumber!==void 0&&(o.min=O.tMinNumber),O.tMaxNumber!==void 0&&(o.max=O.tMaxNumber),O.tMinExpression!==void 0&&(s.min=O.tMinExpression),O.tMaxExpression!==void 0&&(s.max=O.tMaxExpression),O.xCoord!==void 0&&(r.x=O.xCoord),O.yCoord!==void 0&&(r.y=O.yCoord),O.zCoord!==void 0&&(r.z=O.zCoord),O.cuspParameterValues!==void 0&&(a.push(...O.cuspParameterValues),console.log("cusp",a))}const V=W(()=>isNaN(o.min)||isNaN(o.max)||r.x===""||r.y===""||r.z==="");function N(){let O=!1;if(n.value.forEach(ee=>{const de=ee.coordinateExpressions;r.x===de.x&&r.y===de.y&&r.z===de.z&&(O=!0)}),O){$.fire("show-alert",{key:"objectTree.duplicateParametricCurve",type:"error"});return}const F=[];if(o.min>=o.max){$.fire("show-alert",{key:"objectTree.tMinNotLessThantMax",type:"error"});return}if(a.length>0&&!a.every(ee=>o.min<=ee&&ee<=o.max)){$.fire("show-alert",{key:"objectTree.cuspValuesOutOfBounds",type:"error"});return}if(s.min.length===0&&s.max.length!==0||s.min.length!==0&&s.max.length===0){$.fire("show-alert",{key:"objectTree.exactlyOneEmptyTExpression",type:"error"});return}const X=[];for(let ee=0;ee<S.parameterization.numberOfTestTValues+1;ee++)X.push(o.min+ee/S.parameterization.numberOfTestTValues*(o.max-o.min));i.value.forEach(ee=>{const de=ee.name;c.set(de,ee.value)});const Z=D(X);if(Z!==null){$.fire("show-alert",{key:"objectTree.notAUnitParametricCurve",keyOptions:{tVal:Z},type:"error"});return}try{wt.differentiate(wt.parse(r.x),"t"),wt.differentiate(wt.parse(r.y),"t"),wt.differentiate(wt.parse(r.z),"t"),wt.differentiate(wt.differentiate(wt.parse(r.x),"t"),"t"),wt.differentiate(wt.differentiate(wt.parse(r.y),"t"),"t"),wt.differentiate(wt.differentiate(wt.parse(r.z),"t"),"t")}catch(ee){$.fire("show-alert",{key:"objectTree.unableToComputeTheDerivativeOf",keyOptions:{error:ee},type:"error"});return}c.set("t",o.min),u.set(l.evaluateWithVars(r.x,c),l.evaluateWithVars(r.y,c),l.evaluateWithVars(r.z,c)),c.set("t",o.max),h.set(l.evaluateWithVars(r.x,c),l.evaluateWithVars(r.y,c),l.evaluateWithVars(r.z,c));const K=u.sub(h).isZero(S.nearlyAntipodalIdeal),z=[];let H;for(H in r){const ee=r[H];for(const de of ee.matchAll(/[Mm][0-9]+/g)){const Y=i.value.findIndex(te=>te.name.startsWith(`${de[0]}`));Y>-1&&z.findIndex(he=>he.name===i.value[Y].name)<0&&z.push(i.value[Y])}}let re;for(re in s){const ee=s[re];for(const de of ee.matchAll(/[Mm][0-9]+/g)){const Y=i.value.findIndex(te=>te.name.startsWith(`${de[0]}`));Y>-1&&z.findIndex(he=>he.name===i.value[Y].name)<0&&z.push(i.value[Y])}}const ne=new tn(r,s,o,a,z),B=new De("parametric",ne),Q=ne.P(o.min);u.copy(Q).add(new k(0,S.parametric.initialLabelOffset,0)).normalize(),B.locationVector=u;const fe=new Dt;fe.addCommand(new zP(ne,z,B));const ie=new YM(ne);ie.locationVector=Q;const se=new De("point",ie);if(s.min.length!==0||!K){const ee=new g_(ne,"min"),de=new g_(ne,"max"),Y=new De("point",ee),te=new De("point",de);fe.addCommand(new UP(ne,ee,Y,de,te,ie,se)),ne.endPoints=[ee,de]}else K&&fe.addCommand(new BP(ne,ie,se));e.createAllIntersectionsWithParametric(ne,F).forEach(ee=>{if(ee.existingIntersectionPoint)fe.addCommand(new nr(ee.SEIntersectionPoint,ee.parent1));else{const de=new De("point",ee.SEIntersectionPoint);if(u.copy(ee.SEIntersectionPoint.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),de.locationVector=u,fe.addCommand(new ir(ee.SEIntersectionPoint,ee.parent1,ee.parent2,de)),ee.SEIntersectionPoint.showing=!1,de.showing=!1,ee.createAntipodalPoint){const Y=new ut(ee.SEIntersectionPoint,!1);Y.locationVector=ee.SEIntersectionPoint.locationVector,Y.locationVector.multiplyScalar(-1);const te=Y.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));fe.addCommand(new qp(Y,ee.SEIntersectionPoint,te)),F.push(Y,ee.SEIntersectionPoint)}}}),fe.execute(),ne.markKidsOutOfDate(),ne.update(),console.log("parametric exist?",ne.exists),r={x:"",y:"",z:""},s={min:"",max:""},o={min:NaN,max:NaN},a=[],$.fire("parametric-clear-data",{})}function D(O){for(let F=0;F<O.length;F++)if(c.set("t",O[F]),u.set(l.evaluateWithVars(r.x,c),l.evaluateWithVars(r.y,c),l.evaluateWithVars(r.z,c)),Math.abs(u.length()-1)>S.nearlyAntipodalIdeal)return O[F];return null}return(O,F)=>(Te(),Ct("div",null,[w(uc,{raised:"",variant:"outlined"},{default:U(()=>[w(lh,null,{default:U(()=>[w(Ph,null,{default:U(()=>[v.value?Vi("",!0):(Te(),qe(pr,{key:0},{default:U(()=>[$e(" Keyboard shortcuts: "),Xce],void 0,!0),_:1})),w(pr,null,{default:U(()=>[w(Si,{cols:"12"},{default:U(()=>[w(mo,{rounded:"",color:"accent",elevation:4,class:"my-3"},{default:U(()=>[w(Bce,{i18LabelKey:"objectTree.parametricCoordinates",coordinateData:m},null,8,["coordinateData"])],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),w(pr,null,{default:U(()=>[w(Si,{cols:"12"},{default:U(()=>[w(mo,{rounded:"",color:"accent",elevation:4,class:"my-3"},{default:U(()=>[w(Hce,{i18LabelKey:"objectTree.tExpressionData",tExpressionData:d},null,8,["tExpressionData"])],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),w(pr,null,{default:U(()=>[w(Si,{cols:"12"},{default:U(()=>[(Te(),Ct(mt,null,Zs(f,(X,Z)=>w(qce,{key:Z,placeholder:X.placeholder,i18nLabelKey:X.i18nLabelkey,i18nToolTip:X.i18nToolTip,name:X.name},null,8,["placeholder","i18nLabelKey","i18nToolTip","name"])),64))],void 0,!0),_:1})],void 0,!0),_:1}),w(pr,null,{default:U(()=>[w(Si,{cols:"12"},{default:U(()=>[tt("template",null,[w(Kce,{i18nLabelKey:g.i18nLabelKey,i18nToolTip:g.i18nToolTip,name:g.name},null,8,["i18nLabelKey","i18nToolTip","name"])])],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),w(Op,null,{default:U(()=>[w(Ry),w(Qt,{size:"small",fab:"",right:"",color:"accent",disabled:V.value,onClick:N},{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-plus")],void 0,!0),_:1})],void 0,!0),_:1},8,["disabled"])],void 0,!0),_:1})],void 0),_:1})]))}});class jP extends Xy{constructor(e){super(e,[])}toOpcode(){return["AddSliderMeasurement","objectName="+L.symbolToASCIIDec(this.seExpression.name),"objectExists="+this.seExpression.exists,"objectShowing="+this.seExpression.showing,"sliderMeasurementMin="+this.seExpression.min,"sliderMeasurementMax="+this.seExpression.max,"sliderMeasurementStep="+this.seExpression.step,"sliderMeasurementValue="+this.seExpression.value].join("&")}static parse(e,i){const n=e.split("&"),r=new Map;n.forEach((c,u)=>{if(u===0)return;const h=c.split("=");r.set(h[0],L.asciiDecToSymbol(h[1]))});const s=Number(r.get("sliderMeasurementMin")),o=Number(r.get("sliderMeasurementMax")),a=Number(r.get("sliderMeasurementStep")),l=Number(r.get("sliderMeasurementValue"));if(!isNaN(s)&&!isNaN(o)&&!isNaN(a)&&!isNaN(l)){const c=new JM({min:s,max:o,step:a,value:l});if(r.get("objectName")!==void 0)c.name=r.get("objectName")??"",c.showing=r.get("objectShowing")==="true",c.exists=r.get("objectExists")==="true",i.set(c.name,c);else throw new Error("AddSliderCommand: slider name doesn't exist");return new jP(c)}throw new Error(`AddLengthMeasurementCommand: ${s}, ${o}, ${a}, or ${l} is undefined`)}}const Zce=We({...Ut(),...Ace()},"VForm"),V5=vt()({name:"VForm",props:Zce(),emits:{"update:modelValue":t=>!0,submit:t=>!0},setup(t,e){let{slots:i,emit:n}=e;const r=Vce(t),s=ge();function o(l){l.preventDefault(),r.reset()}function a(l){const c=l,u=r.validate();c.then=u.then.bind(u),c.catch=u.catch.bind(u),c.finally=u.finally.bind(u),n("submit",c),c.defaultPrevented||u.then(h=>{var f;let{valid:d}=h;d&&((f=s.value)==null||f.submit())}),c.preventDefault()}return Tt(()=>{var l;return w("form",{ref:s,class:["v-form",t.class],style:t.style,novalidate:!0,onReset:o,onSubmit:a},[(l=i.default)==null?void 0:l.call(i,r)])}),_c(r,s)}});const rA=Symbol.for("vuetify:v-slider");function SC(t,e,i){const n=i==="vertical",r=e.getBoundingClientRect(),s="touches"in t?t.touches[0]:t;return n?s.clientY-(r.top+r.height/2):s.clientX-(r.left+r.width/2)}function Jce(t,e){return"touches"in t&&t.touches.length?t.touches[0][e]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0][e]:t[e]}const L5=We({disabled:{type:Boolean,default:null},error:Boolean,readonly:{type:Boolean,default:null},max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:t=>typeof t=="boolean"||t==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:t=>typeof t=="boolean"||t==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:t=>["vertical","horizontal"].includes(t)},reverse:Boolean,...cs(),...Tl({elevation:2}),ripple:{type:Boolean,default:!0}},"Slider"),I5=t=>{const e=W(()=>parseFloat(t.min)),i=W(()=>parseFloat(t.max)),n=W(()=>+t.step>0?parseFloat(t.step):0),r=W(()=>Math.max(XL(n.value),XL(e.value)));function s(o){if(o=parseFloat(o),n.value<=0)return o;const a=So(o,e.value,i.value),l=e.value%n.value,c=Math.round((a-l)/n.value)*n.value+l;return parseFloat(Math.min(c,i.value).toFixed(r.value))}return{min:e,max:i,step:n,decimals:r,roundValue:s}},O5=t=>{let{props:e,steps:i,onSliderStart:n,onSliderMove:r,onSliderEnd:s,getActiveThumb:o}=t;const{isRtl:a}=io(),l=bt(e,"reverse"),c=W(()=>e.direction==="vertical"),u=W(()=>c.value!==l.value),{min:h,max:d,step:f,decimals:m,roundValue:g}=i,v=W(()=>parseInt(e.thumbSize,10)),p=W(()=>parseInt(e.tickSize,10)),b=W(()=>parseInt(e.trackSize,10)),_=W(()=>(d.value-h.value)/f.value),P=bt(e,"disabled"),E=W(()=>e.error||e.disabled?void 0:e.thumbColor??e.color),T=W(()=>e.error||e.disabled?void 0:e.trackColor??e.color),C=W(()=>e.error||e.disabled?void 0:e.trackFillColor??e.color),M=_t(!1),x=_t(0),V=ge(),N=ge();function D(se){var G;const ee=e.direction==="vertical",de=ee?"top":"left",Y=ee?"height":"width",te=ee?"clientY":"clientX",{[de]:he,[Y]:ae}=(G=V.value)==null?void 0:G.$el.getBoundingClientRect(),A=Jce(se,te);let I=Math.min(Math.max((A-he-x.value)/ae,0),1)||0;return(ee?u.value:u.value!==a.value)&&(I=1-I),g(h.value+I*(d.value-h.value))}const O=se=>{s({value:D(se)}),M.value=!1,x.value=0},F=se=>{N.value=o(se),N.value&&(N.value.focus(),M.value=!0,N.value.contains(se.target)?x.value=SC(se,N.value,e.direction):(x.value=0,r({value:D(se)})),n({value:D(se)}))},X={passive:!0,capture:!0};function Z(se){r({value:D(se)})}function K(se){se.stopPropagation(),se.preventDefault(),O(se),window.removeEventListener("mousemove",Z,X),window.removeEventListener("mouseup",K)}function z(se){var ee;O(se),window.removeEventListener("touchmove",Z,X),(ee=se.target)==null||ee.removeEventListener("touchend",z)}function H(se){var ee;F(se),window.addEventListener("touchmove",Z,X),(ee=se.target)==null||ee.addEventListener("touchend",z,{passive:!1})}function re(se){se.preventDefault(),F(se),window.addEventListener("mousemove",Z,X),window.addEventListener("mouseup",K,{passive:!1})}const ne=se=>{const ee=(se-h.value)/(d.value-h.value)*100;return So(isNaN(ee)?0:ee,0,100)},B=bt(e,"showTicks"),Q=W(()=>B.value?e.ticks?Array.isArray(e.ticks)?e.ticks.map(se=>({value:se,position:ne(se),label:se.toString()})):Object.keys(e.ticks).map(se=>({value:parseFloat(se),position:ne(parseFloat(se)),label:e.ticks[se]})):_.value!==1/0?eM(_.value+1).map(se=>{const ee=h.value+se*f.value;return{value:ee,position:ne(ee)}}):[]:[]),fe=W(()=>Q.value.some(se=>{let{label:ee}=se;return!!ee})),ie={activeThumbRef:N,color:bt(e,"color"),decimals:m,disabled:P,direction:bt(e,"direction"),elevation:bt(e,"elevation"),hasLabels:fe,isReversed:l,indexFromEnd:u,min:h,max:d,mousePressed:M,numTicks:_,onSliderMousedown:re,onSliderTouchstart:H,parsedTicks:Q,parseMouseMove:D,position:ne,readonly:bt(e,"readonly"),rounded:bt(e,"rounded"),roundValue:g,showTicks:B,startOffset:x,step:f,thumbSize:v,thumbColor:E,thumbLabel:bt(e,"thumbLabel"),ticks:bt(e,"ticks"),tickSize:p,trackColor:T,trackContainerRef:V,trackFillColor:C,trackSize:b,vertical:c};return jn(rA,ie),ie},Qce=We({focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0},ripple:{type:[Boolean,Object],default:!0},...Ut()},"VSliderThumb"),bC=vt()({name:"VSliderThumb",directives:{Ripple:of},props:Qce(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i,emit:n}=e;const r=xi(rA),{isRtl:s,rtlClasses:o}=io();if(!r)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:a,step:l,disabled:c,thumbSize:u,thumbLabel:h,direction:d,isReversed:f,vertical:m,readonly:g,elevation:v,mousePressed:p,decimals:b,indexFromEnd:_}=r,P=W(()=>c.value?void 0:v.value),{elevationClasses:E}=xl(P),{textColorClasses:T,textColorStyles:C}=ko(a),{pageup:M,pagedown:x,end:V,home:N,left:D,right:O,down:F,up:X}=q9,Z=[M,x,V,N,D,O,F,X],K=W(()=>l.value?[1,2,3]:[1,5,10]);function z(re,ne){if(!Z.includes(re.key))return;re.preventDefault();const B=l.value||.1,Q=(t.max-t.min)/B;if([D,O,F,X].includes(re.key)){const ie=(m.value?[s.value?D:O,f.value?F:X]:_.value!==s.value?[D,X]:[O,X]).includes(re.key)?1:-1,se=re.shiftKey?2:re.ctrlKey?1:0;ne=ne+ie*B*K.value[se]}else if(re.key===N)ne=t.min;else if(re.key===V)ne=t.max;else{const fe=re.key===x?1:-1;ne=ne-fe*B*(Q>100?Q/10:10)}return Math.max(t.min,Math.min(t.max,ne))}function H(re){const ne=z(re,t.modelValue);ne!=null&&n("update:modelValue",ne)}return Tt(()=>{const re=Lt(_.value?100-t.position:t.position,"%");return w("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":t.focused,"v-slider-thumb--pressed":t.focused&&p.value},t.class,o.value],style:[{"--v-slider-thumb-position":re,"--v-slider-thumb-size":Lt(u.value)},t.style],role:"slider",tabindex:c.value?-1:0,"aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":t.modelValue,"aria-readonly":!!g.value,"aria-orientation":d.value,onKeydown:g.value?void 0:H},[w("div",{class:["v-slider-thumb__surface",T.value,E.value],style:{...C.value}},null),fi(w("div",{class:["v-slider-thumb__ripple",T.value],style:C.value},null),[[Mo("ripple"),t.ripple,null,{circle:!0,center:!0}]]),w(pB,{origin:"bottom center"},{default:()=>{var ne;return[fi(w("div",{class:"v-slider-thumb__label-container"},[w("div",{class:["v-slider-thumb__label"]},[w("div",null,[((ne=i["thumb-label"])==null?void 0:ne.call(i,{modelValue:t.modelValue}))??t.modelValue.toFixed(l.value?b.value:1)])])]),[[ln,h.value&&t.focused||h.value==="always"]])]}})])}),{}}});const ehe=We({start:{type:Number,required:!0},stop:{type:Number,required:!0},...Ut()},"VSliderTrack"),D5=vt()({name:"VSliderTrack",props:ehe(),emits:{},setup(t,e){let{slots:i}=e;const n=xi(rA);if(!n)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:r,parsedTicks:s,rounded:o,showTicks:a,tickSize:l,trackColor:c,trackFillColor:u,trackSize:h,vertical:d,min:f,max:m,indexFromEnd:g}=n,{roundedClasses:v}=hs(o),{backgroundColorClasses:p,backgroundColorStyles:b}=Cs(u),{backgroundColorClasses:_,backgroundColorStyles:P}=Cs(c),E=W(()=>`inset-${d.value?"block":"inline"}-${g.value?"end":"start"}`),T=W(()=>d.value?"height":"width"),C=W(()=>({[E.value]:"0%",[T.value]:"100%"})),M=W(()=>t.stop-t.start),x=W(()=>({[E.value]:Lt(t.start,"%"),[T.value]:Lt(M.value,"%")})),V=W(()=>a.value?(d.value?s.value.slice().reverse():s.value).map((D,O)=>{var X;const F=D.value!==f.value&&D.value!==m.value?Lt(D.position,"%"):void 0;return w("div",{key:D.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":D.position>=t.start&&D.position<=t.stop,"v-slider-track__tick--first":D.value===f.value,"v-slider-track__tick--last":D.value===m.value}],style:{[E.value]:F}},[(D.label||i["tick-label"])&&w("div",{class:"v-slider-track__tick-label"},[((X=i["tick-label"])==null?void 0:X.call(i,{tick:D,index:O}))??D.label])])}):[]);return Tt(()=>w("div",{class:["v-slider-track",v.value,t.class],style:[{"--v-slider-track-size":Lt(h.value),"--v-slider-tick-size":Lt(l.value)},t.style]},[w("div",{class:["v-slider-track__background",_.value,{"v-slider-track__background--opacity":!!r.value||!u.value}],style:{...C.value,...P.value}},null),w("div",{class:["v-slider-track__fill",p.value],style:{...x.value,...b.value}},null),a.value&&w("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":a.value==="always"}]},[V.value])])),{}}}),the=We({...FP(),...L5(),...df(),modelValue:{type:[Number,String],default:0}},"VSlider"),hp=vt()({name:"VSlider",props:the(),emits:{"update:focused":t=>!0,"update:modelValue":t=>!0,start:t=>!0,end:t=>!0},setup(t,e){let{slots:i,emit:n}=e;const r=ge(),{rtlClasses:s}=io(),o=I5(t),a=Oi(t,"modelValue",void 0,T=>o.roundValue(T??o.min.value)),{min:l,max:c,mousePressed:u,roundValue:h,onSliderMousedown:d,onSliderTouchstart:f,trackContainerRef:m,position:g,hasLabels:v,readonly:p}=O5({props:t,steps:o,onSliderStart:()=>{n("start",a.value)},onSliderEnd:T=>{let{value:C}=T;const M=h(C);a.value=M,n("end",M)},onSliderMove:T=>{let{value:C}=T;return a.value=h(C)},getActiveThumb:()=>{var T;return(T=r.value)==null?void 0:T.$el}}),{isFocused:b,focus:_,blur:P}=uf(t),E=W(()=>g(a.value));return Tt(()=>{const T=za.filterProps(t),C=!!(t.label||i.label||i.prepend);return w(za,ht({class:["v-slider",{"v-slider--has-labels":!!i["tick-label"]||v.value,"v-slider--focused":b.value,"v-slider--pressed":u.value,"v-slider--disabled":t.disabled},s.value,t.class],style:t.style},T,{focused:b.value}),{...i,prepend:C?M=>{var x,V;return w(mt,null,[((x=i.label)==null?void 0:x.call(i,M))??(t.label?w(RP,{id:M.id.value,class:"v-slider__label",text:t.label},null):void 0),(V=i.prepend)==null?void 0:V.call(i,M)])}:void 0,default:M=>{let{id:x,messagesId:V}=M;return w("div",{class:"v-slider__container",onMousedown:p.value?void 0:d,onTouchstartPassive:p.value?void 0:f},[w("input",{id:x.value,name:t.name||x.value,disabled:!!t.disabled,readonly:!!t.readonly,tabindex:"-1",value:a.value},null),w(D5,{ref:m,start:0,stop:E.value},{"tick-label":i["tick-label"]}),w(bC,{ref:r,"aria-describedby":V.value,focused:b.value,min:l.value,max:c.value,modelValue:a.value,"onUpdate:modelValue":N=>a.value=N,position:E.value,elevation:t.elevation,onFocus:_,onBlur:P,ripple:t.ripple},{"thumb-label":i["thumb-label"]})])}})}),{}}}),ihe={id:"dataEntry"},nhe={id:"action"},rhe=ri({__name:"SliderForm",setup(t){const e=ge(0),i=ge(1),n=ge(.1),r=ge(0),s=ge(!1);function o(){const l=new JM({min:e.value,max:i.value,step:n.value,value:r.value});new jP(l).execute()}function a(){(i.value-e.value)/n.value>25&&(n.value=(i.value-e.value)/25)}return He(()=>e.value,l=>{l>i.value||n.value===0||a()}),He(()=>i.value,l=>{l<e.value||n.value===0||a()}),(l,c)=>(Te(),qe(V5,{modelValue:s.value,"onUpdate:modelValue":c[4]||(c[4]=u=>s.value=u)},{default:U(()=>[tt("div",ihe,[w(vr,{id:"_test_input_min",label:l.$t("objectTree.min"),class:"field _test_input",variant:"outlined",density:"compact",modelValue:e.value,"onUpdate:modelValue":c[0]||(c[0]=u=>e.value=u),modelModifiers:{number:!0},error:e.value>i.value},null,8,["label","modelValue","error"]),w(vr,{id:"_test_input_step",label:l.$t("objectTree.step"),class:"field _test_input",variant:"outlined",density:"compact",modelValue:n.value,"onUpdate:modelValue":c[1]||(c[1]=u=>n.value=u),modelModifiers:{number:!0},error:n.value>i.value-e.value},null,8,["label","modelValue","error"]),w(vr,{id:"_test_input_max",label:l.$t("objectTree.max"),class:"field _test_input",variant:"outlined",density:"compact",modelValue:i.value,"onUpdate:modelValue":c[2]||(c[2]=u=>i.value=u),modelModifiers:{number:!0},error:i.value<e.value},null,8,["label","modelValue","error"])]),w(hp,{id:"_test_slider",modelValue:r.value,"onUpdate:modelValue":c[3]||(c[3]=u=>r.value=u),min:e.value,max:i.value,step:n.value,"thumb-label":"always","background-color":"accent lighten-2","show-ticks":"always","tick-size":"4"},null,8,["modelValue","min","max","step"]),w(ch),tt("div",nhe,[w(Qt,{id:"_test_add_slider",color:"primary",text:"",disabled:!s.value,onClick:o},{default:U(()=>[$e(nt(l.$t("objectTree.create")),1)],void 0,!0),_:1},8,["disabled"])])],void 0),_:1},8,["modelValue"]))}});const she=Tn(rhe,[["__scopeId","data-v-b1feec2f"]]),ohe={id:"topContainer"},ahe={class:"body-1 font-weight-bold button-group-heading"},lhe={class:"body-1 font-weight-bold button-group-heading"},che={class:"body-1 font-weight-bold button-group-heading"},hhe={class:"ma-2 pa-1",id:"objectTreeContainer"},uhe=ri({__name:"ObjectTree",setup(t){const e=An(),{sePoints:i,seLines:n,seSegments:r,seCircles:s,seEllipses:o,seParametrics:a,seNodules:l,expressions:c,actionMode:u,seTransformations:h}=Ji(e);let d=!0;const f=ge(0),m=W(()=>l.value.filter(p=>p.exists).length===0&&c.value.length===0);to(()=>{$.listen("update-points-user-created",g)});function g(){f.value=f.value-1}an(()=>{$.unlisten("update-points-user-created")});const v=W(()=>{if((u.value==="measuredCircle"||u.value==="translation"||u.value==="rotation")&&c.value.length===0&&d)switch(d=!1,u.value){case"measuredCircle":$.fire("show-alert",{key:"objectTree.createMeasurementForMeasuredCircle",type:"info"});break;case"translation":$.fire("show-alert",{key:"objectTree.createMeasurementForTranslation",type:"info"});break;case"rotation":$.fire("show-alert",{key:"objectTree.createMeasurementForRotation",type:"info"});break}return(u.value==="measuredCircle"||u.value==="translation"||u.value==="rotation")&&c.value.length>0&&(d=!0),c.value.length>0});return(p,b)=>(Te(),Ct("div",null,[tt("div",ohe,[w(ul,{style:{gap:"10px","padding-right":"8px"}},{default:U(()=>[w(ul,null,{default:U(()=>[w(nh,{style:{"border-radius":"8px"}},{default:U(()=>[w(cc,{color:"accent"},{default:U(()=>[tt("h3",ahe,nt(p.$t("objectTree.expression")),1)],void 0,!0),_:1}),w(gl,null,{default:U(()=>[w(Nce)],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),w(ul,null,{default:U(()=>[w(nh,{style:{"border-radius":"8px"}},{default:U(()=>[w(cc,{color:"accent"},{default:U(()=>[tt("h3",lhe,nt(p.$t("objectTree.parametricCurves")),1)],void 0,!0),_:1}),w(gl,null,{default:U(()=>[w(Yce)],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),w(ul,null,{default:U(()=>[w(nh,{style:{"border-radius":"8px","padding-right":"8px"}},{default:U(()=>[w(cc,{color:"accent"},{default:U(()=>[tt("h3",che,nt(p.$t("objectTree.slider")),1)],void 0,!0),_:1}),w(gl,null,{default:U(()=>[w(she)],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1}),tt("div",hhe,[fi((Te(),qe(mo,{rounded:"",color:"accent",elevation:4,key:f.value,class:"my-3"},{default:U(()=>[w(Uh,{i18LabelKey:"objects.points",children:le(i)},null,8,["children"])],void 0),_:1})),[[ln,le(i).filter(_=>_ instanceof le(Le)||_ instanceof le(ut)?_.isUserCreated&&_.exists:_.exists).length>0]]),fi(w(mo,{rounded:"",color:"accent",elevation:4,class:"my-3"},{default:U(()=>[w(Uh,{i18LabelKey:"objects.lines",children:le(n)},null,8,["children"])],void 0),_:1},512),[[ln,le(n).length>0]]),fi(w(mo,{rounded:"",color:"accent",elevation:4,class:"my-3"},{default:U(()=>[w(Uh,{i18LabelKey:"objects.segments",children:le(r)},null,8,["children"])],void 0),_:1},512),[[ln,le(r).length>0]]),fi(w(mo,{rounded:"",color:"accent",elevation:4,class:"my-3"},{default:U(()=>[w(Uh,{i18LabelKey:"objects.circles",children:le(s)},null,8,["children"])],void 0),_:1},512),[[ln,le(s).length>0]]),fi(w(mo,{rounded:"",color:"accent",elevation:4,class:"my-3"},{default:U(()=>[w(Uh,{i18LabelKey:"objects.ellipses",children:le(o)},null,8,["children"])],void 0),_:1},512),[[ln,le(o).length>0]]),fi(w(mo,{rounded:"",color:"accent",elevation:4,class:"my-3"},{default:U(()=>[w(Uh,{i18LabelKey:"objects.parametrics",children:le(a)},null,8,["children"])],void 0),_:1},512),[[ln,le(a).length>0]]),fi(w(mo,{rounded:"",color:"accent",elevation:4,class:"my-3"},{default:U(()=>[w(Uh,{i18LabelKey:"objects.transformations",children:le(h)},null,8,["children"])],void 0),_:1},512),[[ln,le(h).length>0]]),fi(w(mo,{rounded:"",color:"accent",elevation:4,class:"my-3"},{default:U(()=>[w(Uh,{i18LabelKey:"objects.measurements",children:le(c)},null,8,["children"])],void 0),_:1},512),[[ln,v.value]]),fi(tt("span",{class:"text-body-2 ma-2"},nt(p.$t("objectTree.noObjectsInDatabase")),513),[[ln,m.value]])])])]))}});const dhe=Tn(uhe,[["__scopeId","data-v-52c990a9"]]);class Kp extends L{constructor(i,n,r,s){super();y(this,"seCircle");y(this,"centerSEPoint");y(this,"circleSEPoint");y(this,"seLabel");this.seCircle=i,this.centerSEPoint=n,this.circleSEPoint=r,this.seLabel=s}do(){this.centerSEPoint.registerChild(this.seCircle),this.circleSEPoint.registerChild(this.seCircle),this.seCircle.registerChild(this.seLabel),L.store.addCircle(this.seCircle),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seCircle.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeCircle(this.lastState),this.seCircle.unregisterChild(this.seLabel),this.centerSEPoint.unregisterChild(this.seCircle),this.circleSEPoint.unregisterChild(this.seCircle)}toOpcode(){return["AddCircle","objectName="+L.symbolToASCIIDec(this.seCircle.name),"objectExists="+this.seCircle.exists,"objectShowing="+this.seCircle.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seCircle.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seCircle.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"circleCenterPointName="+this.centerSEPoint.name,"circlePointOnCircleName="+this.circleSEPoint.name].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("circleCenterPointName")??""),a=n.get(s.get("circlePointOnCircleName")??"");if(o&&a){const l=new Kt(o,a,!1),c=s.get("objectFrontStyle");c!==void 0&&l.updatePlottableStyle(q.Front,JSON.parse(c));const u=s.get("objectBackStyle");u!==void 0&&l.updatePlottableStyle(q.Back,JSON.parse(u));const h=new De("circle",l),d=new k;d.from(s.get("labelVector")),h.locationVector.copy(d);const f=s.get("labelStyle");if(f!==void 0&&h.updatePlottableStyle(q.Label,JSON.parse(f)),s.get("objectName")!==void 0)l.name=s.get("objectName")??"",l.showing=s.get("objectShowing")==="true",l.exists=s.get("objectExists")==="true",n.set(l.name,l);else throw new Error("AddCircle: Circle Name doesn't exist");if(s.get("labelName")!==void 0)h.name=s.get("labelName")??"",h.showing=s.get("labelShowing")==="true",h.exists=s.get("labelExists")==="true",n.set(h.name,h);else throw new Error("AddCircle: Label Name doesn't exist");return new Kp(l,o,a,h)}throw new Error(`AddCircle: ${o} or ${a} is undefined`)}}class $P extends L{constructor(i,n,r,s){super();y(this,"seLine");y(this,"startSEPoint");y(this,"endSEPoint");y(this,"seLabel");this.seLine=i,this.startSEPoint=n,this.endSEPoint=r,this.seLabel=s}do(){this.startSEPoint.registerChild(this.seLine),this.endSEPoint.registerChild(this.seLine),this.seLine.registerChild(this.seLabel),L.store.addLine(this.seLine),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seLine.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeLine(this.lastState),this.seLabel.unregisterChild(this.seLabel),this.startSEPoint.unregisterChild(this.seLine),this.endSEPoint.unregisterChild(this.seLine)}toOpcode(){return["AddLine","objectName="+L.symbolToASCIIDec(this.seLine.name),"objectExists="+this.seLine.exists,"objectShowing="+this.seLine.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLine.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLine.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"lineNormalVector="+this.seLine.normalVector.toFixed(9),"lineStartPointName="+this.startSEPoint.name,"lineEndPointName="+this.endSEPoint.name].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((c,u)=>{if(u===0)return;const h=c.split("=");s.set(h[0],L.asciiDecToSymbol(h[1]))});const o=n.get(s.get("lineStartPointName")??""),a=n.get(s.get("lineEndPointName")??""),l=new k;if(l.from(s.get("lineNormalVector")),a&&o&&l.z!==1){const c=new $t(o,l,a),u=s.get("objectFrontStyle");u!==void 0&&c.updatePlottableStyle(q.Front,JSON.parse(u));const h=s.get("objectBackStyle");h!==void 0&&c.updatePlottableStyle(q.Back,JSON.parse(h));const d=new De("line",c),f=new k;f.from(s.get("labelVector")),d.locationVector.copy(f);const m=s.get("labelStyle");if(m!==void 0&&d.updatePlottableStyle(q.Label,JSON.parse(m)),s.get("objectName")!==void 0)c.name=s.get("objectName")??"",c.showing=s.get("objectShowing")==="true",c.exists=s.get("objectExists")==="true",n.set(c.name,c);else throw new Error("AddLine: Line Name doesn't exist");if(s.get("labelName")!==void 0)d.name=s.get("labelName")??"",d.showing=s.get("labelShowing")==="true",d.exists=s.get("labelExists")==="true",n.set(d.name,d);else throw new Error("AddLine: Label Name doesn't exist");return new $P(c,o,a,d)}throw new Error(`AddLine: ${a}, ${o},or ${l}  is undefined`)}}class WP extends L{constructor(i,n,r,s){super();y(this,"sePerpendicularLineThruPoint");y(this,"parentSEPoint");y(this,"parentOneDimensional");y(this,"seLabel");this.sePerpendicularLineThruPoint=i,this.parentSEPoint=n,this.parentOneDimensional=r,this.seLabel=s}do(){this.parentSEPoint.registerChild(this.sePerpendicularLineThruPoint),this.parentOneDimensional.registerChild(this.sePerpendicularLineThruPoint),this.sePerpendicularLineThruPoint.registerChild(this.seLabel),L.store.addLine(this.sePerpendicularLineThruPoint),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.sePerpendicularLineThruPoint.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeLine(this.lastState),this.sePerpendicularLineThruPoint.unregisterChild(this.seLabel),this.parentOneDimensional.unregisterChild(this.sePerpendicularLineThruPoint),this.parentSEPoint.unregisterChild(this.sePerpendicularLineThruPoint)}toOpcode(){return["AddPerpendicularLineThruPoint","objectName="+L.symbolToASCIIDec(this.sePerpendicularLineThruPoint.name),"objectExists="+this.sePerpendicularLineThruPoint.exists,"objectShowing="+this.sePerpendicularLineThruPoint.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePerpendicularLineThruPoint.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePerpendicularLineThruPoint.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"perpendicularLineThruPointParentPointName="+this.parentSEPoint.name,"perpendicularLineThruPointNormalVector="+this.sePerpendicularLineThruPoint.normalVector.toFixed(9),"perpendicularLineThruPointEndSEPointLocationVector="+this.sePerpendicularLineThruPoint.endSEPoint.locationVector.toFixed(9),"perpendicularLineThruPointParentOneDimensionalName="+this.parentOneDimensional.name,"perpendicularLineThruPointIndex="+this.sePerpendicularLineThruPoint.index].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((h,d)=>{if(d===0)return;const f=h.split("=");s.set(f[0],L.asciiDecToSymbol(f[1]))});const o=n.get(s.get("perpendicularLineThruPointParentOneDimensionalName")??""),a=n.get(s.get("perpendicularLineThruPointParentPointName")??""),l=new k;l.from(s.get("perpendicularLineThruPointEndSEPointLocationVector"));const c=new k;c.from(s.get("perpendicularLineThruPointNormalVector"));const u=Number(s.get("perpendicularLineThruPointIndex"));if(a&&o&&c.z!==1&&l.z!==1&&!isNaN(u)){const h=new Ze;h.locationVector=l,h.exists=!0,h.showing=!1;const d=new OP(o,a,c,h,u),f=s.get("objectFrontStyle");f!==void 0&&d.updatePlottableStyle(q.Front,JSON.parse(f));const m=s.get("objectBackStyle");m!==void 0&&d.updatePlottableStyle(q.Back,JSON.parse(m));const g=new De("line",d),v=new k;v.from(s.get("labelVector")),g.locationVector.copy(v);const p=s.get("labelStyle");if(p!==void 0&&g.updatePlottableStyle(q.Label,JSON.parse(p)),s.get("objectName")!==void 0)d.name=s.get("objectName")??"",d.showing=s.get("objectShowing")==="true",d.exists=s.get("objectExists")==="true",n.set(d.name,d);else throw new Error("AddPerpendicularLineThruPoint: Perpendicular Line Name doesn't exist");if(s.get("labelName")!==void 0)g.name=s.get("labelName")??"",g.showing=s.get("labelShowing")==="true",g.exists=s.get("labelExists")==="true",n.set(g.name,g);else throw new Error("AddPerpendicularLineThruPoint: Label Name doesn't exist");return new WP(d,a,o,g)}throw new Error(`AddPerpendicularLineThruPoint: ${a}, ${o}, ${u}, ${c}, or ${l}  is undefined`)}}class Mn extends L{constructor(i,n,r){super();y(this,"sePoint");y(this,"seLabel");y(this,"useVisiblePointCountToRename");this.sePoint=i,this.seLabel=n,r!==void 0?this.useVisiblePointCountToRename=r:this.useVisiblePointCountToRename=!0}do(){L.store.addLabel(this.seLabel),this.sePoint.registerChild(this.seLabel),L.store.addPoint(this.sePoint),this.sePoint.pointVisibleBefore=!0,this.sePoint.incrementVisiblePointCount(),this.sePoint.label&&this.useVisiblePointCountToRename&&(this.sePoint.label.ref.shortUserName=`P${this.sePoint.visiblePointCount}`)}saveState(){this.lastState=this.sePoint.id}restoreState(){this.sePoint.decrementVisiblePointCount(),this.sePoint.label&&this.useVisiblePointCountToRename&&(this.sePoint.label.ref.shortUserName=`P${this.sePoint.visiblePointCount}`),this.sePoint.pointVisibleBefore=!1,L.store.removeLabel(this.seLabel.id),this.sePoint.unregisterChild(this.seLabel),L.store.removePoint(this.lastState)}toOpcode(){return["AddPoint","objectName="+L.symbolToASCIIDec(this.sePoint.name),"objectExists="+this.sePoint.exists,"objectShowing="+this.sePoint.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePoint.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePoint.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"pointVector="+this.sePoint.locationVector.toFixed(9)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((f,m)=>{if(m===0)return;const g=f.split("=");s.set(g[0],L.asciiDecToSymbol(g[1]))});const o=new k;o.from(s.get("pointVector"));const a=s.get("objectFrontStyle"),l=s.get("objectBackStyle"),c=new Ze;c.locationVector.copy(o),a!==void 0&&c.updatePlottableStyle(q.Front,JSON.parse(a)),l!==void 0&&c.updatePlottableStyle(q.Back,JSON.parse(l));const u=new De("point",c),h=new k;h.from(s.get("labelVector")),u.locationVector.copy(h);const d=s.get("labelStyle");if(d!==void 0&&u.updatePlottableStyle(q.Label,JSON.parse(d)),s.get("objectName")!==void 0)c.name=s.get("objectName")??"",c.showing=s.get("objectShowing")==="true",c.exists=s.get("objectExists")==="true",n.set(c.name,c);else throw new Error("AddPoint: Point Name doesn't exist");if(s.get("labelName")!==void 0)u.name=s.get("labelName")??"",u.showing=s.get("labelShowing")==="true",u.exists=s.get("labelExists")==="true",n.set(u.name,u);else throw new Error("AddPoint: Label Name doesn't exist");return new Mn(c,u,!1)}}class up extends L{constructor(i,n,r){super();y(this,"seEarthPoint");y(this,"seLabel");y(this,"useVisiblePointCountToRename");y(this,"latitude");y(this,"longitude");this.seEarthPoint=i,this.latitude=this.seEarthPoint.latitude,this.longitude=this.seEarthPoint.longitude,this.seLabel=n,r!==void 0?this.useVisiblePointCountToRename=r:this.useVisiblePointCountToRename=!0}do(){L.store.addLabel(this.seLabel),this.seEarthPoint.registerChild(this.seLabel),L.store.addPoint(this.seEarthPoint),this.seEarthPoint.pointVisibleBefore=!0,this.seEarthPoint.incrementVisiblePointCount(),this.seEarthPoint.label&&this.useVisiblePointCountToRename&&(this.seEarthPoint.label.ref.shortUserName=`P${this.seEarthPoint.visiblePointCount}`)}saveState(){this.lastState=this.seEarthPoint.id}restoreState(){this.seEarthPoint.decrementVisiblePointCount(),this.seEarthPoint.label&&this.useVisiblePointCountToRename&&(this.seEarthPoint.label.ref.shortUserName=`P${this.seEarthPoint.visiblePointCount}`),this.seEarthPoint.pointVisibleBefore=!1,L.store.removeLabel(this.seLabel.id),this.seEarthPoint.unregisterChild(this.seLabel),L.store.removePoint(this.lastState)}toOpcode(){return["AddEarthPoint","objectName="+L.symbolToASCIIDec(this.seEarthPoint.name),"objectExists="+this.seEarthPoint.exists,"objectShowing="+this.seEarthPoint.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seEarthPoint.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seEarthPoint.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"pointVector="+this.seEarthPoint.locationVector.toFixed(9),"earthLatitude="+this.seEarthPoint.latitude.toFixed(9),"earthLongitude="+this.seEarthPoint.longitude.toFixed(9)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((h,d)=>{if(d===0)return;const f=h.split("=");s.set(f[0],L.asciiDecToSymbol(f[1]))});const o=new k;o.from(s.get("pointVector"));const a=s.get("objectFrontStyle"),l=s.get("objectBackStyle"),c=Number(s.get("earthLatitude")),u=Number(s.get("earthLongitude"));if(c!==void 0&&u!==void 0){const h=new Xc(u,c);h.locationVector.copy(o),a!==void 0&&h.updatePlottableStyle(q.Front,JSON.parse(a)),l!==void 0&&h.updatePlottableStyle(q.Back,JSON.parse(l));const d=new De("point",h),f=new k;f.from(s.get("labelVector")),d.locationVector.copy(f);const m=s.get("labelStyle");if(m!==void 0&&d.updatePlottableStyle(q.Label,JSON.parse(m)),s.get("objectName")!==void 0)h.name=s.get("objectName")??"",h.showing=s.get("objectShowing")==="true",h.exists=s.get("objectExists")==="true",n.set(h.name,h);else throw new Error("AddPoint: Point Name doesn't exist");if(s.get("labelName")!==void 0)d.name=s.get("labelName")??"",d.showing=s.get("labelShowing")==="true",d.exists=s.get("labelExists")==="true",n.set(d.name,d);else throw new Error("AddPoint: Label Name doesn't exist");return new up(h,d,!1)}else throw new Error("Earth Point Latitude or Longitude undefined")}}class zt extends L{constructor(i,n,r,s){super();y(this,"sePointOnOneOrTwoDimensional");y(this,"parent");y(this,"seLabel");y(this,"useVisiblePointCountToRename");this.sePointOnOneOrTwoDimensional=i,this.parent=n,this.seLabel=r,s!==void 0?this.useVisiblePointCountToRename=s:this.useVisiblePointCountToRename=!0}do(){this.parent.registerChild(this.sePointOnOneOrTwoDimensional),this.sePointOnOneOrTwoDimensional.registerChild(this.seLabel),this.seLabel.showing=!1,L.store.addPoint(this.sePointOnOneOrTwoDimensional),L.store.addLabel(this.seLabel),this.sePointOnOneOrTwoDimensional.pointVisibleBefore=!0,this.sePointOnOneOrTwoDimensional.label&&this.useVisiblePointCountToRename&&(this.sePointOnOneOrTwoDimensional.incrementVisiblePointCount(),this.sePointOnOneOrTwoDimensional.label.ref.shortUserName=`P${this.sePointOnOneOrTwoDimensional.visiblePointCount}`)}saveState(){this.lastState=this.sePointOnOneOrTwoDimensional.id}restoreState(){this.sePointOnOneOrTwoDimensional.label&&this.useVisiblePointCountToRename&&(this.sePointOnOneOrTwoDimensional.decrementVisiblePointCount(),this.sePointOnOneOrTwoDimensional.label.ref.shortUserName=`P${this.sePointOnOneOrTwoDimensional.visiblePointCount}`),this.sePointOnOneOrTwoDimensional.pointVisibleBefore=!1,L.store.removeLabel(this.seLabel.id),L.store.removePoint(this.lastState),this.sePointOnOneOrTwoDimensional.unregisterChild(this.seLabel),this.parent.unregisterChild(this.sePointOnOneOrTwoDimensional)}toOpcode(){return["AddPointOnOneDimensional","objectName="+L.symbolToASCIIDec(this.sePointOnOneOrTwoDimensional.name),"objectExists="+this.sePointOnOneOrTwoDimensional.exists,"objectShowing="+this.sePointOnOneOrTwoDimensional.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePointOnOneOrTwoDimensional.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePointOnOneOrTwoDimensional.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"pointOnOneOrTwoDimensionalParentName="+this.parent.name,"pointOnOneOrTwoDimensionalVector="+this.sePointOnOneOrTwoDimensional.locationVector.toFixed(9)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("pointOnOneOrTwoDimensionalParentName")??""),a=new k;if(a.from(s.get("pointOnOneOrTwoDimensionalVector")),o&&a.z!==1){const l=new kt(o);l.pointDirectLocationSetter(a);const c=s.get("objectFrontStyle");c!==void 0&&l.updatePlottableStyle(q.Front,JSON.parse(c));const u=s.get("objectBackStyle");u!==void 0&&l.updatePlottableStyle(q.Back,JSON.parse(u));const h=new De("point",l),d=new k;d.from(s.get("labelVector")),h.locationVector.copy(d);const f=s.get("labelStyle");if(f!==void 0&&h.updatePlottableStyle(q.Label,JSON.parse(f)),s.get("objectName")!==void 0)l.name=s.get("objectName")??"",l.showing=s.get("objectShowing")==="true",l.exists=s.get("objectExists")==="true",n.set(l.name,l);else throw new Error("AddPointOnOneOrTwoDimensionalCommand:  Point name doesn't exist");if(s.get("labelName")!==void 0)h.name=s.get("labelName")??"",h.showing=s.get("labelShowing")==="true",h.exists=s.get("labelExists")==="true",n.set(h.name,h);else throw new Error("AddPointOnOneOrTwoDimensionalCommand: Label Name doesn't exist");return new zt(l,o,h,!1)}throw new Error(`AddPointOnOneOrTwoDimensional: ${o} or ${a} is undefined`)}}class Yy extends L{constructor(i,n,r,s){super();y(this,"seSegment");y(this,"startSEPoint");y(this,"endSEPoint");y(this,"seLabel");this.seSegment=i,this.startSEPoint=n,this.endSEPoint=r,this.seLabel=s}do(){this.startSEPoint.registerChild(this.seSegment),this.endSEPoint.registerChild(this.seSegment),this.seSegment.registerChild(this.seLabel),L.store.addSegment(this.seSegment),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seSegment.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeSegment(this.lastState),this.seSegment.unregisterChild(this.seLabel),this.startSEPoint.unregisterChild(this.seSegment),this.endSEPoint.unregisterChild(this.seSegment)}toOpcode(){return["AddSegment","objectName="+L.symbolToASCIIDec(this.seSegment.name),"objectExists="+this.seSegment.exists,"objectShowing="+this.seSegment.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seSegment.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seSegment.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"segmentNormalVector="+this.seSegment.normalVector.toFixed(9),"segmentArcLength="+this.seSegment.arcLength,"segmentStartPointName="+this.startSEPoint.name,"segmentEndPointName="+this.endSEPoint.name].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((u,h)=>{if(h===0)return;const d=u.split("=");s.set(d[0],L.asciiDecToSymbol(d[1]))});const o=n.get(s.get("segmentStartPointName")??""),a=n.get(s.get("segmentEndPointName")??""),l=new k;l.from(s.get("segmentNormalVector"));const c=Number(s.get("segmentArcLength"));if(a&&o&&l.z!==1&&!isNaN(c)){const u=new Jt(o,l,c,a),h=s.get("objectFrontStyle");h!==void 0&&u.updatePlottableStyle(q.Front,JSON.parse(h));const d=s.get("objectBackStyle");d!==void 0&&u.updatePlottableStyle(q.Back,JSON.parse(d));const f=new De("segment",u),m=new k;m.from(s.get("labelVector")),f.locationVector.copy(m);const g=s.get("labelStyle");if(g!==void 0&&f.updatePlottableStyle(q.Label,JSON.parse(g)),s.get("objectName")!==void 0)u.name=s.get("objectName")??"",u.showing=s.get("objectShowing")==="true",u.exists=s.get("objectExists")==="true",n.set(u.name,u);else throw new Error("AddSegment: Segment Name doesn't exist");if(s.get("labelName")!==void 0)f.name=s.get("labelName")??"",f.showing=s.get("labelShowing")==="true",f.exists=s.get("labelExists")==="true",n.set(f.name,f);else throw new Error("AddSegment: Label Name doesn't exist");return new Yy(u,o,a,f)}throw new Error(`AddSegment: ${a}, ${o}, ${c}, or ${l}  is undefined`)}}class Fc extends Xy{constructor(i,n,r){super(i,[n]);y(this,"selector");this.selector=r}toOpcode(){return["AddPointCoordinateMeasurement","objectName="+L.symbolToASCIIDec(this.seExpression.name),"objectExists="+this.seExpression.exists,"objectShowing="+this.seExpression.showing,"locationMeasurementParentPointName="+L.symbolToASCIIDec(this.parents[0].name),"locationMeasurementSelector="+this.selector].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("locationMeasurementParentPointName")??""),a=Number(s.get("locationMeasurementSelector"));if(o&&!isNaN(a)){const l=new ma(o,a);if(s.get("objectName")!==void 0)l.name=s.get("objectName")??"",l.showing=s.get("objectShowing")==="true",l.exists=s.get("objectExists")==="true",n.set(l.name,l);else throw new Error("AddPointCoordinateMeasurementCommand:  location measure name doesn't exist");return new Fc(l,o,a)}throw new Error(`AddPointCoordinateMeasurementCommand: ${o} is undefined`)}}class ff extends Xy{toOpcode(){return["AddPointDistanceMeasurement","objectName="+L.symbolToASCIIDec(this.seExpression.name),"objectExists="+this.seExpression.exists,"objectShowing="+this.seExpression.showing,"distanceMeasurementParentPoint1Name="+L.symbolToASCIIDec(this.parents[0].name),"distanceMeasurementParentPoint2Name="+L.symbolToASCIIDec(this.parents[1].name),"valueDisplayMode="+this.seExpression.valueDisplayMode].join("&")}static parse(e,i){const n=e.split("&"),r=new Map;n.forEach((l,c)=>{if(c===0)return;const u=l.split("=");r.set(u[0],L.asciiDecToSymbol(u[1]))});const s=i.get(r.get("distanceMeasurementParentPoint1Name")??""),o=i.get(r.get("distanceMeasurementParentPoint2Name")??""),a=Number(r.get("valueDisplayMode"));if(s&&o&&typeof a=="number"){const l=new Sl(s,o);if(l.valueDisplayMode=a,r.get("objectName")!==void 0)l.name=r.get("objectName")??"",l.showing=r.get("objectShowing")==="true",l.exists=r.get("objectExists")==="true",i.set(l.name,l);else throw new Error("AddPointDistanceMeasurementCommand: Point distance name doesn't exist");return new ff(l,[s,o])}throw new Error(`AddPointDistanceMeasurementCommand: Parent point 1 ${s} or parent point 2 ${o} doesn't exist`)}}class Fu extends Xy{constructor(e,i){super(e,[i])}toOpcode(){return["AddLengthMeasurement","objectName="+L.symbolToASCIIDec(this.seExpression.name),"objectExists="+this.seExpression.exists,"objectShowing="+this.seExpression.showing,"lengthMeasurementSegmentParentName="+L.symbolToASCIIDec(this.parents[0].name),"valueDisplayMode="+this.seExpression.valueDisplayMode].join("&")}static parse(e,i){const n=e.split("&"),r=new Map;n.forEach((a,l)=>{if(l===0)return;const c=a.split("=");r.set(c[0],L.asciiDecToSymbol(c[1]))});const s=i.get(r.get("lengthMeasurementSegmentParentName")??""),o=Number(r.get("valueDisplayMode"));if(s&&typeof o=="number"){const a=new ws(s);if(a.valueDisplayMode=o,r.get("objectName")!==void 0)a.name=r.get("objectName")??"",a.showing=r.get("objectShowing")==="true",a.exists=r.get("objectExists")==="true",i.set(a.name,a);else throw new Error("AddLengthMeasureCommand:  length measure name doesn't exist");return new Fu(a,s)}throw new Error(`AddLengthMeasurementCommand: ${s} is undefined`)}}class GP extends L{constructor(i,n,r,s,o){super();y(this,"seEllipse");y(this,"focus1SEPoint");y(this,"focus2SEPoint");y(this,"ellipseSEPoint");y(this,"seLabel");this.seEllipse=i,this.focus1SEPoint=n,this.focus2SEPoint=r,this.ellipseSEPoint=s,this.seLabel=o}do(){this.focus1SEPoint.registerChild(this.seEllipse),this.focus2SEPoint.registerChild(this.seEllipse),this.ellipseSEPoint.registerChild(this.seEllipse),this.seEllipse.registerChild(this.seLabel),L.store.addEllipse(this.seEllipse),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seEllipse.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeEllipse(this.lastState),this.seEllipse.unregisterChild(this.seLabel),this.ellipseSEPoint.unregisterChild(this.seEllipse),this.focus2SEPoint.unregisterChild(this.seEllipse),this.focus1SEPoint.unregisterChild(this.seEllipse)}toOpcode(){return["AddEllipse","objectName="+L.symbolToASCIIDec(this.seEllipse.name),"objectExists="+this.seEllipse.exists,"objectShowing="+this.seEllipse.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seEllipse.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seEllipse.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"ellipseFocus1Name="+L.symbolToASCIIDec(this.focus1SEPoint.name),"ellipseFocus2Name="+L.symbolToASCIIDec(this.focus2SEPoint.name),"ellipsePointOnEllipseName="+L.symbolToASCIIDec(this.ellipseSEPoint.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((c,u)=>{if(u===0)return;const h=c.split("=");s.set(h[0],L.asciiDecToSymbol(h[1]))});const o=n.get(s.get("ellipseFocus1Name")??""),a=n.get(s.get("ellipseFocus2Name")??""),l=n.get(s.get("ellipsePointOnEllipseName")??"");if(o&&a&&l){const c=new Ii(o,a,l,!1),u=s.get("objectFrontStyle");u!==void 0&&c.updatePlottableStyle(q.Front,JSON.parse(u));const h=s.get("objectBackStyle");h!==void 0&&c.updatePlottableStyle(q.Back,JSON.parse(h));const d=new De("ellipse",c),f=new k;f.from(s.get("labelVector")),d.locationVector.copy(f);const m=s.get("labelStyle");if(m!==void 0&&d.updatePlottableStyle(q.Label,JSON.parse(m)),s.get("objectName")!==void 0)c.name=s.get("objectName")??"",c.showing=s.get("objectShowing")==="true",c.exists=s.get("objectExists")==="true",n.set(c.name,c);else throw new Error("AddEllipse: Ellipse Name doesn't exist");if(s.get("labelName")!==void 0)d.name=s.get("labelName")??"",d.showing=s.get("labelShowing")==="true",d.exists=s.get("labelExists")==="true",n.set(d.name,d);else throw new Error("AddEllipse: Label Name doesn't exist");return new GP(c,o,a,l,d)}throw new Error(`AddEllipse: ${o}, ${a},or ${l}  is undefined`)}}class Yv extends L{constructor(i,n,r,s,o){super();y(this,"sePolarPoint");y(this,"index");y(this,"parent");y(this,"seLabel");y(this,"useVisiblePointCountToRename");this.sePolarPoint=i,this.parent=r,this.seLabel=s,this.index=n,o!==void 0?this.useVisiblePointCountToRename=o:this.useVisiblePointCountToRename=!0}do(){this.parent.registerChild(this.sePolarPoint),this.sePolarPoint.registerChild(this.seLabel),this.seLabel.showing=!1,L.store.addPoint(this.sePolarPoint),L.store.addLabel(this.seLabel),this.sePolarPoint.pointVisibleBefore=!0,this.sePolarPoint.incrementVisiblePointCount(),this.sePolarPoint.label&&this.useVisiblePointCountToRename&&(this.sePolarPoint.label.ref.shortUserName=`P${this.sePolarPoint.visiblePointCount}`)}saveState(){this.lastState=this.sePolarPoint.id}restoreState(){this.sePolarPoint.decrementVisiblePointCount(),this.sePolarPoint.label&&this.useVisiblePointCountToRename&&(this.sePolarPoint.label.ref.shortUserName=`P${this.sePolarPoint.visiblePointCount}`),this.sePolarPoint.pointVisibleBefore=!1,L.store.removeLabel(this.seLabel.id),L.store.removePoint(this.lastState),this.sePolarPoint.unregisterChild(this.seLabel),this.parent.unregisterChild(this.sePolarPoint)}toOpcode(){return["AddPolarPoint","objectName="+L.symbolToASCIIDec(this.sePolarPoint.name),"objectExists="+this.sePolarPoint.exists,"objectShowing="+this.sePolarPoint.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePolarPoint.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePolarPoint.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"polarPointVector="+this.sePolarPoint.locationVector.toFixed(9),"polarPointParentName="+this.parent.name,"polarPointIndex="+this.index].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((c,u)=>{if(u===0)return;const h=c.split("=");s.set(h[0],L.asciiDecToSymbol(h[1]))});const o=n.get(s.get("polarPointParentName")??""),a=new k;a.from(s.get("polarPointVector"));const l=Number(s.get("polarPointIndex"));if(o&&a.z!==1&&!isNaN(l)){const c=new v_(o,l),u=s.get("objectFrontStyle");u!==void 0&&c.updatePlottableStyle(q.Front,JSON.parse(u));const h=s.get("objectBackStyle");h!==void 0&&c.updatePlottableStyle(q.Back,JSON.parse(h));const d=new De("point",c),f=new k;f.from(s.get("labelVector")),d.locationVector.copy(f);const m=s.get("labelStyle");if(m!==void 0&&d.updatePlottableStyle(q.Label,JSON.parse(m)),s.get("objectName")!==void 0)c.name=s.get("objectName")??"",c.showing=s.get("objectShowing")==="true",c.exists=s.get("objectExists")==="true",n.set(c.name,c);else throw new Error("AddPolarPoint: PolarPoint Name doesn't exist");if(s.get("labelName")!==void 0)d.name=s.get("labelName")??"",d.showing=s.get("labelShowing")==="true",d.exists=s.get("labelExists")==="true",n.set(d.name,d);else throw new Error("AddPolarPoint: Label Name doesn't exist");return new Yv(c,l,o,d,!1)}throw new Error(`AddPolarPoint: ${a}, ${l}, or ${o}  is undefined`)}}class Yc extends L{constructor(i,n,r,s,o,a){super();y(this,"_firstSEParent");y(this,"_secondSEParent");y(this,"_thirdSEParent");y(this,"mode",Di.NONE);y(this,"seLabel");y(this,"seAngleMarker");this.mode=i,this.seAngleMarker=n,this._firstSEParent=s,this._secondSEParent=o,this._thirdSEParent=a,this.seLabel=r}do(){this._firstSEParent.registerChild(this.seAngleMarker),this._secondSEParent.registerChild(this.seAngleMarker),this._thirdSEParent!==void 0&&this._thirdSEParent.registerChild(this.seAngleMarker),this.seAngleMarker.registerChild(this.seLabel),L.store.addAngleMarkerAndExpression(this.seAngleMarker),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seAngleMarker.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeAngleMarkerAndExpression(this.lastState),this.seAngleMarker.unregisterChild(this.seLabel),this._thirdSEParent!==void 0&&this._thirdSEParent.unregisterChild(this.seAngleMarker),this._secondSEParent.unregisterChild(this.seAngleMarker),this._firstSEParent.unregisterChild(this.seAngleMarker)}toOpcode(){var i;return["AddAngleMarker","objectName="+L.symbolToASCIIDec(this.seAngleMarker.name),"objectExists="+this.seAngleMarker.exists,"objectShowing="+this.seAngleMarker.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seAngleMarker.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seAngleMarker.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"angleMarkerMode="+this.mode,"angleMarkerFirstParentName="+this._firstSEParent.name,"angleMarkerSecondParentName="+this._secondSEParent.name,"angleMarkerThirdParentName="+((i=this._thirdSEParent)==null?void 0:i.name),"valueDisplayMode="+this.seAngleMarker.valueDisplayMode].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((h,d)=>{if(d===0)return;const f=h.split("=");s.set(f[0],L.asciiDecToSymbol(f[1]))});const o=n.get(s.get("angleMarkerFirstParentName")??""),a=n.get(s.get("angleMarkerSecondParentName")??""),l=n.get(s.get("angleMarkerThirdParentName")??""),c=Number(s.get("angleMarkerMode")),u=Number(s.get("valueDisplayMode"));if(o&&a&&c&&typeof u=="number"){const h=new en(c,Yc.store.zoomMagnificationFactor,o,a,l),d=s.get("objectFrontStyle");d!==void 0&&h.updatePlottableStyle(q.Front,JSON.parse(d));const f=s.get("objectBackStyle");f!==void 0&&h.updatePlottableStyle(q.Back,JSON.parse(f));const m=new De("angleMarker",h),g=new k;g.from(s.get("labelVector")),m.locationVector.copy(g);const v=s.get("labelStyle");if(v!==void 0&&m.updatePlottableStyle(q.Label,JSON.parse(v)),h.valueDisplayMode=u,s.get("objectName")!==void 0)h.name=s.get("objectName")??"",h.showing=s.get("objectShowing")==="true",h.exists=s.get("objectExists")==="true",n.set(h.name,h);else throw new Error("AddAngleMarker: AngleMarker Name doesn't exist");if(s.get("labelName")!==void 0)m.name=s.get("labelName")??"",m.showing=s.get("labelShowing")==="true",m.exists=s.get("labelExists")==="true",n.set(m.name,m);else throw new Error("AddAngleMarker: Label Name doesn't exist");return new Yc(c,h,m,o,a,l)}throw new Error(`AddAngleMarker: ${o}, ${a} or ${c} is undefined`)}}class HP extends L{constructor(i,n,r,s,o){super();y(this,"seAngleMarkerParents",[]);y(this,"seSegments",[]);y(this,"segmentIsFlipped",[]);y(this,"seLabel");y(this,"sePolygon");this.seAngleMarkerParents.push(...s),this.seSegments.push(...n),this.sePolygon=i,this.seLabel=o,this.segmentIsFlipped.push(...r)}do(){this.seAngleMarkerParents.forEach(i=>i.registerChild(this.sePolygon)),this.sePolygon.registerChild(this.seLabel),L.store.addPolygonAndExpression(this.sePolygon),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.sePolygon.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removePolygonAndExpression(this.lastState),this.sePolygon.unregisterChild(this.seLabel),this.seAngleMarkerParents.forEach(i=>i.unregisterChild(this.sePolygon))}toOpcode(){return["AddPolygon","objectName="+L.symbolToASCIIDec(this.sePolygon.name),"objectExists="+this.sePolygon.exists,"objectShowing="+this.sePolygon.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePolygon.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePolygon.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"polygonAngleMarkerParentsNames="+this.seAngleMarkerParents.map(i=>L.symbolToASCIIDec(i.name)).join("@"),"polygonSegmentParentsNames="+this.seSegments.map(i=>L.symbolToASCIIDec(i.name)).join("@"),"polygonSegmentFlippedList="+this.segmentIsFlipped.map(i=>i.toString()).join("@"),"valueDisplayMode="+this.sePolygon.valueDisplayMode].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((f,m)=>{if(m===0)return;const g=f.split("=");s.set(g[0],L.asciiDecToSymbol(g[1]))});const o=s.get("polygonAngleMarkerParentsNames"),a=[];o&&o.split("@").forEach(f=>a.push(n.get(f)));const l=s.get("polygonSegmentParentsNames"),c=[];l&&l.split("@").forEach(f=>c.push(n.get(f)));const u=s.get("polygonSegmentFlippedList"),h=[];u&&u.split("@").forEach(f=>h.push(f==="true"));const d=Number(s.get("valueDisplayMode"));if(a.every(f=>f!==void 0)&&c.every(f=>f!==void 0)&&typeof d=="number"){const f=new Ks(c.map(_=>_),h,a.map(_=>_)),m=s.get("objectFrontStyle");m!==void 0&&f.updatePlottableStyle(q.Front,JSON.parse(m));const g=s.get("objectBackStyle");g!==void 0&&f.updatePlottableStyle(q.Back,JSON.parse(g));const v=new De("polygon",f),p=new k;p.from(s.get("labelVector")),v.locationVector.copy(p);const b=s.get("labelStyle");if(b!==void 0&&v.updatePlottableStyle(q.Label,JSON.parse(b)),f.valueDisplayMode=d,s.get("objectName")!==void 0)f.name=s.get("objectName")??"",f.showing=s.get("objectShowing")==="true",f.exists=s.get("objectExists")==="true",n.set(f.name,f);else throw new Error("AddPolygonCommand:  Polygon name doesn't exist");if(s.get("labelName")!==void 0)v.name=s.get("labelName")??"",v.showing=s.get("labelShowing")==="true",v.exists=s.get("labelExists")==="true",n.set(v.name,v);else throw new Error("AddPolygonCommand: Label Name doesn't exist");return new HP(f,c.map(_=>_),h,a.map(_=>_),v)}throw new Error(`AddPolygon:
      ${a} or
      ${c}
       is undefined`)}}class qP extends L{constructor(i,n,r,s){super();y(this,"seTangentLineThruPoint");y(this,"parentSEPoint");y(this,"parentOneDimensional");y(this,"seLabel");this.seTangentLineThruPoint=i,this.parentSEPoint=n,this.parentOneDimensional=r,this.seLabel=s}do(){this.parentSEPoint.registerChild(this.seTangentLineThruPoint),this.parentOneDimensional.registerChild(this.seTangentLineThruPoint),this.seTangentLineThruPoint.registerChild(this.seLabel),L.store.addLine(this.seTangentLineThruPoint),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seTangentLineThruPoint.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeLine(this.lastState),this.seTangentLineThruPoint.unregisterChild(this.seLabel),this.parentOneDimensional.unregisterChild(this.seTangentLineThruPoint),this.parentSEPoint.unregisterChild(this.seTangentLineThruPoint)}toOpcode(){return["AddTangentLineThruPoint","objectName="+L.symbolToASCIIDec(this.seTangentLineThruPoint.name),"objectExists="+this.seTangentLineThruPoint.exists,"objectShowing="+this.seTangentLineThruPoint.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seTangentLineThruPoint.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seTangentLineThruPoint.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"tangentLineThruPointParentPointName="+this.parentSEPoint.name,"tangentLineThruPointNormalVector="+this.seTangentLineThruPoint.normalVector.toFixed(9),"tangentLineThruPointEndSEPointLocationVector="+this.seTangentLineThruPoint.endSEPoint.locationVector.toFixed(9),"tangentLineThruPointParentOneDimensionalName="+this.parentOneDimensional.name,"tangentLineThruPointIndex="+this.seTangentLineThruPoint.index].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((h,d)=>{if(d===0)return;const f=h.split("=");s.set(f[0],L.asciiDecToSymbol(f[1]))});const o=n.get(s.get("tangentLineThruPointParentOneDimensionalName")??""),a=n.get(s.get("tangentLineThruPointParentPointName")??""),l=new k;l.from(s.get("tangentLineThruPointEndSEPointLocationVector"));const c=new k;c.from(s.get("tangentLineThruPointNormalVector"));const u=Number(s.get("tangentLineThruPointIndex"));if(a&&o&&c.z!==1&&l.z!==1&&!isNaN(u)){const h=new Ze;h.locationVector=l,h.exists=!0,h.showing=!1;const d=new Gp(o,a,c,h,u),f=s.get("objectFrontStyle");f!==void 0&&d.updatePlottableStyle(q.Front,JSON.parse(f));const m=s.get("objectBackStyle");m!==void 0&&d.updatePlottableStyle(q.Back,JSON.parse(m));const g=new De("line",d),v=new k;v.from(s.get("labelVector")),g.locationVector.copy(v);const p=s.get("labelStyle");if(p!==void 0&&g.updatePlottableStyle(q.Label,JSON.parse(p)),s.get("objectName")!==void 0)d.name=s.get("objectName")??"",d.showing=s.get("objectShowing")==="true",d.exists=s.get("objectExists")==="true",n.set(d.name,d);else throw new Error("AddTangentLineThruPoint: Tangent Line Name doesn't exist");if(s.get("labelName")!==void 0)g.name=s.get("labelName")??"",g.showing=s.get("labelShowing")==="true",g.exists=s.get("labelExists")==="true",n.set(g.name,g);else throw new Error("AddTangentLineThruPoint: Label Name doesn't exist");return new qP(d,a,o,g)}throw new Error(`AddTangentLineThruPoint: ${a}, ${o}, ${u}, ${c}, or ${l}  is undefined`)}}class KP extends L{constructor(i,n,r){super();y(this,"seNSectLine");y(this,"parentAngle");y(this,"seLabel");this.seNSectLine=i,this.parentAngle=n,this.seLabel=r}do(){this.parentAngle.registerChild(this.seNSectLine),this.seNSectLine.registerChild(this.seLabel),this.seLabel.showing=!1,L.store.addLine(this.seNSectLine),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seNSectLine.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeLine(this.lastState),this.seNSectLine.unregisterChild(this.seLabel),this.parentAngle.unregisterChild(this.seNSectLine)}toOpcode(){return["AddNSectLine","objectName="+L.symbolToASCIIDec(this.seNSectLine.name),"objectExists="+this.seNSectLine.exists,"objectShowing="+this.seNSectLine.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seNSectLine.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seNSectLine.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"seNSectLineStartSEPointName="+this.seNSectLine.startSEPoint.name,"seNSectLineEndSEPointLocationVector="+this.seNSectLine.endSEPoint.locationVector.toFixed(9),"seNSectLineNormalVector="+this.seNSectLine.normalVector.toFixed(9),"seNSectLineParentAngleName="+this.parentAngle.name,"seNSectLineIndex="+this.seNSectLine.index,"seNSectLineN="+this.seNSectLine.N].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((d,f)=>{if(f===0)return;const m=d.split("=");s.set(m[0],L.asciiDecToSymbol(m[1]))});const o=n.get(s.get("seNSectLineParentAngleName")??""),a=n.get(s.get("seNSectLineStartSEPointName")??""),l=new k;l.from(s.get("seNSectLineEndSEPointLocationVector"));const c=new k;c.from(s.get("seNSectLineNormalVector"));const u=Number(s.get("seNSectLineIndex")),h=Number(s.get("seNSectLineN"));if(o&&a&&l.z!==1&&c.z!==1&&!isNaN(u)&&!isNaN(h)){const d=new Ze;d.locationVector=l,d.exists=!0,d.showing=!1;const f=new iv(a,c,d,o,u,h),m=s.get("objectFrontStyle");m!==void 0&&f.updatePlottableStyle(q.Front,JSON.parse(m));const g=s.get("objectBackStyle");g!==void 0&&f.updatePlottableStyle(q.Back,JSON.parse(g));const v=new De("line",f),p=new k;p.from(s.get("labelVector")),v.locationVector.copy(p);const b=s.get("labelStyle");if(b!==void 0&&v.updatePlottableStyle(q.Label,JSON.parse(b)),s.get("objectName")!==void 0)f.name=s.get("objectName")??"",f.showing=s.get("objectShowing")==="true",f.exists=s.get("objectExists")==="true",n.set(f.name,f);else throw new Error("AddNSectLine: NSectLine Name doesn't exist");if(s.get("labelName")!==void 0)v.name=s.get("labelName")??"",v.showing=s.get("labelShowing")==="true",v.exists=s.get("labelExists")==="true",n.set(v.name,v);else throw new Error("AddNSectLine: Label Name doesn't exist");return new KP(f,o,v)}throw new Error(`AddNSectLine: ${l}, ${c}, ${u}, ${h}, ${o} or ${a} is undefined`)}}class XP extends L{constructor(i,n,r,s){super();y(this,"seNSectPoint");y(this,"parentSegment");y(this,"seLabel");y(this,"useVisiblePointCountToRename");this.seNSectPoint=i,this.parentSegment=n,this.seLabel=r,s!==void 0?this.useVisiblePointCountToRename=s:this.useVisiblePointCountToRename=!0}do(){this.parentSegment.registerChild(this.seNSectPoint),this.seNSectPoint.registerChild(this.seLabel),this.seLabel.showing=!1,L.store.addPoint(this.seNSectPoint),L.store.addLabel(this.seLabel),this.seNSectPoint.pointVisibleBefore=!0,this.seNSectPoint.incrementVisiblePointCount(),this.seNSectPoint.label&&this.useVisiblePointCountToRename&&(this.seNSectPoint.label.ref.shortUserName=`P${this.seNSectPoint.visiblePointCount}`)}saveState(){this.lastState=this.seNSectPoint.id}restoreState(){this.seNSectPoint.decrementVisiblePointCount(),this.seNSectPoint.label&&this.useVisiblePointCountToRename&&(this.seNSectPoint.label.ref.shortUserName=`P${this.seNSectPoint.visiblePointCount}`),this.seNSectPoint.pointVisibleBefore=!1,L.store.removeLabel(this.seLabel.id),L.store.removePoint(this.lastState),this.seNSectPoint.unregisterChild(this.seLabel),this.parentSegment.unregisterChild(this.seNSectPoint)}toOpcode(){return["AddNSectPoint","objectName="+L.symbolToASCIIDec(this.seNSectPoint.name),"objectExists="+this.seNSectPoint.exists,"objectShowing="+this.seNSectPoint.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seNSectPoint.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seNSectPoint.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"seNSectPointVector="+this.seNSectPoint.locationVector.toFixed(9),"seNSectPointParentSegmentName="+this.parentSegment.name,"seNSectPointIndex="+this.seNSectPoint.index,"seNSectPointN="+this.seNSectPoint.N].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((u,h)=>{if(h===0)return;const d=u.split("=");s.set(d[0],L.asciiDecToSymbol(d[1]))});const o=n.get(s.get("seNSectPointParentSegmentName")??""),a=new k;a.from(s.get("seNSectPointVector"));const l=Number(s.get("seNSectPointIndex")),c=Number(s.get("seNSectPointN"));if(o&&a.z!==1&&!isNaN(l)&&!isNaN(c)){const u=new nv(o,l,c),h=s.get("objectFrontStyle");h!==void 0&&u.updatePlottableStyle(q.Front,JSON.parse(h));const d=s.get("objectBackStyle");d!==void 0&&u.updatePlottableStyle(q.Back,JSON.parse(d));const f=new De("point",u),m=new k;m.from(s.get("labelVector")),f.locationVector.copy(m);const g=s.get("labelStyle");if(g!==void 0&&f.updatePlottableStyle(q.Label,JSON.parse(g)),s.get("objectName")!==void 0)u.name=s.get("objectName")??"",u.showing=s.get("objectShowing")==="true",u.exists=s.get("objectExists")==="true",n.set(u.name,u);else throw new Error("AddNSectPoint: NSectPoint Name doesn't exist");if(s.get("labelName")!==void 0)f.name=s.get("labelName")??"",f.showing=s.get("labelShowing")==="true",f.exists=s.get("labelExists")==="true",n.set(f.name,f);else throw new Error("AddNSectPoint: Label Name doesn't exist");return new XP(u,o,f,!1)}throw new Error(`AddNSectPoint: ${a}, ${l}, ${c}, or ${o}  is undefined`)}}class YP extends L{constructor(i,n,r){super();y(this,"sePolarLine");y(this,"parentSEPoint");y(this,"seLabel");this.sePolarLine=i,this.parentSEPoint=n,this.seLabel=r}do(){this.parentSEPoint.registerChild(this.sePolarLine),this.sePolarLine.registerChild(this.seLabel),L.store.addLine(this.sePolarLine),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.sePolarLine.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeLine(this.lastState),this.sePolarLine.unregisterChild(this.seLabel),this.parentSEPoint.unregisterChild(this.sePolarLine)}toOpcode(){return["AddPolarLine","objectName="+L.symbolToASCIIDec(this.sePolarLine.name),"objectExists="+this.sePolarLine.exists,"objectShowing="+this.sePolarLine.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePolarLine.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.sePolarLine.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"polarLineParentPointName="+this.parentSEPoint.name,"polarLineStartSEPointLocationVector="+this.sePolarLine.startSEPoint.locationVector.toFixed(9),"polarLineEndSEPointLocationVector="+this.sePolarLine.endSEPoint.locationVector.toFixed(9)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((c,u)=>{if(u===0)return;const h=c.split("=");s.set(h[0],L.asciiDecToSymbol(h[1]))});const o=new k;o.from(s.get("polarLineStartSEPointLocationVector"));const a=new k;a.from(s.get("polarLineEndSEPointLocationVector"));const l=n.get(s.get("polarLineParentPointName")??"");if(l&&o.z!==1&&a.z!==1){const c=new Ze;c.locationVector=a,c.exists=!0,c.showing=!1;const u=new Ze;u.locationVector=o,u.exists=!0,u.showing=!1;const h=new ZM(u,c,l),d=s.get("objectFrontStyle");d!==void 0&&h.updatePlottableStyle(q.Front,JSON.parse(d));const f=s.get("objectBackStyle");f!==void 0&&h.updatePlottableStyle(q.Back,JSON.parse(f));const m=new De("line",h),g=new k;g.from(s.get("labelVector")),m.locationVector.copy(g);const v=s.get("labelStyle");if(v!==void 0&&m.updatePlottableStyle(q.Label,JSON.parse(v)),s.get("objectName")!==void 0)h.name=s.get("objectName")??"",h.showing=s.get("objectShowing")==="true",h.exists=s.get("objectExists")==="true",n.set(h.name,h);else throw new Error("AddPolarLine: Polar Line Name doesn't exist");if(s.get("labelName")!==void 0)m.name=s.get("labelName")??"",m.showing=s.get("labelShowing")==="true",m.exists=s.get("labelExists")==="true",n.set(m.name,m);else throw new Error("AddPolarLine: Label Name doesn't exist");return new YP(h,l,m)}throw new Error(`AddPolarLine: ${a},  ${l} or ${o} is undefined`)}}class ZP extends L{constructor(i,n,r,s,o,a){super();y(this,"seThreePointCircleCenter");y(this,"firstSEPoint");y(this,"secondSEPoint");y(this,"thirdSEPoint");y(this,"seLabel");y(this,"useVisiblePointCountToRename");this.seThreePointCircleCenter=i,this.firstSEPoint=n,this.secondSEPoint=r,this.thirdSEPoint=s,this.seLabel=o,a!==void 0?this.useVisiblePointCountToRename=a:this.useVisiblePointCountToRename=!0}do(){this.firstSEPoint.registerChild(this.seThreePointCircleCenter),this.secondSEPoint.registerChild(this.seThreePointCircleCenter),this.thirdSEPoint.registerChild(this.seThreePointCircleCenter),L.store.addPoint(this.seThreePointCircleCenter),L.store.addLabel(this.seLabel),this.seThreePointCircleCenter.pointVisibleBefore=!0,this.seThreePointCircleCenter.label&&this.useVisiblePointCountToRename&&(this.seThreePointCircleCenter.incrementVisiblePointCount(),this.seThreePointCircleCenter.label.ref.shortUserName=`P${this.seThreePointCircleCenter.visiblePointCount}`)}saveState(){this.lastState=this.seThreePointCircleCenter.id}restoreState(){this.seThreePointCircleCenter.label&&this.useVisiblePointCountToRename&&(this.seThreePointCircleCenter.decrementVisiblePointCount(),this.seThreePointCircleCenter.label.ref.shortUserName=`P${this.seThreePointCircleCenter.visiblePointCount}`),this.seThreePointCircleCenter.pointVisibleBefore=!1,L.store.removeLabel(this.seLabel.id),L.store.removePoint(this.lastState),this.thirdSEPoint.unregisterChild(this.seThreePointCircleCenter),this.secondSEPoint.unregisterChild(this.seThreePointCircleCenter),this.firstSEPoint.unregisterChild(this.seThreePointCircleCenter)}toOpcode(){return["AddThreePointCircleCenter","objectName="+L.symbolToASCIIDec(this.seThreePointCircleCenter.name),"objectExists="+this.seThreePointCircleCenter.exists,"objectShowing="+this.seThreePointCircleCenter.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seThreePointCircleCenter.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seThreePointCircleCenter.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"threePointCircleParentPoint1Name="+L.symbolToASCIIDec(this.firstSEPoint.name),"threePointCircleParentPoint2Name="+L.symbolToASCIIDec(this.secondSEPoint.name),"threePointCircleParentPoint3Name="+L.symbolToASCIIDec(this.thirdSEPoint.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((c,u)=>{if(u===0)return;const h=c.split("=");s.set(h[0],L.asciiDecToSymbol(h[1]))});const o=n.get(s.get("threePointCircleParentPoint1Name")??""),a=n.get(s.get("threePointCircleParentPoint2Name")??""),l=n.get(s.get("threePointCircleParentPoint3Name")??"");if(o&&a&&l){const c=new QM(o,a,l),u=s.get("objectFrontStyle");u!==void 0&&c.updatePlottableStyle(q.Front,JSON.parse(u));const h=s.get("objectBackStyle");h!==void 0&&c.updatePlottableStyle(q.Back,JSON.parse(h));const d=new De("point",c),f=new k;f.from(s.get("labelVector")),d.locationVector.copy(f);const m=s.get("labelStyle");if(m!==void 0&&d.updatePlottableStyle(q.Label,JSON.parse(m)),s.get("objectName")!==void 0)c.name=s.get("objectName")??"",c.showing=s.get("objectShowing")==="true",c.exists=s.get("objectExists")==="true",n.set(c.name,c);else throw new Error("AddThreePointCircleCenter: Center point name doesn't exist");if(s.get("labelName")!==void 0)d.name=s.get("labelName")??"",d.showing=s.get("labelShowing")==="true",d.exists=s.get("labelExists")==="true",n.set(d.name,d);else throw new Error("AddThreePointCircleCenter: Label Name doesn't exist");return new ZP(c,o,a,l,d,!1)}throw new Error(`AddThreePointCircleCenter: ${o}, ${a},or ${l}  is undefined`)}}class JP extends L{constructor(i,n,r,s){super();y(this,"seCircle");y(this,"centerSEPoint");y(this,"measurementSEExpression");y(this,"seLabel");this.seCircle=i,this.centerSEPoint=n,this.measurementSEExpression=r,this.seLabel=s}do(){this.centerSEPoint.registerChild(this.seCircle),this.measurementSEExpression.registerChild(this.seCircle),this.seCircle.registerChild(this.seLabel),L.store.addCircle(this.seCircle),L.store.addLabel(this.seLabel)}saveState(){this.lastState=this.seCircle.id}restoreState(){L.store.removeLabel(this.seLabel.id),L.store.removeCircle(this.lastState),this.seCircle.unregisterChild(this.seLabel),this.centerSEPoint.unregisterChild(this.seCircle),this.measurementSEExpression.unregisterChild(this.seCircle)}toOpcode(){return["AddMeasuredCircle","objectName="+L.symbolToASCIIDec(this.seCircle.name),"objectExists="+this.seCircle.exists,"objectShowing="+this.seCircle.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seCircle.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seCircle.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"circleCenterPointName="+this.centerSEPoint.name,"measuredCircleRadiusExpression="+this.measurementSEExpression.name].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("circleCenterPointName")??""),a=n.get(s.get("measuredCircleRadiusExpression")??"");if(o&&a){const l=new Ze(!0);l.showing=!1,l.exists=!0;const c=a.value.modPi();this.tmpVector.set(-o.locationVector.y,o.locationVector.x,0),this.tmpVector.isZero()&&this.tmpVector.set(0,-o.locationVector.z,o.locationVector.y),this.tmpVector.normalize(),this.tmpVector1.copy(o.locationVector).multiplyScalar(Math.cos(c)),this.tmpVector1.addScaledVector(this.tmpVector,Math.sin(c)),l.locationVector=this.tmpVector1.normalize();const u=new yC(o,l,a),h=s.get("objectFrontStyle");h!==void 0&&u.updatePlottableStyle(q.Front,JSON.parse(h));const d=s.get("objectBackStyle");d!==void 0&&u.updatePlottableStyle(q.Back,JSON.parse(d));const f=new De("circle",u),m=new k;m.from(s.get("labelVector")),f.locationVector.copy(m);const g=s.get("labelStyle");if(g!==void 0&&f.updatePlottableStyle(q.Label,JSON.parse(g)),s.get("objectName")!==void 0)u.name=s.get("objectName")??"",u.showing=s.get("objectShowing")==="true",u.exists=s.get("objectExists")==="true",n.set(u.name,u);else throw new Error("AddMeasureCircle: Circle Name doesn't exist");if(s.get("labelName")!==void 0)f.name=s.get("labelName")??"",f.showing=s.get("labelShowing")==="true",f.exists=s.get("labelExists")==="true",n.set(f.name,f);else throw new Error("AddCircle: Label Name doesn't exist");return new JP(u,o,a,f)}throw new Error(`AddCircle: ${o} or ${a} is undefined`)}}class QP extends L{constructor(i,n,r){super();y(this,"seTranslation");y(this,"seLineOrSegment");y(this,"seTranslationDistanceExpression");this.seTranslation=i,this.seLineOrSegment=n,this.seTranslationDistanceExpression=r}do(){L.store.addTransformation(this.seTranslation),this.seLineOrSegment.registerChild(this.seTranslation),this.seTranslationDistanceExpression.registerChild(this.seTranslation)}saveState(){this.lastState=this.seTranslation.id}restoreState(){this.seTranslationDistanceExpression.unregisterChild(this.seTranslation),this.seLineOrSegment.unregisterChild(this.seTranslation),L.store.removeTransformation(this.lastState)}toOpcode(){return["AddTranslation","objectName="+L.symbolToASCIIDec(this.seTranslation.name),"objectExists="+this.seTranslation.exists,"translationSegmentParentName="+L.symbolToASCIIDec(this.seLineOrSegment.name),"translationDistanceExpressionName="+L.symbolToASCIIDec(this.seTranslationDistanceExpression.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("translationSegmentParentName")??""),a=n.get(s.get("translationDistanceExpressionName")??"");if(o&&a){const l=new is(o,a);if(s.get("objectName")!==void 0)l.name=s.get("objectName")??"",l.exists=s.get("objectExists")==="true",n.set(l.name,l);else throw new Error("AddTranslationCommand:  translation name doesn't exist");return new QP(l,o,a)}throw new Error(`AddTranslationCommand: ${o} or ${a} is undefined`)}}class eE extends L{constructor(i,n,r){super();y(this,"seRotation");y(this,"sePointOfRotation");y(this,"seAngleExpression");this.seRotation=i,this.sePointOfRotation=n,this.seAngleExpression=r}do(){L.store.addTransformation(this.seRotation),this.sePointOfRotation.registerChild(this.seRotation),this.seAngleExpression.registerChild(this.seRotation)}saveState(){this.lastState=this.seRotation.id}restoreState(){this.seAngleExpression.unregisterChild(this.seRotation),this.sePointOfRotation.unregisterChild(this.seRotation),L.store.removeTransformation(this.lastState)}toOpcode(){return["AddRotation","objectName="+L.symbolToASCIIDec(this.seRotation.name),"objectExists="+this.seRotation.exists,"rotationPointName="+L.symbolToASCIIDec(this.sePointOfRotation.name),"rotationAngleExpressionName="+L.symbolToASCIIDec(this.seAngleExpression.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("rotationPointName")??""),a=n.get(s.get("rotationAngleExpressionName")??"");if(o&&a){const l=new ts(o,a);if(s.get("objectName")!==void 0)l.name=s.get("objectName")??"",l.exists=s.get("objectExists")==="true",n.set(l.name,l);else throw new Error("AddRotationCommand: Rotation name doesn't exist");return new eE(l,o,a)}throw new Error(`AddRotationCommand: ${o} or ${a} is undefined`)}}class Zv extends L{constructor(i,n){super();y(this,"seReflection");y(this,"seLineOrSegment");this.seReflection=i,this.seLineOrSegment=n}do(){L.store.addTransformation(this.seReflection),this.seLineOrSegment.registerChild(this.seReflection)}saveState(){this.lastState=this.seReflection.id}restoreState(){this.seLineOrSegment.unregisterChild(this.seReflection),L.store.removeTransformation(this.lastState)}toOpcode(){return["AddReflection","objectName="+L.symbolToASCIIDec(this.seReflection.name),"objectExists="+this.seReflection.exists,"reflectionLineOrSegmentName="+L.symbolToASCIIDec(this.seLineOrSegment.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((a,l)=>{if(l===0)return;const c=a.split("=");s.set(c[0],L.asciiDecToSymbol(c[1]))});const o=n.get(s.get("reflectionLineOrSegmentName")??"");if(o){const a=new Qi(o);if(s.get("objectName")!==void 0)a.name=s.get("objectName")??"",a.exists=s.get("objectExists")==="true",n.set(a.name,a);else throw new Error("AddReflectionCommand: Reflection name doesn't exist");return new Zv(a,o)}throw new Error(`AddReflectionCommand: ${o} is undefined`)}}class Jv extends L{constructor(i,n){super();y(this,"seInversion");y(this,"seCircle");this.seInversion=i,this.seCircle=n}do(){L.store.addTransformation(this.seInversion),this.seCircle.registerChild(this.seInversion)}saveState(){this.lastState=this.seInversion.id}restoreState(){this.seCircle.unregisterChild(this.seInversion),L.store.removeTransformation(this.lastState)}toOpcode(){return["AddInversion","objectName="+L.symbolToASCIIDec(this.seInversion.name),"objectExists="+this.seInversion.exists,"inversionCircleName="+L.symbolToASCIIDec(this.seCircle.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((a,l)=>{if(l===0)return;const c=a.split("=");s.set(c[0],L.asciiDecToSymbol(c[1]))});const o=n.get(s.get("inversionCircleName")??"");if(o){const a=new zr(o);if(s.get("objectName")!==void 0)a.name=s.get("objectName")??"",a.exists=s.get("objectExists")==="true",n.set(a.name,a);else throw new Error("AddInversionCommand: Inversion name doesn't exist");return new Jv(a,o)}throw new Error(`AddInversionCommand: ${o} is undefined`)}}class Qv extends L{constructor(i,n){super();y(this,"sePointReflection");y(this,"sePointOfReflection");this.sePointReflection=i,this.sePointOfReflection=n}do(){L.store.addTransformation(this.sePointReflection),this.sePointOfReflection.registerChild(this.sePointReflection)}saveState(){this.lastState=this.sePointReflection.id}restoreState(){this.sePointOfReflection.unregisterChild(this.sePointReflection),L.store.removeTransformation(this.lastState)}toOpcode(){return["AddPointReflection","objectName="+L.symbolToASCIIDec(this.sePointReflection.name),"objectExists="+this.sePointReflection.exists,"pointReflectionPointName="+L.symbolToASCIIDec(this.sePointOfReflection.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((a,l)=>{if(l===0)return;const c=a.split("=");s.set(c[0],L.asciiDecToSymbol(c[1]))});const o=n.get(s.get("pointReflectionPointName")??"");if(o){const a=new er(o);if(s.get("objectName")!==void 0)a.name=s.get("objectName")??"",a.exists=s.get("objectExists")==="true",n.set(a.name,a);else throw new Error("AddPointReflectionCommand: PointReflection name doesn't exist");return new Qv(a,o)}throw new Error(`AddPointReflectionCommand: ${o} is undefined`)}}class tE extends L{constructor(i,n,r,s,o){super();y(this,"preimageSEPoint");y(this,"parentTransformation");y(this,"transformedSEPoint");y(this,"transformedSEPointLabel");y(this,"useVisiblePointCountToRename");this.preimageSEPoint=r,this.transformedSEPoint=i,this.parentTransformation=s,this.transformedSEPointLabel=n,o!==void 0?this.useVisiblePointCountToRename=o:this.useVisiblePointCountToRename=!0}do(){this.preimageSEPoint.registerChild(this.transformedSEPoint),this.parentTransformation.registerChild(this.transformedSEPoint),this.transformedSEPoint.registerChild(this.transformedSEPointLabel),L.store.addPoint(this.transformedSEPoint),L.store.addLabel(this.transformedSEPointLabel),this.transformedSEPoint.pointVisibleBefore=!0,this.transformedSEPoint.incrementVisiblePointCount(),this.transformedSEPoint.label&&this.useVisiblePointCountToRename&&(this.transformedSEPoint.label.ref.shortUserName=`P${this.transformedSEPoint.visiblePointCount}`)}saveState(){this.lastState=this.transformedSEPoint.id}restoreState(){this.transformedSEPoint.decrementVisiblePointCount(),this.transformedSEPoint.label&&this.useVisiblePointCountToRename&&(this.transformedSEPoint.label.ref.shortUserName=`P${this.transformedSEPoint.visiblePointCount}`),this.transformedSEPoint.pointVisibleBefore=!1,L.store.removeLabel(this.transformedSEPointLabel.id),L.store.removePoint(this.lastState),this.transformedSEPoint.unregisterChild(this.transformedSEPointLabel),this.parentTransformation.unregisterChild(this.transformedSEPoint),this.preimageSEPoint.unregisterChild(this.transformedSEPoint)}toOpcode(){return["AddTransformedPoint","objectName="+L.symbolToASCIIDec(this.transformedSEPoint.name),"objectExists="+this.transformedSEPoint.exists,"objectShowing="+this.transformedSEPoint.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.transformedSEPoint.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.transformedSEPoint.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.transformedSEPointLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.transformedSEPointLabel.ref.currentStyleState(q.Label))),"labelVector="+this.transformedSEPointLabel.ref._locationVector.toFixed(9),"labelShowing="+this.transformedSEPointLabel.showing,"labelExists="+this.transformedSEPointLabel.exists,"transformedPointParentName="+this.preimageSEPoint.name,"transformedPointParentTransformationName="+this.parentTransformation.name].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("transformedPointParentName")??""),a=n.get(s.get("transformedPointParentTransformationName")??"");if(o&&a){const l=new Dr(o,a),c=s.get("objectFrontStyle");c!==void 0&&l.updatePlottableStyle(q.Front,JSON.parse(c));const u=s.get("objectBackStyle");u!==void 0&&l.updatePlottableStyle(q.Back,JSON.parse(u));const h=new De("point",l),d=new k;d.from(s.get("labelVector")),h.locationVector.copy(d);const f=s.get("labelStyle");if(f!==void 0&&h.updatePlottableStyle(q.Label,JSON.parse(f)),s.get("objectName")!==void 0)l.name=s.get("objectName")??"",l.showing=s.get("objectShowing")==="true",l.exists=s.get("objectExists")==="true",n.set(l.name,l);else throw new Error("AddTransformedPoint: Point Name doesn't exist");if(s.get("labelName")!==void 0)h.name=s.get("labelName")??"",h.showing=s.get("labelShowing")==="true",h.exists=s.get("labelExists")==="true",n.set(h.name,h);else throw new Error("AddTransformedPoint: Label Name doesn't exist");return new tE(l,h,o,a,!1)}throw new Error(`AddTransformedPoint: ${o} or ${a} is undefined`)}}class iE extends L{constructor(i,n,r,s){super();y(this,"preimageSESegment");y(this,"parentIsometry");y(this,"isometrySESegment");y(this,"isometrySESegmentLabel");this.preimageSESegment=r,this.isometrySESegment=i,this.parentIsometry=s,this.isometrySESegmentLabel=n}do(){this.preimageSESegment.registerChild(this.isometrySESegment),this.parentIsometry.registerChild(this.isometrySESegment),this.isometrySESegment.registerChild(this.isometrySESegmentLabel),L.store.addSegment(this.isometrySESegment),L.store.addLabel(this.isometrySESegmentLabel)}saveState(){this.lastState=this.isometrySESegment.id}restoreState(){L.store.removeLabel(this.isometrySESegmentLabel.id),L.store.removeSegment(this.lastState),this.isometrySESegment.unregisterChild(this.isometrySESegmentLabel),this.parentIsometry.unregisterChild(this.isometrySESegment),this.preimageSESegment.unregisterChild(this.isometrySESegment)}toOpcode(){return["AddIsometrySegment","objectName="+L.symbolToASCIIDec(this.isometrySESegment.name),"objectExists="+this.isometrySESegment.exists,"objectShowing="+this.isometrySESegment.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySESegment.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySESegment.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.isometrySESegmentLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySESegmentLabel.ref.currentStyleState(q.Label))),"labelVector="+this.isometrySESegmentLabel.ref._locationVector.toFixed(9),"labelShowing="+this.isometrySESegmentLabel.showing,"labelExists="+this.isometrySESegmentLabel.exists,"isometrySegmentParentName="+this.preimageSESegment.name,"isometrySegmentParentIsometryName="+this.parentIsometry.name,"isometrySegmentStartSEPointName="+L.symbolToASCIIDec(this.isometrySESegment.startSEPoint.name),"isometrySegmentEndSEPointName="+L.symbolToASCIIDec(this.isometrySESegment.endSEPoint.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((u,h)=>{if(h===0)return;const d=u.split("=");s.set(d[0],L.asciiDecToSymbol(d[1]))});const o=n.get(s.get("isometrySegmentParentName")??""),a=n.get(s.get("isometrySegmentParentIsometryName")??""),l=n.get(s.get("isometrySegmentStartSEPointName")??""),c=n.get(s.get("isometrySegmentEndSEPointName")??"");if(o&&a&&c&&l){const u=new tv(a instanceof Qi?c:l,a.f(o.normalVector),o.arcLength,a instanceof Qi?l:c,o,a),h=s.get("objectFrontStyle");h!==void 0&&u.updatePlottableStyle(q.Front,JSON.parse(h));const d=s.get("objectBackStyle");d!==void 0&&u.updatePlottableStyle(q.Back,JSON.parse(d));const f=new De("segment",u),m=new k;m.from(s.get("labelVector")),f.locationVector.copy(m);const g=s.get("labelStyle");if(g!==void 0&&f.updatePlottableStyle(q.Label,JSON.parse(g)),s.get("objectName")!==void 0)u.name=s.get("objectName")??"",u.showing=s.get("objectShowing")==="true",u.exists=s.get("objectExists")==="true",n.set(u.name,u);else throw new Error("AddIsometrySESegment: Segment Name doesn't exist");if(s.get("labelName")!==void 0)f.name=s.get("labelName")??"",f.showing=s.get("labelShowing")==="true",f.exists=s.get("labelExists")==="true",n.set(f.name,f);else throw new Error("AddIsometrySESegment: Label Name doesn't exist");return new iE(u,f,o,a)}throw new Error(`AddIsometrySegment: ${o} or ${a} or ${l} or ${c} is undefined`)}}class nE extends L{constructor(i,n,r,s){super();y(this,"preimageSELine");y(this,"parentIsometry");y(this,"isometrySELine");y(this,"isometrySELineLabel");this.preimageSELine=r,this.isometrySELine=i,this.parentIsometry=s,this.isometrySELineLabel=n}do(){this.preimageSELine.registerChild(this.isometrySELine),this.parentIsometry.registerChild(this.isometrySELine),this.isometrySELine.registerChild(this.isometrySELineLabel),L.store.addLine(this.isometrySELine),L.store.addLabel(this.isometrySELineLabel)}saveState(){this.lastState=this.isometrySELine.id}restoreState(){L.store.removeLabel(this.isometrySELineLabel.id),L.store.removeLine(this.lastState),this.isometrySELine.unregisterChild(this.isometrySELineLabel),this.parentIsometry.unregisterChild(this.isometrySELine),this.preimageSELine.unregisterChild(this.isometrySELine)}toOpcode(){return["AddIsometryLine","objectName="+L.symbolToASCIIDec(this.isometrySELine.name),"objectExists="+this.isometrySELine.exists,"objectShowing="+this.isometrySELine.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySELine.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySELine.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.isometrySELineLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySELineLabel.ref.currentStyleState(q.Label))),"labelVector="+this.isometrySELineLabel.ref._locationVector.toFixed(9),"labelShowing="+this.isometrySELineLabel.showing,"labelExists="+this.isometrySELineLabel.exists,"isometryLineParentName="+this.preimageSELine.name,"isometryLineParentIsometryName="+this.parentIsometry.name,"isometryLineStartSEPointName="+L.symbolToASCIIDec(this.isometrySELine.startSEPoint.name),"isometryLineEndSEPointName="+L.symbolToASCIIDec(this.isometrySELine.endSEPoint.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((u,h)=>{if(h===0)return;const d=u.split("=");s.set(d[0],L.asciiDecToSymbol(d[1]))});const o=n.get(s.get("isometryLineParentName")??""),a=n.get(s.get("isometryLineParentIsometryName")??""),l=n.get(s.get("isometryLineStartSEPointName")??""),c=n.get(s.get("isometryLineEndSEPointName")??"");if(o&&a&&c&&l){const u=new ev(l,a.f(o.normalVector),c,o,a),h=s.get("objectFrontStyle");h!==void 0&&u.updatePlottableStyle(q.Front,JSON.parse(h));const d=s.get("objectBackStyle");d!==void 0&&u.updatePlottableStyle(q.Back,JSON.parse(d));const f=new De("line",u),m=new k;m.from(s.get("labelVector")),f.locationVector.copy(m);const g=s.get("labelStyle");if(g!==void 0&&f.updatePlottableStyle(q.Label,JSON.parse(g)),s.get("objectName")!==void 0)u.name=s.get("objectName")??"",u.showing=s.get("objectShowing")==="true",u.exists=s.get("objectExists")==="true",n.set(u.name,u);else throw new Error("AddIsometrySELine: Line Name doesn't exist");if(s.get("labelName")!==void 0)f.name=s.get("labelName")??"",f.showing=s.get("labelShowing")==="true",f.exists=s.get("labelExists")==="true",n.set(f.name,f);else throw new Error("AddIsometrySELine: Label Name doesn't exist");return new nE(u,f,o,a)}throw new Error(`AddIsometryLine: ${o} or ${a} or ${l} or ${c} is undefined`)}}class rE extends L{constructor(i,n,r,s){super();y(this,"preimageSECircle");y(this,"parentIsometry");y(this,"isometrySECircle");y(this,"isometrySECircleLabel");this.preimageSECircle=r,this.isometrySECircle=i,this.parentIsometry=s,this.isometrySECircleLabel=n}do(){this.preimageSECircle.registerChild(this.isometrySECircle),this.parentIsometry.registerChild(this.isometrySECircle),this.isometrySECircle.registerChild(this.isometrySECircleLabel),L.store.addCircle(this.isometrySECircle),L.store.addLabel(this.isometrySECircleLabel)}saveState(){this.lastState=this.isometrySECircle.id}restoreState(){L.store.removeLabel(this.isometrySECircleLabel.id),L.store.removeCircle(this.lastState),this.isometrySECircle.unregisterChild(this.isometrySECircleLabel),this.parentIsometry.unregisterChild(this.isometrySECircle),this.preimageSECircle.unregisterChild(this.isometrySECircle)}toOpcode(){return["AddIsometryCircle","objectName="+L.symbolToASCIIDec(this.isometrySECircle.name),"objectExists="+this.isometrySECircle.exists,"objectShowing="+this.isometrySECircle.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySECircle.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySECircle.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.isometrySECircleLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySECircleLabel.ref.currentStyleState(q.Label))),"labelVector="+this.isometrySECircleLabel.ref._locationVector.toFixed(9),"labelShowing="+this.isometrySECircleLabel.showing,"labelExists="+this.isometrySECircleLabel.exists,"isometryCircleParentName="+this.preimageSECircle.name,"isometryCircleParentIsometryName="+this.parentIsometry.name,"isometryCircleCenterSEPointName="+L.symbolToASCIIDec(this.isometrySECircle.centerSEPoint.name),"isometryCircleCircleSEPointName="+L.symbolToASCIIDec(this.isometrySECircle.circleSEPoint.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((u,h)=>{if(h===0)return;const d=u.split("=");s.set(d[0],L.asciiDecToSymbol(d[1]))});const o=n.get(s.get("isometryCircleParentName")??""),a=n.get(s.get("isometryCircleParentIsometryName")??""),l=n.get(s.get("isometryCircleCenterSEPointName")??""),c=n.get(s.get("isometryCircleCircleSEPointName")??"");if(o&&a&&c&&l){const u=new Jg(l,c,o,a),h=s.get("objectFrontStyle");h!==void 0&&u.updatePlottableStyle(q.Front,JSON.parse(h));const d=s.get("objectBackStyle");d!==void 0&&u.updatePlottableStyle(q.Back,JSON.parse(d));const f=new De("circle",u),m=new k;m.from(s.get("labelVector")),f.locationVector.copy(m);const g=s.get("labelStyle");if(g!==void 0&&f.updatePlottableStyle(q.Label,JSON.parse(g)),s.get("objectName")!==void 0)u.name=s.get("objectName")??"",u.showing=s.get("objectShowing")==="true",u.exists=s.get("objectExists")==="true",n.set(u.name,u);else throw new Error("AddIsometrySECircle: Circle Name doesn't exist");if(s.get("labelName")!==void 0)f.name=s.get("labelName")??"",f.showing=s.get("labelShowing")==="true",f.exists=s.get("labelExists")==="true",n.set(f.name,f);else throw new Error("AddIsometrySECircle: Label Name doesn't exist");return new rE(u,f,o,a)}throw new Error(`AddIsometryCircle: ${o} or ${a} or ${l} or ${c} is undefined`)}}class sE extends L{constructor(i,n,r,s){super();y(this,"preimageSEEllipse");y(this,"parentIsometry");y(this,"isometrySEEllipse");y(this,"isometrySEEllipseLabel");this.preimageSEEllipse=r,this.isometrySEEllipse=i,this.parentIsometry=s,this.isometrySEEllipseLabel=n}do(){this.preimageSEEllipse.registerChild(this.isometrySEEllipse),this.parentIsometry.registerChild(this.isometrySEEllipse),this.isometrySEEllipse.registerChild(this.isometrySEEllipseLabel),L.store.addEllipse(this.isometrySEEllipse),L.store.addLabel(this.isometrySEEllipseLabel)}saveState(){this.lastState=this.isometrySEEllipse.id}restoreState(){L.store.removeLabel(this.isometrySEEllipseLabel.id),L.store.removeEllipse(this.lastState),this.isometrySEEllipse.unregisterChild(this.isometrySEEllipseLabel),this.parentIsometry.unregisterChild(this.isometrySEEllipse),this.preimageSEEllipse.unregisterChild(this.isometrySEEllipse)}toOpcode(){return["AddIsometryEllipse","objectName="+L.symbolToASCIIDec(this.isometrySEEllipse.name),"objectExists="+this.isometrySEEllipse.exists,"objectShowing="+this.isometrySEEllipse.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySEEllipse.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySEEllipse.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.isometrySEEllipseLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.isometrySEEllipseLabel.ref.currentStyleState(q.Label))),"labelVector="+this.isometrySEEllipseLabel.ref._locationVector.toFixed(9),"labelShowing="+this.isometrySEEllipseLabel.showing,"labelExists="+this.isometrySEEllipseLabel.exists,"isometryEllipseParentName="+this.preimageSEEllipse.name,"isometryEllipseParentIsometryName="+this.parentIsometry.name,"isometryEllipseFocus1SEPointName="+L.symbolToASCIIDec(this.isometrySEEllipse.focus1SEPoint.name),"isometryEllipseFocus2SEPointName="+L.symbolToASCIIDec(this.isometrySEEllipse.focus2SEPoint.name),"isometryEllipseEllipseSEPointName="+L.symbolToASCIIDec(this.isometrySEEllipse.ellipseSEPoint.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((h,d)=>{if(d===0)return;const f=h.split("=");s.set(f[0],L.asciiDecToSymbol(f[1]))});const o=n.get(s.get("isometryEllipseParentName")??""),a=n.get(s.get("isometryEllipseParentIsometryName")??""),l=n.get(s.get("isometryEllipseFocus1SEPointName")??""),c=n.get(s.get("isometryEllipseFocus2SEPointName")??""),u=n.get(s.get("isometryEllipseEllipseSEPointName")??"");if(o&&a&&u&&l&&c){const h=new Qg(l,c,u,o,a),d=s.get("objectFrontStyle");d!==void 0&&h.updatePlottableStyle(q.Front,JSON.parse(d));const f=s.get("objectBackStyle");f!==void 0&&h.updatePlottableStyle(q.Back,JSON.parse(f));const m=new De("ellipse",h),g=new k;g.from(s.get("labelVector")),m.locationVector.copy(g);const v=s.get("labelStyle");if(v!==void 0&&m.updatePlottableStyle(q.Label,JSON.parse(v)),s.get("objectName")!==void 0)h.name=s.get("objectName")??"",h.showing=s.get("objectShowing")==="true",h.exists=s.get("objectExists")==="true",n.set(h.name,h);else throw new Error("AddIsometrySEEllipse: Ellipse Name doesn't exist");if(s.get("labelName")!==void 0)m.name=s.get("labelName")??"",m.showing=s.get("labelShowing")==="true",m.exists=s.get("labelExists")==="true",n.set(m.name,m);else throw new Error("AddIsometrySEEllipse: Label Name doesn't exist");return new sE(h,m,o,a)}throw new Error(`AddIsometryEllipse: ${o} or ${a} or ${l} or ${u} is undefined`)}}class oE extends L{constructor(i,n,r,s,o){super();y(this,"preimageSECircleOrLine");y(this,"parentInversion");y(this,"invertedSECircleCenter");y(this,"invertedSECircleCenterLabel");y(this,"useVisiblePointCountToRename");this.preimageSECircleOrLine=r,this.invertedSECircleCenter=i,this.parentInversion=s,this.invertedSECircleCenterLabel=n,o!==void 0?this.useVisiblePointCountToRename=o:this.useVisiblePointCountToRename=!0}do(){this.preimageSECircleOrLine.registerChild(this.invertedSECircleCenter),this.parentInversion.registerChild(this.invertedSECircleCenter),this.invertedSECircleCenter.registerChild(this.invertedSECircleCenterLabel),L.store.addPoint(this.invertedSECircleCenter),L.store.addLabel(this.invertedSECircleCenterLabel),this.invertedSECircleCenter.pointVisibleBefore=!0,this.invertedSECircleCenter.label&&this.useVisiblePointCountToRename&&(this.invertedSECircleCenter.incrementVisiblePointCount(),this.invertedSECircleCenter.label.ref.shortUserName=`P${this.invertedSECircleCenter.visiblePointCount}`)}saveState(){this.lastState=this.invertedSECircleCenter.id}restoreState(){this.invertedSECircleCenter.label&&this.useVisiblePointCountToRename&&(this.invertedSECircleCenter.decrementVisiblePointCount(),this.invertedSECircleCenter.label.ref.shortUserName=`P${this.invertedSECircleCenter.visiblePointCount}`),this.invertedSECircleCenter.pointVisibleBefore=!1,L.store.removeLabel(this.invertedSECircleCenterLabel.id),L.store.removePoint(this.lastState),this.invertedSECircleCenter.unregisterChild(this.invertedSECircleCenterLabel),this.parentInversion.unregisterChild(this.invertedSECircleCenter),this.preimageSECircleOrLine.unregisterChild(this.invertedSECircleCenter)}toOpcode(){return["AddInvertedCircleCenter","objectName="+L.symbolToASCIIDec(this.invertedSECircleCenter.name),"objectExists="+this.invertedSECircleCenter.exists,"objectShowing="+this.invertedSECircleCenter.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.invertedSECircleCenter.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.invertedSECircleCenter.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.invertedSECircleCenterLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.invertedSECircleCenterLabel.ref.currentStyleState(q.Label))),"labelVector="+this.invertedSECircleCenterLabel.ref._locationVector.toFixed(9),"labelShowing="+this.invertedSECircleCenterLabel.showing,"labelExists="+this.invertedSECircleCenterLabel.exists,"invertedCircleCenterLineOrCircleParentName="+this.preimageSECircleOrLine.name,"invertedCircleCenterParentInversionName="+this.parentInversion.name].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("invertedCircleCenterLineOrCircleParentName")??""),a=n.get(s.get("invertedCircleCenterParentInversionName")??"");if(o&&a){const l=new jc(o,a),c=s.get("objectFrontStyle");c!==void 0&&l.updatePlottableStyle(q.Front,JSON.parse(c));const u=s.get("objectBackStyle");u!==void 0&&l.updatePlottableStyle(q.Back,JSON.parse(u));const h=new De("point",l),d=new k;d.from(s.get("labelVector")),h.locationVector.copy(d);const f=s.get("labelStyle");if(f!==void 0&&h.updatePlottableStyle(q.Label,JSON.parse(f)),s.get("objectName")!==void 0)l.name=s.get("objectName")??"",l.showing=s.get("objectShowing")==="true",l.exists=s.get("objectExists")==="true",n.set(l.name,l);else throw new Error("AddInvertedSECircleCenter: Center Point Name doesn't exist");if(s.get("labelName")!==void 0)h.name=s.get("labelName")??"",h.showing=s.get("labelShowing")==="true",h.exists=s.get("labelExists")==="true",n.set(h.name,h);else throw new Error("AddInvertedSECircleCenter: Label Name doesn't exist");return new oE(l,h,o,a,!1)}throw new Error(`AddInversionCircleCenter: ${o} or ${a} is undefined`)}}class Dm extends L{constructor(i,n){super();y(this,"seOtherParent");y(this,"seIntersectionPoint");this.seOtherParent=n,this.seIntersectionPoint=i}do(){this.seIntersectionPoint.removeIntersectionOtherParent(this.seOtherParent)}saveState(){this.lastState=this.seIntersectionPoint.id}restoreState(){this.seIntersectionPoint.addIntersectionOtherParent(this.seOtherParent)}toOpcode(){return["RemoveIntersectionPointOtherParent","intersectionPointName="+this.seIntersectionPoint.name,"intersectionPointOtherParentName="+this.seOtherParent.name].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("intersectionPointName")??""),a=n.get(s.get("intersectionPointOtherParentName")??"");if(o&&a)return new Dm(o,a);throw new Error(`RemoveIntersectionPointOtherParentCommand: ${o} or ${a} is undefined`)}}class ey extends L{constructor(i){super();y(this,"seNodule");y(this,"parentIds",[]);this.seNodule=i,this.seNodule.parents.forEach(n=>{this.parentIds.push(n.id)})}do(){for(let i=0;i<this.parentIds.length;i++){const n=L.store.getSENoduleById(this.parentIds[i]);if(n)n.unregisterChild(this.seNodule);else throw`Attempted to unregister child ${this.seNodule} from a non-existent nodule with ID ${this.parentIds[i]} in the DeleteNoduleCommand`}this.seNodule instanceof Ze?L.store.removePoint(this.seNodule.id):this.seNodule instanceof $t?L.store.removeLine(this.seNodule.id):this.seNodule instanceof Kt?L.store.removeCircle(this.seNodule.id):this.seNodule instanceof Ii?L.store.removeEllipse(this.seNodule.id):this.seNodule instanceof tn?L.store.removeParametric(this.seNodule.id):this.seNodule instanceof Jt?L.store.removeSegment(this.seNodule.id):this.seNodule instanceof De?L.store.removeLabel(this.seNodule.id):this.seNodule instanceof en?L.store.removeAngleMarkerAndExpression(this.seNodule.id):this.seNodule instanceof Ks?L.store.removePolygonAndExpression(this.seNodule.id):this.seNodule instanceof On?(L.store.removeExpression(this.seNodule.id),this.seNodule instanceof ws?this.seNodule.seSegment.label&&(this.seNodule.seSegment.label.ref.value=[]):this.seNodule instanceof ma&&L.store.expressions.filter(i=>i instanceof ma).every(i=>i.sePoint.name!==this.seNodule.sePoint.name)&&this.seNodule.sePoint.label&&(this.seNodule.sePoint.label.ref.value=[])):this.seNodule instanceof $n&&L.store.removeTransformation(this.seNodule.id)}saveState(){this.lastState=this.seNodule.id}restoreState(){this.seNodule instanceof $n?L.store.addTransformation(this.seNodule):this.seNodule instanceof Ks?L.store.addPolygonAndExpression(this.seNodule):this.seNodule instanceof en?L.store.addAngleMarkerAndExpression(this.seNodule):this.seNodule instanceof On?L.store.addExpression(this.seNodule):this.seNodule instanceof De?L.store.addLabel(this.seNodule):this.seNodule instanceof Jt?L.store.addSegment(this.seNodule):this.seNodule instanceof tn?L.store.addParametric(this.seNodule):this.seNodule instanceof Ii?L.store.addEllipse(this.seNodule):this.seNodule instanceof Kt?L.store.addCircle(this.seNodule):this.seNodule instanceof $t?L.store.addLine(this.seNodule):this.seNodule instanceof Ze&&L.store.addPoint(this.seNodule);for(let i=this.parentIds.length-1;i>-1;i--){const n=L.store.getSENoduleById(this.parentIds[i]);if(n)n.registerChild(this.seNodule);else throw`Attempted to register child${this.seNodule}to a non-existent nodule with ID${this.parentIds[i]}in the DeleteNoduleCommand`}}toOpcode(){return["DeleteNodule","objectName="+L.symbolToASCIIDec(this.seNodule.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((a,l)=>{if(l===0)return;const c=a.split("=");s.set(c[0],L.asciiDecToSymbol(c[1]))});const o=n.get(s.get("objectName")??"");if(o)return new ey(o);throw new Error("DeleteNoduleCommand: nodule is undefined")}}class ty extends L{constructor(i,n){super();y(this,"oldPrincipleParent");y(this,"seIntersectionPoint");y(this,"newPrincipleParent",null);this.seIntersectionPoint=i,this.oldPrincipleParent=n}do(){if(this.newPrincipleParent=this.seIntersectionPoint.removePrincipleParent(this.oldPrincipleParent),this.newPrincipleParent)this.newPrincipleParent.registerChild(this.seIntersectionPoint),this.oldPrincipleParent.unregisterChild(this.seIntersectionPoint);else throw new Error(`ChangeIntersectionPointPrincipleParent: Can't remove principle parent ${this.oldPrincipleParent.name} from intersection point ${this.seIntersectionPoint.name} `)}saveState(){this.lastState=this.seIntersectionPoint.id}restoreState(){this.newPrincipleParent&&(this.oldPrincipleParent.registerChild(this.seIntersectionPoint),this.newPrincipleParent.unregisterChild(this.seIntersectionPoint),this.seIntersectionPoint.replacePrincipleParent(this.newPrincipleParent,this.oldPrincipleParent))}toOpcode(){return["ChangeIntersectionPointPrinciplePoint","changePrincipleParentSEIntersectionPointName="+L.symbolToASCIIDec(this.seIntersectionPoint.name),"changePrincipleParentOldPrincipleName="+L.symbolToASCIIDec(this.oldPrincipleParent.name)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((l,c)=>{if(c===0)return;const u=l.split("=");s.set(u[0],L.asciiDecToSymbol(u[1]))});const o=n.get(s.get("changePrincipleParentSEIntersectionPointName")??""),a=n.get(s.get("changePrincipleParentOldPrincipleName")??"");if(o&&a)return new ty(o,a);throw new Error(`Change Principle Parent Command: SEIntersection point ${o} or old principle parent ${a} doesn't exist`)}}class aE extends L{constructor(i){super();y(this,"showing");this.showing=i}do(){L.store.isEarthMode=this.showing}saveState(){}restoreState(){L.store.isEarthMode=!this.showing}toOpcode(){return["SetEarthMode","objectShowing="+this.showing].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;if(r.forEach((o,a)=>{if(a===0)return;const l=o.split("=");s.set(l[0],L.asciiDecToSymbol(l[1]))}),s.get("objectShowing")!==void 0)return new aE(s.get("objectShowing")==="true");throw new Error('SetEarthModeDisplayCommand: "objectShowing" is undefined')}}class iy extends L{constructor(i,n){super();y(this,"seLatitude");y(this,"seLabel");y(this,"latitude");this.seLatitude=i,this.latitude=this.seLatitude.latitude,this.seLabel=n}do(){L.store.addLabel(this.seLabel),this.seLatitude.registerChild(this.seLabel),L.store.addCircle(this.seLatitude)}saveState(){this.lastState=this.seLatitude.id}restoreState(){L.store.removeCircle(this.lastState),this.seLatitude.unregisterChild(this.seLabel),L.store.removeLabel(this.seLabel.id)}toOpcode(){return["AddLatitude","objectName="+L.symbolToASCIIDec(this.seLatitude.name),"objectExists="+this.seLatitude.exists,"objectShowing="+this.seLatitude.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLatitude.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLatitude.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"earthLatitude="+this.seLatitude.latitude.toFixed(9)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((c,u)=>{if(u===0)return;const h=c.split("=");s.set(h[0],L.asciiDecToSymbol(h[1]))});const o=s.get("objectFrontStyle"),a=s.get("objectBackStyle"),l=Number(s.get("earthLatitude"));if(l!==void 0){const c=new du(l);o!==void 0&&c.updatePlottableStyle(q.Front,JSON.parse(o)),a!==void 0&&c.updatePlottableStyle(q.Back,JSON.parse(a));const u=new De("circle",c),h=new k;h.from(s.get("labelVector")),u.locationVector.copy(h);const d=s.get("labelStyle");if(d!==void 0&&u.updatePlottableStyle(q.Label,JSON.parse(d)),s.get("objectName")!==void 0)c.name=s.get("objectName")??"",c.showing=s.get("objectShowing")==="true",c.exists=s.get("objectExists")==="true",n.set(c.name,c);else throw new Error("AddLatitude: Circle name doesn't exist");if(s.get("labelName")!==void 0)u.name=s.get("labelName")??"",u.showing=s.get("labelShowing")==="true",u.exists=s.get("labelExists")==="true",n.set(u.name,u);else throw new Error("AddLatitude: Label Name doesn't exist");return new iy(c,u)}else throw new Error("AddLatitudeCommand: Latitude undefined")}}class ny extends L{constructor(i,n){super();y(this,"seLongitude");y(this,"seLabel");y(this,"longitude");this.seLongitude=i,this.longitude=this.seLongitude.longitude,this.seLabel=n}do(){L.store.addLabel(this.seLabel),this.seLongitude.registerChild(this.seLabel),L.store.addSegment(this.seLongitude)}saveState(){this.lastState=this.seLongitude.id}restoreState(){L.store.removeSegment(this.lastState),this.seLongitude.unregisterChild(this.seLabel),L.store.removeLabel(this.seLabel.id)}toOpcode(){return["AddLongitude","objectName="+L.symbolToASCIIDec(this.seLongitude.name),"objectExists="+this.seLongitude.exists,"objectShowing="+this.seLongitude.showing,"objectFrontStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLongitude.ref.currentStyleState(q.Front))),"objectBackStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLongitude.ref.currentStyleState(q.Back))),"labelName="+L.symbolToASCIIDec(this.seLabel.name),"labelStyle="+L.symbolToASCIIDec(JSON.stringify(this.seLabel.ref.currentStyleState(q.Label))),"labelVector="+this.seLabel.ref._locationVector.toFixed(9),"labelShowing="+this.seLabel.showing,"labelExists="+this.seLabel.exists,"earthLongitude="+this.seLongitude.longitude.toFixed(9)].join("&")}static parse(i,n){const r=i.split("&"),s=new Map;r.forEach((c,u)=>{if(u===0)return;const h=c.split("=");s.set(h[0],L.asciiDecToSymbol(h[1]))});const o=s.get("objectFrontStyle"),a=s.get("objectBackStyle"),l=Number(s.get("earthLongitude"));if(l!==void 0){const c=new fu(l);o!==void 0&&c.updatePlottableStyle(q.Front,JSON.parse(o)),a!==void 0&&c.updatePlottableStyle(q.Back,JSON.parse(a));const u=new De("segment",c),h=new k;h.from(s.get("labelVector")),u.locationVector.copy(h);const d=s.get("labelStyle");if(d!==void 0&&u.updatePlottableStyle(q.Label,JSON.parse(d)),s.get("objectName")!==void 0)c.name=s.get("objectName")??"",c.showing=s.get("objectShowing")==="true",c.exists=s.get("objectExists")==="true",n.set(c.name,c);else throw new Error("AddLongitude: Segment name doesn't exist");if(s.get("labelName")!==void 0)u.name=s.get("labelName")??"",u.showing=s.get("labelShowing")==="true",u.exists=s.get("labelExists")==="true",n.set(u.name,u);else throw new Error("AddLongitude: Label Name doesn't exist");return new ny(c,u)}else throw new Error("AddLongitudeCommand: Longitude undefined")}}const Yt=new Map;function hR(t){const e=t.indexOf("&");if(e<0){const n=`Invalid command format: ${t}`;throw $.fire("show-alert",{key:n,type:"error"}),new Error(n)}switch(t.substring(0,e)){case"AddPoint":return Mn.parse(t,Yt);case"AddPointOnOneDimensional":return zt.parse(t,Yt);case"AddIntersectionPoint":return ir.parse(t,Yt);case"AddIntersectionPointOtherParent":return nr.parse(t,Yt);case"RemoveIntersectionPointOtherParent":return Dm.parse(t,Yt);case"AddLongitude":return ny.parse(t,Yt);case"AddLatitude":return iy.parse(t,Yt);case"AddEarthPoint":return up.parse(t,Yt);case"AddSegment":return Yy.parse(t,Yt);case"AddLine":return $P.parse(t,Yt);case"AddCircle":return Kp.parse(t,Yt);case"AddMeasuredCircle":return JP.parse(t,Yt);case"AddEllipse":return GP.parse(t,Yt);case"AddThreePointCircleCenter":return ZP.parse(t,Yt);case"AddAntipodalPoint":return qp.parse(t,Yt);case"AddPolarPoint":return Yv.parse(t,Yt);case"AddPolarLine":return YP.parse(t,Yt);case"AddPerpendicularLineThruPoint":return WP.parse(t,Yt);case"AddTangentLineThruPoint":return qP.parse(t,Yt);case"AddAngleMarker":return Yc.parse(t,Yt);case"AddPolygon":return HP.parse(t,Yt);case"AddPointCoordinateMeasurement":return Fc.parse(t,Yt);case"AddPointDistanceMeasurement":return ff.parse(t,Yt);case"AddLengthMeasurement":return Fu.parse(t,Yt);case"AddCalculation":return NP.parse(t,Yt);case"AddParametric":return zP.parse(t,Yt);case"AddParametricEndPoints":return UP.parse(t,Yt);case"AddParametricTracePoint":return BP.parse(t,Yt);case"AddNSectPoint":return XP.parse(t,Yt);case"AddNSectLine":return KP.parse(t,Yt);case"AddSliderMeasurement":return jP.parse(t,Yt);case"AddTranslation":return QP.parse(t,Yt);case"AddRotation":return eE.parse(t,Yt);case"AddReflection":return Zv.parse(t,Yt);case"AddPointReflection":return Qv.parse(t,Yt);case"AddInversion":return Jv.parse(t,Yt);case"AddTransformedPoint":return tE.parse(t,Yt);case"AddIsometrySegment":return iE.parse(t,Yt);case"AddIsometryLine":return nE.parse(t,Yt);case"AddIsometryCircle":return rE.parse(t,Yt);case"AddIsometryEllipse":return sE.parse(t,Yt);case"AddInvertedCircleCenter":return oE.parse(t,Yt);case"DeleteNodule":return ey.parse(t,Yt);case"ChangeIntersectionPointPrinciplePoint":return ty.parse(t,Yt);case"SetNoduleDisplay":return qi.parse(t,Yt);case"SetEarthMode":return aE.parse(t,Yt);case"SetValueDisplayMode":return Hp.parse(t,Yt);default:{const n=`Not yet implemented: ${t}`;throw $.fire("show-alert",{key:`Not yet implemented ${n}`,type:"error"}),new Error(n)}}}function fhe(t){if(typeof t=="string")hR(t).execute();else{const e=new Dt;t.map(i=>i.replace(/^"/,"").replace(/"$/,"")).forEach(i=>{e.addCommand(hR(i))}),e.execute()}}function _C(t){Yt.clear(),L.commandHistory.splice(0),L.redoHistory.splice(0),t.forEach(e=>{fhe(e)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N5="firebasestorage.googleapis.com",R5="storageBucket",mhe=2*60*1e3,phe=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn extends Pc{constructor(e,i,n=0){super(BT(e),`Firebase Storage: ${i} (${BT(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Kn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return BT(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Wn;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Wn||(Wn={}));function BT(t){return"storage/"+t}function sA(){const t="An unknown error occurred, please check the error payload for server response.";return new Kn(Wn.UNKNOWN,t)}function ghe(t){return new Kn(Wn.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function vhe(t){return new Kn(Wn.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function yhe(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Kn(Wn.UNAUTHENTICATED,t)}function She(){return new Kn(Wn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function bhe(t){return new Kn(Wn.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function _he(){return new Kn(Wn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Phe(){return new Kn(Wn.CANCELED,"User canceled the upload/download.")}function Ehe(t){return new Kn(Wn.INVALID_URL,"Invalid URL '"+t+"'.")}function whe(t){return new Kn(Wn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function The(){return new Kn(Wn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+R5+"' property when initializing the app?")}function xhe(){return new Kn(Wn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function khe(){return new Kn(Wn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Che(t){return new Kn(Wn.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function PC(t){return new Kn(Wn.INVALID_ARGUMENT,t)}function F5(){return new Kn(Wn.APP_DELETED,"The Firebase app was deleted.")}function Mhe(t){return new Kn(Wn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function rv(t,e){return new Kn(Wn.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Tg(t){throw new Kn(Wn.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,i){this.bucket=e,this.path_=i}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,i){let n;try{n=Yo.makeFromUrl(e,i)}catch{return new Yo(e,"")}if(n.path==="")return n;throw whe(e)}static makeFromUrl(e,i){let n=null;const r="([A-Za-z0-9.\\-_]+)";function s(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function c(P){P.path_=decodeURIComponent(P.path)}const u="v[A-Za-z0-9_]+",h=i.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${r}/o${d}`,"i"),m={bucket:1,path:3},g=i===N5?"(?:storage.googleapis.com|storage.cloud.google.com)":i,v="([^?#]*)",p=new RegExp(`^https?://${g}/${r}/${v}`,"i"),_=[{regex:a,indices:l,postModify:s},{regex:f,indices:m,postModify:c},{regex:p,indices:{bucket:1,path:2},postModify:c}];for(let P=0;P<_.length;P++){const E=_[P],T=E.regex.exec(e);if(T){const C=T[E.indices.bucket];let M=T[E.indices.path];M||(M=""),n=new Yo(C,M),E.postModify(n);break}}if(n==null)throw Ehe(e);return n}}class Ahe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vhe(t,e,i){let n=1,r=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...v){c||(c=!0,e.apply(null,v))}function h(v){r=setTimeout(()=>{r=null,t(f,l())},v)}function d(){s&&clearTimeout(s)}function f(v,...p){if(c){d();return}if(v){d(),u.call(null,v,...p);return}if(l()||o){d(),u.call(null,v,...p);return}n<64&&(n*=2);let _;a===1?(a=2,_=0):_=(n+Math.random())*1e3,h(_)}let m=!1;function g(v){m||(m=!0,d(),!c&&(r!==null?(v||(a=2),clearTimeout(r),h(0)):v||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,g(!0)},i),g}function Lhe(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ihe(t){return t!==void 0}function Ohe(t){return typeof t=="object"&&!Array.isArray(t)}function oA(t){return typeof t=="string"||t instanceof String}function uR(t){return aA()&&t instanceof Blob}function aA(){return typeof Blob<"u"&&!pK()}function dR(t,e,i,n){if(n<e)throw PC(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>i)throw PC(`Invalid value for '${t}'. Expected ${i} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(t,e,i){let n=e;return i==null&&(n=`https://${e}`),`${i}://${n}/v0${t}`}function z5(t){const e=encodeURIComponent;let i="?";for(const n in t)if(t.hasOwnProperty(n)){const r=e(n)+"="+e(t[n]);i=i+r+"&"}return i=i.slice(0,-1),i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ld;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ld||(Ld={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dhe(t,e){const i=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return i||r||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nhe{constructor(e,i,n,r,s,o,a,l,c,u,h,d=!0){this.url_=e,this.method_=i,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,m)=>{this.resolve_=f,this.reject_=m,this.start_()})}start_(){const e=(n,r)=>{if(r){n(!1,new xb(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Ld.NO_ERROR,l=s.getStatus();if(!a||Dhe(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===Ld.ABORT;n(!1,new xb(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new xb(c,s))})},i=(n,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());Ihe(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=sA();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){const l=this.appDelete_?F5():Phe();o(l)}else{const l=_he();o(l)}};this.canceled_?i(!1,new xb(!1,null,!0)):this.backoffId_=Vhe(e,i,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Lhe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class xb{constructor(e,i,n){this.wasSuccessCode=e,this.connection=i,this.canceled=!!n}}function Rhe(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Fhe(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function zhe(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Uhe(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function Bhe(t,e,i,n,r,s,o=!0){const a=z5(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return zhe(c,e),Rhe(c,i),Fhe(c,s),Uhe(c,n),new Nhe(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jhe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function $he(...t){const e=jhe();if(e!==void 0){const i=new e;for(let n=0;n<t.length;n++)i.append(t[n]);return i.getBlob()}else{if(aA())return new Blob(t);throw new Kn(Wn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Whe(t,e,i){return t.webkitSlice?t.webkitSlice(e,i):t.mozSlice?t.mozSlice(e,i):t.slice?t.slice(e,i):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ghe(t){if(typeof atob>"u")throw Che("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dl={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class jT{constructor(e,i){this.data=e,this.contentType=i||null}}function U5(t,e){switch(t){case dl.RAW:return new jT(B5(e));case dl.BASE64:case dl.BASE64URL:return new jT(j5(t,e));case dl.DATA_URL:return new jT(qhe(e),Khe(e))}throw sA()}function B5(t){const e=[];for(let i=0;i<t.length;i++){let n=t.charCodeAt(i);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(i<t.length-1&&(t.charCodeAt(i+1)&64512)===56320))e.push(239,191,189);else{const s=n,o=t.charCodeAt(++i);n=65536|(s&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function Hhe(t){let e;try{e=decodeURIComponent(t)}catch{throw rv(dl.DATA_URL,"Malformed data URL.")}return B5(e)}function j5(t,e){switch(t){case dl.BASE64:{const r=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(r||s)throw rv(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case dl.BASE64URL:{const r=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(r||s)throw rv(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let i;try{i=Ghe(e)}catch(r){throw r.message.includes("polyfill")?r:rv(t,"Invalid character found")}const n=new Uint8Array(i.length);for(let r=0;r<i.length;r++)n[r]=i.charCodeAt(r);return n}class $5{constructor(e){this.base64=!1,this.contentType=null;const i=e.match(/^data:([^,]+)?,/);if(i===null)throw rv(dl.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=i[1]||null;n!=null&&(this.base64=Xhe(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function qhe(t){const e=new $5(t);return e.base64?j5(dl.BASE64,e.rest):Hhe(e.rest)}function Khe(t){return new $5(t).contentType}function Xhe(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,i){let n=0,r="";uR(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(i?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(i?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,i){if(uR(this.data_)){const n=this.data_,r=Whe(n,e,i);return r===null?null:new ou(r)}else{const n=new Uint8Array(this.data_.buffer,e,i-e);return new ou(n,!0)}}static getBlob(...e){if(aA()){const i=e.map(n=>n instanceof ou?n.data_:n);return new ou($he.apply(null,i))}else{const i=e.map(o=>oA(o)?U5(dl.RAW,o).data:o.data_);let n=0;i.forEach(o=>{n+=o.byteLength});const r=new Uint8Array(n);let s=0;return i.forEach(o=>{for(let a=0;a<o.length;a++)r[s++]=o[a]}),new ou(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W5(t){let e;try{e=JSON.parse(t)}catch{return null}return Ohe(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yhe(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Zhe(t,e){const i=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?i:t+"/"+i}function G5(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jhe(t,e){return e}class Ns{constructor(e,i,n,r){this.server=e,this.local=i||e,this.writable=!!n,this.xform=r||Jhe}}let kb=null;function Qhe(t){return!oA(t)||t.length<2?t:G5(t)}function H5(){if(kb)return kb;const t=[];t.push(new Ns("bucket")),t.push(new Ns("generation")),t.push(new Ns("metageneration")),t.push(new Ns("name","fullPath",!0));function e(s,o){return Qhe(o)}const i=new Ns("name");i.xform=e,t.push(i);function n(s,o){return o!==void 0?Number(o):o}const r=new Ns("size");return r.xform=n,t.push(r),t.push(new Ns("timeCreated")),t.push(new Ns("updated")),t.push(new Ns("md5Hash",null,!0)),t.push(new Ns("cacheControl",null,!0)),t.push(new Ns("contentDisposition",null,!0)),t.push(new Ns("contentEncoding",null,!0)),t.push(new Ns("contentLanguage",null,!0)),t.push(new Ns("contentType",null,!0)),t.push(new Ns("metadata","customMetadata",!0)),kb=t,kb}function eue(t,e){function i(){const n=t.bucket,r=t.fullPath,s=new Yo(n,r);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:i})}function tue(t,e,i){const n={};n.type="file";const r=i.length;for(let s=0;s<r;s++){const o=i[s];n[o.local]=o.xform(n,e[o.server])}return eue(n,t),n}function q5(t,e,i){const n=W5(e);return n===null?null:tue(t,n,i)}function iue(t,e,i,n){const r=W5(e);if(r===null||!oA(r.downloadTokens))return null;const s=r.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(c=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=lE(d,i,n),m=z5({alt:"media",token:c});return f+m})[0]}function nue(t,e){const i={},n=e.length;for(let r=0;r<n;r++){const s=e[r];s.writable&&(i[s.server]=t[s.local])}return JSON.stringify(i)}class lA{constructor(e,i,n,r){this.url=e,this.method=i,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K5(t){if(!t)throw sA()}function rue(t,e){function i(n,r){const s=q5(t,r,e);return K5(s!==null),s}return i}function sue(t,e){function i(n,r){const s=q5(t,r,e);return K5(s!==null),iue(s,r,t.host,t._protocol)}return i}function X5(t){function e(i,n){let r;return i.getStatus()===401?i.getErrorText().includes("Firebase App Check token is invalid")?r=She():r=yhe():i.getStatus()===402?r=vhe(t.bucket):i.getStatus()===403?r=bhe(t.path):r=n,r.status=i.getStatus(),r.serverResponse=n.serverResponse,r}return e}function Y5(t){const e=X5(t);function i(n,r){let s=e(n,r);return n.getStatus()===404&&(s=ghe(t.path)),s.serverResponse=r.serverResponse,s}return i}function oue(t,e,i){const n=e.fullServerUrl(),r=lE(n,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new lA(r,s,sue(t,i),o);return a.errorHandler=Y5(e),a}function aue(t,e){const i=e.fullServerUrl(),n=lE(i,t.host,t._protocol),r="DELETE",s=t.maxOperationRetryTime;function o(l,c){}const a=new lA(n,r,o,s);return a.successCodes=[200,204],a.errorHandler=Y5(e),a}function lue(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function cue(t,e,i){const n=Object.assign({},i);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=lue(null,e)),n}function hue(t,e,i,n,r){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let _="";for(let P=0;P<2;P++)_=_+Math.random().toString().slice(2);return _}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=cue(e,n,r),u=nue(c,i),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,d=`\r
--`+l+"--",f=ou.getBlob(h,n,d);if(f===null)throw xhe();const m={name:c.fullPath},g=lE(s,t.host,t._protocol),v="POST",p=t.maxUploadRetryTime,b=new lA(g,v,rue(t,i),p);return b.urlParams=m,b.headers=o,b.body=f.uploadData(),b.errorHandler=X5(e),b}class uue{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ld.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ld.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ld.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,i,n,r){if(this.sent_)throw Tg("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(i,e,!0),r!==void 0)for(const s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Tg("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Tg("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Tg("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Tg("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class due extends uue{initXhr(){this.xhr_.responseType="text"}}function cA(){return new due}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,i){this._service=e,i instanceof Yo?this._location=i:this._location=Yo.makeFromUrl(i,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,i){return new Gd(e,i)}get root(){const e=new Yo(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return G5(this._location.path)}get storage(){return this._service}get parent(){const e=Yhe(this._location.path);if(e===null)return null;const i=new Yo(this._location.bucket,e);return new Gd(this._service,i)}_throwIfRoot(e){if(this._location.path==="")throw Mhe(e)}}function Z5(t,e,i){t._throwIfRoot("uploadBytes");const n=hue(t.storage,t._location,H5(),new ou(e,!0),i);return t.storage.makeRequestWithTokens(n,cA).then(r=>({metadata:r,ref:t}))}function fue(t,e,i=dl.RAW,n){t._throwIfRoot("uploadString");const r=U5(i,e),s=Object.assign({},n);return s.contentType==null&&r.contentType!=null&&(s.contentType=r.contentType),Z5(t,r.data,s)}function mue(t){t._throwIfRoot("getDownloadURL");const e=oue(t.storage,t._location,H5());return t.storage.makeRequestWithTokens(e,cA).then(i=>{if(i===null)throw khe();return i})}function pue(t){t._throwIfRoot("deleteObject");const e=aue(t.storage,t._location);return t.storage.makeRequestWithTokens(e,cA)}function gue(t,e){const i=Zhe(t._location.path,e),n=new Yo(t._location.bucket,i);return new Gd(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vue(t){return/^[A-Za-z]+:\/\//.test(t)}function yue(t,e){return new Gd(t,e)}function J5(t,e){if(t instanceof hA){const i=t;if(i._bucket==null)throw The();const n=new Gd(i,i._bucket);return e!=null?J5(n,e):n}else return e!==void 0?gue(t,e):t}function Sue(t,e){if(e&&vue(e)){if(t instanceof hA)return yue(t,e);throw PC("To use ref(service, url), the first argument must be a Storage instance.")}else return J5(t,e)}function fR(t,e){const i=e==null?void 0:e[R5];return i==null?null:Yo.makeFromBucketSpec(i,t)}function bue(t,e,i,n={}){t.host=`${e}:${i}`,t._protocol="http";const{mockUserToken:r}=n;r&&(t._overrideAuthToken=typeof r=="string"?r:WB(r,t.app.options.projectId))}class hA{constructor(e,i,n,r,s){this.app=e,this._authProvider=i,this._appCheckProvider=n,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=N5,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=mhe,this._maxUploadRetryTime=phe,this._requests=new Set,r!=null?this._bucket=Yo.makeFromBucketSpec(r,this._host):this._bucket=fR(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Yo.makeFromBucketSpec(this._url,e):this._bucket=fR(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){dR("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){dR("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const i=await e.getToken();if(i!==null)return i.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Gd(this,e)}_makeRequest(e,i,n,r,s=!0){if(this._deleted)return new Ahe(F5());{const o=Bhe(e,this._appId,n,r,i,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,i){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,i,n,r).getPromise()}}const mR="@firebase/storage",pR="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5="storage";function _ue(t,e,i){return t=Nn(t),Z5(t,e,i)}function gR(t,e,i,n){return t=Nn(t),fue(t,e,i,n)}function dp(t){return t=Nn(t),mue(t)}function vR(t){return t=Nn(t),pue(t)}function Mu(t,e){return t=Nn(t),Sue(t,e)}function cE(t=SM(),e){t=Nn(t);const n=bP(t,Q5).getImmediate({identifier:e}),r=BB("storage");return r&&Pue(n,...r),n}function Pue(t,e,i,n={}){bue(t,e,i,n)}function Eue(t,{instanceIdentifier:e}){const i=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new hA(i,n,r,e,lf)}function wue(){zd(new ku(Q5,Eue,"PUBLIC").setMultipleInstances(!0)),tc(mR,pR,""),tc(mR,pR,"esm2017")}wue();var Tue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yt,uA=uA||{},oi=Tue||self;function hE(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Zy(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function xue(t){return Object.prototype.hasOwnProperty.call(t,$T)&&t[$T]||(t[$T]=++kue)}var $T="closure_uid_"+(1e9*Math.random()>>>0),kue=0;function Cue(t,e,i){return t.call.apply(t.bind,arguments)}function Mue(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function Ts(t,e,i){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ts=Cue:Ts=Mue,Ts.apply(null,arguments)}function Cb(t,e){var i=Array.prototype.slice.call(arguments,1);return function(){var n=i.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function qr(t,e){function i(){}i.prototype=e.prototype,t.$=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.ac=function(n,r,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(n,o)}}function zu(){this.s=this.s,this.o=this.o}var Aue=0;zu.prototype.s=!1;zu.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),Aue!=0)&&xue(this)};zu.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const ej=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let i=0;i<t.length;i++)if(i in t&&t[i]===e)return i;return-1};function dA(t){const e=t.length;if(0<e){const i=Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}return[]}function yR(t,e){for(let i=1;i<arguments.length;i++){const n=arguments[i];if(hE(n)){const r=t.length||0,s=n.length||0;t.length=r+s;for(let o=0;o<s;o++)t[r+o]=n[o]}else t.push(n)}}function xs(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}xs.prototype.h=function(){this.defaultPrevented=!0};var Vue=function(){if(!oi.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{oi.addEventListener("test",()=>{},e),oi.removeEventListener("test",()=>{},e)}catch{}return t}();function ry(t){return/^[\s\xa0]*$/.test(t)}function uE(){var t=oi.navigator;return t&&(t=t.userAgent)?t:""}function $l(t){return uE().indexOf(t)!=-1}function fA(t){return fA[" "](t),t}fA[" "]=function(){};function Lue(t,e){var i=wde;return Object.prototype.hasOwnProperty.call(i,t)?i[t]:i[t]=e(t)}var Iue=$l("Opera"),fp=$l("Trident")||$l("MSIE"),tj=$l("Edge"),EC=tj||fp,ij=$l("Gecko")&&!(uE().toLowerCase().indexOf("webkit")!=-1&&!$l("Edge"))&&!($l("Trident")||$l("MSIE"))&&!$l("Edge"),Oue=uE().toLowerCase().indexOf("webkit")!=-1&&!$l("Edge");function nj(){var t=oi.document;return t?t.documentMode:void 0}var wC;e:{var WT="",GT=function(){var t=uE();if(ij)return/rv:([^\);]+)(\)|;)/.exec(t);if(tj)return/Edge\/([\d\.]+)/.exec(t);if(fp)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Oue)return/WebKit\/(\S+)/.exec(t);if(Iue)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(GT&&(WT=GT?GT[1]:""),fp){var HT=nj();if(HT!=null&&HT>parseFloat(WT)){wC=String(HT);break e}}wC=WT}var TC;if(oi.document&&fp){var SR=nj();TC=SR||parseInt(wC,10)||void 0}else TC=void 0;var Due=TC;function sy(t,e){if(xs.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var i=this.type=t.type,n=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ij){e:{try{fA(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else i=="mouseover"?e=t.fromElement:i=="mouseout"&&(e=t.toElement);this.relatedTarget=e,n?(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Nue[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&sy.$.h.call(this)}}qr(sy,xs);var Nue={2:"touch",3:"pen",4:"mouse"};sy.prototype.h=function(){sy.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Jy="closure_listenable_"+(1e6*Math.random()|0),Rue=0;function Fue(t,e,i,n,r){this.listener=t,this.proxy=null,this.src=e,this.type=i,this.capture=!!n,this.la=r,this.key=++Rue,this.fa=this.ia=!1}function dE(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function mA(t,e,i){for(const n in t)e.call(i,t[n],n,t)}function zue(t,e){for(const i in t)e.call(void 0,t[i],i,t)}function rj(t){const e={};for(const i in t)e[i]=t[i];return e}const bR="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function sj(t,e){let i,n;for(let r=1;r<arguments.length;r++){n=arguments[r];for(i in n)t[i]=n[i];for(let s=0;s<bR.length;s++)i=bR[s],Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}}function fE(t){this.src=t,this.g={},this.h=0}fE.prototype.add=function(t,e,i,n,r){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=kC(t,e,n,r);return-1<o?(e=t[o],i||(e.ia=!1)):(e=new Fue(e,this.src,s,!!n,r),e.ia=i,t.push(e)),e};function xC(t,e){var i=e.type;if(i in t.g){var n=t.g[i],r=ej(n,e),s;(s=0<=r)&&Array.prototype.splice.call(n,r,1),s&&(dE(e),t.g[i].length==0&&(delete t.g[i],t.h--))}}function kC(t,e,i,n){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!i&&s.la==n)return r}return-1}var pA="closure_lm_"+(1e6*Math.random()|0),qT={};function oj(t,e,i,n,r){if(n&&n.once)return lj(t,e,i,n,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)oj(t,e[s],i,n,r);return null}return i=yA(i),t&&t[Jy]?t.O(e,i,Zy(n)?!!n.capture:!!n,r):aj(t,e,i,!1,n,r)}function aj(t,e,i,n,r,s){if(!e)throw Error("Invalid event type");var o=Zy(r)?!!r.capture:!!r,a=vA(t);if(a||(t[pA]=a=new fE(t)),i=a.add(e,i,n,o,s),i.proxy)return i;if(n=Uue(),i.proxy=n,n.src=t,n.listener=i,t.addEventListener)Vue||(r=o),r===void 0&&(r=!1),t.addEventListener(e.toString(),n,r);else if(t.attachEvent)t.attachEvent(hj(e.toString()),n);else if(t.addListener&&t.removeListener)t.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return i}function Uue(){function t(i){return e.call(t.src,t.listener,i)}const e=Bue;return t}function lj(t,e,i,n,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)lj(t,e[s],i,n,r);return null}return i=yA(i),t&&t[Jy]?t.P(e,i,Zy(n)?!!n.capture:!!n,r):aj(t,e,i,!0,n,r)}function cj(t,e,i,n,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)cj(t,e[s],i,n,r);else n=Zy(n)?!!n.capture:!!n,i=yA(i),t&&t[Jy]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],i=kC(s,i,n,r),-1<i&&(dE(s[i]),Array.prototype.splice.call(s,i,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=vA(t))&&(e=t.g[e.toString()],t=-1,e&&(t=kC(e,i,n,r)),(i=-1<t?e[t]:null)&&gA(i))}function gA(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Jy])xC(e.i,t);else{var i=t.type,n=t.proxy;e.removeEventListener?e.removeEventListener(i,n,t.capture):e.detachEvent?e.detachEvent(hj(i),n):e.addListener&&e.removeListener&&e.removeListener(n),(i=vA(e))?(xC(i,t),i.h==0&&(i.src=null,e[pA]=null)):dE(t)}}}function hj(t){return t in qT?qT[t]:qT[t]="on"+t}function Bue(t,e){if(t.fa)t=!0;else{e=new sy(e,this);var i=t.listener,n=t.la||t.src;t.ia&&gA(t),t=i.call(n,e)}return t}function vA(t){return t=t[pA],t instanceof fE?t:null}var KT="__closure_events_fn_"+(1e9*Math.random()>>>0);function yA(t){return typeof t=="function"?t:(t[KT]||(t[KT]=function(e){return t.handleEvent(e)}),t[KT])}function Hr(){zu.call(this),this.i=new fE(this),this.S=this,this.J=null}qr(Hr,zu);Hr.prototype[Jy]=!0;Hr.prototype.removeEventListener=function(t,e,i,n){cj(this,t,e,i,n)};function as(t,e){var i,n=t.J;if(n)for(i=[];n;n=n.J)i.push(n);if(t=t.S,n=e.type||e,typeof e=="string")e=new xs(e,t);else if(e instanceof xs)e.target=e.target||t;else{var r=e;e=new xs(n,t),sj(e,r)}if(r=!0,i)for(var s=i.length-1;0<=s;s--){var o=e.g=i[s];r=Mb(o,n,!0,e)&&r}if(o=e.g=t,r=Mb(o,n,!0,e)&&r,r=Mb(o,n,!1,e)&&r,i)for(s=0;s<i.length;s++)o=e.g=i[s],r=Mb(o,n,!1,e)&&r}Hr.prototype.N=function(){if(Hr.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var i=t.g[e],n=0;n<i.length;n++)dE(i[n]);delete t.g[e],t.h--}}this.J=null};Hr.prototype.O=function(t,e,i,n){return this.i.add(String(t),e,!1,i,n)};Hr.prototype.P=function(t,e,i,n){return this.i.add(String(t),e,!0,i,n)};function Mb(t,e,i,n){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==i){var a=o.listener,l=o.la||o.src;o.ia&&xC(t.i,o),r=a.call(l,n)!==!1&&r}}return r&&!n.defaultPrevented}var SA=oi.JSON.stringify;class jue{constructor(e,i){this.i=e,this.j=i,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function $ue(){var t=bA;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Wue{constructor(){this.h=this.g=null}add(e,i){const n=uj.get();n.set(e,i),this.h?this.h.next=n:this.g=n,this.h=n}}var uj=new jue(()=>new Gue,t=>t.reset());class Gue{constructor(){this.next=this.g=this.h=null}set(e,i){this.h=e,this.g=i,this.next=null}reset(){this.next=this.g=this.h=null}}function Hue(t){var e=1;t=t.split(":");const i=[];for(;0<e&&t.length;)i.push(t.shift()),e--;return t.length&&i.push(t.join(":")),i}function que(t){oi.setTimeout(()=>{throw t},0)}let oy,ay=!1,bA=new Wue,dj=()=>{const t=oi.Promise.resolve(void 0);oy=()=>{t.then(Kue)}};var Kue=()=>{for(var t;t=$ue();){try{t.h.call(t.g)}catch(i){que(i)}var e=uj;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ay=!1};function mE(t,e){Hr.call(this),this.h=t||1,this.g=e||oi,this.j=Ts(this.qb,this),this.l=Date.now()}qr(mE,Hr);yt=mE.prototype;yt.ga=!1;yt.T=null;yt.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),as(this,"tick"),this.ga&&(_A(this),this.start()))}};yt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function _A(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}yt.N=function(){mE.$.N.call(this),_A(this),delete this.g};function PA(t,e,i){if(typeof t=="function")i&&(t=Ts(t,i));else if(t&&typeof t.handleEvent=="function")t=Ts(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:oi.setTimeout(t,e||0)}function fj(t){t.g=PA(()=>{t.g=null,t.i&&(t.i=!1,fj(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class Xue extends zu{constructor(e,i){super(),this.m=e,this.j=i,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:fj(this)}N(){super.N(),this.g&&(oi.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ly(t){zu.call(this),this.h=t,this.g={}}qr(ly,zu);var _R=[];function mj(t,e,i,n){Array.isArray(i)||(i&&(_R[0]=i.toString()),i=_R);for(var r=0;r<i.length;r++){var s=oj(e,i[r],n||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function pj(t){mA(t.g,function(e,i){this.g.hasOwnProperty(i)&&gA(e)},t),t.g={}}ly.prototype.N=function(){ly.$.N.call(this),pj(this)};ly.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function pE(){this.g=!0}pE.prototype.Ea=function(){this.g=!1};function Yue(t,e,i,n,r,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+c+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+n+") [attempt "+r+"]: "+e+`
`+i+`
`+o})}function Zue(t,e,i,n,r,s,o){t.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+r+"]: "+e+`
`+i+`
`+s+" "+o})}function gm(t,e,i,n){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Que(t,i)+(n?" "+n:"")})}function Jue(t,e){t.info(function(){return"TIMEOUT: "+e})}pE.prototype.info=function(){};function Que(t,e){if(!t.g)return e;if(!e)return null;try{var i=JSON.parse(e);if(i){for(t=0;t<i.length;t++)if(Array.isArray(i[t])){var n=i[t];if(!(2>n.length)){var r=n[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return SA(i)}catch{return e}}var mf={},PR=null;function gE(){return PR=PR||new Hr}mf.Ta="serverreachability";function gj(t){xs.call(this,mf.Ta,t)}qr(gj,xs);function cy(t){const e=gE();as(e,new gj(e))}mf.STAT_EVENT="statevent";function vj(t,e){xs.call(this,mf.STAT_EVENT,t),this.stat=e}qr(vj,xs);function Xs(t){const e=gE();as(e,new vj(e,t))}mf.Ua="timingevent";function yj(t,e){xs.call(this,mf.Ua,t),this.size=e}qr(yj,xs);function Qy(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return oi.setTimeout(function(){t()},e)}var vE={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Sj={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function EA(){}EA.prototype.h=null;function ER(t){return t.h||(t.h=t.i())}function bj(){}var eS={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function wA(){xs.call(this,"d")}qr(wA,xs);function TA(){xs.call(this,"c")}qr(TA,xs);var CC;function yE(){}qr(yE,EA);yE.prototype.g=function(){return new XMLHttpRequest};yE.prototype.i=function(){return{}};CC=new yE;function tS(t,e,i,n){this.l=t,this.j=e,this.m=i,this.W=n||1,this.U=new ly(this),this.P=ede,t=EC?125:void 0,this.V=new mE(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new _j}function _j(){this.i=null,this.g="",this.h=!1}var ede=45e3,MC={},S_={};yt=tS.prototype;yt.setTimeout=function(t){this.P=t};function AC(t,e,i){t.L=1,t.v=bE(uh(e)),t.s=i,t.S=!0,Pj(t,null)}function Pj(t,e){t.G=Date.now(),iS(t),t.A=uh(t.v);var i=t.A,n=t.W;Array.isArray(n)||(n=[String(n)]),Aj(i.i,"t",n),t.C=0,i=t.l.J,t.h=new _j,t.g=Zj(t.l,i?e:null,!t.s),0<t.O&&(t.M=new Xue(Ts(t.Pa,t,t.g),t.O)),mj(t.U,t.g,"readystatechange",t.nb),e=t.I?rj(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),cy(),Yue(t.j,t.u,t.A,t.m,t.W,t.s)}yt.nb=function(t){t=t.target;const e=this.M;e&&Zl(t)==3?e.l():this.Pa(t)};yt.Pa=function(t){try{if(t==this.g)e:{const u=Zl(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>u)&&(u!=3||EC||this.g&&(this.h.h||this.g.ja()||kR(this.g)))){this.J||u!=4||e==7||(e==8||0>=h?cy(3):cy(2)),SE(this);var i=this.g.da();this.ca=i;t:if(Ej(this)){var n=kR(this.g);t="";var r=n.length,s=Zl(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){vd(this),sv(this);var o="";break t}this.h.i=new oi.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(n[e],{stream:s&&e==r-1});n.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=i==200,Zue(this.j,this.u,this.A,this.m,this.W,u,i),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ry(a)){var c=a;break t}}c=null}if(i=c)gm(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,VC(this,i);else{this.i=!1,this.o=3,Xs(12),vd(this),sv(this);break e}}this.S?(wj(this,u,o),EC&&this.i&&u==3&&(mj(this.U,this.V,"tick",this.mb),this.V.start())):(gm(this.j,this.m,o,null),VC(this,o)),u==4&&vd(this),this.i&&!this.J&&(u==4?qj(this.l,this):(this.i=!1,iS(this)))}else _de(this.g),i==400&&0<o.indexOf("Unknown SID")?(this.o=3,Xs(12)):(this.o=0,Xs(13)),vd(this),sv(this)}}}catch{}finally{}};function Ej(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function wj(t,e,i){let n=!0,r;for(;!t.J&&t.C<i.length;)if(r=tde(t,i),r==S_){e==4&&(t.o=4,Xs(14),n=!1),gm(t.j,t.m,null,"[Incomplete Response]");break}else if(r==MC){t.o=4,Xs(15),gm(t.j,t.m,i,"[Invalid Chunk]"),n=!1;break}else gm(t.j,t.m,r,null),VC(t,r);Ej(t)&&r!=S_&&r!=MC&&(t.h.g="",t.C=0),e!=4||i.length!=0||t.h.h||(t.o=1,Xs(16),n=!1),t.i=t.i&&n,n?0<i.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+i.length),VA(e),e.M=!0,Xs(11))):(gm(t.j,t.m,i,"[Invalid Chunked Response]"),vd(t),sv(t))}yt.mb=function(){if(this.g){var t=Zl(this.g),e=this.g.ja();this.C<e.length&&(SE(this),wj(this,t,e),this.i&&t!=4&&iS(this))}};function tde(t,e){var i=t.C,n=e.indexOf(`
`,i);return n==-1?S_:(i=Number(e.substring(i,n)),isNaN(i)?MC:(n+=1,n+i>e.length?S_:(e=e.slice(n,n+i),t.C=n+i,e)))}yt.cancel=function(){this.J=!0,vd(this)};function iS(t){t.Y=Date.now()+t.P,Tj(t,t.P)}function Tj(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Qy(Ts(t.lb,t),e)}function SE(t){t.B&&(oi.clearTimeout(t.B),t.B=null)}yt.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(Jue(this.j,this.A),this.L!=2&&(cy(),Xs(17)),vd(this),this.o=2,sv(this)):Tj(this,this.Y-t)};function sv(t){t.l.H==0||t.J||qj(t.l,t)}function vd(t){SE(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,_A(t.V),pj(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function VC(t,e){try{var i=t.l;if(i.H!=0&&(i.g==t||LC(i.i,t))){if(!t.K&&LC(i.i,t)&&i.H==3){try{var n=i.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&n.length==3){var r=n;if(r[0]==0){e:if(!i.u){if(i.g)if(i.g.G+3e3<t.G)P_(i),EE(i);else break e;AA(i),Xs(18)}}else i.Fa=r[1],0<i.Fa-i.V&&37500>r[2]&&i.G&&i.A==0&&!i.v&&(i.v=Qy(Ts(i.ib,i),6e3));if(1>=Ij(i.i)&&i.oa){try{i.oa()}catch{}i.oa=void 0}}else yd(i,11)}else if((t.K||i.g==t)&&P_(i),!ry(e))for(r=i.Ja.g.parse(e),e=0;e<r.length;e++){let c=r[e];if(i.V=c[0],c=c[1],i.H==2)if(c[0]=="c"){i.K=c[1],i.pa=c[2];const u=c[3];u!=null&&(i.ra=u,i.l.info("VER="+i.ra));const h=c[4];h!=null&&(i.Ga=h,i.l.info("SVER="+i.Ga));const d=c[5];d!=null&&typeof d=="number"&&0<d&&(n=1.5*d,i.L=n,i.l.info("backChannelRequestTimeoutMs_="+n)),n=i;const f=t.g;if(f){const m=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(m){var s=n.i;s.g||m.indexOf("spdy")==-1&&m.indexOf("quic")==-1&&m.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(xA(s,s.h),s.h=null))}if(n.F){const g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(n.Da=g,Pn(n.I,n.F,g))}}i.H=3,i.h&&i.h.Ba(),i.ca&&(i.S=Date.now()-t.G,i.l.info("Handshake RTT: "+i.S+"ms")),n=i;var o=t;if(n.wa=Yj(n,n.J?n.pa:null,n.Y),o.K){Oj(n.i,o);var a=o,l=n.L;l&&a.setTimeout(l),a.B&&(SE(a),iS(a)),n.g=o}else Gj(n);0<i.j.length&&wE(i)}else c[0]!="stop"&&c[0]!="close"||yd(i,7);else i.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?yd(i,7):MA(i):c[0]!="noop"&&i.h&&i.h.Aa(c),i.A=0)}}cy(4)}catch{}}function ide(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(hE(t)){for(var e=[],i=t.length,n=0;n<i;n++)e.push(t[n]);return e}e=[],i=0;for(n in t)e[i++]=t[n];return e}function nde(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(hE(t)||typeof t=="string"){var e=[];t=t.length;for(var i=0;i<t;i++)e.push(i);return e}e=[],i=0;for(const n in t)e[i++]=n;return e}}}function xj(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(hE(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var i=nde(t),n=ide(t),r=n.length,s=0;s<r;s++)e.call(void 0,n[s],i&&i[s],t)}var kj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rde(t,e){if(t){t=t.split("&");for(var i=0;i<t.length;i++){var n=t[i].indexOf("="),r=null;if(0<=n){var s=t[i].substring(0,n);r=t[i].substring(n+1)}else s=t[i];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function Id(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Id){this.h=t.h,b_(this,t.j),this.s=t.s,this.g=t.g,__(this,t.m),this.l=t.l;var e=t.i,i=new hy;i.i=e.i,e.g&&(i.g=new Map(e.g),i.h=e.h),wR(this,i),this.o=t.o}else t&&(e=String(t).match(kj))?(this.h=!1,b_(this,e[1]||"",!0),this.s=Dg(e[2]||""),this.g=Dg(e[3]||"",!0),__(this,e[4]),this.l=Dg(e[5]||"",!0),wR(this,e[6]||"",!0),this.o=Dg(e[7]||"")):(this.h=!1,this.i=new hy(null,this.h))}Id.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ng(e,TR,!0),":");var i=this.g;return(i||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Ng(e,TR,!0),"@"),t.push(encodeURIComponent(String(i)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i=this.m,i!=null&&t.push(":",String(i))),(i=this.l)&&(this.g&&i.charAt(0)!="/"&&t.push("/"),t.push(Ng(i,i.charAt(0)=="/"?ade:ode,!0))),(i=this.i.toString())&&t.push("?",i),(i=this.o)&&t.push("#",Ng(i,cde)),t.join("")};function uh(t){return new Id(t)}function b_(t,e,i){t.j=i?Dg(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function __(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function wR(t,e,i){e instanceof hy?(t.i=e,hde(t.i,t.h)):(i||(e=Ng(e,lde)),t.i=new hy(e,t.h))}function Pn(t,e,i){t.i.set(e,i)}function bE(t){return Pn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Dg(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ng(t,e,i){return typeof t=="string"?(t=encodeURI(t).replace(e,sde),i&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sde(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var TR=/[#\/\?@]/g,ode=/[#\?:]/g,ade=/[#\?]/g,lde=/[#\?@]/g,cde=/#/g;function hy(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Uu(t){t.g||(t.g=new Map,t.h=0,t.i&&rde(t.i,function(e,i){t.add(decodeURIComponent(e.replace(/\+/g," ")),i)}))}yt=hy.prototype;yt.add=function(t,e){Uu(this),this.i=null,t=Xp(this,t);var i=this.g.get(t);return i||this.g.set(t,i=[]),i.push(e),this.h+=1,this};function Cj(t,e){Uu(t),e=Xp(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Mj(t,e){return Uu(t),e=Xp(t,e),t.g.has(e)}yt.forEach=function(t,e){Uu(this),this.g.forEach(function(i,n){i.forEach(function(r){t.call(e,r,n,this)},this)},this)};yt.ta=function(){Uu(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),i=[];for(let n=0;n<e.length;n++){const r=t[n];for(let s=0;s<r.length;s++)i.push(e[n])}return i};yt.Z=function(t){Uu(this);let e=[];if(typeof t=="string")Mj(this,t)&&(e=e.concat(this.g.get(Xp(this,t))));else{t=Array.from(this.g.values());for(let i=0;i<t.length;i++)e=e.concat(t[i])}return e};yt.set=function(t,e){return Uu(this),this.i=null,t=Xp(this,t),Mj(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};yt.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function Aj(t,e,i){Cj(t,e),0<i.length&&(t.i=null,t.g.set(Xp(t,e),dA(i)),t.h+=i.length)}yt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var i=0;i<e.length;i++){var n=e[i];const s=encodeURIComponent(String(n)),o=this.Z(n);for(n=0;n<o.length;n++){var r=s;o[n]!==""&&(r+="="+encodeURIComponent(String(o[n]))),t.push(r)}}return this.i=t.join("&")};function Xp(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function hde(t,e){e&&!t.j&&(Uu(t),t.i=null,t.g.forEach(function(i,n){var r=n.toLowerCase();n!=r&&(Cj(this,n),Aj(this,r,i))},t)),t.j=e}var ude=class{constructor(t,e){this.g=t,this.map=e}};function Vj(t){this.l=t||dde,oi.PerformanceNavigationTiming?(t=oi.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(oi.g&&oi.g.Ka&&oi.g.Ka()&&oi.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var dde=10;function Lj(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Ij(t){return t.h?1:t.g?t.g.size:0}function LC(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function xA(t,e){t.g?t.g.add(e):t.h=e}function Oj(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Vj.prototype.cancel=function(){if(this.i=Dj(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function Dj(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const i of t.g.values())e=e.concat(i.F);return e}return dA(t.i)}var fde=class{stringify(t){return oi.JSON.stringify(t,void 0)}parse(t){return oi.JSON.parse(t,void 0)}};function mde(){this.g=new fde}function pde(t,e,i){const n=i||"";try{xj(t,function(r,s){let o=r;Zy(r)&&(o=SA(r)),e.push(n+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(n+"type="+encodeURIComponent("_badmap")),r}}function gde(t,e){const i=new pE;if(oi.Image){const n=new Image;n.onload=Cb(Ab,i,n,"TestLoadImage: loaded",!0,e),n.onerror=Cb(Ab,i,n,"TestLoadImage: error",!1,e),n.onabort=Cb(Ab,i,n,"TestLoadImage: abort",!1,e),n.ontimeout=Cb(Ab,i,n,"TestLoadImage: timeout",!1,e),oi.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=t}else e(!1)}function Ab(t,e,i,n,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(n)}catch{}}function nS(t){this.l=t.fc||null,this.j=t.ob||!1}qr(nS,EA);nS.prototype.g=function(){return new _E(this.l,this.j)};nS.prototype.i=function(t){return function(){return t}}({});function _E(t,e){Hr.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=kA,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}qr(_E,Hr);var kA=0;yt=_E.prototype;yt.open=function(t,e){if(this.readyState!=kA)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,uy(this)};yt.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||oi).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};yt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,rS(this)),this.readyState=kA};yt.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,uy(this)),this.g&&(this.readyState=3,uy(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof oi.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Nj(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function Nj(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}yt.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?rS(this):uy(this),this.readyState==3&&Nj(this)}};yt.Za=function(t){this.g&&(this.response=this.responseText=t,rS(this))};yt.Ya=function(t){this.g&&(this.response=t,rS(this))};yt.ka=function(){this.g&&rS(this)};function rS(t){t.readyState=4,t.l=null,t.j=null,t.A=null,uy(t)}yt.setRequestHeader=function(t,e){this.v.append(t,e)};yt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};yt.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var i=e.next();!i.done;)i=i.value,t.push(i[0]+": "+i[1]),i=e.next();return t.join(`\r
`)};function uy(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(_E.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var vde=oi.JSON.parse;function Gn(t){Hr.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Rj,this.L=this.M=!1}qr(Gn,Hr);var Rj="",yde=/^https?$/i,Sde=["POST","PUT"];yt=Gn.prototype;yt.Oa=function(t){this.M=t};yt.ha=function(t,e,i,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():CC.g(),this.C=this.u?ER(this.u):ER(CC),this.g.onreadystatechange=Ts(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){xR(this,s);return}if(t=i||"",i=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var r in n)i.set(r,n[r]);else if(typeof n.keys=="function"&&typeof n.get=="function")for(const s of n.keys())i.set(s,n.get(s));else throw Error("Unknown input type for opt_headers: "+String(n));n=Array.from(i.keys()).find(s=>s.toLowerCase()=="content-type"),r=oi.FormData&&t instanceof oi.FormData,!(0<=ej(Sde,e))||n||r||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of i)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Uj(this),0<this.B&&((this.L=bde(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ts(this.ua,this)):this.A=PA(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){xR(this,s)}};function bde(t){return fp&&typeof t.timeout=="number"&&t.ontimeout!==void 0}yt.ua=function(){typeof uA<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,as(this,"timeout"),this.abort(8))};function xR(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Fj(t),PE(t)}function Fj(t){t.F||(t.F=!0,as(t,"complete"),as(t,"error"))}yt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,as(this,"complete"),as(this,"abort"),PE(this))};yt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),PE(this,!0)),Gn.$.N.call(this)};yt.La=function(){this.s||(this.G||this.v||this.l?zj(this):this.kb())};yt.kb=function(){zj(this)};function zj(t){if(t.h&&typeof uA<"u"&&(!t.C[1]||Zl(t)!=4||t.da()!=2)){if(t.v&&Zl(t)==4)PA(t.La,0,t);else if(as(t,"readystatechange"),Zl(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var i;if(!(i=e)){var n;if(n=o===0){var r=String(t.I).match(kj)[1]||null;!r&&oi.self&&oi.self.location&&(r=oi.self.location.protocol.slice(0,-1)),n=!yde.test(r?r.toLowerCase():"")}i=n}if(i)as(t,"complete"),as(t,"success");else{t.m=6;try{var s=2<Zl(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",Fj(t)}}finally{PE(t)}}}}function PE(t,e){if(t.g){Uj(t);const i=t.g,n=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||as(t,"ready");try{i.onreadystatechange=n}catch{}}}function Uj(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(oi.clearTimeout(t.A),t.A=null)}yt.isActive=function(){return!!this.g};function Zl(t){return t.g?t.g.readyState:0}yt.da=function(){try{return 2<Zl(this)?this.g.status:-1}catch{return-1}};yt.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};yt.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),vde(e)}};function kR(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Rj:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function _de(t){const e={};t=(t.g&&2<=Zl(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let n=0;n<t.length;n++){if(ry(t[n]))continue;var i=Hue(t[n]);const r=i[0];if(i=i[1],typeof i!="string")continue;i=i.trim();const s=e[r]||[];e[r]=s,s.push(i)}zue(e,function(n){return n.join(", ")})}yt.Ia=function(){return this.m};yt.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Bj(t){let e="";return mA(t,function(i,n){e+=n,e+=":",e+=i,e+=`\r
`}),e}function CA(t,e,i){e:{for(n in i){var n=!1;break e}n=!0}n||(i=Bj(i),typeof t=="string"?i!=null&&encodeURIComponent(String(i)):Pn(t,e,i))}function xg(t,e,i){return i&&i.internalChannelParams&&i.internalChannelParams[t]||e}function jj(t){this.Ga=0,this.j=[],this.l=new pE,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=xg("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=xg("baseRetryDelayMs",5e3,t),this.hb=xg("retryDelaySeedMs",1e4,t),this.eb=xg("forwardChannelMaxRetries",2,t),this.xa=xg("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Vj(t&&t.concurrentRequestLimit),this.Ja=new mde,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}yt=jj.prototype;yt.ra=8;yt.H=1;function MA(t){if($j(t),t.H==3){var e=t.W++,i=uh(t.I);if(Pn(i,"SID",t.K),Pn(i,"RID",e),Pn(i,"TYPE","terminate"),sS(t,i),e=new tS(t,t.l,e),e.L=2,e.v=bE(uh(i)),i=!1,oi.navigator&&oi.navigator.sendBeacon)try{i=oi.navigator.sendBeacon(e.v.toString(),"")}catch{}!i&&oi.Image&&(new Image().src=e.v,i=!0),i||(e.g=Zj(e.l,null),e.g.ha(e.v)),e.G=Date.now(),iS(e)}Xj(t)}function EE(t){t.g&&(VA(t),t.g.cancel(),t.g=null)}function $j(t){EE(t),t.u&&(oi.clearTimeout(t.u),t.u=null),P_(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&oi.clearTimeout(t.m),t.m=null)}function wE(t){if(!Lj(t.i)&&!t.m){t.m=!0;var e=t.Na;oy||dj(),ay||(oy(),ay=!0),bA.add(e,t),t.C=0}}function Pde(t,e){return Ij(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Qy(Ts(t.Na,t,e),Kj(t,t.C)),t.C++,!0)}yt.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const r=new tS(this,this.l,t);let s=this.s;if(this.U&&(s?(s=rj(s),sj(s,this.U)):s=this.U),this.o!==null||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,i=0;i<this.j.length;i++){t:{var n=this.j[i];if("__data__"in n.map&&(n=n.map.__data__,typeof n=="string")){n=n.length;break t}n=void 0}if(n===void 0)break;if(e+=n,4096<e){e=i;break e}if(e===4096||i===this.j.length-1){e=i+1;break e}}e=1e3}else e=1e3;e=Wj(this,r,e),i=uh(this.I),Pn(i,"RID",t),Pn(i,"CVER",22),this.F&&Pn(i,"X-HTTP-Session-Id",this.F),sS(this,i),s&&(this.O?e="headers="+encodeURIComponent(String(Bj(s)))+"&"+e:this.o&&CA(i,this.o,s)),xA(this.i,r),this.bb&&Pn(i,"TYPE","init"),this.P?(Pn(i,"$req",e),Pn(i,"SID","null"),r.aa=!0,AC(r,i,null)):AC(r,i,e),this.H=2}}else this.H==3&&(t?CR(this,t):this.j.length==0||Lj(this.i)||CR(this))};function CR(t,e){var i;e?i=e.m:i=t.W++;const n=uh(t.I);Pn(n,"SID",t.K),Pn(n,"RID",i),Pn(n,"AID",t.V),sS(t,n),t.o&&t.s&&CA(n,t.o,t.s),i=new tS(t,t.l,i,t.C+1),t.o===null&&(i.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Wj(t,i,1e3),i.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),xA(t.i,i),AC(i,n,e)}function sS(t,e){t.na&&mA(t.na,function(i,n){Pn(e,n,i)}),t.h&&xj({},function(i,n){Pn(e,n,i)})}function Wj(t,e,i){i=Math.min(t.j.length,i);var n=t.h?Ts(t.h.Va,t.h,t):null;e:{var r=t.j;let s=-1;for(;;){const o=["count="+i];s==-1?0<i?(s=r[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<i;l++){let c=r[l].g;const u=r[l].map;if(c-=s,0>c)s=Math.max(0,r[l].g-100),a=!1;else try{pde(u,o,"req"+c+"_")}catch{n&&n(u)}}if(a){n=o.join("&");break e}}}return t=t.j.splice(0,i),e.F=t,n}function Gj(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;oy||dj(),ay||(oy(),ay=!0),bA.add(e,t),t.A=0}}function AA(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Qy(Ts(t.Ma,t),Kj(t,t.A)),t.A++,!0)}yt.Ma=function(){if(this.u=null,Hj(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Qy(Ts(this.jb,this),t)}};yt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Xs(10),EE(this),Hj(this))};function VA(t){t.B!=null&&(oi.clearTimeout(t.B),t.B=null)}function Hj(t){t.g=new tS(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=uh(t.wa);Pn(e,"RID","rpc"),Pn(e,"SID",t.K),Pn(e,"AID",t.V),Pn(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Pn(e,"TO",t.qa),Pn(e,"TYPE","xmlhttp"),sS(t,e),t.o&&t.s&&CA(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var i=t.g;t=t.pa,i.L=1,i.v=bE(uh(e)),i.s=null,i.S=!0,Pj(i,t)}yt.ib=function(){this.v!=null&&(this.v=null,EE(this),AA(this),Xs(19))};function P_(t){t.v!=null&&(oi.clearTimeout(t.v),t.v=null)}function qj(t,e){var i=null;if(t.g==e){P_(t),VA(t),t.g=null;var n=2}else if(LC(t.i,e))i=e.F,Oj(t.i,e),n=1;else return;if(t.H!=0){if(e.i)if(n==1){i=e.s?e.s.length:0,e=Date.now()-e.G;var r=t.C;n=gE(),as(n,new yj(n,i)),wE(t)}else Gj(t);else if(r=e.o,r==3||r==0&&0<e.ca||!(n==1&&Pde(t,e)||n==2&&AA(t)))switch(i&&0<i.length&&(e=t.i,e.i=e.i.concat(i)),r){case 1:yd(t,5);break;case 4:yd(t,10);break;case 3:yd(t,6);break;default:yd(t,2)}}}function Kj(t,e){let i=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(i*=2),i*e}function yd(t,e){if(t.l.info("Error code "+e),e==2){var i=null;t.h&&(i=null);var n=Ts(t.pb,t);i||(i=new Id("//www.google.com/images/cleardot.gif"),oi.location&&oi.location.protocol=="http"||b_(i,"https"),bE(i)),gde(i.toString(),n)}else Xs(2);t.H=0,t.h&&t.h.za(e),Xj(t),$j(t)}yt.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Xs(2)):(this.l.info("Failed to ping google.com"),Xs(1))};function Xj(t){if(t.H=0,t.ma=[],t.h){const e=Dj(t.i);(e.length!=0||t.j.length!=0)&&(yR(t.ma,e),yR(t.ma,t.j),t.i.i.length=0,dA(t.j),t.j.length=0),t.h.ya()}}function Yj(t,e,i){var n=i instanceof Id?uh(i):new Id(i);if(n.g!="")e&&(n.g=e+"."+n.g),__(n,n.m);else{var r=oi.location;n=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new Id(null);n&&b_(s,n),e&&(s.g=e),r&&__(s,r),i&&(s.l=i),n=s}return i=t.F,e=t.Da,i&&e&&Pn(n,i,e),Pn(n,"VER",t.ra),sS(t,n),n}function Zj(t,e,i){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=i&&t.Ha&&!t.va?new Gn(new nS({ob:!0})):new Gn(t.va),e.Oa(t.J),e}yt.isActive=function(){return!!this.h&&this.h.isActive(this)};function Jj(){}yt=Jj.prototype;yt.Ba=function(){};yt.Aa=function(){};yt.za=function(){};yt.ya=function(){};yt.isActive=function(){return!0};yt.Va=function(){};function E_(){if(fp&&!(10<=Number(Due)))throw Error("Environmental error: no available transport.")}E_.prototype.g=function(t,e){return new ta(t,e)};function ta(t,e){Hr.call(this),this.g=new jj(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!ry(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ry(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Yp(this)}qr(ta,Hr);ta.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,i=this.h||void 0;Xs(0),t.Y=e,t.na=i||{},t.G=t.aa,t.I=Yj(t,null,t.Y),wE(t)};ta.prototype.close=function(){MA(this.g)};ta.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var i={};i.__data__=t,t=i}else this.v&&(i={},i.__data__=SA(t),t=i);e.j.push(new ude(e.fb++,t)),e.H==3&&wE(e)};ta.prototype.N=function(){this.g.h=null,delete this.j,MA(this.g),delete this.g,ta.$.N.call(this)};function Qj(t){wA.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const i in e){t=i;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}qr(Qj,wA);function e$(){TA.call(this),this.status=1}qr(e$,TA);function Yp(t){this.g=t}qr(Yp,Jj);Yp.prototype.Ba=function(){as(this.g,"a")};Yp.prototype.Aa=function(t){as(this.g,new Qj(t))};Yp.prototype.za=function(t){as(this.g,new e$)};Yp.prototype.ya=function(){as(this.g,"b")};function Ede(){this.blockSize=-1}function bl(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}qr(bl,Ede);bl.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function XT(t,e,i){i||(i=0);var n=Array(16);if(typeof e=="string")for(var r=0;16>r;++r)n[r]=e.charCodeAt(i++)|e.charCodeAt(i++)<<8|e.charCodeAt(i++)<<16|e.charCodeAt(i++)<<24;else for(r=0;16>r;++r)n[r]=e[i++]|e[i++]<<8|e[i++]<<16|e[i++]<<24;e=t.g[0],i=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^i&(r^s))+n[0]+3614090360&4294967295;e=i+(o<<7&4294967295|o>>>25),o=s+(r^e&(i^r))+n[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(i^s&(e^i))+n[2]+606105819&4294967295,r=s+(o<<17&4294967295|o>>>15),o=i+(e^r&(s^e))+n[3]+3250441966&4294967295,i=r+(o<<22&4294967295|o>>>10),o=e+(s^i&(r^s))+n[4]+4118548399&4294967295,e=i+(o<<7&4294967295|o>>>25),o=s+(r^e&(i^r))+n[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(i^s&(e^i))+n[6]+2821735955&4294967295,r=s+(o<<17&4294967295|o>>>15),o=i+(e^r&(s^e))+n[7]+4249261313&4294967295,i=r+(o<<22&4294967295|o>>>10),o=e+(s^i&(r^s))+n[8]+1770035416&4294967295,e=i+(o<<7&4294967295|o>>>25),o=s+(r^e&(i^r))+n[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(i^s&(e^i))+n[10]+4294925233&4294967295,r=s+(o<<17&4294967295|o>>>15),o=i+(e^r&(s^e))+n[11]+2304563134&4294967295,i=r+(o<<22&4294967295|o>>>10),o=e+(s^i&(r^s))+n[12]+1804603682&4294967295,e=i+(o<<7&4294967295|o>>>25),o=s+(r^e&(i^r))+n[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(i^s&(e^i))+n[14]+2792965006&4294967295,r=s+(o<<17&4294967295|o>>>15),o=i+(e^r&(s^e))+n[15]+1236535329&4294967295,i=r+(o<<22&4294967295|o>>>10),o=e+(r^s&(i^r))+n[1]+4129170786&4294967295,e=i+(o<<5&4294967295|o>>>27),o=s+(i^r&(e^i))+n[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^i&(s^e))+n[11]+643717713&4294967295,r=s+(o<<14&4294967295|o>>>18),o=i+(s^e&(r^s))+n[0]+3921069994&4294967295,i=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(i^r))+n[5]+3593408605&4294967295,e=i+(o<<5&4294967295|o>>>27),o=s+(i^r&(e^i))+n[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^i&(s^e))+n[15]+3634488961&4294967295,r=s+(o<<14&4294967295|o>>>18),o=i+(s^e&(r^s))+n[4]+3889429448&4294967295,i=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(i^r))+n[9]+568446438&4294967295,e=i+(o<<5&4294967295|o>>>27),o=s+(i^r&(e^i))+n[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^i&(s^e))+n[3]+4107603335&4294967295,r=s+(o<<14&4294967295|o>>>18),o=i+(s^e&(r^s))+n[8]+1163531501&4294967295,i=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(i^r))+n[13]+2850285829&4294967295,e=i+(o<<5&4294967295|o>>>27),o=s+(i^r&(e^i))+n[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^i&(s^e))+n[7]+1735328473&4294967295,r=s+(o<<14&4294967295|o>>>18),o=i+(s^e&(r^s))+n[12]+2368359562&4294967295,i=r+(o<<20&4294967295|o>>>12),o=e+(i^r^s)+n[5]+4294588738&4294967295,e=i+(o<<4&4294967295|o>>>28),o=s+(e^i^r)+n[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^i)+n[11]+1839030562&4294967295,r=s+(o<<16&4294967295|o>>>16),o=i+(r^s^e)+n[14]+4259657740&4294967295,i=r+(o<<23&4294967295|o>>>9),o=e+(i^r^s)+n[1]+2763975236&4294967295,e=i+(o<<4&4294967295|o>>>28),o=s+(e^i^r)+n[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^i)+n[7]+4139469664&4294967295,r=s+(o<<16&4294967295|o>>>16),o=i+(r^s^e)+n[10]+3200236656&4294967295,i=r+(o<<23&4294967295|o>>>9),o=e+(i^r^s)+n[13]+681279174&4294967295,e=i+(o<<4&4294967295|o>>>28),o=s+(e^i^r)+n[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^i)+n[3]+3572445317&4294967295,r=s+(o<<16&4294967295|o>>>16),o=i+(r^s^e)+n[6]+76029189&4294967295,i=r+(o<<23&4294967295|o>>>9),o=e+(i^r^s)+n[9]+3654602809&4294967295,e=i+(o<<4&4294967295|o>>>28),o=s+(e^i^r)+n[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^i)+n[15]+530742520&4294967295,r=s+(o<<16&4294967295|o>>>16),o=i+(r^s^e)+n[2]+3299628645&4294967295,i=r+(o<<23&4294967295|o>>>9),o=e+(r^(i|~s))+n[0]+4096336452&4294967295,e=i+(o<<6&4294967295|o>>>26),o=s+(i^(e|~r))+n[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~i))+n[14]+2878612391&4294967295,r=s+(o<<15&4294967295|o>>>17),o=i+(s^(r|~e))+n[5]+4237533241&4294967295,i=r+(o<<21&4294967295|o>>>11),o=e+(r^(i|~s))+n[12]+1700485571&4294967295,e=i+(o<<6&4294967295|o>>>26),o=s+(i^(e|~r))+n[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~i))+n[10]+4293915773&4294967295,r=s+(o<<15&4294967295|o>>>17),o=i+(s^(r|~e))+n[1]+2240044497&4294967295,i=r+(o<<21&4294967295|o>>>11),o=e+(r^(i|~s))+n[8]+1873313359&4294967295,e=i+(o<<6&4294967295|o>>>26),o=s+(i^(e|~r))+n[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~i))+n[6]+2734768916&4294967295,r=s+(o<<15&4294967295|o>>>17),o=i+(s^(r|~e))+n[13]+1309151649&4294967295,i=r+(o<<21&4294967295|o>>>11),o=e+(r^(i|~s))+n[4]+4149444226&4294967295,e=i+(o<<6&4294967295|o>>>26),o=s+(i^(e|~r))+n[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~i))+n[2]+718787259&4294967295,r=s+(o<<15&4294967295|o>>>17),o=i+(s^(r|~e))+n[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}bl.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var i=e-this.blockSize,n=this.m,r=this.h,s=0;s<e;){if(r==0)for(;s<=i;)XT(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(n[r++]=t.charCodeAt(s++),r==this.blockSize){XT(this,n),r=0;break}}else for(;s<e;)if(n[r++]=t[s++],r==this.blockSize){XT(this,n),r=0;break}}this.h=r,this.i+=e};bl.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var i=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=i&255,i/=256;for(this.j(t),t=Array(16),e=i=0;4>e;++e)for(var n=0;32>n;n+=8)t[i++]=this.g[e]>>>n&255;return t};function on(t,e){this.h=e;for(var i=[],n=!0,r=t.length-1;0<=r;r--){var s=t[r]|0;n&&s==e||(i[r]=s,n=!1)}this.g=i}var wde={};function LA(t){return-128<=t&&128>t?Lue(t,function(e){return new on([e|0],0>e?-1:0)}):new on([t|0],0>t?-1:0)}function Jl(t){if(isNaN(t)||!isFinite(t))return Nm;if(0>t)return ns(Jl(-t));for(var e=[],i=1,n=0;t>=i;n++)e[n]=t/i|0,i*=IC;return new on(e,0)}function t$(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return ns(t$(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=Jl(Math.pow(e,8)),n=Nm,r=0;r<t.length;r+=8){var s=Math.min(8,t.length-r),o=parseInt(t.substring(r,r+s),e);8>s?(s=Jl(Math.pow(e,s)),n=n.R(s).add(Jl(o))):(n=n.R(i),n=n.add(Jl(o)))}return n}var IC=4294967296,Nm=LA(0),OC=LA(1),MR=LA(16777216);yt=on.prototype;yt.ea=function(){if(_a(this))return-ns(this).ea();for(var t=0,e=1,i=0;i<this.g.length;i++){var n=this.D(i);t+=(0<=n?n:IC+n)*e,e*=IC}return t};yt.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Zc(this))return"0";if(_a(this))return"-"+ns(this).toString(t);for(var e=Jl(Math.pow(t,6)),i=this,n="";;){var r=T_(i,e).g;i=w_(i,r.R(e));var s=((0<i.g.length?i.g[0]:i.h)>>>0).toString(t);if(i=r,Zc(i))return s+n;for(;6>s.length;)s="0"+s;n=s+n}};yt.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Zc(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function _a(t){return t.h==-1}yt.X=function(t){return t=w_(this,t),_a(t)?-1:Zc(t)?0:1};function ns(t){for(var e=t.g.length,i=[],n=0;n<e;n++)i[n]=~t.g[n];return new on(i,~t.h).add(OC)}yt.abs=function(){return _a(this)?ns(this):this};yt.add=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0,r=0;r<=e;r++){var s=n+(this.D(r)&65535)+(t.D(r)&65535),o=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);n=o>>>16,s&=65535,o&=65535,i[r]=o<<16|s}return new on(i,i[i.length-1]&-2147483648?-1:0)};function w_(t,e){return t.add(ns(e))}yt.R=function(t){if(Zc(this)||Zc(t))return Nm;if(_a(this))return _a(t)?ns(this).R(ns(t)):ns(ns(this).R(t));if(_a(t))return ns(this.R(ns(t)));if(0>this.X(MR)&&0>t.X(MR))return Jl(this.ea()*t.ea());for(var e=this.g.length+t.g.length,i=[],n=0;n<2*e;n++)i[n]=0;for(n=0;n<this.g.length;n++)for(var r=0;r<t.g.length;r++){var s=this.D(n)>>>16,o=this.D(n)&65535,a=t.D(r)>>>16,l=t.D(r)&65535;i[2*n+2*r]+=o*l,Vb(i,2*n+2*r),i[2*n+2*r+1]+=s*l,Vb(i,2*n+2*r+1),i[2*n+2*r+1]+=o*a,Vb(i,2*n+2*r+1),i[2*n+2*r+2]+=s*a,Vb(i,2*n+2*r+2)}for(n=0;n<e;n++)i[n]=i[2*n+1]<<16|i[2*n];for(n=e;n<2*e;n++)i[n]=0;return new on(i,0)};function Vb(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function kg(t,e){this.g=t,this.h=e}function T_(t,e){if(Zc(e))throw Error("division by zero");if(Zc(t))return new kg(Nm,Nm);if(_a(t))return e=T_(ns(t),e),new kg(ns(e.g),ns(e.h));if(_a(e))return e=T_(t,ns(e)),new kg(ns(e.g),e.h);if(30<t.g.length){if(_a(t)||_a(e))throw Error("slowDivide_ only works with positive integers.");for(var i=OC,n=e;0>=n.X(t);)i=AR(i),n=AR(n);var r=qf(i,1),s=qf(n,1);for(n=qf(n,2),i=qf(i,2);!Zc(n);){var o=s.add(n);0>=o.X(t)&&(r=r.add(i),s=o),n=qf(n,1),i=qf(i,1)}return e=w_(t,r.R(e)),new kg(r,e)}for(r=Nm;0<=t.X(e);){for(i=Math.max(1,Math.floor(t.ea()/e.ea())),n=Math.ceil(Math.log(i)/Math.LN2),n=48>=n?1:Math.pow(2,n-48),s=Jl(i),o=s.R(e);_a(o)||0<o.X(t);)i-=n,s=Jl(i),o=s.R(e);Zc(s)&&(s=OC),r=r.add(s),t=w_(t,o)}return new kg(r,t)}yt.gb=function(t){return T_(this,t).h};yt.and=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)&t.D(n);return new on(i,this.h&t.h)};yt.or=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)|t.D(n);return new on(i,this.h|t.h)};yt.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)^t.D(n);return new on(i,this.h^t.h)};function AR(t){for(var e=t.g.length+1,i=[],n=0;n<e;n++)i[n]=t.D(n)<<1|t.D(n-1)>>>31;return new on(i,t.h)}function qf(t,e){var i=e>>5;e%=32;for(var n=t.g.length-i,r=[],s=0;s<n;s++)r[s]=0<e?t.D(s+i)>>>e|t.D(s+i+1)<<32-e:t.D(s+i);return new on(r,t.h)}E_.prototype.createWebChannel=E_.prototype.g;ta.prototype.send=ta.prototype.u;ta.prototype.open=ta.prototype.m;ta.prototype.close=ta.prototype.close;vE.NO_ERROR=0;vE.TIMEOUT=8;vE.HTTP_ERROR=6;Sj.COMPLETE="complete";bj.EventType=eS;eS.OPEN="a";eS.CLOSE="b";eS.ERROR="c";eS.MESSAGE="d";Hr.prototype.listen=Hr.prototype.O;Gn.prototype.listenOnce=Gn.prototype.P;Gn.prototype.getLastError=Gn.prototype.Sa;Gn.prototype.getLastErrorCode=Gn.prototype.Ia;Gn.prototype.getStatus=Gn.prototype.da;Gn.prototype.getResponseJson=Gn.prototype.Wa;Gn.prototype.getResponseText=Gn.prototype.ja;Gn.prototype.send=Gn.prototype.ha;Gn.prototype.setWithCredentials=Gn.prototype.Oa;bl.prototype.digest=bl.prototype.l;bl.prototype.reset=bl.prototype.reset;bl.prototype.update=bl.prototype.j;on.prototype.add=on.prototype.add;on.prototype.multiply=on.prototype.R;on.prototype.modulo=on.prototype.gb;on.prototype.compare=on.prototype.X;on.prototype.toNumber=on.prototype.ea;on.prototype.toString=on.prototype.toString;on.prototype.getBits=on.prototype.D;on.fromNumber=Jl;on.fromString=t$;var Tde=function(){return new E_},xde=function(){return gE()},YT=vE,kde=Sj,Cde=mf,VR={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Mde=nS,Lb=bj,Ade=Gn,Vde=bl,Rm=on;const LR="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vs=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};vs.UNAUTHENTICATED=new vs(null),vs.GOOGLE_CREDENTIALS=new vs("google-credentials-uid"),vs.FIRST_PARTY=new vs("first-party-uid"),vs.MOCK_USER=new vs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zp="9.23.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd=new vM("@firebase/firestore");function IR(){return Hd.logLevel}function It(t,...e){if(Hd.logLevel<=Gi.DEBUG){const i=e.map(IA);Hd.debug(`Firestore (${Zp}): ${t}`,...i)}}function dh(t,...e){if(Hd.logLevel<=Gi.ERROR){const i=e.map(IA);Hd.error(`Firestore (${Zp}): ${t}`,...i)}}function mp(t,...e){if(Hd.logLevel<=Gi.WARN){const i=e.map(IA);Hd.warn(`Firestore (${Zp}): ${t}`,...i)}}function IA(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(t="Unexpected state"){const e=`FIRESTORE (${Zp}) INTERNAL ASSERTION FAILED: `+t;throw dh(e),new Error(e)}function En(t,e){t||ni()}function pi(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};let Rt=class extends Pc{constructor(e,i){super(e,i),this.code=e,this.message=i,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rh=class{constructor(){this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let i$=class{constructor(e,i){this.user=i,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Lde=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,i){e.enqueueRetryable(()=>i(vs.UNAUTHENTICATED))}shutdown(){}},Ide=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,i){this.changeListener=i,e.enqueueRetryable(()=>i(this.token.user))}shutdown(){this.changeListener=null}},Ode=class{constructor(e){this.t=e,this.currentUser=vs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,i){let n=this.i;const r=l=>this.i!==n?(n=this.i,i(l)):Promise.resolve();let s=new rh;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new rh,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{It("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(It("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new rh)}},0),o()}getToken(){const e=this.i,i=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(i).then(n=>this.i!==e?(It("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(En(typeof n.accessToken=="string"),new i$(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return En(e===null||typeof e=="string"),new vs(e)}},Dde=class{constructor(e,i,n){this.h=e,this.l=i,this.m=n,this.type="FirstParty",this.user=vs.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}},Nde=class{constructor(e,i,n){this.h=e,this.l=i,this.m=n}getToken(){return Promise.resolve(new Dde(this.h,this.l,this.m))}start(e,i){e.enqueueRetryable(()=>i(vs.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Rde=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Fde=class{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,i){const n=s=>{s.error!=null&&It("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,It("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?i(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const r=s=>{It("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?r(s):It("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(i=>i?(En(typeof i.token=="string"),this.T=i.token,new Rde(i.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zde(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),i=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(i);else for(let n=0;n<t;n++)i[n]=Math.floor(256*Math.random());return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let n$=class{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=zde(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<i&&(n+=e.charAt(r[s]%e.length))}return n}};function Yi(t,e){return t<e?-1:t>e?1:0}function pp(t,e,i){return t.length===e.length&&t.every((n,r)=>i(n,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qs=class P0{constructor(e,i){if(this.seconds=e,this.nanoseconds=i,i<0)throw new Rt(Qe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(i>=1e9)throw new Rt(Qe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(e<-62135596800)throw new Rt(Qe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Rt(Qe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return P0.fromMillis(Date.now())}static fromDate(e){return P0.fromMillis(e.getTime())}static fromMillis(e){const i=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*i));return new P0(i,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Yi(this.nanoseconds,e.nanoseconds):Yi(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bi=class E0{constructor(e){this.timestamp=e}static fromTimestamp(e){return new E0(e)}static min(){return new E0(new Qs(0,0))}static max(){return new E0(new Qs(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let r$=class DC{constructor(e,i,n){i===void 0?i=0:i>e.length&&ni(),n===void 0?n=e.length-i:n>e.length-i&&ni(),this.segments=e,this.offset=i,this.len=n}get length(){return this.len}isEqual(e){return DC.comparator(this,e)===0}child(e){const i=this.segments.slice(this.offset,this.limit());return e instanceof DC?e.forEach(n=>{i.push(n)}):i.push(e),this.construct(i)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}forEach(e){for(let i=this.offset,n=this.limit();i<n;i++)e(this.segments[i])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,i){const n=Math.min(e.length,i.length);for(let r=0;r<n;r++){const s=e.get(r),o=i.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<i.length?-1:e.length>i.length?1:0}},fr=class w0 extends r${construct(e,i,n){return new w0(e,i,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const i=[];for(const n of e){if(n.indexOf("//")>=0)throw new Rt(Qe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);i.push(...n.split("/").filter(r=>r.length>0))}return new w0(i)}static emptyPath(){return new w0([])}};const Ude=/^[_a-zA-Z][_a-zA-Z0-9]*$/;let mc=class cm extends r${construct(e,i,n){return new cm(e,i,n)}static isValidIdentifier(e){return Ude.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),cm.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new cm(["__name__"])}static fromServerFormat(e){const i=[];let n="",r=0;const s=()=>{if(n.length===0)throw new Rt(Qe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);i.push(n),n=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new Rt(Qe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Rt(Qe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(n+=a,r++):(s(),r++)}if(s(),o)throw new Rt(Qe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new cm(i)}static emptyPath(){return new cm([])}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ei=class Rg{constructor(e){this.path=e}static fromPath(e){return new Rg(fr.fromString(e))}static fromName(e){return new Rg(fr.fromString(e).popFirst(5))}static empty(){return new Rg(fr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,i){return fr.comparator(e.path,i.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Rg(new fr(e.slice()))}};function Bde(t,e){const i=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,r=bi.fromTimestamp(n===1e9?new Qs(i+1,0):new Qs(i,n));return new dy(r,ei.empty(),e)}function jde(t){return new dy(t.readTime,t.key,-1)}let dy=class NC{constructor(e,i,n){this.readTime=e,this.documentKey=i,this.largestBatchId=n}static min(){return new NC(bi.min(),ei.empty(),-1)}static max(){return new NC(bi.max(),ei.empty(),-1)}};function $de(t,e){let i=t.readTime.compareTo(e.readTime);return i!==0?i:(i=ei.comparator(t.documentKey,e.documentKey),i!==0?i:Yi(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wde="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";let Gde=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oS(t){if(t.code!==Qe.FAILED_PRECONDITION||t.message!==Wde)throw t;It("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ft=class co{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(i=>{this.isDone=!0,this.result=i,this.nextCallback&&this.nextCallback(i)},i=>{this.isDone=!0,this.error=i,this.catchCallback&&this.catchCallback(i)})}catch(e){return this.next(void 0,e)}next(e,i){return this.callbackAttached&&ni(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(e,this.result):new co((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(i,s).next(n,r)}})}toPromise(){return new Promise((e,i)=>{this.next(e,i)})}wrapUserFunction(e){try{const i=e();return i instanceof co?i:co.resolve(i)}catch(i){return co.reject(i)}}wrapSuccess(e,i){return e?this.wrapUserFunction(()=>e(i)):co.resolve(i)}wrapFailure(e,i){return e?this.wrapUserFunction(()=>e(i)):co.reject(i)}static resolve(e){return new co((i,n)=>{i(e)})}static reject(e){return new co((i,n)=>{n(e)})}static waitFor(e){return new co((i,n)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&i()},l=>n(l))}),o=!0,s===r&&i()})}static or(e){let i=co.resolve(!1);for(const n of e)i=i.next(r=>r?co.resolve(r):n());return i}static forEach(e,i){const n=[];return e.forEach((r,s)=>{n.push(i.call(this,r,s))}),this.waitFor(n)}static mapArray(e,i){return new co((n,r)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;i(e[c]).next(u=>{o[c]=u,++a,a===s&&n(o)},u=>r(u))}})}static doWhile(e,i){return new co((n,r)=>{const s=()=>{e()===!0?i().next(()=>{s()},r):n()};s()})}};function aS(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OA=class{constructor(e,i){this.previousValue=e,i&&(i.sequenceNumberHandler=n=>this.ot(n),this.ut=n=>i.writeSequenceNumber(n))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}};OA.ct=-1;function TE(t){return t==null}function x_(t){return t===0&&1/t==-1/0}function Hde(t){return typeof t=="number"&&Number.isInteger(t)&&!x_(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(t){let e=0;for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&e++;return e}function pf(t,e){for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&e(i,t[i])}function s$(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sr=class RC{constructor(e,i){this.comparator=e,this.root=i||es.EMPTY}insert(e,i){return new RC(this.comparator,this.root.insert(e,i,this.comparator).copy(null,null,es.BLACK,null,null))}remove(e){return new RC(this.comparator,this.root.remove(e,this.comparator).copy(null,null,es.BLACK,null,null))}get(e){let i=this.root;for(;!i.isEmpty();){const n=this.comparator(e,i.key);if(n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}indexOf(e){let i=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return i+n.left.size;r<0?n=n.left:(i+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((i,n)=>(e(i,n),!1))}toString(){const e=[];return this.inorderTraversal((i,n)=>(e.push(`${i}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ib(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ib(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ib(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ib(this.root,e,this.comparator,!0)}};class Ib{constructor(e,i,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=i?n(e.key,i):1,i&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const i={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return i}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class es{constructor(e,i,n,r,s){this.key=e,this.value=i,this.color=n??es.RED,this.left=r??es.EMPTY,this.right=s??es.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,i,n,r,s){return new es(e??this.key,i??this.value,n??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,i,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,i,n),null):s===0?r.copy(null,i,null,null,null):r.copy(null,null,null,null,r.right.insert(e,i,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return es.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,i){let n,r=this;if(i(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,i),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),i(e,r.key)===0){if(r.right.isEmpty())return es.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,i))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,es.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,es.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,i)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ni();const e=this.left.check();if(e!==this.right.check())throw ni();return e+(this.isRed()?0:1)}}es.EMPTY=null,es.RED=!0,es.BLACK=!1;es.EMPTY=new class{constructor(){this.size=0}get key(){throw ni()}get value(){throw ni()}get color(){throw ni()}get left(){throw ni()}get right(){throw ni()}copy(t,e,i,n,r){return this}insert(t,e,i){return new es(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e){this.comparator=e,this.data=new Sr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((i,n)=>(e(i),!1))}forEachInRange(e,i){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;i(r.key)}}forEachWhile(e,i){let n;for(n=i!==void 0?this.data.getIteratorFrom(i):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const i=this.data.getIteratorFrom(e);return i.hasNext()?i.getNext().key:null}getIterator(){return new DR(this.data.getIterator())}getIteratorFrom(e){return new DR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let i=this;return i.size<e.size&&(i=e,e=this),e.forEach(n=>{i=i.add(n)}),i}isEqual(e){if(!(e instanceof ks)||this.size!==e.size)return!1;const i=this.data.getIterator(),n=e.data.getIterator();for(;i.hasNext();){const r=i.getNext().key,s=n.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(i=>{e.push(i)}),e}toString(){const e=[];return this.forEach(i=>e.push(i)),"SortedSet("+e.toString()+")"}copy(e){const i=new ks(this.comparator);return i.data=e,i}}class DR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e){this.fields=e,e.sort(mc.comparator)}static empty(){return new Zo([])}unionWith(e){let i=new ks(mc.comparator);for(const n of this.fields)i=i.add(n);for(const n of e)i=i.add(n);return new Zo(i.toArray())}covers(e){for(const i of this.fields)if(i.isPrefixOf(e))return!0;return!1}isEqual(e){return pp(this.fields,e.fields,(i,n)=>i.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o$ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e){this.binaryString=e}static fromBase64String(e){const i=function(n){try{return atob(n)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new o$("Invalid base64 string: "+r):r}}(e);return new As(i)}static fromUint8Array(e){const i=function(n){let r="";for(let s=0;s<n.length;++s)r+=String.fromCharCode(n[s]);return r}(e);return new As(i)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const i=new Uint8Array(e.length);for(let n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Yi(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}As.EMPTY_BYTE_STRING=new As("");const qde=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Au(t){if(En(!!t),typeof t=="string"){let e=0;const i=qde.exec(t);if(En(!!i),i[1]){let r=i[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ur(t.seconds),nanos:ur(t.nanos)}}function ur(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function qd(t){return typeof t=="string"?As.fromBase64String(t):As.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DA(t){var e,i;return((i=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||i===void 0?void 0:i.stringValue)==="server_timestamp"}function NA(t){const e=t.mapValue.fields.__previous_value__;return DA(e)?NA(e):e}function fy(t){const e=Au(t.mapValue.fields.__local_write_time__.timestampValue);return new Qs(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kde{constructor(e,i,n,r,s,o,a,l,c){this.databaseId=e,this.appId=i,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class my{constructor(e,i){this.projectId=e,this.database=i||"(default)"}static empty(){return new my("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof my&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ob={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Kd(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?DA(t)?4:Xde(t)?9007199254740991:10:ni()}function pc(t,e){if(t===e)return!0;const i=Kd(t);if(i!==Kd(e))return!1;switch(i){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return fy(t).isEqual(fy(e));case 3:return function(n,r){if(typeof n.timestampValue=="string"&&typeof r.timestampValue=="string"&&n.timestampValue.length===r.timestampValue.length)return n.timestampValue===r.timestampValue;const s=Au(n.timestampValue),o=Au(r.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(n,r){return qd(n.bytesValue).isEqual(qd(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(n,r){return ur(n.geoPointValue.latitude)===ur(r.geoPointValue.latitude)&&ur(n.geoPointValue.longitude)===ur(r.geoPointValue.longitude)}(t,e);case 2:return function(n,r){if("integerValue"in n&&"integerValue"in r)return ur(n.integerValue)===ur(r.integerValue);if("doubleValue"in n&&"doubleValue"in r){const s=ur(n.doubleValue),o=ur(r.doubleValue);return s===o?x_(s)===x_(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return pp(t.arrayValue.values||[],e.arrayValue.values||[],pc);case 10:return function(n,r){const s=n.mapValue.fields||{},o=r.mapValue.fields||{};if(OR(s)!==OR(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(o[a]===void 0||!pc(s[a],o[a])))return!1;return!0}(t,e);default:return ni()}}function py(t,e){return(t.values||[]).find(i=>pc(i,e))!==void 0}function gp(t,e){if(t===e)return 0;const i=Kd(t),n=Kd(e);if(i!==n)return Yi(i,n);switch(i){case 0:case 9007199254740991:return 0;case 1:return Yi(t.booleanValue,e.booleanValue);case 2:return function(r,s){const o=ur(r.integerValue||r.doubleValue),a=ur(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return NR(t.timestampValue,e.timestampValue);case 4:return NR(fy(t),fy(e));case 5:return Yi(t.stringValue,e.stringValue);case 6:return function(r,s){const o=qd(r),a=qd(s);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(r,s){const o=r.split("/"),a=s.split("/");for(let l=0;l<o.length&&l<a.length;l++){const c=Yi(o[l],a[l]);if(c!==0)return c}return Yi(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,s){const o=Yi(ur(r.latitude),ur(s.latitude));return o!==0?o:Yi(ur(r.longitude),ur(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(r,s){const o=r.values||[],a=s.values||[];for(let l=0;l<o.length&&l<a.length;++l){const c=gp(o[l],a[l]);if(c)return c}return Yi(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===Ob.mapValue&&s===Ob.mapValue)return 0;if(r===Ob.mapValue)return 1;if(s===Ob.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),l=s.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let u=0;u<a.length&&u<c.length;++u){const h=Yi(a[u],c[u]);if(h!==0)return h;const d=gp(o[a[u]],l[c[u]]);if(d!==0)return d}return Yi(a.length,c.length)}(t.mapValue,e.mapValue);default:throw ni()}}function NR(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Yi(t,e);const i=Au(t),n=Au(e),r=Yi(i.seconds,n.seconds);return r!==0?r:Yi(i.nanos,n.nanos)}function vp(t){return FC(t)}function FC(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Au(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?qd(t.bytesValue).toBase64():"referenceValue"in t?(i=t.referenceValue,ei.fromName(i).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(n){let r="[",s=!0;for(const o of n.values||[])s?s=!1:r+=",",r+=FC(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const a of r)o?o=!1:s+=",",s+=`${a}:${FC(n.fields[a])}`;return s+"}"}(t.mapValue):ni();var e,i}function zC(t){return!!t&&"integerValue"in t}function RA(t){return!!t&&"arrayValue"in t}function RR(t){return!!t&&"nullValue"in t}function FR(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function T0(t){return!!t&&"mapValue"in t}function ov(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return pf(t.mapValue.fields,(i,n)=>e.mapValue.fields[i]=ov(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let i=0;i<(t.arrayValue.values||[]).length;++i)e.arrayValue.values[i]=ov(t.arrayValue.values[i]);return e}return Object.assign({},t)}function Xde(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this.value=e}static empty(){return new yo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let i=this.value;for(let n=0;n<e.length-1;++n)if(i=(i.mapValue.fields||{})[e.get(n)],!T0(i))return null;return i=(i.mapValue.fields||{})[e.lastSegment()],i||null}}set(e,i){this.getFieldsMap(e.popLast())[e.lastSegment()]=ov(i)}setAll(e){let i=mc.emptyPath(),n={},r=[];e.forEach((o,a)=>{if(!i.isImmediateParentOf(a)){const l=this.getFieldsMap(i);this.applyChanges(l,n,r),n={},r=[],i=a.popLast()}o?n[a.lastSegment()]=ov(o):r.push(a.lastSegment())});const s=this.getFieldsMap(i);this.applyChanges(s,n,r)}delete(e){const i=this.field(e.popLast());T0(i)&&i.mapValue.fields&&delete i.mapValue.fields[e.lastSegment()]}isEqual(e){return pc(this.value,e.value)}getFieldsMap(e){let i=this.value;i.mapValue.fields||(i.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=i.mapValue.fields[e.get(n)];T0(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},i.mapValue.fields[e.get(n)]=r),i=r}return i.mapValue.fields}applyChanges(e,i,n){pf(i,(r,s)=>e[r]=s);for(const r of n)delete e[r]}clone(){return new yo(ov(this.value))}}function a$(t){const e=[];return pf(t.fields,(i,n)=>{const r=new mc([i]);if(T0(n)){const s=a$(n.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new Zo(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,i,n,r,s,o,a){this.key=e,this.documentType=i,this.version=n,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ys(e,0,bi.min(),bi.min(),bi.min(),yo.empty(),0)}static newFoundDocument(e,i,n,r){return new ys(e,1,i,bi.min(),n,r,0)}static newNoDocument(e,i){return new ys(e,2,i,bi.min(),bi.min(),yo.empty(),0)}static newUnknownDocument(e,i){return new ys(e,3,i,bi.min(),bi.min(),yo.empty(),2)}convertToFoundDocument(e,i){return!this.createTime.isEqual(bi.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=i,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=bi.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ys&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ys(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(e,i){this.position=e,this.inclusive=i}}function zR(t,e,i){let n=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(s.field.isKeyField()?n=ei.comparator(ei.fromName(o.referenceValue),i.key):n=gp(o,i.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function UR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let i=0;i<t.position.length;i++)if(!pc(t.position[i],e.position[i]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,i="asc"){this.field=e,this.dir=i}}function Yde(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l${}class Mr extends l${constructor(e,i,n){super(),this.field=e,this.op=i,this.value=n}static create(e,i,n){return e.isKeyField()?i==="in"||i==="not-in"?this.createKeyFieldInFilter(e,i,n):new Jde(e,i,n):i==="array-contains"?new tfe(e,n):i==="in"?new ife(e,n):i==="not-in"?new nfe(e,n):i==="array-contains-any"?new rfe(e,n):new Mr(e,i,n)}static createKeyFieldInFilter(e,i,n){return i==="in"?new Qde(e,n):new efe(e,n)}matches(e){const i=e.data.field(this.field);return this.op==="!="?i!==null&&this.matchesComparison(gp(i,this.value)):i!==null&&Kd(this.value)===Kd(i)&&this.matchesComparison(gp(i,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ni()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class gc extends l${constructor(e,i){super(),this.filters=e,this.op=i,this.lt=null}static create(e,i){return new gc(e,i)}matches(e){return c$(this)?this.filters.find(i=>!i.matches(e))===void 0:this.filters.find(i=>i.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,i)=>e.concat(i.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(i=>i.isInequality());return e!==null?e.field:null}ft(e){for(const i of this.getFlattenedFilters())if(e(i))return i;return null}}function c$(t){return t.op==="and"}function h$(t){return Zde(t)&&c$(t)}function Zde(t){for(const e of t.filters)if(e instanceof gc)return!1;return!0}function UC(t){if(t instanceof Mr)return t.field.canonicalString()+t.op.toString()+vp(t.value);if(h$(t))return t.filters.map(e=>UC(e)).join(",");{const e=t.filters.map(i=>UC(i)).join(",");return`${t.op}(${e})`}}function u$(t,e){return t instanceof Mr?function(i,n){return n instanceof Mr&&i.op===n.op&&i.field.isEqual(n.field)&&pc(i.value,n.value)}(t,e):t instanceof gc?function(i,n){return n instanceof gc&&i.op===n.op&&i.filters.length===n.filters.length?i.filters.reduce((r,s,o)=>r&&u$(s,n.filters[o]),!0):!1}(t,e):void ni()}function d$(t){return t instanceof Mr?function(e){return`${e.field.canonicalString()} ${e.op} ${vp(e.value)}`}(t):t instanceof gc?function(e){return e.op.toString()+" {"+e.getFilters().map(d$).join(" ,")+"}"}(t):"Filter"}class Jde extends Mr{constructor(e,i,n){super(e,i,n),this.key=ei.fromName(n.referenceValue)}matches(e){const i=ei.comparator(e.key,this.key);return this.matchesComparison(i)}}class Qde extends Mr{constructor(e,i){super(e,"in",i),this.keys=f$("in",i)}matches(e){return this.keys.some(i=>i.isEqual(e.key))}}class efe extends Mr{constructor(e,i){super(e,"not-in",i),this.keys=f$("not-in",i)}matches(e){return!this.keys.some(i=>i.isEqual(e.key))}}function f$(t,e){var i;return(((i=e.arrayValue)===null||i===void 0?void 0:i.values)||[]).map(n=>ei.fromName(n.referenceValue))}class tfe extends Mr{constructor(e,i){super(e,"array-contains",i)}matches(e){const i=e.data.field(this.field);return RA(i)&&py(i.arrayValue,this.value)}}class ife extends Mr{constructor(e,i){super(e,"in",i)}matches(e){const i=e.data.field(this.field);return i!==null&&py(this.value.arrayValue,i)}}class nfe extends Mr{constructor(e,i){super(e,"not-in",i)}matches(e){if(py(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const i=e.data.field(this.field);return i!==null&&!py(this.value.arrayValue,i)}}class rfe extends Mr{constructor(e,i){super(e,"array-contains-any",i)}matches(e){const i=e.data.field(this.field);return!(!RA(i)||!i.arrayValue.values)&&i.arrayValue.values.some(n=>py(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sfe{constructor(e,i=null,n=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=i,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.dt=null}}function BR(t,e=null,i=[],n=[],r=null,s=null,o=null){return new sfe(t,e,i,n,r,s,o)}function FA(t){const e=pi(t);if(e.dt===null){let i=e.path.canonicalString();e.collectionGroup!==null&&(i+="|cg:"+e.collectionGroup),i+="|f:",i+=e.filters.map(n=>UC(n)).join(","),i+="|ob:",i+=e.orderBy.map(n=>function(r){return r.field.canonicalString()+r.dir}(n)).join(","),TE(e.limit)||(i+="|l:",i+=e.limit),e.startAt&&(i+="|lb:",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(n=>vp(n)).join(",")),e.endAt&&(i+="|ub:",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(n=>vp(n)).join(",")),e.dt=i}return e.dt}function zA(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<t.orderBy.length;i++)if(!Yde(t.orderBy[i],e.orderBy[i]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(!u$(t.filters[i],e.filters[i]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!UR(t.startAt,e.startAt)&&UR(t.endAt,e.endAt)}function BC(t){return ei.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE{constructor(e,i=null,n=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=i,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.wt=null,this._t=null,this.startAt,this.endAt}}function ofe(t,e,i,n,r,s,o,a){return new xE(t,e,i,n,r,s,o,a)}function kE(t){return new xE(t)}function jR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function afe(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function lfe(t){for(const e of t.filters){const i=e.getFirstInequalityField();if(i!==null)return i}return null}function cfe(t){return t.collectionGroup!==null}function Fm(t){const e=pi(t);if(e.wt===null){e.wt=[];const i=lfe(e),n=afe(e);if(i!==null&&n===null)i.isKeyField()||e.wt.push(new av(i)),e.wt.push(new av(mc.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new av(mc.keyField(),s))}}}return e.wt}function fh(t){const e=pi(t);if(!e._t)if(e.limitType==="F")e._t=BR(e.path,e.collectionGroup,Fm(e),e.filters,e.limit,e.startAt,e.endAt);else{const i=[];for(const s of Fm(e)){const o=s.dir==="desc"?"asc":"desc";i.push(new av(s.field,o))}const n=e.endAt?new k_(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new k_(e.startAt.position,e.startAt.inclusive):null;e._t=BR(e.path,e.collectionGroup,i,e.filters,e.limit,n,r)}return e._t}function jC(t,e,i){return new xE(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,i,t.startAt,t.endAt)}function CE(t,e){return zA(fh(t),fh(e))&&t.limitType===e.limitType}function m$(t){return`${FA(fh(t))}|lt:${t.limitType}`}function $C(t){return`Query(target=${function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map(n=>d$(n)).join(", ")}]`),TE(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(n=>vp(n)).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(n=>vp(n)).join(",")),`Target(${i})`}(fh(t))}; limitType=${t.limitType})`}function ME(t,e){return e.isFoundDocument()&&function(i,n){const r=n.key.path;return i.collectionGroup!==null?n.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):ei.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)}(t,e)&&function(i,n){for(const r of Fm(i))if(!r.field.isKeyField()&&n.data.field(r.field)===null)return!1;return!0}(t,e)&&function(i,n){for(const r of i.filters)if(!r.matches(n))return!1;return!0}(t,e)&&function(i,n){return!(i.startAt&&!function(r,s,o){const a=zR(r,s,o);return r.inclusive?a<=0:a<0}(i.startAt,Fm(i),n)||i.endAt&&!function(r,s,o){const a=zR(r,s,o);return r.inclusive?a>=0:a>0}(i.endAt,Fm(i),n))}(t,e)}function hfe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function p$(t){return(e,i)=>{let n=!1;for(const r of Fm(t)){const s=ufe(r,e,i);if(s!==0)return s;n=n||r.field.isKeyField()}return 0}}function ufe(t,e,i){const n=t.field.isKeyField()?ei.comparator(e.key,i.key):function(r,s,o){const a=s.data.field(r),l=o.data.field(r);return a!==null&&l!==null?gp(a,l):ni()}(t.field,e,i);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ni()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,i){this.mapKeyFn=e,this.equalsFn=i,this.inner={},this.innerSize=0}get(e){const i=this.mapKeyFn(e),n=this.inner[i];if(n!==void 0){for(const[r,s]of n)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,i){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,i]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,i]);r.push([e,i]),this.innerSize++}delete(e){const i=this.mapKeyFn(e),n=this.inner[i];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[i]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){pf(this.inner,(i,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return s$(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dfe=new Sr(ei.comparator);function mh(){return dfe}const g$=new Sr(ei.comparator);function Fg(...t){let e=g$;for(const i of t)e=e.insert(i.key,i);return e}function v$(t){let e=g$;return t.forEach((i,n)=>e=e.insert(i,n.overlayedDocument)),e}function Sd(){return lv()}function y$(){return lv()}function lv(){return new Jp(t=>t.toString(),(t,e)=>t.isEqual(e))}const ffe=new Sr(ei.comparator),mfe=new ks(ei.comparator);function Li(...t){let e=mfe;for(const i of t)e=e.add(i);return e}const pfe=new ks(Yi);function gfe(){return pfe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S$(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:x_(e)?"-0":e}}function b$(t){return{integerValue:""+t}}function vfe(t,e){return Hde(e)?b$(e):S$(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this._=void 0}}function yfe(t,e,i){return t instanceof C_?function(n,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return r&&DA(r)&&(r=NA(r)),r&&(s.fields.__previous_value__=r),{mapValue:s}}(i,e):t instanceof gy?P$(t,e):t instanceof vy?E$(t,e):function(n,r){const s=_$(n,r),o=$R(s)+$R(n.gt);return zC(s)&&zC(n.gt)?b$(o):S$(n.serializer,o)}(t,e)}function Sfe(t,e,i){return t instanceof gy?P$(t,e):t instanceof vy?E$(t,e):i}function _$(t,e){return t instanceof M_?zC(i=e)||function(n){return!!n&&"doubleValue"in n}(i)?e:{integerValue:0}:null;var i}class C_ extends AE{}class gy extends AE{constructor(e){super(),this.elements=e}}function P$(t,e){const i=w$(e);for(const n of t.elements)i.some(r=>pc(r,n))||i.push(n);return{arrayValue:{values:i}}}class vy extends AE{constructor(e){super(),this.elements=e}}function E$(t,e){let i=w$(e);for(const n of t.elements)i=i.filter(r=>!pc(r,n));return{arrayValue:{values:i}}}class M_ extends AE{constructor(e,i){super(),this.serializer=e,this.gt=i}}function $R(t){return ur(t.integerValue||t.doubleValue)}function w$(t){return RA(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function bfe(t,e){return t.field.isEqual(e.field)&&function(i,n){return i instanceof gy&&n instanceof gy||i instanceof vy&&n instanceof vy?pp(i.elements,n.elements,pc):i instanceof M_&&n instanceof M_?pc(i.gt,n.gt):i instanceof C_&&n instanceof C_}(t.transform,e.transform)}class _fe{constructor(e,i){this.version=e,this.transformResults=i}}class Va{constructor(e,i){this.updateTime=e,this.exists=i}static none(){return new Va}static exists(e){return new Va(void 0,e)}static updateTime(e){return new Va(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function x0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class VE{}function T$(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new UA(t.key,Va.none()):new lS(t.key,t.data,Va.none());{const i=t.data,n=yo.empty();let r=new ks(mc.comparator);for(let s of e.fields)if(!r.has(s)){let o=i.field(s);o===null&&s.length>1&&(s=s.popLast(),o=i.field(s)),o===null?n.delete(s):n.set(s,o),r=r.add(s)}return new Bu(t.key,n,new Zo(r.toArray()),Va.none())}}function Pfe(t,e,i){t instanceof lS?function(n,r,s){const o=n.value.clone(),a=GR(n.fieldTransforms,r,s.transformResults);o.setAll(a),r.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,i):t instanceof Bu?function(n,r,s){if(!x0(n.precondition,r))return void r.convertToUnknownDocument(s.version);const o=GR(n.fieldTransforms,r,s.transformResults),a=r.data;a.setAll(x$(n)),a.setAll(o),r.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(t,e,i):function(n,r,s){r.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,i)}function cv(t,e,i,n){return t instanceof lS?function(r,s,o,a){if(!x0(r.precondition,s))return o;const l=r.value.clone(),c=HR(r.fieldTransforms,a,s);return l.setAll(c),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(t,e,i,n):t instanceof Bu?function(r,s,o,a){if(!x0(r.precondition,s))return o;const l=HR(r.fieldTransforms,a,s),c=s.data;return c.setAll(x$(r)),c.setAll(l),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),o===null?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(u=>u.field))}(t,e,i,n):function(r,s,o){return x0(r.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,i)}function Efe(t,e){let i=null;for(const n of t.fieldTransforms){const r=e.data.field(n.field),s=_$(n.transform,r||null);s!=null&&(i===null&&(i=yo.empty()),i.set(n.field,s))}return i||null}function WR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(i,n){return i===void 0&&n===void 0||!(!i||!n)&&pp(i,n,(r,s)=>bfe(r,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class lS extends VE{constructor(e,i,n,r=[]){super(),this.key=e,this.value=i,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Bu extends VE{constructor(e,i,n,r,s=[]){super(),this.key=e,this.data=i,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function x$(t){const e=new Map;return t.fieldMask.fields.forEach(i=>{if(!i.isEmpty()){const n=t.data.field(i);e.set(i,n)}}),e}function GR(t,e,i){const n=new Map;En(t.length===i.length);for(let r=0;r<i.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);n.set(s.field,Sfe(o,a,i[r]))}return n}function HR(t,e,i){const n=new Map;for(const r of t){const s=r.transform,o=i.data.field(r.field);n.set(r.field,yfe(s,o,e))}return n}class UA extends VE{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wfe extends VE{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tfe{constructor(e,i,n,r){this.batchId=e,this.localWriteTime=i,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,i){const n=i.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Pfe(s,e,n[r])}}applyToLocalView(e,i){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(i=cv(n,e,i,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(i=cv(n,e,i,this.localWriteTime));return i}applyToLocalDocumentSet(e,i){const n=y$();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=i.has(r.key)?null:a;const l=T$(o,a);l!==null&&n.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(bi.min())}),n}keys(){return this.mutations.reduce((e,i)=>e.add(i.key),Li())}isEqual(e){return this.batchId===e.batchId&&pp(this.mutations,e.mutations,(i,n)=>WR(i,n))&&pp(this.baseMutations,e.baseMutations,(i,n)=>WR(i,n))}}class BA{constructor(e,i,n,r){this.batch=e,this.commitVersion=i,this.mutationResults=n,this.docVersions=r}static from(e,i,n){En(e.mutations.length===n.length);let r=ffe;const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,n[o].version);return new BA(e,i,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xfe{constructor(e,i){this.largestBatchId=e,this.mutation=i}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kfe{constructor(e,i){this.count=e,this.unchangedNames=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lr,Ri;function Cfe(t){switch(t){default:return ni();case Qe.CANCELLED:case Qe.UNKNOWN:case Qe.DEADLINE_EXCEEDED:case Qe.RESOURCE_EXHAUSTED:case Qe.INTERNAL:case Qe.UNAVAILABLE:case Qe.UNAUTHENTICATED:return!1;case Qe.INVALID_ARGUMENT:case Qe.NOT_FOUND:case Qe.ALREADY_EXISTS:case Qe.PERMISSION_DENIED:case Qe.FAILED_PRECONDITION:case Qe.ABORTED:case Qe.OUT_OF_RANGE:case Qe.UNIMPLEMENTED:case Qe.DATA_LOSS:return!0}}function k$(t){if(t===void 0)return dh("GRPC error has no .code"),Qe.UNKNOWN;switch(t){case lr.OK:return Qe.OK;case lr.CANCELLED:return Qe.CANCELLED;case lr.UNKNOWN:return Qe.UNKNOWN;case lr.DEADLINE_EXCEEDED:return Qe.DEADLINE_EXCEEDED;case lr.RESOURCE_EXHAUSTED:return Qe.RESOURCE_EXHAUSTED;case lr.INTERNAL:return Qe.INTERNAL;case lr.UNAVAILABLE:return Qe.UNAVAILABLE;case lr.UNAUTHENTICATED:return Qe.UNAUTHENTICATED;case lr.INVALID_ARGUMENT:return Qe.INVALID_ARGUMENT;case lr.NOT_FOUND:return Qe.NOT_FOUND;case lr.ALREADY_EXISTS:return Qe.ALREADY_EXISTS;case lr.PERMISSION_DENIED:return Qe.PERMISSION_DENIED;case lr.FAILED_PRECONDITION:return Qe.FAILED_PRECONDITION;case lr.ABORTED:return Qe.ABORTED;case lr.OUT_OF_RANGE:return Qe.OUT_OF_RANGE;case lr.UNIMPLEMENTED:return Qe.UNIMPLEMENTED;case lr.DATA_LOSS:return Qe.DATA_LOSS;default:return ni()}}(Ri=lr||(lr={}))[Ri.OK=0]="OK",Ri[Ri.CANCELLED=1]="CANCELLED",Ri[Ri.UNKNOWN=2]="UNKNOWN",Ri[Ri.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ri[Ri.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ri[Ri.NOT_FOUND=5]="NOT_FOUND",Ri[Ri.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ri[Ri.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ri[Ri.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ri[Ri.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ri[Ri.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ri[Ri.ABORTED=10]="ABORTED",Ri[Ri.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ri[Ri.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ri[Ri.INTERNAL=13]="INTERNAL",Ri[Ri.UNAVAILABLE=14]="UNAVAILABLE",Ri[Ri.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Db}static getOrCreateInstance(){return Db===null&&(Db=new jA),Db}onExistenceFilterMismatch(e){const i=Symbol();return this.onExistenceFilterMismatchCallbacks.set(i,e),()=>this.onExistenceFilterMismatchCallbacks.delete(i)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(i=>i(e))}}let Db=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mfe(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Afe=new Rm([4294967295,4294967295],0);function qR(t){const e=Mfe().encode(t),i=new Vde;return i.update(e),new Uint8Array(i.digest())}function KR(t){const e=new DataView(t.buffer),i=e.getUint32(0,!0),n=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Rm([i,n],0),new Rm([r,s],0)]}class $A{constructor(e,i,n){if(this.bitmap=e,this.padding=i,this.hashCount=n,i<0||i>=8)throw new zg(`Invalid padding: ${i}`);if(n<0)throw new zg(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new zg(`Invalid hash count: ${n}`);if(e.length===0&&i!==0)throw new zg(`Invalid padding when bitmap length is 0: ${i}`);this.It=8*e.length-i,this.Tt=Rm.fromNumber(this.It)}Et(e,i,n){let r=e.add(i.multiply(Rm.fromNumber(n)));return r.compare(Afe)===1&&(r=new Rm([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;const i=qR(e),[n,r]=KR(i);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,r,s);if(!this.At(o))return!1}return!0}static create(e,i,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new $A(s,r,i);return n.forEach(a=>o.insert(a)),o}insert(e){if(this.It===0)return;const i=qR(e),[n,r]=KR(i);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,r,s);this.Rt(o)}}Rt(e){const i=Math.floor(e/8),n=e%8;this.bitmap[i]|=1<<n}}class zg extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(e,i,n,r,s){this.snapshotVersion=e,this.targetChanges=i,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,i,n){const r=new Map;return r.set(e,cS.createSynthesizedTargetChangeForCurrentChange(e,i,n)),new LE(bi.min(),r,new Sr(Yi),mh(),Li())}}class cS{constructor(e,i,n,r,s){this.resumeToken=e,this.current=i,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,i,n){return new cS(n,i,Li(),Li(),Li())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e,i,n,r){this.Pt=e,this.removedTargetIds=i,this.key=n,this.bt=r}}class C${constructor(e,i){this.targetId=e,this.Vt=i}}class M${constructor(e,i,n=As.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=i,this.resumeToken=n,this.cause=r}}class XR{constructor(){this.St=0,this.Dt=ZR(),this.Ct=As.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Li(),i=Li(),n=Li();return this.Dt.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:i=i.add(r);break;case 1:n=n.add(r);break;default:ni()}}),new cS(this.Ct,this.xt,e,i,n)}Ft(){this.Nt=!1,this.Dt=ZR()}Bt(e,i){this.Nt=!0,this.Dt=this.Dt.insert(e,i)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Vfe{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=mh(),this.zt=YR(),this.Wt=new Sr(Yi)}Ht(e){for(const i of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(i,e.bt):this.Yt(i,e.key,e.bt);for(const i of e.removedTargetIds)this.Yt(i,e.key,e.bt)}Xt(e){this.forEachTarget(e,i=>{const n=this.Zt(i);switch(e.state){case 0:this.te(i)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(i);break;case 3:this.te(i)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(i)&&(this.ee(i),n.$t(e.resumeToken));break;default:ni()}})}forEachTarget(e,i){e.targetIds.length>0?e.targetIds.forEach(i):this.Qt.forEach((n,r)=>{this.te(r)&&i(r)})}ne(e){var i;const n=e.targetId,r=e.Vt.count,s=this.se(n);if(s){const o=s.target;if(BC(o))if(r===0){const a=new ei(o.path);this.Yt(n,a,ys.newNoDocument(a,bi.min()))}else En(r===1);else{const a=this.ie(n);if(a!==r){const l=this.re(e,a);if(l!==0){this.ee(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,c)}(i=jA.instance)===null||i===void 0||i.notifyOnExistenceFilterMismatch(function(c,u,h){var d,f,m,g,v,p;const b={localCacheCount:u,existenceFilterCount:h.count},_=h.unchangedNames;return _&&(b.bloomFilter={applied:c===0,hashCount:(d=_==null?void 0:_.hashCount)!==null&&d!==void 0?d:0,bitmapLength:(g=(m=(f=_==null?void 0:_.bits)===null||f===void 0?void 0:f.bitmap)===null||m===void 0?void 0:m.length)!==null&&g!==void 0?g:0,padding:(p=(v=_==null?void 0:_.bits)===null||v===void 0?void 0:v.padding)!==null&&p!==void 0?p:0}),b}(l,a,e.Vt))}}}}re(e,i){const{unchangedNames:n,count:r}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:s="",padding:o=0},hashCount:a=0}=n;let l,c;try{l=qd(s).toUint8Array()}catch(u){if(u instanceof o$)return mp("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw u}try{c=new $A(l,o,a)}catch(u){return mp(u instanceof zg?"BloomFilter error: ":"Applying bloom filter failed: ",u),1}return c.It===0?1:r!==i-this.oe(e.targetId,c)?2:0}oe(e,i){const n=this.Gt.getRemoteKeysForTarget(e);let r=0;return n.forEach(s=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;i.vt(a)||(this.Yt(e,s,null),r++)}),r}ce(e){const i=new Map;this.Qt.forEach((s,o)=>{const a=this.se(o);if(a){if(s.current&&BC(a.target)){const l=new ei(a.target.path);this.jt.get(l)!==null||this.ae(o,l)||this.Yt(o,l,ys.newNoDocument(l,e))}s.Mt&&(i.set(o,s.Ot()),s.Ft())}});let n=Li();this.zt.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.se(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(e));const r=new LE(e,i,this.Wt,this.jt,n);return this.jt=mh(),this.zt=YR(),this.Wt=new Sr(Yi),r}Jt(e,i){if(!this.te(e))return;const n=this.ae(e,i.key)?2:0;this.Zt(e).Bt(i.key,n),this.jt=this.jt.insert(i.key,i),this.zt=this.zt.insert(i.key,this.he(i.key).add(e))}Yt(e,i,n){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,i)?r.Bt(i,1):r.Lt(i),this.zt=this.zt.insert(i,this.he(i).delete(e)),n&&(this.jt=this.jt.insert(i,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const i=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+i.addedDocuments.size-i.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let i=this.Qt.get(e);return i||(i=new XR,this.Qt.set(e,i)),i}he(e){let i=this.zt.get(e);return i||(i=new ks(Yi),this.zt=this.zt.insert(e,i)),i}te(e){const i=this.se(e)!==null;return i||It("WatchChangeAggregator","Detected inactive target",e),i}se(e){const i=this.Qt.get(e);return i&&i.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new XR),this.Gt.getRemoteKeysForTarget(e).forEach(i=>{this.Yt(e,i,null)})}ae(e,i){return this.Gt.getRemoteKeysForTarget(e).has(i)}}function YR(){return new Sr(ei.comparator)}function ZR(){return new Sr(ei.comparator)}const Lfe=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Ife=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Ofe=(()=>({and:"AND",or:"OR"}))();class Dfe{constructor(e,i){this.databaseId=e,this.useProto3Json=i}}function WC(t,e){return t.useProto3Json||TE(e)?e:{value:e}}function A_(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function A$(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Nfe(t,e){return A_(t,e.toTimestamp())}function hc(t){return En(!!t),bi.fromTimestamp(function(e){const i=Au(e);return new Qs(i.seconds,i.nanos)}(t))}function WA(t,e){return function(i){return new fr(["projects",i.projectId,"databases",i.database])}(t).child("documents").child(e).canonicalString()}function V$(t){const e=fr.fromString(t);return En(D$(e)),e}function GC(t,e){return WA(t.databaseId,e.path)}function ZT(t,e){const i=V$(e);if(i.get(1)!==t.databaseId.projectId)throw new Rt(Qe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+i.get(1)+" vs "+t.databaseId.projectId);if(i.get(3)!==t.databaseId.database)throw new Rt(Qe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+i.get(3)+" vs "+t.databaseId.database);return new ei(L$(i))}function HC(t,e){return WA(t.databaseId,e)}function Rfe(t){const e=V$(t);return e.length===4?fr.emptyPath():L$(e)}function qC(t){return new fr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function L$(t){return En(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function JR(t,e,i){return{name:GC(t,e),fields:i.value.mapValue.fields}}function Ffe(t,e){let i;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:ni()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(l,c){return l.useProto3Json?(En(c===void 0||typeof c=="string"),As.fromBase64String(c||"")):(En(c===void 0||c instanceof Uint8Array),As.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const c=l.code===void 0?Qe.UNKNOWN:k$(l.code);return new Rt(c,l.message||"")}(o);i=new M$(n,r,s,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const r=ZT(t,n.document.name),s=hc(n.document.updateTime),o=n.document.createTime?hc(n.document.createTime):bi.min(),a=new yo({mapValue:{fields:n.document.fields}}),l=ys.newFoundDocument(r,s,o,a),c=n.targetIds||[],u=n.removedTargetIds||[];i=new k0(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const r=ZT(t,n.document),s=n.readTime?hc(n.readTime):bi.min(),o=ys.newNoDocument(r,s),a=n.removedTargetIds||[];i=new k0([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const r=ZT(t,n.document),s=n.removedTargetIds||[];i=new k0([],s,r,null)}else{if(!("filter"in e))return ni();{e.filter;const n=e.filter;n.targetId;const{count:r=0,unchangedNames:s}=n,o=new kfe(r,s),a=n.targetId;i=new C$(a,o)}}return i}function zfe(t,e){let i;if(e instanceof lS)i={update:JR(t,e.key,e.value)};else if(e instanceof UA)i={delete:GC(t,e.key)};else if(e instanceof Bu)i={update:JR(t,e.key,e.data),updateMask:Kfe(e.fieldMask)};else{if(!(e instanceof wfe))return ni();i={verify:GC(t,e.key)}}return e.fieldTransforms.length>0&&(i.updateTransforms=e.fieldTransforms.map(n=>function(r,s){const o=s.transform;if(o instanceof C_)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof gy)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof vy)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof M_)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw ni()}(0,n))),e.precondition.isNone||(i.currentDocument=function(n,r){return r.updateTime!==void 0?{updateTime:Nfe(n,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:ni()}(t,e.precondition)),i}function Ufe(t,e){return t&&t.length>0?(En(e!==void 0),t.map(i=>function(n,r){let s=n.updateTime?hc(n.updateTime):hc(r);return s.isEqual(bi.min())&&(s=hc(r)),new _fe(s,n.transformResults||[])}(i,e))):[]}function Bfe(t,e){return{documents:[HC(t,e.path)]}}function jfe(t,e){const i={structuredQuery:{}},n=e.path;e.collectionGroup!==null?(i.parent=HC(t,n),i.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i.parent=HC(t,n.popLast()),i.structuredQuery.from=[{collectionId:n.lastSegment()}]);const r=function(l){if(l.length!==0)return O$(gc.create(l,"and"))}(e.filters);r&&(i.structuredQuery.where=r);const s=function(l){if(l.length!==0)return l.map(c=>function(u){return{field:hm(u.field),direction:Gfe(u.dir)}}(c))}(e.orderBy);s&&(i.structuredQuery.orderBy=s);const o=WC(t,e.limit);var a;return o!==null&&(i.structuredQuery.limit=o),e.startAt&&(i.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(i.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),i}function $fe(t){let e=Rfe(t.parent);const i=t.structuredQuery,n=i.from?i.from.length:0;let r=null;if(n>0){En(n===1);const u=i.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let s=[];i.where&&(s=function(u){const h=I$(u);return h instanceof gc&&h$(h)?h.getFilters():[h]}(i.where));let o=[];i.orderBy&&(o=i.orderBy.map(u=>function(h){return new av(um(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;i.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,TE(h)?null:h}(i.limit));let l=null;i.startAt&&(l=function(u){const h=!!u.before,d=u.values||[];return new k_(d,h)}(i.startAt));let c=null;return i.endAt&&(c=function(u){const h=!u.before,d=u.values||[];return new k_(d,h)}(i.endAt)),ofe(e,r,o,s,a,"F",l,c)}function Wfe(t,e){const i=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ni()}}(e.purpose);return i==null?null:{"goog-listen-tags":i}}function I$(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=um(e.unaryFilter.field);return Mr.create(i,"==",{doubleValue:NaN});case"IS_NULL":const n=um(e.unaryFilter.field);return Mr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=um(e.unaryFilter.field);return Mr.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=um(e.unaryFilter.field);return Mr.create(s,"!=",{nullValue:"NULL_VALUE"});default:return ni()}}(t):t.fieldFilter!==void 0?function(e){return Mr.create(um(e.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ni()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return gc.create(e.compositeFilter.filters.map(i=>I$(i)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ni()}}(e.compositeFilter.op))}(t):ni()}function Gfe(t){return Lfe[t]}function Hfe(t){return Ife[t]}function qfe(t){return Ofe[t]}function hm(t){return{fieldPath:t.canonicalString()}}function um(t){return mc.fromServerFormat(t.fieldPath)}function O$(t){return t instanceof Mr?function(e){if(e.op==="=="){if(FR(e.value))return{unaryFilter:{field:hm(e.field),op:"IS_NAN"}};if(RR(e.value))return{unaryFilter:{field:hm(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(FR(e.value))return{unaryFilter:{field:hm(e.field),op:"IS_NOT_NAN"}};if(RR(e.value))return{unaryFilter:{field:hm(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hm(e.field),op:Hfe(e.op),value:e.value}}}(t):t instanceof gc?function(e){const i=e.getFilters().map(n=>O$(n));return i.length===1?i[0]:{compositeFilter:{op:qfe(e.op),filters:i}}}(t):ni()}function Kfe(t){const e=[];return t.fields.forEach(i=>e.push(i.canonicalString())),{fieldPaths:e}}function D$(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,i,n,r,s=bi.min(),o=bi.min(),a=As.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=i,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new mu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,i){return new mu(this.target,this.targetId,this.purpose,this.sequenceNumber,i,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xfe{constructor(e){this.fe=e}}function Yfe(t){const e=$fe({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?jC(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zfe{constructor(){this.rn=new Jfe}addToCollectionParentIndex(e,i){return this.rn.add(i),ft.resolve()}getCollectionParents(e,i){return ft.resolve(this.rn.getEntries(i))}addFieldIndex(e,i){return ft.resolve()}deleteFieldIndex(e,i){return ft.resolve()}getDocumentsMatchingTarget(e,i){return ft.resolve(null)}getIndexType(e,i){return ft.resolve(0)}getFieldIndexes(e,i){return ft.resolve([])}getNextCollectionGroupToUpdate(e){return ft.resolve(null)}getMinOffset(e,i){return ft.resolve(dy.min())}getMinOffsetFromCollectionGroup(e,i){return ft.resolve(dy.min())}updateCollectionGroup(e,i,n){return ft.resolve()}updateIndexEntries(e,i){return ft.resolve()}}class Jfe{constructor(){this.index={}}add(e){const i=e.lastSegment(),n=e.popLast(),r=this.index[i]||new ks(fr.comparator),s=!r.has(n);return this.index[i]=r.add(n),s}has(e){const i=e.lastSegment(),n=e.popLast(),r=this.index[i];return r&&r.has(n)}getEntries(e){return(this.index[e]||new ks(fr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new yp(0)}static Mn(){return new yp(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qfe{constructor(){this.changes=new Jp(e=>e.toString(),(e,i)=>e.isEqual(i)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,i){this.assertNotApplied(),this.changes.set(e,ys.newInvalidDocument(e).setReadTime(i))}getEntry(e,i){this.assertNotApplied();const n=this.changes.get(i);return n!==void 0?ft.resolve(n):this.getFromCache(e,i)}getEntries(e,i){return this.getAllFromCache(e,i)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eme{constructor(e,i){this.overlayedDocument=e,this.mutatedFields=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tme{constructor(e,i,n,r){this.remoteDocumentCache=e,this.mutationQueue=i,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,i){let n=null;return this.documentOverlayCache.getOverlay(e,i).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,i))).next(r=>(n!==null&&cv(n.mutation,r,Zo.empty(),Qs.now()),r))}getDocuments(e,i){return this.remoteDocumentCache.getEntries(e,i).next(n=>this.getLocalViewOfDocuments(e,n,Li()).next(()=>n))}getLocalViewOfDocuments(e,i,n=Li()){const r=Sd();return this.populateOverlays(e,r,i).next(()=>this.computeViews(e,i,r,n).next(s=>{let o=Fg();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,i){const n=Sd();return this.populateOverlays(e,n,i).next(()=>this.computeViews(e,i,n,Li()))}populateOverlays(e,i,n){const r=[];return n.forEach(s=>{i.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{i.set(o,a)})})}computeViews(e,i,n,r){let s=mh();const o=lv(),a=lv();return i.forEach((l,c)=>{const u=n.get(c.key);r.has(c.key)&&(u===void 0||u.mutation instanceof Bu)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),cv(u.mutation,c,u.mutation.getFieldMask(),Qs.now())):o.set(c.key,Zo.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>o.set(c,u)),i.forEach((c,u)=>{var h;return a.set(c,new eme(u,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,i){const n=lv();let r=new Sr((o,a)=>o-a),s=Li();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,i).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=i.get(l);if(c===null)return;let u=n.get(l)||Zo.empty();u=a.applyToLocalView(c,u),n.set(l,u);const h=(r.get(a.batchId)||Li()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=y$();u.forEach(d=>{if(!s.has(d)){const f=T$(i.get(d),n.get(d));f!==null&&h.set(d,f),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return ft.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,i){return this.remoteDocumentCache.getEntries(e,i).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,i,n){return function(r){return ei.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}(i)?this.getDocumentsMatchingDocumentQuery(e,i.path):cfe(i)?this.getDocumentsMatchingCollectionGroupQuery(e,i,n):this.getDocumentsMatchingCollectionQuery(e,i,n)}getNextDocuments(e,i,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,i,n,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,i,n.largestBatchId,r-s.size):ft.resolve(Sd());let a=-1,l=s;return o.next(c=>ft.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?ft.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Li())).next(u=>({batchId:a,changes:v$(u)})))})}getDocumentsMatchingDocumentQuery(e,i){return this.getDocument(e,new ei(i)).next(n=>{let r=Fg();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,i,n){const r=i.collectionGroup;let s=Fg();return this.indexManager.getCollectionParents(e,r).next(o=>ft.forEach(o,a=>{const l=function(c,u){return new xE(u,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(i,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,l,n).next(c=>{c.forEach((u,h)=>{s=s.insert(u,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,i,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,i.path,n.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,i,n,r))).next(s=>{r.forEach((a,l)=>{const c=l.getKey();s.get(c)===null&&(s=s.insert(c,ys.newInvalidDocument(c)))});let o=Fg();return s.forEach((a,l)=>{const c=r.get(a);c!==void 0&&cv(c.mutation,l,Zo.empty(),Qs.now()),ME(i,l)&&(o=o.insert(a,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ime{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,i){return ft.resolve(this.cs.get(i))}saveBundleMetadata(e,i){var n;return this.cs.set(i.id,{id:(n=i).id,version:n.version,createTime:hc(n.createTime)}),ft.resolve()}getNamedQuery(e,i){return ft.resolve(this.hs.get(i))}saveNamedQuery(e,i){return this.hs.set(i.name,function(n){return{name:n.name,query:Yfe(n.bundledQuery),readTime:hc(n.readTime)}}(i)),ft.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nme{constructor(){this.overlays=new Sr(ei.comparator),this.ls=new Map}getOverlay(e,i){return ft.resolve(this.overlays.get(i))}getOverlays(e,i){const n=Sd();return ft.forEach(i,r=>this.getOverlay(e,r).next(s=>{s!==null&&n.set(r,s)})).next(()=>n)}saveOverlays(e,i,n){return n.forEach((r,s)=>{this.we(e,i,s)}),ft.resolve()}removeOverlaysForBatchId(e,i,n){const r=this.ls.get(n);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(n)),ft.resolve()}getOverlaysForCollection(e,i,n){const r=Sd(),s=i.length+1,o=new ei(i.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!i.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&r.set(l.getKey(),l)}return ft.resolve(r)}getOverlaysForCollectionGroup(e,i,n,r){let s=new Sr((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===i&&c.largestBatchId>n){let u=s.get(c.largestBatchId);u===null&&(u=Sd(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=Sd(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=r)););return ft.resolve(a)}we(e,i,n){const r=this.overlays.get(n.key);if(r!==null){const o=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new xfe(i,n));let s=this.ls.get(i);s===void 0&&(s=Li(),this.ls.set(i,s)),this.ls.set(i,s.add(n.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(){this.fs=new ks(Ur.ds),this.ws=new ks(Ur._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,i){const n=new Ur(e,i);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,i){e.forEach(n=>this.addReference(n,i))}removeReference(e,i){this.ys(new Ur(e,i))}ps(e,i){e.forEach(n=>this.removeReference(n,i))}Is(e){const i=new ei(new fr([])),n=new Ur(i,e),r=new Ur(i,e+1),s=[];return this.ws.forEachInRange([n,r],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const i=new ei(new fr([])),n=new Ur(i,e),r=new Ur(i,e+1);let s=Li();return this.ws.forEachInRange([n,r],o=>{s=s.add(o.key)}),s}containsKey(e){const i=new Ur(e,0),n=this.fs.firstAfterOrEqual(i);return n!==null&&e.isEqual(n.key)}}class Ur{constructor(e,i){this.key=e,this.As=i}static ds(e,i){return ei.comparator(e.key,i.key)||Yi(e.As,i.As)}static _s(e,i){return Yi(e.As,i.As)||ei.comparator(e.key,i.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rme{constructor(e,i){this.indexManager=e,this.referenceDelegate=i,this.mutationQueue=[],this.vs=1,this.Rs=new ks(Ur.ds)}checkEmpty(e){return ft.resolve(this.mutationQueue.length===0)}addMutationBatch(e,i,n,r){const s=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Tfe(s,i,n,r);this.mutationQueue.push(o);for(const a of r)this.Rs=this.Rs.add(new Ur(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ft.resolve(o)}lookupMutationBatch(e,i){return ft.resolve(this.Ps(i))}getNextMutationBatchAfterBatchId(e,i){const n=i+1,r=this.bs(n),s=r<0?0:r;return ft.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ft.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return ft.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,i){const n=new Ur(i,0),r=new Ur(i,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([n,r],o=>{const a=this.Ps(o.As);s.push(a)}),ft.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,i){let n=new ks(Yi);return i.forEach(r=>{const s=new Ur(r,0),o=new Ur(r,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],a=>{n=n.add(a.As)})}),ft.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,i){const n=i.path,r=n.length+1;let s=n;ei.isDocumentKey(s)||(s=s.child(""));const o=new Ur(new ei(s),0);let a=new ks(Yi);return this.Rs.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.As)),!0)},o),ft.resolve(this.Vs(a))}Vs(e){const i=[];return e.forEach(n=>{const r=this.Ps(n);r!==null&&i.push(r)}),i}removeMutationBatch(e,i){En(this.Ss(i.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Rs;return ft.forEach(i.mutations,r=>{const s=new Ur(r.key,i.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,i){const n=new Ur(i,0),r=this.Rs.firstAfterOrEqual(n);return ft.resolve(i.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ft.resolve()}Ss(e,i){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){const i=this.bs(e);return i<0||i>=this.mutationQueue.length?null:this.mutationQueue[i]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sme{constructor(e){this.Ds=e,this.docs=new Sr(ei.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,i){const n=i.key,r=this.docs.get(n),s=r?r.size:0,o=this.Ds(i);return this.docs=this.docs.insert(n,{document:i.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const i=this.docs.get(e);i&&(this.docs=this.docs.remove(e),this.size-=i.size)}getEntry(e,i){const n=this.docs.get(i);return ft.resolve(n?n.document.mutableCopy():ys.newInvalidDocument(i))}getEntries(e,i){let n=mh();return i.forEach(r=>{const s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():ys.newInvalidDocument(r))}),ft.resolve(n)}getDocumentsMatchingQuery(e,i,n,r){let s=mh();const o=i.path,a=new ei(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||$de(jde(u),n)<=0||(r.has(u.key)||ME(i,u))&&(s=s.insert(u.key,u.mutableCopy()))}return ft.resolve(s)}getAllFromCollectionGroup(e,i,n,r){ni()}Cs(e,i){return ft.forEach(this.docs,n=>i(n))}newChangeBuffer(e){return new ome(this)}getSize(e){return ft.resolve(this.size)}}class ome extends Qfe{constructor(e){super(),this.os=e}applyChanges(e){const i=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?i.push(this.os.addEntry(e,r)):this.os.removeEntry(n)}),ft.waitFor(i)}getFromCache(e,i){return this.os.getEntry(e,i)}getAllFromCache(e,i){return this.os.getEntries(e,i)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ame{constructor(e){this.persistence=e,this.xs=new Jp(i=>FA(i),zA),this.lastRemoteSnapshotVersion=bi.min(),this.highestTargetId=0,this.Ns=0,this.ks=new GA,this.targetCount=0,this.Ms=yp.kn()}forEachTarget(e,i){return this.xs.forEach((n,r)=>i(r)),ft.resolve()}getLastRemoteSnapshotVersion(e){return ft.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ft.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),ft.resolve(this.highestTargetId)}setTargetsMetadata(e,i,n){return n&&(this.lastRemoteSnapshotVersion=n),i>this.Ns&&(this.Ns=i),ft.resolve()}Fn(e){this.xs.set(e.target,e);const i=e.targetId;i>this.highestTargetId&&(this.Ms=new yp(i),this.highestTargetId=i),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,i){return this.Fn(i),this.targetCount+=1,ft.resolve()}updateTargetData(e,i){return this.Fn(i),ft.resolve()}removeTargetData(e,i){return this.xs.delete(i.target),this.ks.Is(i.targetId),this.targetCount-=1,ft.resolve()}removeTargets(e,i,n){let r=0;const s=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=i&&n.get(a.targetId)===null&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),ft.waitFor(s).next(()=>r)}getTargetCount(e){return ft.resolve(this.targetCount)}getTargetData(e,i){const n=this.xs.get(i)||null;return ft.resolve(n)}addMatchingKeys(e,i,n){return this.ks.gs(i,n),ft.resolve()}removeMatchingKeys(e,i,n){this.ks.ps(i,n);const r=this.persistence.referenceDelegate,s=[];return r&&i.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),ft.waitFor(s)}removeMatchingKeysForTargetId(e,i){return this.ks.Is(i),ft.resolve()}getMatchingKeysForTargetId(e,i){const n=this.ks.Es(i);return ft.resolve(n)}containsKey(e,i){return ft.resolve(this.ks.containsKey(i))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lme{constructor(e,i){this.$s={},this.overlays={},this.Os=new OA(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new ame(this),this.indexManager=new Zfe,this.remoteDocumentCache=function(n){return new sme(n)}(n=>this.referenceDelegate.Ls(n)),this.serializer=new Xfe(i),this.qs=new ime(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let i=this.overlays[e.toKey()];return i||(i=new nme,this.overlays[e.toKey()]=i),i}getMutationQueue(e,i){let n=this.$s[e.toKey()];return n||(n=new rme(i,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,i,n){It("MemoryPersistence","Starting transaction:",e);const r=new cme(this.Os.next());return this.referenceDelegate.Us(),n(r).next(s=>this.referenceDelegate.Ks(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Gs(e,i){return ft.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,i)))}}class cme extends Gde{constructor(e){super(),this.currentSequenceNumber=e}}class HA{constructor(e){this.persistence=e,this.Qs=new GA,this.js=null}static zs(e){return new HA(e)}get Ws(){if(this.js)return this.js;throw ni()}addReference(e,i,n){return this.Qs.addReference(n,i),this.Ws.delete(n.toString()),ft.resolve()}removeReference(e,i,n){return this.Qs.removeReference(n,i),this.Ws.add(n.toString()),ft.resolve()}markPotentiallyOrphaned(e,i){return this.Ws.add(i.toString()),ft.resolve()}removeTarget(e,i){this.Qs.Is(i.targetId).forEach(r=>this.Ws.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,i.targetId).next(r=>{r.forEach(s=>this.Ws.add(s.toString()))}).next(()=>n.removeTargetData(e,i))}Us(){this.js=new Set}Ks(e){const i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ft.forEach(this.Ws,n=>{const r=ei.fromPath(n);return this.Hs(e,r).next(s=>{s||i.removeEntry(r,bi.min())})}).next(()=>(this.js=null,i.apply(e)))}updateLimboDocument(e,i){return this.Hs(e,i).next(n=>{n?this.Ws.delete(i.toString()):this.Ws.add(i.toString())})}Ls(e){return 0}Hs(e,i){return ft.or([()=>ft.resolve(this.Qs.containsKey(i)),()=>this.persistence.getTargetCache().containsKey(e,i),()=>this.persistence.Gs(e,i)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(e,i,n,r){this.targetId=e,this.fromCache=i,this.Fi=n,this.Bi=r}static Li(e,i){let n=Li(),r=Li();for(const s of i.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new qA(e,i.fromCache,n,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hme{constructor(){this.qi=!1}initialize(e,i){this.Ui=e,this.indexManager=i,this.qi=!0}getDocumentsMatchingQuery(e,i,n,r){return this.Ki(e,i).next(s=>s||this.Gi(e,i,r,n)).next(s=>s||this.Qi(e,i))}Ki(e,i){if(jR(i))return ft.resolve(null);let n=fh(i);return this.indexManager.getIndexType(e,n).next(r=>r===0?null:(i.limit!==null&&r===1&&(i=jC(i,null,"F"),n=fh(i)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=Li(...s);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ji(i,a);return this.zi(i,c,o,l.readTime)?this.Ki(e,jC(i,null,"F")):this.Wi(e,c,i,l)}))})))}Gi(e,i,n,r){return jR(i)||r.isEqual(bi.min())?this.Qi(e,i):this.Ui.getDocuments(e,n).next(s=>{const o=this.ji(i,s);return this.zi(i,o,n,r)?this.Qi(e,i):(IR()<=Gi.DEBUG&&It("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),$C(i)),this.Wi(e,o,i,Bde(r,-1)))})}ji(e,i){let n=new ks(p$(e));return i.forEach((r,s)=>{ME(e,s)&&(n=n.add(s))}),n}zi(e,i,n,r){if(e.limit===null)return!1;if(n.size!==i.size)return!0;const s=e.limitType==="F"?i.last():i.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Qi(e,i){return IR()<=Gi.DEBUG&&It("QueryEngine","Using full collection scan to execute query:",$C(i)),this.Ui.getDocumentsMatchingQuery(e,i,dy.min())}Wi(e,i,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next(s=>(i.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ume{constructor(e,i,n,r){this.persistence=e,this.Hi=i,this.serializer=r,this.Ji=new Sr(Yi),this.Yi=new Jp(s=>FA(s),zA),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tme(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",i=>e.collect(i,this.Ji))}}function dme(t,e,i,n){return new ume(t,e,i,n)}async function N$(t,e){const i=pi(t);return await i.persistence.runTransaction("Handle user change","readonly",n=>{let r;return i.mutationQueue.getAllMutationBatches(n).next(s=>(r=s,i.tr(e),i.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let l=Li();for(const c of r){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return i.localDocuments.getDocuments(n,l).next(c=>({er:c,removedBatchIds:o,addedBatchIds:a}))})})}function fme(t,e){const i=pi(t);return i.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),s=i.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,l,c){const u=l.batch,h=u.keys();let d=ft.resolve();return h.forEach(f=>{d=d.next(()=>c.getEntry(a,f)).next(m=>{const g=l.docVersions.get(f);En(g!==null),m.version.compareTo(g)<0&&(u.applyToRemoteDocument(m,l),m.isValidDocument()&&(m.setReadTime(l.commitVersion),c.addEntry(m)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(i,n,e,s).next(()=>s.apply(n)).next(()=>i.mutationQueue.performConsistencyCheck(n)).next(()=>i.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let a=Li();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>i.localDocuments.getDocuments(n,r))})}function R$(t){const e=pi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",i=>e.Bs.getLastRemoteSnapshotVersion(i))}function mme(t,e){const i=pi(t),n=e.snapshotVersion;let r=i.Ji;return i.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=i.Zi.newChangeBuffer({trackRemovals:!0});r=i.Ji;const a=[];e.targetChanges.forEach((u,h)=>{const d=r.get(h);if(!d)return;a.push(i.Bs.removeMatchingKeys(s,u.removedDocuments,h).next(()=>i.Bs.addMatchingKeys(s,u.addedDocuments,h)));let f=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(As.EMPTY_BYTE_STRING,bi.min()).withLastLimboFreeSnapshotVersion(bi.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,n)),r=r.insert(h,f),function(m,g,v){return m.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(d,f,u)&&a.push(i.Bs.updateTargetData(s,f))});let l=mh(),c=Li();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(i.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(pme(s,o,e.documentUpdates).next(u=>{l=u.nr,c=u.sr})),!n.isEqual(bi.min())){const u=i.Bs.getLastRemoteSnapshotVersion(s).next(h=>i.Bs.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(u)}return ft.waitFor(a).next(()=>o.apply(s)).next(()=>i.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(i.Ji=r,s))}function pme(t,e,i){let n=Li(),r=Li();return i.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let o=mh();return i.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(bi.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):It("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{nr:o,sr:r}})}function gme(t,e){const i=pi(t);return i.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),i.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function vme(t,e){const i=pi(t);return i.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return i.Bs.getTargetData(n,e).next(s=>s?(r=s,ft.resolve(r)):i.Bs.allocateTargetId(n).next(o=>(r=new mu(e,o,"TargetPurposeListen",n.currentSequenceNumber),i.Bs.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=i.Ji.get(n.targetId);return(r===null||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(i.Ji=i.Ji.insert(n.targetId,n),i.Yi.set(e,n.targetId)),n})}async function KC(t,e,i){const n=pi(t),r=n.Ji.get(e),s=i?"readwrite":"readwrite-primary";try{i||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!aS(o))throw o;It("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ji=n.Ji.remove(e),n.Yi.delete(r.target)}function QR(t,e,i){const n=pi(t);let r=bi.min(),s=Li();return n.persistence.runTransaction("Execute query","readonly",o=>function(a,l,c){const u=pi(a),h=u.Yi.get(c);return h!==void 0?ft.resolve(u.Ji.get(h)):u.Bs.getTargetData(l,c)}(n,o,fh(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,n.Bs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>n.Hi.getDocumentsMatchingQuery(o,e,i?r:bi.min(),i?s:Li())).next(a=>(yme(n,hfe(e),a),{documents:a,ir:s})))}function yme(t,e,i){let n=t.Xi.get(e)||bi.min();i.forEach((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.Xi.set(e,n)}class e2{constructor(){this.activeTargetIds=gfe()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Sme{constructor(){this.Hr=new e2,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,i,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,i,n){this.Jr[e]=i}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new e2,Promise.resolve()}handleUserChange(e,i,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bme{Yr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){It("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){It("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nb=null;function JT(){return Nb===null?Nb=268435456+Math.round(2147483648*Math.random()):Nb++,"0x"+Nb.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _me={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pme{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms="WebChannelConnection";class Eme extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const i=e.ssl?"https":"http";this.mo=i+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,i,n,r,s){const o=JT(),a=this.To(e,i);It("RestConnection",`Sending RPC '${e}' ${o}:`,a,n);const l={};return this.Eo(l,r,s),this.Ao(e,a,l,n).then(c=>(It("RestConnection",`Received RPC '${e}' ${o}: `,c),c),c=>{throw mp("RestConnection",`RPC '${e}' ${o} failed with error: `,c,"url: ",a,"request:",n),c})}vo(e,i,n,r,s,o){return this.Io(e,i,n,r,s)}Eo(e,i,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Zp,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((r,s)=>e[s]=r),n&&n.headers.forEach((r,s)=>e[s]=r)}To(e,i){const n=_me[e];return`${this.mo}/v1/${i}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,i,n,r){const s=JT();return new Promise((o,a)=>{const l=new Ade;l.setWithCredentials(!0),l.listenOnce(kde.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case YT.NO_ERROR:const u=l.getResponseJson();It(ms,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case YT.TIMEOUT:It(ms,`RPC '${e}' ${s} timed out`),a(new Rt(Qe.DEADLINE_EXCEEDED,"Request time out"));break;case YT.HTTP_ERROR:const h=l.getStatus();if(It(ms,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const f=d==null?void 0:d.error;if(f&&f.status&&f.message){const m=function(g){const v=g.toLowerCase().replace(/_/g,"-");return Object.values(Qe).indexOf(v)>=0?v:Qe.UNKNOWN}(f.status);a(new Rt(m,f.message))}else a(new Rt(Qe.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new Rt(Qe.UNAVAILABLE,"Connection failed."));break;default:ni()}}finally{It(ms,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(r);It(ms,`RPC '${e}' ${s} sending request:`,r),l.send(i,"POST",c,n,15)})}Ro(e,i,n){const r=JT(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Tde(),a=xde(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new Mde({})),this.Eo(l.initMessageHeaders,i,n),l.encodeInitMessageHeaders=!0;const u=s.join("");It(ms,`Creating RPC '${e}' stream ${r}: ${u}`,l);const h=o.createWebChannel(u,l);let d=!1,f=!1;const m=new Pme({ro:v=>{f?It(ms,`Not sending because RPC '${e}' stream ${r} is closed:`,v):(d||(It(ms,`Opening RPC '${e}' stream ${r} transport.`),h.open(),d=!0),It(ms,`RPC '${e}' stream ${r} sending:`,v),h.send(v))},oo:()=>h.close()}),g=(v,p,b)=>{v.listen(p,_=>{try{b(_)}catch(P){setTimeout(()=>{throw P},0)}})};return g(h,Lb.EventType.OPEN,()=>{f||It(ms,`RPC '${e}' stream ${r} transport opened.`)}),g(h,Lb.EventType.CLOSE,()=>{f||(f=!0,It(ms,`RPC '${e}' stream ${r} transport closed`),m.wo())}),g(h,Lb.EventType.ERROR,v=>{f||(f=!0,mp(ms,`RPC '${e}' stream ${r} transport errored:`,v),m.wo(new Rt(Qe.UNAVAILABLE,"The operation could not be completed")))}),g(h,Lb.EventType.MESSAGE,v=>{var p;if(!f){const b=v.data[0];En(!!b);const _=b,P=_.error||((p=_[0])===null||p===void 0?void 0:p.error);if(P){It(ms,`RPC '${e}' stream ${r} received error:`,P);const E=P.status;let T=function(M){const x=lr[M];if(x!==void 0)return k$(x)}(E),C=P.message;T===void 0&&(T=Qe.INTERNAL,C="Unknown error status: "+E+" with message "+P.message),f=!0,m.wo(new Rt(T,C)),h.close()}else It(ms,`RPC '${e}' stream ${r} received:`,b),m._o(b)}}),g(a,Cde.STAT_EVENT,v=>{v.stat===VR.PROXY?It(ms,`RPC '${e}' stream ${r} detected buffering proxy`):v.stat===VR.NOPROXY&&It(ms,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{m.fo()},0),m}}function QT(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(t){return new Dfe(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F${constructor(e,i,n=1e3,r=1.5,s=6e4){this.ii=e,this.timerId=i,this.Po=n,this.bo=r,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const i=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),r=Math.max(0,i-n);r>0&&It("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.So} ms, delay with jitter: ${i} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z${constructor(e,i,n,r,s,o,a,l){this.ii=e,this.$o=n,this.Oo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new F$(e,i)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,i){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():i&&i.code===Qe.RESOURCE_EXHAUSTED?(dh(i.toString()),dh("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):i&&i.code===Qe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(i)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),i=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.Fo===i&&this.Zo(n,r)},n=>{e(()=>{const r=new Rt(Qe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.tu(r)})})}Zo(e,i){const n=this.Xo(this.Fo);this.stream=this.eu(e,i),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(r=>{n(()=>this.tu(r))}),this.stream.onMessage(r=>{n(()=>this.onMessage(r))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return It("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return i=>{this.ii.enqueueAndForget(()=>this.Fo===e?i():(It("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class wme extends z${constructor(e,i,n,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,n,r,o),this.serializer=s}eu(e,i){return this.connection.Ro("Listen",e,i)}onMessage(e){this.qo.reset();const i=Ffe(this.serializer,e),n=function(r){if(!("targetChange"in r))return bi.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?bi.min():s.readTime?hc(s.readTime):bi.min()}(e);return this.listener.nu(i,n)}su(e){const i={};i.database=qC(this.serializer),i.addTarget=function(r,s){let o;const a=s.target;if(o=BC(a)?{documents:Bfe(r,a)}:{query:jfe(r,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=A$(r,s.resumeToken);const l=WC(r,s.expectedCount);l!==null&&(o.expectedCount=l)}else if(s.snapshotVersion.compareTo(bi.min())>0){o.readTime=A_(r,s.snapshotVersion.toTimestamp());const l=WC(r,s.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=Wfe(this.serializer,e);n&&(i.labels=n),this.Wo(i)}iu(e){const i={};i.database=qC(this.serializer),i.removeTarget=e,this.Wo(i)}}class Tme extends z${constructor(e,i,n,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,n,r,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,i){return this.connection.Ro("Write",e,i)}onMessage(e){if(En(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const i=Ufe(e.writeResults,e.commitTime),n=hc(e.commitTime);return this.listener.cu(n,i)}return En(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){const e={};e.database=qC(this.serializer),this.Wo(e)}uu(e){const i={streamToken:this.lastStreamToken,writes:e.map(n=>zfe(this.serializer,n))};this.Wo(i)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xme extends class{}{constructor(e,i,n,r){super(),this.authCredentials=e,this.appCheckCredentials=i,this.connection=n,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new Rt(Qe.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,i,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.Io(e,i,n,r,s)).catch(r=>{throw r.name==="FirebaseError"?(r.code===Qe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Rt(Qe.UNKNOWN,r.toString())})}vo(e,i,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(e,i,n,s,o,r)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Qe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Rt(Qe.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class kme{constructor(e,i){this.asyncQueue=e,this.onlineStateHandler=i,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const i=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(dh(i),this.mu=!1):It("OnlineStateTracker",i)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cme{constructor(e,i,n,r,s){this.localStore=e,this.datastore=i,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(o=>{n.enqueueAndForget(async()=>{gf(this)&&(It("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=pi(a);l.vu.add(4),await hS(l),l.bu.set("Unknown"),l.vu.delete(4),await OE(l)}(this))})}),this.bu=new kme(n,r)}}async function OE(t){if(gf(t))for(const e of t.Ru)await e(!0)}async function hS(t){for(const e of t.Ru)await e(!1)}function U$(t,e){const i=pi(t);i.Au.has(e.targetId)||(i.Au.set(e.targetId,e),YA(i)?XA(i):Qp(i).Ko()&&KA(i,e))}function B$(t,e){const i=pi(t),n=Qp(i);i.Au.delete(e),n.Ko()&&j$(i,e),i.Au.size===0&&(n.Ko()?n.jo():gf(i)&&i.bu.set("Unknown"))}function KA(t,e){if(t.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(bi.min())>0){const i=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(i)}Qp(t).su(e)}function j$(t,e){t.Vu.qt(e),Qp(t).iu(e)}function XA(t){t.Vu=new Vfe({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),le:e=>t.Au.get(e)||null,ue:()=>t.datastore.serializer.databaseId}),Qp(t).start(),t.bu.gu()}function YA(t){return gf(t)&&!Qp(t).Uo()&&t.Au.size>0}function gf(t){return pi(t).vu.size===0}function $$(t){t.Vu=void 0}async function Mme(t){t.Au.forEach((e,i)=>{KA(t,e)})}async function Ame(t,e){$$(t),YA(t)?(t.bu.Iu(e),XA(t)):t.bu.set("Unknown")}async function Vme(t,e,i){if(t.bu.set("Online"),e instanceof M$&&e.state===2&&e.cause)try{await async function(n,r){const s=r.cause;for(const o of r.targetIds)n.Au.has(o)&&(await n.remoteSyncer.rejectListen(o,s),n.Au.delete(o),n.Vu.removeTarget(o))}(t,e)}catch(n){It("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await V_(t,n)}else if(e instanceof k0?t.Vu.Ht(e):e instanceof C$?t.Vu.ne(e):t.Vu.Xt(e),!i.isEqual(bi.min()))try{const n=await R$(t.localStore);i.compareTo(n)>=0&&await function(r,s){const o=r.Vu.ce(s);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const c=r.Au.get(l);c&&r.Au.set(l,c.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach((a,l)=>{const c=r.Au.get(a);if(!c)return;r.Au.set(a,c.withResumeToken(As.EMPTY_BYTE_STRING,c.snapshotVersion)),j$(r,a);const u=new mu(c.target,a,l,c.sequenceNumber);KA(r,u)}),r.remoteSyncer.applyRemoteEvent(o)}(t,i)}catch(n){It("RemoteStore","Failed to raise snapshot:",n),await V_(t,n)}}async function V_(t,e,i){if(!aS(e))throw e;t.vu.add(1),await hS(t),t.bu.set("Offline"),i||(i=()=>R$(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{It("RemoteStore","Retrying IndexedDB access"),await i(),t.vu.delete(1),await OE(t)})}function W$(t,e){return e().catch(i=>V_(t,i,e))}async function DE(t){const e=pi(t),i=Vu(e);let n=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;Lme(e);)try{const r=await gme(e.localStore,n);if(r===null){e.Eu.length===0&&i.jo();break}n=r.batchId,Ime(e,r)}catch(r){await V_(e,r)}G$(e)&&H$(e)}function Lme(t){return gf(t)&&t.Eu.length<10}function Ime(t,e){t.Eu.push(e);const i=Vu(t);i.Ko()&&i.ou&&i.uu(e.mutations)}function G$(t){return gf(t)&&!Vu(t).Uo()&&t.Eu.length>0}function H$(t){Vu(t).start()}async function Ome(t){Vu(t).hu()}async function Dme(t){const e=Vu(t);for(const i of t.Eu)e.uu(i.mutations)}async function Nme(t,e,i){const n=t.Eu.shift(),r=BA.from(n,e,i);await W$(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await DE(t)}async function Rme(t,e){e&&Vu(t).ou&&await async function(i,n){if(r=n.code,Cfe(r)&&r!==Qe.ABORTED){const s=i.Eu.shift();Vu(i).Qo(),await W$(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,n)),await DE(i)}var r}(t,e),G$(t)&&H$(t)}async function i2(t,e){const i=pi(t);i.asyncQueue.verifyOperationInProgress(),It("RemoteStore","RemoteStore received new credentials");const n=gf(i);i.vu.add(3),await hS(i),n&&i.bu.set("Unknown"),await i.remoteSyncer.handleCredentialChange(e),i.vu.delete(3),await OE(i)}async function Fme(t,e){const i=pi(t);e?(i.vu.delete(2),await OE(i)):e||(i.vu.add(2),await hS(i),i.bu.set("Unknown"))}function Qp(t){return t.Su||(t.Su=function(e,i,n){const r=pi(e);return r.fu(),new wme(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{uo:Mme.bind(null,t),ao:Ame.bind(null,t),nu:Vme.bind(null,t)}),t.Ru.push(async e=>{e?(t.Su.Qo(),YA(t)?XA(t):t.bu.set("Unknown")):(await t.Su.stop(),$$(t))})),t.Su}function Vu(t){return t.Du||(t.Du=function(e,i,n){const r=pi(e);return r.fu(),new Tme(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{uo:Ome.bind(null,t),ao:Rme.bind(null,t),au:Dme.bind(null,t),cu:Nme.bind(null,t)}),t.Ru.push(async e=>{e?(t.Du.Qo(),await DE(t)):(await t.Du.stop(),t.Eu.length>0&&(It("RemoteStore",`Stopping write stream with ${t.Eu.length} pending writes`),t.Eu=[]))})),t.Du}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e,i,n,r,s){this.asyncQueue=e,this.timerId=i,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new rh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,i,n,r,s){const o=Date.now()+n,a=new ZA(e,i,o,r,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Rt(Qe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function JA(t,e){if(dh("AsyncQueue",`${e}: ${t}`),aS(t))return new Rt(Qe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(e){this.comparator=e?(i,n)=>e(i,n)||ei.comparator(i.key,n.key):(i,n)=>ei.comparator(i.key,n.key),this.keyedMap=Fg(),this.sortedSet=new Sr(this.comparator)}static emptySet(e){return new zm(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const i=this.keyedMap.get(e);return i?this.sortedSet.indexOf(i):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((i,n)=>(e(i),!1))}add(e){const i=this.delete(e.key);return i.copy(i.keyedMap.insert(e.key,e),i.sortedSet.insert(e,null))}delete(e){const i=this.get(e);return i?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(i)):this}isEqual(e){if(!(e instanceof zm)||this.size!==e.size)return!1;const i=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;i.hasNext();){const r=i.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(i=>{e.push(i.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,i){const n=new zm;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=i,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(){this.Cu=new Sr(ei.comparator)}track(e){const i=e.doc.key,n=this.Cu.get(i);n?e.type!==0&&n.type===3?this.Cu=this.Cu.insert(i,e):e.type===3&&n.type!==1?this.Cu=this.Cu.insert(i,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Cu=this.Cu.insert(i,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Cu=this.Cu.insert(i,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Cu=this.Cu.remove(i):e.type===1&&n.type===2?this.Cu=this.Cu.insert(i,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Cu=this.Cu.insert(i,{type:2,doc:e.doc}):ni():this.Cu=this.Cu.insert(i,e)}xu(){const e=[];return this.Cu.inorderTraversal((i,n)=>{e.push(n)}),e}}class Sp{constructor(e,i,n,r,s,o,a,l,c){this.query=e,this.docs=i,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,i,n,r,s){const o=[];return i.forEach(a=>{o.push({type:0,doc:a})}),new Sp(e,i,zm.emptySet(i),o,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&CE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const i=this.docChanges,n=e.docChanges;if(i.length!==n.length)return!1;for(let r=0;r<i.length;r++)if(i[r].type!==n[r].type||!i[r].doc.isEqual(n[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zme{constructor(){this.Nu=void 0,this.listeners=[]}}class Ume{constructor(){this.queries=new Jp(e=>m$(e),CE),this.onlineState="Unknown",this.ku=new Set}}async function QA(t,e){const i=pi(t),n=e.query;let r=!1,s=i.queries.get(n);if(s||(r=!0,s=new zme),r)try{s.Nu=await i.onListen(n)}catch(o){const a=JA(o,`Initialization of query '${$C(e.query)}' failed`);return void e.onError(a)}i.queries.set(n,s),s.listeners.push(e),e.Mu(i.onlineState),s.Nu&&e.$u(s.Nu)&&tV(i)}async function eV(t,e){const i=pi(t),n=e.query;let r=!1;const s=i.queries.get(n);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),r=s.listeners.length===0)}if(r)return i.queries.delete(n),i.onUnlisten(n)}function Bme(t,e){const i=pi(t);let n=!1;for(const r of e){const s=r.query,o=i.queries.get(s);if(o){for(const a of o.listeners)a.$u(r)&&(n=!0);o.Nu=r}}n&&tV(i)}function jme(t,e,i){const n=pi(t),r=n.queries.get(e);if(r)for(const s of r.listeners)s.onError(i);n.queries.delete(e)}function tV(t){t.ku.forEach(e=>{e.next()})}class iV{constructor(e,i,n){this.query=e,this.Ou=i,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)r.type!==3&&n.push(r);e=new Sp(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let i=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),i=!0):this.qu(e,this.onlineState)&&(this.Uu(e),i=!0),this.Bu=e,i}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let i=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),i=!0),i}qu(e,i){if(!e.fromCache)return!0;const n=i!=="Offline";return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||i==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;const i=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!i)&&this.options.includeMetadataChanges===!0}Uu(e){e=Sp.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q${constructor(e){this.key=e}}class K${constructor(e){this.key=e}}class $me{constructor(e,i){this.query=e,this.Yu=i,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Li(),this.mutatedKeys=Li(),this.tc=p$(e),this.ec=new zm(this.tc)}get nc(){return this.Yu}sc(e,i){const n=i?i.ic:new n2,r=i?i.ec:this.ec;let s=i?i.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{const d=r.get(u),f=ME(this.query,h)?h:null,m=!!d&&this.mutatedKeys.has(d.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let v=!1;d&&f?d.data.isEqual(f.data)?m!==g&&(n.track({type:3,doc:f}),v=!0):this.rc(d,f)||(n.track({type:2,doc:f}),v=!0,(l&&this.tc(f,l)>0||c&&this.tc(f,c)<0)&&(a=!0)):!d&&f?(n.track({type:0,doc:f}),v=!0):d&&!f&&(n.track({type:1,doc:d}),v=!0,(l||c)&&(a=!0)),v&&(f?(o=o.add(f),s=g?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{ec:o,ic:n,zi:a,mutatedKeys:s}}rc(e,i){return e.hasLocalMutations&&i.hasCommittedMutations&&!i.hasLocalMutations}applyChanges(e,i,n){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((c,u)=>function(h,d){const f=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ni()}};return f(h)-f(d)}(c.type,u.type)||this.tc(c.doc,u.doc)),this.oc(n);const o=i?this.uc():[],a=this.Zu.size===0&&this.current?1:0,l=a!==this.Xu;return this.Xu=a,s.length!==0||l?{snapshot:new Sp(this.query,e.ec,r,s,e.mutatedKeys,a===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new n2,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(i=>this.Yu=this.Yu.add(i)),e.modifiedDocuments.forEach(i=>{}),e.removedDocuments.forEach(i=>this.Yu=this.Yu.delete(i)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Li(),this.ec.forEach(n=>{this.ac(n.key)&&(this.Zu=this.Zu.add(n.key))});const i=[];return e.forEach(n=>{this.Zu.has(n)||i.push(new K$(n))}),this.Zu.forEach(n=>{e.has(n)||i.push(new q$(n))}),i}hc(e){this.Yu=e.ir,this.Zu=Li();const i=this.sc(e.documents);return this.applyChanges(i,!0)}lc(){return Sp.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}}class Wme{constructor(e,i,n){this.query=e,this.targetId=i,this.view=n}}class Gme{constructor(e){this.key=e,this.fc=!1}}class Hme{constructor(e,i,n,r,s,o){this.localStore=e,this.remoteStore=i,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new Jp(a=>m$(a),CE),this._c=new Map,this.mc=new Set,this.gc=new Sr(ei.comparator),this.yc=new Map,this.Ic=new GA,this.Tc={},this.Ec=new Map,this.Ac=yp.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}}async function qme(t,e){const i=npe(t);let n,r;const s=i.wc.get(e);if(s)n=s.targetId,i.sharedClientState.addLocalQueryTarget(n),r=s.view.lc();else{const o=await vme(i.localStore,fh(e)),a=i.sharedClientState.addLocalQueryTarget(o.targetId);n=o.targetId,r=await Kme(i,e,n,a==="current",o.resumeToken),i.isPrimaryClient&&U$(i.remoteStore,o)}return r}async function Kme(t,e,i,n,r){t.Rc=(h,d,f)=>async function(m,g,v,p){let b=g.view.sc(v);b.zi&&(b=await QR(m.localStore,g.query,!1).then(({documents:E})=>g.view.sc(E,b)));const _=p&&p.targetChanges.get(g.targetId),P=g.view.applyChanges(b,m.isPrimaryClient,_);return s2(m,g.targetId,P.cc),P.snapshot}(t,h,d,f);const s=await QR(t.localStore,e,!0),o=new $me(e,s.ir),a=o.sc(s.documents),l=cS.createSynthesizedTargetChangeForCurrentChange(i,n&&t.onlineState!=="Offline",r),c=o.applyChanges(a,t.isPrimaryClient,l);s2(t,i,c.cc);const u=new Wme(e,i,o);return t.wc.set(e,u),t._c.has(i)?t._c.get(i).push(e):t._c.set(i,[e]),c.snapshot}async function Xme(t,e){const i=pi(t),n=i.wc.get(e),r=i._c.get(n.targetId);if(r.length>1)return i._c.set(n.targetId,r.filter(s=>!CE(s,e))),void i.wc.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(n.targetId),i.sharedClientState.isActiveQueryTarget(n.targetId)||await KC(i.localStore,n.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(n.targetId),B$(i.remoteStore,n.targetId),XC(i,n.targetId)}).catch(oS)):(XC(i,n.targetId),await KC(i.localStore,n.targetId,!0))}async function Yme(t,e,i){const n=rpe(t);try{const r=await function(s,o){const a=pi(s),l=Qs.now(),c=o.reduce((d,f)=>d.add(f.key),Li());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=mh(),m=Li();return a.Zi.getEntries(d,c).next(g=>{f=g,f.forEach((v,p)=>{p.isValidDocument()||(m=m.add(v))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(g=>{u=g;const v=[];for(const p of o){const b=Efe(p,u.get(p.key).overlayedDocument);b!=null&&v.push(new Bu(p.key,b,a$(b.value.mapValue),Va.exists(!0)))}return a.mutationQueue.addMutationBatch(d,l,v,o)}).next(g=>{h=g;const v=g.applyToLocalDocumentSet(u,m);return a.documentOverlayCache.saveOverlays(d,g.batchId,v)})}).then(()=>({batchId:h.batchId,changes:v$(u)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(s,o,a){let l=s.Tc[s.currentUser.toKey()];l||(l=new Sr(Yi)),l=l.insert(o,a),s.Tc[s.currentUser.toKey()]=l}(n,r.batchId,i),await uS(n,r.changes),await DE(n.remoteStore)}catch(r){const s=JA(r,"Failed to persist write");i.reject(s)}}async function X$(t,e){const i=pi(t);try{const n=await mme(i.localStore,e);e.targetChanges.forEach((r,s)=>{const o=i.yc.get(s);o&&(En(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.fc=!0:r.modifiedDocuments.size>0?En(o.fc):r.removedDocuments.size>0&&(En(o.fc),o.fc=!1))}),await uS(i,n,e)}catch(n){await oS(n)}}function r2(t,e,i){const n=pi(t);if(n.isPrimaryClient&&i===0||!n.isPrimaryClient&&i===1){const r=[];n.wc.forEach((s,o)=>{const a=o.view.Mu(e);a.snapshot&&r.push(a.snapshot)}),function(s,o){const a=pi(s);a.onlineState=o;let l=!1;a.queries.forEach((c,u)=>{for(const h of u.listeners)h.Mu(o)&&(l=!0)}),l&&tV(a)}(n.eventManager,e),r.length&&n.dc.nu(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Zme(t,e,i){const n=pi(t);n.sharedClientState.updateQueryState(e,"rejected",i);const r=n.yc.get(e),s=r&&r.key;if(s){let o=new Sr(ei.comparator);o=o.insert(s,ys.newNoDocument(s,bi.min()));const a=Li().add(s),l=new LE(bi.min(),new Map,new Sr(Yi),o,a);await X$(n,l),n.gc=n.gc.remove(s),n.yc.delete(e),nV(n)}else await KC(n.localStore,e,!1).then(()=>XC(n,e,i)).catch(oS)}async function Jme(t,e){const i=pi(t),n=e.batch.batchId;try{const r=await fme(i.localStore,e);Z$(i,n,null),Y$(i,n),i.sharedClientState.updateMutationState(n,"acknowledged"),await uS(i,r)}catch(r){await oS(r)}}async function Qme(t,e,i){const n=pi(t);try{const r=await function(s,o){const a=pi(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return a.mutationQueue.lookupMutationBatch(l,o).next(u=>(En(u!==null),c=u.keys(),a.mutationQueue.removeMutationBatch(l,u))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,c,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>a.localDocuments.getDocuments(l,c))})}(n.localStore,e);Z$(n,e,i),Y$(n,e),n.sharedClientState.updateMutationState(e,"rejected",i),await uS(n,r)}catch(r){await oS(r)}}function Y$(t,e){(t.Ec.get(e)||[]).forEach(i=>{i.resolve()}),t.Ec.delete(e)}function Z$(t,e,i){const n=pi(t);let r=n.Tc[n.currentUser.toKey()];if(r){const s=r.get(e);s&&(i?s.reject(i):s.resolve(),r=r.remove(e)),n.Tc[n.currentUser.toKey()]=r}}function XC(t,e,i=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t._c.get(e))t.wc.delete(n),i&&t.dc.Pc(n,i);t._c.delete(e),t.isPrimaryClient&&t.Ic.Is(e).forEach(n=>{t.Ic.containsKey(n)||J$(t,n)})}function J$(t,e){t.mc.delete(e.path.canonicalString());const i=t.gc.get(e);i!==null&&(B$(t.remoteStore,i),t.gc=t.gc.remove(e),t.yc.delete(i),nV(t))}function s2(t,e,i){for(const n of i)n instanceof q$?(t.Ic.addReference(n.key,e),epe(t,n)):n instanceof K$?(It("SyncEngine","Document no longer in limbo: "+n.key),t.Ic.removeReference(n.key,e),t.Ic.containsKey(n.key)||J$(t,n.key)):ni()}function epe(t,e){const i=e.key,n=i.path.canonicalString();t.gc.get(i)||t.mc.has(n)||(It("SyncEngine","New document in limbo: "+i),t.mc.add(n),nV(t))}function nV(t){for(;t.mc.size>0&&t.gc.size<t.maxConcurrentLimboResolutions;){const e=t.mc.values().next().value;t.mc.delete(e);const i=new ei(fr.fromString(e)),n=t.Ac.next();t.yc.set(n,new Gme(i)),t.gc=t.gc.insert(i,n),U$(t.remoteStore,new mu(fh(kE(i.path)),n,"TargetPurposeLimboResolution",OA.ct))}}async function uS(t,e,i){const n=pi(t),r=[],s=[],o=[];n.wc.isEmpty()||(n.wc.forEach((a,l)=>{o.push(n.Rc(l,e,i).then(c=>{if((c||i)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(l.targetId,c!=null&&c.fromCache?"not-current":"current"),c){r.push(c);const u=qA.Li(l.targetId,c);s.push(u)}}))}),await Promise.all(o),n.dc.nu(r),await async function(a,l){const c=pi(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>ft.forEach(l,h=>ft.forEach(h.Fi,d=>c.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>ft.forEach(h.Bi,d=>c.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!aS(u))throw u;It("LocalStore","Failed to update sequence numbers: "+u)}for(const u of l){const h=u.targetId;if(!u.fromCache){const d=c.Ji.get(h),f=d.snapshotVersion,m=d.withLastLimboFreeSnapshotVersion(f);c.Ji=c.Ji.insert(h,m)}}}(n.localStore,s))}async function tpe(t,e){const i=pi(t);if(!i.currentUser.isEqual(e)){It("SyncEngine","User change. New user:",e.toKey());const n=await N$(i.localStore,e);i.currentUser=e,function(r,s){r.Ec.forEach(o=>{o.forEach(a=>{a.reject(new Rt(Qe.CANCELLED,s))})}),r.Ec.clear()}(i,"'waitForPendingWrites' promise is rejected due to a user change."),i.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await uS(i,n.er)}}function ipe(t,e){const i=pi(t),n=i.yc.get(e);if(n&&n.fc)return Li().add(n.key);{let r=Li();const s=i._c.get(e);if(!s)return r;for(const o of s){const a=i.wc.get(o);r=r.unionWith(a.view.nc)}return r}}function npe(t){const e=pi(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=X$.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ipe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Zme.bind(null,e),e.dc.nu=Bme.bind(null,e.eventManager),e.dc.Pc=jme.bind(null,e.eventManager),e}function rpe(t){const e=pi(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Jme.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Qme.bind(null,e),e}class o2{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=IE(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,i){return null}createIndexBackfillerScheduler(e,i){return null}createLocalStore(e){return dme(this.persistence,new hme,e.initialUser,this.serializer)}createPersistence(e){return new lme(HA.zs,this.serializer)}createSharedClientState(e){return new Sme}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class spe{async initialize(e,i){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>r2(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=tpe.bind(null,this.syncEngine),await Fme(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ume}createDatastore(e){const i=IE(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new Eme(r));var r;return function(s,o,a,l){return new xme(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,n,i)}createRemoteStore(e){return i=this.localStore,n=this.datastore,r=e.asyncQueue,s=a=>r2(this.syncEngine,a,0),o=t2.D()?new t2:new bme,new Cme(i,n,r,s,o);var i,n,r,s,o}createSyncEngine(e,i){return function(n,r,s,o,a,l,c){const u=new Hme(n,r,s,o,a,l);return c&&(u.vc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,i)}terminate(){return async function(e){const i=pi(e);It("RemoteStore","RemoteStore shutting down."),i.vu.add(5),await hS(i),i.Pu.shutdown(),i.bu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):dh("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,i){this.muted||setTimeout(()=>{this.muted||e(i)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ope{constructor(e,i,n,r){this.authCredentials=e,this.appCheckCredentials=i,this.asyncQueue=n,this.databaseInfo=r,this.user=vs.UNAUTHENTICATED,this.clientId=n$.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async s=>{It("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(It("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Rt(Qe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(i){const n=JA(i,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function ex(t,e){t.asyncQueue.verifyOperationInProgress(),It("FirestoreClient","Initializing OfflineComponentProvider");const i=await t.getConfiguration();await e.initialize(i);let n=i.initialUser;t.setCredentialChangeListener(async r=>{n.isEqual(r)||(await N$(e.localStore,r),n=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function a2(t,e){t.asyncQueue.verifyOperationInProgress();const i=await lpe(t);It("FirestoreClient","Initializing OnlineComponentProvider");const n=await t.getConfiguration();await e.initialize(i,n),t.setCredentialChangeListener(r=>i2(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>i2(e.remoteStore,s)),t._onlineComponents=e}function ape(t){return t.name==="FirebaseError"?t.code===Qe.FAILED_PRECONDITION||t.code===Qe.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function lpe(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){It("FirestoreClient","Using user provided OfflineComponentProvider");try{await ex(t,t._uninitializedComponentsProvider._offline)}catch(e){const i=e;if(!ape(i))throw i;mp("Error using user provided cache. Falling back to memory cache: "+i),await ex(t,new o2)}}else It("FirestoreClient","Using default OfflineComponentProvider"),await ex(t,new o2);return t._offlineComponents}async function Q$(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(It("FirestoreClient","Using user provided OnlineComponentProvider"),await a2(t,t._uninitializedComponentsProvider._online)):(It("FirestoreClient","Using default OnlineComponentProvider"),await a2(t,new spe))),t._onlineComponents}function cpe(t){return Q$(t).then(e=>e.syncEngine)}async function L_(t){const e=await Q$(t),i=e.eventManager;return i.onListen=qme.bind(null,e.syncEngine),i.onUnlisten=Xme.bind(null,e.syncEngine),i}function hpe(t,e,i={}){const n=new rh;return t.asyncQueue.enqueueAndForget(async()=>function(r,s,o,a,l){const c=new rV({next:h=>{s.enqueueAndForget(()=>eV(r,u));const d=h.docs.has(o);!d&&h.fromCache?l.reject(new Rt(Qe.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?l.reject(new Rt(Qe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(h)},error:h=>l.reject(h)}),u=new iV(kE(o.path),c,{includeMetadataChanges:!0,Ku:!0});return QA(r,u)}(await L_(t),t.asyncQueue,e,i,n)),n.promise}function upe(t,e,i={}){const n=new rh;return t.asyncQueue.enqueueAndForget(async()=>function(r,s,o,a,l){const c=new rV({next:h=>{s.enqueueAndForget(()=>eV(r,u)),h.fromCache&&a.source==="server"?l.reject(new Rt(Qe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(h)},error:h=>l.reject(h)}),u=new iV(o,c,{includeMetadataChanges:!0,Ku:!0});return QA(r,u)}(await L_(t),t.asyncQueue,e,i,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eW(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tW(t,e,i){if(!i)throw new Rt(Qe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dpe(t,e,i,n){if(e===!0&&n===!0)throw new Rt(Qe.INVALID_ARGUMENT,`${t} and ${i} cannot be used together.`)}function c2(t){if(!ei.isDocumentKey(t))throw new Rt(Qe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function h2(t){if(ei.isDocumentKey(t))throw new Rt(Qe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function sV(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ni()}function Eo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Rt(Qe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const i=sV(t);throw new Rt(Qe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${i}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(e){var i,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Rt(Qe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(i=e.ssl)===null||i===void 0||i;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Rt(Qe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dpe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=eW((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Rt(Qe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Rt(Qe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Rt(Qe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(i=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,i.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var i,n}}class NE{constructor(e,i,n,r){this._authCredentials=e,this._appCheckCredentials=i,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new u2({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Rt(Qe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new Rt(Qe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new u2(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Lde;switch(i.type){case"firstParty":return new Nde(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Rt(Qe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const i=l2.get(e);i&&(It("ComponentProvider","Removing Datastore"),l2.delete(e),i.terminate())}(this),Promise.resolve()}}function fpe(t,e,i,n={}){var r;const s=(t=Eo(t,NE))._getSettings(),o=`${e}:${i}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&mp("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let a,l;if(typeof n.mockUserToken=="string")a=n.mockUserToken,l=vs.MOCK_USER;else{a=WB(n.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Rt(Qe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new vs(c)}t._authCredentials=new Ide(new i$(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,i,n){this.converter=i,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new eo(this.firestore,e,this._key)}}class dS{constructor(e,i,n){this.converter=i,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new dS(this.firestore,e,this._query)}}class Pu extends dS{constructor(e,i,n){super(e,i,kE(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new eo(this.firestore,null,new ei(e))}withConverter(e){return new Pu(this.firestore,e,this._path)}}function I_(t,e,...i){if(t=Nn(t),tW("collection","path",e),t instanceof NE){const n=fr.fromString(e,...i);return h2(n),new Pu(t,null,n)}{if(!(t instanceof eo||t instanceof Pu))throw new Rt(Qe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(fr.fromString(e,...i));return h2(n),new Pu(t.firestore,null,n)}}function vl(t,e,...i){if(t=Nn(t),arguments.length===1&&(e=n$.A()),tW("doc","path",e),t instanceof NE){const n=fr.fromString(e,...i);return c2(n),new eo(t,null,new ei(n))}{if(!(t instanceof eo||t instanceof Pu))throw new Rt(Qe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(fr.fromString(e,...i));return c2(n),new eo(t.firestore,t instanceof Pu?t.converter:null,new ei(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mpe{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new F$(this,"async_queue_retry"),this.Xc=()=>{const i=QT();i&&It("AsyncQueue","Visibility state changed to "+i.visibilityState),this.qo.Mo()};const e=QT();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const i=QT();i&&typeof i.removeEventListener=="function"&&i.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const i=new rh;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(i.resolve,i.reject),i.promise)).then(()=>i.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!aS(e))throw e;It("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const i=this.Gc.then(()=>(this.Hc=!0,e().catch(n=>{this.Wc=n,this.Hc=!1;const r=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),o}(n);throw dh("INTERNAL UNHANDLED ERROR: ",r),n}).then(n=>(this.Hc=!1,n))));return this.Gc=i,i}enqueueAfterDelay(e,i,n){this.Zc(),this.Yc.indexOf(e)>-1&&(i=0);const r=ZA.createAndSchedule(this,e,i,n,s=>this.na(s));return this.zc.push(r),r}Zc(){this.Wc&&ni()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(const i of this.zc)if(i.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((i,n)=>i.targetTimeMs-n.targetTimeMs);for(const i of this.zc)if(i.skipDelay(),e!=="all"&&i.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const i=this.zc.indexOf(e);this.zc.splice(i,1)}}function d2(t){return function(e,i){if(typeof e!="object"||e===null)return!1;const n=e;for(const r of i)if(r in n&&typeof n[r]=="function")return!0;return!1}(t,["next","error","complete"])}class ph extends NE{constructor(e,i,n,r){super(e,i,n,r),this.type="firestore",this._queue=new mpe,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||iW(this),this._firestoreClient.terminate()}}function fS(t,e){const i=typeof t=="object"?t:SM(),n=typeof t=="string"?t:e||"(default)",r=bP(i,"firestore").getImmediate({identifier:n});if(!r._initialized){const s=BB("firestore");s&&fpe(r,...s)}return r}function RE(t){return t._firestoreClient||iW(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function iW(t){var e,i,n;const r=t._freezeSettings(),s=function(o,a,l,c){return new Kde(o,a,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,eW(c.experimentalLongPollingOptions),c.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new ope(t._authCredentials,t._appCheckCredentials,t._queue,s),!((i=r.cache)===null||i===void 0)&&i._offlineComponentProvider&&(!((n=r.cache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e){this._byteString=e}static fromBase64String(e){try{return new bp(As.fromBase64String(e))}catch(i){throw new Rt(Qe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+i)}}static fromUint8Array(e){return new bp(As.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(...e){for(let i=0;i<e.length;++i)if(e[i].length===0)throw new Rt(Qe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mc(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aV{constructor(e,i){if(!isFinite(e)||e<-90||e>90)throw new Rt(Qe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(i)||i<-180||i>180)throw new Rt(Qe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+i);this._lat=e,this._long=i}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Yi(this._lat,e._lat)||Yi(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ppe=/^__.*__$/;class gpe{constructor(e,i,n){this.data=e,this.fieldMask=i,this.fieldTransforms=n}toMutation(e,i){return this.fieldMask!==null?new Bu(e,this.data,this.fieldMask,i,this.fieldTransforms):new lS(e,this.data,i,this.fieldTransforms)}}class nW{constructor(e,i,n){this.data=e,this.fieldMask=i,this.fieldTransforms=n}toMutation(e,i){return new Bu(e,this.data,this.fieldMask,i,this.fieldTransforms)}}function rW(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ni()}}class lV{constructor(e,i,n,r,s,o){this.settings=e,this.databaseId=i,this.serializer=n,this.ignoreUndefinedProperties=r,s===void 0&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new lV(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var i;const n=(i=this.path)===null||i===void 0?void 0:i.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}da(e){var i;const n=(i=this.path)===null||i===void 0?void 0:i.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return O_(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(i=>e.isPrefixOf(i))!==void 0||this.fieldTransforms.find(i=>e.isPrefixOf(i.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(rW(this.ca)&&ppe.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class vpe{constructor(e,i,n){this.databaseId=e,this.ignoreUndefinedProperties=i,this.serializer=n||IE(e)}ya(e,i,n,r=!1){return new lV({ca:e,methodName:i,ga:n,path:mc.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cV(t){const e=t._freezeSettings(),i=IE(t._databaseId);return new vpe(t._databaseId,!!e.ignoreUndefinedProperties,i)}function sW(t,e,i,n,r,s={}){const o=t.ya(s.merge||s.mergeFields?2:0,e,i,r);hV("Data must be an object, but it was:",o,n);const a=oW(n,o);let l,c;if(s.merge)l=new Zo(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const d=YC(e,h,i);if(!o.contains(d))throw new Rt(Qe.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);lW(u,d)||u.push(d)}l=new Zo(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new gpe(new yo(a),l,c)}class zE extends oV{_toFieldTransform(e){if(e.ca!==2)throw e.ca===1?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof zE}}function ype(t,e,i,n){const r=t.ya(1,e,i);hV("Data must be an object, but it was:",r,n);const s=[],o=yo.empty();pf(n,(l,c)=>{const u=uV(e,l,i);c=Nn(c);const h=r.da(u);if(c instanceof zE)s.push(u);else{const d=UE(c,h);d!=null&&(s.push(u),o.set(u,d))}});const a=new Zo(s);return new nW(o,a,r.fieldTransforms)}function Spe(t,e,i,n,r,s){const o=t.ya(1,e,i),a=[YC(e,n,i)],l=[r];if(s.length%2!=0)throw new Rt(Qe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(YC(e,s[d])),l.push(s[d+1]);const c=[],u=yo.empty();for(let d=a.length-1;d>=0;--d)if(!lW(c,a[d])){const f=a[d];let m=l[d];m=Nn(m);const g=o.da(f);if(m instanceof zE)c.push(f);else{const v=UE(m,g);v!=null&&(c.push(f),u.set(f,v))}}const h=new Zo(c);return new nW(u,h,o.fieldTransforms)}function UE(t,e){if(aW(t=Nn(t)))return hV("Unsupported field value:",e,t),oW(t,e);if(t instanceof oV)return function(i,n){if(!rW(n.ca))throw n._a(`${i._methodName}() can only be used with update() and set()`);if(!n.path)throw n._a(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(n);r&&n.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(i,n){const r=[];let s=0;for(const o of i){let a=UE(o,n.wa(s));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),s++}return{arrayValue:{values:r}}}(t,e)}return function(i,n){if((i=Nn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return vfe(n.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=Qs.fromDate(i);return{timestampValue:A_(n.serializer,r)}}if(i instanceof Qs){const r=new Qs(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:A_(n.serializer,r)}}if(i instanceof aV)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof bp)return{bytesValue:A$(n.serializer,i._byteString)};if(i instanceof eo){const r=n.databaseId,s=i.firestore._databaseId;if(!s.isEqual(r))throw n._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:WA(i.firestore._databaseId||n.databaseId,i._key.path)}}throw n._a(`Unsupported field value: ${sV(i)}`)}(t,e)}function oW(t,e){const i={};return s$(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pf(t,(n,r)=>{const s=UE(r,e.ha(n));s!=null&&(i[n]=s)}),{mapValue:{fields:i}}}function aW(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Qs||t instanceof aV||t instanceof bp||t instanceof eo||t instanceof oV)}function hV(t,e,i){if(!aW(i)||!function(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}(i)){const n=sV(i);throw n==="an object"?e._a(t+" a custom object"):e._a(t+" "+n)}}function YC(t,e,i){if((e=Nn(e))instanceof FE)return e._internalPath;if(typeof e=="string")return uV(t,e);throw O_("Field path arguments must be of type string or ",t,!1,void 0,i)}const bpe=new RegExp("[~\\*/\\[\\]]");function uV(t,e,i){if(e.search(bpe)>=0)throw O_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,i);try{return new FE(...e.split("."))._internalPath}catch{throw O_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,i)}}function O_(t,e,i,n,r){const s=n&&!n.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;i&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${n}`),o&&(l+=` in document ${r}`),l+=")"),new Rt(Qe.INVALID_ARGUMENT,a+t+l)}function lW(t,e){return t.some(i=>i.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cW{constructor(e,i,n,r,s){this._firestore=e,this._userDataWriter=i,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new eo(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _pe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const i=this._document.data.field(hW("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i)}}}class _pe extends cW{data(){return super.data()}}function hW(t,e){return typeof e=="string"?uV(t,e):e instanceof FE?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uW(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Rt(Qe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ppe{convertValue(e,i="none"){switch(Kd(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ur(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,i);case 5:return e.stringValue;case 6:return this.convertBytes(qd(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,i);case 10:return this.convertObject(e.mapValue,i);default:throw ni()}}convertObject(e,i){return this.convertObjectMap(e.fields,i)}convertObjectMap(e,i="none"){const n={};return pf(e,(r,s)=>{n[r]=this.convertValue(s,i)}),n}convertGeoPoint(e){return new aV(ur(e.latitude),ur(e.longitude))}convertArray(e,i){return(e.values||[]).map(n=>this.convertValue(n,i))}convertServerTimestamp(e,i){switch(i){case"previous":const n=NA(e);return n==null?null:this.convertValue(n,i);case"estimate":return this.convertTimestamp(fy(e));default:return null}}convertTimestamp(e){const i=Au(e);return new Qs(i.seconds,i.nanos)}convertDocumentKey(e,i){const n=fr.fromString(e);En(D$(n));const r=new my(n.get(1),n.get(3)),s=new ei(n.popFirst(5));return r.isEqual(i)||dh(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${i.projectId}/${i.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dW(t,e,i){let n;return n=t?i&&(i.merge||i.mergeFields)?t.toFirestore(e,i):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e,i){this.hasPendingWrites=e,this.fromCache=i}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fW extends cW{constructor(e,i,n,r,s,o){super(e,i,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const i=new C0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(i,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,i={}){if(this._document){const n=this._document.data.field(hW("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,i.serverTimestamps)}}}class C0 extends fW{data(e={}){return super.data(e)}}class mW{constructor(e,i,n,r){this._firestore=e,this._userDataWriter=i,this._snapshot=r,this.metadata=new Ug(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(i=>e.push(i)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,i){this._snapshot.docs.forEach(n=>{e.call(i,new C0(this._firestore,this._userDataWriter,n.key,n,new Ug(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const i=!!e.includeMetadataChanges;if(i&&this._snapshot.excludesMetadataChanges)throw new Rt(Qe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===i||(this._cachedChanges=function(n,r){if(n._snapshot.oldDocs.isEmpty()){let s=0;return n._snapshot.docChanges.map(o=>{const a=new C0(n._firestore,n._userDataWriter,o.doc.key,o.doc,new Ug(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:s++}})}{let s=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new C0(n._firestore,n._userDataWriter,o.doc.key,o.doc,new Ug(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let l=-1,c=-1;return o.type!==0&&(l=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),c=s.indexOf(o.doc.key)),{type:Epe(o.type),doc:a,oldIndex:l,newIndex:c}})}}(this,i),this._cachedChangesIncludeMetadataChanges=i),this._cachedChanges}}function Epe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ni()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(t){t=Eo(t,eo);const e=Eo(t.firestore,ph);return hpe(RE(e),t._key).then(i=>pW(e,t,i))}class dV extends Ppe{constructor(e){super(),this.firestore=e}convertBytes(e){return new bp(e)}convertReference(e){const i=this.convertDocumentKey(e,this.firestore._databaseId);return new eo(this.firestore,null,i)}}function wpe(t){t=Eo(t,dS);const e=Eo(t.firestore,ph),i=RE(e),n=new dV(e);return uW(t._query),upe(i,t._query).then(r=>new mW(e,n,t,r))}function Tpe(t,e,i){t=Eo(t,eo);const n=Eo(t.firestore,ph),r=dW(t.converter,e,i);return BE(n,[sW(cV(n),"setDoc",t._key,r,t.converter!==null,i).toMutation(t._key,Va.none())])}function tx(t,e,i,...n){t=Eo(t,eo);const r=Eo(t.firestore,ph),s=cV(r);let o;return o=typeof(e=Nn(e))=="string"||e instanceof FE?Spe(s,"updateDoc",t._key,e,i,n):ype(s,"updateDoc",t._key,e),BE(r,[o.toMutation(t._key,Va.exists(!0))])}function f2(t){return BE(Eo(t.firestore,ph),[new UA(t._key,Va.none())])}function m2(t,e){const i=Eo(t.firestore,ph),n=vl(t),r=dW(t.converter,e);return BE(i,[sW(cV(t.firestore),"addDoc",n._key,r,t.converter!==null,{}).toMutation(n._key,Va.exists(!1))]).then(()=>n)}function xpe(t,...e){var i,n,r;t=Nn(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||d2(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(d2(e[o])){const h=e[o];e[o]=(i=h.next)===null||i===void 0?void 0:i.bind(h),e[o+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[o+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let l,c,u;if(t instanceof eo)c=Eo(t.firestore,ph),u=kE(t._key.path),l={next:h=>{e[o]&&e[o](pW(c,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Eo(t,dS);c=Eo(h.firestore,ph),u=h._query;const d=new dV(c);l={next:f=>{e[o]&&e[o](new mW(c,d,h,f))},error:e[o+1],complete:e[o+2]},uW(t._query)}return function(h,d,f,m){const g=new rV(m),v=new iV(d,g,f);return h.asyncQueue.enqueueAndForget(async()=>QA(await L_(h),v)),()=>{g.Dc(),h.asyncQueue.enqueueAndForget(async()=>eV(await L_(h),v))}}(RE(c),u,a,l)}function BE(t,e){return function(i,n){const r=new rh;return i.asyncQueue.enqueueAndForget(async()=>Yme(await cpe(i),n,r)),r.promise}(RE(t),e)}function pW(t,e,i){const n=i.docs.get(e._key),r=new dV(t);return new fW(t,r,e._key,n,new Ug(i.hasPendingWrites,i.fromCache),e.converter)}(function(t,e=!0){(function(i){Zp=i})(lf),zd(new ku("firestore",(i,{instanceIdentifier:n,options:r})=>{const s=i.getProvider("app").getImmediate(),o=new ph(new Ode(i.getProvider("auth-internal")),new Fde(i.getProvider("app-check-internal")),function(a,l){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Rt(Qe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new my(a.options.projectId,l)}(s,n),s);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),tc(LR,"3.13.0",t),tc(LR,"3.13.0","esm2017")})();var fV={exports:{}},gW=function(e,i){return function(){for(var r=new Array(arguments.length),s=0;s<r.length;s++)r[s]=arguments[s];return e.apply(i,r)}},kpe=gW,mV=Object.prototype.toString,pV=function(t){return function(e){var i=mV.call(e);return t[i]||(t[i]=i.slice(8,-1).toLowerCase())}}(Object.create(null));function vf(t){return t=t.toLowerCase(),function(i){return pV(i)===t}}function gV(t){return Array.isArray(t)}function D_(t){return typeof t>"u"}function Cpe(t){return t!==null&&!D_(t)&&t.constructor!==null&&!D_(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}var vW=vf("ArrayBuffer");function Mpe(t){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&vW(t.buffer),e}function Ape(t){return typeof t=="string"}function Vpe(t){return typeof t=="number"}function yW(t){return t!==null&&typeof t=="object"}function M0(t){if(pV(t)!=="object")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}var Lpe=vf("Date"),Ipe=vf("File"),Ope=vf("Blob"),Dpe=vf("FileList");function vV(t){return mV.call(t)==="[object Function]"}function Npe(t){return yW(t)&&vV(t.pipe)}function Rpe(t){var e="[object FormData]";return t&&(typeof FormData=="function"&&t instanceof FormData||mV.call(t)===e||vV(t.toString)&&t.toString()===e)}var Fpe=vf("URLSearchParams");function zpe(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Upe(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function yV(t,e){if(!(t===null||typeof t>"u"))if(typeof t!="object"&&(t=[t]),gV(t))for(var i=0,n=t.length;i<n;i++)e.call(null,t[i],i,t);else for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.call(null,t[r],r,t)}function ZC(){var t={};function e(r,s){M0(t[s])&&M0(r)?t[s]=ZC(t[s],r):M0(r)?t[s]=ZC({},r):gV(r)?t[s]=r.slice():t[s]=r}for(var i=0,n=arguments.length;i<n;i++)yV(arguments[i],e);return t}function Bpe(t,e,i){return yV(e,function(r,s){i&&typeof r=="function"?t[s]=kpe(r,i):t[s]=r}),t}function jpe(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}function $pe(t,e,i,n){t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,i&&Object.assign(t.prototype,i)}function Wpe(t,e,i){var n,r,s,o={};e=e||{};do{for(n=Object.getOwnPropertyNames(t),r=n.length;r-- >0;)s=n[r],o[s]||(e[s]=t[s],o[s]=!0);t=Object.getPrototypeOf(t)}while(t&&(!i||i(t,e))&&t!==Object.prototype);return e}function Gpe(t,e,i){t=String(t),(i===void 0||i>t.length)&&(i=t.length),i-=e.length;var n=t.indexOf(e,i);return n!==-1&&n===i}function Hpe(t){if(!t)return null;var e=t.length;if(D_(e))return null;for(var i=new Array(e);e-- >0;)i[e]=t[e];return i}var qpe=function(t){return function(e){return t&&e instanceof t}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),us={isArray:gV,isArrayBuffer:vW,isBuffer:Cpe,isFormData:Rpe,isArrayBufferView:Mpe,isString:Ape,isNumber:Vpe,isObject:yW,isPlainObject:M0,isUndefined:D_,isDate:Lpe,isFile:Ipe,isBlob:Ope,isFunction:vV,isStream:Npe,isURLSearchParams:Fpe,isStandardBrowserEnv:Upe,forEach:yV,merge:ZC,extend:Bpe,trim:zpe,stripBOM:jpe,inherits:$pe,toFlatObject:Wpe,kindOf:pV,kindOfTest:vf,endsWith:Gpe,toArray:Hpe,isTypedArray:qpe,isFileList:Dpe},Kf=us;function p2(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var SW=function(e,i,n){if(!i)return e;var r;if(n)r=n(i);else if(Kf.isURLSearchParams(i))r=i.toString();else{var s=[];Kf.forEach(i,function(l,c){l===null||typeof l>"u"||(Kf.isArray(l)?c=c+"[]":l=[l],Kf.forEach(l,function(h){Kf.isDate(h)?h=h.toISOString():Kf.isObject(h)&&(h=JSON.stringify(h)),s.push(p2(c)+"="+p2(h))}))}),r=s.join("&")}if(r){var o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+r}return e},Kpe=us;function jE(){this.handlers=[]}jE.prototype.use=function(e,i,n){return this.handlers.push({fulfilled:e,rejected:i,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};jE.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};jE.prototype.forEach=function(e){Kpe.forEach(this.handlers,function(n){n!==null&&e(n)})};var Xpe=jE,Ype=us,Zpe=function(e,i){Ype.forEach(e,function(r,s){s!==i&&s.toUpperCase()===i.toUpperCase()&&(e[i]=r,delete e[s])})},bW=us;function _p(t,e,i,n,r){Error.call(this),this.message=t,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),n&&(this.request=n),r&&(this.response=r)}bW.inherits(_p,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var _W=_p.prototype,PW={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(t){PW[t]={value:t}});Object.defineProperties(_p,PW);Object.defineProperty(_W,"isAxiosError",{value:!0});_p.from=function(t,e,i,n,r,s){var o=Object.create(_W);return bW.toFlatObject(t,o,function(l){return l!==Error.prototype}),_p.call(o,t.message,e,i,n,r),o.name=t.name,s&&Object.assign(o,s),o};var eg=_p,EW={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Za=us;function Jpe(t,e){e=e||new FormData;var i=[];function n(s){return s===null?"":Za.isDate(s)?s.toISOString():Za.isArrayBuffer(s)||Za.isTypedArray(s)?typeof Blob=="function"?new Blob([s]):Buffer.from(s):s}function r(s,o){if(Za.isPlainObject(s)||Za.isArray(s)){if(i.indexOf(s)!==-1)throw Error("Circular reference detected in "+o);i.push(s),Za.forEach(s,function(l,c){if(!Za.isUndefined(l)){var u=o?o+"."+c:c,h;if(l&&!o&&typeof l=="object"){if(Za.endsWith(c,"{}"))l=JSON.stringify(l);else if(Za.endsWith(c,"[]")&&(h=Za.toArray(l))){h.forEach(function(d){!Za.isUndefined(d)&&e.append(u,n(d))});return}}r(l,u)}}),i.pop()}else e.append(o,n(s))}return r(t),e}var wW=Jpe,ix,g2;function Qpe(){if(g2)return ix;g2=1;var t=eg;return ix=function(i,n,r){var s=r.config.validateStatus;!r.status||!s||s(r.status)?i(r):n(new t("Request failed with status code "+r.status,[t.ERR_BAD_REQUEST,t.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))},ix}var nx,v2;function ege(){if(v2)return nx;v2=1;var t=us;return nx=t.isStandardBrowserEnv()?function(){return{write:function(n,r,s,o,a,l){var c=[];c.push(n+"="+encodeURIComponent(r)),t.isNumber(s)&&c.push("expires="+new Date(s).toGMTString()),t.isString(o)&&c.push("path="+o),t.isString(a)&&c.push("domain="+a),l===!0&&c.push("secure"),document.cookie=c.join("; ")},read:function(n){var r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),nx}var tge=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)},ige=function(e,i){return i?e.replace(/\/+$/,"")+"/"+i.replace(/^\/+/,""):e},nge=tge,rge=ige,TW=function(e,i){return e&&!nge(i)?rge(e,i):i},rx,y2;function sge(){if(y2)return rx;y2=1;var t=us,e=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return rx=function(n){var r={},s,o,a;return n&&t.forEach(n.split(`
`),function(c){if(a=c.indexOf(":"),s=t.trim(c.substr(0,a)).toLowerCase(),o=t.trim(c.substr(a+1)),s){if(r[s]&&e.indexOf(s)>=0)return;s==="set-cookie"?r[s]=(r[s]?r[s]:[]).concat([o]):r[s]=r[s]?r[s]+", "+o:o}}),r},rx}var sx,S2;function oge(){if(S2)return sx;S2=1;var t=us;return sx=t.isStandardBrowserEnv()?function(){var i=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a"),r;function s(o){var a=o;return i&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=s(window.location.href),function(a){var l=t.isString(a)?s(a):a;return l.protocol===r.protocol&&l.host===r.host}}():function(){return function(){return!0}}(),sx}var ox,b2;function $E(){if(b2)return ox;b2=1;var t=eg,e=us;function i(n){t.call(this,n??"canceled",t.ERR_CANCELED),this.name="CanceledError"}return e.inherits(i,t,{__CANCEL__:!0}),ox=i,ox}var ax,_2;function age(){return _2||(_2=1,ax=function(e){var i=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return i&&i[1]||""}),ax}var lx,P2;function E2(){if(P2)return lx;P2=1;var t=us,e=Qpe(),i=ege(),n=SW,r=TW,s=sge(),o=oge(),a=EW,l=eg,c=$E(),u=age();return lx=function(d){return new Promise(function(m,g){var v=d.data,p=d.headers,b=d.responseType,_;function P(){d.cancelToken&&d.cancelToken.unsubscribe(_),d.signal&&d.signal.removeEventListener("abort",_)}t.isFormData(v)&&t.isStandardBrowserEnv()&&delete p["Content-Type"];var E=new XMLHttpRequest;if(d.auth){var T=d.auth.username||"",C=d.auth.password?unescape(encodeURIComponent(d.auth.password)):"";p.Authorization="Basic "+btoa(T+":"+C)}var M=r(d.baseURL,d.url);E.open(d.method.toUpperCase(),n(M,d.params,d.paramsSerializer),!0),E.timeout=d.timeout;function x(){if(E){var D="getAllResponseHeaders"in E?s(E.getAllResponseHeaders()):null,O=!b||b==="text"||b==="json"?E.responseText:E.response,F={data:O,status:E.status,statusText:E.statusText,headers:D,config:d,request:E};e(function(Z){m(Z),P()},function(Z){g(Z),P()},F),E=null}}if("onloadend"in E?E.onloadend=x:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(x)},E.onabort=function(){E&&(g(new l("Request aborted",l.ECONNABORTED,d,E)),E=null)},E.onerror=function(){g(new l("Network Error",l.ERR_NETWORK,d,E,E)),E=null},E.ontimeout=function(){var O=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded",F=d.transitional||a;d.timeoutErrorMessage&&(O=d.timeoutErrorMessage),g(new l(O,F.clarifyTimeoutError?l.ETIMEDOUT:l.ECONNABORTED,d,E)),E=null},t.isStandardBrowserEnv()){var V=(d.withCredentials||o(M))&&d.xsrfCookieName?i.read(d.xsrfCookieName):void 0;V&&(p[d.xsrfHeaderName]=V)}"setRequestHeader"in E&&t.forEach(p,function(O,F){typeof v>"u"&&F.toLowerCase()==="content-type"?delete p[F]:E.setRequestHeader(F,O)}),t.isUndefined(d.withCredentials)||(E.withCredentials=!!d.withCredentials),b&&b!=="json"&&(E.responseType=d.responseType),typeof d.onDownloadProgress=="function"&&E.addEventListener("progress",d.onDownloadProgress),typeof d.onUploadProgress=="function"&&E.upload&&E.upload.addEventListener("progress",d.onUploadProgress),(d.cancelToken||d.signal)&&(_=function(D){E&&(g(!D||D&&D.type?new c:D),E.abort(),E=null)},d.cancelToken&&d.cancelToken.subscribe(_),d.signal&&(d.signal.aborted?_():d.signal.addEventListener("abort",_))),v||(v=null);var N=u(M);if(N&&["http","https","file"].indexOf(N)===-1){g(new l("Unsupported protocol "+N+":",l.ERR_BAD_REQUEST,d));return}E.send(v)})},lx}var cx,w2;function lge(){return w2||(w2=1,cx=null),cx}var Fr=us,T2=Zpe,x2=eg,cge=EW,hge=wW,uge={"Content-Type":"application/x-www-form-urlencoded"};function k2(t,e){!Fr.isUndefined(t)&&Fr.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function dge(){var t;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(t=E2()),t}function fge(t,e,i){if(Fr.isString(t))try{return(e||JSON.parse)(t),Fr.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(i||JSON.stringify)(t)}var WE={transitional:cge,adapter:dge(),transformRequest:[function(e,i){if(T2(i,"Accept"),T2(i,"Content-Type"),Fr.isFormData(e)||Fr.isArrayBuffer(e)||Fr.isBuffer(e)||Fr.isStream(e)||Fr.isFile(e)||Fr.isBlob(e))return e;if(Fr.isArrayBufferView(e))return e.buffer;if(Fr.isURLSearchParams(e))return k2(i,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var n=Fr.isObject(e),r=i&&i["Content-Type"],s;if((s=Fr.isFileList(e))||n&&r==="multipart/form-data"){var o=this.env&&this.env.FormData;return hge(s?{"files[]":e}:e,o&&new o)}else if(n||r==="application/json")return k2(i,"application/json"),fge(e);return e}],transformResponse:[function(e){var i=this.transitional||WE.transitional,n=i&&i.silentJSONParsing,r=i&&i.forcedJSONParsing,s=!n&&this.responseType==="json";if(s||r&&Fr.isString(e)&&e.length)try{return JSON.parse(e)}catch(o){if(s)throw o.name==="SyntaxError"?x2.from(o,x2.ERR_BAD_RESPONSE,this,null,this.response):o}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:lge()},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Fr.forEach(["delete","get","head"],function(e){WE.headers[e]={}});Fr.forEach(["post","put","patch"],function(e){WE.headers[e]=Fr.merge(uge)});var SV=WE,mge=us,pge=SV,gge=function(e,i,n){var r=this||pge;return mge.forEach(n,function(o){e=o.call(r,e,i)}),e},hx,C2;function xW(){return C2||(C2=1,hx=function(e){return!!(e&&e.__CANCEL__)}),hx}var M2=us,ux=gge,vge=xW(),yge=SV,Sge=$E();function dx(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Sge}var bge=function(e){dx(e),e.headers=e.headers||{},e.data=ux.call(e,e.data,e.headers,e.transformRequest),e.headers=M2.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),M2.forEach(["delete","get","head","post","put","patch","common"],function(r){delete e.headers[r]});var i=e.adapter||yge.adapter;return i(e).then(function(r){return dx(e),r.data=ux.call(e,r.data,r.headers,e.transformResponse),r},function(r){return vge(r)||(dx(e),r&&r.response&&(r.response.data=ux.call(e,r.response.data,r.response.headers,e.transformResponse))),Promise.reject(r)})},Do=us,kW=function(e,i){i=i||{};var n={};function r(u,h){return Do.isPlainObject(u)&&Do.isPlainObject(h)?Do.merge(u,h):Do.isPlainObject(h)?Do.merge({},h):Do.isArray(h)?h.slice():h}function s(u){if(Do.isUndefined(i[u])){if(!Do.isUndefined(e[u]))return r(void 0,e[u])}else return r(e[u],i[u])}function o(u){if(!Do.isUndefined(i[u]))return r(void 0,i[u])}function a(u){if(Do.isUndefined(i[u])){if(!Do.isUndefined(e[u]))return r(void 0,e[u])}else return r(void 0,i[u])}function l(u){if(u in i)return r(e[u],i[u]);if(u in e)return r(void 0,e[u])}var c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l};return Do.forEach(Object.keys(e).concat(Object.keys(i)),function(h){var d=c[h]||s,f=d(h);Do.isUndefined(f)&&d!==l||(n[h]=f)}),n},fx,A2;function CW(){return A2||(A2=1,fx={version:"0.27.2"}),fx}var _ge=CW().version,Zh=eg,bV={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){bV[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});var V2={};bV.transitional=function(e,i,n){function r(s,o){return"[Axios v"+_ge+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return function(s,o,a){if(e===!1)throw new Zh(r(o," has been removed"+(i?" in "+i:"")),Zh.ERR_DEPRECATED);return i&&!V2[o]&&(V2[o]=!0,console.warn(r(o," has been deprecated since v"+i+" and will be removed in the near future"))),e?e(s,o,a):!0}};function Pge(t,e,i){if(typeof t!="object")throw new Zh("options must be an object",Zh.ERR_BAD_OPTION_VALUE);for(var n=Object.keys(t),r=n.length;r-- >0;){var s=n[r],o=e[s];if(o){var a=t[s],l=a===void 0||o(a,s,t);if(l!==!0)throw new Zh("option "+s+" must be "+l,Zh.ERR_BAD_OPTION_VALUE);continue}if(i!==!0)throw new Zh("Unknown option "+s,Zh.ERR_BAD_OPTION)}}var Ege={assertOptions:Pge,validators:bV},MW=us,wge=SW,L2=Xpe,I2=bge,GE=kW,Tge=TW,AW=Ege,Xf=AW.validators;function Pp(t){this.defaults=t,this.interceptors={request:new L2,response:new L2}}Pp.prototype.request=function(e,i){typeof e=="string"?(i=i||{},i.url=e):i=e||{},i=GE(this.defaults,i),i.method?i.method=i.method.toLowerCase():this.defaults.method?i.method=this.defaults.method.toLowerCase():i.method="get";var n=i.transitional;n!==void 0&&AW.assertOptions(n,{silentJSONParsing:Xf.transitional(Xf.boolean),forcedJSONParsing:Xf.transitional(Xf.boolean),clarifyTimeoutError:Xf.transitional(Xf.boolean)},!1);var r=[],s=!0;this.interceptors.request.forEach(function(f){typeof f.runWhen=="function"&&f.runWhen(i)===!1||(s=s&&f.synchronous,r.unshift(f.fulfilled,f.rejected))});var o=[];this.interceptors.response.forEach(function(f){o.push(f.fulfilled,f.rejected)});var a;if(!s){var l=[I2,void 0];for(Array.prototype.unshift.apply(l,r),l=l.concat(o),a=Promise.resolve(i);l.length;)a=a.then(l.shift(),l.shift());return a}for(var c=i;r.length;){var u=r.shift(),h=r.shift();try{c=u(c)}catch(d){h(d);break}}try{a=I2(c)}catch(d){return Promise.reject(d)}for(;o.length;)a=a.then(o.shift(),o.shift());return a};Pp.prototype.getUri=function(e){e=GE(this.defaults,e);var i=Tge(e.baseURL,e.url);return wge(i,e.params,e.paramsSerializer)};MW.forEach(["delete","get","head","options"],function(e){Pp.prototype[e]=function(i,n){return this.request(GE(n||{},{method:e,url:i,data:(n||{}).data}))}});MW.forEach(["post","put","patch"],function(e){function i(n){return function(s,o,a){return this.request(GE(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Pp.prototype[e]=i(),Pp.prototype[e+"Form"]=i(!0)});var xge=Pp,mx,O2;function kge(){if(O2)return mx;O2=1;var t=$E();function e(i){if(typeof i!="function")throw new TypeError("executor must be a function.");var n;this.promise=new Promise(function(o){n=o});var r=this;this.promise.then(function(s){if(r._listeners){var o,a=r._listeners.length;for(o=0;o<a;o++)r._listeners[o](s);r._listeners=null}}),this.promise.then=function(s){var o,a=new Promise(function(l){r.subscribe(l),o=l}).then(s);return a.cancel=function(){r.unsubscribe(o)},a},i(function(o){r.reason||(r.reason=new t(o),n(r.reason))})}return e.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},e.prototype.subscribe=function(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]},e.prototype.unsubscribe=function(n){if(this._listeners){var r=this._listeners.indexOf(n);r!==-1&&this._listeners.splice(r,1)}},e.source=function(){var n,r=new e(function(o){n=o});return{token:r,cancel:n}},mx=e,mx}var px,D2;function Cge(){return D2||(D2=1,px=function(e){return function(n){return e.apply(null,n)}}),px}var gx,N2;function Mge(){if(N2)return gx;N2=1;var t=us;return gx=function(i){return t.isObject(i)&&i.isAxiosError===!0},gx}var R2=us,Age=gW,A0=xge,Vge=kW,Lge=SV;function VW(t){var e=new A0(t),i=Age(A0.prototype.request,e);return R2.extend(i,A0.prototype,e),R2.extend(i,e),i.create=function(r){return VW(Vge(t,r))},i}var Co=VW(Lge);Co.Axios=A0;Co.CanceledError=$E();Co.CancelToken=kge();Co.isCancel=xW();Co.VERSION=CW().version;Co.toFormData=wW;Co.AxiosError=eg;Co.Cancel=Co.CanceledError;Co.all=function(e){return Promise.all(e)};Co.spread=Cge();Co.isAxiosError=Mge();fV.exports=Co;fV.exports.default=Co;var Ige=fV.exports,Oge=Ige;const N_=IP(Oge);let F2,Sy,Um,vx=null;const Qr=ge(null),dm=ge([]);function Dge(t){return dm.value.findIndex(i=>i.id===t)>=0}async function R_(t,e){var a;let i;const n=e.script.trim();n.startsWith("https")?i=await dp(Mu(Sy,n)).then(c=>N_.get(c)).then(c=>c.data):i=JSON.parse(n);const r=new Pt;let s;(a=e.preview)!=null&&a.startsWith("https:")?s=await dp(Mu(Sy,e.preview)).then(l=>N_.get(l)).then(l=>l.data):s=e.preview;const o=i.map(l=>typeof l=="string"?1:l.length).reduce((l,c)=>l+c);if(e.rotationMatrix){const l=JSON.parse(e.rotationMatrix);r.fromArray(l)}return Promise.resolve({version:e.version,id:t,script:n,parsedScript:i,objectCount:o,author:e.author,dateCreated:e.dateCreated,description:e.description,aspectRatio:e.aspectRatio??1,sphereRotationMatrix:r,preview:s??"",publicDocId:e.publicDocId,tools:e.tools??void 0})}function Nge(t,e){e.splice(0);const i=[];wpe(t).then(n=>{n.forEach(async r=>{const s=r.data();let o=null;if(s.constructionDocId){const a=s,l=vl(Um,"users",a.author,"constructions",a.constructionDocId),c=await yy(l);o=await R_(a.constructionDocId,c.data())}else o=await R_(r.id,s);o.parsedScript.length>0?e.push(o):(console.warn(`Construction ${t.path}.${r.id} contains no script`),i.push(r.id))})}).finally(()=>{e.sort((n,r)=>n.dateCreated.localeCompare(r.dateCreated)),i.length>0&&$.fire("show-alert",{key:"Missing scripts in documents: "+i.join(","),type:"error"})})}async function Rge(t,e){if(Qr.value===null)return Promise.resolve(!1);const i=Qr.value.findIndex(n=>n.id===e);if(i<0)return Promise.resolve(!1);try{const n=Qr.value[i];return n.publicDocId&&await f2(vl(Um,"constructions",n.publicDocId)),n.script.startsWith("https://")&&await vR(Mu(Sy,`/scripts/${e}`)),n.preview.startsWith("https://")&&await vR(Mu(Sy,`/construction-svg/${e}`)),await f2(vl(Um,"users",t,"constructions",e)),Promise.resolve(!0)}catch{return Promise.resolve(!1)}}function _V(){ki(()=>{F2=Fp(),Um=fS(),Sy=cE(),F2.onAuthStateChanged(r=>{if(vx!==null&&vx(),r!==null){const s=I_(Um,"users",r.uid,"constructions");Qr.value===null&&(Qr.value=[]),vx=xpe(s,o=>{o.docChanges().forEach(async a=>{var c,u,h,d,f;const l=a.doc.data();switch(a.type){case"added":const m=await R_(a.doc.id,l);(c=Qr.value)==null||c.push(m);break;case"removed":if(Qr.value){const g=(u=Qr.value)==null?void 0:u.findIndex(v=>v.id===a.doc.id);g>=0&&((h=Qr.value)==null||h.splice(g,1))}break;case"modified":if(Qr.value){const g=(d=Qr.value)==null?void 0:d.findIndex(p=>p.id===a.doc.id),v=await R_(a.doc.id,l);g>=0&&((f=Qr.value)==null||f.splice(g,1,v))}break}})})}else Qr.value=null});const n=I_(Um,"constructions");Nge(n,dm.value)});const t=Eh(),{constructionDocId:e}=Ji(t),i=W(()=>{let n=-1;return Qr.value!==null&&(n=Qr.value.findIndex(r=>r.id===e.value),n>=0)?Qr.value[n].preview:dm.value!==null&&(n=dm.value.findIndex(r=>r.id===e.value),n>=0)?dm.value[n].preview:null});return{publicConstructions:dm,privateConstructions:Qr,deleteConstruction:Rge,currentConstructionPreview:i,isPublicConstruction:Dge}}function PV(t){return C1()?(ls(t),!0):!1}function tg(t){return typeof t=="function"?t():le(t)}const EV=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Fge=Object.prototype.toString,zge=t=>Fge.call(t)==="[object Object]",z2=()=>+Date.now(),JC=()=>{};function Uge(t,e){function i(...n){return new Promise((r,s)=>{Promise.resolve(t(()=>e.apply(this,n),{fn:e,thisArg:this,args:n})).then(r).catch(s)})}return i}function Bge(t,e=!0,i=!0,n=!1){let r=0,s,o=!0,a=JC,l;const c=()=>{s&&(clearTimeout(s),s=void 0,a(),a=JC)};return h=>{const d=tg(t),f=Date.now()-r,m=()=>l=h();return c(),d<=0?(r=Date.now(),m()):(f>d&&(i||!o)?(r=Date.now(),m()):e&&(l=new Promise((g,v)=>{a=n?v:g,s=setTimeout(()=>{r=Date.now(),o=!0,g(m()),c()},Math.max(0,d-f))})),!i&&!s&&(s=setTimeout(()=>o=!0,d)),o=!1,l)}}function jge(t){let e;function i(){return e||(e=t()),e}return i.reset=async()=>{const n=e;e=void 0,n&&await n},i}function $ge(t,e,i={}){const{immediate:n=!0}=i,r=ge(!1);let s=null;function o(){s&&(clearTimeout(s),s=null)}function a(){r.value=!1,o()}function l(...c){o(),r.value=!0,s=setTimeout(()=>{r.value=!1,s=null,t(...c)},tg(e))}return n&&(r.value=!0,EV&&l()),PV(a),{isPending:Vp(r),start:l,stop:a}}function Wge(t){var e;const i=tg(t);return(e=i==null?void 0:i.$el)!=null?e:i}const wV=EV?window:void 0,TV=EV?window.navigator:void 0;function by(...t){let e,i,n,r;if(typeof t[0]=="string"||Array.isArray(t[0])?([i,n,r]=t,e=wV):[e,i,n,r]=t,!e)return JC;Array.isArray(i)||(i=[i]),Array.isArray(n)||(n=[n]);const s=[],o=()=>{s.forEach(u=>u()),s.length=0},a=(u,h,d,f)=>(u.addEventListener(h,d,f),()=>u.removeEventListener(h,d,f)),l=He(()=>[Wge(e),tg(r)],([u,h])=>{if(o(),!u)return;const d=zge(h)?{...h}:h;s.push(...i.flatMap(f=>n.map(m=>a(u,f,m,d))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return PV(c),c}function Gge(t){return typeof t=="function"?t:typeof t=="string"?e=>e.key===t:Array.isArray(t)?e=>t.includes(e.key):()=>!0}function Hge(...t){let e,i,n={};t.length===3?(e=t[0],i=t[1],n=t[2]):t.length===2?typeof t[1]=="object"?(e=!0,i=t[0],n=t[1]):(e=t[0],i=t[1]):(e=!0,i=t[0]);const{target:r=wV,eventName:s="keydown",passive:o=!1,dedupe:a=!1}=n,l=Gge(e);return by(r,s,u=>{u.repeat&&tg(a)||l(u)&&i(u)},o)}function qge(t,e,i={}){return Hge(t,e,{...i,eventName:"keydown"})}function Kge(){const t=ge(!1);return Sh()&&ki(()=>{t.value=!0}),t}function xV(t){const e=Kge();return W(()=>(e.value,!!t()))}function F_(t,e={}){const{controls:i=!1,navigator:n=TV}=e,r=xV(()=>n&&"permissions"in n);let s;const o=typeof t=="string"?{name:t}:t,a=ge(),l=()=>{s&&(a.value=s.state)},c=jge(async()=>{if(r.value){if(!s)try{s=await n.permissions.query(o),by(s,"change",l),l()}catch{a.value="prompt"}return s}});return c(),i?{state:a,isSupported:r,query:c}:a}function Xge(t={}){const{navigator:e=TV,read:i=!1,source:n,copiedDuring:r=1500,legacy:s=!1}=t,o=xV(()=>e&&"clipboard"in e),a=F_("clipboard-read"),l=F_("clipboard-write"),c=W(()=>o.value||s),u=ge(""),h=ge(!1),d=$ge(()=>h.value=!1,r);function f(){o.value&&a.value!=="denied"?e.clipboard.readText().then(p=>{u.value=p}):u.value=v()}c.value&&i&&by(["copy","cut"],f);async function m(p=tg(n)){c.value&&p!=null&&(o.value&&l.value!=="denied"?await e.clipboard.writeText(p):g(p),u.value=p,h.value=!0,d.start())}function g(p){const b=document.createElement("textarea");b.value=p??"",b.style.position="absolute",b.style.opacity="0",document.body.appendChild(b),b.select(),document.execCommand("copy"),b.remove()}function v(){var p,b,_;return(_=(b=(p=document==null?void 0:document.getSelection)==null?void 0:p.call(document))==null?void 0:b.toString())!=null?_:""}return{isSupported:c,text:u,copied:h,copy:m}}function Yge(t={}){const{enableHighAccuracy:e=!0,maximumAge:i=3e4,timeout:n=27e3,navigator:r=TV,immediate:s=!0}=t,o=xV(()=>r&&"geolocation"in r),a=ge(null),l=_t(null),c=ge({accuracy:0,latitude:Number.POSITIVE_INFINITY,longitude:Number.POSITIVE_INFINITY,altitude:null,altitudeAccuracy:null,heading:null,speed:null});function u(m){a.value=m.timestamp,c.value=m.coords,l.value=null}let h;function d(){o.value&&(h=r.geolocation.watchPosition(u,m=>l.value=m,{enableHighAccuracy:e,maximumAge:i,timeout:n}))}s&&d();function f(){h&&r&&r.geolocation.clearWatch(h)}return PV(()=>{f()}),{isSupported:o,coords:c,locatedAt:a,error:l,resume:d,pause:f}}const Zge=["mousemove","mousedown","resize","keydown","touchstart","wheel"],Jge=6e4;function Qge(t=Jge,e={}){const{initialState:i=!1,listenForVisibilityChange:n=!0,events:r=Zge,window:s=wV,eventFilter:o=Bge(50)}=e,a=ge(i),l=ge(z2());let c;const u=()=>{a.value=!1,clearTimeout(c),c=setTimeout(()=>a.value=!0,t)},h=Uge(o,()=>{l.value=z2(),u()});if(s){const d=s.document;for(const f of r)by(s,f,h,{passive:!0});n&&by(d,"visibilitychange",()=>{d.hidden||h()}),u()}return{idle:a,lastActive:l,reset:u}}const eve=We({disabled:Boolean,modelValue:{type:Boolean,default:void 0},..._B()},"VHover"),tve=vt()({name:"VHover",props:eve(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const n=Oi(t,"modelValue"),{runOpenDelay:r,runCloseDelay:s}=PB(t,o=>!t.disabled&&(n.value=o));return()=>{var o;return(o=i.default)==null?void 0:o.call(i,{isHovering:n.value,props:{onMouseenter:r,onMouseleave:s}})}}});const QC=Symbol.for("vuetify:list");function LW(){const t=xi(QC,{hasPrepend:_t(!1),updateHasPrepend:()=>null}),e={hasPrepend:_t(!1),updateHasPrepend:i=>{i&&(e.hasPrepend.value=i)}};return jn(QC,e),t}function IW(){return xi(QC,null)}const ive={open:t=>{let{id:e,value:i,opened:n,parents:r}=t;if(i){const s=new Set;s.add(e);let o=r.get(e);for(;o!=null;)s.add(o),o=r.get(o);return s}else return n.delete(e),n},select:()=>null},OW={open:t=>{let{id:e,value:i,opened:n,parents:r}=t;if(i){let s=r.get(e);for(n.add(e);s!=null&&s!==e;)n.add(s),s=r.get(s);return n}else n.delete(e);return n},select:()=>null},nve={open:OW.open,select:t=>{let{id:e,value:i,opened:n,parents:r}=t;if(!i)return n;const s=[];let o=r.get(e);for(;o!=null;)s.push(o),o=r.get(o);return new Set(s)}},kV=t=>{const e={select:i=>{let{id:n,value:r,selected:s}=i;if(n=hi(n),t&&!r){const o=Array.from(s.entries()).reduce((a,l)=>{let[c,u]=l;return u==="on"?[...a,c]:a},[]);if(o.length===1&&o[0]===n)return s}return s.set(n,r?"on":"off"),s},in:(i,n,r)=>{let s=new Map;for(const o of i||[])s=e.select({id:o,value:!0,selected:new Map(s),children:n,parents:r});return s},out:i=>{const n=[];for(const[r,s]of i.entries())s==="on"&&n.push(r);return n}};return e},DW=t=>{const e=kV(t);return{select:n=>{let{selected:r,id:s,...o}=n;s=hi(s);const a=r.has(s)?new Map([[s,r.get(s)]]):new Map;return e.select({...o,id:s,selected:a})},in:(n,r,s)=>{let o=new Map;return n!=null&&n.length&&(o=e.in(n.slice(0,1),r,s)),o},out:(n,r,s)=>e.out(n,r,s)}},rve=t=>{const e=kV(t);return{select:n=>{let{id:r,selected:s,children:o,...a}=n;return r=hi(r),o.has(r)?s:e.select({id:r,selected:s,children:o,...a})},in:e.in,out:e.out}},sve=t=>{const e=DW(t);return{select:n=>{let{id:r,selected:s,children:o,...a}=n;return r=hi(r),o.has(r)?s:e.select({id:r,selected:s,children:o,...a})},in:e.in,out:e.out}},ove=t=>{const e={select:i=>{let{id:n,value:r,selected:s,children:o,parents:a}=i;n=hi(n);const l=new Map(s),c=[n];for(;c.length;){const h=c.shift();s.set(h,r?"on":"off"),o.has(h)&&c.push(...o.get(h))}let u=a.get(n);for(;u;){const h=o.get(u),d=h.every(m=>s.get(m)==="on"),f=h.every(m=>!s.has(m)||s.get(m)==="off");s.set(u,d?"on":f?"off":"indeterminate"),u=a.get(u)}return t&&!r&&Array.from(s.entries()).reduce((d,f)=>{let[m,g]=f;return g==="on"?[...d,m]:d},[]).length===0?l:s},in:(i,n,r)=>{let s=new Map;for(const o of i||[])s=e.select({id:o,value:!0,selected:new Map(s),children:n,parents:r});return s},out:(i,n)=>{const r=[];for(const[s,o]of i.entries())o==="on"&&!n.has(s)&&r.push(s);return r}};return e},_y=Symbol.for("vuetify:nested"),NW={id:_t(),root:{register:()=>null,unregister:()=>null,parents:ge(new Map),children:ge(new Map),open:()=>null,openOnSelect:()=>null,select:()=>null,opened:ge(new Set),selected:ge(new Map),selectedValues:ge([])}},ave=We({selectStrategy:[String,Function],openStrategy:[String,Object],opened:Array,selected:Array,mandatory:Boolean},"nested"),lve=t=>{let e=!1;const i=ge(new Map),n=ge(new Map),r=Oi(t,"opened",t.opened,h=>new Set(h),h=>[...h.values()]),s=W(()=>{if(typeof t.selectStrategy=="object")return t.selectStrategy;switch(t.selectStrategy){case"single-leaf":return sve(t.mandatory);case"leaf":return rve(t.mandatory);case"independent":return kV(t.mandatory);case"single-independent":return DW(t.mandatory);case"classic":default:return ove(t.mandatory)}}),o=W(()=>{if(typeof t.openStrategy=="object")return t.openStrategy;switch(t.openStrategy){case"list":return nve;case"single":return ive;case"multiple":default:return OW}}),a=Oi(t,"selected",t.selected,h=>s.value.in(h,i.value,n.value),h=>s.value.out(h,i.value,n.value));an(()=>{e=!0});function l(h){const d=[];let f=h;for(;f!=null;)d.unshift(f),f=n.value.get(f);return d}const c=br("nested"),u={id:_t(),root:{opened:r,selected:a,selectedValues:W(()=>{const h=[];for(const[d,f]of a.value.entries())f==="on"&&h.push(d);return h}),register:(h,d,f)=>{d&&h!==d&&n.value.set(h,d),f&&i.value.set(h,[]),d!=null&&i.value.set(d,[...i.value.get(d)||[],h])},unregister:h=>{if(e)return;i.value.delete(h);const d=n.value.get(h);if(d){const f=i.value.get(d)??[];i.value.set(d,f.filter(m=>m!==h))}n.value.delete(h),r.value.delete(h)},open:(h,d,f)=>{c.emit("click:open",{id:h,value:d,path:l(h),event:f});const m=o.value.open({id:h,value:d,opened:new Set(r.value),children:i.value,parents:n.value,event:f});m&&(r.value=m)},openOnSelect:(h,d,f)=>{const m=o.value.select({id:h,value:d,selected:new Map(a.value),opened:new Set(r.value),children:i.value,parents:n.value,event:f});m&&(r.value=m)},select:(h,d,f)=>{c.emit("click:select",{id:h,value:d,path:l(h),event:f});const m=s.value.select({id:h,value:d,selected:new Map(a.value),children:i.value,parents:n.value,event:f});m&&(a.value=m),u.root.openOnSelect(h,d,f)},children:i,parents:n}};return jn(_y,u),u.root},RW=(t,e)=>{const i=xi(_y,NW),n=Symbol(Ao()),r=W(()=>t.value!==void 0?t.value:n),s={...i,id:r,open:(o,a)=>i.root.open(r.value,o,a),openOnSelect:(o,a)=>i.root.openOnSelect(r.value,o,a),isOpen:W(()=>i.root.opened.value.has(r.value)),parent:W(()=>i.root.parents.value.get(r.value)),select:(o,a)=>i.root.select(r.value,o,a),isSelected:W(()=>i.root.selected.value.get(hi(r.value))==="on"),isIndeterminate:W(()=>i.root.selected.value.get(r.value)==="indeterminate"),isLeaf:W(()=>!i.root.children.value.get(r.value)),isGroupActivator:i.isGroupActivator};return!i.isGroupActivator&&i.root.register(r.value,i.id.value,e),an(()=>{!i.isGroupActivator&&i.root.unregister(r.value)}),e&&jn(_y,s),s},cve=()=>{const t=xi(_y,NW);jn(_y,{...t,isGroupActivator:!0})},hve=El({name:"VListGroupActivator",setup(t,e){let{slots:i}=e;return cve(),()=>{var n;return(n=i.default)==null?void 0:n.call(i)}}}),uve=We({activeColor:String,baseColor:String,color:String,collapseIcon:{type:ji,default:"$collapse"},expandIcon:{type:ji,default:"$expand"},prependIcon:ji,appendIcon:ji,fluid:Boolean,subgroup:Boolean,title:String,value:null,...Ut(),...pn()},"VListGroup"),U2=vt()({name:"VListGroup",props:uve(),setup(t,e){let{slots:i}=e;const{isOpen:n,open:r,id:s}=RW(bt(t,"value"),!0),o=W(()=>`v-list-group--id-${String(s.value)}`),a=IW(),{isBooted:l}=MP();function c(f){r(!n.value,f)}const u=W(()=>({onClick:c,class:"v-list-group__header",id:o.value})),h=W(()=>n.value?t.collapseIcon:t.expandIcon),d=W(()=>({VListItem:{active:n.value,activeColor:t.activeColor,baseColor:t.baseColor,color:t.color,prependIcon:t.prependIcon||t.subgroup&&h.value,appendIcon:t.appendIcon||!t.subgroup&&h.value,title:t.title,value:t.value}}));return Tt(()=>w(t.tag,{class:["v-list-group",{"v-list-group--prepend":a==null?void 0:a.hasPrepend.value,"v-list-group--fluid":t.fluid,"v-list-group--subgroup":t.subgroup,"v-list-group--open":n.value},t.class],style:t.style},{default:()=>[i.activator&&w(rr,{defaults:d.value},{default:()=>[w(hve,null,{default:()=>[i.activator({props:u.value,isOpen:n.value})]})]}),w(Gl,{transition:{component:vB},disabled:!l.value},{default:()=>{var f;return[fi(w("div",{class:"v-list-group__items",role:"group","aria-labelledby":o.value},[(f=i.default)==null?void 0:f.call(i)]),[[ln,n.value]])]}})]})),{}}});const FW=Qd("v-list-item-subtitle"),zW=Qd("v-list-item-title"),dve=We({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:ji,baseColor:String,disabled:Boolean,lines:String,link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:ji,ripple:{type:[Boolean,Object],default:!0},slim:Boolean,subtitle:[String,Number],title:[String,Number],value:null,onClick:pl(),onClickOnce:pl(),...Lu(),...Ut(),...Ba(),...bh(),...Tl(),...cs(),...pP(),...pn(),...wn(),...bc({variant:"text"})},"VListItem"),jo=vt()({name:"VListItem",directives:{Ripple:of},props:dve(),emits:{click:t=>!0},setup(t,e){let{attrs:i,slots:n,emit:r}=e;const s=mP(t,i),o=W(()=>t.value===void 0?s.href.value:t.value),{select:a,isSelected:l,isIndeterminate:c,isGroupActivator:u,root:h,parent:d,openOnSelect:f}=RW(o,!1),m=IW(),g=W(()=>{var z;return t.active!==!1&&(t.active||((z=s.isActive)==null?void 0:z.value)||l.value)}),v=W(()=>t.link!==!1&&s.isLink.value),p=W(()=>!t.disabled&&t.link!==!1&&(t.link||s.isClickable.value||t.value!=null&&!!m)),b=W(()=>t.rounded||t.nav),_=W(()=>t.color??t.activeColor),P=W(()=>({color:g.value?_.value??t.baseColor:t.baseColor,variant:t.variant}));He(()=>{var z;return(z=s.isActive)==null?void 0:z.value},z=>{z&&d.value!=null&&h.open(d.value,!0),z&&f(z)},{immediate:!0});const{themeClasses:E}=Hn(t),{borderClasses:T}=Iu(t),{colorClasses:C,colorStyles:M,variantClasses:x}=tf(P),{densityClasses:V}=wl(t),{dimensionStyles:N}=_h(t),{elevationClasses:D}=xl(t),{roundedClasses:O}=hs(b),F=W(()=>t.lines?`v-list-item--${t.lines}-line`:void 0),X=W(()=>({isActive:g.value,select:a,isSelected:l.value,isIndeterminate:c.value}));function Z(z){var H;r("click",z),!(u||!p.value)&&((H=s.navigate)==null||H.call(s,z),t.value!=null&&a(!l.value,z))}function K(z){(z.key==="Enter"||z.key===" ")&&(z.preventDefault(),Z(z))}return Tt(()=>{const z=v.value?"a":t.tag,H=n.title||t.title!=null,re=n.subtitle||t.subtitle!=null,ne=!!(t.appendAvatar||t.appendIcon),B=!!(ne||n.append),Q=!!(t.prependAvatar||t.prependIcon),fe=!!(Q||n.prepend);return m==null||m.updateHasPrepend(fe),t.activeColor&&u7("active-color",["color","base-color"]),fi(w(z,{class:["v-list-item",{"v-list-item--active":g.value,"v-list-item--disabled":t.disabled,"v-list-item--link":p.value,"v-list-item--nav":t.nav,"v-list-item--prepend":!fe&&(m==null?void 0:m.hasPrepend.value),"v-list-item--slim":t.slim,[`${t.activeClass}`]:t.activeClass&&g.value},E.value,T.value,C.value,V.value,D.value,F.value,O.value,x.value,t.class],style:[M.value,N.value,t.style],href:s.href.value,tabindex:p.value?m?-2:0:void 0,onClick:Z,onKeydown:p.value&&!v.value&&K},{default:()=>{var ie;return[ef(p.value||g.value,"v-list-item"),fe&&w("div",{key:"prepend",class:"v-list-item__prepend"},[n.prepend?w(rr,{key:"prepend-defaults",disabled:!Q,defaults:{VAvatar:{density:t.density,image:t.prependAvatar},VIcon:{density:t.density,icon:t.prependIcon},VListItemAction:{start:!0}}},{default:()=>{var se;return[(se=n.prepend)==null?void 0:se.call(n,X.value)]}}):w(mt,null,[t.prependAvatar&&w(ah,{key:"prepend-avatar",density:t.density,image:t.prependAvatar},null),t.prependIcon&&w(lt,{key:"prepend-icon",density:t.density,icon:t.prependIcon},null)]),w("div",{class:"v-list-item__spacer"},null)]),w("div",{class:"v-list-item__content","data-no-activator":""},[H&&w(zW,{key:"title"},{default:()=>{var se;return[((se=n.title)==null?void 0:se.call(n,{title:t.title}))??t.title]}}),re&&w(FW,{key:"subtitle"},{default:()=>{var se;return[((se=n.subtitle)==null?void 0:se.call(n,{subtitle:t.subtitle}))??t.subtitle]}}),(ie=n.default)==null?void 0:ie.call(n,X.value)]),B&&w("div",{key:"append",class:"v-list-item__append"},[n.append?w(rr,{key:"append-defaults",disabled:!ne,defaults:{VAvatar:{density:t.density,image:t.appendAvatar},VIcon:{density:t.density,icon:t.appendIcon},VListItemAction:{end:!0}}},{default:()=>{var se;return[(se=n.append)==null?void 0:se.call(n,X.value)]}}):w(mt,null,[t.appendIcon&&w(lt,{key:"append-icon",density:t.density,icon:t.appendIcon},null),t.appendAvatar&&w(ah,{key:"append-avatar",density:t.density,image:t.appendAvatar},null)]),w("div",{class:"v-list-item__spacer"},null)])]}}),[[Mo("ripple"),p.value&&t.ripple]])}),{}}}),fve=We({color:String,inset:Boolean,sticky:Boolean,title:String,...Ut(),...pn()},"VListSubheader"),mve=vt()({name:"VListSubheader",props:fve(),setup(t,e){let{slots:i}=e;const{textColorClasses:n,textColorStyles:r}=ko(bt(t,"color"));return Tt(()=>{const s=!!(i.default||t.title);return w(t.tag,{class:["v-list-subheader",{"v-list-subheader--inset":t.inset,"v-list-subheader--sticky":t.sticky},n.value,t.class],style:[{textColorStyles:r},t.style]},{default:()=>{var o;return[s&&w("div",{class:"v-list-subheader__text"},[((o=i.default)==null?void 0:o.call(i))??t.title])]}})}),{}}}),pve=We({items:Array,returnObject:Boolean},"VListChildren"),UW=vt()({name:"VListChildren",props:pve(),setup(t,e){let{slots:i}=e;return LW(),()=>{var n,r;return((n=i.default)==null?void 0:n.call(i))??((r=t.items)==null?void 0:r.map(s=>{var d,f;let{children:o,props:a,type:l,raw:c}=s;if(l==="divider")return((d=i.divider)==null?void 0:d.call(i,{props:a}))??w(ch,a,null);if(l==="subheader")return((f=i.subheader)==null?void 0:f.call(i,{props:a}))??w(mve,a,null);const u={subtitle:i.subtitle?m=>{var g;return(g=i.subtitle)==null?void 0:g.call(i,{...m,item:c})}:void 0,prepend:i.prepend?m=>{var g;return(g=i.prepend)==null?void 0:g.call(i,{...m,item:c})}:void 0,append:i.append?m=>{var g;return(g=i.append)==null?void 0:g.call(i,{...m,item:c})}:void 0,title:i.title?m=>{var g;return(g=i.title)==null?void 0:g.call(i,{...m,item:c})}:void 0},h=U2.filterProps(a);return o?w(U2,ht({value:a==null?void 0:a.value},h),{activator:m=>{let{props:g}=m;const v={...a,...g,value:t.returnObject?c:a.value};return i.header?i.header({props:v}):w(jo,v,u)},default:()=>w(UW,{items:o},i)}):i.item?i.item({props:a}):w(jo,ht(a,{value:t.returnObject?c:a.value}),u)}))}}}),BW=We({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean,valueComparator:{type:Function,default:Jd}},"list-items");function e1(t,e){const i=jl(e,t.itemTitle,e),n=jl(e,t.itemValue,i),r=jl(e,t.itemChildren),s=t.itemProps===!0?typeof e=="object"&&e!=null&&!Array.isArray(e)?"children"in e?Ua(e,["children"]):e:void 0:jl(e,t.itemProps),o={title:i,value:n,...s};return{title:String(o.title??""),value:o.value,props:o,children:Array.isArray(r)?jW(t,r):void 0,raw:e}}function jW(t,e){const i=[];for(const n of e)i.push(e1(t,n));return i}function $W(t){const e=W(()=>jW(t,t.items)),i=W(()=>e.value.some(s=>s.value===null));function n(s){return i.value||(s=s.filter(o=>o!==null)),s.map(o=>t.returnObject&&typeof o=="string"?e1(t,o):e.value.find(a=>t.valueComparator(o,a.value))||e1(t,o))}function r(s){return t.returnObject?s.map(o=>{let{raw:a}=o;return a}):s.map(o=>{let{value:a}=o;return a})}return{items:e,transformIn:n,transformOut:r}}function gve(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"}function vve(t,e){const i=jl(e,t.itemType,"item"),n=gve(e)?e:jl(e,t.itemTitle),r=jl(e,t.itemValue,void 0),s=jl(e,t.itemChildren),o=t.itemProps===!0?Ua(e,["children"]):jl(e,t.itemProps),a={title:n,value:r,...o};return{type:i,title:a.title,value:a.value,props:a,children:i==="item"&&s?WW(t,s):void 0,raw:e}}function WW(t,e){const i=[];for(const n of e)i.push(vve(t,n));return i}function yve(t){return{items:W(()=>WW(t,t.items))}}const Sve=We({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,expandIcon:String,collapseIcon:String,lines:{type:[Boolean,String],default:"one"},slim:Boolean,nav:Boolean,...ave({selectStrategy:"single-leaf",openStrategy:"list"}),...Lu(),...Ut(),...Ba(),...bh(),...Tl(),itemType:{type:String,default:"type"},...BW(),...cs(),...pn(),...wn(),...bc({variant:"text"})},"VList"),Bm=vt()({name:"VList",props:Sve(),emits:{"update:selected":t=>!0,"update:opened":t=>!0,"click:open":t=>!0,"click:select":t=>!0},setup(t,e){let{slots:i}=e;const{items:n}=yve(t),{themeClasses:r}=Hn(t),{backgroundColorClasses:s,backgroundColorStyles:o}=Cs(bt(t,"bgColor")),{borderClasses:a}=Iu(t),{densityClasses:l}=wl(t),{dimensionStyles:c}=_h(t),{elevationClasses:u}=xl(t),{roundedClasses:h}=hs(t),{open:d,select:f}=lve(t),m=W(()=>t.lines?`v-list--${t.lines}-line`:void 0),g=bt(t,"activeColor"),v=bt(t,"baseColor"),p=bt(t,"color");LW(),Pl({VListGroup:{activeColor:g,baseColor:v,color:p,expandIcon:bt(t,"expandIcon"),collapseIcon:bt(t,"collapseIcon")},VListItem:{activeClass:bt(t,"activeClass"),activeColor:g,baseColor:v,color:p,density:bt(t,"density"),disabled:bt(t,"disabled"),lines:bt(t,"lines"),nav:bt(t,"nav"),slim:bt(t,"slim"),variant:bt(t,"variant")}});const b=_t(!1),_=ge();function P(V){b.value=!0}function E(V){b.value=!1}function T(V){var N;!b.value&&!(V.relatedTarget&&((N=_.value)!=null&&N.contains(V.relatedTarget)))&&x()}function C(V){if(_.value){if(V.key==="ArrowDown")x("next");else if(V.key==="ArrowUp")x("prev");else if(V.key==="Home")x("first");else if(V.key==="End")x("last");else return;V.preventDefault()}}function M(V){b.value=!0}function x(V){if(_.value)return W0(_.value,V)}return Tt(()=>w(t.tag,{ref:_,class:["v-list",{"v-list--disabled":t.disabled,"v-list--nav":t.nav,"v-list--slim":t.slim},r.value,s.value,a.value,l.value,u.value,m.value,h.value,t.class],style:[o.value,c.value,t.style],tabindex:t.disabled||b.value?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:P,onFocusout:E,onFocus:T,onKeydown:C,onMousedown:M},{default:()=>[w(UW,{items:n.value,returnObject:t.returnObject},i)]})),{open:d,select:f,focus:x}}});function bve(t){const e=_t(t);let i=-1;function n(){clearInterval(i)}function r(){n(),vn(()=>e.value=t)}function s(o){const a=o?getComputedStyle(o):{transitionDuration:.2},l=parseFloat(a.transitionDuration)*1e3||200;if(n(),e.value<=0)return;const c=performance.now();i=window.setInterval(()=>{const u=performance.now()-c+l;e.value=Math.max(t-u,0),e.value<=0&&n()},l)}return ls(n),{clear:n,time:e,start:s,reset:r}}const _ve=We({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...rf({location:"bottom"}),...Oy(),...cs(),...bc(),...wn(),...Ua(Ny({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),CV=vt()({name:"VSnackbar",props:_ve(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const n=Oi(t,"modelValue"),{locationStyles:r}=sf(t),{positionClasses:s}=Dy(t),{scopeId:o}=Np(),{themeClasses:a}=Hn(t),{colorClasses:l,colorStyles:c,variantClasses:u}=tf(t),{roundedClasses:h}=hs(t),d=bve(Number(t.timeout)),f=ge(),m=ge(),g=_t(!1);He(n,p),He(()=>t.timeout,p),ki(()=>{n.value&&p()});let v=-1;function p(){d.reset(),window.clearTimeout(v);const E=Number(t.timeout);if(!n.value||E===-1)return;const T=wv(m.value);d.start(T),v=window.setTimeout(()=>{n.value=!1},E)}function b(){d.reset(),window.clearTimeout(v)}function _(){g.value=!0,b()}function P(){g.value=!1,p()}return Tt(()=>{const E=dc.filterProps(t),T=!!(i.default||i.text||t.text);return w(dc,ht({ref:f,class:["v-snackbar",{"v-snackbar--active":n.value,"v-snackbar--multi-line":t.multiLine&&!t.vertical,"v-snackbar--timer":!!t.timer,"v-snackbar--vertical":t.vertical},s.value,t.class],style:t.style},E,{modelValue:n.value,"onUpdate:modelValue":C=>n.value=C,contentProps:ht({class:["v-snackbar__wrapper",a.value,l.value,h.value,u.value],style:[r.value,c.value],onPointerenter:_,onPointerleave:P},E.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0},o),{default:()=>{var C,M;return[ef(!1,"v-snackbar"),t.timer&&w("div",{key:"timer",class:"v-snackbar__timer"},[w(QU,{ref:m,active:!g.value,color:typeof t.timer=="string"?t.timer:"info",max:t.timeout,"model-value":d.time.value},null)]),T&&w("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((C=i.text)==null?void 0:C.call(i))??t.text,(M=i.default)==null?void 0:M.call(i)]),i.actions&&w(rr,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[w("div",{class:"v-snackbar__actions"},[i.actions()])]})]},activator:i.activator})}),_c({},f)}}),Pve={key:0,class:"_test_nodata"},Eve=["src"],wve={class:"text-truncate"},Tve={class:"constructionItem"},xve=3e3,GW=ri({__name:"ConstructionList",props:{items:{},allowSharing:{type:Boolean}},setup(t){const e=t,i=ge(null),n=ge(null),r=An(),s=Eh(),o=Fp(),a=ge(""),l=ge(""),c=ge(!1),{constructionDocId:u}=Ji(s),{hasUnsavedNodules:h}=Ji(r),{t:d}=qn({useScope:"local"}),{deleteConstruction:f}=_V(),m=Xge();F_("clipboard-read"),F_("clipboard-write");let g=null,v;const p=W(()=>{var D;return((D=o.currentUser)==null?void 0:D.email)??""});function b(D){return D||"/logo.png"}async function _(D){g!==D.id&&(g=D.id,$.fire("preview-construction",D))}function P(){$.fire("preview-construction",null),g=""}function E(D){var O;a.value=D,h.value?(O=i.value)==null||O.show():(u.value=D,T())}function T(){i.value.hide();let D=null,O,F=e.items.findIndex(Z=>Z.id===a.value),X;F>=0?(D=e.items[F].parsedScript,O=e.items[F].sphereRotationMatrix,e.items[F].tools&&(X=e.items[F].tools)):O=new Pt,X===void 0?(console.debug("Include all tools"),s.resetToolset(!0)):(console.debug("Exclude all tools"),s.resetToolset(!1),X.forEach(Z=>{s.includeToolName(Z)})),D!==null&&(r.removeAllFromLayers(),r.init(),Xe.resetAllCounters(),$.fire("show-alert",{key:d("constructionLoaded",{docId:a.value}),type:"info"}),r.setRotationMatrix(O),_C(D),r.clearUnsavedFlag(),$.fire("construction-loaded",{}),r.updateDisplay(),r.setActionMode("move"))}async function C(D){var F;const O=(F=o.currentUser)==null?void 0:F.uid;O?await f(O,D)?$.fire("show-alert",{key:d("constructionDeleted",{docId:D}),type:"success"}):$.fire("show-alert",{key:d("constructionDeleteFailed",{docId:D}),type:"error"}):$.fire("show-alert",{key:d("deleteAttemptNoUid"),type:"error"})}function M(D){c.value=!0,v=setTimeout(()=>{C(D)},3500)}function x(){c.value=!1,clearTimeout(v)}function V(D){var O;l.value=D,(O=n.value)==null||O.show()}function N(){m.copy(`https://easelgeo.app/construction/${l.value}`)}return(D,O)=>(Te(),Ct(mt,null,[tt("div",{onMouseleave:P},[D.items.length===0?(Te(),Ct("span",Pve,"No data")):Vi("",!0),w(Bm,{lines:"three"},{default:U(()=>[(Te(!0),Ct(mt,null,Zs(D.items,F=>(Te(),qe(tve,{key:F.id},{default:U(({isHovering:X,props:Z})=>[w(jo,ht(Z,{class:"_test_constructionItem",onMouseoverCapture:K=>_(F)}),{prepend:U(()=>[tt("img",{src:b(F.preview),class:"mr-1",alt:"preview",width:"64"},null,8,Eve)]),default:U(()=>[w(zW,{class:"text-truncate"},{default:U(()=>[$e(nt(F.description||"N/A"),1)],void 0,!0),_:2},1024),w(FW,null,{default:U(()=>[tt("code",null,nt(F.id.substring(0,5)),1),tt("span",wve,nt(F.objectCount)+" objects, "+nt(F.dateCreated.substring(0,10))+" "+nt(F.author),1)],void 0,!0),_:2},1024),w(ch),w(dc,{contained:"","model-value":X,class:"_test_constructionOverlay align-center justify-center",scrim:"#00007F"},{default:U(()=>[tt("div",Tve,[w(Qt,{id:"_test_loadfab",class:"mx-1",size:"small",color:"secondary",icon:"mdi-file-document-edit",onClick:K=>E(F.id)},null,8,["onClick"]),F.publicDocId?(Te(),qe(Qt,{key:0,id:"_test_sharefab",class:"mx-1",size:"small",color:"secondary",icon:"$shareConstruction",onClick:K=>V(F.publicDocId)},null,8,["onClick"])):Vi("",!0),F.author===p.value?(Te(),qe(Qt,{key:1,id:"_test_deletefab",class:"mx-1",size:"small",icon:"$deleteConstruction",color:"red",onClick:K=>M(F.id)},null,8,["onClick"])):Vi("",!0)])],void 0,!0),_:2},1032,["model-value"])],void 0,!0),_:2},1040,["onMouseoverCapture"])]),_:2},1024))),128))],void 0),_:1})],32),w(xu,{ref_key:"constructionLoadDialog",ref:i,class:"dialog",title:le(d)("confirmationRequired"),"yes-text":"Proceed",yesAction:T,"no-text":"Cancel","max-width":"50%"},{default:U(()=>[$e(nt(le(d)("unsavedObjects")),1)],void 0),_:1},8,["title"]),w(xu,{ref_key:"constructionShareDialog",ref:n,title:le(d)("confirmationRequired"),"yes-text":"Copy URL",yesAction:N,"no-text":"Cancel","max-width":"50%"},{default:U(()=>[$e(nt(le(d)("copyURL",{docId:l.value})),1)],void 0),_:1},8,["title"]),w(CV,{modelValue:c.value,"onUpdate:modelValue":O[0]||(O[0]=F=>c.value=F),location:"top",timeout:xve},{actions:U(()=>[w(Qt,{onClick:x,color:"warning"},{default:U(()=>[$e(nt(le(d)("undo")),1)],void 0,!0),_:1})]),default:U(()=>[$e(nt(le(d)("deleteWarning"))+" ",1)],void 0),_:1},8,["modelValue"])],64))}});function B2(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{deleteWarning:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["You construction ",r(s("docId"))," is about to be deleted"])},deleteAttemptNoUid:i=>{const{normalize:n}=i;return n(["Attempt to delete a construction when owner in unknown"])},constructionDeleted:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Construction ",r(s("docId"))," is succesfully removed"])},constructionDeleteFailed:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Unable to delete construction ",r(s("docId"))])},constructionLoaded:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Construction ",r(s("docId"))," is succesfully loaded to canvas"])},confirmationRequired:i=>{const{normalize:n}=i;return n(["Confirmation Required"])},copyURL:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Copy URL https://easelgeo.app/construction/",r(s("docId"))," to clipboard?"])},unsavedObjects:i=>{const{normalize:n}=i;return n(["Loading a new construction will delete the unsaved work"])},undo:i=>{const{normalize:n}=i;return n(["Undo"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"deleteWarning":"You construction {docId} is about to be deleted","deleteAttemptNoUid":"Attempt to delete a construction when owner in unknown","constructionDeleted":"Construction {docId} is succesfully removed","constructionDeleteFailed":"Unable to delete construction {docId}","constructionLoaded":"Construction {docId} is succesfully loaded to canvas","confirmationRequired":"Confirmation Required","copyURL":"Copy URL https://easelgeo.app/construction/{docId} to clipboard?","unsavedObjects":"Loading a new construction will delete the unsaved work","undo":"Undo"}}'),delete e._Ctor}typeof B2=="function"&&B2(GW);const j2=Tn(GW,[["__scopeId","data-v-6ea76006"]]),kve={class:"pt-2"},HW=ri({__name:"ConstructionLoader",setup(t){const{t:e}=qn(),{publicConstructions:i,privateConstructions:n}=_V(),r=ge([]),s=ge([]),o=ge(""),a=ge("");let l=null;const c=ge(""),u=ge(!1),{idle:h}=Qge(1e3),d=W(()=>(console.debug("displayed private recomputed"),a.value.length>0?r.value:n.value!=null?n.value:[])),f=W(()=>a.value.length>0?s.value:i.value);return He(h,()=>{var m,g;if(!h){o.value="";return}if(l!==a.value&&a.value.length>0){l=a.value,o.value="";const v=[],p=(m=n.value)==null?void 0:m.filter(_=>_.description.toLowerCase().includes(a.value.toLowerCase()));p&&p.length>0&&(v.push("private"),r.value=p);const b=(g=i.value)==null?void 0:g.filter(_=>_.description.toLowerCase().includes(a.value.toLowerCase()));b.length>0&&(v.push("public"),s.value=b),v.length>1?(u.value=!0,c.value=v,o.value=e("foundMultiple",{privateCount:p.length,publicCount:b.length})):(u.value=!1,c.value=v[0],o.value=e("foundSingle",{count:((p==null?void 0:p.length)??0)+b.length,group:v[0]}))}}),(m,g)=>(Te(),Ct("div",kve,[w(vr,{type:"text",modelValue:a.value,"onUpdate:modelValue":g[0]||(g[0]=v=>a.value=v),variant:"outlined",density:"compact",label:le(e)("searchLabel"),hint:o.value,class:"px-2"},null,8,["modelValue","label","hint"]),w(ul,{modelValue:c.value,"onUpdate:modelValue":g[1]||(g[1]=v=>c.value=v),multiple:u.value},{default:U(()=>[le(n)!==null?(Te(),qe(nh,{key:0,value:"private"},{default:U(()=>[w(cc,null,{default:U(()=>[$e(nt(le(e)("privateConstructions")),1)],void 0,!0),_:1}),m.firebaseUid&&m.firebaseUid.length>0?(Te(),qe(gl,{key:0},{default:U(()=>[w(j2,{"allow-sharing":!0,items:d.value},null,8,["items"])],void 0,!0),_:1})):(Te(),qe(gl,{key:1},{default:U(()=>[$e(" Nothing here ")],void 0,!0),_:1}))],void 0,!0),_:1})):Vi("",!0),w(nh,{value:"public"},{default:U(()=>[w(cc,null,{default:U(()=>[$e(nt(le(e)("publicConstructions")),1)],void 0,!0),_:1}),w(gl,null,{default:U(()=>[w(j2,{items:f.value,"allow-sharing":!1},null,8,["items"])],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1},8,["modelValue","multiple"])]))}});function $2(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{constructionDeleted:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Construction ",r(s("docId"))," was successfully removed"])},privateConstructions:i=>{const{normalize:n}=i;return n(["Private Constructions"])},publicConstructions:i=>{const{normalize:n}=i;return n(["Public Constructions"])},failedToDelete:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Unable to delete construction ",r(s("docId"))])},searchLabel:i=>{const{normalize:n}=i;return n(["Search Construction"])},foundMultiple:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Found ",r(s("privateCount"))," private and ",r(s("publicCount"))," public constructions"])},foundSingle:i=>{const{normalize:n,interpolate:r,named:s,plural:o}=i;return o([n(["Found ",r(s("count"))," ",r(s("group"))," construction"]),n(["Found ",r(s("count"))," ",r(s("group"))," constructions"])])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"constructionDeleted":"Construction {docId} was successfully removed","privateConstructions":"Private Constructions","publicConstructions":"Public Constructions","failedToDelete":"Unable to delete construction {docId}","searchLabel":"Search Construction","foundMultiple":"Found {privateCount} private and {publicCount} public constructions","foundSingle":"Found {count} {group} construction | Found {count} {group} constructions"}}'),delete e._Ctor}typeof $2=="function"&&$2(HW);const Cve=Tn(HW,[["__scopeId","data-v-444aa550"]]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Mve(t,e,i,n){function r(s){return s instanceof i?s:new i(function(o){o(s)})}return new(i||(i=Promise))(function(s,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})}var Ave=function t(e,i){if(e===i)return!0;if(e&&i&&typeof e=="object"&&typeof i=="object"){if(e.constructor!==i.constructor)return!1;var n,r,s;if(Array.isArray(e)){if(n=e.length,n!=i.length)return!1;for(r=n;r--!==0;)if(!t(e[r],i[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===i.source&&e.flags===i.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===i.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===i.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(i).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(i,s[r]))return!1;for(r=n;r--!==0;){var o=s[r];if(!t(e[o],i[o]))return!1}return!0}return e!==e&&i!==i};const W2="__googleMapsScriptId";var vm;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(vm||(vm={}));class hd{constructor({apiKey:e,authReferrerPolicy:i,channel:n,client:r,id:s=W2,language:o,libraries:a=[],mapIds:l,nonce:c,region:u,retries:h=3,url:d="https://maps.googleapis.com/maps/api/js",version:f}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=i,this.channel=n,this.client=r,this.id=s||W2,this.language=o,this.libraries=a,this.mapIds=l,this.nonce=c,this.region=u,this.retries=h,this.url=d,this.version=f,hd.instance){if(!Ave(this.options,hd.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(hd.instance.options)}`);return hd.instance}hd.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?vm.FAILURE:this.done?vm.SUCCESS:this.loading?vm.LOADING:vm.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+="?callback=__googleMapsCallback",this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,i)=>{this.loadCallback(n=>{n?i(n.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,i;if(document.getElementById(this.id)){this.callback();return}const n={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(n).forEach(s=>!n[s]&&delete n[s]),!((i=(e=window==null?void 0:window.google)===null||e===void 0?void 0:e.maps)===null||i===void 0)&&i.importLibrary||(s=>{let o,a,l,c="The Google Maps JavaScript API",u="google",h="importLibrary",d="__ib__",f=document,m=window;m=m[u]||(m[u]={});const g=m.maps||(m.maps={}),v=new Set,p=new URLSearchParams,b=()=>o||(o=new Promise((_,P)=>Mve(this,void 0,void 0,function*(){var E;yield a=f.createElement("script"),a.id=this.id,p.set("libraries",[...v]+"");for(l in s)p.set(l.replace(/[A-Z]/g,T=>"_"+T[0].toLowerCase()),s[l]);p.set("callback",u+".maps."+d),a.src=this.url+"?"+p,g[d]=_,a.onerror=()=>o=P(Error(c+" could not load.")),a.nonce=this.nonce||((E=f.querySelector("script[nonce]"))===null||E===void 0?void 0:E.nonce)||"",f.head.append(a)})));g[h]?console.warn(c+" only loads once. Ignoring:",s):g[h]=(_,...P)=>v.add(_)&&b().then(()=>g[h](_,...P))})(n);const r=this.libraries.map(s=>this.importLibrary(s));r.length||r.push(this.importLibrary("core")),Promise.all(r).then(()=>this.callback(),s=>{const o=new ErrorEvent("error",{error:s});this.loadErrorCallback(o)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const i=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${i} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},i)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading||(this.loading=!0,this.setScript())}}}const qW=Symbol.for("vuetify:selection-control-group"),KW=We({color:String,disabled:{type:Boolean,default:null},defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:ji,trueIcon:ji,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:{type:Boolean,default:null},modelValue:null,type:String,valueComparator:{type:Function,default:Jd},...Ut(),...Ba(),...wn()},"SelectionControlGroup"),Vve=We({...KW({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup"),nwe=vt()({name:"VSelectionControlGroup",props:Vve(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const n=Oi(t,"modelValue"),r=Ao(),s=W(()=>t.id||`v-selection-control-group-${r}`),o=W(()=>t.name||s.value),a=new Set;return jn(qW,{modelValue:n,forceUpdate:()=>{a.forEach(l=>l())},onForceUpdate:l=>{a.add(l),ls(()=>{a.delete(l)})}}),Pl({[t.defaultsTarget]:{color:bt(t,"color"),disabled:bt(t,"disabled"),density:bt(t,"density"),error:bt(t,"error"),inline:bt(t,"inline"),modelValue:n,multiple:W(()=>!!t.multiple||t.multiple==null&&Array.isArray(n.value)),name:o,falseIcon:bt(t,"falseIcon"),trueIcon:bt(t,"trueIcon"),readonly:bt(t,"readonly"),ripple:bt(t,"ripple"),type:bt(t,"type"),valueComparator:bt(t,"valueComparator")}}),Tt(()=>{var l;return w("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":t.inline},t.class],style:t.style,role:t.type==="radio"?"radiogroup":void 0},[(l=i.default)==null?void 0:l.call(i)])}),{}}}),MV=We({label:String,baseColor:String,trueValue:null,falseValue:null,value:null,...Ut(),...KW()},"VSelectionControl");function Lve(t){const e=xi(qW,void 0),{densityClasses:i}=wl(t),n=Oi(t,"modelValue"),r=W(()=>t.trueValue!==void 0?t.trueValue:t.value!==void 0?t.value:!0),s=W(()=>t.falseValue!==void 0?t.falseValue:!1),o=W(()=>!!t.multiple||t.multiple==null&&Array.isArray(n.value)),a=W({get(){const f=e?e.modelValue.value:n.value;return o.value?Aa(f).some(m=>t.valueComparator(m,r.value)):t.valueComparator(f,r.value)},set(f){if(t.readonly)return;const m=f?r.value:s.value;let g=m;o.value&&(g=f?[...Aa(n.value),m]:Aa(n.value).filter(v=>!t.valueComparator(v,r.value))),e?e.modelValue.value=g:n.value=g}}),{textColorClasses:l,textColorStyles:c}=ko(W(()=>{if(!(t.error||t.disabled))return a.value?t.color:t.baseColor})),{backgroundColorClasses:u,backgroundColorStyles:h}=Cs(W(()=>a.value&&!t.error&&!t.disabled?t.color:void 0)),d=W(()=>a.value?t.trueIcon:t.falseIcon);return{group:e,densityClasses:i,trueValue:r,falseValue:s,model:a,textColorClasses:l,textColorStyles:c,backgroundColorClasses:u,backgroundColorStyles:h,icon:d}}const z_=vt()({name:"VSelectionControl",directives:{Ripple:of},inheritAttrs:!1,props:MV(),emits:{"update:modelValue":t=>!0},setup(t,e){let{attrs:i,slots:n}=e;const{group:r,densityClasses:s,icon:o,model:a,textColorClasses:l,textColorStyles:c,backgroundColorClasses:u,backgroundColorStyles:h,trueValue:d}=Lve(t),f=Ao(),m=_t(!1),g=_t(!1),v=ge(),p=W(()=>t.id||`input-${f}`),b=W(()=>!t.disabled&&!t.readonly);r==null||r.onForceUpdate(()=>{v.value&&(v.value.checked=a.value)});function _(C){b.value&&(m.value=!0,Xm(C.target,":focus-visible")!==!1&&(g.value=!0))}function P(){m.value=!1,g.value=!1}function E(C){C.stopPropagation()}function T(C){b.value&&(t.readonly&&r&&vn(()=>r.forceUpdate()),a.value=C.target.checked)}return Tt(()=>{var N,D;const C=n.label?n.label({label:t.label,props:{for:p.value}}):t.label,[M,x]=Cy(i),V=w("input",ht({ref:v,checked:a.value,disabled:!!t.disabled,id:p.value,onBlur:P,onFocus:_,onInput:T,"aria-disabled":!!t.disabled,type:t.type,value:d.value,name:t.name,"aria-checked":t.type==="checkbox"?a.value:void 0},x),null);return w("div",ht({class:["v-selection-control",{"v-selection-control--dirty":a.value,"v-selection-control--disabled":t.disabled,"v-selection-control--error":t.error,"v-selection-control--focused":m.value,"v-selection-control--focus-visible":g.value,"v-selection-control--inline":t.inline},s.value,t.class]},M,{style:t.style}),[w("div",{class:["v-selection-control__wrapper",l.value],style:c.value},[(N=n.default)==null?void 0:N.call(n,{backgroundColorClasses:u,backgroundColorStyles:h}),fi(w("div",{class:["v-selection-control__input"]},[((D=n.input)==null?void 0:D.call(n,{model:a,textColorClasses:l,textColorStyles:c,backgroundColorClasses:u,backgroundColorStyles:h,inputNode:V,icon:o.value,props:{onFocus:_,onBlur:P,id:p.value}}))??w(mt,null,[o.value&&w(lt,{key:"icon",icon:o.value},null),V])]),[[Mo("ripple"),t.ripple&&[!t.disabled&&!t.readonly,null,["center","circle"]]]])]),C&&w(RP,{for:p.value,onClick:E},{default:()=>[C]})])}),{isFocused:m,input:v}}}),XW=We({indeterminate:Boolean,indeterminateIcon:{type:ji,default:"$checkboxIndeterminate"},...MV({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),U_=vt()({name:"VCheckboxBtn",props:XW(),emits:{"update:modelValue":t=>!0,"update:indeterminate":t=>!0},setup(t,e){let{slots:i}=e;const n=Oi(t,"indeterminate"),r=Oi(t,"modelValue");function s(l){n.value&&(n.value=!1)}const o=W(()=>n.value?t.indeterminateIcon:t.falseIcon),a=W(()=>n.value?t.indeterminateIcon:t.trueIcon);return Tt(()=>{const l=Ua(z_.filterProps(t),["modelValue"]);return w(z_,ht(l,{modelValue:r.value,"onUpdate:modelValue":[c=>r.value=c,s],class:["v-checkbox-btn",t.class],style:t.style,type:"checkbox",falseIcon:o.value,trueIcon:a.value,"aria-checked":n.value?"mixed":void 0}),i)}),{}}}),Ive=We({...df(),...Ua(XW(),["inline"])},"VCheckbox"),Py=vt()({name:"VCheckbox",inheritAttrs:!1,props:Ive(),emits:{"update:modelValue":t=>!0,"update:focused":t=>!0},setup(t,e){let{attrs:i,slots:n}=e;const r=Oi(t,"modelValue"),{isFocused:s,focus:o,blur:a}=uf(t),l=Ao(),c=W(()=>t.id||`checkbox-${l}`);return Tt(()=>{const[u,h]=Cy(i),d=za.filterProps(t),f=U_.filterProps(t);return w(za,ht({class:["v-checkbox",t.class]},u,d,{modelValue:r.value,"onUpdate:modelValue":m=>r.value=m,id:c.value,focused:s.value,style:t.style}),{...n,default:m=>{let{id:g,messagesId:v,isDisabled:p,isReadonly:b}=m;return w(U_,ht(f,{id:g.value,"aria-describedby":v.value,disabled:p.value,readonly:b.value},h,{modelValue:r.value,"onUpdate:modelValue":_=>r.value=_,onFocus:o,onBlur:a}),n)}})}),{}}});function G2(t){const i=Math.abs(t);return Math.sign(t)*(i/((1/.501-2)*(1-i)+1))}function H2(t){let{selectedElement:e,containerSize:i,contentSize:n,isRtl:r,currentScrollOffset:s,isHorizontal:o}=t;const a=o?e.clientWidth:e.clientHeight,l=o?e.offsetLeft:e.offsetTop,c=r&&o?n-l-a:l,u=i+s,h=a+c,d=a*.4;return c<=s?s=Math.max(c-d,0):u<=h&&(s=Math.min(s-(u-h-d),n-i)),s}function Ove(t){let{selectedElement:e,containerSize:i,contentSize:n,isRtl:r,isHorizontal:s}=t;const o=s?e.clientWidth:e.clientHeight,a=s?e.offsetLeft:e.offsetTop,l=r&&s?n-a-o/2-i/2:a+o/2-i/2;return Math.min(n-i,Math.max(0,l))}const Dve=Symbol.for("vuetify:v-slide-group"),AV=We({centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:Dve},nextIcon:{type:ji,default:"$next"},prevIcon:{type:ji,default:"$prev"},showArrows:{type:[Boolean,String],validator:t=>typeof t=="boolean"||["always","desktop","mobile"].includes(t)},...Ut(),...wB(),...pn(),...My({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),B_=vt()({name:"VSlideGroup",props:AV(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const{isRtl:n}=io(),{displayClasses:r,mobile:s}=Dp(t),o=Ip(t,t.symbol),a=_t(!1),l=_t(0),c=_t(0),u=_t(0),h=W(()=>t.direction==="horizontal"),{resizeRef:d,contentRect:f}=Rd(),{resizeRef:m,contentRect:g}=Rd(),v=W(()=>o.selected.value.length?o.items.value.findIndex(ne=>ne.id===o.selected.value[0]):-1),p=W(()=>o.selected.value.length?o.items.value.findIndex(ne=>ne.id===o.selected.value[o.selected.value.length-1]):-1);if(un){let ne=-1;He(()=>[o.selected.value,f.value,g.value,h.value],()=>{cancelAnimationFrame(ne),ne=requestAnimationFrame(()=>{if(f.value&&g.value){const B=h.value?"width":"height";c.value=f.value[B],u.value=g.value[B],a.value=c.value+1<u.value}if(v.value>=0&&m.value){const B=m.value.children[p.value];v.value===0||!a.value?l.value=0:t.centerActive?l.value=Ove({selectedElement:B,containerSize:c.value,contentSize:u.value,isRtl:n.value,isHorizontal:h.value}):a.value&&(l.value=H2({selectedElement:B,containerSize:c.value,contentSize:u.value,isRtl:n.value,currentScrollOffset:l.value,isHorizontal:h.value}))}})})}const b=_t(!1);let _=0,P=0;function E(ne){const B=h.value?"clientX":"clientY";P=(n.value&&h.value?-1:1)*l.value,_=ne.touches[0][B],b.value=!0}function T(ne){if(!a.value)return;const B=h.value?"clientX":"clientY",Q=n.value&&h.value?-1:1;l.value=Q*(P+_-ne.touches[0][B])}function C(ne){const B=u.value-c.value;l.value<0||!a.value?l.value=0:l.value>=B&&(l.value=B),b.value=!1}function M(){d.value&&(d.value[h.value?"scrollLeft":"scrollTop"]=0)}const x=_t(!1);function V(ne){if(x.value=!0,!(!a.value||!m.value)){for(const B of ne.composedPath())for(const Q of m.value.children)if(Q===B){l.value=H2({selectedElement:Q,containerSize:c.value,contentSize:u.value,isRtl:n.value,currentScrollOffset:l.value,isHorizontal:h.value});return}}}function N(ne){x.value=!1}function D(ne){var B;!x.value&&!(ne.relatedTarget&&((B=m.value)!=null&&B.contains(ne.relatedTarget)))&&F()}function O(ne){m.value&&(h.value?ne.key==="ArrowRight"?F(n.value?"prev":"next"):ne.key==="ArrowLeft"&&F(n.value?"next":"prev"):ne.key==="ArrowDown"?F("next"):ne.key==="ArrowUp"&&F("prev"),ne.key==="Home"?F("first"):ne.key==="End"&&F("last"))}function F(ne){var B,Q,fe,ie,se;if(m.value)if(!ne)(B=Tv(m.value)[0])==null||B.focus();else if(ne==="next"){const ee=(Q=m.value.querySelector(":focus"))==null?void 0:Q.nextElementSibling;ee?ee.focus():F("first")}else if(ne==="prev"){const ee=(fe=m.value.querySelector(":focus"))==null?void 0:fe.previousElementSibling;ee?ee.focus():F("last")}else ne==="first"?(ie=m.value.firstElementChild)==null||ie.focus():ne==="last"&&((se=m.value.lastElementChild)==null||se.focus())}function X(ne){const B=l.value+(ne==="prev"?-1:1)*c.value;l.value=So(B,0,u.value-c.value)}const Z=W(()=>{let ne=l.value>u.value-c.value?-(u.value-c.value)+G2(u.value-c.value-l.value):-l.value;l.value<=0&&(ne=G2(-l.value));const B=n.value&&h.value?-1:1;return{transform:`translate${h.value?"X":"Y"}(${B*ne}px)`,transition:b.value?"none":"",willChange:b.value?"transform":""}}),K=W(()=>({next:o.next,prev:o.prev,select:o.select,isSelected:o.isSelected})),z=W(()=>{switch(t.showArrows){case"always":return!0;case"desktop":return!s.value;case!0:return a.value||Math.abs(l.value)>0;case"mobile":return s.value||a.value||Math.abs(l.value)>0;default:return!s.value&&(a.value||Math.abs(l.value)>0)}}),H=W(()=>Math.abs(l.value)>0),re=W(()=>u.value>Math.abs(l.value)+c.value);return Tt(()=>w(t.tag,{class:["v-slide-group",{"v-slide-group--vertical":!h.value,"v-slide-group--has-affixes":z.value,"v-slide-group--is-overflowing":a.value},r.value,t.class],style:t.style,tabindex:x.value||o.selected.value.length?-1:0,onFocus:D},{default:()=>{var ne,B,Q;return[z.value&&w("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!H.value}],onClick:()=>H.value&&X("prev")},[((ne=i.prev)==null?void 0:ne.call(i,K.value))??w(wI,null,{default:()=>[w(lt,{icon:n.value?t.nextIcon:t.prevIcon},null)]})]),w("div",{key:"container",ref:d,class:"v-slide-group__container",onScroll:M},[w("div",{ref:m,class:"v-slide-group__content",style:Z.value,onTouchstartPassive:E,onTouchmovePassive:T,onTouchendPassive:C,onFocusin:V,onFocusout:N,onKeydown:O},[(B=i.default)==null?void 0:B.call(i,K.value)])]),z.value&&w("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!re.value}],onClick:()=>re.value&&X("next")},[((Q=i.next)==null?void 0:Q.call(i,K.value))??w(wI,null,{default:()=>[w(lt,{icon:n.value?t.prevIcon:t.nextIcon},null)]})])]}})),{selected:o.selected,scrollTo:X,scrollOffset:l,focus:F}}}),YW=Symbol.for("vuetify:v-chip-group"),Nve=We({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:Jd},...AV(),...Ut(),...My({selectedClass:"v-chip--selected"}),...pn(),...wn(),...bc({variant:"tonal"})},"VChipGroup");vt()({name:"VChipGroup",props:Nve(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const{themeClasses:n}=Hn(t),{isSelected:r,select:s,next:o,prev:a,selected:l}=Ip(t,YW);return Pl({VChip:{color:bt(t,"color"),disabled:bt(t,"disabled"),filter:bt(t,"filter"),variant:bt(t,"variant")}}),Tt(()=>{const c=B_.filterProps(t);return w(B_,ht(c,{class:["v-chip-group",{"v-chip-group--column":t.column},n.value,t.class],style:t.style}),{default:()=>{var u;return[(u=i.default)==null?void 0:u.call(i,{isSelected:r,select:s,next:o,prev:a,selected:l.value})]}})}),{}}});const Rve=We({activeClass:String,appendAvatar:String,appendIcon:ji,closable:Boolean,closeIcon:{type:ji,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:ji,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:pl(),onClickOnce:pl(),...Lu(),...Ut(),...Ba(),...Tl(),...Ay(),...cs(),...pP(),...Ly(),...pn({tag:"span"}),...wn(),...bc({variant:"tonal"})},"VChip"),ZW=vt()({name:"VChip",directives:{Ripple:of},props:Rve(),emits:{"click:close":t=>!0,"update:modelValue":t=>!0,"group:selected":t=>!0,click:t=>!0},setup(t,e){let{attrs:i,emit:n,slots:r}=e;const{t:s}=nf(),{borderClasses:o}=Iu(t),{colorClasses:a,colorStyles:l,variantClasses:c}=tf(t),{densityClasses:u}=wl(t),{elevationClasses:h}=xl(t),{roundedClasses:d}=hs(t),{sizeClasses:f}=Iy(t),{themeClasses:m}=Hn(t),g=Oi(t,"modelValue"),v=Vy(t,YW,!1),p=mP(t,i),b=W(()=>t.link!==!1&&p.isLink.value),_=W(()=>!t.disabled&&t.link!==!1&&(!!v||t.link||p.isClickable.value)),P=W(()=>({"aria-label":s(t.closeLabel),onClick(C){C.stopPropagation(),g.value=!1,n("click:close",C)}}));function E(C){var M;n("click",C),_.value&&((M=p.navigate)==null||M.call(p,C),v==null||v.toggle())}function T(C){(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),E(C))}return()=>{const C=p.isLink.value?"a":t.tag,M=!!(t.appendIcon||t.appendAvatar),x=!!(M||r.append),V=!!(r.close||t.closable),N=!!(r.filter||t.filter)&&v,D=!!(t.prependIcon||t.prependAvatar),O=!!(D||r.prepend),F=!v||v.isSelected.value;return g.value&&fi(w(C,{class:["v-chip",{"v-chip--disabled":t.disabled,"v-chip--label":t.label,"v-chip--link":_.value,"v-chip--filter":N,"v-chip--pill":t.pill},m.value,o.value,F?a.value:void 0,u.value,h.value,d.value,f.value,c.value,v==null?void 0:v.selectedClass.value,t.class],style:[F?l.value:void 0,t.style],disabled:t.disabled||void 0,draggable:t.draggable,href:p.href.value,tabindex:_.value?0:void 0,onClick:E,onKeydown:_.value&&!b.value&&T},{default:()=>{var X;return[ef(_.value,"v-chip"),N&&w(yB,{key:"filter"},{default:()=>[fi(w("div",{class:"v-chip__filter"},[r.filter?w(rr,{key:"filter-defaults",disabled:!t.filterIcon,defaults:{VIcon:{icon:t.filterIcon}}},r.filter):w(lt,{key:"filter-icon",icon:t.filterIcon},null)]),[[ln,v.isSelected.value]])]}),O&&w("div",{key:"prepend",class:"v-chip__prepend"},[r.prepend?w(rr,{key:"prepend-defaults",disabled:!D,defaults:{VAvatar:{image:t.prependAvatar,start:!0},VIcon:{icon:t.prependIcon,start:!0}}},r.prepend):w(mt,null,[t.prependIcon&&w(lt,{key:"prepend-icon",icon:t.prependIcon,start:!0},null),t.prependAvatar&&w(ah,{key:"prepend-avatar",image:t.prependAvatar,start:!0},null)])]),w("div",{class:"v-chip__content"},[((X=r.default)==null?void 0:X.call(r,{isSelected:v==null?void 0:v.isSelected.value,selectedClass:v==null?void 0:v.selectedClass.value,select:v==null?void 0:v.select,toggle:v==null?void 0:v.toggle,value:v==null?void 0:v.value.value,disabled:t.disabled}))??t.text]),x&&w("div",{key:"append",class:"v-chip__append"},[r.append?w(rr,{key:"append-defaults",disabled:!M,defaults:{VAvatar:{end:!0,image:t.appendAvatar},VIcon:{end:!0,icon:t.appendIcon}}},r.append):w(mt,null,[t.appendIcon&&w(lt,{key:"append-icon",end:!0,icon:t.appendIcon},null),t.appendAvatar&&w(ah,{key:"append-avatar",end:!0,image:t.appendAvatar},null)])]),V&&w("button",ht({key:"close",class:"v-chip__close",type:"button"},P.value),[r.close?w(rr,{key:"close-defaults",defaults:{VIcon:{icon:t.closeIcon,size:"x-small"}}},r.close):w(lt,{key:"close-icon",icon:t.closeIcon,size:"x-small"},null)])]}}),[[Mo("ripple"),_.value&&t.ripple,null]])}}});const Fve=We({id:String,...Ua(Ny({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:fM}}),["absolute"])},"VMenu"),Ep=vt()({name:"VMenu",props:Fve(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const n=Oi(t,"modelValue"),{scopeId:r}=Np(),s=Ao(),o=W(()=>t.id||`v-menu-${s}`),a=ge(),l=xi(uk,null),c=_t(0);jn(uk,{register(){++c.value},unregister(){--c.value},closeParents(){setTimeout(()=>{c.value||(n.value=!1,l==null||l.closeParents())},40)}});async function u(g){var b,_,P;const v=g.relatedTarget,p=g.target;await vn(),n.value&&v!==p&&((b=a.value)!=null&&b.contentEl)&&((_=a.value)!=null&&_.globalTop)&&![document,a.value.contentEl].includes(p)&&!a.value.contentEl.contains(p)&&((P=Tv(a.value.contentEl)[0])==null||P.focus())}He(n,g=>{g?(l==null||l.register(),document.addEventListener("focusin",u,{once:!0})):(l==null||l.unregister(),document.removeEventListener("focusin",u))});function h(){l==null||l.closeParents()}function d(g){var v,p,b;t.disabled||g.key==="Tab"&&(xU(Tv((v=a.value)==null?void 0:v.contentEl,!1),g.shiftKey?"prev":"next",P=>P.tabIndex>=0)||(n.value=!1,(b=(p=a.value)==null?void 0:p.activatorEl)==null||b.focus()))}function f(g){var p;if(t.disabled)return;const v=(p=a.value)==null?void 0:p.contentEl;v&&n.value?g.key==="ArrowDown"?(g.preventDefault(),W0(v,"next")):g.key==="ArrowUp"&&(g.preventDefault(),W0(v,"prev")):["ArrowDown","ArrowUp"].includes(g.key)&&(n.value=!0,g.preventDefault(),setTimeout(()=>setTimeout(()=>f(g))))}const m=W(()=>ht({"aria-haspopup":"menu","aria-expanded":String(n.value),"aria-owns":o.value,onKeydown:f},t.activatorProps));return Tt(()=>{const g=dc.filterProps(t);return w(dc,ht({ref:a,id:o.value,class:["v-menu",t.class],style:t.style},g,{modelValue:n.value,"onUpdate:modelValue":v=>n.value=v,absolute:!0,activatorProps:m.value,"onClick:outside":h,onKeydown:d},r),{activator:i.activator,default:function(){for(var v=arguments.length,p=new Array(v),b=0;b<v;b++)p[b]=arguments[b];return w(rr,{root:"VMenu"},{default:()=>{var _;return[(_=i.default)==null?void 0:_.call(i,...p)]}})}})}),_c({id:o,openChildren:c},a)}});const zve=We({renderless:Boolean,...Ut()},"VVirtualScrollItem"),Uve=vt()({name:"VVirtualScrollItem",inheritAttrs:!1,props:zve(),emits:{"update:height":t=>!0},setup(t,e){let{attrs:i,emit:n,slots:r}=e;const{resizeRef:s,contentRect:o}=Rd(void 0,"border");He(()=>{var a;return(a=o.value)==null?void 0:a.height},a=>{a!=null&&n("update:height",a)}),Tt(()=>{var a,l;return t.renderless?w(mt,null,[(a=r.default)==null?void 0:a.call(r,{itemRef:s})]):w("div",ht({ref:s,class:["v-virtual-scroll__item",t.class],style:t.style},i),[(l=r.default)==null?void 0:l.call(r)])})}}),Bve=-1,jve=1,yx=100,$ve=We({itemHeight:{type:[Number,String],default:null},height:[Number,String]},"virtual");function Wve(t,e){const i=Dp(),n=_t(0);Oa(()=>{n.value=parseFloat(t.itemHeight||0)});const r=_t(0),s=_t(Math.ceil((parseInt(t.height)||i.height.value)/(n.value||16))||1),o=_t(0),a=_t(0),l=ge(),c=ge();let u=0;const{resizeRef:h,contentRect:d}=Rd();Oa(()=>{h.value=l.value});const f=W(()=>{var H;return l.value===document.documentElement?i.height.value:((H=d.value)==null?void 0:H.height)||parseInt(t.height)||0}),m=W(()=>!!(l.value&&c.value&&f.value&&n.value));let g=Array.from({length:e.value.length}),v=Array.from({length:e.value.length});const p=_t(0);let b=-1;function _(H){return g[H]||n.value}const P=X9(()=>{const H=performance.now();v[0]=0;const re=e.value.length;for(let ne=1;ne<=re-1;ne++)v[ne]=(v[ne-1]||0)+_(ne-1);p.value=Math.max(p.value,performance.now()-H)},p),E=He(m,H=>{H&&(E(),u=c.value.offsetTop,P.immediate(),X(),~b&&vn(()=>{un&&window.requestAnimationFrame(()=>{K(b),b=-1})}))});He(f,(H,re)=>{re&&X()}),ls(()=>{P.clear()});function T(H,re){const ne=g[H],B=n.value;n.value=B?Math.min(n.value,re):re,(ne!==re||B!==n.value)&&(g[H]=re,P())}function C(H){return H=So(H,0,e.value.length-1),v[H]||0}function M(H){return Gve(v,H)}let x=0,V=0,N=0;function D(){if(!l.value||!c.value)return;const H=l.value.scrollTop,re=performance.now();re-N>500?(V=Math.sign(H-x),u=c.value.offsetTop):V=H-x,x=H,N=re,X()}function O(){!l.value||!c.value||(V=0,N=0,X())}let F=-1;function X(){cancelAnimationFrame(F),F=requestAnimationFrame(Z)}function Z(){if(!l.value||!f.value)return;const H=x-u,re=Math.sign(V),ne=Math.max(0,H-yx),B=So(M(ne),0,e.value.length),Q=H+f.value+yx,fe=So(M(Q)+1,B+1,e.value.length);if((re!==Bve||B<r.value)&&(re!==jve||fe>s.value)){const ie=C(r.value)-C(B),se=C(fe)-C(s.value);Math.max(ie,se)>yx?(r.value=B,s.value=fe):(B<=0&&(r.value=B),fe>=e.value.length&&(s.value=fe))}o.value=C(r.value),a.value=C(e.value.length)-C(s.value)}function K(H){const re=C(H);!l.value||H&&!re?b=H:l.value.scrollTop=re}const z=W(()=>e.value.slice(r.value,s.value).map((H,re)=>({raw:H,index:re+r.value})));return He(e,()=>{g=Array.from({length:e.value.length}),v=Array.from({length:e.value.length}),P.immediate(),X()},{deep:!0}),{containerRef:l,markerRef:c,computedItems:z,paddingTop:o,paddingBottom:a,scrollToIndex:K,handleScroll:D,handleScrollend:O,handleItemResize:T}}function Gve(t,e){let i=t.length-1,n=0,r=0,s=null,o=-1;if(t[i]<e)return i;for(;n<=i;)if(r=n+i>>1,s=t[r],s>e)i=r-1;else if(s<e)o=r,n=r+1;else return s===e?r:n;return o}const Hve=We({items:{type:Array,default:()=>[]},renderless:Boolean,...$ve(),...Ut(),...bh()},"VVirtualScroll"),JW=vt()({name:"VVirtualScroll",props:Hve(),setup(t,e){let{slots:i}=e;const n=br("VVirtualScroll"),{dimensionStyles:r}=_h(t),{containerRef:s,markerRef:o,handleScroll:a,handleScrollend:l,handleItemResize:c,scrollToIndex:u,paddingTop:h,paddingBottom:d,computedItems:f}=Wve(t,bt(t,"items"));return ec(()=>t.renderless,()=>{function m(){var p,b;const v=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?"addEventListener":"removeEventListener";s.value===document.documentElement?(document[v]("scroll",a,{passive:!0}),document[v]("scrollend",l)):((p=s.value)==null||p[v]("scroll",a,{passive:!0}),(b=s.value)==null||b[v]("scrollend",l))}ki(()=>{s.value=jU(n.vnode.el,!0),m(!0)}),ls(m)}),Tt(()=>{const m=f.value.map(g=>w(Uve,{key:g.index,renderless:t.renderless,"onUpdate:height":v=>c(g.index,v)},{default:v=>{var p;return(p=i.default)==null?void 0:p.call(i,{item:g.raw,index:g.index,...v})}}));return t.renderless?w(mt,null,[w("div",{ref:o,class:"v-virtual-scroll__spacer",style:{paddingTop:Lt(h.value)}},null),m,w("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:Lt(d.value)}},null)]):w("div",{ref:s,class:["v-virtual-scroll",t.class],onScrollPassive:a,onScrollend:l,style:[r.value,t.style]},[w("div",{ref:o,class:"v-virtual-scroll__container",style:{paddingTop:Lt(h.value),paddingBottom:Lt(d.value)}},[m])])}),{scrollToIndex:u}}});function QW(t,e){const i=_t(!1);let n;function r(a){cancelAnimationFrame(n),i.value=!0,n=requestAnimationFrame(()=>{n=requestAnimationFrame(()=>{i.value=!1})})}async function s(){await new Promise(a=>requestAnimationFrame(a)),await new Promise(a=>requestAnimationFrame(a)),await new Promise(a=>requestAnimationFrame(a)),await new Promise(a=>{if(i.value){const l=He(i,()=>{l(),a()})}else a()})}async function o(a){var u,h;if(a.key==="Tab"&&((u=e.value)==null||u.focus()),!["PageDown","PageUp","Home","End"].includes(a.key))return;const l=(h=t.value)==null?void 0:h.$el;if(!l)return;(a.key==="Home"||a.key==="End")&&l.scrollTo({top:a.key==="Home"?0:l.scrollHeight,behavior:"smooth"}),await s();const c=l.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(a.key==="PageDown"||a.key==="Home"){const d=l.getBoundingClientRect().top;for(const f of c)if(f.getBoundingClientRect().top>=d){f.focus();break}}else{const d=l.getBoundingClientRect().bottom;for(const f of[...c].reverse())if(f.getBoundingClientRect().bottom<=d){f.focus();break}}}return{onListScroll:r,onListKeydown:o}}const eG=We({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:ji,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...BW({itemChildren:!1})},"Select"),qve=We({...eG(),...Ua(nA({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...af({transition:{component:fM}})},"VSelect"),ym=vt()({name:"VSelect",props:qve(),emits:{"update:focused":t=>!0,"update:modelValue":t=>!0,"update:menu":t=>!0},setup(t,e){let{slots:i}=e;const{t:n}=nf(),r=ge(),s=ge(),o=ge(),a=Oi(t,"menu"),l=W({get:()=>a.value,set:z=>{var H;a.value&&!z&&((H=s.value)!=null&&H.openChildren)||(a.value=z)}}),{items:c,transformIn:u,transformOut:h}=$W(t),d=Oi(t,"modelValue",[],z=>u(z===null?[null]:Aa(z)),z=>{const H=h(z);return t.multiple?H:H[0]??null}),f=W(()=>typeof t.counterValue=="function"?t.counterValue(d.value):typeof t.counterValue=="number"?t.counterValue:d.value.length),m=iA(),g=W(()=>d.value.map(z=>z.value)),v=_t(!1),p=W(()=>l.value?t.closeText:t.openText);let b="",_;const P=W(()=>t.hideSelected?c.value.filter(z=>!d.value.some(H=>H===z)):c.value),E=W(()=>t.hideNoData&&!P.value.length||t.readonly||(m==null?void 0:m.isReadonly.value)),T=W(()=>{var z;return{...t.menuProps,activatorProps:{...((z=t.menuProps)==null?void 0:z.activatorProps)||{},"aria-haspopup":"listbox"}}}),C=ge(),{onListScroll:M,onListKeydown:x}=QW(C,r);function V(z){t.openOnClear&&(l.value=!0)}function N(){E.value||(l.value=!l.value)}function D(z){var Q,fe;if(!z.key||t.readonly||m!=null&&m.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(z.key)&&z.preventDefault(),["Enter","ArrowDown"," "].includes(z.key)&&(l.value=!0),["Escape","Tab"].includes(z.key)&&(l.value=!1),z.key==="Home"?(Q=C.value)==null||Q.focus("first"):z.key==="End"&&((fe=C.value)==null||fe.focus("last"));const H=1e3;function re(ie){const se=ie.key.length===1,ee=!ie.ctrlKey&&!ie.metaKey&&!ie.altKey;return se&&ee}if(t.multiple||!re(z))return;const ne=performance.now();ne-_>H&&(b=""),b+=z.key.toLowerCase(),_=ne;const B=c.value.find(ie=>ie.title.toLowerCase().startsWith(b));B!==void 0&&(d.value=[B])}function O(z){if(t.multiple){const H=d.value.findIndex(re=>t.valueComparator(re.value,z.value));if(H===-1)d.value=[...d.value,z];else{const re=[...d.value];re.splice(H,1),d.value=re}}else d.value=[z],l.value=!1}function F(z){var H;(H=C.value)!=null&&H.$el.contains(z.relatedTarget)||(l.value=!1)}function X(){var z;v.value&&((z=r.value)==null||z.focus())}function Z(z){v.value=!0}function K(z){if(z==null)d.value=[];else if(Xm(r.value,":autofill")||Xm(r.value,":-webkit-autofill")){const H=c.value.find(re=>re.title===z);H&&O(H)}else r.value&&(r.value.value="")}return He(l,()=>{if(!t.hideSelected&&l.value&&d.value.length){const z=P.value.findIndex(H=>d.value.some(re=>t.valueComparator(re.value,H.value)));un&&window.requestAnimationFrame(()=>{var H;z>=0&&((H=o.value)==null||H.scrollToIndex(z))})}}),He(P,(z,H)=>{v.value&&(!z.length&&t.hideNoData&&(l.value=!1),!H.length&&z.length&&(l.value=!0))}),Tt(()=>{const z=!!(t.chips||i.chip),H=!!(!t.hideNoData||P.value.length||i["prepend-item"]||i["append-item"]||i["no-data"]),re=d.value.length>0,ne=vr.filterProps(t),B=re||!v.value&&t.label&&!t.persistentPlaceholder?void 0:t.placeholder;return w(vr,ht({ref:r},ne,{modelValue:d.value.map(Q=>Q.props.value).join(", "),"onUpdate:modelValue":K,focused:v.value,"onUpdate:focused":Q=>v.value=Q,validationValue:d.externalValue,counterValue:f.value,dirty:re,class:["v-select",{"v-select--active-menu":l.value,"v-select--chips":!!t.chips,[`v-select--${t.multiple?"multiple":"single"}`]:!0,"v-select--selected":d.value.length,"v-select--selection-slot":!!i.selection},t.class],style:t.style,inputmode:"none",placeholder:B,"onClick:clear":V,"onMousedown:control":N,onBlur:F,onKeydown:D,"aria-label":n(p.value),title:n(p.value)}),{...i,default:()=>w(mt,null,[w(Ep,ht({ref:s,modelValue:l.value,"onUpdate:modelValue":Q=>l.value=Q,activator:"parent",contentClass:"v-select__content",disabled:E.value,eager:t.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:t.transition,onAfterLeave:X},T.value),{default:()=>[H&&w(Bm,ht({ref:C,selected:g.value,selectStrategy:t.multiple?"independent":"single-independent",onMousedown:Q=>Q.preventDefault(),onKeydown:x,onFocusin:Z,onScrollPassive:M,tabindex:"-1","aria-live":"polite",color:t.itemColor??t.color},t.listProps),{default:()=>{var Q,fe,ie;return[(Q=i["prepend-item"])==null?void 0:Q.call(i),!P.value.length&&!t.hideNoData&&(((fe=i["no-data"])==null?void 0:fe.call(i))??w(jo,{title:n(t.noDataText)},null)),w(JW,{ref:o,renderless:!0,items:P.value},{default:se=>{var he;let{item:ee,index:de,itemRef:Y}=se;const te=ht(ee.props,{ref:Y,key:de,onClick:()=>O(ee)});return((he=i.item)==null?void 0:he.call(i,{item:ee,index:de,props:te}))??w(jo,ht(te,{role:"option"}),{prepend:ae=>{let{isSelected:A}=ae;return w(mt,null,[t.multiple&&!t.hideSelected?w(U_,{key:ee.value,modelValue:A,ripple:!1,tabindex:"-1"},null):void 0,ee.props.prependAvatar&&w(ah,{image:ee.props.prependAvatar},null),ee.props.prependIcon&&w(lt,{icon:ee.props.prependIcon},null)])}})}}),(ie=i["append-item"])==null?void 0:ie.call(i)]}})]}),d.value.map((Q,fe)=>{function ie(Y){Y.stopPropagation(),Y.preventDefault(),O(Q)}const se={"onClick:close":ie,onMousedown(Y){Y.preventDefault(),Y.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},ee=z?!!i.chip:!!i.selection,de=ee?nM(z?i.chip({item:Q,index:fe,props:se}):i.selection({item:Q,index:fe})):void 0;if(!(ee&&!de))return w("div",{key:Q.value,class:"v-select__selection"},[z?i.chip?w(rr,{key:"chip-defaults",defaults:{VChip:{closable:t.closableChips,size:"small",text:Q.title}}},{default:()=>[de]}):w(ZW,ht({key:"chip",closable:t.closableChips,size:"small",text:Q.title,disabled:Q.props.disabled},se),null):de??w("span",{class:"v-select__selection-text"},[Q.title,t.multiple&&fe<d.value.length-1&&w("span",{class:"v-select__selection-comma"},[$e(",")])])])})]),"append-inner":function(){var se;for(var Q=arguments.length,fe=new Array(Q),ie=0;ie<Q;ie++)fe[ie]=arguments[ie];return w(mt,null,[(se=i["append-inner"])==null?void 0:se.call(i,...fe),t.menuIcon?w(lt,{class:"v-select__menu-icon",icon:t.menuIcon},null):void 0])}})}),_c({isFocused:v,menu:l,select:O},r)}}),Kve=(t,e,i)=>t==null||e==null?-1:t.toString().toLocaleLowerCase().indexOf(e.toString().toLocaleLowerCase()),Xve=We({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function Yve(t,e,i){var a;const n=[],r=(i==null?void 0:i.default)??Kve,s=i!=null&&i.filterKeys?Aa(i.filterKeys):!1,o=Object.keys((i==null?void 0:i.customKeyFilter)??{}).length;if(!(t!=null&&t.length))return n;e:for(let l=0;l<t.length;l++){const[c,u=c]=Aa(t[l]),h={},d={};let f=-1;if(e&&!(i!=null&&i.noFilter)){if(typeof c=="object"){const v=s||Object.keys(u);for(const p of v){const b=jl(u,p,u),_=(a=i==null?void 0:i.customKeyFilter)==null?void 0:a[p];if(f=_?_(b,e,c):r(b,e,c),f!==-1&&f!==!1)_?h[p]=f:d[p]=f;else if((i==null?void 0:i.filterMode)==="every")continue e}}else f=r(c,e,c),f!==-1&&f!==!1&&(d.title=f);const m=Object.keys(d).length,g=Object.keys(h).length;if(!m&&!g||(i==null?void 0:i.filterMode)==="union"&&g!==o&&!m||(i==null?void 0:i.filterMode)==="intersection"&&(g!==o||!m))continue}n.push({index:l,matches:{...d,...h}})}return n}function Zve(t,e,i,n){const r=ge([]),s=ge(new Map),o=W(()=>n!=null&&n.transform?le(e).map(l=>[l,n.transform(l)]):le(e));Oa(()=>{const l=typeof i=="function"?i():le(i),c=typeof l!="string"&&typeof l!="number"?"":String(l),u=Yve(o.value,c,{customKeyFilter:{...t.customKeyFilter,...le(n==null?void 0:n.customKeyFilter)},default:t.customFilter,filterKeys:t.filterKeys,filterMode:t.filterMode,noFilter:t.noFilter}),h=le(e),d=[],f=new Map;u.forEach(m=>{let{index:g,matches:v}=m;const p=h[g];d.push(p),f.set(p.value,v)}),r.value=d,s.value=f});function a(l){return s.value.get(l.value)}return{filteredItems:r,filteredMatches:s,getMatches:a}}function Jve(t,e,i){if(e==null)return t;if(Array.isArray(e))throw new Error("Multiple matches is not implemented");return typeof e=="number"&&~e?w(mt,null,[w("span",{class:"v-autocomplete__unmask"},[t.substr(0,e)]),w("span",{class:"v-autocomplete__mask"},[t.substr(e,i)]),w("span",{class:"v-autocomplete__unmask"},[t.substr(e+i)])]):t}const Qve=We({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...Xve({filterKeys:["title"]}),...eG(),...Ua(nA({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...af({transition:!1})},"VAutocomplete"),eye=vt()({name:"VAutocomplete",props:Qve(),emits:{"update:focused":t=>!0,"update:search":t=>!0,"update:modelValue":t=>!0,"update:menu":t=>!0},setup(t,e){let{slots:i}=e;const{t:n}=nf(),r=ge(),s=_t(!1),o=_t(!0),a=_t(!1),l=ge(),c=ge(),u=Oi(t,"menu"),h=W({get:()=>u.value,set:de=>{var Y;u.value&&!de&&((Y=l.value)!=null&&Y.openChildren)||(u.value=de)}}),d=_t(-1),f=W(()=>{var de;return(de=r.value)==null?void 0:de.color}),m=W(()=>h.value?t.closeText:t.openText),{items:g,transformIn:v,transformOut:p}=$W(t),{textColorClasses:b,textColorStyles:_}=ko(f),P=Oi(t,"search",""),E=Oi(t,"modelValue",[],de=>v(de===null?[null]:Aa(de)),de=>{const Y=p(de);return t.multiple?Y:Y[0]??null}),T=W(()=>typeof t.counterValue=="function"?t.counterValue(E.value):typeof t.counterValue=="number"?t.counterValue:E.value.length),C=iA(),{filteredItems:M,getMatches:x}=Zve(t,g,()=>o.value?"":P.value),V=W(()=>t.hideSelected?M.value.filter(de=>!E.value.some(Y=>Y.value===de.value)):M.value),N=W(()=>E.value.map(de=>de.props.value)),D=W(()=>{var Y;return(t.autoSelectFirst===!0||t.autoSelectFirst==="exact"&&P.value===((Y=V.value[0])==null?void 0:Y.title))&&V.value.length>0&&!o.value&&!a.value}),O=W(()=>t.hideNoData&&!V.value.length||t.readonly||(C==null?void 0:C.isReadonly.value)),F=ge(),{onListScroll:X,onListKeydown:Z}=QW(F,r);function K(de){t.openOnClear&&(h.value=!0),P.value=""}function z(){O.value||(h.value=!0)}function H(de){O.value||(s.value&&(de.preventDefault(),de.stopPropagation()),h.value=!h.value)}function re(de){var he,ae,A;if(t.readonly||C!=null&&C.isReadonly.value)return;const Y=r.value.selectionStart,te=E.value.length;if((d.value>-1||["Enter","ArrowDown","ArrowUp"].includes(de.key))&&de.preventDefault(),["Enter","ArrowDown"].includes(de.key)&&(h.value=!0),["Escape"].includes(de.key)&&(h.value=!1),D.value&&["Enter","Tab"].includes(de.key)&&ee(V.value[0]),de.key==="ArrowDown"&&D.value&&((he=F.value)==null||he.focus("next")),!!t.multiple){if(["Backspace","Delete"].includes(de.key)){if(d.value<0){de.key==="Backspace"&&!P.value&&(d.value=te-1);return}const I=d.value,G=E.value[d.value];G&&!G.props.disabled&&ee(G),d.value=I>=te-1?te-2:I}if(de.key==="ArrowLeft"){if(d.value<0&&Y>0)return;const I=d.value>-1?d.value-1:te-1;E.value[I]?d.value=I:(d.value=-1,r.value.setSelectionRange((ae=P.value)==null?void 0:ae.length,(A=P.value)==null?void 0:A.length))}if(de.key==="ArrowRight"){if(d.value<0)return;const I=d.value+1;E.value[I]?d.value=I:(d.value=-1,r.value.setSelectionRange(0,0))}}}function ne(de){if(Xm(r.value,":autofill")||Xm(r.value,":-webkit-autofill")){const Y=g.value.find(te=>te.title===de.target.value);Y&&ee(Y)}}function B(){var de;s.value&&(o.value=!0,(de=r.value)==null||de.focus())}function Q(de){s.value=!0,setTimeout(()=>{a.value=!0})}function fe(de){a.value=!1}function ie(de){(de==null||de===""&&!t.multiple)&&(E.value=[])}const se=_t(!1);function ee(de){let Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!de.props.disabled)if(t.multiple){const te=E.value.findIndex(he=>t.valueComparator(he.value,de.value));if(te===-1)E.value=[...E.value,de];else{const he=[...E.value];he.splice(te,1),E.value=he}t.clearOnSelect&&(P.value="")}else E.value=Y?[de]:[],se.value=!0,P.value=Y?de.title:"",h.value=!1,o.value=!0,vn(()=>se.value=!1)}return He(s,(de,Y)=>{var te;de!==Y&&(de?(se.value=!0,P.value=t.multiple?"":String(((te=E.value.at(-1))==null?void 0:te.props.title)??""),o.value=!0,vn(()=>se.value=!1)):(!t.multiple&&P.value==null?E.value=[]:D.value&&!a.value&&!E.value.some(he=>{let{value:ae}=he;return ae===V.value[0].value})&&ee(V.value[0]),h.value=!1,P.value="",d.value=-1))}),He(P,de=>{!s.value||se.value||(de&&(h.value=!0),o.value=!de)}),He(h,()=>{if(!t.hideSelected&&h.value&&E.value.length){const de=V.value.findIndex(Y=>E.value.some(te=>Y.value===te.value));un&&window.requestAnimationFrame(()=>{var Y;de>=0&&((Y=c.value)==null||Y.scrollToIndex(de))})}}),He(V,(de,Y)=>{s.value&&(!de.length&&t.hideNoData&&(h.value=!1),!Y.length&&de.length&&(h.value=!0))}),Tt(()=>{const de=!!(t.chips||i.chip),Y=!!(!t.hideNoData||V.value.length||i["prepend-item"]||i["append-item"]||i["no-data"]),te=E.value.length>0,he=vr.filterProps(t);return w(vr,ht({ref:r},he,{modelValue:P.value,"onUpdate:modelValue":[ae=>P.value=ae,ie],focused:s.value,"onUpdate:focused":ae=>s.value=ae,validationValue:E.externalValue,counterValue:T.value,dirty:te,onChange:ne,class:["v-autocomplete",`v-autocomplete--${t.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":h.value,"v-autocomplete--chips":!!t.chips,"v-autocomplete--selection-slot":!!i.selection,"v-autocomplete--selecting-index":d.value>-1},t.class],style:t.style,readonly:t.readonly,placeholder:te?void 0:t.placeholder,"onClick:clear":K,"onMousedown:control":z,onKeydown:re}),{...i,default:()=>w(mt,null,[w(Ep,ht({ref:l,modelValue:h.value,"onUpdate:modelValue":ae=>h.value=ae,activator:"parent",contentClass:"v-autocomplete__content",disabled:O.value,eager:t.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:t.transition,onAfterLeave:B},t.menuProps),{default:()=>[Y&&w(Bm,ht({ref:F,selected:N.value,selectStrategy:t.multiple?"independent":"single-independent",onMousedown:ae=>ae.preventDefault(),onKeydown:Z,onFocusin:Q,onFocusout:fe,onScrollPassive:X,tabindex:"-1","aria-live":"polite",color:t.itemColor??t.color},t.listProps),{default:()=>{var ae,A,I;return[(ae=i["prepend-item"])==null?void 0:ae.call(i),!V.value.length&&!t.hideNoData&&(((A=i["no-data"])==null?void 0:A.call(i))??w(jo,{title:n(t.noDataText)},null)),w(JW,{ref:c,renderless:!0,items:V.value},{default:G=>{var ye;let{item:ue,index:Se,itemRef:Ee}=G;const Oe=ht(ue.props,{ref:Ee,key:Se,active:D.value&&Se===0?!0:void 0,onClick:()=>ee(ue)});return((ye=i.item)==null?void 0:ye.call(i,{item:ue,index:Se,props:Oe}))??w(jo,Oe,{prepend:Pe=>{let{isSelected:we}=Pe;return w(mt,null,[t.multiple&&!t.hideSelected?w(U_,{key:ue.value,modelValue:we,ripple:!1,tabindex:"-1"},null):void 0,ue.props.prependAvatar&&w(ah,{image:ue.props.prependAvatar},null),ue.props.prependIcon&&w(lt,{icon:ue.props.prependIcon},null)])},title:()=>{var Pe,we;return o.value?ue.title:Jve(ue.title,(Pe=x(ue))==null?void 0:Pe.title,((we=P.value)==null?void 0:we.length)??0)}})}}),(I=i["append-item"])==null?void 0:I.call(i)]}})]}),E.value.map((ae,A)=>{function I(Ee){Ee.stopPropagation(),Ee.preventDefault(),ee(ae,!1)}const G={"onClick:close":I,onMousedown(Ee){Ee.preventDefault(),Ee.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},ue=de?!!i.chip:!!i.selection,Se=ue?nM(de?i.chip({item:ae,index:A,props:G}):i.selection({item:ae,index:A})):void 0;if(!(ue&&!Se))return w("div",{key:ae.value,class:["v-autocomplete__selection",A===d.value&&["v-autocomplete__selection--selected",b.value]],style:A===d.value?_.value:{}},[de?i.chip?w(rr,{key:"chip-defaults",defaults:{VChip:{closable:t.closableChips,size:"small",text:ae.title}}},{default:()=>[Se]}):w(ZW,ht({key:"chip",closable:t.closableChips,size:"small",text:ae.title,disabled:ae.props.disabled},G),null):Se??w("span",{class:"v-autocomplete__selection-text"},[ae.title,t.multiple&&A<E.value.length-1&&w("span",{class:"v-autocomplete__selection-comma"},[$e(",")])])])})]),"append-inner":function(){var G;for(var ae=arguments.length,A=new Array(ae),I=0;I<ae;I++)A[I]=arguments[I];return w(mt,null,[(G=i["append-inner"])==null?void 0:G.call(i,...A),t.menuIcon?w(lt,{class:"v-autocomplete__menu-icon",icon:t.menuIcon,onMousedown:H,onClick:Q9,"aria-label":n(m.value),title:n(m.value)},null):void 0])}})}),_c({isFocused:s,isPristine:o,menu:h,search:P,filteredItems:M,select:ee},r)}}),tye={style:{display:"flex",padding:"5px"}},hv=ri({__name:"AddressInput",props:{isLine:{type:Boolean,default:!1},drawLine:{type:Boolean,default:!1}},emits:["update:placeId","update:point"],async setup(t,{emit:e}){let i,n;const r=An(),{inverseTotalRotationMatrix:s,sePoints:o,isEarthMode:a}=Ji(r),{t:l}=qn(),{geoLocationToUnitSphere:c}=XM(),u=t,h=e,d=ge(""),f=ge(""),m=ge(null),g=ge([]),v=ge(void 0),p={}.VITE_APP_GOOGLE_MAP_API_KEY;console.log("Address input using API",p);const b=new hd({apiKey:p,version:"weekly"}),{AutocompleteService:_,PlacesService:P}=([i,n]=C6(()=>b.importLibrary("places")),i=await i,n(),i),E=new _;let T;ki(async()=>{T=new P(m.value)}),He(()=>v.value,x=>{x&&C(x)}),He(()=>u.drawLine,()=>{u.isLine&&M()}),He(()=>d.value,()=>{h("update:placeId",d.value)});function C(x){f.value="",E.getPlacePredictions({input:x}).then(V=>{console.debug("Searching for",x,"with response",V),g.value=V.predictions.map(N=>({description:N.description,placeId:N.place_id}))}).catch(V=>{f.value=l("addressPredictionError")+V})}function M(){console.debug("Get details of",d.value),f.value="",T.getDetails({placeId:d.value,fields:["name","geometry","formatted_address"]},(x,V)=>{var N;if(V===google.maps.places.PlacesServiceStatus.OK){if(o.value.filter(O=>O instanceof Xc).map(O=>O).some(O=>{var F,X,Z;return((F=x==null?void 0:x.geometry)==null?void 0:F.location)&&O.latitude===((X=x.geometry)==null?void 0:X.location.lat())&&O.longitude===((Z=x.geometry)==null?void 0:Z.location.lng())})){$.fire("show-alert",{key:"handlers.pointCreationAttemptDuplicate",keyOptions:{},type:"error"});return}if((N=x==null?void 0:x.geometry)!=null&&N.location){const O=c(x.geometry.location.lat(),x.geometry.location.lng()),F=O[0],X=O[1],Z=O[2],K=new Xc(x.geometry.location.lng(),x.geometry.location.lat()),z=new k(F,X,Z);z.normalize();const H=new Pt;H.copy(s.value).invert(),z.applyMatrix4(H),K.locationVector=z;let re=x.formatted_address;const ne=new De("point",K);ne.ref.caption=re??l("noFormattedAddress");const B=new Dt;B.addCommand(new up(K,ne)),B.execute(),ne.update(),h("update:point",K)}}else f.value=l("addressDetailsUnknown")}),d.value="",v.value="",g.value=[]}return(x,V)=>(Te(),Ct("div",tye,[w(eye,{ref_key:"addrInput",ref:m,modelValue:d.value,"onUpdate:modelValue":V[0]||(V[0]=N=>d.value=N),search:v.value,"onUpdate:search":V[1]||(V[1]=N=>v.value=N),items:g.value,disabled:!le(a),"item-title":"description","item-value":"placeId","hide-details":f.value.length===0,"error-messages":f.value,class:"bg-white",density:"compact",label:le(l)("enterAddress"),style:{width:"30em"}},T6({_:2},[x.isLine?void 0:{name:"append",fn:U(()=>[w(Qt,{onClick:M,disabled:d.value===null||d.value.length===0},{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-map-marker")],void 0,!0),_:1})],void 0,!0),_:1},8,["disabled"])]),key:"0"}]),1032,["modelValue","search","items","disabled","hide-details","error-messages","label"])]))}});function q2(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{enterAddress:i=>{const{normalize:n}=i;return n(["Enter address"])},addressPredictionError:i=>{const{normalize:n}=i;return n(["Unable to get address prediction: "])},noFormattedAddress:i=>{const{normalize:n}=i;return n(["Address details not available"])},addressDetailsUnknown:i=>{const{normalize:n}=i;return n(["Unable to get address details"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"enterAddress":"Enter address","addressPredictionError":"Unable to get address prediction: ","noFormattedAddress":"Address details not available","addressDetailsUnknown":"Unable to get address details"}}'),delete e._Ctor}function K2(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"id",resource:{enterAddress:i=>{const{normalize:n}=i;return n(["Ketikkan alamat"])},addressPredictionError:i=>{const{normalize:n}=i;return n(["Gagal menentukan prediksi alamat: "])},noFormattedAddress:i=>{const{normalize:n}=i;return n(["Alamat lengkap tidak ditemukan"])},addressDetailsUnknown:i=>{const{normalize:n}=i;return n(["Alamat rinci tidak ditemukan"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"id":{"enterAddress":"Ketikkan alamat","addressPredictionError":"Gagal menentukan prediksi alamat: ","noFormattedAddress":"Alamat lengkap tidak ditemukan","addressDetailsUnknown":"Alamat rinci tidak ditemukan"}}'),delete e._Ctor}typeof q2=="function"&&q2(hv);typeof K2=="function"&&K2(hv);class iye extends it.Group{constructor(i){super();y(this,"box");y(this,"_text");y(this,"timer");this._text=new it.Text(i,0,0);const n=this._text.getBoundingClientRect();this.box=new it.RoundedRectangle(0,0,n.width,n.height,4),this.box.fill="hsl(20,50%,80%)",this.box.opacity=.7,this.add(this.box,this._text)}set text(i){this._text.value=i;const n=this._text.getBoundingClientRect();this.box.width=n.width}showWithDelay(i,n){this.timer=setTimeout(()=>{this.addTo(i)},n)}hide(){this.timer&&clearTimeout(this.timer),this.remove()}}const xm=class xm{constructor(e){y(this,"X_AXIS",new k(1,0,0));y(this,"Y_AXIS",new k(0,1,0));y(this,"Z_AXIS",new k(0,0,1));y(this,"canvas");y(this,"currentSphereVector");y(this,"previousSphereVector");y(this,"currentScreenVector");y(this,"previousScreenVector");y(this,"isOnSphere");y(this,"hitSENodules",[]);y(this,"hitSEPoints",[]);y(this,"hitSELines",[]);y(this,"hitSESegments",[]);y(this,"hitSECircles",[]);y(this,"hitSEEllipses",[]);y(this,"hitSELabels",[]);y(this,"hitSEAngleMarkers",[]);y(this,"hitSEParametrics",[]);y(this,"hitSEPolygons",[]);y(this,"layers");y(this,"mouseVector",new k);y(this,"infoText",new iye("Hello"));this.layers=e,this.canvas=e[st.midground],this.currentSphereVector=new k,this.currentScreenVector=new it.Vector(0,0),this.previousSphereVector=new k,this.previousScreenVector=new it.Vector(0,0),this.isOnSphere=!1}static setGlobalStore(e){xm.store=e}mouseMoved(e){this.trackMouseLocation(e)}trackMouseLocation(e){const n=(e.currentTarget||e.target).getBoundingClientRect(),r=e.clientX-n.left,s=e.clientY-n.top,o=r-n.width/2,a=n.height/2-s,l=xm.store.zoomMagnificationFactor,c=xm.store.zoomTranslation;this.mouseVector.set((o-c[0])/l,(a+c[1])/l,0),this.previousScreenVector.copy(this.currentScreenVector),this.currentScreenVector.set(this.mouseVector.x,this.mouseVector.y);const u=this.mouseVector.length(),h=S.boundaryCircle.radius;if(u<h){const d=this.mouseVector.x,f=this.mouseVector.y,m=Math.sqrt(h*h-(d*d+f*f))*(e.shiftKey?-1:1);this.previousSphereVector.copy(this.currentSphereVector),this.currentSphereVector.set(d,f,m).normalize(),e.ctrlKey&&console.debug("Mouse at",this.currentSphereVector.toFixed(4)),this.isOnSphere=!0}else this.isOnSphere=!1}mouseLeave(e){this.isOnSphere=!1}activate(){}deactivate(){}};y(xm,"store");let Tr=xm;class _i extends Tr{mouseLeave(e){super.mouseLeave(e),_i.store.unglowAllSENodules(),this.infoText.hide()}mouseMoved(e){if(super.mouseMoved(e),!this.isOnSphere)return;this.hitSENodules.forEach(n=>{n.selected||(n.glowing=!1)}),this.hitSEPoints.clear(),this.hitSELines.clear(),this.hitSESegments.clear(),this.hitSECircles.clear(),this.hitSEEllipses.clear(),this.hitSELabels.clear(),this.hitSEAngleMarkers.clear(),this.hitSEParametrics.clear(),this.hitSEPolygons.clear(),this.infoText.hide(),this.hitSENodules=_i.store.findNearbySENodules(this.currentSphereVector,this.currentScreenVector).filter(n=>n instanceof Le||n instanceof ut?n.isUserCreated?n.showing&&n.exists:n.exists:n.showing&&n.exists),this.hitSEPoints=this.hitSENodules.filter(n=>n instanceof Ze).map(n=>n),this.hitSELines=this.hitSENodules.filter(n=>n instanceof $t).map(n=>n),this.hitSESegments=this.hitSENodules.filter(n=>n instanceof Jt).map(n=>n),this.hitSECircles=this.hitSENodules.filter(n=>n instanceof Kt).map(n=>n),this.hitSEEllipses=this.hitSENodules.filter(n=>n instanceof Ii).map(n=>n),this.hitSELabels=this.hitSENodules.filter(n=>n instanceof De).map(n=>n),this.hitSEAngleMarkers=this.hitSENodules.filter(n=>n instanceof en).map(n=>n),this.hitSEParametrics=this.hitSENodules.filter(n=>n instanceof tn).map(n=>n),this.hitSEPolygons=this.hitSENodules.filter(n=>n instanceof Ks).map(n=>n);const i=[...this.hitSEPoints,...this.hitSELines,...this.hitSESegments,...this.hitSECircles,...this.hitSEEllipses,...this.hitSEAngleMarkers,...this.hitSEParametrics,...this.hitSEPolygons].map(n=>{var r;return(r=n.label)==null?void 0:r.ref.shortUserName}).join(", ");i.length>0&&(this.infoText.hide(),this.infoText.showWithDelay(this.layers[st.foregroundText],300),this.infoText.text=i,this.infoText.translation.set(this.currentScreenVector.x,-this.currentScreenVector.y+16))}activate(){_i.store.selectedSENodules.map(e=>e).forEach(e=>{e.selected=!1}),_i.store.setSelectedSENodules([]),_i.store.unglowAllSENodules(),this.infoText.hide()}static addCreateAntipodeCommand(e,i){const n=new ut(e,!1);n.locationVector=e.locationVector,n.locationVector.multiplyScalar(-1);const r=n.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));return i.addCommand(new qp(n,e,r)),n}}class sn extends L{constructor(i,n,r){super();y(this,"seIntersectionOrAntipodePoint");y(this,"userCreatedValue");y(this,"useVisiblePointCountToRename");this.seIntersectionOrAntipodePoint=i,this.userCreatedValue=n,r!==void 0?this.useVisiblePointCountToRename=r:this.useVisiblePointCountToRename=!0}do(){this.seIntersectionOrAntipodePoint.isUserCreated=this.userCreatedValue,this.seIntersectionOrAntipodePoint.ref.stylize(Vt.ApplyCurrentVariables),this.seIntersectionOrAntipodePoint.ref.adjustSize(),this.seIntersectionOrAntipodePoint.showing=this.userCreatedValue,this.seIntersectionOrAntipodePoint.label&&S.point.showLabelsOfNonFreePointsInitially&&(this.seIntersectionOrAntipodePoint.label.showing=this.userCreatedValue),this.userCreatedValue?(this.seIntersectionOrAntipodePoint.pointVisibleBefore=!0,this.seIntersectionOrAntipodePoint.label&&this.useVisiblePointCountToRename&&(this.seIntersectionOrAntipodePoint.incrementVisiblePointCount(),this.seIntersectionOrAntipodePoint.label.ref.shortUserName=`P${this.seIntersectionOrAntipodePoint.visiblePointCount}`)):(this.seIntersectionOrAntipodePoint.label&&this.useVisiblePointCountToRename&&(this.seIntersectionOrAntipodePoint.decrementVisiblePointCount(),this.seIntersectionOrAntipodePoint.label.ref.shortUserName=`P${this.seIntersectionOrAntipodePoint.visiblePointCount}`),this.seIntersectionOrAntipodePoint.pointVisibleBefore=!1),this.seIntersectionOrAntipodePoint.markKidsOutOfDate(),this.seIntersectionOrAntipodePoint.update(),$.fire("update-points-user-created",{})}saveState(){}restoreState(){this.userCreatedValue?(this.seIntersectionOrAntipodePoint.label&&this.useVisiblePointCountToRename&&(this.seIntersectionOrAntipodePoint.decrementVisiblePointCount(),this.seIntersectionOrAntipodePoint.label.ref.shortUserName=`P${this.seIntersectionOrAntipodePoint.visiblePointCount}`),this.seIntersectionOrAntipodePoint.pointVisibleBefore=!1):(this.seIntersectionOrAntipodePoint.pointVisibleBefore=!0,this.seIntersectionOrAntipodePoint.label&&this.useVisiblePointCountToRename&&(this.seIntersectionOrAntipodePoint.incrementVisiblePointCount(),this.seIntersectionOrAntipodePoint.label.ref.shortUserName=`P${this.seIntersectionOrAntipodePoint.visiblePointCount}`)),this.seIntersectionOrAntipodePoint.label&&S.point.showLabelsOfNonFreePointsInitially&&(this.seIntersectionOrAntipodePoint.label.showing=!this.userCreatedValue),this.seIntersectionOrAntipodePoint.showing=!this.userCreatedValue,this.seIntersectionOrAntipodePoint.ref.stylize(Vt.ApplyTemporaryVariables),this.seIntersectionOrAntipodePoint.isUserCreated=!this.userCreatedValue,this.seIntersectionOrAntipodePoint.markKidsOutOfDate(),this.seIntersectionOrAntipodePoint.update(),$.fire("update-points-user-created",{})}toOpcode(){return null}}class gs extends _i{constructor(i){super(i);y(this,"startVector",new k);y(this,"startSEPoint",null);y(this,"endSEPoint",null);y(this,"startSEPointOneDimensionalParent",null);y(this,"arcLength",0);y(this,"temporarySegment");y(this,"isTemporarySegmentAdded",!1);y(this,"isTemporaryStartMarkerAdded",!1);y(this,"isTemporaryEndMarkerAdded",!1);y(this,"snapStartMarkerToTemporaryOneDimensional",null);y(this,"snapEndMarkerToTemporaryOneDimensional",null);y(this,"snapStartMarkerToTemporaryPoint",null);y(this,"snapEndMarkerToTemporaryPoint",null);y(this,"temporaryStartMarker");y(this,"temporaryEndMarker");y(this,"startLocationSelected",!1);y(this,"longerThanPi",!1);y(this,"nearlyAntipodal",!1);y(this,"normalVector",new k(0,0,0));y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"tmpVector3",new k);this.temporarySegment=new Ws,gs.store.addTemporaryNodule(this.temporarySegment),this.isTemporarySegmentAdded=!1,this.temporaryStartMarker=new mi,gs.store.addTemporaryNodule(this.temporaryStartMarker),this.temporaryEndMarker=new mi,gs.store.addTemporaryNodule(this.temporaryEndMarker)}mousePressed(i){if(super.mouseMoved(i),this.isOnSphere&&!this.startLocationSelected){if(this.startLocationSelected=!0,this.hitSEPoints.length>0){const n=this.hitSEPoints[0];this.startVector.copy(n.locationVector),this.startSEPoint=this.hitSEPoints[0],this.temporaryStartMarker.positionVector=n.locationVector,this.temporarySegment.startVector=n.locationVector,this.startSEPoint.glowing=!0,this.startSEPoint.selected=!0}else this.hitSESegments.length>0?(this.startSEPointOneDimensionalParent=this.hitSESegments[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporarySegment.startVector=this.startVector,this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):this.hitSELines.length>0?(this.startSEPointOneDimensionalParent=this.hitSELines[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporarySegment.startVector=this.startVector,this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):this.hitSECircles.length>0?(this.startSEPointOneDimensionalParent=this.hitSECircles[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporarySegment.startVector=this.startVector,this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):this.hitSEEllipses.length>0?(this.startSEPointOneDimensionalParent=this.hitSEEllipses[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporarySegment.startVector=this.startVector,this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):this.hitSEParametrics.length>0?(this.startSEPointOneDimensionalParent=this.hitSEParametrics[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporarySegment.startVector=this.startVector,this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):this.hitSEPolygons.length>0?(this.startSEPointOneDimensionalParent=this.hitSEPolygons[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporarySegment.startVector=this.startVector,this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):(this.temporarySegment.startVector=this.currentSphereVector,this.temporaryStartMarker.positionVector=this.currentSphereVector,this.startVector.copy(this.currentSphereVector),this.startSEPoint=null);this.temporaryEndMarker.positionVector=this.currentSphereVector,this.nearlyAntipodal=!1,this.longerThanPi=!1,this.arcLength=0}}mouseMoved(i){super.mouseMoved(i),this.hitSEPoints.length>0?(this.hitSEPoints[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=this.hitSEPoints[0]):(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=this.hitSEPoints[0],this.snapEndMarkerToTemporaryPoint=null)):this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSESegments[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSESegments[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):this.hitSELines.length>0?(this.hitSELines[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSELines[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSELines[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSECircles[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSECircles[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSEEllipses[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSEEllipses[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSEParametrics[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSEParametrics[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):this.hitSEPolygons.length>0?(this.hitSEPolygons[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSEPolygons[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSEPolygons[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null),this.isOnSphere?this.startLocationSelected?(!this.isTemporaryStartMarkerAdded&&this.startSEPoint===null&&(this.isTemporaryStartMarkerAdded=!0,this.temporaryStartMarker.addToLayers(this.layers)),this.isTemporaryEndMarkerAdded||(this.isTemporaryEndMarkerAdded=!0,this.temporaryEndMarker.addToLayers(this.layers)),this.snapEndMarkerToTemporaryPoint!==null&&(this.temporaryEndMarker.removeFromLayers(),this.isTemporaryEndMarkerAdded=!1),this.snapEndMarkerToTemporaryOneDimensional!==null?this.temporaryEndMarker.positionVector=this.snapEndMarkerToTemporaryOneDimensional.closestVector(this.currentSphereVector):this.temporaryEndMarker.positionVector=this.currentSphereVector,this.isTemporarySegmentAdded||(this.isTemporarySegmentAdded=!0,this.temporarySegment.addToLayers(this.layers)),this.snapEndMarkerToTemporaryPoint===null?this.setArcLengthAndNormalVector(i.ctrlKey,this.temporaryEndMarker.positionVector):this.setArcLengthAndNormalVector(i.ctrlKey,this.snapEndMarkerToTemporaryPoint.locationVector),this.temporarySegment.arcLength=this.arcLength,this.temporarySegment.normalVector=this.normalVector,this.temporarySegment.updateDisplay()):(this.isTemporaryStartMarkerAdded||(this.isTemporaryStartMarkerAdded=!0,this.temporaryStartMarker.addToLayers(this.layers)),this.snapStartMarkerToTemporaryPoint!==null&&(this.snapStartMarkerToTemporaryPoint instanceof Le&&!this.snapStartMarkerToTemporaryPoint.isUserCreated?this.temporaryStartMarker.positionVector=this.snapStartMarkerToTemporaryPoint.locationVector:(this.temporaryStartMarker.removeFromLayers(),this.isTemporaryStartMarkerAdded=!1)),this.snapStartMarkerToTemporaryOneDimensional!==null?this.temporaryStartMarker.positionVector=this.snapStartMarkerToTemporaryOneDimensional.closestVector(this.currentSphereVector):this.snapStartMarkerToTemporaryPoint==null&&(this.temporaryStartMarker.positionVector=this.currentSphereVector)):this.isTemporaryStartMarkerAdded&&(this.temporarySegment.removeFromLayers(),this.temporaryStartMarker.removeFromLayers(),this.temporaryEndMarker.removeFromLayers(),this.isTemporaryStartMarkerAdded=!1,this.isTemporaryEndMarkerAdded=!1,this.isTemporarySegmentAdded=!1,this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)}mouseReleased(i){this.isOnSphere&&(this.startLocationSelected?this.startVector.angleTo(this.currentSphereVector)>S.segment.minimumArcLength&&(this.makeSegment(i.ctrlKey)||$.fire("show-alert",{key:"handlers.segmentCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.mouseLeave(i)):(this.temporarySegment.removeFromLayers(),this.temporaryStartMarker.removeFromLayers(),this.temporaryEndMarker.removeFromLayers(),this.isTemporaryStartMarkerAdded=!1,this.isTemporaryEndMarkerAdded=!1,this.isTemporarySegmentAdded=!1,this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null))}mouseLeave(i){super.mouseLeave(i),this.prepareForNextSegment()}prepareForNextSegment(){this.temporarySegment.removeFromLayers(),this.temporaryStartMarker.removeFromLayers(),this.temporaryEndMarker.removeFromLayers(),this.isTemporarySegmentAdded=!1,this.isTemporaryStartMarkerAdded=!1,this.isTemporaryEndMarkerAdded=!1,this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null,this.startSEPoint&&(this.startSEPoint.glowing=!1,this.startSEPoint.selected=!1),this.startSEPoint=null,this.endSEPoint=null,this.startSEPointOneDimensionalParent=null,this.nearlyAntipodal=!1,this.longerThanPi=!1,this.startLocationSelected=!1,this.arcLength=0,gs.store.unglowAllSENodules()}makeSegment(i,n=!1){const r=new Dt,s=[];if(this.startSEPoint===null){let o=null,a=null;this.startSEPointOneDimensionalParent?(o=new kt(this.startSEPointOneDimensionalParent),a=new De("point",o),r.addCommand(new zt(o,this.startSEPointOneDimensionalParent,a))):(o=new Ze,a=new De("point",o),r.addCommand(new Mn(o,a))),o.locationVector=this.startVector;const l=gs.addCreateAntipodeCommand(o,r);s.push(o,l),this.tmpVector.copy(o.locationVector).add(new k(2*S.segment.initialLabelOffset,S.segment.initialLabelOffset,0)).normalize(),a.locationVector=this.tmpVector,this.startSEPoint=o}else(this.startSEPoint instanceof Le&&!this.startSEPoint.isUserCreated||this.startSEPoint instanceof ut&&!this.startSEPoint.isUserCreated)&&r.addCommand(new sn(this.startSEPoint,!0));if(this.hitSEPoints.length>0&&!n)this.endSEPoint=this.hitSEPoints[0],this.setArcLengthAndNormalVector(i,this.endSEPoint.locationVector),this.temporarySegment.arcLength=this.arcLength,this.temporarySegment.normalVector=this.normalVector,this.temporarySegment.updateDisplay(),(this.endSEPoint instanceof Le&&!this.endSEPoint.isUserCreated||this.endSEPoint instanceof ut&&!this.endSEPoint.isUserCreated)&&r.addCommand(new sn(this.endSEPoint,!0));else if(!n){let o=null,a=null;this.hitSESegments.length>0?(o=new kt(this.hitSESegments[0]),o.locationVector=this.hitSESegments[0].closestVector(this.currentSphereVector),a=new De("point",o),r.addCommand(new zt(o,this.hitSESegments[0],a))):this.hitSELines.length>0?(o=new kt(this.hitSELines[0]),o.locationVector=this.hitSELines[0].closestVector(this.currentSphereVector),a=new De("point",o),r.addCommand(new zt(o,this.hitSELines[0],a))):this.hitSECircles.length>0?(o=new kt(this.hitSECircles[0]),o.locationVector=this.hitSECircles[0].closestVector(this.currentSphereVector),a=new De("point",o),r.addCommand(new zt(o,this.hitSECircles[0],a))):this.hitSEEllipses.length>0?(o=new kt(this.hitSEEllipses[0]),o.locationVector=this.hitSEEllipses[0].closestVector(this.currentSphereVector),a=new De("point",o),r.addCommand(new zt(o,this.hitSEEllipses[0],a))):this.hitSEParametrics.length>0?(o=new kt(this.hitSEParametrics[0]),o.locationVector=this.hitSEParametrics[0].closestVector(this.currentSphereVector),a=new De("point",o),r.addCommand(new zt(o,this.hitSEParametrics[0],a))):this.hitSEPolygons.length>0?(o=new kt(this.hitSEPolygons[0]),o.locationVector=this.hitSEPolygons[0].closestVector(this.currentSphereVector),a=new De("point",o),r.addCommand(new zt(o,this.hitSEPolygons[0],a))):(o=new Ze,o.locationVector=this.currentSphereVector,a=new De("point",o),r.addCommand(new Mn(o,a))),this.endSEPoint=o;const l=gs.addCreateAntipodeCommand(o,r);s.push(o,l),this.tmpVector.copy(o.locationVector).add(new k(2*S.segment.initialLabelOffset,S.segment.initialLabelOffset,0)).normalize(),a.locationVector=this.tmpVector}if(this.endSEPoint){if(this.setArcLengthAndNormalVector(i,this.endSEPoint.locationVector),this.temporaryEndMarker.positionVector=this.endSEPoint.locationVector,this.temporarySegment.arcLength=this.arcLength,this.temporarySegment.normalVector=this.normalVector,this.temporarySegment.updateDisplay(),gs.store.seSegments.some(l=>(this.tmpVector.subVectors(l.startSEPoint.locationVector,this.startSEPoint?this.startSEPoint.locationVector:this.tmpVector).isZero()&&this.tmpVector1.subVectors(l.endSEPoint.locationVector,this.endSEPoint?this.endSEPoint.locationVector:this.tmpVector1).isZero()||this.tmpVector.subVectors(l.endSEPoint.locationVector,this.startSEPoint?this.startSEPoint.locationVector:this.tmpVector1).isZero()&&this.tmpVector1.subVectors(l.startSEPoint.locationVector,this.endSEPoint?this.endSEPoint.locationVector:this.tmpVector).isZero())&&l.longerThanPi===this.longerThanPi&&(this.tmpVector2.copy(this.normalVector).sub(l.normalVector).isZero()||this.tmpVector3.copy(this.normalVector).multiplyScalar(-1).sub(l.normalVector).isZero())))return!1;this.isTemporarySegmentAdded=!1;const o=new Jt(this.startSEPoint,this.normalVector,this.arcLength,this.endSEPoint);o.shallowUpdate();const a=o.attachLabelWithOffset(new k(0,S.segment.initialLabelOffset,0));r.addCommand(new Yy(o,this.startSEPoint,this.endSEPoint,a)),gs.store.createAllIntersectionsWithSegment(o,s).forEach(l=>{if(l.existingIntersectionPoint)r.addCommand(new nr(l.SEIntersectionPoint,l.parent1));else{const c=l.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.segment.initialLabelOffset,S.segment.initialLabelOffset,0));r.addCommand(new ir(l.SEIntersectionPoint,l.parent1,l.parent2,c)),l.SEIntersectionPoint.showing=!1,c.showing=!1,l.createAntipodalPoint&&gs.addCreateAntipodeCommand(l.SEIntersectionPoint,r)}}),r.execute()}return!0}setArcLengthAndNormalVector(i,n){this.tmpVector.crossVectors(this.startVector,n),this.tmpVector.isZero(S.nearlyAntipodalIdeal)&&(this.normalVector.length()==0?(this.tmpVector.crossVectors(this.startVector,this.tmpVector),this.tmpVector.isZero(S.nearlyAntipodalIdeal)&&(this.tmpVector.set(0,1,0),this.tmpVector.crossVectors(this.startVector,this.tmpVector))):(this.tmpVector.crossVectors(this.startVector,this.normalVector),this.tmpVector.crossVectors(this.tmpVector,this.startVector))),this.normalVector.copy(this.tmpVector).normalize(),this.arcLength=this.startVector.angleTo(n),this.startVector.angleTo(n)>2&&(this.tmpVector.crossVectors(this.startVector,n).isZero(S.nearlyAntipodalIdeal)?this.nearlyAntipodal=!0:(this.nearlyAntipodal&&(this.longerThanPi=!this.longerThanPi),this.nearlyAntipodal=!1)),i?this.longerThanPi=!0:this.longerThanPi=!1,this.longerThanPi&&(this.arcLength=2*Math.PI-this.arcLength)}activate(){if(gs.store.selectedSENodules.length==2){const i=gs.store.selectedSENodules[0],n=gs.store.selectedSENodules[1];i instanceof Ze&&n instanceof Ze&&(this.tmpVector.crossVectors(i.locationVector,n.locationVector),this.startSEPoint=i,this.startVector.copy(this.startSEPoint.locationVector),this.endSEPoint=n,this.setArcLengthAndNormalVector(!1,this.endSEPoint.locationVector),this.makeSegment(!1,!0)||$.fire("show-alert",{key:"handlers.segmentCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.prepareForNextSegment())}super.activate()}deactivate(){super.deactivate()}}class vc extends L{constructor(i,n,r,s){super();y(this,"nodules",[]);y(this,"panel");y(this,"currentStyles",[]);y(this,"pastStyles",[]);this.nodules.push(...i),this.panel=n,r.forEach(o=>{this.currentStyles.push({...o})}),s.forEach(o=>{this.pastStyles.push({...o})})}do(){for(let i=0;i<this.nodules.length;i++)L.store.changeStyle({selected:[this.nodules[i]],panel:this.panel,payload:{...this.currentStyles[i]}})}saveState(){this.lastState=0}restoreState(){for(let i=0;i<this.nodules.length;i++)L.store.changeStyle({selected:[this.nodules[i]],panel:this.panel,payload:{...this.pastStyles[i]}})}toOpcode(){return null}}const nye=We({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...df(),...MV()},"VSwitch"),Ql=vt()({name:"VSwitch",inheritAttrs:!1,props:nye(),emits:{"update:focused":t=>!0,"update:modelValue":t=>!0,"update:indeterminate":t=>!0},setup(t,e){let{attrs:i,slots:n}=e;const r=Oi(t,"indeterminate"),s=Oi(t,"modelValue"),{loaderClasses:o}=fP(t),{isFocused:a,focus:l,blur:c}=uf(t),u=ge(),h=W(()=>typeof t.loading=="string"&&t.loading!==""?t.loading:t.color),d=Ao(),f=W(()=>t.id||`switch-${d}`);function m(){r.value&&(r.value=!1)}function g(v){var p,b;v.stopPropagation(),v.preventDefault(),(b=(p=u.value)==null?void 0:p.input)==null||b.click()}return Tt(()=>{const[v,p]=Cy(i),b=za.filterProps(t),_=z_.filterProps(t);return w(za,ht({class:["v-switch",{"v-switch--inset":t.inset},{"v-switch--indeterminate":r.value},o.value,t.class]},v,b,{modelValue:s.value,"onUpdate:modelValue":P=>s.value=P,id:f.value,focused:a.value,style:t.style}),{...n,default:P=>{let{id:E,messagesId:T,isDisabled:C,isReadonly:M,isValid:x}=P;const V={model:s,isValid:x};return w(z_,ht({ref:u},_,{modelValue:s.value,"onUpdate:modelValue":[N=>s.value=N,m],id:E.value,"aria-describedby":T.value,type:"checkbox","aria-checked":r.value?"mixed":void 0,disabled:C.value,readonly:M.value,onFocus:l,onBlur:c},p),{...n,default:N=>{let{backgroundColorClasses:D,backgroundColorStyles:O}=N;return w("div",{class:["v-switch__track",...D.value],style:O.value,onClick:g},[n["track-true"]&&w("div",{key:"prepend",class:"v-switch__track-true"},[n["track-true"](V)]),n["track-false"]&&w("div",{key:"append",class:"v-switch__track-false"},[n["track-false"](V)])])},input:N=>{let{inputNode:D,icon:O,backgroundColorClasses:F,backgroundColorStyles:X}=N;return w(mt,null,[D,w("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":O||t.loading},t.inset?void 0:F.value],style:t.inset?void 0:X.value},[n.thumb?w(rr,{defaults:{VIcon:{icon:O,size:"x-small"}}},{default:()=>[n.thumb({...V,icon:O})]}):w(pB,null,{default:()=>[t.loading?w(uM,{name:"v-switch",active:!0,color:x.value===!1?void 0:h.value},{default:Z=>n.loader?n.loader(Z):w(XU,{active:Z.isActive,color:Z.color,indeterminate:!0,size:"16",width:"2"},null)}):O&&w(lt,{key:String(O),icon:O,size:"x-small"},null)]})])])}})}})}),{}}}),rye={id:"earthobject"},tG=ri({__name:"AddEarthObject",setup(t){const e=An(),{inverseTotalRotationMatrix:i,sePoints:n,seCircles:r,seSegments:s,createAllIntersectionsWithSegment:o,createAllIntersectionsWithCircle:a}=Ji(e),{t:l}=qn(),{geoLocationToUnitSphere:c}=XM(),u=new k;let h=ge(!1),d=ge(!1),f=ge(!1),m=ge(!1),g=ge(""),v=ge(""),p,b,_,P,E=!1,T=!1;function C(Y){if(typeof Y=="string"&&Number.isNaN(Number(Y)))return l("numbersOnly");{let te=Number(Y);return-90<=te&&te<=90?!0:l("latitudeRange")}}function M(Y){if(typeof Y=="string"&&Number.isNaN(Number(Y)))return l("numbersOnly");{let te=Number(Y);return-180<te&&te<=180?!0:l("longitudeRange")}}const x=W(()=>v.value===""||g.value===""),V=W(()=>g.value===""),N=W(()=>v.value==="");function D(){if(n.value.filter(I=>I instanceof Xc&&(Math.abs(I.latitude-Number(g.value))<S.tolerance&&Math.abs(I.longitude-Number(v.value))<S.tolerance||p!==void 0&&Math.abs(90-Number(g.value))<S.tolerance||b!==void 0&&Math.abs(90+Number(g.value))<S.tolerance)).length>0){$.fire("show-alert",{key:"handlers.pointCreationAttemptDuplicate",type:"error"});return}const Y=new Xc(Number(g.value),Number(v.value)),te=c(Number(g.value),Number(v.value)),he=new k(te[0],te[1],te[2]),ae=new Pt;ae.copy(i.value).invert(),he.applyMatrix4(ae),Y.locationVector=he;const A=new De("point",Y);A.ref.caption="("+Math.abs(Number(g.value))+" "+(Number(g.value)!==0?Number(g.value)>0?l("N")+", ":l("S")+", ":", ")+Math.abs(Number(v.value))+" "+(Number(v.value)!==0?Number(v.value)>0?l("E")+")":l("W")+")":")"),A.update(),new up(Y,A).execute(),$.fire("show-alert",{key:"handlers.newEarthPointAdded",keyOptions:{name:Y.name,lat:Y.latitude+"",long:Y.longitude+""},type:"success"})}function O(Y){let te;if(Y!==void 0)te=Number(Y);else{if(g.value==null)return;te=Number(g.value)}if(Z(te)!==void 0){$.fire("show-alert",{key:"handlers.latitudeCreationAttemptDuplicate",type:"error"});return}else if(Math.abs(te-90)<S.circle.minimumRadius||Math.abs(te+90)<S.circle.minimumRadius){$.fire("show-alert",{key:"handlers.latitudeWithZeroRadius",type:"error"});return}const he=new du(te),ae=new De("circle",he);te===0?ae.ref.caption=l("equator"):te==23.5?ae.ref.caption=l("TropicOfCancer"):te==-23.5?ae.ref.caption=l("TropicOfCapricorn"):te==66.5?ae.ref.caption=l("arcticCircle"):te==-66.5?ae.ref.caption=l("antarcticCircle"):ae.ref.caption=Math.abs(te)+" "+(te>0?l("N"):l("S")),ae.update();const A=new Dt;A.addCommand(new iy(he,ae)),A.addCommand(de(he)).execute(),e.unglowAllSENodules(),$.fire("show-alert",{key:"handlers.newLatitudeAdded",keyOptions:{name:he.name,lat:he.latitude+""},type:"success"})}function F(Y){let te;if(Y!==void 0)te=Number(Y);else{if(v.value==null)return;te=Number(v.value)}if(K(te)!==void 0){$.fire("show-alert",{key:"handlers.longitudeCreationAttemptDuplicate",type:"error"});return}const he=new fu(te),ae=new De("segment",he);te===0?ae.ref.caption=l("primeMeridian"):ae.ref.caption=Math.abs(te)+""+(te>0?l("E"):l("W"));const A=c(0,te),I=new k(A[0],A[1],A[2]),G=new Pt;G.copy(Xe.store.inverseTotalRotationMatrix).invert(),I.applyMatrix4(G).normalize(),ae.locationVector=I,ae.update();const ue=new Dt;ue.addCommand(new ny(he,ae)),ue.addCommand(ee(he)).execute(),e.unglowAllSENodules(),$.fire("show-alert",{key:"handlers.newLongitudeAdded",keyOptions:{name:he.name,long:he.longitude+""},type:"success"})}He(()=>s.value,Y=>{const te=Y.filter(he=>he instanceof fu&&he.longitude===0).map(he=>he);te[0]?(P=te[0],h.value=te[0].showing):(P=void 0,h.value=!1)}),He(()=>r.value,Y=>{const te=Y.filter(he=>he instanceof du&&he.latitude===0).map(he=>he);te[0]?(_=te[0],d.value=te[0].showing):(_=void 0,d.value=!1)}),He(()=>n.value,Y=>{const te=Y.filter(A=>A instanceof Xc).map(A=>A);let he=te.find(A=>A.latitude===90);he!=null?(p=he,f.value=he.showing):(p=void 0,f.value=!1);let ae=te.find(A=>A.latitude===-90);ae!=null?(b=ae,m.value=ae.showing):(b=void 0,m.value=!1)});function X(Y){return n.value.find(te=>(u.copy(te.locationVector),u.applyMatrix4(i.value),console.log("point y value ",u.y),Math.abs(u.y-(wr.NORTH===Y?1:-1))<S.tolerance?(console.log(wr.NORTH===Y?"North":"South","pole found"),te.label&&(Y===wr.NORTH&&!E?(te.label.ref.caption=l("northPole"),E=!0,new vc([te.label.ref],q.Label,[{labelDisplayMode:Xi.CaptionOnly}],[{labelDisplayMode:te.label.ref.labelDisplayMode}]).execute()):Y===wr.SOUTH&&!T&&(te.label.ref.caption=l("southPole"),T=!0,new vc([te.label.ref],q.Label,[{labelDisplayMode:Xi.CaptionOnly}],[{labelDisplayMode:te.label.ref.labelDisplayMode}]).execute())),te.update(),!0):!1))}function Z(Y){return r.value.filter(he=>he instanceof du).map(he=>he).find(he=>Math.abs(he.latitude-Y)<S.tolerance)}function K(Y){return s.value.filter(he=>he instanceof fu).map(he=>he).find(he=>Math.abs(he.longitude-Y)<S.tolerance)}ki(()=>{b=X(wr.SOUTH),p=X(wr.NORTH),p!==void 0&&(f.value=p.showing),b!==void 0&&(m.value=b.showing),$.listen("update-pole-switch",z),_=Z(0),_!==void 0&&(d.value=_.showing),$.listen("update-equator-switch",H),P=K(0),P!==void 0&&(h.value=P.showing),$.listen("update-prime-meridian-switch",re)});function z(Y){console.log("message received"),Y.pole==wr.NORTH?f.value=Y.val:m.value=Y.val}function H(Y){d.value=Y.val}function re(Y){h.value=Y.val}an(()=>{$.unlisten("update-pole-switch"),$.unlisten("update-equator-switch"),$.unlisten("update-prime-meridian-switch")});function ne(Y){let te=new Dt;if(Y===wr.NORTH){if(p===void 0){const he=fe(wr.NORTH);he!==void 0&&te.addCommand(he)}console.log("display pole north",p),p!==void 0&&((p instanceof Le||p instanceof ut)&&p.isUserCreated===!1&&te.addCommand(new sn(p,!0,!0)),te.addCommand(new qi(p,!f.value)),p.label&&(f.value?!S.hideObjectHidesLabel:!S.showObjectShowsLabel)&&te.addCommand(new qi(p.label,!f.value)))}else{if(b===void 0){const he=fe(wr.SOUTH);he!==void 0&&te.addCommand(he)}b!==void 0&&((b instanceof Le||b instanceof ut)&&b.isUserCreated===!1&&te.addCommand(new sn(b,!0,!0)),te.addCommand(new qi(b,!m.value)),b.label&&(m.value?!S.hideObjectHidesLabel:!S.showObjectShowsLabel)&&te.addCommand(new qi(b.label,!m.value)))}te.execute(),$.fire("update-label-and-showing-display",{})}function B(){let Y=new Dt;if(_===void 0){const te=ie();te!==void 0&&Y.addCommand(te)}_!==void 0&&(Y.addCommand(new qi(_,!d.value)),_.label&&(d.value?!S.hideObjectHidesLabel:!S.showObjectShowsLabel)&&Y.addCommand(new qi(_.label,!d.value))),Y.execute(),e.unglowAllSENodules(),$.fire("update-label-and-showing-display",{})}function Q(){let Y=new Dt;if(P===void 0){const te=se();te!==void 0&&Y.addCommand(te)}P!==void 0&&(Y.addCommand(new qi(P,!h.value)),P.label&&(h.value?!S.hideObjectHidesLabel:!S.showObjectShowsLabel)&&Y.addCommand(new qi(P.label,!h.value))),Y.execute(),e.unglowAllSENodules(),$.fire("update-label-and-showing-display",{})}function fe(Y){let te=X(Y),he;if(te===void 0){te=new Xc(Y===wr.NORTH?90:-90,0);const ae=new k(0,Y===wr.NORTH?1:-1,0),A=new Pt;A.copy(i.value).invert(),ae.applyMatrix4(A),te.locationVector=ae;const I=new De("point",te);Y===wr.NORTH?(I.ref.caption=l("northPole"),E=!0):(I.ref.caption=l("southPole"),T=!0),I.update(),he=new Dt,he.addCommand(new up(te,I)),_i.addCreateAntipodeCommand(te,he)}return Y===wr.NORTH?p=te:b=te,he}function ie(){_=Z(0);let Y;if(_===void 0){_=new du(0);const te=new De("circle",_);te.ref.caption=l("equator"),te.showing=!0,te.update(),Y=new Dt,Y.addCommand(new iy(_,te)),Y.addCommand(de(_))}return Y}function se(){P=K(0);let Y;if(P===void 0){P=new fu(0);const te=new De("segment",P);te.ref.caption=l("primeMeridian");const he=c(0,0),ae=new k(he[0],he[1],he[2]),A=new Pt;A.copy(Xe.store.inverseTotalRotationMatrix).invert(),ae.applyMatrix4(A).normalize(),te.locationVector=ae,te.showing=!0,te.update(),Y=new Dt,Y.addCommand(new ny(P,te)),Y.addCommand(ee(P))}return Y}function ee(Y){const te=new Dt;return o.value(Y,[]).forEach(he=>{if(he.existingIntersectionPoint)te.addCommand(new nr(he.SEIntersectionPoint,he.parent1));else{const ae=he.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.segment.initialLabelOffset,S.segment.initialLabelOffset,0));te.addCommand(new ir(he.SEIntersectionPoint,he.parent1,he.parent2,ae)),he.SEIntersectionPoint.showing=!1,ae.showing=!1,he.createAntipodalPoint&&gs.addCreateAntipodeCommand(he.SEIntersectionPoint,te)}}),te}function de(Y){const te=new Dt;return a.value(Y,[]).forEach(he=>{if(he.existingIntersectionPoint)te.addCommand(new nr(he.SEIntersectionPoint,he.parent1));else{const ae=he.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.segment.initialLabelOffset,S.segment.initialLabelOffset,0));te.addCommand(new ir(he.SEIntersectionPoint,he.parent1,he.parent2,ae)),he.SEIntersectionPoint.showing=!1,ae.showing=!1,he.createAntipodalPoint&&gs.addCreateAntipodeCommand(he.SEIntersectionPoint,te)}}),te}return(Y,te)=>(Te(),Ct("div",rye,[w(Ql,{"hide-details":"",modelValue:le(f),"onUpdate:modelValue":te[0]||(te[0]=he=>Fi(f)?f.value=he:f=he),density:"compact",variant:"outlined",label:le(l)("northPole"),onClick:te[1]||(te[1]=he=>ne(le(wr).NORTH))},null,8,["modelValue","label"]),w(Ql,{"hide-details":"",modelValue:le(m),"onUpdate:modelValue":te[2]||(te[2]=he=>Fi(m)?m.value=he:m=he),density:"compact",variant:"outlined",label:le(l)("southPole"),onClick:te[3]||(te[3]=he=>ne(le(wr).SOUTH))},null,8,["modelValue","label"]),w(Ql,{"hide-details":"",modelValue:le(d),"onUpdate:modelValue":te[4]||(te[4]=he=>Fi(d)?d.value=he:d=he),density:"compact",variant:"outlined",label:le(l)("equator"),onClick:B},null,8,["modelValue","label"]),w(Ql,{"hide-details":"",modelValue:le(h),"onUpdate:modelValue":te[5]||(te[5]=he=>Fi(h)?h.value=he:h=he),density:"compact",variant:"outlined",label:le(l)("primeMeridian"),onClick:Q},null,8,["modelValue","label"]),w(ch,{thickness:8,color:"black",class:"mb-2"}),w(vr,{label:le(l)("latitude"),clearable:"",density:"compact",rules:[C],modelValue:le(g),"onUpdate:modelValue":te[6]||(te[6]=he=>Fi(g)?g.value=he:g=he)},null,8,["label","rules","modelValue"]),w(vr,{label:le(l)("longitude"),density:"compact",clearable:"",rules:[M],modelValue:le(v),"onUpdate:modelValue":te[7]||(te[7]=he=>Fi(v)?v.value=he:v=he)},null,8,["label","rules","modelValue"]),w(Qt,{disabled:x.value,variant:"outlined",density:"compact",onClick:te[8]||(te[8]=he=>D())},{default:U(()=>[$e(nt(le(l)("addPoint")),1)],void 0),_:1},8,["disabled"]),w(Qt,{disabled:V.value,variant:"outlined",density:"compact",onClick:te[9]||(te[9]=he=>O())},{default:U(()=>[$e(nt(le(l)("addLatitude")),1)],void 0),_:1},8,["disabled"]),w(Qt,{disabled:N.value,variant:"outlined",density:"compact",onClick:te[10]||(te[10]=he=>F())},{default:U(()=>[$e(nt(le(l)("addLongitude")),1)],void 0),_:1},8,["disabled"])]))}});function X2(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{northPole:i=>{const{normalize:n}=i;return n(["North Pole"])},southPole:i=>{const{normalize:n}=i;return n(["South Pole"])},latitude:i=>{const{normalize:n}=i;return n(["Degrees Latitude"])},longitude:i=>{const{normalize:n}=i;return n(["Degrees Longitude"])},numbersOnly:i=>{const{normalize:n}=i;return n(["Enter only numbers"])},latitudeRange:i=>{const{normalize:n}=i;return n(["Latitude must be between -90 and 90 degrees"])},longitudeRange:i=>{const{normalize:n}=i;return n(["Longitude must be between -180 and 180 degrees"])},addPoint:i=>{const{normalize:n}=i;return n(["Add Point"])},equator:i=>{const{normalize:n}=i;return n(["Equator"])},addLatitude:i=>{const{normalize:n}=i;return n(["Add Latitude"])},addLongitude:i=>{const{normalize:n}=i;return n(["Add Longitude"])},TropicOfCancer:i=>{const{normalize:n}=i;return n(["Tropic of Cancer"])},TropicOfCapricorn:i=>{const{normalize:n}=i;return n(["Tropic of Capricorn"])},arcticCircle:i=>{const{normalize:n}=i;return n(["Arctic Circle"])},antarcticCircle:i=>{const{normalize:n}=i;return n(["Antarctic Circle"])},primeMeridian:i=>{const{normalize:n}=i;return n(["Prime Meridian"])},N:i=>{const{normalize:n}=i;return n(["N"])},S:i=>{const{normalize:n}=i;return n(["S"])},E:i=>{const{normalize:n}=i;return n(["E"])},W:i=>{const{normalize:n}=i;return n(["W"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"northPole":"North Pole","southPole":"South Pole","latitude":"Degrees Latitude","longitude":"Degrees Longitude","numbersOnly":"Enter only numbers","latitudeRange":"Latitude must be between -90 and 90 degrees","longitudeRange":"Longitude must be between -180 and 180 degrees","addPoint":"Add Point","equator":"Equator","addLatitude":"Add Latitude","addLongitude":"Add Longitude","TropicOfCancer":"Tropic of Cancer","TropicOfCapricorn":"Tropic of Capricorn","arcticCircle":"Arctic Circle","antarcticCircle":"Antarctic Circle","primeMeridian":"Prime Meridian","N":"N","S":"S","E":"E","W":"W"}}'),delete e._Ctor}typeof X2=="function"&&X2(tG);const sye=Tn(tG,[["__scopeId","data-v-05c33c40"]]),oye={class:"body-1 font-weight-bold button-group-heading"},aye={class:"body-1 font-weight-bold button-group-heading"},VV=ri({__name:"EarthTool",setup(t){const e=An(),{isEarthMode:i,seNodules:n}=Ji(e),{t:r}=qn(),s=ge(),o=ge(),a=ge(""),l=ge(""),c=ge(!0);return He([()=>s.value,()=>o.value],()=>{if(s.value!=null&&o.value!=null){const u=new k;u.crossVectors(s.value.locationVector,o.value.locationVector),u.normalize();const h=new $t(s.value,u,o.value),d=new Jt(s.value,u,s.value.locationVector.angleTo(o.value.locationVector),o.value),f=new De("line",h);new Yy(d,s.value,o.value,f).execute(),s.value=void 0,o.value=void 0}}),He(()=>i.value,u=>{let h=new Dt;h.addCommand(new aE(u));let d=n.value.filter(f=>f instanceof On&&!(f instanceof en)).map(f=>f);d.length!==0&&d.forEach(f=>{let m=f.recordCurrentValueDisplayModeAndUpdate(u);h.addCommand(new Hp(f,m[0],m[1]))}),h.execute()}),(u,h)=>(Te(),Ct(mt,null,[w(Ql,{style:{"padding-left":"8px"},"hide-details":"",color:"primary",density:"compact",variant:"outlined",modelValue:le(i),"onUpdate:modelValue":h[0]||(h[0]=d=>Fi(i)?i.value=d:null),label:le(r)("earthMode")},null,8,["modelValue","label"]),w(ul,{style:{gap:"10px","padding-right":"8px"}},{default:U(()=>[w(ul,null,{default:U(()=>[w(nh,{style:{"border-radius":"8px"}},{default:U(()=>[w(cc,null,{default:U(()=>[tt("h3",oye,nt(le(r)("point")),1)],void 0,!0),_:1}),w(gl,null,{default:U(()=>[(Te(),qe(uw,null,{default:U(()=>[w(hv)],void 0,!0),_:1}))],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),w(ul,null,{default:U(()=>[w(nh,{style:{"border-radius":"8px"}},{default:U(()=>[w(cc,null,{default:U(()=>[tt("h3",aye,nt(le(r)("line")),1)],void 0,!0),_:1}),w(gl,null,{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-crosshairs-gps")],void 0,!0),_:1}),w(lt,null,{default:U(()=>[$e("mdi-map-marker")],void 0,!0),_:1}),(Te(),qe(uw,null,{default:U(()=>[w(hv,{isLine:!0,"place-id":a.value,"onUpdate:placeId":h[1]||(h[1]=d=>a.value=d),point:s.value,"onUpdate:point":h[2]||(h[2]=d=>s.value=d),"draw-line":c.value},null,8,["place-id","point","draw-line"])],void 0,!0),_:1})),(Te(),qe(uw,null,{default:U(()=>[w(hv,{isLine:!0,"place-id":l.value,"onUpdate:placeId":h[3]||(h[3]=d=>l.value=d),point:o.value,"onUpdate:point":h[4]||(h[4]=d=>o.value=d),"draw-line":c.value},null,8,["place-id","point","draw-line"])],void 0,!0),_:1})),w(Qt,{onClick:h[5]||(h[5]=d=>c.value=!c.value),disabled:a.value===null||l.value===null||a.value.length===0||l.value.length===0},{default:U(()=>[$e(nt(le(r)("draw")),1)],void 0,!0),_:1},8,["disabled"])],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1}),le(i)?(Te(),qe(sye,{key:0})):Vi("",!0)],64))}});function Y2(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{point:i=>{const{normalize:n}=i;return n(["Point"])},earthMode:i=>{const{normalize:n}=i;return n(["Earth Mode"])},line:i=>{const{normalize:n}=i;return n(["Line"])},draw:i=>{const{normalize:n}=i;return n(["Draw Segment"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"point":"Point","earthMode":"Earth Mode","line":"Line","draw":"Draw Segment"}}'),delete e._Ctor}function Z2(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"id",resource:{point:i=>{const{normalize:n}=i;return n(["Titik"])},earthMode:i=>{const{normalize:n}=i;return n(["Peta Bumi"])},line:i=>{const{normalize:n}=i;return n(["Garis"])},draw:i=>{const{normalize:n}=i;return n(["Tampilkan Segmen"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"id":{"point":"Titik","earthMode":"Peta Bumi","line":"Garis","draw":"Tampilkan Segmen"}}'),delete e._Ctor}typeof Y2=="function"&&Y2(VV);typeof Z2=="function"&&Z2(VV);const lye=Tn(VV,[["__scopeId","data-v-47438967"]]),iG=ri({__name:"LanguageSelector",setup(t){qn({useScope:"local"});const e=ge(!1),i=ge([{value:"en",title:" English (US)"},{value:"id",title:" Bahasa Indonesia"}]);return(n,r)=>{const s=Mo("t");return Te(),Ct(mt,null,[w(lt,{id:"lang",class:"mr-2"},{default:U(()=>[$e("mdi-translate")],void 0),_:1}),w(Ep,{activator:"#lang",modelValue:e.value,"onUpdate:modelValue":r[2]||(r[2]=o=>e.value=o),location:"bottom",offset:"32","close-on-content-click":!1},{default:U(()=>[w(uc,null,{default:U(()=>[fi(w(gP,null,null,512),[[s,"selectLanguage"]]),w(lh,null,{default:U(()=>[w(ym,{items:i.value,modelValue:n.$i18n.locale,"onUpdate:modelValue":r[0]||(r[0]=o=>n.$i18n.locale=o)},null,8,["items","modelValue"])],void 0,!0),_:1}),w(Op,null,{default:U(()=>[w(Qt,{variant:"outlined",onClick:r[1]||(r[1]=o=>e.value=!1)},{default:U(()=>[$e("OK")],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1},8,["modelValue"])],64)}}});function J2(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"",resource:{en:{selectLanguage:i=>{const{normalize:n}=i;return n(["Select Your Language"])}},id:{selectLanguage:i=>{const{normalize:n}=i;return n(["Pilih Bahasa"])}}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"selectLanguage":"Select Your Language"},"id":{"selectLanguage":"Pilih Bahasa"}}'),delete e._Ctor}typeof J2=="function"&&J2(iG);const V0=ri({__name:"HintButton",props:{tooltip:{},type:{},longLabel:{type:Boolean}},setup(t){const{attr:e}=q1(),i=t;return W(()=>i.longLabel?{maxWidth:"250px",wordWrap:"break-word",display:"inline-block",height:"1em",whiteSpace:"pre-line"}:{}),(n,r)=>(Te(),qe(Qt,ht(le(e),{class:"text-subtitle-2",ripple:"",icon:"",size:"x-small"}),{default:U(()=>[w(lt,null,{default:U(()=>[Ma(n.$slots,"icon")],void 0,!0),_:3}),w(dr,{location:"bottom",activator:"parent"},{default:U(()=>[tt("span",null,nt(n.tooltip),1)],void 0,!0),_:1})],void 0),_:3},16))}});var nG={exports:{}};(function(t,e){(function(i,n){n()})(Bc,function(){function i(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function n(c,u,h){var d=new XMLHttpRequest;d.open("GET",c),d.responseType="blob",d.onload=function(){l(d.response,u,h)},d.onerror=function(){console.error("could not download file")},d.send()}function r(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Bc=="object"&&Bc.global===Bc?Bc:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(c,u,h){var d=o.URL||o.webkitURL,f=document.createElement("a");u=u||c.name||"download",f.download=u,f.rel="noopener",typeof c=="string"?(f.href=c,f.origin===location.origin?s(f):r(f.href)?n(c,u,h):s(f,f.target="_blank")):(f.href=d.createObjectURL(c),setTimeout(function(){d.revokeObjectURL(f.href)},4e4),setTimeout(function(){s(f)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,h){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(i(c,h),u);else if(r(c))n(c,u,h);else{var d=document.createElement("a");d.href=c,d.target="_blank",setTimeout(function(){s(d)})}}:function(c,u,h,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof c=="string")return n(c,u,h);var f=c.type==="application/octet-stream",m=/constructor/i.test(o.HTMLElement)||o.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||f&&m||a)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var _=v.result;_=g?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=_:location=_,d=null},v.readAsDataURL(c)}else{var p=o.URL||o.webkitURL,b=p.createObjectURL(c);d?d.location=b:location.href=b,d=null,setTimeout(function(){p.revokeObjectURL(b)},4e4)}});o.saveAs=l.saveAs=l,t.exports=l})})(nG);var cye=nG.exports;const t1=IP(cye),hye=["src"],rG=ri({__name:"AuthenticatedUserToolbox",props:{expandedView:{type:Boolean}},setup(t){const e=Eh(),i=An(),{loginEnabled:n,userProfilePictureURL:r,userEmail:s,constructionDocId:o,includedTools:a}=Ji(e),{hasObjects:l,inverseTotalRotationMatrix:c,svgCanvas:u,canvasHeight:h,canvasWidth:d,isEarthMode:f}=Ji(i),{t:m}=qn(),{currentConstructionPreview:g,isPublicConstruction:v,privateConstructions:p}=_V(),b=ge(0),_=Fp(),P=fS(),E=cE(),T=LP(),C=ge(""),M=ge(null),x=ge(null),V=ge(!1),N=ge(!1),D=ge(""),O=ge(100);let F=null,X;const Z=t;qge(!0,B=>{if(!B.ctrlKey||!B.altKey)return b.value=0,!1;B.code==="KeyS"&&b.value===0?(b.value=1,B.preventDefault()):B.code==="KeyE"&&b.value===1?(b.value=2,n.value=!0,B.preventDefault()):(b.value=0,B.preventDefault())},{dedupe:!0});const K=W(()=>{var Q;return o.value===null?!1:(((Q=p.value)==null?void 0:Q.findIndex(fe=>fe.id===o.value))??-1)>=0});He(()=>o.value,()=>{C.value=""}),He(()=>N.value,B=>{if(!B||p.value===null)C.value="";else{const Q=p.value.findIndex(fe=>fe.id===o.value);C.value=Q>=0?p.value[Q].description:""}}),ki(()=>{var B;X=(B=u.value)==null?void 0:B.querySelector("svg"),F=_.onAuthStateChanged(Q=>{if(Q!==null){e.userEmail=Q.email??m("unknownEmail"),e.userProfilePictureURL=Q.photoURL??void 0,console.debug("User details",Q);const fe=vl(P,"users",Q.uid);yy(fe).then(ie=>{if(ie.exists()){console.debug("User data",ie.data());const{profilePictureURL:se,role:ee}=ie.data();se&&r.value===void 0&&(e.userProfilePictureURL=se),ee&&(e.userRole=ee.toLowerCase())}}),e.loginEnabled=!0}else e.userEmail=void 0,e.userProfilePictureURL=void 0})}),an(()=>{F&&(F(),F=null)});async function z(){_.currentUser!==null?(await _.signOut(),e.userEmail=void 0,e.userProfilePictureURL=void 0,e.userDisplayedName=void 0):T.replace({path:"/account"})}async function H(){var I;X===void 0&&(X=u.value.querySelector("svg"));const B=50*1024,Q=G=>new Promise((ue,Se)=>{const Ee=new FileReader;Ee.onerror=Se,Ee.onload=()=>{ue(Ee.result)},Ee.readAsDataURL(G)}),fe=L.dumpOpcode(),ie=c,se=_.currentUser.uid,ee=`users/${se}/constructions`,de=X.cloneNode(!0);de.setAttribute("xmlns","http://www.w3.org/2000/svg"),de.style.removeProperty("transform");const Y=new Blob([de.outerHTML],{type:"image/svg+xml;charset=utf-8"}),te=await Q(Y);let he;if(f.value){const G=document.getElementById("earth");he=await re([G.toDataURL(),te],d.value,h.value,"png")}else he=te;let ae;const A={version:"1",dateCreated:new Date().toISOString(),author:s.value,description:C.value,rotationMatrix:JSON.stringify(ie.value.elements),tools:a.value,aspectRatio:d.value/h.value,script:"",preview:""};if(N.value){const G=vl(P,ee.concat("/"+o.value));ae=tx(G,A).then(()=>G)}else ae=m2(I_(P,ee),A);ae.then(G=>{e.constructionDocId=G.id;const ue=fe.length<B?Promise.resolve(fe):gR(Mu(E,`scripts/${G.id}`),fe).then(Ee=>dp(Ee.ref)),Se=he.length<B?Promise.resolve(he):gR(Mu(E,`construction-svg/${G.id}`),he).then(Ee=>dp(Ee.ref));return Promise.all([G.id,ue,Se])}).then(async([G,ue,Se])=>{const Ee=vl(P,ee,G);if(V.value){const Oe=await m2(I_(P,"/constructions/"),{author:se,constructionDocId:G});await tx(Ee,{script:ue,preview:Se,publicDocId:Oe.id})}else await tx(Ee,{script:ue,preview:Se});return G}).then(G=>{$.fire("show-alert",{key:"constructions.firestoreConstructionSaved",keyOptions:{docId:G},type:"info"}),i.clearUnsavedFlag()}).catch(G=>{console.error("Can't save document",G.message),$.fire("show-alert",{key:m("construction.firestoreSaveError",{error:G}),keyOptions:{error:G},type:"error"})}),(I=M.value)==null||I.hide()}async function re(B,Q,fe,ie){const se=document.createElement("canvas");se.width=Q,se.height=fe;const ee=se.getContext("2d"),de=ie.toLowerCase(),Y=B.map(he=>new Promise(ae=>{const A=new Image;A.addEventListener("load",()=>{ee==null||ee.drawImage(A,0,0,Q,fe),ae(he)}),A.src=he}));return await Promise.all(Y),se.toDataURL(`image/${de}`)}function ne(){X===void 0&&(X=u.value.querySelector("svg"));const B=X.cloneNode(!0);B.setAttribute("xmlns","http://www.w3.org/2000/svg");const Q=new Blob([B.outerHTML],{type:"image/svg+xml;charset=utf-8"}),fe=URL.createObjectURL(Q);D.value==="SVG"?t1.saveAs(fe,"construction.svg"):re([fe],d.value,h.value,D.value).then(ie=>{t1.saveAs(ie,"construction."+D.value)})}return(B,Q)=>{const fe=ml("router-link");return Te(),Ct(mt,null,[le(n)?(Te(),Ct("div",{key:0,id:"authToolbox",style:mr({alignItems:Z.expandedView?"flex-start":"center"})},[le(n)?(Te(),Ct(mt,{key:0},[le(r)!==void 0?(Te(),qe(ah,{key:0,size:"x-small",contain:"","max-width":"48",image:le(r),onClick:z},null,8,["image"])):(Te(),qe(Qt,{key:1,fab:"",icon:"",size:"x-small",class:"bg-yellow",onClick:z},{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-account")],void 0,!0),_:1})],void 0),_:1})),le(_).currentUser!==null?(Te(),qe(fe,{key:2,to:"/settings/"},{default:U(()=>[w(lt,{color:"white",class:"mx-2"},{default:U(()=>[$e("mdi-cog")],void 0,!0),_:1})],void 0),_:1})):Vi("",!0),le(_).currentUser!==null?(Te(),qe(V0,{key:3,disabled:!le(l),onClick:Q[0]||(Q[0]=()=>{var ie;return(ie=M.value)==null?void 0:ie.show()}),tooltip:"Save construction"},{icon:U(()=>[$e("mdi-content-save")]),_:1},8,["disabled"])):Vi("",!0)],64)):Vi("",!0),le(o)&&le(v)(le(o))?(Te(),qe(V0,{key:1,tooltip:"Share saved cons"},{icon:U(()=>[$e("mdi-share-variant")]),_:1})):Vi("",!0),le(o)?(Te(),qe(V0,{key:2,onClick:Q[1]||(Q[1]=()=>{var ie;return(ie=x.value)==null?void 0:ie.show()}),tooltip:"Export Construction"},{icon:U(()=>[$e("mdi-file-export")]),_:1})):Vi("",!0)],4)):Vi("",!0),w(xu,{ref_key:"saveConstructionDialog",ref:M,title:V.value?le(m)("savePublicConstructionDialogTitle"):le(m)("savePrivateConstructionDialogTitle"),"yes-text":le(m)("saveAction"),"no-text":le(m)("cancelAction"),"yes-action":H,"max-width":"40%"},{default:U(()=>{var ie,se;return[w(vr,{type:"text",density:"compact",clearable:"",counter:"","persistent-hint":"",label:le(m)("construction.saveDescription"),required:"",modelValue:C.value,"onUpdate:modelValue":Q[2]||(Q[2]=ee=>C.value=ee),onKeypress:Q[3]||(Q[3]=Qx(()=>{},["stop"]))},null,8,["label","modelValue"]),w(Ql,{modelValue:V.value,"onUpdate:modelValue":Q[4]||(Q[4]=ee=>V.value=ee),disabled:((ie=le(_).currentUser)==null?void 0:ie.uid.length)===0,label:le(m)("construction.makePublic")},null,8,["modelValue","disabled","label"]),K.value?(Te(),qe(Ql,{key:0,modelValue:N.value,"onUpdate:modelValue":Q[5]||(Q[5]=ee=>N.value=ee),disabled:((se=le(_).currentUser)==null?void 0:se.uid.length)===0,label:le(m)("construction.saveOverwrite",{docId:le(o)})},null,8,["modelValue","disabled","label"])):Vi("",!0)]},void 0),_:1},8,["title","yes-text","no-text"]),w(xu,{ref_key:"exportConstructionDialog",ref:x,title:le(m)("exportConstructionDialogTitle"),"yes-text":le(m)("exportAction"),"no-text":le(m)("cancelAction"),"yes-action":ne,"max-width":"60%"},{default:U(()=>[w(pr,{align:"center",justify:"space-between"},{default:U(()=>[le(g)?(Te(),qe(Si,{key:0,cols:"6"},{default:U(()=>[tt("img",{id:"preview",src:le(g),width:"400"},null,8,hye)],void 0,!0),_:1})):Vi("",!0),w(Si,{cols:"6"},{default:U(()=>[w(pr,{class:"green"},{default:U(()=>[w(Si,{cols:"8",class:"pr-4"},{default:U(()=>[tt("p",null,nt(le(m)("sliderFileDimensions",{widthHeight:`${(O.value*le(d)/le(h)).toFixed(0)}x${O.value}`})),1),w(hp,{modelValue:O.value,"onUpdate:modelValue":Q[6]||(Q[6]=ie=>O.value=ie),class:"align-center",max:1500,min:100,step:8,"hide-details":""},null,8,["modelValue"])],void 0,!0),_:1}),w(Si,{cols:"4"},{default:U(()=>[w(vr,{type:"number",modelValue:O.value,"onUpdate:modelValue":Q[7]||(Q[7]=ie=>O.value=ie),class:"mt-0 pt-0","hide-details":"","single-line":"",onKeypress:Q[8]||(Q[8]=Qx(()=>{},["stop"]))},null,8,["modelValue"])],void 0,!0),_:1}),w(Si,{class:"d-flex",cols:"4"},{default:U(()=>[w(ym,{items:["SVG","PNG","JPEG","GIF","BMP"],label:le(m)("exportFormat"),modelValue:D.value,"onUpdate:modelValue":Q[9]||(Q[9]=ie=>D.value=ie),solo:""},null,8,["label","modelValue"])],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1},8,["title","yes-text","no-text"])],64)}}});function Q2(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{savePrivateConstructionDialogTitle:i=>{const{normalize:n}=i;return n(["Save Private Construction"])},savePublicConstructionDialogTitle:i=>{const{normalize:n}=i;return n(["Save Public Construction"])},exportConstructionDialogTitle:i=>{const{normalize:n}=i;return n(["Export Construction"])},exportAction:i=>{const{normalize:n}=i;return n(["Export"])},saveAction:i=>{const{normalize:n}=i;return n(["Save"])},cancelAction:i=>{const{normalize:n}=i;return n(["Cancel"])},unknownEmail:i=>{const{normalize:n}=i;return n(["Unknown email"])},construction:{saveDescription:i=>{const{normalize:n}=i;return n(["Description"])},saveOverwrite:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Overwrite the existing construction ",r(s("docId"))])},makePublic:i=>{const{normalize:n}=i;return n(["Make construction publicly available"])},firestoreSaveError:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Construction was not saved: ",r(s("error"))])}},sliderFileDimensions:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Exported file size ",r(s("widthHeight"))])},exportFormat:i=>{const{normalize:n}=i;return n(["Image Format"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"savePrivateConstructionDialogTitle":"Save Private Construction","savePublicConstructionDialogTitle":"Save Public Construction","exportConstructionDialogTitle":"Export Construction","exportAction":"Export","saveAction":"Save","cancelAction":"Cancel","unknownEmail":"Unknown email","construction":{"saveDescription":"Description","saveOverwrite":"Overwrite the existing construction {docId}","makePublic":"Make construction publicly available","firestoreSaveError":"Construction was not saved: {error}"},"sliderFileDimensions":"Exported file size {widthHeight}","exportFormat":"Image Format"}}'),delete e._Ctor}typeof Q2=="function"&&Q2(rG);const uye=Tn(rG,[["__scopeId","data-v-4cb0f29d"]]),i1={"001":1,AD:1,AE:6,AF:6,AG:0,AI:1,AL:1,AM:1,AN:1,AR:1,AS:0,AT:1,AU:1,AX:1,AZ:1,BA:1,BD:0,BE:1,BG:1,BH:6,BM:1,BN:1,BR:0,BS:0,BT:0,BW:0,BY:1,BZ:0,CA:0,CH:1,CL:1,CM:1,CN:1,CO:0,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DM:0,DO:0,DZ:6,EC:1,EE:1,EG:6,ES:1,ET:0,FI:1,FJ:1,FO:1,FR:1,GB:1,"GB-alt-variant":0,GE:1,GF:1,GP:1,GR:1,GT:0,GU:0,HK:0,HN:0,HR:1,HU:1,ID:0,IE:1,IL:0,IN:0,IQ:6,IR:6,IS:1,IT:1,JM:0,JO:6,JP:0,KE:0,KG:1,KH:0,KR:0,KW:6,KZ:1,LA:0,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MH:0,MK:1,MM:0,MN:1,MO:0,MQ:1,MT:0,MV:5,MX:0,MY:1,MZ:0,NI:0,NL:1,NO:1,NP:0,NZ:1,OM:6,PA:0,PE:0,PH:0,PK:0,PL:1,PR:0,PT:0,PY:0,QA:6,RE:1,RO:1,RS:1,RU:1,SA:0,SD:6,SE:1,SG:0,SI:1,SK:1,SM:1,SV:0,SY:6,TH:0,TJ:1,TM:1,TR:1,TT:0,TW:0,UA:1,UM:0,US:0,UY:1,UZ:1,VA:1,VE:0,VI:0,VN:1,WS:0,XK:1,YE:0,ZA:0,ZW:0};function dye(t,e){const i=[];let n=[];const r=sG(t),s=oG(t),o=(r.getDay()-i1[e.slice(-2).toUpperCase()]+7)%7,a=(s.getDay()-i1[e.slice(-2).toUpperCase()]+7)%7;for(let l=0;l<o;l++){const c=new Date(r);c.setDate(c.getDate()-(o-l)),n.push(c)}for(let l=1;l<=s.getDate();l++){const c=new Date(t.getFullYear(),t.getMonth(),l);n.push(c),n.length===7&&(i.push(n),n=[])}for(let l=1;l<7-a;l++){const c=new Date(s);c.setDate(c.getDate()+l),n.push(c)}return n.length>0&&i.push(n),i}function fye(t){const e=new Date(t);for(;e.getDay()!==0;)e.setDate(e.getDate()-1);return e}function mye(t){const e=new Date(t);for(;e.getDay()!==6;)e.setDate(e.getDate()+1);return e}function sG(t){return new Date(t.getFullYear(),t.getMonth(),1)}function oG(t){return new Date(t.getFullYear(),t.getMonth()+1,0)}function pye(t){const e=t.split("-").map(Number);return new Date(e[0],e[1]-1,e[2])}const gye=/^([12]\d{3}-([1-9]|0[1-9]|1[0-2])-([1-9]|0[1-9]|[12]\d|3[01]))$/;function aG(t){if(t==null)return new Date;if(t instanceof Date)return t;if(typeof t=="string"){let e;if(gye.test(t))return pye(t);if(e=Date.parse(t),!isNaN(e))return new Date(e)}return null}const eF=new Date(2e3,0,2);function vye(t){const e=i1[t.slice(-2).toUpperCase()];return eM(7).map(i=>{const n=new Date(eF);return n.setDate(eF.getDate()+e+i),new Intl.DateTimeFormat(t,{weekday:"narrow"}).format(n)})}function yye(t,e,i,n){const r=aG(t)??new Date,s=n==null?void 0:n[e];if(typeof s=="function")return s(r,e,i);let o={};switch(e){case"fullDateWithWeekday":o={weekday:"long",day:"numeric",month:"long",year:"numeric"};break;case"hours12h":o={hour:"numeric",hour12:!0};break;case"normalDateWithWeekday":o={weekday:"short",day:"numeric",month:"short"};break;case"keyboardDate":o={day:"2-digit",month:"2-digit",year:"numeric"};break;case"monthAndDate":o={month:"long",day:"numeric"};break;case"monthAndYear":o={month:"long",year:"numeric"};break;case"month":o={month:"long"};break;case"monthShort":o={month:"short"};break;case"dayOfMonth":return new Intl.NumberFormat(i).format(r.getDate());case"shortDate":o={year:"2-digit",month:"numeric",day:"numeric"};break;case"weekdayShort":o={weekday:"short"};break;case"year":o={year:"numeric"};break;default:o=s??{timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(i,o).format(r)}function Sye(t,e){const i=t.toJsDate(e),n=i.getFullYear(),r=ZL(String(i.getMonth()+1),2,"0"),s=ZL(String(i.getDate()),2,"0");return`${n}-${r}-${s}`}function bye(t){const[e,i,n]=t.split("-").map(Number);return new Date(e,i-1,n)}function _ye(t,e){const i=new Date(t);return i.setMinutes(i.getMinutes()+e),i}function Pye(t,e){const i=new Date(t);return i.setHours(i.getHours()+e),i}function Eye(t,e){const i=new Date(t);return i.setDate(i.getDate()+e),i}function wye(t,e){const i=new Date(t);return i.setDate(i.getDate()+e*7),i}function Tye(t,e){const i=new Date(t);return i.setMonth(i.getMonth()+e),i}function xye(t){return t.getFullYear()}function kye(t){return t.getMonth()}function Cye(t){return new Date(t.getFullYear(),t.getMonth()+1,1)}function Mye(t){return t.getHours()}function Aye(t){return t.getMinutes()}function Vye(t){return new Date(t.getFullYear(),0,1)}function Lye(t){return new Date(t.getFullYear(),11,31)}function Iye(t,e){return n1(t,e[0])&&Dye(t,e[1])}function Oye(t){const e=new Date(t);return e instanceof Date&&!isNaN(e.getTime())}function n1(t,e){return t.getTime()>e.getTime()}function Dye(t,e){return t.getTime()<e.getTime()}function tF(t,e){return t.getTime()===e.getTime()}function Nye(t,e){return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}function Rye(t,e){return t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}function Fye(t,e,i){const n=new Date(t),r=new Date(e);return i==="month"?n.getMonth()-r.getMonth()+(n.getFullYear()-r.getFullYear())*12:Math.floor((n.getTime()-r.getTime())/(1e3*60*60*24))}function zye(t,e){const i=new Date(t);return i.setHours(e),i}function Uye(t,e){const i=new Date(t);return i.setMinutes(e),i}function Bye(t,e){const i=new Date(t);return i.setMonth(e),i}function jye(t,e){const i=new Date(t);return i.setFullYear(e),i}function $ye(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate())}function Wye(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)}class Gye{constructor(e){this.locale=e.locale,this.formats=e.formats}date(e){return aG(e)}toJsDate(e){return e}toISO(e){return Sye(this,e)}parseISO(e){return bye(e)}addMinutes(e,i){return _ye(e,i)}addHours(e,i){return Pye(e,i)}addDays(e,i){return Eye(e,i)}addWeeks(e,i){return wye(e,i)}addMonths(e,i){return Tye(e,i)}getWeekArray(e){return dye(e,this.locale)}startOfWeek(e){return fye(e)}endOfWeek(e){return mye(e)}startOfMonth(e){return sG(e)}endOfMonth(e){return oG(e)}format(e,i){return yye(e,i,this.locale,this.formats)}isEqual(e,i){return tF(e,i)}isValid(e){return Oye(e)}isWithinRange(e,i){return Iye(e,i)}isAfter(e,i){return n1(e,i)}isBefore(e,i){return!n1(e,i)&&!tF(e,i)}isSameDay(e,i){return Nye(e,i)}isSameMonth(e,i){return Rye(e,i)}setMinutes(e,i){return Uye(e,i)}setHours(e,i){return zye(e,i)}setMonth(e,i){return Bye(e,i)}setYear(e,i){return jye(e,i)}getDiff(e,i,n){return Fye(e,i,n)}getWeekdays(){return vye(this.locale)}getYear(e){return xye(e)}getMonth(e){return kye(e)}getNextMonth(e){return Cye(e)}getHours(e){return Mye(e)}getMinutes(e){return Aye(e)}startOfDay(e){return $ye(e)}endOfDay(e){return Wye(e)}startOfYear(e){return Vye(e)}endOfYear(e){return Lye(e)}}const Hye=Symbol.for("vuetify:date-options"),iF=Symbol.for("vuetify:date-adapter");function qye(t,e){const i=qo({adapter:Gye,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"cs-CZ",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"no-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},t);return{options:i,instance:Kye(i,e)}}function Kye(t,e){const i=$r(typeof t.adapter=="function"?new t.adapter({locale:t.locale[e.current.value]??e.current.value,formats:t.formats}):t.adapter);return He(e.current,n=>{i.locale=t.locale[n]??n??i.locale}),i}const Xye=Symbol.for("vuetify:goto");function Yye(){return{container:void 0,duration:300,layout:!1,offset:0,easing:"easeInOutCubic",patterns:{linear:t=>t,easeInQuad:t=>t**2,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t**2:-1+(4-2*t)*t,easeInCubic:t=>t**3,easeOutCubic:t=>--t**3+1,easeInOutCubic:t=>t<.5?4*t**3:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t**4,easeOutQuart:t=>1- --t**4,easeInOutQuart:t=>t<.5?8*t**4:1-8*--t**4,easeInQuint:t=>t**5,easeOutQuint:t=>1+--t**5,easeInOutQuint:t=>t<.5?16*t**5:1+16*--t**5}}}function Zye(t,e){return{rtl:e.isRtl,options:qo(Yye(),t)}}function lG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:e,...i}=t,n=qo(e,i),{aliases:r={},components:s={},directives:o={}}=n,a=w7(n.defaults),l=zq(n.display,n.ssr),c=O7(n.theme),u=W7(n.icons),h=J7(n.locale),d=qye(n.date,h),f=Zye(n.goTo,h);return{install:g=>{for(const v in o)g.directive(v,o[v]);for(const v in s)g.component(v,s[v]);for(const v in r)g.component(v,El({...r[v],name:v,aliasName:r[v].name}));if(c.install(g),g.provide(Ym,a),g.provide(dk,l),g.provide(kv,c),g.provide(ok,u),g.provide(q0,h),g.provide(Hye,d.options),g.provide(iF,d.instance),g.provide(Xye,f),un&&n.ssr)if(g.$nuxt)g.$nuxt.hook("app:suspense:resolve",()=>{l.update()});else{const{mount:v}=g;g.mount=function(){const p=v(...arguments);return vn(()=>l.update()),g.mount=v,p}}Ao.reset(),g.mixin({computed:{$vuetify(){return $r({defaults:Yf.call(this,Ym),display:Yf.call(this,dk),theme:Yf.call(this,kv),icons:Yf.call(this,ok),locale:Yf.call(this,q0),date:Yf.call(this,iF)})}}})},defaults:a,display:l,theme:c,icons:u,locale:h,date:d,goTo:f}}const Jye="3.5.2";lG.version=Jye;function Yf(t){var n,r;const e=this.$,i=((n=e.parent)==null?void 0:n.provides)??((r=e.vnode.appContext)==null?void 0:r.provides);if(i&&t in i)return i[t]}const Qye=We({...Ut(),...B4()},"VLayout"),eSe=vt()({name:"VLayout",props:Qye(),setup(t,e){let{slots:i}=e;const{layoutClasses:n,layoutStyles:r,getLayoutItem:s,items:o,layoutRef:a}=j4(t);return Tt(()=>{var l;return w("div",{ref:a,class:[n.value,t.class],style:[r.value,t.style]},[(l=i.default)==null?void 0:l.call(i)])}),{getLayoutItem:s,items:o}}});function tSe(t){let{rootEl:e,isSticky:i,layoutItemStyles:n}=t;const r=_t(!1),s=_t(0),o=W(()=>{const c=typeof r.value=="boolean"?"top":r.value;return[i.value?{top:"auto",bottom:"auto",height:void 0}:void 0,r.value?{[c]:Lt(s.value)}:{top:n.value.top}]});ki(()=>{He(i,c=>{c?window.addEventListener("scroll",l,{passive:!0}):window.removeEventListener("scroll",l)},{immediate:!0})}),an(()=>{window.removeEventListener("scroll",l)});let a=0;function l(){const c=a>window.scrollY?"up":"down",u=e.value.getBoundingClientRect(),h=parseFloat(n.value.top??0),d=window.scrollY-Math.max(0,s.value-h),f=u.height+Math.max(s.value,h)-window.scrollY-window.innerHeight,m=parseFloat(getComputedStyle(e.value).getPropertyValue("--v-body-scroll-y"))||0;u.height<window.innerHeight-h?(r.value="top",s.value=h):c==="up"&&r.value==="bottom"||c==="down"&&r.value==="top"?(s.value=window.scrollY+u.top-m,r.value=!0):c==="down"&&f<=0?(s.value=0,r.value="bottom"):c==="up"&&d<=0&&(m?r.value!=="top"&&(s.value=-d+m+h,r.value="top"):(s.value=u.top+d,r.value="top")),a=window.scrollY}return{isStuck:r,stickyStyles:o}}const iSe=100,nSe=20;function nF(t){const e=1.41421356237;return(t<0?-1:1)*Math.sqrt(Math.abs(t))*e}function rF(t){if(t.length<2)return 0;if(t.length===2)return t[1].t===t[0].t?0:(t[1].d-t[0].d)/(t[1].t-t[0].t);let e=0;for(let i=t.length-1;i>0;i--){if(t[i].t===t[i-1].t)continue;const n=nF(e),r=(t[i].d-t[i-1].d)/(t[i].t-t[i-1].t);e+=(r-n)*Math.abs(r),i===t.length-1&&(e*=.5)}return nF(e)*1e3}function rSe(){const t={};function e(r){Array.from(r.changedTouches).forEach(s=>{(t[s.identifier]??(t[s.identifier]=new Z9(nSe))).push([r.timeStamp,s])})}function i(r){Array.from(r.changedTouches).forEach(s=>{delete t[s.identifier]})}function n(r){var c;const s=(c=t[r])==null?void 0:c.values().reverse();if(!s)throw new Error(`No samples for touch id ${r}`);const o=s[0],a=[],l=[];for(const u of s){if(o[0]-u[0]>iSe)break;a.push({t:u[0],d:u[1].clientX}),l.push({t:u[0],d:u[1].clientY})}return{x:rF(a),y:rF(l),get direction(){const{x:u,y:h}=this,[d,f]=[Math.abs(u),Math.abs(h)];return d>f&&u>=0?"right":d>f&&u<=0?"left":f>d&&h>=0?"down":f>d&&h<=0?"up":sSe()}}}return{addMovement:e,endTouch:i,getVelocity:n}}function sSe(){throw new Error}function oSe(t){let{isActive:e,isTemporary:i,width:n,touchless:r,position:s}=t;ki(()=>{window.addEventListener("touchstart",p,{passive:!0}),window.addEventListener("touchmove",b,{passive:!1}),window.addEventListener("touchend",_,{passive:!0})}),an(()=>{window.removeEventListener("touchstart",p),window.removeEventListener("touchmove",b),window.removeEventListener("touchend",_)});const o=W(()=>["left","right"].includes(s.value)),{addMovement:a,endTouch:l,getVelocity:c}=rSe();let u=!1;const h=_t(!1),d=_t(0),f=_t(0);let m;function g(E,T){return(s.value==="left"?E:s.value==="right"?document.documentElement.clientWidth-E:s.value==="top"?E:s.value==="bottom"?document.documentElement.clientHeight-E:Zf())-(T?n.value:0)}function v(E){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const C=s.value==="left"?(E-f.value)/n.value:s.value==="right"?(document.documentElement.clientWidth-E-f.value)/n.value:s.value==="top"?(E-f.value)/n.value:s.value==="bottom"?(document.documentElement.clientHeight-E-f.value)/n.value:Zf();return T?Math.max(0,Math.min(1,C)):C}function p(E){if(r.value)return;const T=E.changedTouches[0].clientX,C=E.changedTouches[0].clientY,M=25,x=s.value==="left"?T<M:s.value==="right"?T>document.documentElement.clientWidth-M:s.value==="top"?C<M:s.value==="bottom"?C>document.documentElement.clientHeight-M:Zf(),V=e.value&&(s.value==="left"?T<n.value:s.value==="right"?T>document.documentElement.clientWidth-n.value:s.value==="top"?C<n.value:s.value==="bottom"?C>document.documentElement.clientHeight-n.value:Zf());(x||V||e.value&&i.value)&&(u=!0,m=[T,C],f.value=g(o.value?T:C,e.value),d.value=v(o.value?T:C),l(E),a(E))}function b(E){const T=E.changedTouches[0].clientX,C=E.changedTouches[0].clientY;if(u){if(!E.cancelable){u=!1;return}const x=Math.abs(T-m[0]),V=Math.abs(C-m[1]);(o.value?x>V&&x>3:V>x&&V>3)?(h.value=!0,u=!1):(o.value?V:x)>3&&(u=!1)}if(!h.value)return;E.preventDefault(),a(E);const M=v(o.value?T:C,!1);d.value=Math.max(0,Math.min(1,M)),M>1?f.value=g(o.value?T:C,!0):M<0&&(f.value=g(o.value?T:C,!1))}function _(E){if(u=!1,!h.value)return;a(E),h.value=!1;const T=c(E.changedTouches[0].identifier),C=Math.abs(T.x),M=Math.abs(T.y);(o.value?C>M&&C>400:M>C&&M>3)?e.value=T.direction===({left:"right",right:"left",top:"down",bottom:"up"}[s.value]||Zf()):e.value=d.value>.5}const P=W(()=>h.value?{transform:s.value==="left"?`translateX(calc(-100% + ${d.value*n.value}px))`:s.value==="right"?`translateX(calc(100% - ${d.value*n.value}px))`:s.value==="top"?`translateY(calc(-100% + ${d.value*n.value}px))`:s.value==="bottom"?`translateY(calc(100% - ${d.value*n.value}px))`:Zf(),transition:"none"}:void 0);return{isDragging:h,dragProgress:d,dragStyles:P}}function Zf(){throw new Error}const aSe=["start","end","left","right","top","bottom"],lSe=We({color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:{type:Boolean,default:null},railWidth:{type:[Number,String],default:56},scrim:{type:[Boolean,String],default:!0},image:String,temporary:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:t=>aSe.includes(t)},sticky:Boolean,...Lu(),...Ut(),...wB(),...Tl(),...coe(),...cs(),...pn({tag:"nav"}),...wn()},"VNavigationDrawer"),sF=vt()({name:"VNavigationDrawer",props:lSe(),emits:{"update:modelValue":t=>!0,"update:rail":t=>!0},setup(t,e){let{attrs:i,emit:n,slots:r}=e;const{isRtl:s}=io(),{themeClasses:o}=Hn(t),{borderClasses:a}=Iu(t),{backgroundColorClasses:l,backgroundColorStyles:c}=Cs(bt(t,"color")),{elevationClasses:u}=xl(t),{displayClasses:h,mobile:d}=Dp(t),{roundedClasses:f}=hs(t),m=eB(),g=Oi(t,"modelValue",null,re=>!!re),{ssrBootStyles:v}=MP(),{scopeId:p}=Np(),b=ge(),_=_t(!1),P=W(()=>t.rail&&t.expandOnHover&&_.value?Number(t.width):Number(t.rail?t.railWidth:t.width)),E=W(()=>nk(t.location,s.value)),T=W(()=>!t.permanent&&(d.value||t.temporary)),C=W(()=>t.sticky&&!T.value&&E.value!=="bottom");ec(()=>t.expandOnHover&&t.rail!=null,()=>{He(_,re=>n("update:rail",!re))}),ec(()=>!t.disableResizeWatcher,()=>{He(T,re=>!t.permanent&&vn(()=>g.value=!re))}),ec(()=>!t.disableRouteWatcher&&!!m,()=>{He(m.currentRoute,()=>T.value&&(g.value=!1))}),He(()=>t.permanent,re=>{re&&(g.value=!0)}),to(()=>{t.modelValue!=null||T.value||(g.value=t.permanent||!d.value)});const{isDragging:M,dragProgress:x,dragStyles:V}=oSe({isActive:g,isTemporary:T,width:P,touchless:bt(t,"touchless"),position:E}),N=W(()=>{const re=T.value?0:t.rail&&t.expandOnHover?Number(t.railWidth):P.value;return M.value?re*x.value:re}),{layoutItemStyles:D,layoutItemScrimStyles:O}=hoe({id:t.name,order:W(()=>parseInt(t.order,10)),position:E,layoutSize:N,elementSize:P,active:W(()=>g.value||M.value),disableTransitions:W(()=>M.value),absolute:W(()=>t.absolute||C.value&&typeof F.value!="string")}),{isStuck:F,stickyStyles:X}=tSe({rootEl:b,isSticky:C,layoutItemStyles:D}),Z=Cs(W(()=>typeof t.scrim=="string"?t.scrim:null)),K=W(()=>({...M.value?{opacity:x.value*.2,transition:"none"}:void 0,...O.value}));Pl({VList:{bgColor:"transparent"}});function z(){_.value=!0}function H(){_.value=!1}return Tt(()=>{const re=r.image||t.image;return w(mt,null,[w(t.tag,ht({ref:b,onMouseenter:z,onMouseleave:H,class:["v-navigation-drawer",`v-navigation-drawer--${E.value}`,{"v-navigation-drawer--expand-on-hover":t.expandOnHover,"v-navigation-drawer--floating":t.floating,"v-navigation-drawer--is-hovering":_.value,"v-navigation-drawer--rail":t.rail,"v-navigation-drawer--temporary":T.value,"v-navigation-drawer--active":g.value,"v-navigation-drawer--sticky":C.value},o.value,l.value,a.value,h.value,u.value,f.value,t.class],style:[c.value,D.value,V.value,v.value,X.value,t.style]},p,i),{default:()=>{var ne,B,Q,fe;return[re&&w("div",{key:"image",class:"v-navigation-drawer__img"},[r.image?(ne=r.image)==null?void 0:ne.call(r,{image:t.image}):w("img",{src:t.image,alt:""},null)]),r.prepend&&w("div",{class:"v-navigation-drawer__prepend"},[(B=r.prepend)==null?void 0:B.call(r)]),w("div",{class:"v-navigation-drawer__content"},[(Q=r.default)==null?void 0:Q.call(r)]),r.append&&w("div",{class:"v-navigation-drawer__append"},[(fe=r.append)==null?void 0:fe.call(r)])]}}),w(xo,{name:"fade-transition"},{default:()=>[T.value&&(M.value||g.value)&&!!t.scrim&&w("div",ht({class:["v-navigation-drawer__scrim",Z.backgroundColorClasses.value],style:[K.value,Z.backgroundColorStyles.value],onClick:()=>g.value=!1},p),null)]})])}),{isStuck:F}}}),cSe=ri({__name:"AppNavigation",setup(t){const e=An(),i=Eh();Ji(e);const{userEmail:n}=Ji(i),{height:r,width:s,name:o}=Dp(),a=ge(!0),l=ge(!1),c=ge(!1),u=ge(0),h=ge(!0);function d(v){a.value=!0,h.value=!1,u.value=v,setTimeout(()=>{h.value=!0},1e3)}const f=ge(0);to(()=>{$.listen("left-panel-set-active-tab",m)}),ki(()=>{const{mainRect:v}=jM();console.log("Layout details",v),console.log("Display details",r.value,s.value,o.value)});function m(v){f.value=v.tabNumber}an(()=>{$.unlisten("left-panel-set-active-tab")});function g(v){c.value=v.type==="mouseover"}return(v,p)=>(Te(),qe(uc,null,{default:U(()=>[w(eSe,null,{default:U(()=>[w(sF,{fixed:"","expand-on-hover":h.value,rail:a.value,"rail-width":64,onMouseover:g,onMouseleave:g,style:{"background-color":"#002108",color:"white"}},{append:U(()=>[w(ch,{color:"#BDF3CB"}),w(uye,{"expanded-view":c.value},null,8,["expanded-view"]),w(Bm,{density:"compact",nav:""},{default:U(()=>[w(jo,{"prepend-icon":"mdi-account",title:le(n)},null,8,["title"]),w(iG)],void 0,!0),_:1})]),default:U(()=>[w(Bm,null,{default:U(()=>[w(jo,{"prepend-avatar":Eae,title:"Spherical Easel"})],void 0,!0),_:1}),w(ch,{color:"#BDF3CB"}),w(Bm,{density:"compact",nav:"","active-class":"active"},{default:U(()=>[w(jo,{onClick:p[0]||(p[0]=b=>d(0)),"prepend-icon":"mdi-tools",title:"Tools",value:"tools"}),w(jo,{onClick:p[1]||(p[1]=b=>d(1)),"prepend-icon":"mdi-axis",title:"Objects",value:"object"}),w(jo,{onClick:p[2]||(p[2]=b=>d(2)),"prepend-icon":"mdi-diameter",title:"Construction",value:"construction"}),w(jo,{onClick:p[3]||(p[3]=b=>d(3)),"prepend-icon":"mdi-earth",title:"Earth",value:"earth"})],void 0,!0),_:1})],void 0,!0),_:1},8,["expand-on-hover","rail"]),w(sF,{width:295,style:mr([{backgroundColor:"#B9D9C1",border:l.value?"":"0px"},{"padding-left":"8px","padding-top":"8px"}])},{default:U(()=>[u.value===0?(Te(),qe(gce,{key:0})):Vi("",!0),u.value===1?(Te(),qe(dhe,{key:1})):Vi("",!0),u.value===2?(Te(),qe(Cve,{key:2})):Vi("",!0),u.value===3?(Te(),qe(lye,{key:3})):Vi("",!0)],void 0,!0),_:1},8,["style"]),w($4,{style:mr({height:le(r)+"px"})},null,8,["style"])],void 0,!0),_:1})],void 0),_:1}))}});const hSe=Tn(cSe,[["__scopeId","data-v-2d39e2fc"]]),ud=ri({__name:"ShortcutIcon",props:{model:{}},setup(t){const e=An(),i=t;let n=ge(!1);ki(()=>{i.model.action==="undoAction"?($.listen("undo-enabled",r),n.value=L.commandHistory.length==0):i.model.action==="redoAction"&&($.listen("redo-enabled",r),n.value=L.redoHistory.length==0)}),an(()=>{i.model.action==="undoAction"?$.unlisten("undo-enabled"):i.model.action==="redoAction"&&$.unlisten("redo-enabled")});function r(o){n.value=!o.value}function s(){i.model.clickFunc?i.model.clickFunc():i.model.action&&e.setActionMode(i.model.action)}return(o,a)=>(Te(),qe(Qt,ht(o.$attrs,{icon:"",size:"x-small",tile:"",disabled:le(n),onClick:s}),{default:U(()=>[w(lt,k1(lP(o.$attrs)),{default:U(()=>[$e(nt(o.model.icon??"$"+o.model.action),1)],void 0,!0),_:1},16),w(dr,{activator:"parent",location:"bottom"},{default:U(()=>[$e(nt(o.$t(o.model.toolTipMessage)),1)],void 0,!0),_:1})],void 0),_:1},16,["disabled"]))}});class uv extends L{constructor(i,n,r,s){super();y(this,"magnificationFactor");y(this,"translationVector",[]);y(this,"previousMagnificationFactor");y(this,"previousTranslationVector",[]);this.magnificationFactor=i,this.previousMagnificationFactor=r;for(let o=0;o<2;o++)this.translationVector[o]=n[o],this.previousTranslationVector[o]=s[o]}set setMagnificationFactor(i){this.magnificationFactor=i}set setTranslationVector(i){for(let n=0;n<2;n++)this.translationVector[n]=i[n]}do(){L.store.setZoomMagnificationFactor(this.magnificationFactor),L.store.setZoomTranslation(this.translationVector),$.fire("zoom-updated",{})}saveState(){}restoreState(){L.store.setZoomMagnificationFactor(this.previousMagnificationFactor),L.store.setZoomTranslation(this.previousTranslationVector),$.fire("zoom-updated",{})}toOpcode(){return null}}class uSe extends it.Group{constructor(i){super();y(this,"path");y(this,"layer");y(this,"vertex1",new it.Vector(0,0));y(this,"vertex2",new it.Vector(1,0));y(this,"vertex3",new it.Vector(1,1));y(this,"vertex4",new it.Vector(1,0));this.layer=i,this.path=new it.Path([this.vertex1,this.vertex2,this.vertex3,this.vertex4],!0,!1),this.path.noFill(),this.path.stroke="hsla(0, 0%, 0%, 1)",this.path.opacity=1,this.path.linewidth=1,this.path.dashes.push(1,5),this.path.addTo(this)}move(i,n,r){this.path.vertices[0].set(i[0],-i[1]),this.path.vertices[1].set(i[0],-n[1]),this.path.vertices[2].set(n[0],-n[1]),this.path.vertices[3].set(n[0],-i[1]),r?(this.path.opacity=.5,this.path.linewidth=.5):(this.path.opacity=1,this.path.linewidth=.5)}show(){this.addTo(this.layer)}hide(){this.remove()}}const oF=10,aF=new k,lF=new it.Vector(0,0);class Yn extends _i{constructor(i){super(i);y(this,"currentSelection",[]);y(this,"highlightTimer",null);y(this,"highlightTimer2",null);y(this,"delayedStart",null);y(this,"highlightOn",!1);y(this,"mouseDownLocation",[]);y(this,"dragging",!1);y(this,"selectionRectangle");y(this,"selectionRectangleAdded",!1);y(this,"selectionRectangleSelection",[]);y(this,"keyPressSelection",[]);y(this,"keyPressHandler",i=>{var n;if(this.keyPressSelection.clear(),i.code==="KeyP"&&!i.shiftKey?Yn.store.sePoints.map(r=>r).filter(r=>!((r instanceof Le||r instanceof ut)&&!r.isUserCreated)&&r.showing).forEach(r=>{this.keyPressSelection.push(r),r.ref.glowingDisplay()}):i.code==="KeyC"&&!i.shiftKey?Yn.store.seCircles.map(r=>r).filter(r=>r.showing).forEach(r=>{this.keyPressSelection.push(r),r.ref.glowingDisplay()}):i.code==="KeyE"&&!i.shiftKey?Yn.store.seEllipses.map(r=>r).filter(r=>r.showing).forEach(r=>{this.keyPressSelection.push(r),r.ref.glowingDisplay()}):i.code==="KeyL"&&!i.shiftKey?Yn.store.seLines.map(r=>r).filter(r=>r.showing).forEach(r=>{this.keyPressSelection.push(r),r.ref.glowingDisplay()}):i.code==="KeyS"&&!i.shiftKey?Yn.store.seSegments.map(r=>r).filter(r=>r.showing).forEach(r=>{this.keyPressSelection.push(r),r.ref.glowingDisplay()}):i.code==="KeyA"&&i.shiftKey?Yn.store.seAngleMarkers.map(r=>r).filter(r=>r.showing).forEach(r=>{this.keyPressSelection.push(r),r.ref.glowingDisplay()}):i.code==="KeyP"&&i.shiftKey?Yn.store.seParametrics.map(r=>r).filter(r=>r.showing).forEach(r=>{var s;this.keyPressSelection.push(r),(s=r.ref)==null||s.glowingDisplay()}):i.code==="KeyO"&&i.shiftKey?Yn.store.sePolygons.map(r=>r).filter(r=>r.showing).forEach(r=>{this.keyPressSelection.push(r),r.ref.glowingDisplay()}):navigator.userAgent.indexOf("Mac OS X")!==-1?i.code==="KeyA"&&!i.shiftKey&&i.metaKey&&(Yn.store.seNodules.map(r=>r).filter(r=>r.showing&&!r.isLabel()).forEach(r=>{this.keyPressSelection.push(r),r.ref&&r.ref.glowingDisplay()}),i.preventDefault()):navigator.userAgent.indexOf("Mac OS X")===-1&&i.code==="KeyA"&&i.ctrlKey&&(Yn.store.seNodules.map(r=>r).filter(r=>r.showing&&!r.isLabel()).forEach(r=>{this.keyPressSelection.push(r),r.ref&&r.ref.glowingDisplay()}),i.preventDefault()),!(((n=this.hitSENodules)==null?void 0:n.length)<=1)&&i.key.match(/[0-9]/)){const r=Number(i.key)-1;this.hitSENodules.filter(s=>!(s instanceof Le&&!s.isUserCreated)&&!(s instanceof ut&&!s.isUserCreated)).forEach((s,o)=>{o===r?(this.keyPressSelection.push(s),s.ref.glowingDisplay(),this.infoText.text=s.name):s.selected||s.ref.normalDisplay()})}});this.selectionRectangle=new uSe(i[st.foregroundText])}mousePressed(i){this.isOnSphere&&(Yn.store.actionMode==="select"&&(Yn.store.setSelectedSENodules(this.currentSelection),Yn.store.selectedSENodules.length===0?$.fire("show-alert",{key:"handlers.selectionUpdateNothingSelected",keyOptions:{},type:"error"}):$.fire("show-alert",{key:"handlers.selectionUpdate",keyOptions:{number:`${Yn.store.selectedSENodules.length}`},type:"success"}),this.currentSelection.length>0&&this.highlightTimer===null?(this.highlightTimer=setInterval(this.blinkSelections.bind(this),1500),this.delayedStart=setTimeout(()=>{this.highlightTimer2=setInterval(this.blinkSelections.bind(this),1500)},300)):this.currentSelection.length===0&&this.highlightTimer!==null&&(clearInterval(this.highlightTimer),this.highlightTimer2&&clearInterval(this.highlightTimer2),this.delayedStart&&clearInterval(this.delayedStart),this.delayedStart=null,this.highlightTimer=null,this.highlightTimer2=null),this.mouseDownLocation.splice(0),this.dragging=!1,this.selectionRectangleAdded&&this.selectionRectangle.hide(),this.selectionRectangleAdded=!1,this.selectionRectangleSelection.splice(0)),this.mouseDownLocation=[this.currentScreenVector.x,this.currentScreenVector.y],this.selectionRectangleSelection.splice(0),this.hitSELabels[0]&&$.fire("show-alert",{key:"style.cannotSelectLabels",keyOptions:{},type:"warning"}))}blinkSelections(){this.highlightOn=!this.highlightOn,this.currentSelection.forEach(i=>{i.glowing=this.highlightOn})}mouseMoved(i){this.keyPressSelection.length!=0&&(this.keyPressSelection.forEach(n=>n.ref.normalDisplay()),this.keyPressSelection.splice(0)),super.mouseMoved(i),this.mouseDownLocation.length!==0?(this.dragging=!0,this.selectionRectangleAdded||(this.selectionRectangle.show(),this.selectionRectangleAdded=!0),this.selectionRectangle.move(this.mouseDownLocation,[this.currentScreenVector.x,this.currentScreenVector.y],i.shiftKey),this.highlight(this.mouseDownLocation,[this.currentScreenVector.x,this.currentScreenVector.y],i.shiftKey)):this.hitSEPoints.length>0?(!(this.hitSEPoints[0]instanceof ut)||this.hitSEPoints[0].isUserCreated)&&(!(this.hitSEPoints[0]instanceof Le)||this.hitSEPoints[0].isUserCreated)&&(this.hitSEPoints[0].glowing=!0):this.hitSELines.length>0?this.hitSELines[0].glowing=!0:this.hitSESegments.length>0?this.hitSESegments[0].glowing=!0:this.hitSECircles.length>0?this.hitSECircles[0].glowing=!0:this.hitSEEllipses.length>0?this.hitSEEllipses[0].glowing=!0:this.hitSEParametrics.length>0?this.hitSEParametrics[0].glowing=!0:this.hitSEAngleMarkers.length>0?this.hitSEAngleMarkers[0].glowing=!0:this.hitSEPolygons.length>0&&(this.hitSEPolygons[0].glowing=!0)}mouseReleased(i){if(!this.dragging)if(this.keyPressSelection.length!==0){const n=this.keyPressSelection.filter(r=>this.currentSelection.findIndex(s=>s.id===r.id)<0);n.forEach(r=>{r.selected=!0}),this.currentSelection.push(...n),this.keyPressSelection.splice(0)}else{const n=[];if(this.hitSEPoints.length>0?(!(this.hitSEPoints[0]instanceof ut)||this.hitSEPoints[0].isUserCreated)&&(!(this.hitSEPoints[0]instanceof Le)||this.hitSEPoints[0].isUserCreated)&&n.push(this.hitSEPoints[0]):this.hitSELines.length>0?n.push(this.hitSELines[0]):this.hitSESegments.length>0?n.push(this.hitSESegments[0]):this.hitSECircles.length>0?n.push(this.hitSECircles[0]):this.hitSEEllipses.length>0?n.push(this.hitSEEllipses[0]):this.hitSEParametrics.length>0?n.push(this.hitSEParametrics[0]):this.hitSEAngleMarkers.length>0?n.push(this.hitSEAngleMarkers[0]):this.hitSEPolygons.length>0&&n.push(this.hitSEPolygons[0]),i.altKey)if(n[0].selected=!n[0].selected,n[0].selected)this.currentSelection.push(n[0]);else{const r=this.currentSelection.findIndex(s=>s.id===n[0].id);r>=0&&this.currentSelection.splice(r,1)}else if(this.currentSelection.forEach(r=>{r.selected=!1}),n[0]!==void 0)n[0].selected=!0,this.currentSelection=[n[0]];else{this.currentSelection.splice(0);const r=new k(this.currentSphereVector.x,this.currentSphereVector.y,-1*this.currentSphereVector.z),s=Yn.store.findNearbySENodules(r,this.currentScreenVector).filter(o=>!o.isLabel()).filter(o=>o instanceof Le||o instanceof ut?o.isUserCreated?o.showing&&o.exists:o.exists:o.showing&&o.exists);!i.shiftKey&&s.length>0&&$.fire("show-alert",{key:"handlers.moveHandlerObjectOnBackOfSphere",keyOptions:{},type:"info"})}}Yn.store.setSelectedSENodules(this.currentSelection),this.currentSelection.length>0&&this.highlightTimer===null?(this.highlightTimer=setInterval(this.blinkSelections.bind(this),1500),this.delayedStart=setTimeout(()=>{this.highlightTimer2=setInterval(this.blinkSelections.bind(this),1500)},300)):this.currentSelection.length===0&&this.highlightTimer!==null&&(clearInterval(this.highlightTimer),this.highlightTimer2&&clearInterval(this.highlightTimer2),this.delayedStart&&clearInterval(this.delayedStart),this.delayedStart=null,this.highlightTimer=null,this.highlightTimer2=null),this.mouseDownLocation.splice(0),this.dragging=!1,this.selectionRectangleAdded&&this.selectionRectangle.hide(),this.selectionRectangleAdded=!1,this.selectionRectangleSelection.splice(0)}activate(){window.addEventListener("keydown",this.keyPressHandler),this.currentSelection.splice(0),this.selectionRectangleSelection.splice(0)}deactivate(){this.highlightTimer!==null&&(clearInterval(this.highlightTimer),this.highlightTimer=null,this.highlightTimer2&&clearInterval(this.highlightTimer2),this.highlightTimer2=null,this.delayedStart&&clearInterval(this.delayedStart),this.delayedStart=null),window.removeEventListener("keydown",this.keyPressHandler),$.fire("save-style-state",{}),this.selectionRectangle.hide(),this.selectionRectangleSelection.splice(0)}highlight(i,n,r){this.selectionRectangleSelection.forEach(v=>{const p=this.currentSelection.findIndex(b=>b.id===v.id);p!==-1&&this.currentSelection.splice(p,1),v.selected=!1}),this.selectionRectangleSelection.splice(0);const s=i[0]<n[0]?1:-1,o=i[1]<n[1]?1:-1;let a=0,l=0,c=0,u=0,h=0,d=0;const f=S.boundaryCircle.radius;let m=0,g=[];do{do h=i[0]+c,d=i[1]+u,h*h+d*d<f*f&&(lF.set(h,d),m=Math.sqrt(f*f-(h*h+d*d))*(r?-1:1),aF.set(h,d,m).normalize(),g=Yn.store.findNearbySENodules(aF,lF).filter(v=>!v.isLabel()).filter(v=>v instanceof Le||v instanceof ut?v.isUserCreated?v.showing&&v.exists:!1:v.showing&&v.exists).filter(v=>!(this.currentSelection.findIndex(p=>p.id===v.id)!==-1||this.selectionRectangleSelection.findIndex(p=>p.id===v.id)!==-1)),g.length!==0&&(g.forEach(v=>{v.ref&&v.ref.glowingDisplay(),v.selected=!0}),this.selectionRectangleSelection.push(...g))),a+=1,c=s*a*oF/Yn.store.zoomMagnificationFactor;while(Math.abs(i[0]-n[0])>Math.abs(c));a=0,l+=1,u=o*l*oF/Yn.store.zoomMagnificationFactor}while(Math.abs(i[1]-n[1])>Math.abs(u));this.currentSelection.push(...this.selectionRectangleSelection)}}class j_ extends _i{constructor(i){super(i);y(this,"isTemporaryPointAdded",!1);y(this,"snapToTemporaryOneDimensional",null);y(this,"startMarker");y(this,"tmpVector",new k);this.startMarker=new mi,j_.store.addTemporaryNodule(this.startMarker)}mousePressed(i){if(super.mouseMoved(i),this.isOnSphere)if(this.hitSEPoints.length>0){if(this.hitSEPoints[0]instanceof Le&&!this.hitSEPoints[0].isUserCreated||this.hitSEPoints[0]instanceof ut&&!this.hitSEPoints[0].isUserCreated){const n=new Dt;n.addCommand(new sn(this.hitSEPoints[0],!0)),n.execute();return}$.fire("show-alert",{key:"handlers.pointCreationAttemptDuplicate",keyOptions:{},type:"error"});return}else{const n=new Dt;let r=null,s=null;this.hitSESegments.length>0?(r=new kt(this.hitSESegments[0]),r.locationVector=this.currentSphereVector,s=new De("point",r),n.addCommand(new zt(r,this.hitSESegments[0],s))):this.hitSELines.length>0?(r=new kt(this.hitSELines[0]),r.locationVector=this.currentSphereVector,s=new De("point",r),n.addCommand(new zt(r,this.hitSELines[0],s))):this.hitSECircles.length>0?(r=new kt(this.hitSECircles[0]),r.locationVector=this.currentSphereVector,s=new De("point",r),n.addCommand(new zt(r,this.hitSECircles[0],s))):this.hitSEEllipses.length>0?(r=new kt(this.hitSEEllipses[0]),r.locationVector=this.currentSphereVector,s=new De("point",r),n.addCommand(new zt(r,this.hitSEEllipses[0],s))):this.hitSEParametrics.length>0?(r=new kt(this.hitSEParametrics[0]),r.locationVector=this.currentSphereVector,s=new De("point",r),n.addCommand(new zt(r,this.hitSEParametrics[0],s))):this.hitSEPolygons.length>0?(r=new kt(this.hitSEPolygons[0]),r.locationVector=this.currentSphereVector,s=new De("point",r),n.addCommand(new zt(r,this.hitSEPolygons[0],s))):(r=new Ze,r.locationVector=this.currentSphereVector,s=new De("point",r),n.addCommand(new Mn(r,s))),j_.addCreateAntipodeCommand(r,n),this.tmpVector.copy(r.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),s.locationVector=this.tmpVector,n.execute(),super.mouseLeave(i)}else this.isTemporaryPointAdded&&(this.startMarker.removeFromLayers(),this.isTemporaryPointAdded=!1)}mouseMoved(i){if(super.mouseMoved(i),this.hitSEPoints.length>0){const n=this.hitSEPoints.filter(r=>r instanceof Le&&!r.isUserCreated||r instanceof ut&&!r.isUserCreated);n.length>0&&(n[0].glowing=!0,this.snapToTemporaryOneDimensional=null)}else this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSESegments[0]):this.hitSELines.length>0?(this.hitSELines[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSELines[0]):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSECircles[0]):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEEllipses[0]):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEParametrics[0]):this.hitSEPolygons.length>0?(this.hitSEPolygons[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEPolygons[0]):this.snapToTemporaryOneDimensional=null;this.isOnSphere?(this.isTemporaryPointAdded||(this.isTemporaryPointAdded=!0,this.startMarker.addToLayers(this.layers)),this.snapToTemporaryOneDimensional===null?this.startMarker.positionVector=this.currentSphereVector:this.startMarker.positionVector=this.snapToTemporaryOneDimensional.closestVector(this.currentSphereVector),this.hitSEPoints.length>0&&this.isTemporaryPointAdded&&(this.startMarker.removeFromLayers(),this.isTemporaryPointAdded=!1,this.snapToTemporaryOneDimensional=null)):this.isTemporaryPointAdded&&(this.startMarker.removeFromLayers(),this.isTemporaryPointAdded=!1,this.snapToTemporaryOneDimensional=null)}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.isTemporaryPointAdded&&(this.startMarker.removeFromLayers(),this.isTemporaryPointAdded=!1),this.snapToTemporaryOneDimensional=null}activate(){super.activate()}deactivate(){super.deactivate()}}class Us extends _i{constructor(i){super(i);y(this,"startVector",new k);y(this,"normalVector",new k(0,0,0));y(this,"startSEPoint",null);y(this,"endSEPoint",null);y(this,"startSEPointOneDimensionalParent",null);y(this,"isTemporaryLineAdded",!1);y(this,"isTemporaryStartMarkerAdded",!1);y(this,"isTemporaryEndMarkerAdded",!1);y(this,"snapStartMarkerToTemporaryOneDimensional",null);y(this,"snapEndMarkerToTemporaryOneDimensional",null);y(this,"snapStartMarkerToTemporaryPoint",null);y(this,"snapEndMarkerToTemporaryPoint",null);y(this,"temporaryLine");y(this,"temporaryStartMarker");y(this,"temporaryEndMarker");y(this,"startLocationSelected",!1);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);this.temporaryLine=new _s,Us.store.addTemporaryNodule(this.temporaryLine),this.isTemporaryLineAdded=!1,this.temporaryStartMarker=new mi,Us.store.addTemporaryNodule(this.temporaryStartMarker),this.temporaryEndMarker=new mi,Us.store.addTemporaryNodule(this.temporaryEndMarker)}mousePressed(i){if(super.mouseMoved(i),this.isOnSphere&&!this.startLocationSelected){if(this.startLocationSelected=!0,this.hitSEPoints.length>0){const n=this.hitSEPoints[0];this.startVector.copy(n.locationVector),this.startSEPoint=this.hitSEPoints[0],this.temporaryStartMarker.positionVector=n.locationVector,this.startSEPoint.glowing=!0,this.startSEPoint.selected=!0}else this.hitSESegments.length>0?(this.startSEPointOneDimensionalParent=this.hitSESegments[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):this.hitSELines.length>0?(this.startSEPointOneDimensionalParent=this.hitSELines[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):this.hitSECircles.length>0?(this.startSEPointOneDimensionalParent=this.hitSECircles[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):this.hitSEEllipses.length>0?(this.startSEPointOneDimensionalParent=this.hitSEEllipses[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):this.hitSEParametrics.length>0?(this.startSEPointOneDimensionalParent=this.hitSEParametrics[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):this.hitSEPolygons.length>0?(this.startSEPointOneDimensionalParent=this.hitSEPolygons[0],this.startVector.copy(this.startSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryStartMarker.positionVector=this.startVector,this.startSEPoint=null):(this.temporaryStartMarker.positionVector=this.currentSphereVector,this.startVector.copy(this.currentSphereVector),this.startSEPoint=null);this.temporaryEndMarker.positionVector=this.currentSphereVector}}mouseMoved(i){super.mouseMoved(i),this.hitSEPoints.length>0?(this.hitSEPoints[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=this.hitSEPoints[0]):(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=this.hitSEPoints[0],this.snapEndMarkerToTemporaryPoint=null)):this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSESegments[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSESegments[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):this.hitSELines.length>0?(this.hitSELines[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSELines[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSELines[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSECircles[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSECircles[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSEEllipses[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSEEllipses[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSEParametrics[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSEParametrics[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):this.hitSEPolygons.length>0?(this.hitSEPolygons[0].glowing=!0,this.startLocationSelected?(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=this.hitSEPolygons[0],this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null):(this.snapStartMarkerToTemporaryOneDimensional=this.hitSEPolygons[0],this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)):(this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null),this.isOnSphere?this.startLocationSelected?(!this.isTemporaryStartMarkerAdded&&this.startSEPoint===null&&(this.isTemporaryStartMarkerAdded=!0,this.temporaryStartMarker.addToLayers(this.layers)),this.isTemporaryEndMarkerAdded||(this.isTemporaryEndMarkerAdded=!0,this.temporaryEndMarker.addToLayers(this.layers)),this.snapEndMarkerToTemporaryPoint!==null&&(this.temporaryEndMarker.removeFromLayers(),this.isTemporaryEndMarkerAdded=!1),this.snapEndMarkerToTemporaryOneDimensional!==null?this.temporaryEndMarker.positionVector=this.snapEndMarkerToTemporaryOneDimensional.closestVector(this.currentSphereVector):this.temporaryEndMarker.positionVector=this.currentSphereVector,this.isTemporaryLineAdded||(this.isTemporaryLineAdded=!0,this.temporaryLine.addToLayers(this.layers)),this.snapEndMarkerToTemporaryPoint===null?this.tmpVector.crossVectors(this.startVector,this.temporaryEndMarker.positionVector):this.tmpVector.crossVectors(this.startVector,this.snapEndMarkerToTemporaryPoint.locationVector),this.tmpVector.isZero(S.nearlyAntipodalIdeal)&&(this.normalVector.length()===0?(this.tmpVector.set(1,0,0),this.tmpVector.crossVectors(this.startVector,this.tmpVector),this.tmpVector.isZero(S.nearlyAntipodalIdeal)&&(this.tmpVector.set(0,1,0),this.tmpVector.crossVectors(this.startVector,this.tmpVector))):(this.tmpVector.crossVectors(this.startVector,this.normalVector),this.tmpVector.crossVectors(this.tmpVector,this.startVector))),this.normalVector.copy(this.tmpVector).normalize(),this.temporaryLine.normalVector=this.normalVector,this.temporaryLine.updateDisplay()):(this.isTemporaryStartMarkerAdded||(this.isTemporaryStartMarkerAdded=!0,this.temporaryStartMarker.addToLayers(this.layers)),this.snapStartMarkerToTemporaryPoint!==null&&(this.snapStartMarkerToTemporaryPoint instanceof Le&&!this.snapStartMarkerToTemporaryPoint.isUserCreated?this.temporaryStartMarker.positionVector=this.snapStartMarkerToTemporaryPoint.locationVector:(this.temporaryStartMarker.removeFromLayers(),this.isTemporaryStartMarkerAdded=!1)),this.snapStartMarkerToTemporaryOneDimensional!==null?this.temporaryStartMarker.positionVector=this.snapStartMarkerToTemporaryOneDimensional.closestVector(this.currentSphereVector):this.snapStartMarkerToTemporaryPoint==null&&(this.temporaryStartMarker.positionVector=this.currentSphereVector)):this.isTemporaryStartMarkerAdded&&(this.temporaryLine.removeFromLayers(),this.temporaryStartMarker.removeFromLayers(),this.temporaryEndMarker.removeFromLayers(),this.isTemporaryStartMarkerAdded=!1,this.isTemporaryEndMarkerAdded=!1,this.isTemporaryLineAdded=!1,this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null)}mouseReleased(i){this.isOnSphere&&(this.startLocationSelected?this.startVector.angleTo(this.currentSphereVector)>S.line.minimumLength&&(this.makeLine()||$.fire("show-alert",{key:"handlers.lineCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.mouseLeave(i)):(this.temporaryLine.removeFromLayers(),this.temporaryStartMarker.removeFromLayers(),this.temporaryEndMarker.removeFromLayers(),this.isTemporaryLineAdded=!1,this.isTemporaryStartMarkerAdded=!1,this.isTemporaryEndMarkerAdded=!1,this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null))}mouseLeave(i){super.mouseLeave(i),this.prepareForNextLine()}prepareForNextLine(){this.temporaryLine.removeFromLayers(),this.temporaryStartMarker.removeFromLayers(),this.temporaryEndMarker.removeFromLayers(),this.isTemporaryLineAdded=!1,this.isTemporaryStartMarkerAdded=!1,this.isTemporaryEndMarkerAdded=!1,this.snapStartMarkerToTemporaryOneDimensional=null,this.snapEndMarkerToTemporaryOneDimensional=null,this.snapStartMarkerToTemporaryPoint=null,this.snapEndMarkerToTemporaryPoint=null,this.startSEPoint&&(this.startSEPoint.glowing=!1,this.startSEPoint.selected=!1),this.startSEPoint=null,this.endSEPoint=null,this.startSEPointOneDimensionalParent=null,this.normalVector.set(0,0,0),this.startLocationSelected=!1,this.tmpVector.set(0,0,0),Us.store.unglowAllSENodules()}makeLine(i=!1){const n=new Dt,r=[];if(this.startSEPoint===null){let s=null,o=null;this.startSEPointOneDimensionalParent?(s=new kt(this.startSEPointOneDimensionalParent),o=new De("point",s),n.addCommand(new zt(s,this.startSEPointOneDimensionalParent,o))):(s=new Ze,o=new De("point",s),n.addCommand(new Mn(s,o))),s.locationVector=this.startVector;const a=Us.addCreateAntipodeCommand(s,n);r.push(s,a),this.tmpVector.copy(s.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),o.locationVector=this.tmpVector,this.startSEPoint=s}else(this.startSEPoint instanceof Le&&!this.startSEPoint.isUserCreated||this.startSEPoint instanceof ut&&!this.startSEPoint.isUserCreated)&&n.addCommand(new sn(this.startSEPoint,!0));if(this.hitSEPoints.length>0&&!i)this.endSEPoint=this.hitSEPoints[0],(this.endSEPoint instanceof Le&&!this.endSEPoint.isUserCreated||this.endSEPoint instanceof ut&&!this.endSEPoint.isUserCreated)&&n.addCommand(new sn(this.endSEPoint,!0));else if(!i){let s=null,o=null;this.hitSESegments.length>0?(s=new kt(this.hitSESegments[0]),s.locationVector=this.hitSESegments[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSESegments[0],o))):this.hitSELines.length>0?(s=new kt(this.hitSELines[0]),s.locationVector=this.hitSELines[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSELines[0],o))):this.hitSECircles.length>0?(s=new kt(this.hitSECircles[0]),s.locationVector=this.hitSECircles[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSECircles[0],o))):this.hitSEEllipses.length>0?(s=new kt(this.hitSEEllipses[0]),s.locationVector=this.hitSEEllipses[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSEEllipses[0],o))):this.hitSEParametrics.length>0?(s=new kt(this.hitSEParametrics[0]),s.locationVector=this.hitSEParametrics[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSEParametrics[0],o))):this.hitSEPolygons.length>0?(s=new kt(this.hitSEPolygons[0]),s.locationVector=this.hitSEPolygons[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSEPolygons[0],o))):(s=new Ze,s.locationVector=this.currentSphereVector,o=new De("point",s),n.addCommand(new Mn(s,o)));const a=Us.addCreateAntipodeCommand(s,n);r.push(a,s),this.endSEPoint=s,this.tmpVector.copy(s.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),o.locationVector=this.tmpVector}if(this.endSEPoint){if(this.tmpVector.crossVectors(this.startSEPoint.locationVector,this.endSEPoint.locationVector),this.tmpVector.isZero(S.nearlyAntipodalIdeal)&&(this.tmpVector.crossVectors(this.startSEPoint.locationVector,this.normalVector),this.tmpVector.crossVectors(this.tmpVector,this.startSEPoint.locationVector)),this.normalVector.copy(this.tmpVector).normalize(),this.temporaryLine.normalVector=this.normalVector,Us.store.seLines.some(a=>this.tmpVector.subVectors(a.normalVector,this.normalVector).isZero())||(this.tmpVector1.copy(this.normalVector).multiplyScalar(-1),Us.store.seLines.some(a=>this.tmpVector.subVectors(a.normalVector,this.tmpVector1).isZero())))return!1;const s=new $t(this.startSEPoint,this.normalVector,this.endSEPoint),o=new De("line",s);this.tmpVector.addVectors(this.startSEPoint.locationVector,this.endSEPoint.locationVector).normalize().add(new k(0,S.line.initialLabelOffset,0)).normalize(),o.locationVector=this.tmpVector,n.addCommand(new $P(s,this.startSEPoint,this.endSEPoint,o)),Us.store.createAllIntersectionsWithLine(s,r).forEach(a=>{if(a.existingIntersectionPoint)n.addCommand(new nr(a.SEIntersectionPoint,a.parent1));else{const l=a.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new ir(a.SEIntersectionPoint,a.parent1,a.parent2,l)),a.SEIntersectionPoint.showing=!1,l.showing=!1,a.createAntipodalPoint&&Us.addCreateAntipodeCommand(a.SEIntersectionPoint,n)}}),n.execute()}return!0}activate(){if(Us.store.selectedSENodules.length==2){const i=Us.store.selectedSENodules[0],n=Us.store.selectedSENodules[1];i instanceof Ze&&n instanceof Ze&&(this.tmpVector.crossVectors(i.locationVector,n.locationVector),this.tmpVector.isZero(S.nearlyAntipodalIdeal)&&(this.tmpVector.set(1,0,0),this.normalVector.crossVectors(i.locationVector,this.tmpVector),this.tmpVector.isZero(S.nearlyAntipodalIdeal)&&(this.tmpVector.set(0,1,0),this.normalVector.crossVectors(i.locationVector,this.tmpVector)),this.normalVector.normalize()),this.startSEPoint=i,this.endSEPoint=n,this.makeLine(!0)||$.fire("show-alert",{key:"handlers.lineCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.prepareForNextLine()),super.activate()}}deactivate(){super.deactivate()}}const dSe=new k;class ho extends _i{constructor(i){super(i);y(this,"centerVector");y(this,"temporaryCircle");y(this,"centerSEPoint",null);y(this,"centerLocationSelected",!1);y(this,"circleSEPoint",null);y(this,"centerSEPointOneDimensionalParent",null);y(this,"arcRadius",0);y(this,"temporaryStartMarker");y(this,"temporaryEndMarker");y(this,"tmpVector",new k);y(this,"tmpMatrix",new Pt);y(this,"temporaryCircleAdded",!1);y(this,"temporaryStartMarkerAdded",!1);y(this,"temporaryEndMarkerAdded",!1);y(this,"snapTemporaryPointMarkerToOneDimensional",null);y(this,"snapTemporaryPointMarkerToPoint",null);this.centerVector=new k,this.temporaryCircle=new Sa,ho.store.addTemporaryNodule(this.temporaryCircle),this.temporaryStartMarker=new mi,ho.store.addTemporaryNodule(this.temporaryStartMarker),this.temporaryEndMarker=new mi,ho.store.addTemporaryNodule(this.temporaryEndMarker)}mousePressed(i){if(this.isOnSphere&&!this.centerLocationSelected){if(this.centerLocationSelected=!0,this.hitSEPoints.length>0){const n=this.hitSEPoints[0];this.centerVector.copy(n.locationVector),this.centerSEPoint=n,this.temporaryStartMarker.positionVector=n.locationVector,this.temporaryCircle.centerVector=n.locationVector,this.centerSEPoint.glowing=!0,this.centerSEPoint.selected=!0}else this.hitSESegments.length>0?(this.centerSEPointOneDimensionalParent=this.hitSESegments[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryStartMarker.positionVector=this.centerVector,this.centerSEPoint=null):this.hitSELines.length>0?(this.centerSEPointOneDimensionalParent=this.hitSELines[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryStartMarker.positionVector=this.centerVector,this.centerSEPoint=null):this.hitSECircles.length>0?(this.centerSEPointOneDimensionalParent=this.hitSECircles[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryStartMarker.positionVector=this.centerVector,this.centerSEPoint=null):this.hitSEEllipses.length>0?(this.centerSEPointOneDimensionalParent=this.hitSEEllipses[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryStartMarker.positionVector=this.centerVector,this.centerSEPoint=null):this.hitSEParametrics.length>0?(this.centerSEPointOneDimensionalParent=this.hitSEParametrics[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryStartMarker.positionVector=this.centerVector,this.centerSEPoint=null):this.hitSEPolygons.length>0?(this.centerSEPointOneDimensionalParent=this.hitSEPolygons[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryStartMarker.positionVector=this.centerVector,this.centerSEPoint=null):(this.temporaryCircle.centerVector=this.currentSphereVector,this.temporaryStartMarker.positionVector=this.currentSphereVector,this.centerVector.copy(this.currentSphereVector),this.centerSEPoint=null);this.temporaryEndMarker.positionVector=this.currentSphereVector,$.fire("show-alert",{key:"handlers.circleCenterSelected",keyOptions:{},type:"info"})}}mouseMoved(i){super.mouseMoved(i);let n=null;this.hitSEPoints.length>0?n=this.hitSEPoints[0]:this.hitSESegments.length>0?n=this.hitSESegments[0]:this.hitSELines.length>0?n=this.hitSELines[0]:this.hitSECircles.length>0?n=this.hitSECircles[0]:this.hitSEEllipses.length>0?n=this.hitSEEllipses[0]:this.hitSEParametrics.length>0?n=this.hitSEParametrics[0]:this.hitSEPolygons.length>0?n=this.hitSEPolygons[0]:(this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null),n!==null&&(n instanceof Ze?(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=n):(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=n,this.snapTemporaryPointMarkerToPoint=null)),this.isOnSphere?this.centerLocationSelected?(this.temporaryEndMarkerAdded||(this.temporaryEndMarkerAdded=!0,this.temporaryEndMarker.addToLayers(this.layers)),this.snapTemporaryPointMarkerToPoint!==null&&((this.snapTemporaryPointMarkerToPoint instanceof Le||this.snapTemporaryPointMarkerToPoint instanceof ut)&&!this.snapTemporaryPointMarkerToPoint.isUserCreated?this.temporaryEndMarker.positionVector=this.snapTemporaryPointMarkerToPoint.locationVector:(this.temporaryEndMarker.removeFromLayers(),this.temporaryEndMarkerAdded=!1)),this.snapTemporaryPointMarkerToOneDimensional!==null?this.temporaryEndMarker.positionVector=this.snapTemporaryPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryPointMarkerToPoint===null&&(this.temporaryEndMarker.positionVector=this.currentSphereVector),this.temporaryCircleAdded||(this.temporaryCircleAdded=!0,this.temporaryCircle.addToLayers(this.layers)),this.snapTemporaryPointMarkerToPoint===null?this.arcRadius=this.temporaryCircle.centerVector.angleTo(this.temporaryEndMarker.positionVector):this.arcRadius=this.temporaryCircle.centerVector.angleTo(this.snapTemporaryPointMarkerToPoint.locationVector),this.temporaryCircle.circleRadius=this.arcRadius,this.temporaryCircle.updateDisplay()):(this.temporaryStartMarkerAdded||(this.temporaryStartMarkerAdded=!0,this.temporaryStartMarker.addToLayers(this.layers)),this.snapTemporaryPointMarkerToPoint!==null&&(this.snapTemporaryPointMarkerToPoint instanceof Le&&!this.snapTemporaryPointMarkerToPoint.isUserCreated?this.temporaryStartMarker.positionVector=this.snapTemporaryPointMarkerToPoint.locationVector:(this.temporaryStartMarker.removeFromLayers(),this.temporaryStartMarkerAdded=!1)),this.snapTemporaryPointMarkerToOneDimensional!==null?this.temporaryStartMarker.positionVector=this.snapTemporaryPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryPointMarkerToPoint==null&&(this.temporaryStartMarker.positionVector=this.currentSphereVector)):(this.centerLocationSelected?(this.temporaryEndMarker.removeFromLayers(),this.temporaryEndMarkerAdded=!1,this.temporaryCircle.removeFromLayers(),this.temporaryCircleAdded=!1):(this.temporaryStartMarker.removeFromLayers(),this.temporaryStartMarkerAdded=!1),this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null)}mouseReleased(i){if(this.isOnSphere&&this.centerLocationSelected){const n=this.currentSphereVector.angleTo(this.centerVector);n>S.circle.minimumRadius&&n<Math.PI-S.circle.minimumRadius&&(this.makeCircle()||$.fire("show-alert",{key:"handlers.circleCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.mouseLeave(i))}}mouseLeave(i){super.mouseLeave(i),this.prepareForNextCircle()}prepareForNextCircle(){this.temporaryCircle.removeFromLayers(),this.temporaryCircleAdded=!1,this.temporaryEndMarker.removeFromLayers(),this.temporaryEndMarkerAdded=!1,this.temporaryStartMarker.removeFromLayers(),this.temporaryStartMarkerAdded=!1,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null,this.centerSEPoint!==null&&(this.centerSEPoint.glowing=!1,this.centerSEPoint.selected=!1),this.circleSEPoint=null,this.centerSEPoint=null,this.centerSEPointOneDimensionalParent=null,this.centerLocationSelected=!1,ho.store.unglowAllSENodules()}makeCircle(i=!1){const n=new Dt,r=[];if(this.centerSEPoint===null){let s=null,o=null;this.centerSEPointOneDimensionalParent?(o=new kt(this.centerSEPointOneDimensionalParent),s=new De("point",o),n.addCommand(new zt(o,this.centerSEPointOneDimensionalParent,s))):(o=new Ze,s=new De("point",o),n.addCommand(new Mn(o,s))),o.locationVector=this.centerVector,this.tmpVector.copy(o.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),s.locationVector=this.tmpVector;const a=ho.addCreateAntipodeCommand(o,n);r.push(a,o),this.centerSEPoint=o}else(this.centerSEPoint instanceof Le&&!this.centerSEPoint.isUserCreated||this.centerSEPoint instanceof ut&&!this.centerSEPoint.isUserCreated)&&n.addCommand(new sn(this.centerSEPoint,!0));if(this.hitSEPoints.length>0&&!i)this.circleSEPoint=this.hitSEPoints[0],this.arcRadius=this.temporaryCircle.centerVector.angleTo(this.circleSEPoint.locationVector),this.temporaryCircle.circleRadius=this.arcRadius,this.temporaryCircle.updateDisplay(),(this.circleSEPoint instanceof Le&&!this.circleSEPoint.isUserCreated||this.circleSEPoint instanceof ut&&!this.circleSEPoint.isUserCreated)&&n.addCommand(new sn(this.circleSEPoint,!0));else if(!i){let s=null,o=null;this.hitSESegments.length>0?(s=new kt(this.hitSESegments[0]),s.locationVector=this.hitSESegments[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSESegments[0],o))):this.hitSELines.length>0?(s=new kt(this.hitSELines[0]),s.locationVector=this.hitSELines[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSELines[0],o))):this.hitSECircles.length>0?(s=new kt(this.hitSECircles[0]),s.locationVector=this.hitSECircles[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSECircles[0],o))):this.hitSEEllipses.length>0?(s=new kt(this.hitSEEllipses[0]),s.locationVector=this.hitSEEllipses[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSEEllipses[0],o))):this.hitSEParametrics.length>0?(s=new kt(this.hitSEParametrics[0]),s.locationVector=this.hitSEParametrics[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSEParametrics[0],o))):this.hitSEPolygons.length>0?(s=new kt(this.hitSEPolygons[0]),s.locationVector=this.hitSEPolygons[0].closestVector(this.currentSphereVector),o=new De("point",s),n.addCommand(new zt(s,this.hitSEPolygons[0],o))):(s=new Ze,s.locationVector=this.currentSphereVector,o=new De("point",s),n.addCommand(new Mn(s,o)));const a=ho.addCreateAntipodeCommand(s,n);r.push(a,s),this.circleSEPoint=s,this.tmpVector.copy(s.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),o.locationVector=this.tmpVector}if(this.circleSEPoint){if(this.temporaryEndMarker.positionVector=this.circleSEPoint.locationVector,this.arcRadius=this.temporaryCircle.centerVector.angleTo(this.circleSEPoint.locationVector),this.temporaryCircle.circleRadius=this.arcRadius,this.temporaryCircle.updateDisplay(),ho.store.seCircles.some(a=>this.tmpVector.subVectors(a.centerSEPoint.locationVector,this.centerSEPoint?this.centerSEPoint.locationVector:this.tmpVector).isZero()&&Math.abs(this.arcRadius-a.circleRadius)<S.tolerance))return!1;const s=new Kt(this.centerSEPoint,this.circleSEPoint,!1),o=new De("circle",s);this.tmpMatrix.makeRotationAxis(this.centerSEPoint.locationVector,Math.PI/2),this.tmpVector.copy(this.circleSEPoint.locationVector).applyMatrix4(this.tmpMatrix).add(new k(0,S.circle.initialLabelOffset,0)).normalize(),o.locationVector=this.tmpVector,n.addCommand(new Kp(s,this.centerSEPoint,this.circleSEPoint,o)),ho.store.createAllIntersectionsWithCircle(s,r).forEach(a=>{if(a.existingIntersectionPoint)n.addCommand(new nr(a.SEIntersectionPoint,a.parent1));else{const l=new De("point",a.SEIntersectionPoint);this.tmpVector.copy(a.SEIntersectionPoint.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),l.locationVector=this.tmpVector,n.addCommand(new ir(a.SEIntersectionPoint,a.parent1,a.parent2,l)),a.SEIntersectionPoint.showing=!1,l.showing=!1,a.createAntipodalPoint&&ho.addCreateAntipodeCommand(a.SEIntersectionPoint,n)}}),n.execute()}return!0}activate(){if(ho.store.selectedSENodules.length==2){const i=ho.store.selectedSENodules[0],n=ho.store.selectedSENodules[1];i instanceof Ze&&n instanceof Ze&&!dSe.crossVectors(i.locationVector,n.locationVector).isZero(S.nearlyAntipodalIdeal)&&(this.centerSEPoint=i,this.circleSEPoint=n,this.temporaryCircle.centerVector=i.locationVector,this.makeCircle(!0)||$.fire("show-alert",{key:"handlers.circleCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.prepareForNextCircle())}super.activate()}deactivate(){super.deactivate()}}class cG extends L{constructor(i){super();y(this,"rotationMat");y(this,"inverseRotation");this.rotationMat=i.clone(),this.inverseRotation=new Pt,this.inverseRotation.copy(this.rotationMat).invert()}do(){L.store.rotateSphere(this.rotationMat)}saveState(){}restoreState(){L.store.rotateSphere(this.inverseRotation)}toOpcode(){return null}}const Cg=new k,Bh=1e3/S.rotate.momentum.framesPerSecond,Il=Math.max(0,Math.min(S.rotate.momentum.decayTime*1e3,3e5)),Rs=new k,Rb=new k,Fb=new k;class bd extends _i{constructor(i){super(i);y(this,"startVector1",new k);y(this,"startVector2",new k);y(this,"startVector3",new k);y(this,"changeInPositionRotationMatrix",new Pt);y(this,"saveRotationNeeded",!1);y(this,"userIsRotating",!1);y(this,"momentumMode",!1);y(this,"previousTime",0);y(this,"derivative",0);y(this,"momentumAngle",0);y(this,"rotateAboutObjectMode",!1);y(this,"axisOfRotation",new k);y(this,"oldAxisOfRotation",new k);y(this,"rotationObject",null);y(this,"newObjectOfRotation",!0);y(this,"altKeyDown",!1);y(this,"keyDown",i=>{i.repeat||i.altKey&&(this.momentumMode=!1,$.fire("show-alert",{key:"handlers.rotationAboutEquator",keyOptions:{},type:"warning"}),this.altKeyDown=!0,this.rotationObject!==null&&this.rotationObject!==void 0&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1),this.rotationObject=null,this.rotateAboutObjectMode=!1,this.newObjectOfRotation=!0,this.axisOfRotation.set(0,1,0))});y(this,"keyUp",i=>{this.altKeyDown&&(this.momentumMode=!1,$.fire("show-alert",{key:"handlers.rotationNoObjectUpdate",keyOptions:{},type:"warning"}),this.altKeyDown=!1,this.rotationObject!==null&&this.rotationObject!==void 0&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1),this.rotationObject=null,this.rotateAboutObjectMode=!1,this.newObjectOfRotation=!0,this.axisOfRotation.set(0,1,0))})}mousePressed(i){var n,r,s,o;if(this.isOnSphere){if(this.momentumMode=!1,!i.altKey){let a="",l="";if(this.hitSEPoints.length>0){const c=this.hitSEPoints.filter(u=>!(u instanceof Le&&!u.isUserCreated||u instanceof ut&&!u.isUserCreated));c.length>0&&(this.rotationObject===null||this.rotationObject.id!==c[0].id?(this.rotationObject!==null&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1),this.rotationObject=c[0],this.oldAxisOfRotation.copy(this.axisOfRotation),this.axisOfRotation.copy(c[0].locationVector).normalize(),this.rotateAboutObjectMode=!0,a="objects.points",l=(n=c[0].label)==null?void 0:n.ref.shortUserName,this.newObjectOfRotation=!0,this.rotationObject.selected=!0,this.rotationObject.glowing=!0):this.rotationObject!==null&&this.rotationObject!==null&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1,a="",l="",this.newObjectOfRotation=!0,this.rotationObject=null,this.rotateAboutObjectMode=!1))}else this.hitSESegments.length>0?this.rotationObject===null||this.rotationObject.id!==this.hitSESegments[0].id?(this.rotationObject!==null&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1),this.rotationObject=this.hitSESegments[0],this.oldAxisOfRotation.copy(this.axisOfRotation),this.axisOfRotation.copy(this.hitSESegments[0].normalVector).normalize(),this.rotateAboutObjectMode=!0,a="objects.segments",l=(r=this.hitSESegments[0].label)==null?void 0:r.ref.shortUserName,this.newObjectOfRotation=!0,this.rotationObject.selected=!0,this.rotationObject.glowing=!0):this.rotationObject!==null&&this.rotationObject!==null&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1,a="",l="",this.newObjectOfRotation=!0,this.rotationObject=null,this.rotateAboutObjectMode=!1):this.hitSELines.length>0?this.rotationObject===null||this.rotationObject.id!==this.hitSELines[0].id?(this.rotationObject!==null&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1),this.rotationObject=this.hitSELines[0],this.oldAxisOfRotation.copy(this.axisOfRotation),this.axisOfRotation.copy(this.hitSELines[0].normalVector).normalize(),this.rotateAboutObjectMode=!0,a="objects.lines",l=(s=this.hitSELines[0].label)==null?void 0:s.ref.shortUserName,this.newObjectOfRotation=!0,this.rotationObject.selected=!0,this.rotationObject.glowing=!0):this.rotationObject!==null&&this.rotationObject!==null&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1,a="",l="",this.newObjectOfRotation=!0,this.rotationObject=null,this.rotateAboutObjectMode=!1):this.hitSECircles.length>0&&(this.rotationObject===null||this.rotationObject.id!==this.hitSECircles[0].id?(this.rotationObject!==null&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1),this.rotationObject=this.hitSECircles[0],this.oldAxisOfRotation.copy(this.axisOfRotation),this.axisOfRotation.copy(this.hitSECircles[0].centerSEPoint.locationVector).normalize(),this.rotateAboutObjectMode=!0,a="objects.circle",l=(o=this.hitSECircles[0].label)==null?void 0:o.ref.shortUserName,this.newObjectOfRotation=!0,this.rotationObject.selected=!0,this.rotationObject.glowing=!0):this.rotationObject!==null&&this.rotationObject!==null&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1,a="",l="",this.newObjectOfRotation=!0,this.rotationObject=null,this.rotateAboutObjectMode=!1));this.newObjectOfRotation&&(this.rotationObject!==null?($.fire("show-alert",{key:"handlers.rotationObjectUpdate",keyOptions:{type:String(_e.global.t(a,{name:l})),name:l},type:"success"}),this.newObjectOfRotation=!1):($.fire("show-alert",{key:"handlers.rotationNoObjectUpdate",keyOptions:{},type:"warning"}),this.newObjectOfRotation=!1))}this.userIsRotating=!0,this.startVector1.set(1,0,0),this.startVector2.set(0,1,0),this.startVector3.set(0,0,1),this.previousTime=i.timeStamp}}mouseMoved(i){if(this.trackMouseLocation(i),this.rotationObject!==null&&!this.userIsRotating&&!this.momentumMode&&(this.rotationObject.glowing=!0),!this.isOnSphere){this.rotationObject!==null&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1,$.fire("show-alert",{key:"handlers.rotationNoObjectUpdate",keyOptions:{},type:"warning"}),this.newObjectOfRotation=!0,this.rotationObject=null,this.rotateAboutObjectMode=!1);return}if(this.momentumMode)return;if(!this.userIsRotating){if(super.mouseMoved(i),this.hitSEPoints.length>0){const r=this.hitSEPoints.filter(s=>!(s instanceof Le&&!s.isUserCreated||s instanceof ut&&!s.isUserCreated));r.length>0&&(r[0].glowing=!0)}else this.hitSESegments.length>0?this.hitSESegments[0].glowing=!0:this.hitSELines.length>0?this.hitSELines[0].glowing=!0:this.hitSECircles.length>0&&(this.hitSECircles[0].glowing=!0);return}let n;this.rotationObject===null&&!i.altKey?n=this.previousSphereVector.angleTo(this.currentSphereVector):(this.rotationObject instanceof Ze&&!i.altKey?Rs.copy(this.rotationObject.locationVector):(this.rotationObject instanceof $t||this.rotationObject instanceof Jt)&&!i.altKey?Rs.copy(this.rotationObject.normalVector):Rs.set(0,1,0),Rb.crossVectors(Rs,this.previousSphereVector).isZero(S.nearlyAntipodalIdeal)||Fb.crossVectors(Rs,this.currentSphereVector).isZero(S.nearlyAntipodalIdeal)?n=0:(Rb.copy(this.previousSphereVector),Rb.addScaledVector(Rs,-1*Rs.dot(this.previousSphereVector)).normalize(),Fb.copy(this.currentSphereVector),Fb.addScaledVector(Rs,-1*Rs.dot(this.currentSphereVector)).normalize(),n=Rb.angleTo(Fb))),this.userIsRotating&&n>S.rotate.minAngle&&(this.rotateAboutObjectMode||i.altKey?(Rs.crossVectors(this.currentSphereVector,this.previousSphereVector),n*=-1*Math.sign(Rs.dot(this.axisOfRotation)),Cg.copy(this.axisOfRotation).normalize()):(Rs.crossVectors(this.previousSphereVector,this.currentSphereVector),Rs.isZero()?Cg.copy(this.oldAxisOfRotation).normalize():(this.oldAxisOfRotation.copy(Rs),Cg.copy(Rs).normalize())),this.changeInPositionRotationMatrix.makeRotationAxis(Cg,n),this.derivative=n/(i.timeStamp-this.previousTime),this.momentumAngle=n,this.previousTime=i.timeStamp,this.startVector1.applyMatrix4(this.changeInPositionRotationMatrix).normalize(),this.startVector2.applyMatrix4(this.changeInPositionRotationMatrix).normalize(),this.startVector3.applyMatrix4(this.changeInPositionRotationMatrix).normalize(),bd.store.rotateSphere(this.changeInPositionRotationMatrix),this.saveRotationNeeded=!0)}mouseReleased(i){if(this.userIsRotating){if(!this.isOnSphere){this.saveRotationNeeded&&(this.issueRotateSphereCommand(this.startVector1,this.startVector2,this.startVector3),this.saveRotationNeeded=!1),this.userIsRotating=!1,this.momentumMode=!1;return}this.momentumMode||(Il>0&&this.derivative!=0&&i.timeStamp-this.previousTime<S.rotate.momentum.pauseTimeToTemporarilyDisableMomentum*1e3?(this.momentumMode=!0,this.userIsRotating=!0,this.rotationObject!==null&&(this.rotationObject.glowing=!1),this.momentum(0)):this.saveRotationNeeded&&(this.issueRotateSphereCommand(this.startVector1,this.startVector2,this.startVector3),this.saveRotationNeeded=!1)),this.userIsRotating=!1}}mouseLeave(i){super.mouseLeave(i),this.userIsRotating&&this.saveRotationNeeded&&(this.issueRotateSphereCommand(this.startVector1,this.startVector2,this.startVector3),this.saveRotationNeeded=!1),this.momentumMode=!1,this.userIsRotating=!1,this.rotationObject!==null&&(this.rotationObject.glowing=!1,this.rotationObject.selected=!1),this.rotationObject=null,this.rotateAboutObjectMode=!1,this.newObjectOfRotation=!0,bd.store.unglowAllSENodules()}sleep(i){return new Promise(n=>setTimeout(n,i))}async momentum(i){this.momentumMode&&i*Bh<Il?(this.momentumAngle=this.derivative/(Il*Il)*(1/3*((i+1)*Bh-Il)*((i+1)*Bh-Il)*((i+1)*Bh-Il)-1/3*(i*Bh-Il)*(i*Bh-Il)*(i*Bh-Il)),this.changeInPositionRotationMatrix.makeRotationAxis(Cg,this.momentumAngle),this.startVector1.applyMatrix4(this.changeInPositionRotationMatrix).normalize(),this.startVector2.applyMatrix4(this.changeInPositionRotationMatrix).normalize(),this.startVector3.applyMatrix4(this.changeInPositionRotationMatrix).normalize(),$.fire("sphere-rotate",{transform:this.changeInPositionRotationMatrix}),this.saveRotationNeeded=!0,await this.sleep(Bh),this.momentum(i+1)):(this.momentumMode=!1,this.derivative=0,this.userIsRotating=!1,this.rotationObject!==null&&(this.rotationObject.glowing=!0),this.saveRotationNeeded&&(this.issueRotateSphereCommand(this.startVector1,this.startVector2,this.startVector3),this.saveRotationNeeded=!1))}activate(){var r,s,o;window.addEventListener("keydown",this.keyDown),window.addEventListener("keyup",this.keyUp);let i="",n="";if(bd.store.selectedSENodules.length==1){const a=bd.store.selectedSENodules[0];a instanceof Ze?(this.rotationObject=a,this.oldAxisOfRotation.copy(this.axisOfRotation),this.axisOfRotation.copy(a.locationVector).normalize(),this.rotateAboutObjectMode=!0,i="objects.points",n=(r=a.label)==null?void 0:r.ref.shortUserName):a instanceof $t?(this.rotationObject=a,this.oldAxisOfRotation.copy(this.axisOfRotation),this.axisOfRotation.copy(a.normalVector).normalize(),this.rotateAboutObjectMode=!0,i="objects.lines",n=(s=a.label)==null?void 0:s.ref.shortUserName):a instanceof Jt&&(this.rotationObject=a,this.oldAxisOfRotation.copy(this.axisOfRotation),this.axisOfRotation.copy(a.normalVector).normalize(),this.rotateAboutObjectMode=!0,i="objects.segments",n=(o=a.label)==null?void 0:o.ref.shortUserName),this.rotationObject!==null&&$.fire("show-alert",{key:"handlers.rotationObjectUpdate",keyOptions:{type:String(_e.global.t(i,{name:n})),name:n},type:"success"})}super.activate(),this.rotationObject!==null&&(this.rotationObject.selected=!0,this.rotationObject.glowing=!0)}deactivate(){window.removeEventListener("keydown",this.keyDown),window.removeEventListener("keyup",this.keyUp),this.rotationObject!==null&&(this.rotationObject.selected=!1,this.rotationObject.glowing=!1),this.rotationObject=null,this.rotateAboutObjectMode=!1}issueRotateSphereCommand(i,n,r){this.changeInPositionRotationMatrix.makeBasis(i,n,r),new cG(this.changeInPositionRotationMatrix).push()}}class $_ extends _i{constructor(i){super(i);y(this,"isTemporaryPointAdded",!1);y(this,"startMarker");y(this,"snapToTemporaryOneDimensional",null);y(this,"oneDimensional",null);y(this,"tmpVector",new k);this.startMarker=new mi,$_.store.addTemporaryNodule(this.startMarker)}mousePressed(i){if(this.mouseMoved(i),this.isOnSphere){if(this.hitSEPoints.length===0&&(this.hitSESegments.length>0?this.oneDimensional=this.hitSESegments[0]:this.hitSELines.length>0?this.oneDimensional=this.hitSELines[0]:this.hitSECircles.length>0?this.oneDimensional=this.hitSECircles[0]:this.hitSEEllipses.length>0?this.oneDimensional=this.hitSEEllipses[0]:this.hitSEParametrics.length>0?this.oneDimensional=this.hitSEParametrics[0]:this.hitSEPolygons.length>0&&(this.oneDimensional=this.hitSEPolygons[0])),this.oneDimensional!==null){const n=new Dt,r=new kt(this.oneDimensional);r.locationVector=this.oneDimensional.closestVector(this.currentSphereVector);const s=r.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new zt(r,this.oneDimensional,s)),$_.addCreateAntipodeCommand(r,n),n.execute(),this.mouseMoved(i),this.oneDimensional=null}}else this.isTemporaryPointAdded&&(this.startMarker.removeFromLayers(),this.isTemporaryPointAdded=!1,this.snapToTemporaryOneDimensional=null)}mouseMoved(i){super.mouseMoved(i),this.hitSEPoints.length===0&&(this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSESegments[0]):this.hitSELines.length>0?(this.hitSELines[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSELines[0]):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSECircles[0]):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEEllipses[0]):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEParametrics[0]):this.hitSEPolygons.length>0&&(this.hitSEPolygons[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEPolygons[0])),this.isOnSphere?(this.isTemporaryPointAdded||(this.isTemporaryPointAdded=!0,this.startMarker.addToLayers(this.layers)),this.snapToTemporaryOneDimensional===null?this.startMarker.positionVector=this.currentSphereVector:this.startMarker.positionVector=this.snapToTemporaryOneDimensional.closestVector(this.currentSphereVector),(this.hitSEPoints.length>0||this.hitSENodules.length===0)&&(this.startMarker.removeFromLayers(),this.isTemporaryPointAdded=!1,this.snapToTemporaryOneDimensional=null)):this.isTemporaryPointAdded&&(this.startMarker.removeFromLayers(),this.isTemporaryPointAdded=!1,this.snapToTemporaryOneDimensional=null)}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.isTemporaryPointAdded&&(this.startMarker.removeFromLayers(),this.isTemporaryPointAdded=!1),this.snapToTemporaryOneDimensional=null,this.oneDimensional=null}}class da extends _i{constructor(i){super(i);y(this,"oneDimensional1",null);y(this,"oneDimensional2",null);y(this,"updatedIntersectionInfo",[])}mousePressed(i){var n;if(this.isOnSphere){if(this.hitSEPoints.length>0){if(this.hitSEPoints[0]instanceof Le&&!this.hitSEPoints[0].isUserCreated||this.hitSEPoints[0]instanceof ut&&!this.hitSEPoints[0].isUserCreated){new sn(this.hitSEPoints[0],!0).execute();return}return}this.oneDimensional1==null?(this.hitSESegments.length>0?this.oneDimensional1=this.hitSESegments[0]:this.hitSELines.length>0?this.oneDimensional1=this.hitSELines[0]:this.hitSECircles.length>0?this.oneDimensional1=this.hitSECircles[0]:this.hitSEEllipses.length>0?this.oneDimensional1=this.hitSEEllipses[0]:this.hitSEParametrics.length>0&&(this.oneDimensional1=this.hitSEParametrics[0]),this.oneDimensional1!==null&&(this.oneDimensional1.selected=!0,$.fire("show-alert",{key:"handlers.intersectionOneDimensionalSelected",keyOptions:{name:`${(n=this.oneDimensional1.label)==null?void 0:n.ref.shortUserName}`},type:"info"}))):this.oneDimensional2==null&&(this.hitSESegments.length>0?this.oneDimensional2=this.hitSESegments[0]:this.hitSELines.length>0?this.oneDimensional2=this.hitSELines[0]:this.hitSECircles.length>0?this.oneDimensional2=this.hitSECircles[0]:this.hitSEEllipses.length>0?this.oneDimensional2=this.hitSEEllipses[0]:this.hitSEParametrics.length>0&&(this.oneDimensional2=this.hitSEParametrics[0]),this.oneDimensional2!==null&&(this.oneDimensional1.id!==this.oneDimensional2.id?this.oneDimensional2.selected=!0:(this.oneDimensional2=null,$.fire("show-alert",{key:"handlers.intersectionOneDimensionalDuplicate",keyOptions:{},type:"error"})))),this.oneDimensional1!=null&&this.oneDimensional2!=null&&(this.doIntersection(this.oneDimensional1,this.oneDimensional2),this.oneDimensional1.selected=!1,this.oneDimensional1=null,this.oneDimensional2.selected=!1,this.oneDimensional2=null,this.updatedIntersectionInfo.clear())}}mouseMoved(i){if(super.mouseMoved(i),this.hitSEPoints.length>0&&this.oneDimensional1===null){const n=this.hitSEPoints.filter(r=>r instanceof Le&&!r.isUserCreated||r instanceof ut&&!r.isUserCreated);n.length>0&&(n[0].glowing=!0)}else this.hitSELines.length>0?this.oneDimensional1!==null?da.store.findIntersectionPointsByParent(this.oneDimensional1.name,this.hitSELines[0].name).some(n=>n.exists&&!n.isUserCreated)&&(this.hitSELines[0].glowing=!0):this.hitSELines[0].glowing=!0:this.hitSESegments.length>0?this.oneDimensional1!==null?da.store.findIntersectionPointsByParent(this.oneDimensional1.name,this.hitSESegments[0].name).some(n=>n.exists&&!n.isUserCreated)&&(this.hitSESegments[0].glowing=!0):this.hitSESegments[0].glowing=!0:this.hitSECircles.length>0?this.oneDimensional1!==null?da.store.findIntersectionPointsByParent(this.oneDimensional1.name,this.hitSECircles[0].name).some(n=>n.exists&&!n.isUserCreated)&&(this.hitSECircles[0].glowing=!0):this.hitSECircles[0].glowing=!0:this.hitSEEllipses.length>0?this.oneDimensional1!==null?da.store.findIntersectionPointsByParent(this.oneDimensional1.name,this.hitSEEllipses[0].name).some(n=>n.exists&&!n.isUserCreated)&&(this.hitSEEllipses[0].glowing=!0):this.hitSEEllipses[0].glowing=!0:this.hitSEParametrics.length>0&&(this.oneDimensional1!==null?da.store.findIntersectionPointsByParent(this.oneDimensional1.name,this.hitSEParametrics[0].name).some(n=>n.exists&&!n.isUserCreated)&&(this.hitSEParametrics[0].glowing=!0):this.hitSEParametrics[0].glowing=!0)}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.oneDimensional1&&(this.oneDimensional1.selected=!1,this.oneDimensional1=null),this.oneDimensional2&&(this.oneDimensional2.selected=!1,this.oneDimensional2=null)}doIntersection(i,n){const r=da.store.inverseTotalRotationMatrix,s=Ol(i),o=Ol(n);if(s===o&&n.name>i.name||o<s){const l=i;i=n,n=l}lm(i,n,r).forEach(l=>this.updatedIntersectionInfo.push(l));const a=new Dt;da.store.findIntersectionPointsByParent(i.name,n.name).forEach((l,c)=>{l.isUserCreated?$.fire("show-alert",{key:"handlers.intersectionOneDimensionalAlreadyExists",keyOptions:{},type:"error"}):this.updatedIntersectionInfo[c].exists?(a.addCommand(new sn(l,!0)),$.fire("show-alert",{key:"handlers.intersectionOneDimensionalPointCreated",keyOptions:{},type:"success"})):c===0&&$.fire("show-alert",{key:"handlers.intersectionOneDimensionalNotIntersect",keyOptions:{},type:"error"})}),a.execute()}activate(){if(da.store.selectedSENodules.length==2){const i=da.store.selectedSENodules[0],n=da.store.selectedSENodules[1];i.isOneDimensional()&&n.isOneDimensional()&&this.doIntersection(i,n)}super.activate()}deactivate(){super.deactivate()}}class fSe extends L{constructor(i,n){super();y(this,"seIntersectionPoint");y(this,"seIntersectionParent");this.seIntersectionPoint=i,this.seIntersectionParent=n}do(){this.seIntersectionPoint.antipodalPointId=this.seIntersectionParent.id,this.seIntersectionPoint.shallowUpdate()}saveState(){}restoreState(){this.seIntersectionPoint.antipodalPointId=-1,this.seIntersectionPoint.shallowUpdate()}toOpcode(){return null}}class fa extends _i{constructor(i){super(i);y(this,"parentPoint",null);y(this,"oneDimensionalContainingParentPoint",null);y(this,"snapToTemporaryOneDimensional",null);y(this,"snapToTemporaryPoint",null);y(this,"parentPointVector",new k(0,0,0));y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"temporaryAntipodeMarker");y(this,"temporaryPointMarker");y(this,"isTemporaryAntipodeAdded",!1);y(this,"isTemporaryPointAdded",!1);this.temporaryAntipodeMarker=new mi,fa.store.addTemporaryNodule(this.temporaryAntipodeMarker),this.temporaryPointMarker=new mi,fa.store.addTemporaryNodule(this.temporaryPointMarker)}mousePressed(i){if(super.mouseMoved(i),this.isOnSphere){if(this.hitSEPoints.length>0){this.parentPoint=this.hitSEPoints[0],this.parentPoint&&this.tmpVector1.copy(this.parentPoint.locationVector).multiplyScalar(-1);const n=fa.store.sePoints.findIndex(s=>!!this.tmpVector.subVectors(this.tmpVector1,s.locationVector).isZero());let r=null;if(n===-1)throw new Error(`AntipodePointHandler: The point ${this.parentPoint.name} doesn't have an antipode!`);r=fa.store.sePoints[n],this.revealAntipode(r,this.parentPoint)}else this.hitSESegments.length>0?(this.oneDimensionalContainingParentPoint=this.hitSESegments[0],this.parentPointVector.copy(this.oneDimensionalContainingParentPoint.closestVector(this.currentSphereVector)),this.parentPoint=null):this.hitSELines.length>0?(this.oneDimensionalContainingParentPoint=this.hitSELines[0],this.parentPointVector.copy(this.oneDimensionalContainingParentPoint.closestVector(this.currentSphereVector)),this.parentPoint=null):this.hitSECircles.length>0?(this.oneDimensionalContainingParentPoint=this.hitSECircles[0],this.parentPointVector.copy(this.oneDimensionalContainingParentPoint.closestVector(this.currentSphereVector)),this.parentPoint=null):this.hitSEEllipses.length>0?(this.oneDimensionalContainingParentPoint=this.hitSEEllipses[0],this.parentPointVector.copy(this.oneDimensionalContainingParentPoint.closestVector(this.currentSphereVector)),this.parentPoint=null):this.hitSEPolygons.length>0?(this.oneDimensionalContainingParentPoint=this.hitSEPolygons[0],this.parentPointVector.copy(this.oneDimensionalContainingParentPoint.closestVector(this.currentSphereVector)),this.parentPoint=null):(this.parentPointVector.copy(this.currentSphereVector),this.parentPoint=null,this.oneDimensionalContainingParentPoint=null);if(!this.parentPointVector.isZero()){const n=new Dt;if(this.oneDimensionalContainingParentPoint!==null){this.parentPoint=new kt(this.oneDimensionalContainingParentPoint),this.parentPoint.locationVector=this.parentPointVector;const o=this.parentPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new zt(this.parentPoint,this.oneDimensionalContainingParentPoint,o))}else{this.parentPoint=new Ze,this.parentPoint.locationVector=this.parentPointVector;const o=this.parentPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new Mn(this.parentPoint,o))}const r=new ut(this.parentPoint,!0),s=r.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new qp(r,this.parentPoint,s)),r.shallowUpdate(),n.execute(),this.mouseLeave(i)}}}mouseMoved(i){super.mouseMoved(i);let n=!0;if(this.hitSEPoints.length>0){this.tmpVector1.copy(this.hitSEPoints[0].locationVector).multiplyScalar(-1);const r=fa.store.sePoints.findIndex(o=>!!this.tmpVector.subVectors(this.tmpVector1,o.locationVector).isZero());let s=null;if(r===-1)throw new Error(`AntipodePointHandler: The point ${this.hitSEPoints[0].name} doesn't have an antipode 1!`);s=fa.store.sePoints[r],s!==null&&(s instanceof ut&&!s.isUserCreated||s instanceof Le&&!s.isUserCreated&&!s.isAntipodal)?(this.hitSEPoints[0].glowing=!0,this.snapToTemporaryPoint=this.hitSEPoints[0],this.snapToTemporaryOneDimensional=null):n=!1}else this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSESegments[0],this.snapToTemporaryPoint=null):this.hitSELines.length>0?(this.hitSELines[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSELines[0],this.snapToTemporaryPoint=null):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSECircles[0],this.snapToTemporaryPoint=null):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEEllipses[0],this.snapToTemporaryPoint=null):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEParametrics[0],this.snapToTemporaryPoint=null):this.hitSEPolygons.length>0?(this.hitSEPolygons[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEPolygons[0],this.snapToTemporaryPoint=null):(this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null);this.isOnSphere?(this.isTemporaryAntipodeAdded||(this.isTemporaryAntipodeAdded=!0,this.temporaryAntipodeMarker.addToLayers(this.layers)),this.isTemporaryPointAdded||(this.isTemporaryPointAdded=!0,this.temporaryPointMarker.addToLayers(this.layers)),this.snapToTemporaryOneDimensional===null&&this.snapToTemporaryPoint===null?(this.temporaryAntipodeMarker.positionVector=this.tmpVector.copy(this.currentSphereVector).multiplyScalar(-1),this.hitSEPoints.length===0?this.temporaryPointMarker.positionVector=this.tmpVector.copy(this.currentSphereVector):(this.temporaryPointMarker.removeFromLayers(),this.isTemporaryPointAdded=!1,!n&&this.isTemporaryAntipodeAdded&&(this.temporaryAntipodeMarker.removeFromLayers(),this.isTemporaryAntipodeAdded=!1))):this.snapToTemporaryOneDimensional!==null&&this.snapToTemporaryPoint===null?(this.temporaryAntipodeMarker.positionVector=this.tmpVector.copy(this.snapToTemporaryOneDimensional.closestVector(this.currentSphereVector)).multiplyScalar(-1),this.hitSEPoints.length===0?this.temporaryPointMarker.positionVector=this.tmpVector.copy(this.snapToTemporaryOneDimensional.closestVector(this.currentSphereVector)):(this.temporaryPointMarker.removeFromLayers(),this.isTemporaryPointAdded=!1,!n&&this.isTemporaryAntipodeAdded&&(this.temporaryAntipodeMarker.removeFromLayers(),this.isTemporaryAntipodeAdded=!1))):this.snapToTemporaryOneDimensional===null&&this.snapToTemporaryPoint!==null&&(this.temporaryAntipodeMarker.positionVector=this.tmpVector.copy(this.snapToTemporaryPoint.locationVector).multiplyScalar(-1),this.hitSEPoints.length===0?this.temporaryPointMarker.positionVector=this.tmpVector.copy(this.snapToTemporaryPoint.locationVector):(this.temporaryPointMarker.removeFromLayers(),this.isTemporaryPointAdded=!1))):(this.isTemporaryAntipodeAdded&&(this.temporaryAntipodeMarker.removeFromLayers(),this.isTemporaryAntipodeAdded=!1),this.isTemporaryPointAdded&&(this.temporaryPointMarker.removeFromLayers(),this.isTemporaryPointAdded=!1),this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null)}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.parentPoint=null,this.oneDimensionalContainingParentPoint=null,this.parentPointVector.set(0,0,0),this.isTemporaryAntipodeAdded&&this.temporaryAntipodeMarker.removeFromLayers(),this.isTemporaryAntipodeAdded=!1,this.isTemporaryPointAdded&&this.temporaryPointMarker.removeFromLayers(),this.isTemporaryPointAdded=!1,this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null}activate(){if(fa.store.selectedSENodules.length==1){const i=fa.store.selectedSENodules[0];if(i instanceof Ze){const n=fa.store.sePoints.findIndex(r=>(this.tmpVector.copy(r.locationVector).multiplyScalar(-1),this.tmpVector.sub(i.locationVector),!!this.tmpVector.isZero()));if(n>-1){const r=fa.store.sePoints[n];this.revealAntipode(r,i)}else console.warn(`Antipode Point Handler: Antipode of selected point ${i.name} doesn't exist!!!!!`)}}super.activate()}deactivate(){super.deactivate()}revealAntipode(i,n){if(i!==null&&(i instanceof ut&&!i.isUserCreated||i instanceof Le&&!i.isUserCreated&&!i.isAntipodal)){const r=new Dt;r.addCommand(new sn(i,!0)),i instanceof Le&&r.addCommand(new fSe(i,this.parentPoint)),this.parentPoint instanceof Le&&!this.parentPoint.isUserCreated&&r.addCommand(new sn(this.parentPoint,!0)),r.execute()}else $.fire("show-alert",{key:"handlers.antipodeDuplicate",keyOptions:{pointName:n.label.ref.shortUserName},type:"error"})}}class Bs extends _i{constructor(i){super(i);y(this,"parentPoint",null);y(this,"parentLineOrSegment",null);y(this,"oneDimensionalContainingParentPoint",null);y(this,"snapToTemporaryCircleOrEllipseOrParametricOrPolygon",null);y(this,"temporaryParentLineOrSegment",null);y(this,"snapToTemporaryPoint",null);y(this,"parentPointVector",new k(0,0,0));y(this,"tmpVector",new k);y(this,"temporaryPolarLineMarker");y(this,"temporaryPolarPointMarker1");y(this,"temporaryPolarPointMarker2");y(this,"temporaryPoint");y(this,"creating",0);y(this,"temporaryPolarLineAdded",!1);y(this,"temporaryPolarPointMarkersAdded",!1);y(this,"temporaryPointAdded",!1);this.temporaryPolarLineMarker=new g5,Bs.store.addTemporaryNodule(this.temporaryPolarLineMarker),this.temporaryPolarPointMarker1=new m_,Bs.store.addTemporaryNodule(this.temporaryPolarPointMarker1),this.temporaryPolarPointMarker2=new m_,Bs.store.addTemporaryNodule(this.temporaryPolarPointMarker2),this.temporaryPoint=new mi,Bs.store.addTemporaryNodule(this.temporaryPoint)}mousePressed(i){if(super.mouseMoved(i),this.isOnSphere){if(this.hitSEPoints.length>0)Bs.store.seLines.some(r=>this.tmpVector.crossVectors(r.normalVector,this.hitSEPoints[0].locationVector).isZero(S.nearlyAntipodalIdeal))?$.fire("show-alert",{key:"handlers.polarLineDuplicate",keyOptions:{},type:"error"}):(this.parentPoint=this.hitSEPoints[0],this.parentPointVector.copy(this.parentPoint.locationVector),this.oneDimensionalContainingParentPoint=null,this.parentLineOrSegment=null);else if(this.hitSESegments.length>0||this.hitSELines.length>0)if(!Bs.store.sePoints.some(r=>this.tmpVector.subVectors(r.locationVector,this.hitSESegments[0]?this.hitSESegments[0].normalVector:this.hitSELines[0].normalVector).isZero(S.nearlyAntipodalIdeal)))this.parentLineOrSegment=this.hitSESegments[0]?this.hitSESegments[0]:this.hitSELines[0],this.parentPointVector.set(0,0,0),this.oneDimensionalContainingParentPoint=null,this.parentPoint=null;else{const r=_e.global.t("objects.lines",3);$.fire("show-alert",{key:"handlers.polarPointDuplicate",keyOptions:{object:r},type:"error"})}else this.hitSECircles.length>0?(this.oneDimensionalContainingParentPoint=this.hitSECircles[0],this.parentPointVector.copy(this.oneDimensionalContainingParentPoint.closestVector(this.currentSphereVector)),this.parentPoint=null,this.parentLineOrSegment=null):this.hitSEEllipses.length>0?(this.oneDimensionalContainingParentPoint=this.hitSEEllipses[0],this.parentPointVector.copy(this.oneDimensionalContainingParentPoint.closestVector(this.currentSphereVector)),this.parentPoint=null,this.parentLineOrSegment=null):this.hitSEParametrics.length>0?(this.oneDimensionalContainingParentPoint=this.hitSEParametrics[0],this.parentPointVector.copy(this.oneDimensionalContainingParentPoint.closestVector(this.currentSphereVector)),this.parentPoint=null,this.parentLineOrSegment=null):this.hitSEPolygons.length>0?(this.oneDimensionalContainingParentPoint=this.hitSEPolygons[0],this.parentPointVector.copy(this.oneDimensionalContainingParentPoint.closestVector(this.currentSphereVector)),this.parentPoint=null,this.parentLineOrSegment=null):(this.parentPointVector.copy(this.currentSphereVector),this.parentPoint=null,this.oneDimensionalContainingParentPoint=null,this.parentLineOrSegment=null);this.parentLineOrSegment!==null?this.createPolarPoints(this.parentLineOrSegment):this.createPolarLine(),this.mouseLeave(i)}}mouseMoved(i){if(super.mouseMoved(i),this.hitSEPoints.length>0?Bs.store.seLines.some(r=>this.tmpVector.crossVectors(r.normalVector,this.hitSEPoints[0].locationVector).isZero(S.nearlyAntipodalIdeal))?this.creating=1:(this.hitSEPoints[0].glowing=!0,this.snapToTemporaryPoint=this.hitSEPoints[0],this.snapToTemporaryCircleOrEllipseOrParametricOrPolygon=null,this.creating=2,this.temporaryParentLineOrSegment=null):this.hitSESegments.length>0||this.hitSELines.length>0?(this.temporaryParentLineOrSegment=this.hitSESegments[0]?this.hitSESegments[0]:this.hitSELines[0],Bs.store.sePoints.some(r=>this.tmpVector.subVectors(r.locationVector,this.temporaryParentLineOrSegment.normalVector).isZero(S.nearlyAntipodalIdeal))?this.creating=2:(this.hitSESegments[0]?this.hitSESegments[0].glowing=!0:this.hitSELines[0].glowing=!0,this.snapToTemporaryCircleOrEllipseOrParametricOrPolygon=null,this.creating=1,this.snapToTemporaryPoint=null)):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.snapToTemporaryCircleOrEllipseOrParametricOrPolygon=this.hitSECircles[0],this.snapToTemporaryPoint=null,this.creating=2,this.temporaryParentLineOrSegment=null):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.snapToTemporaryCircleOrEllipseOrParametricOrPolygon=this.hitSEEllipses[0],this.snapToTemporaryPoint=null,this.creating=2,this.temporaryParentLineOrSegment=null):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.snapToTemporaryCircleOrEllipseOrParametricOrPolygon=this.hitSEParametrics[0],this.snapToTemporaryPoint=null,this.creating=2,this.temporaryParentLineOrSegment=null):this.hitSEPolygons.length>0?(this.hitSEPolygons[0].glowing=!0,this.snapToTemporaryCircleOrEllipseOrParametricOrPolygon=this.hitSEPolygons[0],this.snapToTemporaryPoint=null,this.creating=2,this.temporaryParentLineOrSegment=null):(this.snapToTemporaryCircleOrEllipseOrParametricOrPolygon=null,this.snapToTemporaryPoint=null,this.creating=2,this.temporaryParentLineOrSegment=null),this.isOnSphere){if(this.creating===2)this.temporaryPolarPointMarkersAdded&&(this.temporaryPolarPointMarker1.removeFromLayers(),this.temporaryPolarPointMarker2.removeFromLayers(),this.temporaryPolarPointMarkersAdded=!1),this.temporaryPointAdded||(this.temporaryPoint.addToLayers(this.layers),this.temporaryPointAdded=!0),this.snapToTemporaryPoint!==null?this.snapToTemporaryPoint instanceof Le&&!this.snapToTemporaryPoint.isUserCreated||this.snapToTemporaryPoint instanceof ut&&!this.snapToTemporaryPoint.isUserCreated?this.temporaryPoint.positionVector=this.snapToTemporaryPoint.locationVector:(this.temporaryPoint.removeFromLayers(),this.temporaryPointAdded=!1):this.snapToTemporaryCircleOrEllipseOrParametricOrPolygon!==null?this.temporaryPoint.positionVector=this.snapToTemporaryCircleOrEllipseOrParametricOrPolygon.closestVector(this.currentSphereVector):this.temporaryPoint.positionVector=this.currentSphereVector,this.temporaryPolarLineAdded||(this.temporaryPolarLineMarker.addToLayers(this.layers),this.temporaryPolarLineAdded=!0),this.temporaryPolarLineMarker.normalVector=this.temporaryPoint._locationVector,this.temporaryPolarLineMarker.updateDisplay();else if(this.creating===1){this.temporaryPolarLineAdded&&(this.temporaryPolarLineMarker.removeFromLayers(),this.temporaryPolarLineAdded=!1),this.temporaryPointAdded&&(this.temporaryPoint.removeFromLayers(),this.temporaryPointAdded=!1),this.temporaryPolarPointMarkersAdded||(this.temporaryPolarPointMarker1.addToLayers(this.layers),this.temporaryPolarPointMarker2.addToLayers(this.layers),this.temporaryPolarPointMarkersAdded=!0);let n;this.temporaryParentLineOrSegment!==null?n=this.temporaryParentLineOrSegment.normalVector:n=this.tmpVector.set(0,0,0),this.temporaryPolarPointMarker1.positionVector=n,this.tmpVector.copy(n).multiplyScalar(-1),this.temporaryPolarPointMarker2.positionVector=this.tmpVector}}}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.parentPoint=null,this.oneDimensionalContainingParentPoint=null,this.parentPointVector.set(0,0,0),this.parentLineOrSegment=null,this.temporaryPolarLineAdded&&this.temporaryPolarLineMarker.removeFromLayers(),this.temporaryPolarLineAdded=!1,this.temporaryPolarPointMarkersAdded&&(this.temporaryPolarPointMarker1.removeFromLayers(),this.temporaryPolarPointMarker2.removeFromLayers()),this.temporaryPolarPointMarkersAdded=!1,this.temporaryPointAdded&&this.temporaryPoint.removeFromLayers(),this.temporaryPointAdded=!1,this.snapToTemporaryCircleOrEllipseOrParametricOrPolygon=null,this.snapToTemporaryPoint=null}activate(){if(Bs.store.selectedSENodules.length==1){const i=Bs.store.selectedSENodules[0];i instanceof Ze?(this.parentPoint=i,this.createPolarLine()):(i instanceof $t||i instanceof Jt)&&this.createPolarPoints(i)}super.activate()}deactivate(){super.deactivate()}createPolarPoints(i){const n=new Dt,r=new v_(i,0);r.locationVector=i.normalVector;const s=r.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new Yv(r,0,i,s));const o=new v_(i,1);o.locationVector=i.normalVector.multiplyScalar(-1);const a=o.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new Yv(o,1,i,a)),n.execute(),r.markKidsOutOfDate(),r.update(),o.markKidsOutOfDate(),o.update()}createPolarLine(){const i=new Dt,n=[];if(this.parentPoint!==null)(this.parentPoint instanceof Le&&!this.parentPoint.isUserCreated||this.parentPoint instanceof ut&&!this.parentPoint.isUserCreated)&&i.addCommand(new sn(this.parentPoint,!0));else{if(this.oneDimensionalContainingParentPoint!==null){this.parentPoint=new kt(this.oneDimensionalContainingParentPoint),this.parentPoint.locationVector=this.parentPointVector;const u=this.parentPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));i.addCommand(new zt(this.parentPoint,this.oneDimensionalContainingParentPoint,u))}else{this.parentPoint=new Ze,this.parentPoint.locationVector=this.parentPointVector;const u=this.parentPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));i.addCommand(new Mn(this.parentPoint,u))}const c=Bs.addCreateAntipodeCommand(this.parentPoint,i);n.push(c,this.parentPoint)}const r=new Ze(!0);r.showing=!1,r.exists=!0;const s=this.createVectorsToDefineLine(this.parentPoint.locationVector);r.locationVector=s[1];const o=new Ze(!0);o.showing=!1,o.exists=!0,o.locationVector=s[0];const a=new ZM(o,r,this.parentPoint),l=new De("line",a);this.tmpVector.copy(r.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),l.locationVector=this.tmpVector,i.addCommand(new YP(a,this.parentPoint,l)),a.markKidsOutOfDate(),a.update(),Bs.store.createAllIntersectionsWithLine(a,n).forEach(c=>{if(c.existingIntersectionPoint)i.addCommand(new nr(c.SEIntersectionPoint,a));else{const u=c.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));i.addCommand(new ir(c.SEIntersectionPoint,c.parent1,c.parent2,u)),c.SEIntersectionPoint.showing=!1,u.showing=!1,c.createAntipodalPoint&&Bs.addCreateAntipodeCommand(c.SEIntersectionPoint,i)}}),i.execute()}createVectorsToDefineLine(i){const n=new k;n.set(-i.y,i.x,0),n.isZero(S.nearlyAntipodalIdeal)&&n.set(0,-i.z,i.y);const r=new k;return r.crossVectors(i,n),[r.normalize(),n.normalize()]}}var r1=(t=>(t[t.MAGNIFY=0]="MAGNIFY",t[t.MINIFY=1]="MINIFY",t[t.FIT=2]="FIT",t))(r1||{});class Sx{constructor(e){y(this,"targetElement");y(this,"_mode",0);y(this,"utStartDragPosition",new Pi);y(this,"currentPixelPosition",new Pi);y(this,"isDragging",!1);y(this,"didPan",!1);y(this,"isMousePressed",!1);y(this,"percentChange",S.zoom.percentChange/100);y(this,"mousePressMagnificationFactor",1);y(this,"mousePressTranslationVector",[0,0]);y(this,"lastPanTranslationVector",[0,0]);this.targetElement=e}set zoomMode(e){this._mode=e}mousePressed(e){if(this._mode==2)return;this.isMousePressed=!0,this.mousePressMagnificationFactor=Tr.store.zoomMagnificationFactor;const i=Tr.store.zoomTranslation;for(let a=0;a<2;a++)this.mousePressTranslationVector[a]=i[a];const r=(e.currentTarget||e.target).getBoundingClientRect(),s=e.clientX-r.left,o=e.clientY-r.top;this.currentPixelPosition.set(s,o),this.utStartDragPosition.set((s-this.mousePressTranslationVector[0])/this.mousePressMagnificationFactor,(o-this.mousePressTranslationVector[1])/this.mousePressMagnificationFactor)}mouseMoved(e){if(this._mode==2)return;this.isMousePressed&&(this.isDragging=!0);const n=(e.currentTarget||e.target).getBoundingClientRect(),r=e.clientX-n.left,s=e.clientY-n.top;this.currentPixelPosition.set(r,s),this.isDragging&&(this.doPan(e),this.didPan=!0)}mouseReleased(e){this._mode!=2&&(this.isDragging&&this.didPan?(this.isDragging=!1,new uv(this.mousePressMagnificationFactor,this.lastPanTranslationVector,this.mousePressMagnificationFactor,this.mousePressTranslationVector).push()):this.isMousePressed&&this.doZoom(e),this.isMousePressed=!1)}doZoom(e){const i=Tr.store.zoomMagnificationFactor;let n=i;const r=Tr.store.zoomTranslation;if(this._mode===1){if(i<S.zoom.minMagnification){console.error(`Exceeded zoom out limit ${S.zoom.minMagnification}`),$.fire("show-alert",{key:"handlers.panZoomHandlerZoomOutLimitReached",keyOptions:{},type:"warning"});return}n=(1-this.percentChange)*i}if(this._mode===0){if(i>S.zoom.maxMagnification){console.error(`Exceeded zoom in limit ${S.zoom.maxMagnification}`),$.fire("show-alert",{key:"handlers.panZoomHandlerZoomInLimitReached",keyOptions:{},type:"warning"});return}n=(1+this.percentChange)*i}const o=(e.currentTarget||e.target).getBoundingClientRect(),a=e.clientX-o.left-o.width/2,l=e.clientY-o.top-o.height/2,c=(a-r[0])/i,u=(l-r[1])/i,h=[a-c*n,l-u*n];if(n<i)if(n>1){const f=(n-1)/(i-1);h[0]*=f,h[1]*=f}else h[0]=0,h[1]=0;Tr.store.setZoomMagnificationFactor(n),Tr.store.setZoomTranslation(h),$.fire("zoom-updated",{}),new uv(n,h,this.mousePressMagnificationFactor,this.mousePressTranslationVector).push()}doPan(e){const i=Tr.store.zoomMagnificationFactor;this.lastPanTranslationVector=[this.currentPixelPosition.x-i*this.utStartDragPosition.x,this.currentPixelPosition.y-i*this.utStartDragPosition.y],Tr.store.setZoomTranslation(this.lastPanTranslationVector),$.fire("zoom-updated",{})}mouseLeave(e){this._mode!=2&&(this.isDragging=!1,this.isMousePressed=!1)}activate(){Tr.store.selectedSENodules.map(e=>e).forEach(e=>{e.selected=!1}),Tr.store.setSelectedSENodules([]),Tr.store.unglowAllSENodules()}deactivate(){}doZoomFit(e){const i=Tr.store.zoomMagnificationFactor,n=Tr.store.zoomTranslation,s=(e/2-16)/S.boundaryCircle.radius;Tr.store.setZoomMagnificationFactor(s),Tr.store.setZoomTranslation([0,0]),$.fire("zoom-updated",{}),new uv(s,[0,0],i,n).push()}}class _d extends _i{constructor(i){super(i);y(this,"victim",null);y(this,"victimName","");y(this,"victimType","");y(this,"beforeDeleteStateMap",new Map);y(this,"beforeDeleteSENoduleIDList",[])}mousePressed(i){var n,r,s,o,a,l,c,u;if(this.isOnSphere&&(this.hitSEPoints.length>0?(!(this.hitSEPoints[0]instanceof Le)||this.hitSEPoints[0].isUserCreated)&&(!(this.hitSEPoints[0]instanceof ut)||this.hitSEPoints[0].isUserCreated)&&(this.victim=this.hitSEPoints[0],this.victimName=(n=this.hitSEPoints[0].label)==null?void 0:n.ref.shortUserName,this.victimType=_e.global.t("objects.points",3)):this.hitSELines.length>0?(this.victim=this.hitSELines[0],this.victimName=(r=this.hitSELines[0].label)==null?void 0:r.ref.shortUserName,this.victimType=_e.global.t("objects.lines",3)):this.hitSESegments.length>0?(this.victim=this.hitSESegments[0],this.victimName=(s=this.hitSESegments[0].label)==null?void 0:s.ref.shortUserName,this.victimType=_e.global.t("objects.segments",3)):this.hitSECircles.length>0?(this.victim=this.hitSECircles[0],this.victimName=(o=this.hitSECircles[0].label)==null?void 0:o.ref.shortUserName,this.victimType=_e.global.t("objects.circles",3)):this.hitSEEllipses.length>0?(this.victim=this.hitSEEllipses[0],this.victimName=(a=this.hitSEEllipses[0].label)==null?void 0:a.ref.shortUserName,this.victimType=_e.global.t("objects.ellipses",3)):this.hitSEParametrics.length>0?(this.victim=this.hitSEParametrics[0],this.victimName=(l=this.hitSEParametrics[0].label)==null?void 0:l.ref.shortUserName,this.victimType=_e.global.t("objects.parametrics",3)):this.hitSELabels.length>0?new qi(this.hitSELabels[0],!1).execute():this.hitSEAngleMarkers.length>0?(this.victim=this.hitSEAngleMarkers[0],this.victimName=(c=this.hitSEAngleMarkers[0].label)==null?void 0:c.ref.shortUserName,this.victimType=_e.global.t("objects.angleMarkers",3)):this.hitSEPolygons.length>0&&(this.victim=this.hitSEPolygons[0],this.victimName=(u=this.hitSEPolygons[0].label)==null?void 0:u.ref.shortUserName,this.victimType=_e.global.t("objects.polygons",3)),this.victim!=null)){const h=this.delete(this.victim);$.fire("show-alert",{key:"handlers.deletedNodes",keyOptions:{type:this.victimType,name:this.victimName??"",number:h.length-1,objects:h.length===2?_e.global.t("objects.objects",4):_e.global.t("objects.objects",3)},type:"success"}),this.mouseLeave(i)}}mouseMoved(i){if(super.mouseMoved(i),this.hitSEPoints.length>0){const n=this.hitSEPoints.filter(r=>!(r instanceof Le||r instanceof ut&&!r.isUserCreated));n.length>0&&(n[0].glowing=!0)}else this.hitSELines.length>0?this.hitSELines[0].glowing=!0:this.hitSESegments.length>0?this.hitSESegments[0].glowing=!0:this.hitSECircles.length>0?this.hitSECircles[0].glowing=!0:this.hitSEEllipses.length>0?this.hitSEEllipses[0].glowing=!0:this.hitSELabels.length>0?this.hitSELabels[0].glowing=!0:this.hitSEAngleMarkers.length>0?this.hitSEAngleMarkers[0].glowing=!0:this.hitSEParametrics.length>0?this.hitSEParametrics[0].glowing=!0:this.hitSEPolygons.length>0&&(this.hitSEPolygons[0].glowing=!0)}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.victim=null,this.beforeDeleteStateMap.clear(),this.beforeDeleteSENoduleIDList.splice(0)}activate(){if(_d.store.selectedSENodules.length!==0){const i=[];_d.store.selectedSENodules.filter(n=>(!(n instanceof Le)||n.isUserCreated)&&(!(n instanceof ut)||n.isUserCreated)).forEach(n=>{i.findIndex(r=>r===n.id)===-1&&i.push(...this.delete(n))}),$.fire("show-alert",{key:"handlers.deletedNumberNodes",keyOptions:{number:i.length,objects:i.length===1?_e.global.t("objects.objects",4):_e.global.t("objects.objects",3)},type:"success"}),i.splice(0)}super.activate()}deactivate(){super.deactivate()}delete(i){const n=[];this.beforeDeleteStateMap.clear(),this.beforeDeleteSENoduleIDList.splice(0),i.markKidsOutOfDate(),i.update(this.beforeDeleteStateMap,this.beforeDeleteSENoduleIDList);const r=new Dt;this.beforeDeleteSENoduleIDList.reverse();const s=[];this.beforeDeleteSENoduleIDList.forEach(l=>{const c=this.beforeDeleteStateMap.get(l);if(c!==void 0&&c.object instanceof Le){const u=[c.object.principleParent1,c.object.principleParent2,...c.object.otherParentArray],h=[];if(u.forEach(d=>{this.beforeDeleteStateMap.has(d.id)||h.push(d)}),h.length>=2){let d=!1;for(let f=0;f<h.length;f++){for(let m=f+1;m<h.length;m++)if(c.object.checkIntersectionBetweenTwoPotentialParents(h[f],h[m])!==-1){s.push(c.object.id),d=!0;break}if(d)break}}}});let o=s.length,a=0;for(;o>a;){const l=this.beforeDeleteStateMap.get(s[a]);l!==void 0&&(a+=1,l.object.kids.forEach(c=>{c.parents.every(u=>s.some(h=>u.id===h)||!this.beforeDeleteStateMap.has(u.id))&&s.every(u=>u!==c.id)&&(s.push(c.id),o+=1)}))}return s.forEach(l=>{const c=this.beforeDeleteStateMap.get(l);if(c!==void 0){if(!(c.object instanceof Le)){this.beforeDeleteStateMap.delete(l);const u=this.beforeDeleteSENoduleIDList.findIndex(h=>h===l);if(u>-1)this.beforeDeleteSENoduleIDList.splice(u,1);else throw new Error(`Delete Handler: Removed an object with id ${l} from the beforeDeleteStateMap that doesn't exist on the beforeDeleteSENoduleIDList`)}}else throw new Error(`Delete Handler: An object from the notDeletedSENoduleIDS  with id ${l} doesn't exist in the beforeDeleteStateMap`)}),this.beforeDeleteSENoduleIDList.forEach(l=>{const c=this.beforeDeleteStateMap.get(l);if(c!==void 0)if(c.object instanceof Le)if(!s.some(u=>u===c.object.id))c.object.otherParentArray.forEach(u=>{r.addCommand(new Dm(c.object,u))}),c.object.isUserCreated&&r.addCommand(new sn(c.object,!1)),r.addCommand(new ey(c.object)),n.push(c.object.id);else{c.object.otherParentArray.forEach(g=>{s.some(v=>v===g.id)||!this.beforeDeleteStateMap.has(g.id)||r.addCommand(new Dm(c.object,g))});const u=c.object.principleParent1.id;!s.some(g=>g===u)&&this.beforeDeleteStateMap.has(u)&&r.addCommand(new ty(c.object,c.object.principleParent1));const h=c.object.principleParent2.id;!s.some(g=>g===h)&&this.beforeDeleteStateMap.has(h)&&r.addCommand(new ty(c.object,c.object.principleParent2));const d=[c.object.principleParent1,c.object.principleParent2,...c.object.otherParentArray];let f=0;d.forEach(g=>{(s.some(v=>v===g.id)||!this.beforeDeleteStateMap.has(g.id))&&g.exists&&g.isHitAt(c.object.locationVector,_d.store.zoomMagnificationFactor)&&(f+=1)});const m=f>1;c.object.isUserCreated&&!m&&r.addCommand(new sn(c.object,!1))}else(c.object instanceof $t||c.object instanceof Jt||c.object instanceof Kt||c.object instanceof Ii||c.object instanceof tn)&&_d.store.sePoints.filter(u=>u instanceof Le).map(u=>u).forEach(u=>{u.otherParentArray.findIndex(h=>h.id===c.object.id)>-1&&r.addCommand(new Dm(u,c.object))}),r.addCommand(new ey(c.object)),n.push(c.object.id)}),r.execute(),n}}class Sm extends _i{constructor(i){super(i);y(this,"victim",null);y(this,"initialShowingMap",new Map);y(this,"keyPressHandler",i=>{if(i.key.match("S")){const n=new Dt;Sm.store.seNodules.map(r=>r).forEach(r=>{r instanceof Le&&!r.isUserCreated||r instanceof ut&&!r.isUserCreated||r instanceof De&&(r.parent instanceof Le&&!r.parent.isUserCreated||r.parent instanceof ut&&!r.parent.isUserCreated)||r.showing===!1&&n.addCommand(new qi(r,!0))}),n.execute()}else if(i.key.match("s")){const n=new Dt;Sm.store.seNodules.map(r=>r).forEach(r=>{r instanceof Le&&!r.isUserCreated||r instanceof ut&&!r.isUserCreated||this.initialShowingMap.get(r.id)!==void 0&&this.initialShowingMap.get(r.id)===r.showing||r.showing===!1&&n.addCommand(new qi(r,!0))}),n.execute()}})}mousePressed(i){this.isOnSphere&&(this.hitSEPoints.length>0?(!(this.hitSEPoints[0]instanceof Le)||this.hitSEPoints[0].isUserCreated)&&(!(this.hitSEPoints[0]instanceof ut)||this.hitSEPoints[0].isUserCreated)&&(this.victim=this.hitSEPoints[0]):this.hitSELines.length>0?this.victim=this.hitSELines[0]:this.hitSESegments.length>0?this.victim=this.hitSESegments[0]:this.hitSECircles.length>0?this.victim=this.hitSECircles[0]:this.hitSEEllipses.length>0?this.victim=this.hitSEEllipses[0]:this.hitSEParametrics.length>0?this.victim=this.hitSEParametrics[0]:this.hitSELabels.length>0?this.victim=this.hitSELabels[0]:this.hitSEAngleMarkers.length>0?this.victim=this.hitSEAngleMarkers[0]:this.hitSEPolygons.length>0&&(this.victim=this.hitSEPolygons[0]),this.victim!=null&&(new qi(this.victim,!1).execute(),this.victim=null))}mouseMoved(i){if(super.mouseMoved(i),this.hitSEPoints.length>0){const n=this.hitSEPoints.filter(r=>!(r instanceof Le&&!r.isUserCreated||r instanceof ut&&!r.isUserCreated));n.length>0&&(n[0].glowing=!0)}else this.hitSESegments.length>0?this.hitSESegments[0].glowing=!0:this.hitSELines.length>0?this.hitSELines[0].glowing=!0:this.hitSECircles.length>0?this.hitSECircles[0].glowing=!0:this.hitSEEllipses.length>0?this.hitSEEllipses[0].glowing=!0:this.hitSEParametrics.length>0?this.hitSEParametrics[0].glowing=!0:this.hitSELabels.length>0?this.hitSELabels[0].glowing=!0:this.hitSEAngleMarkers.length>0?this.hitSEAngleMarkers[0].glowing=!0:this.hitSEPolygons.length>0&&(this.hitSEPolygons[0].glowing=!0)}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.victim=null}activate(){window.addEventListener("keypress",this.keyPressHandler),Sm.store.seNodules.forEach(n=>{this.initialShowingMap.set(n.id,n.showing)});const i=new Dt;Sm.store.selectedSENodules.map(n=>n).filter(n=>(!(n instanceof Le)||n.isUserCreated)&&(!(n instanceof ut)||n.isUserCreated)).forEach(n=>i.addCommand(new qi(n,!1))),i.execute(),super.activate()}deactivate(){super.deactivate(),window.removeEventListener("keypress",this.keyPressHandler),this.initialShowingMap.clear()}}class bm extends _i{constructor(e){super(e)}mousePressed(e){this.isOnSphere&&this.hitSESegments.length>0&&this.addSegmentLengthMeasure(this.hitSESegments[0])}mouseMoved(e){super.mouseMoved(e);const i=this.hitSESegments.filter(n=>!bm.store.expressions.some(r=>r instanceof ws&&r.seSegment.name===n.name));if(i.length>0){i[0].glowing=!0;const n=i[0].arcLength;this.infoText.text=`Arc length ${(n/Math.PI).toFixed(S.decimalPrecision)}`}}mouseReleased(e){}mouseLeave(e){super.mouseLeave(e)}addSegmentLengthMeasure(e){var n;let i="";if(bm.store.expressions.some(r=>r instanceof ws&&r.seSegment.name===e.name?(i=r.name,!0):!1))$.fire("show-alert",{key:"handlers.duplicateSegmentMeasurement",keyOptions:{segName:`${(n=e.label)==null?void 0:n.ref.shortUserName}`,measurementName:`${i}`},type:"error"});else{const r=new ws(e);$.fire("show-alert",{key:"handlers.newSegmentMeasurementAdded",keyOptions:{name:`${r.name}`},type:"success"});const s=new Dt;if(s.addCommand(new Fu(r,e)),e.label&&(s.addCommand(new qi(e.label,!0)),s.addCommand(new vc([e.label.ref],q.Label,[{labelDisplayMode:S.segment.measuringChangesLabelModeTo}],[{labelDisplayMode:e.label.ref.labelDisplayMode}])),_i.store.isEarthMode)){const o=Ni.EarthModeKilos;o!==r.valueDisplayMode&&s.addCommand(new Hp(r,r.valueDisplayMode,o))}s.execute(),e.markKidsOutOfDate(),e.update()}}activate(){if(bm.store.selectedSENodules.length==1){const e=bm.store.selectedSENodules[0];e instanceof Jt&&this.addSegmentLengthMeasure(e)}super.activate()}deactivate(){super.deactivate()}}class _m extends _i{constructor(i){super(i);y(this,"targetPoints",[])}mousePressed(i){if(this.isOnSphere){let n=[];if(n=this.hitSEPoints.filter(r=>!!((!(r instanceof Le)||r.isUserCreated)&&(!(r instanceof ut)||r.isUserCreated))),n.length>0){if(this.targetPoints.findIndex(s=>s.id===n[0].id)>=0){$.fire("show-alert",{key:"handlers.duplicatePointMessage",keyOptions:{},type:"warning"});return}this.targetPoints.push(n[0]),n[0].glowing=!0,n[0].selected=!0}this.targetPoints.length===2?(this.addPointDistance(this.targetPoints[0],this.targetPoints[1]),this.mouseLeave(i)):$.fire("show-alert",{key:"handlers.selectAnotherPoint",keyOptions:{},type:"info"})}}mouseMoved(i){super.mouseMoved(i);const n=this.hitSEPoints.filter(r=>!(r instanceof Le&&!r.isUserCreated)&&!(r instanceof ut&&!r.isUserCreated));n.length>0&&(n[0].glowing=!0)}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.prepareForNextPointDistance()}prepareForNextPointDistance(){this.targetPoints.forEach(i=>{i.selected=!1,i.glowing=!1}),this.targetPoints.splice(0)}addPointDistance(i,n){var s,o,a,l;let r="";if(_m.store.expressions.some(c=>c instanceof Sl&&(c.parents[0].name===i.name&&c.parents[1].name===n.name||c.parents[0].name===n.name&&c.parents[1].name===i.name)?(r=c.name,!0):!1))$.fire("show-alert",{key:"handlers.duplicatePointDistanceMeasurement",keyOptions:{pt0Name:`${(s=i.label)==null?void 0:s.ref.shortUserName}`,pt1Name:`${(o=n.label)==null?void 0:o.ref.shortUserName}`,measurementName:`${r}`},type:"error"});else{const c=new Sl(i,n);$.fire("show-alert",{key:"handler.pointDistanceMeasurementAdded",keyOptions:{pt0Name:`${(a=i.label)==null?void 0:a.ref.shortUserName}`,pt1Name:`${(l=n.label)==null?void 0:l.ref.shortUserName}`,measurementName:`${r}`},type:"success"}),new ff(c,[i,n]).execute()}}activate(){if(_m.store.selectedSENodules.length==2){const i=_m.store.selectedSENodules[0],n=_m.store.selectedSENodules[1];i instanceof Ze&&n instanceof Ze&&i!==n&&this.addPointDistance(i,n)}super.activate()}deactivate(){super.deactivate(),this.prepareForNextPointDistance()}}class Or extends _i{constructor(i){super(i);y(this,"targetPoints",[]);y(this,"targetLines",[]);y(this,"targetSegments",[]);y(this,"lineClickLocation1",new k);y(this,"lineClickLocation2",new k);y(this,"angleMode",Di.NONE);y(this,"lineSelectedFirst",!0);y(this,"highlightMode",0);y(this,"sePointOneDimensionalParents",[]);y(this,"pointLocations",[]);y(this,"tmpPointVector1",new k);y(this,"tmpPointVector2",new k);y(this,"tmpPointVector3",new k);y(this,"temporaryFirstPoint");y(this,"temporarySecondPoint");y(this,"temporaryThirdPoint");y(this,"isTemporaryFirstPointAdded",!1);y(this,"isTemporarySecondPointAdded",!1);y(this,"isTemporaryThirdPointAdded",!1);y(this,"temporaryAngleMarker");y(this,"isTemporaryAngleMarkerAdded",!1);y(this,"snapPoint",null);y(this,"snapOneDimensional",null);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"makingAnAngleMarker",!1);this.temporaryAngleMarker=new ih,Or.store.addTemporaryNodule(this.temporaryAngleMarker),this.temporaryFirstPoint=new mi,Or.store.addTemporaryNodule(this.temporaryFirstPoint),this.temporarySecondPoint=new mi,Or.store.addTemporaryNodule(this.temporarySecondPoint),this.temporaryThirdPoint=new mi,Or.store.addTemporaryNodule(this.temporaryThirdPoint)}allowPointLocation(i){if(this.pointLocations.length===1){if(this.tmpVector1.crossVectors(i,this.pointLocations[0]).isZero(S.nearlyAntipodalIdeal))return $.fire("show-alert",{key:"handlers.antipodalPointMessage",keyOptions:{},type:"warning"}),!1}else if(this.pointLocations.length===2&&this.tmpVector1.crossVectors(i,this.pointLocations[1]).isZero(S.nearlyAntipodalIdeal))return $.fire("show-alert",{key:"handlers.antipodalPointMessage2",keyOptions:{},type:"warning"}),!1;return!0}handleNextLine(i,n){this.targetLines.findIndex(s=>s.id===i.id)<0?(this.targetLines.push(i),this.lineClickLocation2.copy(n)):$.fire("show-alert",{key:"handlers.duplicateLineMessage",keyOptions:{},type:"warning"})}handleNextSegment(i){this.targetSegments.findIndex(r=>r.id===i.id)<0?this.targetSegments[0].startSEPoint===i.startSEPoint||this.targetSegments[0].startSEPoint===i.endSEPoint||this.targetSegments[0].endSEPoint===i.startSEPoint||this.targetSegments[0].endSEPoint===i.endSEPoint?this.targetSegments.push(i):$.fire("show-alert",{key:"handlers.segmentsWithOutCommonEndpoint",keyOptions:{},type:"warning"}):$.fire("show-alert",{key:"handlers.duplicateSegmentMessage",keyOptions:{},type:"warning"})}handleNextSegmentLineCombination(i,n){i instanceof $t&&(this.targetSegments[0].startSEPoint instanceof kt&&this.targetSegments[0].startSEPoint.parentOneDimensional===i||this.targetSegments[0].endSEPoint instanceof kt&&this.targetSegments[0].endSEPoint.parentOneDimensional===i||this.targetSegments[0].endSEPoint===i.startSEPoint||this.targetSegments[0].endSEPoint===i.endSEPoint||this.targetSegments[0].startSEPoint===i.startSEPoint||this.targetSegments[0].startSEPoint===i.endSEPoint?this.targetLines.push(i):$.fire("show-alert",{key:"handlers.lineDoesNotContainEndpointOfSegment",keyOptions:{},type:"warning"})),i instanceof Jt&&(i.startSEPoint instanceof kt&&i.startSEPoint.parentOneDimensional===this.targetLines[0]||i.endSEPoint instanceof kt&&i.endSEPoint.parentOneDimensional===this.targetLines[0]||this.targetLines[0].endSEPoint===i.startSEPoint||this.targetLines[0].endSEPoint===i.endSEPoint||this.targetLines[0].startSEPoint===i.startSEPoint||this.targetLines[0].startSEPoint===i.endSEPoint?this.targetSegments.push(i):$.fire("show-alert",{key:"handlers.segmentWithOutEndpointOnLine",keyOptions:{},type:"warning"}))}mousePressed(i){if(this.isOnSphere){switch(this.angleMode){case Di.NONE:this.hitSEPoints.length>0?(this.angleMode=Di.POINTS,this.targetPoints.push(this.hitSEPoints[0]),this.sePointOneDimensionalParents.push(null),this.pointLocations.push(this.tmpPointVector1.copy(this.hitSEPoints[0].locationVector)),this.temporaryAngleMarker.startVector=this.hitSEPoints[0].locationVector,this.temporaryFirstPoint.positionVector=this.hitSEPoints[0].locationVector,this.hitSEPoints[0].glowing=!0,this.hitSEPoints[0].selected=!0):this.hitSELines.length>0?(this.angleMode=Di.SEGMENTSORLINEANDSEGMENT,this.targetLines.push(this.hitSELines[0]),this.lineClickLocation1.copy(this.currentSphereVector),this.lineSelectedFirst=!0,this.hitSELines[0].glowing=!0,this.hitSELines[0].selected=!0):this.hitSESegments.length>0?(this.angleMode=Di.SEGMENTSORLINEANDSEGMENT,this.targetSegments.push(this.hitSESegments[0]),this.lineSelectedFirst=!1,this.hitSESegments[0].glowing=!0,this.hitSESegments[0].selected=!0):this.hitSECircles.length>0?(this.angleMode=Di.POINTS,this.targetPoints.push(null),this.sePointOneDimensionalParents.push(this.hitSECircles[0]),this.pointLocations.push(this.tmpPointVector1.copy(this.hitSECircles[0].closestVector(this.currentSphereVector))),this.temporaryAngleMarker.startVector=this.hitSECircles[0].closestVector(this.currentSphereVector),this.temporaryFirstPoint.positionVector=this.hitSECircles[0].closestVector(this.currentSphereVector)):this.hitSEEllipses.length>0?(this.angleMode=Di.POINTS,this.targetPoints.push(null),this.sePointOneDimensionalParents.push(this.hitSEEllipses[0]),this.pointLocations.push(this.tmpPointVector1.copy(this.hitSEEllipses[0].closestVector(this.currentSphereVector))),this.temporaryAngleMarker.startVector=this.hitSEEllipses[0].closestVector(this.currentSphereVector),this.temporaryFirstPoint.positionVector=this.hitSEEllipses[0].closestVector(this.currentSphereVector)):this.hitSEParametrics.length>0?(this.angleMode=Di.POINTS,this.targetPoints.push(null),this.sePointOneDimensionalParents.push(this.hitSEParametrics[0]),this.pointLocations.push(this.tmpPointVector1.copy(this.hitSEParametrics[0].closestVector(this.currentSphereVector))),this.temporaryAngleMarker.startVector=this.hitSEParametrics[0].closestVector(this.currentSphereVector),this.temporaryFirstPoint.positionVector=this.hitSEParametrics[0].closestVector(this.currentSphereVector)):this.hitSEPolygons.length>0?(this.angleMode=Di.POINTS,this.targetPoints.push(null),this.sePointOneDimensionalParents.push(this.hitSEPolygons[0]),this.pointLocations.push(this.tmpPointVector1.copy(this.hitSEPolygons[0].closestVector(this.currentSphereVector))),this.temporaryAngleMarker.startVector=this.hitSEPolygons[0].closestVector(this.currentSphereVector),this.temporaryFirstPoint.positionVector=this.hitSEPolygons[0].closestVector(this.currentSphereVector)):(this.angleMode=Di.POINTS,this.targetPoints.push(null),this.sePointOneDimensionalParents.push(null),this.pointLocations.push(this.tmpPointVector1.copy(this.currentSphereVector)),this.temporaryAngleMarker.startVector=this.currentSphereVector,this.temporaryFirstPoint.positionVector=this.currentSphereVector),this.makingAnAngleMarker=!0;break;case Di.POINTS:this.hitSEPoints.length>0?this.allowPointLocation(this.hitSEPoints[0].locationVector)&&(this.targetPoints.push(this.hitSEPoints[0]),this.sePointOneDimensionalParents.push(null),this.targetPoints.length==2?(this.temporaryAngleMarker.vertexVector=this.hitSEPoints[0].locationVector,this.temporarySecondPoint.positionVector=this.hitSEPoints[0].locationVector,this.pointLocations.push(this.tmpPointVector2.copy(this.hitSEPoints[0].locationVector))):(this.temporaryAngleMarker.endVector=this.hitSEPoints[0].locationVector,this.temporaryThirdPoint.positionVector=this.hitSEPoints[0].locationVector,this.pointLocations.push(this.tmpPointVector3.copy(this.hitSEPoints[0].locationVector))),this.hitSEPoints[0].glowing=!0,this.hitSEPoints[0].selected=!0):this.hitSELines.length>0?(this.tmpVector.copy(this.hitSELines[0].closestVector(this.currentSphereVector)),this.allowPointLocation(this.tmpVector)&&(this.targetPoints.push(null),this.sePointOneDimensionalParents.push(this.hitSELines[0]),this.targetPoints.length==2?(this.temporaryAngleMarker.vertexVector=this.tmpVector,this.temporarySecondPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector2.copy(this.tmpVector))):(this.temporaryAngleMarker.endVector=this.tmpVector,this.temporaryThirdPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector3.copy(this.tmpVector))))):this.hitSESegments.length>0?(this.tmpVector.copy(this.hitSESegments[0].closestVector(this.currentSphereVector)),this.allowPointLocation(this.tmpVector)&&(this.targetPoints.push(null),this.sePointOneDimensionalParents.push(this.hitSESegments[0]),this.targetPoints.length==2?(this.temporaryAngleMarker.vertexVector=this.tmpVector,this.temporarySecondPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector2.copy(this.tmpVector))):(this.temporaryAngleMarker.endVector=this.tmpVector,this.temporaryThirdPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector3.copy(this.tmpVector))))):this.hitSECircles.length>0?(this.tmpVector.copy(this.hitSECircles[0].closestVector(this.currentSphereVector)),this.allowPointLocation(this.tmpVector)&&(this.targetPoints.push(null),this.sePointOneDimensionalParents.push(this.hitSECircles[0]),this.targetPoints.length==2?(this.temporaryAngleMarker.vertexVector=this.tmpVector,this.temporarySecondPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector2.copy(this.tmpVector))):(this.temporaryAngleMarker.endVector=this.tmpVector,this.temporaryThirdPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector3.copy(this.tmpVector))))):this.hitSEEllipses.length>0?(this.tmpVector.copy(this.hitSEEllipses[0].closestVector(this.currentSphereVector)),this.allowPointLocation(this.tmpVector)&&(this.targetPoints.push(null),this.sePointOneDimensionalParents.push(this.hitSEEllipses[0]),this.targetPoints.length==2?(this.temporaryAngleMarker.vertexVector=this.tmpVector,this.temporarySecondPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector2.copy(this.tmpVector))):(this.temporaryAngleMarker.endVector=this.tmpVector,this.temporaryThirdPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector3.copy(this.tmpVector))))):this.hitSEParametrics.length>0?(this.tmpVector.copy(this.hitSEParametrics[0].closestVector(this.currentSphereVector)),this.allowPointLocation(this.tmpVector)&&(this.targetPoints.push(null),this.sePointOneDimensionalParents.push(this.hitSEParametrics[0]),this.targetPoints.length==2?(this.temporaryAngleMarker.vertexVector=this.tmpVector,this.temporarySecondPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector2.copy(this.tmpVector))):(this.temporaryAngleMarker.endVector=this.tmpVector,this.temporaryThirdPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector3.copy(this.tmpVector))))):this.hitSEPolygons.length>0?(this.tmpVector.copy(this.hitSEPolygons[0].closestVector(this.currentSphereVector)),this.allowPointLocation(this.tmpVector)&&(this.targetPoints.push(null),this.sePointOneDimensionalParents.push(this.hitSEPolygons[0]),this.targetPoints.length==2?(this.temporaryAngleMarker.vertexVector=this.tmpVector,this.temporarySecondPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector2.copy(this.tmpVector))):(this.temporaryAngleMarker.endVector=this.tmpVector,this.temporaryThirdPoint.positionVector=this.tmpVector,this.pointLocations.push(this.tmpPointVector3.copy(this.tmpVector))))):this.allowPointLocation(this.currentSphereVector)&&(this.targetPoints.push(null),this.sePointOneDimensionalParents.push(null),this.targetPoints.length==2?(this.temporaryAngleMarker.vertexVector=this.currentSphereVector,this.temporarySecondPoint.positionVector=this.currentSphereVector,this.pointLocations.push(this.tmpPointVector2.copy(this.currentSphereVector))):(this.temporaryAngleMarker.endVector=this.currentSphereVector,this.temporaryThirdPoint.positionVector=this.currentSphereVector,this.pointLocations.push(this.tmpPointVector3.copy(this.currentSphereVector))));break;case Di.SEGMENTSORLINEANDSEGMENT:this.hitSELines.length>0?this.targetLines.length===1?this.handleNextLine(this.hitSELines[0],this.currentSphereVector):this.handleNextSegmentLineCombination(this.hitSELines[0],this.currentSphereVector):this.hitSESegments.length>0&&(this.targetLines.length===1?this.handleNextSegmentLineCombination(this.hitSESegments[0],this.currentSphereVector):this.handleNextSegment(this.hitSESegments[0]));break}if(this.targetPoints.length===3)this.makeAngleMarkerFromThreePoints()&&$.fire("show-alert",{key:"handlers.newAngleAdded",keyOptions:{},type:"success"}),this.mouseLeave(i);else if(this.targetLines.length===2)this.makeAngleMarkerFromTwoLines([this.lineClickLocation1,this.lineClickLocation2])&&$.fire("show-alert",{key:"handlers.newAngleAdded",keyOptions:{},type:"success"}),this.mouseLeave(i);else if(this.targetSegments.length===2)this.makeAngleMarkerFromTwoSegments()&&$.fire("show-alert",{key:"handlers.newAngleAdded",keyOptions:{},type:"success"}),this.mouseLeave(i);else if(this.targetLines.length===1&&this.targetSegments.length===1)this.makeAngleMarkerFromLineAndSegment()&&$.fire("show-alert",{key:"handlers.newAngleAdded",keyOptions:{},type:"success"}),this.mouseLeave(i);else{let n=0;switch(this.angleMode){case Di.POINTS:n=3-this.pointLocations.length,$.fire("show-alert",{key:"handlers.selectMorePoints",keyOptions:{needed:`${n}`},type:"info"});break;case Di.SEGMENTSORLINEANDSEGMENT:$.fire("show-alert",{key:"handlers.selectAnotherLineOrSegment",keyOptions:{},type:"info"})}}}}mouseMoved(i){if(super.mouseMoved(i),this.isOnSphere){switch(this.angleMode){case Di.NONE:this.hitSEPoints.length>0?(this.hitSEPoints[0].glowing=!0,this.snapOneDimensional=null,this.snapPoint=this.hitSEPoints[0]):this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.snapPoint=null):this.hitSELines.length>0?(this.hitSELines[0].glowing=!0,this.snapPoint=null):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.snapOneDimensional=this.hitSECircles[0],this.snapPoint=null):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.snapOneDimensional=this.hitSEEllipses[0],this.snapPoint=null):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.snapOneDimensional=this.hitSEParametrics[0],this.snapPoint=null):this.hitSEPolygons.length>0&&(this.hitSEPolygons[0].glowing=!0,this.snapOneDimensional=this.hitSEPolygons[0],this.snapPoint=null);break;case Di.POINTS:this.hitSEPoints.length>0?(this.hitSEPoints[0].glowing=!0,this.snapPoint=this.hitSEPoints[0],this.snapOneDimensional=null):this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.snapPoint=null,this.snapOneDimensional=this.hitSESegments[0]):this.hitSELines.length>0?(this.hitSELines[0].glowing=!0,this.snapPoint=null,this.snapOneDimensional=this.hitSELines[0]):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.snapPoint=null,this.snapOneDimensional=this.hitSECircles[0]):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.snapPoint=null,this.snapOneDimensional=this.hitSEEllipses[0]):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.snapPoint=null,this.snapOneDimensional=this.hitSEParametrics[0]):this.hitSEPolygons.length>0?(this.hitSEPolygons[0].glowing=!0,this.snapPoint=null,this.snapOneDimensional=this.hitSEPolygons[0]):(this.snapOneDimensional=null,this.snapPoint=null);break;case Di.SEGMENTSORLINEANDSEGMENT:this.hitSELines.length>0?this.hitSELines[0].glowing=!0:this.hitSESegments.length>0&&(this.hitSESegments[0].glowing=!0),this.snapOneDimensional=null,this.snapPoint=null;break}if(this.angleMode!==Di.SEGMENTSORLINEANDSEGMENT)switch(this.pointLocations.length){case 0:this.isTemporaryFirstPointAdded||(this.isTemporaryFirstPointAdded=!0,this.temporaryFirstPoint.addToLayers(this.layers)),this.temporaryFirstPoint.positionVector=this.currentSphereVector,this.hitSEPoints[0]instanceof Ze?this.hitSEPoints[0]instanceof Le||this.hitSEPoints[0]instanceof ut?this.hitSEPoints[0].isUserCreated?(this.temporaryFirstPoint.removeFromLayers(),this.isTemporaryFirstPointAdded=!1):this.temporaryFirstPoint.positionVector=this.hitSEPoints[0].locationVector:(this.temporaryFirstPoint.removeFromLayers(),this.isTemporaryFirstPointAdded=!1):(this.hitSELines.length>0||this.hitSESegments.length>0)&&(this.temporaryFirstPoint.removeFromLayers(),this.isTemporaryFirstPointAdded=!1);break;case 1:this.isTemporarySecondPointAdded||(this.isTemporarySecondPointAdded=!0,this.temporarySecondPoint.addToLayers(this.layers)),this.snapPoint!==null&&(this.snapPoint instanceof Le&&this.snapPoint.isUserCreated||this.snapPoint instanceof ut&&this.snapPoint.isUserCreated)&&(this.temporarySecondPoint.removeFromLayers(),this.isTemporarySecondPointAdded=!1),this.snapPoint!==null?this.temporarySecondPoint.positionVector=this.snapPoint.locationVector:this.snapOneDimensional!==null?this.temporarySecondPoint.positionVector=this.snapOneDimensional.closestVector(this.currentSphereVector):this.temporarySecondPoint.positionVector=this.currentSphereVector;break;case 2:this.isTemporaryThirdPointAdded||(this.isTemporaryThirdPointAdded=!0,this.temporaryThirdPoint.addToLayers(this.layers)),this.snapPoint!==null&&(this.temporaryThirdPoint.removeFromLayers(),this.isTemporaryThirdPointAdded=!1),this.snapPoint!==null?this.temporaryThirdPoint.positionVector=this.snapPoint.locationVector:this.snapOneDimensional!==null?this.temporaryThirdPoint.positionVector=this.snapOneDimensional.closestVector(this.currentSphereVector):this.temporaryThirdPoint.positionVector=this.currentSphereVector,this.isTemporaryAngleMarkerAdded||(this.isTemporaryAngleMarkerAdded=!0,this.temporaryAngleMarker.addToLayers(this.layers)),this.temporaryAngleMarker.setAngleMarkerFromThreeVectors(this.temporaryFirstPoint.positionVector,this.temporarySecondPoint.positionVector,this.currentSphereVector,ih.currentAngleMarkerRadius),this.temporaryAngleMarker.updateDisplay();break}}else switch(this.pointLocations.length){case 0:this.temporaryFirstPoint.removeFromLayers(),this.isTemporaryFirstPointAdded=!1,this.temporarySecondPoint.removeFromLayers(),this.isTemporarySecondPointAdded=!1,this.temporaryThirdPoint.removeFromLayers(),this.isTemporaryThirdPointAdded=!1,this.temporaryAngleMarker.removeFromLayers(),this.isTemporaryAngleMarkerAdded=!1;break;case 1:this.temporarySecondPoint.removeFromLayers(),this.isTemporarySecondPointAdded=!1,this.temporaryThirdPoint.removeFromLayers(),this.isTemporaryThirdPointAdded=!1,this.temporaryAngleMarker.removeFromLayers(),this.isTemporaryAngleMarkerAdded=!1;break;case 2:this.temporaryThirdPoint.removeFromLayers(),this.isTemporaryThirdPointAdded=!1,this.temporaryAngleMarker.removeFromLayers(),this.isTemporaryAngleMarkerAdded=!1;break}}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.deactivate()}activate(){super.activate()}deactivate(){super.deactivate(),this.targetLines.forEach(i=>i.selected=!1),this.targetSegments.forEach(i=>i.selected=!1),this.targetPoints.forEach(i=>{i!==null&&(i.selected=!1)}),this.targetPoints.splice(0),this.targetLines.splice(0),this.lineClickLocation1.set(0,0,0),this.lineClickLocation2.set(0,0,0),this.targetSegments.splice(0),this.pointLocations.splice(0),this.sePointOneDimensionalParents.splice(0),this.makingAnAngleMarker=!1,this.angleMode=Di.NONE,this.temporaryFirstPoint.removeFromLayers(),this.isTemporaryFirstPointAdded=!1,this.temporarySecondPoint.removeFromLayers(),this.isTemporarySecondPointAdded=!1,this.temporaryThirdPoint.removeFromLayers(),this.isTemporaryThirdPointAdded=!1,this.temporaryAngleMarker.removeFromLayers(),this.isTemporaryAngleMarkerAdded=!1,this.snapOneDimensional=null,this.snapPoint=null}makeAngleMarkerFromThreePoints(){var s,o,a,l,c,u;if(this.targetPoints.every(h=>h!==null)){let h="";if(Or.store.expressions.some(d=>{var f,m,g;return d instanceof en&&d.parents[0].name===((f=this.targetPoints[0])==null?void 0:f.name)&&d.parents[1].name===((m=this.targetPoints[1])==null?void 0:m.name)&&d.parents[2].name===((g=this.targetPoints[2])==null?void 0:g.name)?(h=d.name,!0):!1}))return $.fire("show-alert",{key:"handlers.duplicateThreePointAngleMeasurement",keyOptions:{pt0Name:`${(o=(s=this.targetPoints[0])==null?void 0:s.label)==null?void 0:o.ref.shortUserName}`,pt1Name:`${(l=(a=this.targetPoints[1])==null?void 0:a.label)==null?void 0:l.ref.shortUserName}`,pt2Name:`${(u=(c=this.targetPoints[2])==null?void 0:c.label)==null?void 0:u.ref.shortUserName}`,measurementName:`${h}`},type:"error"}),!1}const i=new Dt;for(let h=0;h<3;h++)if(this.sePointOneDimensionalParents[h]!==null&&this.targetPoints[h]===null){const d=new kt(this.sePointOneDimensionalParents[h]);d.locationVector=this.pointLocations[h];const f=d.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));i.addCommand(new zt(d,this.sePointOneDimensionalParents[h],f)),Or.addCreateAntipodeCommand(d,i),this.targetPoints[h]=d}else if(this.sePointOneDimensionalParents[h]===null&&this.targetPoints[h]===null){const d=new Ze,f=d.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));i.addCommand(new Mn(d,f)),d.locationVector=this.pointLocations[h],Or.addCreateAntipodeCommand(d,i),this.targetPoints[h]=d}else(this.targetPoints[h]instanceof Le&&!this.targetPoints[h].isUserCreated||this.targetPoints[h]instanceof ut&&!this.targetPoints[h].isUserCreated)&&i.addCommand(new sn(this.targetPoints[h],!0));const n=new en(Di.POINTS,Or.store.zoomMagnificationFactor,this.targetPoints[0],this.targetPoints[1],this.targetPoints[2]),r=new De("angleMarker",n);return n.valueDisplayMode=S.angleMarker.initialValueDisplayMode,n.markKidsOutOfDate(),n.update(),this.tmpVector.copy(this.pointLocations[1]).add(new k(-2*S.angleMarker.initialLabelOffset,-1*S.angleMarker.initialLabelOffset,0)).normalize(),this.targetPoints[1].label.showing=!1,r.locationVector=this.tmpVector,i.addCommand(new Yc(Di.POINTS,n,r,this.targetPoints[0],this.targetPoints[1],this.targetPoints[2])),i.execute(),n.markKidsOutOfDate(),n.update(),!0}makeAngleMarkerFromTwoLines(i){var o,a,l,c;let n="";if(Or.store.expressions.some(u=>{var h,d,f,m,g,v,p,b;return u instanceof en&&u.parents[0].name===((h=this.targetLines[0])==null?void 0:h.name)&&u.parents[1].name===((d=this.targetLines[1])==null?void 0:d.name)?(this.tmpVector.crossVectors((f=this.targetLines[0])==null?void 0:f.normalVector,(m=this.targetLines[1])==null?void 0:m.normalVector).normalize(),this.tmpVector.z*i[0].z<0&&this.tmpVector.multiplyScalar(-1),this.tmpVector1.crossVectors(this.tmpVector,(g=this.targetLines[0])==null?void 0:g.normalVector).normalize(),this.tmpVector2.crossVectors(this.tmpVector,(v=this.targetLines[1])==null?void 0:v.normalVector).normalize(),this.tmpVector1.dot((p=this.targetLines[0])==null?void 0:p.closestVector(this.lineClickLocation1))<0&&u.firstPointDirectionScalar===-1&&this.tmpVector.z*u.vertexVector.z>0||this.tmpVector1.dot((b=this.targetLines[0])==null?void 0:b.closestVector(this.lineClickLocation1))>0&&u.firstPointDirectionScalar===1&&this.tmpVector.z*u.vertexVector.z>0?(n=u.name,!0):!1):!1}))return $.fire("show-alert",{key:"handlers.duplicateLineAngleMeasurement",keyOptions:{line0Name:`${(a=(o=this.targetLines[0])==null?void 0:o.label)==null?void 0:a.ref.shortUserName}`,line1Name:`${(c=(l=this.targetLines[1])==null?void 0:l.label)==null?void 0:c.ref.shortUserName}`,measurementName:`${n}`},type:"error"}),!1;const r=new en(Di.LINES,Or.store.zoomMagnificationFactor,this.targetLines[0],this.targetLines[1],void 0,i[0],i[1]),s=new De("angleMarker",r);return r.valueDisplayMode=S.angleMarker.initialValueDisplayMode,r.markKidsOutOfDate(),r.update(),this.tmpVector.crossVectors(this.targetLines[0].normalVector,this.targetLines[1].normalVector),this.tmpVector.z<0&&this.tmpVector.multiplyScalar(-1),this.tmpVector.add(new k(-2*S.angleMarker.initialLabelOffset,-1*S.angleMarker.initialLabelOffset,0)).normalize(),s.locationVector=this.tmpVector,new Yc(Di.LINES,r,s,this.targetLines[0],this.targetLines[1]).execute(),r.markKidsOutOfDate(),r.update(),!0}makeAngleMarkerFromTwoSegments(){var s,o,a,l;let i="";if(Or.store.expressions.some(c=>{var u,h;return c instanceof en&&c.parents[0].name===((u=this.targetSegments[0])==null?void 0:u.name)&&c.parents[1].name===((h=this.targetSegments[1])==null?void 0:h.name)?(i=c.name,!0):!1}))return $.fire("show-alert",{key:"handlers.duplicateSegmentAngleMeasurement",keyOptions:{seg0Name:`${(o=(s=this.targetSegments[0])==null?void 0:s.label)==null?void 0:o.ref.shortUserName}`,seg1Name:`${(l=(a=this.targetSegments[1])==null?void 0:a.label)==null?void 0:l.ref.shortUserName}`,measurementName:`${i}`},type:"error"}),!1;const n=new en(Di.SEGMENTS,Or.store.zoomMagnificationFactor,this.targetSegments[0],this.targetSegments[1]),r=new De("angleMarker",n);return n.valueDisplayMode=S.angleMarker.initialValueDisplayMode,n.markKidsOutOfDate(),n.update(),this.targetSegments[0].startSEPoint===this.targetSegments[1].startSEPoint?(this.tmpVector.copy(this.targetSegments[0].startSEPoint.locationVector),this.targetSegments[0].startSEPoint.label.showing=!1):this.targetSegments[0].startSEPoint===this.targetSegments[1].endSEPoint?(this.tmpVector.copy(this.targetSegments[0].startSEPoint.locationVector),this.targetSegments[0].startSEPoint.label.showing=!1):this.targetSegments[0].endSEPoint===this.targetSegments[1].startSEPoint?(this.tmpVector.copy(this.targetSegments[1].startSEPoint.locationVector),this.targetSegments[1].startSEPoint.label.showing=!1):this.targetSegments[0].endSEPoint===this.targetSegments[1].endSEPoint?(this.tmpVector.copy(this.targetSegments[1].endSEPoint.locationVector),this.targetSegments[1].endSEPoint.label.showing=!1):(this.tmpVector.set(0,0,1),console.log("In AngleHandler A pair of select segments doesn't have a common endpoint -- error!")),this.tmpVector.add(new k(-2*S.angleMarker.initialLabelOffset,-1*S.angleMarker.initialLabelOffset,0)).normalize(),r.locationVector=this.tmpVector,new Yc(Di.SEGMENTS,n,r,this.targetSegments[0],this.targetSegments[1]).execute(),n.markKidsOutOfDate(),n.update(),!0}makeAngleMarkerFromLineAndSegment(){var s,o,a,l;let i="";if(this.lineSelectedFirst?Or.store.expressions.some(c=>{var u,h;return c instanceof en&&c.firstSEParent.name===((u=this.targetLines[0])==null?void 0:u.name)&&c.secondSEParent.name===((h=this.targetSegments[0])==null?void 0:h.name)?(i=c.name,!0):!1}):Or.store.expressions.some(c=>{var u,h;return c instanceof en&&c.firstSEParent.name===((u=this.targetSegments[0])==null?void 0:u.name)&&c.secondSEParent.name===((h=this.targetLines[0])==null?void 0:h.name)?(i=c.name,!0):!1}),i!=="")return $.fire("show-alert",{key:"handlers.duplicateSegmentLineAngleMeasurement",keyOptions:{lineName:`${(o=(s=this.targetLines[0])==null?void 0:s.label)==null?void 0:o.ref.shortUserName}`,segName:`${(l=(a=this.targetSegments[0])==null?void 0:a.label)==null?void 0:l.ref.shortUserName}`,measurementName:`${i}`},type:"error"}),!1;let n;this.lineSelectedFirst?n=new en(Di.LINEANDSEGMENT,Or.store.zoomMagnificationFactor,this.targetLines[0],this.targetSegments[0]):n=new en(Di.LINEANDSEGMENT,Or.store.zoomMagnificationFactor,this.targetSegments[0],this.targetLines[0]);const r=new De("angleMarker",n);return n.valueDisplayMode=S.angleMarker.initialValueDisplayMode,n.markKidsOutOfDate(),n.update(),this.targetSegments[0].startSEPoint instanceof kt&&this.targetSegments[0].startSEPoint.parentOneDimensional===this.targetLines[0]?(this.tmpVector.copy(this.targetSegments[0].startSEPoint.locationVector),this.targetSegments[0].startSEPoint.label.showing=!1):this.targetSegments[0].endSEPoint instanceof kt&&this.targetSegments[0].endSEPoint.parentOneDimensional===this.targetLines[0]?(this.tmpVector.copy(this.targetSegments[0].endSEPoint.locationVector),this.targetSegments[0].endSEPoint.label.showing=!1):this.targetSegments[0].endSEPoint===this.targetLines[0].startSEPoint||this.targetSegments[0].endSEPoint===this.targetLines[0].endSEPoint?(this.tmpVector.copy(this.targetSegments[0].endSEPoint.locationVector),this.targetSegments[0].endSEPoint.label.showing=!1):this.targetSegments[0].startSEPoint===this.targetLines[0].startSEPoint||this.targetSegments[0].startSEPoint===this.targetLines[0].endSEPoint?(this.tmpVector.copy(this.targetSegments[0].startSEPoint.locationVector),this.targetSegments[0].startSEPoint.label.showing=!1):(this.tmpVector.set(0,0,1),console.log("In AngleHandler a selected segment doesn't have a endpoint on selected line -- error!")),this.tmpVector.add(new k(-2*S.angleMarker.initialLabelOffset,-1*S.angleMarker.initialLabelOffset,0)).normalize(),r.locationVector=this.tmpVector,new Yc(Di.LINEANDSEGMENT,n,r,this.targetLines[0],this.targetSegments[0]).execute(),n.markKidsOutOfDate(),n.update(),!0}}class Pm extends _i{constructor(i){super(i);y(this,"targetPoint",null)}mousePressed(i){var n,r;if(this.isOnSphere){const s=this.hitSEPoints.filter(o=>!!((!(o instanceof Le)||o.isUserCreated)&&(!(o instanceof ut)||o.isUserCreated)));if(s.length>0&&(this.targetPoint=s[0]),Pm.store.expressions.some(o=>{var a;return o instanceof ma&&o.parents[0].name===((a=this.targetPoint)==null?void 0:a.name)})){$.fire("show-alert",{key:"handlers.duplicatePointCoordinateMeasurement",keyOptions:{ptName:`${(r=(n=this.targetPoint)==null?void 0:n.label)==null?void 0:r.ref.shortUserName}`},type:"error"});return}if(this.targetPoint!=null&&this.targetPoint.label!==void 0){const o=new ma(this.targetPoint,No.X_VALUE),a=new ma(this.targetPoint,No.Y_VALUE),l=new ma(this.targetPoint,No.Z_VALUE);$.fire("show-alert",{key:"handlers.newCoordinatePointMeasurementAdded",keyOptions:{},type:"success"});const c=new Dt;c.addCommand(new Fc(o,this.targetPoint,No.X_VALUE)),c.addCommand(new Fc(a,this.targetPoint,No.Y_VALUE)),c.addCommand(new Fc(l,this.targetPoint,No.Z_VALUE)),c.addCommand(new vc([this.targetPoint.label.ref],q.Label,[{labelDisplayMode:S.point.readingCoordinatesChangesLabelModeTo}],[{labelDisplayMode:this.targetPoint.label.ref.labelDisplayMode}])),c.addCommand(new qi(this.targetPoint.label,!0)),c.execute(),this.targetPoint.markKidsOutOfDate(),this.targetPoint.update(),this.targetPoint=null}}}mouseMoved(i){super.mouseMoved(i);const n=this.hitSEPoints.filter(r=>!!((!(r instanceof Le)||r.isUserCreated)&&(!(r instanceof ut)||r.isUserCreated)));n.length>0&&(n[0].glowing=!0)}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.targetPoint=null}activate(){if(Pm.store.selectedSENodules.every(n=>n instanceof Ze&&!(n instanceof Le&&!n.isUserCreated)&&!(n instanceof ut&&!n.isUserCreated))&&Pm.store.selectedSENodules.length>0){const n=new Dt;Pm.store.selectedSENodules.map(r=>r).filter(r=>r instanceof Ze&&!(r instanceof Le&&!r.isUserCreated)&&!(r instanceof ut&&!r.isUserCreated)).forEach(r=>{const s=new ma(r,No.X_VALUE),o=new ma(r,No.Y_VALUE),a=new ma(r,No.Z_VALUE);n.addCommand(new Fc(s,r,No.Z_VALUE)),n.addCommand(new Fc(o,r,No.Y_VALUE)),n.addCommand(new Fc(a,r,No.Z_VALUE))}),n.execute(),$.fire("show-alert",{key:"handlers.newCoordinatePointMeasurementAdded",keyOptions:{},type:"success"})}super.activate()}deactivate(){super.deactivate()}}class Em extends _i{constructor(i){super(i);y(this,"label",null);y(this,"keyPressHandler",i=>{if(i.code==="KeyS"&&!i.shiftKey){const n=new Dt;Em.store.seNodules.map(r=>r).filter(r=>(!(r instanceof Le)||r.isUserCreated)&&(!(r instanceof ut)||r.isUserCreated)).filter(r=>r.showing).filter(r=>r.isLabelable()?!r.label.showing:!1).forEach(r=>{r.isLabelable()&&n.addCommand(new qi(r.label,!0))}),n.execute()}if(i.code==="KeyH"&&!i.shiftKey){const n=new Dt;Em.store.seNodules.map(r=>r).filter(r=>!(r instanceof Le||r instanceof ut)||r.isUserCreated).filter(r=>r.showing).filter(r=>r.isLabelable()?r.label.showing:!1).forEach(r=>{r.isLabelable()&&n.addCommand(new qi(r.label,!1))}),n.execute()}})}mousePressed(i){this.isOnSphere&&(this.hitSEPoints.length>0&&!(this.hitSEPoints[0]instanceof Le&&!this.hitSEPoints[0].isUserCreated||this.hitSEPoints[0]instanceof ut&&!this.hitSEPoints[0].isUserCreated)?this.hitSEPoints[0].label!=null&&(this.label=this.hitSEPoints[0].label):this.hitSESegments.length>0?this.hitSESegments[0].label!=null&&(this.label=this.hitSESegments[0].label):this.hitSELines.length>0?this.hitSELines[0].label!=null&&(this.label=this.hitSELines[0].label):this.hitSECircles.length>0?this.hitSECircles[0].label!=null&&(this.label=this.hitSECircles[0].label):this.hitSEEllipses.length>0?this.hitSEEllipses[0].label!=null&&(this.label=this.hitSEEllipses[0].label):this.hitSEParametrics.length>0?this.hitSEParametrics[0].label!=null&&(this.label=this.hitSEParametrics[0].label):this.hitSEAngleMarkers.length>0?this.hitSEAngleMarkers[0].label!=null&&(this.label=this.hitSEAngleMarkers[0].label):this.hitSEPolygons.length>0?this.hitSEPolygons[0].label!=null&&(this.label=this.hitSEPolygons[0].label):this.hitSELabels.length>0&&(this.label=this.hitSELabels[0]),this.label!=null&&(new qi(this.label,!this.label.showing).execute(),this.label=null))}mouseMoved(i){super.mouseMoved(i),this.hitSEPoints.length>0&&!(this.hitSEPoints[0]instanceof Le&&!this.hitSEPoints[0].isUserCreated||this.hitSEPoints[0]instanceof ut&&!this.hitSEPoints[0].isUserCreated)?this.hitSEPoints[0].glowing=!0:this.hitSESegments.length>0?this.hitSESegments[0].glowing=!0:this.hitSELines.length>0?this.hitSELines[0].glowing=!0:this.hitSECircles.length>0?this.hitSECircles[0].glowing=!0:this.hitSEParametrics.length>0?this.hitSEParametrics[0].glowing=!0:this.hitSEAngleMarkers.length>0?this.hitSEAngleMarkers[0].glowing=!0:this.hitSEPolygons.length>0?this.hitSEPolygons[0].glowing=!0:this.hitSELabels.length>0&&(this.hitSELabels[0].glowing=!0)}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.label=null}activate(){if(window.addEventListener("keydown",this.keyPressHandler),Em.store.selectedSENodules.length!==0){const i=new Dt;Em.store.selectedSENodules.map(n=>n).filter(n=>(!(n instanceof Le)||n.isUserCreated)&&(!(n instanceof ut)||n.isUserCreated)).forEach(n=>{n.isLabelable()&&i.addCommand(new qi(n.label,!n.label.showing))}),i.execute()}super.activate()}deactivate(){window.removeEventListener("keydown",this.keyPressHandler),super.deactivate()}}class mSe extends L{constructor(i){super();y(this,"pencil");this.pencil=i}do(){L.store.addPoint(this.pencil.commonPoint),this.pencil.lines.forEach(i=>{L.store.addLine(i),this.pencil.commonPoint.registerChild(i),this.pencil.commonParametric.registerChild(i)})}saveState(){}restoreState(){this.pencil.lines.forEach(i=>{this.pencil.commonPoint.unregisterChild(i),this.pencil.commonParametric.unregisterChild(i),L.store.removeLine(i.id)}),L.store.removePoint(this.pencil.commonPoint.id)}toOpcode(){return null}static parse(i,n){return new Dt}}class uo extends _i{constructor(i){super(i);y(this,"tempPlots",[]);y(this,"temporaryPointMarker");y(this,"temporaryPointAdded");y(this,"snapToTemporaryOneDimensional",null);y(this,"snapToTemporaryPoint",null);y(this,"oneDimensional",null);y(this,"sePoint",null);y(this,"sePointOneDimensionalParent",null);y(this,"sePointVector",new k(0,0,0));y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"selectOneObjectAtATime",!0);y(this,"numberOfPerpendiculars",1);this.tempPlots.push({line:new _s,point:new mi,exist:!1,tmpNormal:new k}),uo.store.addTemporaryNodule(this.tempPlots[0].line),uo.store.addTemporaryNodule(this.tempPlots[0].point),this.temporaryPointMarker=new mi,uo.store.addTemporaryNodule(this.temporaryPointMarker),this.temporaryPointAdded=!1}mousePressed(i){var n,r,s,o,a;this.isOnSphere&&(this.selectOneObjectAtATime=!0,this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&(this.hitSEPoints.length!==0||this.oneDimensional!==null||this.hitSENodules.length===0)&&(this.hitSEPoints.length>0?(this.sePoint=this.hitSEPoints[0],this.sePoint.selected=!0,this.sePointVector.copy(this.sePoint.locationVector),(this.sePoint instanceof Le||this.sePoint instanceof ut)&&!this.sePoint.isUserCreated&&(this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0)):this.hitSESegments.length>0?(this.sePointOneDimensionalParent=this.hitSESegments[0],this.sePointVector.copy(this.sePointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null):this.hitSELines.length>0?(this.sePointOneDimensionalParent=this.hitSELines[0],this.sePointVector.copy(this.sePointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null):this.hitSECircles.length>0?(this.sePointOneDimensionalParent=this.hitSECircles[0],this.sePointVector.copy(this.sePointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null):this.hitSEEllipses.length>0?(this.sePointOneDimensionalParent=this.hitSEEllipses[0],this.sePointVector.copy(this.sePointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null):this.hitSEParametrics.length>0?(this.sePointOneDimensionalParent=this.hitSEParametrics[0],this.sePointVector.copy(this.sePointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null):this.hitSEPolygons.length>0?(this.sePointOneDimensionalParent=this.hitSEPolygons[0],this.sePointVector.copy(this.currentSphereVector),this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null):(this.temporaryPointMarker.positionVector=this.currentSphereVector,this.sePointVector.copy(this.currentSphereVector),this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null),this.oneDimensional===null&&$.fire("show-alert",{key:"handlers.lineThruPointPointSelected",keyOptions:{},type:"info"}),this.selectOneObjectAtATime=!1),this.oneDimensional===null&&this.selectOneObjectAtATime&&(this.hitSESegments.length>0?(this.oneDimensional=this.hitSESegments[0],this.oneDimensional.selected=!0,this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&$.fire("show-alert",{key:"handlers.lineThruPointSegmentSelected",keyOptions:{name:`${(n=this.oneDimensional.label)==null?void 0:n.ref.shortUserName}`},type:"info"})):this.hitSELines.length>0?(this.oneDimensional=this.hitSELines[0],this.oneDimensional.selected=!0,this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&$.fire("show-alert",{key:"handlers.lineThruPointLineSelected",keyOptions:{name:`${(r=this.oneDimensional.label)==null?void 0:r.ref.shortUserName}`},type:"info"})):this.hitSECircles.length>0?(this.oneDimensional=this.hitSECircles[0],this.oneDimensional.selected=!0,this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&$.fire("show-alert",{key:"handlers.lineThruPointCircleSelected",keyOptions:{name:`${(s=this.oneDimensional.label)==null?void 0:s.ref.shortUserName}`},type:"info"})):this.hitSEEllipses.length>0?(this.oneDimensional=this.hitSEEllipses[0],this.oneDimensional.selected=!0,this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&$.fire("show-alert",{key:"handlers.lineThruPointEllipseSelected",keyOptions:{name:`${(o=this.oneDimensional.label)==null?void 0:o.ref.shortUserName}`},type:"info"})):this.hitSEParametrics.length>0&&(this.oneDimensional=this.hitSEParametrics[0],this.oneDimensional.selected=!0,this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&$.fire("show-alert",{key:"handlers.lineThruPointParametricSelected",keyOptions:{name:`${(a=this.oneDimensional.label)==null?void 0:a.ref.shortUserName}`},type:"info"}))),this.oneDimensional!==null&&(this.sePoint!==null||this.sePointOneDimensionalParent!==null||!this.sePointVector.isZero())&&(this.createPerpendicular(this.oneDimensional,this.sePointOneDimensionalParent,this.sePointVector,this.sePoint),this.cleanup()))}mouseMoved(i){if(super.mouseMoved(i),this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()?this.hitSEPoints.length>0?(this.hitSEPoints[0].glowing=!0,this.snapToTemporaryPoint=this.hitSEPoints[0],this.snapToTemporaryOneDimensional=null):this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSESegments[0],this.snapToTemporaryPoint=null):this.hitSELines.length>0?(this.hitSELines[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSELines[0],this.snapToTemporaryPoint=null):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSECircles[0],this.snapToTemporaryPoint=null):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEEllipses[0],this.snapToTemporaryPoint=null):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEParametrics[0],this.snapToTemporaryPoint=null):(this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null):!(this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero())&&this.oneDimensional===null&&(this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null):this.hitSELines.length>0?(this.hitSELines[0].glowing=!0,this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null):(this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null)),this.isOnSphere&&(this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&this.oneDimensional!==null&&(this.temporaryPointAdded||(this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0),this.snapToTemporaryPoint!==null&&(this.snapToTemporaryPoint instanceof Le&&!this.snapToTemporaryPoint.isUserCreated?this.temporaryPointMarker.positionVector=this.snapToTemporaryPoint.locationVector:(this.temporaryPointMarker.removeFromLayers(),this.temporaryPointAdded=!1)),this.snapToTemporaryOneDimensional!==null?this.temporaryPointMarker.positionVector=this.snapToTemporaryOneDimensional.closestVector(this.currentSphereVector):this.snapToTemporaryPoint==null&&(this.temporaryPointMarker.positionVector=this.currentSphereVector)),this.oneDimensional!==null)){let n;this.snapToTemporaryPoint!==null?n=this.snapToTemporaryPoint.locationVector:this.snapToTemporaryOneDimensional!==null?n=this.snapToTemporaryOneDimensional.closestVector(this.currentSphereVector):n=this.currentSphereVector;const r=this.oneDimensional.getNormalsToPerpendicularLinesThru(n,this.tempPlots[0].tmpNormal);for(;this.tempPlots.length<r.length;){const s=new _s,o=new mi;this.tempPlots.push({line:s,point:o,exist:!1,tmpNormal:new k}),uo.store.addTemporaryNodule(s),uo.store.addTemporaryNodule(o)}r.forEach((s,o)=>{const a=this.tempPlots[o];a.exist=!0,a.tmpNormal.copy(s.normal),a.line.normalVector=s.normal,a.line.addToLayers(this.layers),a.point.addToLayers(this.layers),a.point.positionVector=s.normalAt});for(let s=r.length;s<this.tempPlots.length;s++)this.tempPlots[s].exist=!1,this.tempPlots[s].line.removeFromLayers(),this.tempPlots[s].point.removeFromLayers()}}mouseReleased(i){}cleanup(){this.oneDimensional!==null&&(this.oneDimensional.selected=!1,this.oneDimensional=null),this.sePoint!==null&&(this.sePoint.selected=!1,this.sePoint=null),this.sePointOneDimensionalParent!==null&&(this.sePointOneDimensionalParent=null),this.temporaryPointMarker.removeFromLayers(),this.temporaryPointAdded=!1,this.tempPlots.forEach(i=>{i.exist=!1,i.line.removeFromLayers(),i.point.removeFromLayers()}),this.sePointVector.set(0,0,0),this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null}mouseLeave(i){super.mouseLeave(i),this.cleanup()}createPerpendicular(i,n,r,s){const o=new Dt,a=[];if(s===null){if(n!==null){this.sePoint=new kt(n),this.sePoint.locationVector=n.closestVector(r);const f=this.sePoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));o.addCommand(new zt(this.sePoint,n,f))}else{this.sePoint=new Ze,this.sePoint.locationVector=r;const f=this.sePoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));o.addCommand(new Mn(this.sePoint,f))}const d=uo.addCreateAntipodeCommand(this.sePoint,o);a.push(d,this.sePoint)}else(s instanceof Le||s instanceof ut)&&!s.isUserCreated&&o.addCommand(new sn(s,!0)),this.sePoint=s;let l=[],c=!1;const u=new Dt;i instanceof $t||i instanceof Jt||i instanceof Kt?(this.numberOfPerpendiculars=1,c=!1):i instanceof Ii?(this.numberOfPerpendiculars=4,c=!1):i instanceof tn&&(c=!0,this.numberOfPerpendiculars=Math.max(this.tempPlots.filter(d=>d.exist).length,1)),l=i.getNormalsToPerpendicularLinesThru(r,this.tempPlots[0].tmpNormal).map(d=>d.normal.normalize());const h=[];for(let d=0;d<this.numberOfPerpendiculars;d++){let f;l[d]!==void 0?f=l[d]:(f=new k(0,0,1),console.log("normal doesn't exist",f.x,f.y,f.z));const m=new Ze(!0);m.showing=!1,m.exists=!0,m.locationVector.crossVectors(r,f);const g=new OP(i,this.sePoint,f,m,d);c&&h.push(g),Math.abs(f.z-1)<S.tolerance&&(g.exists=!1),g.markKidsOutOfDate(),g.update();const v=new De("line",g);this.tmpVector1.copy(m.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),v.locationVector=this.tmpVector1,c||o.addCommand(new WP(g,this.sePoint,i,v)),uo.store.createAllIntersectionsWithLine(g,a).forEach(p=>{if(p.existingIntersectionPoint){console.debug("PerpendicularHandler: new command AddIntersectionPointOtherParent");const b=new nr(p.SEIntersectionPoint,p.parent1);c?u.addCommand(b):o.addCommand(b)}else{const b=p.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)),_=new ir(p.SEIntersectionPoint,p.parent1,p.parent2,b);console.debug("PerpendicularHandler: new command AddIntersectionPointCommand"),c?u.addCommand(_):o.addCommand(_),p.SEIntersectionPoint.showing=!1,b.showing=!1,p.createAntipodalPoint&&(c?uo.addCreateAntipodeCommand(p.SEIntersectionPoint,u):uo.addCreateAntipodeCommand(p.SEIntersectionPoint,o))}})}if(c&&(console.debug("Use pencil..."),h.length>0)){const d=new Fle(i,this.sePoint,h);h.forEach(f=>{f.seParentPencil=d}),u.addCommand(new mSe(d))}c?u.execute():o.execute()}activate(){if(uo.store.selectedSENodules.length==2){const i=uo.store.selectedSENodules[0],n=uo.store.selectedSENodules[1];i.isOneDimensional()&&n.isPoint()&&((!(n instanceof Le)||n.isUserCreated)&&!(n instanceof ut)||n.isUserCreated)&&this.createPerpendicular(i,null,n.locationVector,n),n.isOneDimensional()&&i.isPoint()&&(!(i instanceof Le)||i.isUserCreated)&&(!(i instanceof ut)||i.isUserCreated)&&this.createPerpendicular(n,null,i.locationVector,i)}super.activate()}deactivate(){super.deactivate()}}class js extends _i{constructor(i){super(i);y(this,"tempPlots",[]);y(this,"temporaryPointMarker");y(this,"temporaryPointAdded");y(this,"snapToTemporaryOneDimensional",null);y(this,"snapToTemporaryPoint",null);y(this,"oneDimensional",null);y(this,"sePoint",null);y(this,"sePointOneDimensionalParent",null);y(this,"sePointVector",new k(0,0,0));y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"selectOneObjectAtATime",!0);y(this,"numberOfTangents",1);this.tempPlots.push({line:new _s,point:new mi,exist:!1,tmpNormal:new k}),js.store.addTemporaryNodule(this.tempPlots[0].line),js.store.addTemporaryNodule(this.tempPlots[0].point),this.temporaryPointMarker=new mi,this.temporaryPointMarker.stylize(Vt.ApplyTemporaryVariables),js.store.addTemporaryNodule(this.temporaryPointMarker),this.temporaryPointAdded=!1}mousePressed(i){var n,r,s;this.isOnSphere&&(this.selectOneObjectAtATime=!0,this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&(this.hitSEPoints.length!==0||this.oneDimensional!==null||this.hitSENodules.length===0)&&(this.hitSEPoints.length>0?(this.sePoint=this.hitSEPoints[0],this.sePoint.selected=!0,this.sePointVector.copy(this.sePoint.locationVector),(this.sePoint instanceof Le&&!this.sePoint.isUserCreated||this.sePoint instanceof ut&&!this.sePoint.isUserCreated)&&(this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0)):this.hitSECircles.length>0?(this.sePointOneDimensionalParent=this.hitSECircles[0],this.sePointVector.copy(this.sePointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null):this.hitSEEllipses.length>0?(this.sePointOneDimensionalParent=this.hitSEEllipses[0],this.sePointVector.copy(this.sePointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null):this.hitSEParametrics.length>0?(this.sePointOneDimensionalParent=this.hitSEParametrics[0],this.sePointVector.copy(this.sePointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null):this.hitSEPolygons.length>0?(this.sePointOneDimensionalParent=this.hitSEPolygons[0],this.sePointVector.copy(this.currentSphereVector),this.temporaryPointMarker.positionVector=this.sePointVector,this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null):(this.temporaryPointMarker.positionVector=this.currentSphereVector,this.sePointVector.copy(this.currentSphereVector),this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0,this.sePoint=null),this.oneDimensional===null&&$.fire("show-alert",{key:"handlers.lineThruPointPointSelected",keyOptions:{},type:"info"}),this.selectOneObjectAtATime=!1),this.oneDimensional===null&&this.selectOneObjectAtATime&&(this.hitSECircles.length>0?(this.oneDimensional=this.hitSECircles[0],this.oneDimensional.selected=!0,this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&$.fire("show-alert",{key:"handlers.lineThruPointCircleSelected",keyOptions:{name:`${(n=this.oneDimensional.label)==null?void 0:n.ref.shortUserName}`},type:"info"})):this.hitSEEllipses.length>0?(this.oneDimensional=this.hitSEEllipses[0],this.oneDimensional.selected=!0,this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&$.fire("show-alert",{key:"handlers.lineThruPointEllipseSelected",keyOptions:{name:`${(r=this.oneDimensional.label)==null?void 0:r.ref.shortUserName}`},type:"info"})):this.hitSEParametrics.length>0&&(this.oneDimensional=this.hitSEParametrics[0],this.oneDimensional.selected=!0,this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&$.fire("show-alert",{key:"handlers.lineThruPointParametricSelected",keyOptions:{name:`${(s=this.oneDimensional.label)==null?void 0:s.ref.shortUserName}`},type:"info"}))),this.oneDimensional!==null&&(this.sePoint!==null||this.sePointOneDimensionalParent!==null||!this.sePointVector.isZero())&&(this.createTangent(this.oneDimensional,this.sePointOneDimensionalParent,this.sePointVector,this.sePoint),this.oneDimensional.selected=!1,this.oneDimensional=null,this.sePointOneDimensionalParent=null,this.sePoint!==null&&(this.sePoint.selected=!1),this.sePoint=null,this.temporaryPointAdded&&(this.temporaryPointMarker.removeFromLayers(),this.temporaryPointAdded=!1),this.temporaryPointMarker.removeFromLayers(),this.temporaryPointAdded=!1,this.tempPlots.forEach(o=>{o.line.removeFromLayers(),o.point.removeFromLayers(),o.exist=!1}),this.sePointVector.set(0,0,0)))}mouseMoved(i){if(super.mouseMoved(i),this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()?this.hitSEPoints.length>0?(this.hitSEPoints[0].glowing=!0,this.snapToTemporaryPoint=this.hitSEPoints[0],this.snapToTemporaryOneDimensional=null):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSECircles[0],this.snapToTemporaryPoint=null):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEEllipses[0],this.snapToTemporaryPoint=null):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.snapToTemporaryOneDimensional=this.hitSEParametrics[0],this.snapToTemporaryPoint=null):(this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null):!(this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero())&&this.oneDimensional===null&&(this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null):this.hitSEEllipses.length>0?(this.hitSEEllipses[0].glowing=!0,this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null):this.hitSEParametrics.length>0?(this.hitSEParametrics[0].glowing=!0,this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null):(this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null)),this.isOnSphere&&(this.sePoint===null&&this.sePointOneDimensionalParent===null&&this.sePointVector.isZero()&&this.oneDimensional!==null&&(this.temporaryPointAdded||(this.temporaryPointMarker.addToLayers(this.layers),this.temporaryPointAdded=!0),this.snapToTemporaryPoint!==null&&(this.snapToTemporaryPoint instanceof Le&&!this.snapToTemporaryPoint.isUserCreated||this.snapToTemporaryPoint instanceof ut&&!this.snapToTemporaryPoint.isUserCreated?this.temporaryPointMarker.positionVector=this.snapToTemporaryPoint.locationVector:(this.temporaryPointMarker.removeFromLayers(),this.temporaryPointAdded=!1)),this.snapToTemporaryOneDimensional!==null?this.temporaryPointMarker.positionVector=this.snapToTemporaryOneDimensional.closestVector(this.currentSphereVector):this.snapToTemporaryPoint==null&&(this.temporaryPointMarker.positionVector=this.currentSphereVector)),this.oneDimensional!==null)){let n;this.snapToTemporaryPoint!==null?n=this.snapToTemporaryPoint.locationVector:this.snapToTemporaryOneDimensional!==null?n=this.snapToTemporaryOneDimensional.closestVector(this.currentSphereVector):n=this.currentSphereVector;const r=this.oneDimensional.getNormalsToTangentLinesThru(n,js.store.zoomMagnificationFactor);for(;this.tempPlots.length<r.length;){const s=new _s,o=new mi;this.tempPlots.push({line:s,point:o,exist:!1,tmpNormal:new k}),s.stylize(Vt.ApplyTemporaryVariables),js.store.addTemporaryNodule(s),o.stylize(Vt.ApplyTemporaryVariables),js.store.addTemporaryNodule(o)}r.forEach((s,o)=>{const a=this.tempPlots[o];a.exist=!0,a.tmpNormal.copy(r[o].normal),a.line.normalVector=r[o].normal,a.line.addToLayers(this.layers),a.point.positionVector=r[o].tangentAt,a.point.addToLayers(this.layers)});for(let s=r.length;s<this.tempPlots.length;s++)this.tempPlots[s].line.removeFromLayers(),this.tempPlots[s].point.removeFromLayers(),this.tempPlots[s].exist=!1}}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.oneDimensional!==null&&(this.oneDimensional.selected=!1,this.oneDimensional=null),this.sePoint!==null&&(this.sePoint.selected=!1,this.sePoint=null),this.sePointOneDimensionalParent!==null&&(this.sePointOneDimensionalParent=null),this.temporaryPointMarker.removeFromLayers(),this.temporaryPointAdded=!1,this.tempPlots.forEach(n=>{n.exist=!1,n.line.removeFromLayers(),n.point.removeFromLayers()}),this.sePointVector.set(0,0,0),this.snapToTemporaryOneDimensional=null,this.snapToTemporaryPoint=null}createTangent(i,n,r,s){const o=new Dt,a=[];if(s===null){if(n!==null){this.sePoint=new kt(n),this.sePoint.locationVector=n.closestVector(r);const u=this.sePoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));o.addCommand(new zt(this.sePoint,n,u))}else{this.sePoint=new Ze,this.sePoint.locationVector=r;const u=this.sePoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));o.addCommand(new Mn(this.sePoint,u))}const c=js.addCreateAntipodeCommand(this.sePoint,o);a.push(c,this.sePoint)}else(s instanceof Le&&!s.isUserCreated||s instanceof ut&&!s.isUserCreated)&&o.addCommand(new sn(s,!0)),this.sePoint=s;let l=[];i instanceof Kt||i instanceof Ii?this.numberOfTangents=2:i instanceof tn&&(this.numberOfTangents=this.tempPlots.filter(c=>c.exist).length),l=i.getNormalsToTangentLinesThru(r,js.store.zoomMagnificationFactor);for(let c=0;c<this.numberOfTangents;c++){let u;l[c]!==void 0?u=l[c].normal:u=new k(0,0,1);const h=new Ze(!0);h.showing=!1,h.exists=!0,h.locationVector.crossVectors(r,u);const d=new Gp(i,this.sePoint,u,h,c);Math.abs(u.z-1)<S.tolerance&&(d.exists=!1),d.markKidsOutOfDate(),d.update();const f=new De("line",d);this.tmpVector1.copy(h.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),f.locationVector=this.tmpVector1,o.addCommand(new qP(d,this.sePoint,i,f)),js.store.createAllIntersectionsWithLine(d,a).forEach(m=>{if(m.existingIntersectionPoint)o.addCommand(new nr(m.SEIntersectionPoint,m.parent1));else{const g=m.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));o.addCommand(new ir(m.SEIntersectionPoint,m.parent1,m.parent2,g)),m.SEIntersectionPoint.showing=!1,g.showing=!1,m.createAntipodalPoint&&js.addCreateAntipodeCommand(m.SEIntersectionPoint,o)}})}o.execute()}activate(){if(js.store.selectedSENodules.length==2){const i=js.store.selectedSENodules[0],n=js.store.selectedSENodules[1];i.isOneDimensional()&&n.isPoint()&&(!(n instanceof Le)||n.isUserCreated)&&(!(n instanceof ut)||n.isUserCreated)&&(i instanceof Kt||i instanceof Ii||i instanceof tn)&&this.createTangent(i,null,n.locationVector,n),n.isOneDimensional()&&i.isPoint()&&(!(i instanceof Le)||i.isUserCreated)&&(!(i instanceof ut)||i.isUserCreated)&&(n instanceof Kt||n instanceof Ii||n instanceof tn)&&this.createTangent(n,null,i.locationVector,i)}super.activate()}deactivate(){super.deactivate()}}class pSe{constructor(){}mousePressed(e){}mouseMoved(e){}mouseReleased(e){}mouseLeave(e){}activate(){}deactivate(){}createIconPaths(){$.fire("export-current-svg",{})}}const gSe=new k;class Xr extends _i{constructor(i){super(i);y(this,"focus1Vector");y(this,"focus2Vector");y(this,"temporaryEllipse");y(this,"focus1SEPoint",null);y(this,"focus2SEPoint",null);y(this,"ellipseSEPoint",null);y(this,"focus1SEPointOneDimensionalParent",null);y(this,"focus2SEPointOneDimensionalParent",null);y(this,"focus1LocationSelected",!1);y(this,"focus2LocationSelected",!1);y(this,"a",0);y(this,"b",0);y(this,"temporaryFocus1Marker");y(this,"temporaryFocus2Marker");y(this,"temporaryEllipsePointMarker");y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpMatrix",new Pt);y(this,"temporaryEllipseAdded",!1);y(this,"temporaryFocus1MarkerAdded",!1);y(this,"temporaryFocus2MarkerAdded",!1);y(this,"temporaryEllipsePointMarkerAdded",!1);y(this,"snapTemporaryPointMarkerToOneDimensional",null);y(this,"snapTemporaryPointMarkerToPoint",null);this.focus1Vector=new k,this.focus2Vector=new k,this.temporaryEllipse=new ll,Xr.store.addTemporaryNodule(this.temporaryEllipse),this.temporaryFocus1Marker=new mi,Xr.store.addTemporaryNodule(this.temporaryFocus1Marker),this.temporaryFocus2Marker=new mi,Xr.store.addTemporaryNodule(this.temporaryFocus2Marker),this.temporaryEllipsePointMarker=new mi,Xr.store.addTemporaryNodule(this.temporaryEllipsePointMarker)}mousePressed(i){if(this.isOnSphere&&!this.focus2LocationSelected){if(this.hitSEPoints.length>0){const n=this.hitSEPoints[0];this.focus1LocationSelected?this.tmpVector.crossVectors(n.locationVector,this.focus1Vector).isZero(S.nearlyAntipodalIdeal)?$.fire("show-alert",{key:"handlers.ellipseAntipodalSelected",keyOptions:{},type:"info"}):(this.focus2Vector.copy(n.locationVector),this.focus2SEPoint=n,this.temporaryFocus2Marker.positionVector=n.locationVector,this.temporaryEllipse.focus2Vector=n.locationVector,this.focus2SEPoint.glowing=!0,this.focus2SEPoint.selected=!0,this.focus2LocationSelected=!0,this.mouseMoved(i)):(this.focus1Vector.copy(n.locationVector),this.focus1SEPoint=n,this.temporaryFocus1Marker.positionVector=n.locationVector,this.temporaryEllipse.focus1Vector=n.locationVector,this.focus1SEPoint.glowing=!0,this.focus1SEPoint.selected=!0,this.focus1LocationSelected=!0)}else this.hitSESegments.length>0?this.focus1LocationSelected?(this.focus2SEPointOneDimensionalParent=this.hitSESegments[0],this.focus2Vector.copy(this.focus2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus2Vector=this.focus2Vector,this.temporaryFocus2Marker.positionVector=this.focus2Vector,this.focus2SEPoint=null,this.focus2LocationSelected=!0,this.mouseMoved(i)):(this.focus1SEPointOneDimensionalParent=this.hitSESegments[0],this.focus1Vector.copy(this.focus1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus1Vector=this.focus1Vector,this.temporaryFocus1Marker.positionVector=this.focus1Vector,this.focus1SEPoint=null,this.focus1LocationSelected=!0):this.hitSELines.length>0?this.focus1LocationSelected?(this.focus2SEPointOneDimensionalParent=this.hitSELines[0],this.focus2Vector.copy(this.focus2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus2Vector=this.focus2Vector,this.temporaryFocus2Marker.positionVector=this.focus2Vector,this.focus2SEPoint=null,this.focus2LocationSelected=!0,this.mouseMoved(i)):(this.focus1SEPointOneDimensionalParent=this.hitSELines[0],this.focus1Vector.copy(this.focus1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus1Vector=this.focus1Vector,this.temporaryFocus1Marker.positionVector=this.focus1Vector,this.focus1SEPoint=null,this.focus1LocationSelected=!0):this.hitSECircles.length>0?this.focus1LocationSelected?(this.focus2SEPointOneDimensionalParent=this.hitSECircles[0],this.focus2Vector.copy(this.focus2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus2Vector=this.focus2Vector,this.temporaryFocus2Marker.positionVector=this.focus2Vector,this.focus2SEPoint=null,this.focus2LocationSelected=!0,this.mouseMoved(i)):(this.focus1SEPointOneDimensionalParent=this.hitSECircles[0],this.focus1Vector.copy(this.focus1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus1Vector=this.focus1Vector,this.temporaryFocus1Marker.positionVector=this.focus1Vector,this.focus1SEPoint=null,this.focus1LocationSelected=!0):this.hitSEEllipses.length>0?this.focus1LocationSelected?(this.focus2SEPointOneDimensionalParent=this.hitSEEllipses[0],this.focus2Vector.copy(this.focus2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus2Vector=this.focus2Vector,this.temporaryFocus2Marker.positionVector=this.focus2Vector,this.focus2SEPoint=null,this.focus2LocationSelected=!0,this.mouseMoved(i)):(this.focus1SEPointOneDimensionalParent=this.hitSEEllipses[0],this.focus1Vector.copy(this.focus1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus1Vector=this.focus1Vector,this.temporaryFocus1Marker.positionVector=this.focus1Vector,this.focus1SEPoint=null,this.focus1LocationSelected=!0):this.hitSEParametrics.length>0?this.focus1LocationSelected?(this.focus2SEPointOneDimensionalParent=this.hitSEParametrics[0],this.focus2Vector.copy(this.focus2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus2Vector=this.focus2Vector,this.temporaryFocus2Marker.positionVector=this.focus2Vector,this.focus2SEPoint=null,this.focus2LocationSelected=!0,this.mouseMoved(i)):(this.focus1SEPointOneDimensionalParent=this.hitSEParametrics[0],this.focus1Vector.copy(this.focus1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus1Vector=this.focus1Vector,this.temporaryFocus1Marker.positionVector=this.focus1Vector,this.focus1SEPoint=null,this.focus1LocationSelected=!0):this.hitSEPolygons.length>0?this.focus1LocationSelected?(this.focus2SEPointOneDimensionalParent=this.hitSEPolygons[0],this.focus2Vector.copy(this.focus2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus2Vector=this.focus2Vector,this.temporaryFocus2Marker.positionVector=this.focus2Vector,this.focus2SEPoint=null,this.focus2LocationSelected=!0,this.mouseMoved(i)):(this.focus1SEPointOneDimensionalParent=this.hitSEPolygons[0],this.focus1Vector.copy(this.focus1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryEllipse.focus1Vector=this.focus1Vector,this.temporaryFocus1Marker.positionVector=this.focus1Vector,this.focus1SEPoint=null,this.focus1LocationSelected=!0):this.focus1LocationSelected?(this.temporaryEllipse.focus2Vector=this.currentSphereVector,this.temporaryFocus2Marker.positionVector=this.currentSphereVector,this.focus2Vector.copy(this.currentSphereVector),this.focus2SEPoint=null,this.focus2LocationSelected=!0,this.mouseMoved(i)):(this.temporaryEllipse.focus1Vector=this.currentSphereVector,this.temporaryFocus1Marker.positionVector=this.currentSphereVector,this.focus1Vector.copy(this.currentSphereVector),this.focus1SEPoint=null,this.focus1LocationSelected=!0);this.focus1LocationSelected&&!this.focus2LocationSelected?(this.temporaryFocus2Marker.positionVector=this.currentSphereVector,$.fire("show-alert",{key:"handlers.ellipseFocus1Selected",keyOptions:{},type:"info"})):(this.temporaryEllipsePointMarker.positionVector=this.currentSphereVector,$.fire("show-alert",{key:"handlers.ellipseFocus2Selected",keyOptions:{},type:"info"}))}}mouseMoved(i){super.mouseMoved(i);let n=null;this.hitSEPoints.length>0?n=this.hitSEPoints[0]:this.hitSESegments.length>0?n=this.hitSESegments[0]:this.hitSELines.length>0?n=this.hitSELines[0]:this.hitSECircles.length>0?n=this.hitSECircles[0]:this.hitSEEllipses.length>0?n=this.hitSEEllipses[0]:this.hitSEParametrics.length>0?n=this.hitSEParametrics[0]:this.hitSEPolygons.length>0?n=this.hitSEPolygons[0]:(this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null),n!==null&&(n instanceof Ze?this.focus1LocationSelected?!this.focus2LocationSelected&&!this.tmpVector.crossVectors(n.locationVector,this.focus1Vector).isZero(S.nearlyAntipodalIdeal)?(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=n):n.locationVector.angleTo(this.focus1Vector)+n.locationVector.angleTo(this.focus2Vector)-this.focus1Vector.angleTo(this.focus2Vector)>S.ellipse.minimumAngleSumDifference&&n.locationVector.angleTo(this.focus1Vector)+n.locationVector.angleTo(this.focus2Vector)<2*Math.PI-this.focus1Vector.angleTo(this.focus2Vector)-S.ellipse.minimumAngleSumDifference&&(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=n):(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=n):(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=n,this.snapTemporaryPointMarkerToPoint=null)),this.isOnSphere?this.focus1LocationSelected?this.focus2LocationSelected?(this.temporaryEllipsePointMarkerAdded||(this.temporaryEllipsePointMarkerAdded=!0,this.temporaryEllipsePointMarker.addToLayers(this.layers)),this.snapTemporaryPointMarkerToPoint!==null&&(this.temporaryEllipsePointMarker.positionVector=this.snapTemporaryPointMarkerToPoint.locationVector,(!(this.snapTemporaryPointMarkerToPoint instanceof Le)||this.snapTemporaryPointMarkerToPoint.isUserCreated)&&(this.temporaryEllipsePointMarker.removeFromLayers(),this.temporaryEllipsePointMarkerAdded=!1)),this.snapTemporaryPointMarkerToOneDimensional!==null?this.temporaryEllipsePointMarker.positionVector=this.snapTemporaryPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryPointMarkerToPoint==null&&(this.temporaryEllipsePointMarker.positionVector=this.currentSphereVector),this.temporaryEllipseAdded||(this.temporaryEllipseAdded=!0,this.temporaryEllipse.addToLayers(this.layers)),this.a=.5*(this.temporaryEllipse.focus1Vector.angleTo(this.temporaryEllipsePointMarker.positionVector)+this.temporaryEllipse.focus2Vector.angleTo(this.temporaryEllipsePointMarker.positionVector)),this.b=Math.acos(Math.cos(this.a)/Math.cos(this.temporaryEllipse.focus1Vector.angleTo(this.temporaryEllipse.focus2Vector)/2)),2*this.a-this.focus1Vector.angleTo(this.focus2Vector)<S.ellipse.minimumAngleSumDifference||2*this.a>2*Math.PI-this.focus1Vector.angleTo(this.focus2Vector)-S.ellipse.minimumAngleSumDifference?(this.temporaryEllipse.removeFromLayers(),this.temporaryEllipseAdded=!1):(this.temporaryEllipse.a=this.a,this.temporaryEllipse.b=this.b,this.temporaryEllipse.updateDisplay())):(this.temporaryFocus2MarkerAdded||(this.temporaryFocus2MarkerAdded=!0,this.temporaryFocus2Marker.addToLayers(this.layers)),this.snapTemporaryPointMarkerToPoint!==null&&(this.snapTemporaryPointMarkerToPoint instanceof Le&&!this.snapTemporaryPointMarkerToPoint.isUserCreated?this.temporaryFocus2Marker.positionVector=this.snapTemporaryPointMarkerToPoint.locationVector:(this.temporaryFocus2Marker.removeFromLayers(),this.temporaryFocus2MarkerAdded=!1)),this.snapTemporaryPointMarkerToOneDimensional!==null?this.temporaryFocus2Marker.positionVector=this.snapTemporaryPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryPointMarkerToPoint==null&&(this.temporaryFocus2Marker.positionVector=this.currentSphereVector)):(this.temporaryFocus1MarkerAdded||(this.temporaryFocus1MarkerAdded=!0,this.temporaryFocus1Marker.addToLayers(this.layers)),this.snapTemporaryPointMarkerToPoint!==null&&(this.snapTemporaryPointMarkerToPoint instanceof Le&&!this.snapTemporaryPointMarkerToPoint.isUserCreated?this.temporaryFocus1Marker.positionVector=this.snapTemporaryPointMarkerToPoint.locationVector:(this.temporaryFocus1Marker.removeFromLayers(),this.temporaryFocus1MarkerAdded=!1)),this.snapTemporaryPointMarkerToOneDimensional!==null?this.temporaryFocus1Marker.positionVector=this.snapTemporaryPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryPointMarkerToPoint==null&&(this.temporaryFocus1Marker.positionVector=this.currentSphereVector)):(this.focus1LocationSelected?this.focus2LocationSelected?(this.temporaryEllipsePointMarker.removeFromLayers(),this.temporaryEllipsePointMarkerAdded=!1,this.temporaryEllipse.removeFromLayers(),this.temporaryEllipseAdded=!1):(this.temporaryFocus2Marker.removeFromLayers(),this.temporaryFocus2MarkerAdded=!1):(this.temporaryFocus1Marker.removeFromLayers(),this.temporaryFocus1MarkerAdded=!1),this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null)}mouseReleased(i){if(this.isOnSphere&&this.focus2LocationSelected)if(this.currentSphereVector.angleTo(this.focus1Vector)>S.ellipse.minimumCreationDistance&&this.currentSphereVector.angleTo(this.focus2Vector)>S.ellipse.minimumCreationDistance){const n=this.temporaryEllipse.focus1Vector.angleTo(this.temporaryEllipsePointMarker.positionVector)+this.temporaryEllipse.focus2Vector.angleTo(this.temporaryEllipsePointMarker.positionVector);n-this.focus1Vector.angleTo(this.focus2Vector)>S.ellipse.minimumAngleSumDifference&&n<2*Math.PI-this.focus1Vector.angleTo(this.focus2Vector)-S.ellipse.minimumAngleSumDifference&&(this.makeEllipse()||$.fire("show-alert",{key:"handlers.ellipseCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.mouseLeave(i))}else $.fire("show-alert",{key:"handlers.ellipseInitiallyToSmall",keyOptions:{},type:"info"})}mouseLeave(i){super.mouseLeave(i),this.prepareForNextEllipse()}prepareForNextEllipse(){this.temporaryEllipse.removeFromLayers(),this.temporaryFocus1Marker.removeFromLayers(),this.temporaryFocus2Marker.removeFromLayers(),this.temporaryEllipsePointMarker.removeFromLayers(),this.temporaryFocus1MarkerAdded=!1,this.temporaryFocus2MarkerAdded=!1,this.temporaryEllipsePointMarkerAdded=!1,this.temporaryEllipseAdded=!1,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null,this.focus1SEPoint&&(this.focus1SEPoint.glowing=!1,this.focus1SEPoint.selected=!1),this.focus2SEPoint&&(this.focus2SEPoint.glowing=!1,this.focus2SEPoint.selected=!1),this.focus1SEPoint=null,this.focus2SEPoint=null,this.focus1LocationSelected=!1,this.focus2LocationSelected=!1,this.focus1SEPointOneDimensionalParent=null,this.focus2SEPointOneDimensionalParent=null,this.ellipseSEPoint=null,Xr.store.unglowAllSENodules()}makeEllipse(i=!1){const n=new Dt,r=[];if(this.focus1SEPoint===null){let s=null,o=null;this.focus1SEPointOneDimensionalParent?(o=new kt(this.focus1SEPointOneDimensionalParent),s=new De("point",o),n.addCommand(new zt(o,this.focus1SEPointOneDimensionalParent,s))):(o=new Ze,s=new De("point",o),n.addCommand(new Mn(o,s))),o.locationVector=this.focus1Vector;const a=Xr.addCreateAntipodeCommand(o,n);r.push(a,o),this.tmpVector.copy(o.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),s.locationVector=this.tmpVector,this.focus1SEPoint=o}else(this.focus1SEPoint instanceof Le&&!this.focus1SEPoint.isUserCreated||this.focus1SEPoint instanceof ut&&!this.focus1SEPoint.isUserCreated)&&n.addCommand(new sn(this.focus1SEPoint,!0));if(this.focus2SEPoint===null){let s=null,o=null;this.focus2SEPointOneDimensionalParent?(o=new kt(this.focus2SEPointOneDimensionalParent),s=new De("point",o),n.addCommand(new zt(o,this.focus2SEPointOneDimensionalParent,s))):(o=new Ze,s=new De("point",o),n.addCommand(new Mn(o,s))),o.locationVector=this.focus2Vector;const a=Xr.addCreateAntipodeCommand(o,n);r.push(a,o),this.tmpVector.copy(o.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),s.locationVector=this.tmpVector,this.focus2SEPoint=o}else(this.focus2SEPoint instanceof Le&&!this.focus2SEPoint.isUserCreated||this.focus2SEPoint instanceof ut&&!this.focus2SEPoint.isUserCreated)&&n.addCommand(new sn(this.focus2SEPoint,!0));if(this.hitSEPoints.length>0&&!i)this.ellipseSEPoint=this.hitSEPoints[0],(this.ellipseSEPoint instanceof Le&&!this.ellipseSEPoint.isUserCreated||this.ellipseSEPoint instanceof ut&&!this.ellipseSEPoint.isUserCreated)&&n.addCommand(new sn(this.ellipseSEPoint,!0));else if(!i){let s=null,o=null;this.hitSESegments.length>0?(s=new kt(this.hitSESegments[0]),s.locationVector=this.temporaryEllipsePointMarker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSESegments[0],o))):this.hitSELines.length>0?(s=new kt(this.hitSELines[0]),s.locationVector=this.temporaryEllipsePointMarker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSELines[0],o))):this.hitSECircles.length>0?(s=new kt(this.hitSECircles[0]),s.locationVector=this.temporaryEllipsePointMarker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSECircles[0],o))):this.hitSEEllipses.length>0?(s=new kt(this.hitSEEllipses[0]),s.locationVector=this.temporaryEllipsePointMarker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSEEllipses[0],o))):this.hitSEParametrics.length>0?(s=new kt(this.hitSEParametrics[0]),s.locationVector=this.temporaryEllipsePointMarker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSEParametrics[0],o))):this.hitSEPolygons.length>0?(s=new kt(this.hitSEPolygons[0]),s.locationVector=this.temporaryEllipsePointMarker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSEPolygons[0],o))):(s=new Ze,s.locationVector=this.temporaryEllipsePointMarker.positionVector,o=new De("point",s),n.addCommand(new Mn(s,o)));const a=Xr.addCreateAntipodeCommand(s,n);r.push(a,s),this.ellipseSEPoint=s,this.tmpVector.copy(s.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),o.locationVector=this.tmpVector}if(this.ellipseSEPoint){const s=this.focus1SEPoint.locationVector.angleTo(this.ellipseSEPoint.locationVector)+this.focus2SEPoint.locationVector.angleTo(this.ellipseSEPoint.locationVector);if(Xr.store.seEllipses.some(l=>(this.tmpVector.subVectors(l.focus1SEPoint.locationVector,this.focus1SEPoint?this.focus1SEPoint.locationVector:this.tmpVector).isZero()&&this.tmpVector.subVectors(l.focus2SEPoint.locationVector,this.focus2SEPoint?this.focus2SEPoint.locationVector:this.tmpVector).isZero()||this.tmpVector.subVectors(l.focus1SEPoint.locationVector,this.focus2SEPoint?this.focus2SEPoint.locationVector:this.tmpVector).isZero()&&this.tmpVector.subVectors(l.focus2SEPoint.locationVector,this.focus1SEPoint?this.focus1SEPoint.locationVector:this.tmpVector).isZero())&&Math.abs(l.ellipseAngleSum-s)<S.tolerance))return!1;const o=new Ii(this.focus1SEPoint,this.focus2SEPoint,this.ellipseSEPoint,!1),a=new De("ellipse",o);this.tmpMatrix.makeRotationAxis(this.tmpVector1.addVectors(this.focus1SEPoint.locationVector,this.focus2SEPoint.locationVector).normalize(),Math.PI/2),this.tmpVector.copy(this.ellipseSEPoint.locationVector).applyMatrix4(this.tmpMatrix).add(new k(0,S.ellipse.initialLabelOffset,0)).normalize(),a.locationVector=this.tmpVector,o.shallowUpdate(),n.addCommand(new GP(o,this.focus1SEPoint,this.focus2SEPoint,this.ellipseSEPoint,a)),Xr.store.createAllIntersectionsWithEllipse(o,r).forEach(l=>{if(l.existingIntersectionPoint)n.addCommand(new nr(l.SEIntersectionPoint,l.parent1));else{const c=l.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new ir(l.SEIntersectionPoint,l.parent1,l.parent2,c)),l.SEIntersectionPoint.showing=!1,c.showing=!1,l.createAntipodalPoint&&Xr.addCreateAntipodeCommand(l.SEIntersectionPoint,n)}}),n.execute()}return!0}activate(){if(Xr.store.selectedSENodules.length===3){const i=Xr.store.selectedSENodules[0],n=Xr.store.selectedSENodules[1],r=Xr.store.selectedSENodules[2];i instanceof Ze&&n instanceof Ze&&r instanceof Ze&&!gSe.crossVectors(i.locationVector,n.locationVector).isZero(S.nearlyAntipodalIdeal)&&(this.focus1SEPoint=i,this.focus2SEPoint=n,this.ellipseSEPoint=r,this.makeEllipse(!0)||$.fire("show-alert",{key:"handlers.ellipseCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.prepareForNextEllipse())}super.activate()}deactivate(){super.deactivate()}}class Dl extends _i{constructor(i,n){super(i);y(this,"seEdgeSegments",[]);y(this,"startSEPoint",null);y(this,"endSEPoint",null);y(this,"chainClosed",!1);y(this,"segmentIsFlipped",[]);y(this,"triangleSelectionMode");y(this,"tmpVector",new k);y(this,"tmpVector2",new k);y(this,"tmpVector3",new k);y(this,"temporaryAngleMarkers",[]);y(this,"temporaryAngleMarkersAdded",[]);this.triangleSelectionMode=n??!1;for(let r=0;r<S.polygon.numberOfTemporaryAngleMarkers;r++){const s=new ih;Dl.store.addTemporaryNodule(s),this.temporaryAngleMarkers.push(s),this.temporaryAngleMarkersAdded.push(!1)}}mousePressed(i){var n,r,s,o,a,l,c,u;if(this.isOnSphere){if(this.hitSESegments.length>0)if(this.seEdgeSegments.length==0)this.seEdgeSegments.push(this.hitSESegments[0]),this.hitSESegments[0].selected=!0;else if(this.seEdgeSegments.length===1)if(this.seEdgeSegments[0].startSEPoint.name===this.hitSESegments[0].startSEPoint.name||this.seEdgeSegments[0].startSEPoint.name===this.hitSESegments[0].endSEPoint.name)if(this.acceptableAddition(this.seEdgeSegments,this.hitSESegments[0],this.seEdgeSegments[0].startSEPoint.name===this.hitSESegments[0].endSEPoint.name,this.seEdgeSegments[0].endSEPoint.name===this.hitSESegments[0].startSEPoint.name)){const h=this.seEdgeSegments[0].startSEPoint.name===this.hitSESegments[0].endSEPoint.name;this.seEdgeSegments.push(this.hitSESegments[0]),this.segmentIsFlipped.push(!0),this.segmentIsFlipped.push(h),this.startSEPoint=this.seEdgeSegments[0].endSEPoint,h?this.endSEPoint=this.seEdgeSegments[1].startSEPoint:this.endSEPoint=this.seEdgeSegments[1].endSEPoint,this.hitSESegments[0].selected=!0,this.chainClosed=h?this.hitSESegments[0].startSEPoint.name===((n=this.startSEPoint)==null?void 0:n.name):this.hitSESegments[0].endSEPoint.name===((r=this.startSEPoint)==null?void 0:r.name)}else{$.fire("show-alert",{key:"handlers.newSegmentIntersectsOrToClose",keyOptions:{},type:"warning"});return}else if(this.seEdgeSegments[0].endSEPoint.name===this.hitSESegments[0].startSEPoint.name||this.seEdgeSegments[0].endSEPoint.name===this.hitSESegments[0].endSEPoint.name)if(this.acceptableAddition(this.seEdgeSegments,this.hitSESegments[0],this.seEdgeSegments[0].endSEPoint.name===this.hitSESegments[0].endSEPoint.name,this.seEdgeSegments[0].startSEPoint.name===this.hitSESegments[0].startSEPoint.name)){const h=this.seEdgeSegments[0].endSEPoint.name===this.hitSESegments[0].endSEPoint.name;this.seEdgeSegments.push(this.hitSESegments[0]),this.segmentIsFlipped.push(!1),this.segmentIsFlipped.push(h),this.startSEPoint=this.seEdgeSegments[0].startSEPoint,h?this.endSEPoint=this.seEdgeSegments[1].startSEPoint:this.endSEPoint=this.seEdgeSegments[1].endSEPoint,this.hitSESegments[0].selected=!0,this.chainClosed=h?this.hitSESegments[0].startSEPoint.name===((s=this.startSEPoint)==null?void 0:s.name):this.hitSESegments[0].endSEPoint.name===((o=this.startSEPoint)==null?void 0:o.name)}else{$.fire("show-alert",{key:"handlers.newSegmentIntersectsOrToClose",keyOptions:{},type:"warning"});return}else{$.fire("show-alert",{key:"handlers.newSegmentMustHaveEndpointInCommon",keyOptions:{},type:"warning"});return}else if(this.seEdgeSegments.length===2&&this.triangleSelectionMode){const h=this.chainEndPointOnSegment(this.endSEPoint,this.hitSESegments[0]);if(h[0]){if(h[1]&&this.hitSESegments[0].startSEPoint.name!==((a=this.startSEPoint)==null?void 0:a.name)||!h[1]&&this.hitSESegments[0].endSEPoint.name!==((l=this.startSEPoint)==null?void 0:l.name)){$.fire("show-alert",{key:"handlers.newSegmentMustCloseTriangle",keyOptions:{},type:"warning"});return}if(this.acceptableAddition(this.seEdgeSegments,this.hitSESegments[0],h[1],!0))this.seEdgeSegments.push(this.hitSESegments[0]),this.segmentIsFlipped.push(h[1]),this.chainClosed=!0;else{$.fire("show-alert",{key:"handlers.newSegmentIntersectsOrToClose",keyOptions:{},type:"warning"});return}}else{$.fire("show-alert",{key:"handlers.newSegmentMustHaveEndpointInCommon",keyOptions:{},type:"warning"});return}}else{const h=this.chainEndPointOnSegment(this.endSEPoint,this.hitSESegments[0]);if(h[0]){const d=h[1]?this.hitSESegments[0].startSEPoint.name===((c=this.startSEPoint)==null?void 0:c.name):this.hitSESegments[0].endSEPoint.name===((u=this.startSEPoint)==null?void 0:u.name);if(this.acceptableAddition(this.seEdgeSegments,this.hitSESegments[0],h[1],d))this.seEdgeSegments.push(this.hitSESegments[0]),this.hitSESegments[0].selected=!0,this.segmentIsFlipped.push(h[1]),this.chainClosed=d,this.endSEPoint=h[1]?this.hitSESegments[0].startSEPoint:this.hitSESegments[0].endSEPoint;else{$.fire("show-alert",{key:"handlers.newSegmentIntersectsOrToClose",keyOptions:{},type:"warning"});return}}else{$.fire("show-alert",{key:"handlers.newSegmentMustHaveEndpointInCommon",keyOptions:{},type:"warning"});return}}if(this.chainClosed){let h=!1,d="";if(Dl.store.sePolygons.forEach(p=>{var _;if(p.seEdgeSegments.length!==this.seEdgeSegments.length)return;const b=p.seEdgeSegments.findIndex(P=>P.name===this.seEdgeSegments[0].name);b!==-1&&h===!1&&(h=this.seEdgeSegments.every((P,E)=>{const T=((E+b)%this.seEdgeSegments.length+this.seEdgeSegments.length)%this.seEdgeSegments.length;return p.seEdgeSegments[T].name===this.seEdgeSegments[E].name}),h&&(d=((_=p.label)==null?void 0:_.ref.shortUserName)??""))}),h){$.fire("show-alert",{key:"handlers.previouslyMeasuredPolygon",keyOptions:{token:d},type:"error"}),this.mouseLeave(i);return}const f=new Dt,m=this.addAngleMarkers(f);this.addMeasuredSegments(f);const g=new Ks(this.seEdgeSegments,this.segmentIsFlipped,m),v=new De("polygon",g);g.valueDisplayMode=S.polygon.initialValueDisplayMode,this.tmpVector.set(0,0,0),this.seEdgeSegments.forEach((p,b)=>{b!==this.seEdgeSegments.length&&(this.segmentIsFlipped[b]?this.tmpVector.add(p.endSEPoint.locationVector):this.tmpVector.add(p.startSEPoint.locationVector))}),this.tmpVector.normalize(),v.locationVector=this.tmpVector,f.addCommand(new HP(g,this.seEdgeSegments,this.segmentIsFlipped,m,v)),f.addCommand(new qi(v,!0)),f.addCommand(new vc([v.ref],q.Label,[{labelDisplayMode:S.polygon.measuringChangesLabelModeTo}],[{labelDisplayMode:S.polygon.defaultLabelMode}])),f.execute(),g.markKidsOutOfDate(),g.update(),this.seEdgeSegments.forEach(p=>{p.markKidsOutOfDate(),p.update()}),$.fire("show-alert",{key:"handlers.newPolygonAdded",keyOptions:{},type:"success"}),this.mouseLeave(i)}}}mouseMoved(i){if(super.mouseMoved(i),this.isOnSphere){if(this.hitSESegments.length>0){let n=[];this.seEdgeSegments.length==0?this.hitSESegments[0].glowing=!0:this.seEdgeSegments.length==1?(n=this.hitSESegments.filter(r=>this.seEdgeSegments[0].startSEPoint.name===r.startSEPoint.name||this.seEdgeSegments[0].startSEPoint.name===r.endSEPoint.name?this.acceptableAddition(this.seEdgeSegments,r,this.seEdgeSegments[0].startSEPoint.name===r.endSEPoint.name,this.seEdgeSegments[0].endSEPoint.name===r.startSEPoint.name):this.seEdgeSegments[0].endSEPoint.name===r.startSEPoint.name||this.seEdgeSegments[0].endSEPoint.name===r.endSEPoint.name?this.acceptableAddition(this.seEdgeSegments,r,this.seEdgeSegments[0].endSEPoint.name===r.endSEPoint.name,this.seEdgeSegments[0].startSEPoint.name===r.startSEPoint.name):!1),n.length>0&&(n[0].glowing=!0)):this.seEdgeSegments.length===2&&this.triangleSelectionMode?(n=this.hitSESegments.filter(r=>this.chainEndPointOnSegment(this.endSEPoint,r)[0]).filter(r=>{var o,a;const s=this.chainEndPointOnSegment(this.endSEPoint,r)[1];return s&&r.startSEPoint.name!==((o=this.startSEPoint)==null?void 0:o.name)||!s&&r.endSEPoint.name!==((a=this.startSEPoint)==null?void 0:a.name)?!1:this.acceptableAddition(this.seEdgeSegments,r,s,!0)}),n.length>0&&(n[0].glowing=!0)):(n=this.hitSESegments.filter(r=>this.chainEndPointOnSegment(this.endSEPoint,r)[0]).filter(r=>{var o,a;const s=this.chainEndPointOnSegment(this.endSEPoint,r);return this.acceptableAddition(this.seEdgeSegments,r,s[1],s[1]?r.startSEPoint.name===((o=this.startSEPoint)==null?void 0:o.name):r.endSEPoint.name===((a=this.startSEPoint)==null?void 0:a.name))}),n.length>0&&(n[0].glowing=!0))}this.seEdgeSegments.length>1&&this.seEdgeSegments.length<S.polygon.numberOfTemporaryAngleMarkers&&(this.seEdgeSegments.forEach((n,r)=>{if(!this.temporaryAngleMarkersAdded[r]&&r!==0){const s=this.seEdgeSegments[r-1];this.tmpVector.copy(this.segmentIsFlipped[r-1]?s.endSEPoint.locationVector:s.startSEPoint.locationVector),this.tmpVector2.copy(this.segmentIsFlipped[r]?n.startSEPoint.locationVector:n.endSEPoint.locationVector),this.temporaryAngleMarkers[r].setAngleMarkerFromThreeVectors(this.tmpVector.multiplyScalar(s.longerThanPi?-1:1),this.segmentIsFlipped[r]?n.endSEPoint.locationVector:n.startSEPoint.locationVector,this.tmpVector2.multiplyScalar(n.longerThanPi?-1:1),ih.currentAngleMarkerRadius),this.temporaryAngleMarkersAdded[r]=!0,this.temporaryAngleMarkers[r].addToLayers(this.layers),this.temporaryAngleMarkers[r].updateDisplay()}}),this.temporaryAngleMarkersAdded[0]||(this.temporaryAngleMarkersAdded[0]=!0,this.temporaryAngleMarkers[0].addToLayers(this.layers)),this.tmpVector3.copy(this.segmentIsFlipped[0]?this.seEdgeSegments[0].startSEPoint.locationVector:this.seEdgeSegments[0].endSEPoint.locationVector),this.temporaryAngleMarkers[0].setAngleMarkerFromThreeVectors(this.currentSphereVector,this.segmentIsFlipped[0]?this.seEdgeSegments[0].endSEPoint.locationVector:this.seEdgeSegments[0].startSEPoint.locationVector,this.tmpVector3.multiplyScalar(this.seEdgeSegments[0].longerThanPi?-1:1),ih.currentAngleMarkerRadius),this.temporaryAngleMarkers[0].updateDisplay())}}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.deactivate()}activate(){super.activate()}deactivate(){super.deactivate(),Dl.store.unglowAllSENodules(),this.infoText.hide(),this.seEdgeSegments.forEach(i=>i.selected=!1),this.seEdgeSegments.splice(0),this.segmentIsFlipped.splice(0),this.chainClosed=!1,this.startSEPoint=null,this.endSEPoint=null,this.temporaryAngleMarkers.forEach((i,n)=>{i.removeFromLayers(),this.temporaryAngleMarkersAdded[n]=!1})}chainEndPointOnSegment(i,n){if(i){if(i.name===n.startSEPoint.name)return[!0,!1];if(i.name===n.endSEPoint.name)return[!0,!0]}else return[!0];return[!1]}acceptableAddition(i,n,r,s){let o;if(r?o=n.startSEPoint.locationVector:o=n.endSEPoint.locationVector,!s){for(let l=0;l<i.length;l++)if(i[l].closestVector(o).angleTo(o)<S.polygon.minimumVertexToEdgeThickness)return!1}let a=0;s&&(a=1);for(let l=a;l<i.length-1;l++)if(Dl.store.findIntersectionPointsByParent(n.name,i[l].name).some(c=>c.exists))return!1;return!0}addAngleMarkers(i){const n=[],r=this.seEdgeSegments.length;return this.seEdgeSegments.forEach((s,o)=>{var h,d;const a=this.seEdgeSegments[((o-1)%r+r)%r],l=Dl.store.expressions.find(f=>{if(f instanceof en){if(f.angleMode===Di.SEGMENTS)return f.parents[0].name===(a==null?void 0:a.name)&&f.parents[1].name===(s==null?void 0:s.name);if(f.angleMode===Di.POINTS){const m=this.segmentIsFlipped[((o-1)%r+r)%r],g=this.segmentIsFlipped[(o%r+r)%r],v=m?a.endSEPoint.name:a.startSEPoint.name,p=g?s.startSEPoint.name:s.endSEPoint.name;return console.log(v,p,f.parents[0].name,f.parents[1].name,f.parents[2].name),f.parents[0].name===v&&f.parents[2].name===p}}else return!1});if(l!==void 0){$.fire("show-alert",{key:"handlers.duplicateSegmentAngleMeasurement",keyOptions:{seg0Name:`${(h=a==null?void 0:a.label)==null?void 0:h.ref.shortUserName}`,seg1Name:`${(d=s==null?void 0:s.label)==null?void 0:d.ref.shortUserName}`,measurementName:`${l.name}`},type:"warning"}),n.push(l);return}const c=new en(Dl.store.zoomMagnificationFactor,Di.SEGMENTS,a,s),u=new De("angleMarker",c);c.valueDisplayMode=S.angleMarker.initialValueDisplayMode,c.markKidsOutOfDate(),c.update(),a.startSEPoint===s.startSEPoint?(this.tmpVector.copy(a.startSEPoint.locationVector),a.startSEPoint.label.showing=!1):a.startSEPoint===s.endSEPoint?(this.tmpVector.copy(a.startSEPoint.locationVector),a.startSEPoint.label.showing=!1):a.endSEPoint===s.startSEPoint?(this.tmpVector.copy(s.startSEPoint.locationVector),s.startSEPoint.label.showing=!1):a.endSEPoint===s.endSEPoint?(this.tmpVector.copy(s.endSEPoint.locationVector),s.endSEPoint.label.showing=!1):(this.tmpVector.set(0,0,1),console.log("In AngleHandler A pair of select segments doesn't have a common endpoint -- error!")),this.tmpVector.add(new k(-2*S.angleMarker.initialLabelOffset,-1*S.angleMarker.initialLabelOffset,0)).normalize(),u.locationVector=this.tmpVector,i.addCommand(new Yc(Di.SEGMENTS,c,u,a,s)),n.push(c),c.markKidsOutOfDate(),c.update()}),n}addMeasuredSegments(i){this.seEdgeSegments.forEach(n=>{var o;const r=Dl.store.expressions.find(a=>a instanceof ws&&a.seSegment.name===n.name);if(r!==void 0){$.fire("show-alert",{key:"handlers.duplicateSegmentMeasurement",keyOptions:{segName:`${(o=n.label)==null?void 0:o.ref.shortUserName}`,measurementName:`${r.name}`},type:"warning"});return}const s=new ws(n);s.valueDisplayMode=S.segment.initialValueDisplayMode,i.addCommand(new Fu(s,n)),n.label!==void 0&&(i.addCommand(new vc([n.label.ref],q.Label,[{labelDisplayMode:S.segment.measuringChangesLabelModeTo}],[{labelDisplayMode:n.label.ref.labelDisplayMode}])),i.addCommand(new qi(n.label,!0)))})}}class au extends _i{constructor(i,n){super(i);y(this,"selectedNValue",2);y(this,"bisectionOnly",!1);y(this,"temporaryPoints",[]);y(this,"temporaryPointsAdded",[]);y(this,"temporarilySelectedSegment",null);y(this,"tmpVector",new k);y(this,"keyPressHandler",i=>{if(!this.bisectionOnly&&i.key.match(/[0-9]/)){const n=Number(i.key);if(n===1){$.fire("show-alert",{key:"handlers.nEqualOneSegmentNSect",keyOptions:{},type:"error"});return}n===0?this.selectedNValue=10:this.selectedNValue=Number(i.key),this.updateTemporaryPoints(),$.fire("show-alert",{key:"handlers.nSetSegmentNSect",keyOptions:{number:this.selectedNValue},type:"success"})}});for(let r=0;r<9;r++)this.temporaryPoints.push(new mi),au.store.addTemporaryNodule(this.temporaryPoints[r]),this.temporaryPointsAdded.push(!1);n===!0&&(this.bisectionOnly=n),this.bisectionOnly||(this.selectedNValue=3)}updateTemporaryPoints(){this.temporaryPoints.forEach((i,n)=>{if(this.temporarilySelectedSegment!==null)if(n>this.selectedNValue-2)this.temporaryPointsAdded[n]&&(i.removeFromLayers(),this.temporaryPointsAdded[n]=!1);else{this.temporaryPointsAdded[n]||(i.addToLayers(this.layers),this.temporaryPointsAdded[n]=!0);const r=new k;r.copy(this.temporarilySelectedSegment.startSEPoint.locationVector);const s=this.temporarilySelectedSegment.arcLength,o=this.temporarilySelectedSegment.normalVector,a=new k;a.crossVectors(o,r).multiplyScalar(s>Math.PI?-1:1).normalize(),r.multiplyScalar(Math.cos(s*(n+1)/this.selectedNValue)),a.multiplyScalar(Math.sin(s*(n+1)/this.selectedNValue)),this.tmpVector.addVectors(r,a).normalize(),i.positionVector=this.tmpVector}})}mousePressed(i){var n,r,s,o;if(this.isOnSphere&&this.hitSESegments.length>0){const a=this.hitSESegments[0];au.store.sePoints.filter(l=>l instanceof nv).map(l=>l).some(l=>l.seSegmentParent.name===a.name&&l.N===this.selectedNValue)?this.selectedNValue===2?$.fire("show-alert",{key:"handlers.bisectedSegmentAlready",keyOptions:{segment:(n=a.label)==null?void 0:n.ref.shortUserName,number:this.selectedNValue},type:"error"}):$.fire("show-alert",{key:"handlers.nSectedSegmentAlready",keyOptions:{segment:(r=a.label)==null?void 0:r.ref.shortUserName,number:this.selectedNValue},type:"error"}):(this.createNSection(a),this.mouseLeave(i),this.selectedNValue===2?$.fire("show-alert",{key:"handlers.segmentSuccessfullyBisected",keyOptions:{segment:(s=a.label)==null?void 0:s.ref.shortUserName},type:"success"}):$.fire("show-alert",{key:"handlers.segmentSuccessfullyNSected",keyOptions:{segment:(o=a.label)==null?void 0:o.ref.shortUserName,number:this.selectedNValue},type:"success"}))}}mouseMoved(i){super.mouseMoved(i),this.hitSESegments.length>0?au.store.sePoints.filter(n=>n instanceof nv).map(n=>n).some(n=>n.seSegmentParent.name===this.hitSESegments[0].name&&n.N===this.selectedNValue)||(this.hitSESegments[0].glowing=!0,this.temporarilySelectedSegment=this.hitSESegments[0],this.updateTemporaryPoints()):this.mouseLeave(i)}mouseReleased(i){}mouseLeave(i){this.temporaryPoints.forEach((n,r)=>{n.removeFromLayers(),this.temporaryPointsAdded[r]=!1}),this.temporarilySelectedSegment=null}activate(){super.activate(),window.addEventListener("keypress",this.keyPressHandler)}deactivate(){super.deactivate(),window.removeEventListener("keypress",this.keyPressHandler)}createNSection(i){const n=new Dt,r=[],s=new k;s.copy(i.startSEPoint.locationVector);const o=i.arcLength,a=i.normalVector,l=new k;l.crossVectors(a,s).multiplyScalar(o>Math.PI?-1:1).normalize();for(let c=1;c<this.selectedNValue;c++){const u=new k;u.copy(s).multiplyScalar(Math.cos(o*c/this.selectedNValue));const h=new k;h.copy(l).multiplyScalar(Math.sin(o*c/this.selectedNValue));const d=new k;if(d.addVectors(u,h).normalize,au.store.sePoints.findIndex(m=>this.tmpVector.subVectors(m.locationVector,d).isZero())===-1){const m=new nv(i,c,this.selectedNValue);m.locationVector=d;const g=m.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new XP(m,i,g)),au.addCreateAntipodeCommand(m,n)}else console.log("An n-secting point already exists",c)}n.execute(),r.forEach(c=>{c.markKidsOutOfDate(),c.update()})}}class Nl extends _i{constructor(i,n){super(i);y(this,"selectedNValue",2);y(this,"bisectionOnly",!1);y(this,"temporaryLines",[]);y(this,"temporaryLinesAdded",[]);y(this,"temporarilySelectedAngle",null);y(this,"tmpVector",new k);y(this,"keyPressHandler",i=>{if(!this.bisectionOnly&&i.key.match(/[0-9]/)){const n=Number(i.key);if(n===1){$.fire("show-alert",{key:"handlers.nEqualOneAngleNSect",keyOptions:{},type:"error"});return}n===0?this.selectedNValue=10:this.selectedNValue=Number(i.key),this.updateTemporaryLines(),$.fire("show-alert",{key:"handlers.nSetAngleNSect",keyOptions:{number:this.selectedNValue},type:"success"})}});for(let r=0;r<9;r++)this.temporaryLines.push(new _s),Nl.store.addTemporaryNodule(this.temporaryLines[r]),this.temporaryLinesAdded.push(!1);n===!0&&(this.bisectionOnly=n),this.bisectionOnly||(this.selectedNValue=3)}updateTemporaryLines(){this.temporaryLines.forEach((i,n)=>{if(this.temporarilySelectedAngle!==null)if(n>this.selectedNValue-2)this.temporaryLinesAdded[n]&&(i.removeFromLayers(),this.temporaryLinesAdded[n]=!1);else{this.temporaryLinesAdded[n]||(i.addToLayers(this.layers),this.temporaryLinesAdded[n]=!0);const r=new k;r.copy(this.temporarilySelectedAngle.startVector),r.addScaledVector(this.temporarilySelectedAngle.vertexVector,-1*this.temporarilySelectedAngle.vertexVector.dot(this.temporarilySelectedAngle.startVector)).normalize();const s=new k;s.crossVectors(this.temporarilySelectedAngle.vertexVector,r).normalize;const o=this.temporarilySelectedAngle.value;r.multiplyScalar(Math.cos(o*(n+1)/this.selectedNValue)),s.multiplyScalar(Math.sin(o*(n+1)/this.selectedNValue));const a=new k;a.addVectors(r,s).normalize(),a.crossVectors(this.temporarilySelectedAngle.vertexVector,a).normalize(),i.normalVector=a}})}mousePressed(i){var n,r,s,o;if(this.isOnSphere&&this.hitSEAngleMarkers.length>0){const a=this.hitSEAngleMarkers[0];Nl.store.seLines.filter(l=>l instanceof iv).map(l=>l).some(l=>l.seAngleParent.name===a.name&&l.N===this.selectedNValue)?this.selectedNValue===2?$.fire("show-alert",{key:"handlers.bisectedAngleAlready",keyOptions:{angle:(n=a.label)==null?void 0:n.ref.shortUserName,number:this.selectedNValue},type:"error"}):$.fire("show-alert",{key:"handlers.nSectedAngleAlready",keyOptions:{angle:(r=a.label)==null?void 0:r.ref.shortUserName,number:this.selectedNValue},type:"error"}):(this.createNSection(a),this.mouseLeave(i),this.selectedNValue===2?$.fire("show-alert",{key:"handlers.angleSuccessfullyBisected",keyOptions:{angle:(s=a.label)==null?void 0:s.ref.shortUserName},type:"success"}):$.fire("show-alert",{key:"handlers.angleSuccessfullyNSected",keyOptions:{angle:(o=a.label)==null?void 0:o.ref.shortUserName,number:this.selectedNValue},type:"success"}))}}mouseMoved(i){super.mouseMoved(i),this.hitSEAngleMarkers.length>0?Nl.store.seLines.filter(n=>n instanceof iv).map(n=>n).some(n=>n.seAngleParent.name===this.hitSEAngleMarkers[0].name&&n.N===this.selectedNValue)||(this.hitSEAngleMarkers[0].glowing=!0,this.temporarilySelectedAngle=this.hitSEAngleMarkers[0],this.updateTemporaryLines()):this.mouseLeave(i)}mouseReleased(i){}mouseLeave(i){this.temporaryLines.forEach((n,r)=>{n.removeFromLayers(),this.temporaryLinesAdded[r]=!1}),this.temporarilySelectedAngle=null}activate(){super.activate(),window.addEventListener("keypress",this.keyPressHandler)}deactivate(){super.deactivate(),window.removeEventListener("keypress",this.keyPressHandler)}createNSection(i){const n=new Dt,r=[],s=Nl.store.sePoints.map(c=>c).find(c=>this.tmpVector.subVectors(c.locationVector,i.vertexVector).isZero()),o=new k;o.copy(i.startVector),o.addScaledVector(i.vertexVector,-1*i.vertexVector.dot(i.startVector)).normalize();const a=new k;a.crossVectors(i.vertexVector,o).normalize;const l=i.value;if(s!==void 0)for(let c=1;c<this.selectedNValue;c++){const u=new k;u.copy(o).multiplyScalar(Math.cos(l*c/this.selectedNValue));const h=new k;h.copy(a).multiplyScalar(Math.sin(l*c/this.selectedNValue));const d=new k;d.addVectors(u,h).normalize();const f=new k;if(f.crossVectors(s.locationVector,d).normalize(),Nl.store.seLines.findIndex(g=>this.tmpVector.subVectors(g.normalVector,f).isZero())===-1){const g=new Ze(!0);g.showing=!1,g.exists=!0,g.locationVector=d;const v=new iv(s,f,g,i,c,this.selectedNValue),p=new De("line",v);this.tmpVector.copy(g.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),p.locationVector=this.tmpVector,n.addCommand(new KP(v,i,p)),r.push(v),Nl.store.createAllIntersectionsWithLine(v,[]).forEach(b=>{if(b.existingIntersectionPoint)n.addCommand(new nr(b.SEIntersectionPoint,b.parent1));else{const _=b.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new ir(b.SEIntersectionPoint,b.parent1,b.parent2,_)),b.SEIntersectionPoint.showing=!1,_.showing=!1,b.createAntipodalPoint&&Nl.addCreateAntipodeCommand(b.SEIntersectionPoint,n)}})}else console.log("An n-secting line already exists",c)}n.execute(),r.forEach(c=>{c.markKidsOutOfDate(),c.update()})}}const vSe=new k,ySe=new k;class Er extends _i{constructor(i){super(i);y(this,"point1Vector");y(this,"point2Vector");y(this,"temporaryThreePointCircleCenter");y(this,"temporaryThreePointCircle");y(this,"point1SEPoint",null);y(this,"point2SEPoint",null);y(this,"point3SEPoint",null);y(this,"point1SEPointOneDimensionalParent",null);y(this,"point2SEPointOneDimensionalParent",null);y(this,"point1LocationSelected",!1);y(this,"point2LocationSelected",!1);y(this,"temporaryPoint1Marker");y(this,"temporaryPoint2Marker");y(this,"temporaryPoint3Marker");y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpMatrix",new Pt);y(this,"temporaryThreePointCircleAndCenterAdded",!1);y(this,"temporaryPoint1MarkerAdded",!1);y(this,"temporaryPoint2MarkerAdded",!1);y(this,"temporaryPoint3MarkerAdded",!1);y(this,"snapTemporaryPointMarkerToOneDimensional",null);y(this,"snapTemporaryPointMarkerToPoint",null);this.point1Vector=new k,this.point2Vector=new k,this.temporaryThreePointCircle=new P5,Er.store.addTemporaryNodule(this.temporaryThreePointCircle),this.temporaryThreePointCircleCenter=new DP,Er.store.addTemporaryNodule(this.temporaryThreePointCircleCenter),this.temporaryPoint1Marker=new mi,Er.store.addTemporaryNodule(this.temporaryPoint1Marker),this.temporaryPoint2Marker=new mi,Er.store.addTemporaryNodule(this.temporaryPoint2Marker),this.temporaryPoint3Marker=new mi,Er.store.addTemporaryNodule(this.temporaryPoint3Marker)}mousePressed(i){if(this.isOnSphere&&!this.point2LocationSelected){if(this.hitSEPoints.length>0){const n=this.hitSEPoints[0];this.point1LocationSelected?this.tmpVector.subVectors(n.locationVector,this.point1Vector).isZero()?$.fire("show-alert",{key:"handlers.threePointCircleRepeatPointSelected",keyOptions:{},type:"info"}):(this.point2Vector.copy(n.locationVector),this.point2SEPoint=n,this.temporaryPoint2Marker.positionVector=n.locationVector,this.temporaryThreePointCircleCenter.vector2=n.locationVector,this.point2SEPoint.glowing=!0,this.point2SEPoint.selected=!0,this.point2LocationSelected=!0,this.mouseMoved(i)):(this.point1Vector.copy(n.locationVector),this.point1SEPoint=n,this.temporaryPoint1Marker.positionVector=n.locationVector,this.temporaryThreePointCircleCenter.vector1=n.locationVector,this.point1SEPoint.glowing=!0,this.point1SEPoint.selected=!0,this.point1LocationSelected=!0)}else this.hitSESegments.length>0?this.point1LocationSelected?(this.point2SEPointOneDimensionalParent=this.hitSESegments[0],this.point2Vector.copy(this.point2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector2=this.point2Vector,this.temporaryPoint2Marker.positionVector=this.point2Vector,this.point2SEPoint=null,this.point2LocationSelected=!0,this.mouseMoved(i)):(this.point1SEPointOneDimensionalParent=this.hitSESegments[0],this.point1Vector.copy(this.point1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector1=this.point1Vector,this.temporaryPoint1Marker.positionVector=this.point1Vector,this.point1SEPoint=null,this.point1LocationSelected=!0):this.hitSELines.length>0?this.point1LocationSelected?(this.point2SEPointOneDimensionalParent=this.hitSELines[0],this.point2Vector.copy(this.point2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector2=this.point2Vector,this.temporaryPoint2Marker.positionVector=this.point2Vector,this.point2SEPoint=null,this.point2LocationSelected=!0,this.mouseMoved(i)):(this.point1SEPointOneDimensionalParent=this.hitSELines[0],this.point1Vector.copy(this.point1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector1=this.point1Vector,this.temporaryPoint1Marker.positionVector=this.point1Vector,this.point1SEPoint=null,this.point1LocationSelected=!0):this.hitSECircles.length>0?this.point1LocationSelected?(this.point2SEPointOneDimensionalParent=this.hitSECircles[0],this.point2Vector.copy(this.point2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector2=this.point2Vector,this.temporaryPoint2Marker.positionVector=this.point2Vector,this.point2SEPoint=null,this.point2LocationSelected=!0,this.mouseMoved(i)):(this.point1SEPointOneDimensionalParent=this.hitSECircles[0],this.point1Vector.copy(this.point1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector1=this.point1Vector,this.temporaryPoint1Marker.positionVector=this.point1Vector,this.point1SEPoint=null,this.point1LocationSelected=!0):this.hitSEEllipses.length>0?this.point1LocationSelected?(this.point2SEPointOneDimensionalParent=this.hitSEEllipses[0],this.point2Vector.copy(this.point2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector2=this.point2Vector,this.temporaryPoint2Marker.positionVector=this.point2Vector,this.point2SEPoint=null,this.point2LocationSelected=!0,this.mouseMoved(i)):(this.point1SEPointOneDimensionalParent=this.hitSEEllipses[0],this.point1Vector.copy(this.point1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector1=this.point1Vector,this.temporaryPoint1Marker.positionVector=this.point1Vector,this.point1SEPoint=null,this.point1LocationSelected=!0):this.hitSEParametrics.length>0?this.point1LocationSelected?(this.point2SEPointOneDimensionalParent=this.hitSEParametrics[0],this.point2Vector.copy(this.point2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector2=this.point2Vector,this.temporaryPoint2Marker.positionVector=this.point2Vector,this.point2SEPoint=null,this.point2LocationSelected=!0,this.mouseMoved(i)):(this.point1SEPointOneDimensionalParent=this.hitSEParametrics[0],this.point1Vector.copy(this.point1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector1=this.point1Vector,this.temporaryPoint1Marker.positionVector=this.point1Vector,this.point1SEPoint=null,this.point1LocationSelected=!0):this.hitSEPolygons.length>0?this.point1LocationSelected?(this.point2SEPointOneDimensionalParent=this.hitSEPolygons[0],this.point2Vector.copy(this.point2SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector2=this.point2Vector,this.temporaryPoint2Marker.positionVector=this.point2Vector,this.point2SEPoint=null,this.point2LocationSelected=!0,this.mouseMoved(i)):(this.point1SEPointOneDimensionalParent=this.hitSEPolygons[0],this.point1Vector.copy(this.point1SEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryThreePointCircleCenter.vector1=this.point1Vector,this.temporaryPoint1Marker.positionVector=this.point1Vector,this.point1SEPoint=null,this.point1LocationSelected=!0):this.point1LocationSelected?(this.temporaryThreePointCircleCenter.vector2=this.currentSphereVector,this.temporaryPoint2Marker.positionVector=this.currentSphereVector,this.point2Vector.copy(this.currentSphereVector),this.point2SEPoint=null,this.point2LocationSelected=!0,this.mouseMoved(i)):(this.temporaryThreePointCircleCenter.vector1=this.currentSphereVector,this.temporaryPoint1Marker.positionVector=this.currentSphereVector,this.point1Vector.copy(this.currentSphereVector),this.point1SEPoint=null,this.point1LocationSelected=!0);this.point1LocationSelected&&!this.point2LocationSelected?(this.temporaryPoint2Marker.positionVector=this.currentSphereVector,$.fire("show-alert",{key:"handlers.threePointCircleFirstPointSelected",keyOptions:{},type:"info"})):(this.temporaryPoint3Marker.positionVector=this.currentSphereVector,$.fire("show-alert",{key:"handlers.threePointCircleSecondPointSelected",keyOptions:{},type:"info"}))}}mouseMoved(i){super.mouseMoved(i);let n=null;this.hitSEPoints.length>0?n=this.hitSEPoints[0]:this.hitSESegments.length>0?n=this.hitSESegments[0]:this.hitSELines.length>0?n=this.hitSELines[0]:this.hitSECircles.length>0?n=this.hitSECircles[0]:this.hitSEEllipses.length>0?n=this.hitSEEllipses[0]:this.hitSEParametrics.length>0?n=this.hitSEParametrics[0]:this.hitSEPolygons.length>0?n=this.hitSEPolygons[0]:(this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null),n!==null&&(n instanceof Ze?this.point1LocationSelected?!this.point2LocationSelected&&!this.tmpVector.subVectors(n.locationVector,this.point1Vector).isZero()?(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=n):!this.tmpVector.subVectors(n.locationVector,this.point1Vector).isZero()&&!this.tmpVector.subVectors(n.locationVector,this.point2Vector).isZero()&&(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=n):(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=n):(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=n,this.snapTemporaryPointMarkerToPoint=null)),this.isOnSphere?this.point1LocationSelected?this.point2LocationSelected?(this.temporaryPoint3MarkerAdded||(this.temporaryPoint3MarkerAdded=!0,this.temporaryPoint3Marker.addToLayers(this.layers)),this.snapTemporaryPointMarkerToPoint!==null&&(this.temporaryPoint3Marker.positionVector=this.snapTemporaryPointMarkerToPoint.locationVector,(!(this.snapTemporaryPointMarkerToPoint instanceof Le)||this.snapTemporaryPointMarkerToPoint.isUserCreated)&&(this.temporaryPoint3Marker.removeFromLayers(),this.temporaryPoint3MarkerAdded=!1)),this.snapTemporaryPointMarkerToOneDimensional!==null?this.temporaryPoint3Marker.positionVector=this.snapTemporaryPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryPointMarkerToPoint==null&&(this.temporaryPoint3Marker.positionVector=this.currentSphereVector),this.temporaryThreePointCircleAndCenterAdded||(this.temporaryThreePointCircleAndCenterAdded=!0,this.temporaryThreePointCircle.addToLayers(this.layers),this.temporaryThreePointCircleCenter.addToLayers(this.layers)),this.tmpVector.subVectors(this.tmpVector1.copy(this.temporaryPoint3Marker.positionVector).normalize(),this.point1Vector).isZero()||this.tmpVector.subVectors(this.tmpVector1.copy(this.temporaryPoint3Marker.positionVector).normalize(),this.point2Vector).isZero()?(this.temporaryThreePointCircle.removeFromLayers(),this.temporaryThreePointCircleCenter.removeFromLayers(),this.temporaryThreePointCircleAndCenterAdded=!1):(this.temporaryThreePointCircleCenter.vector3=this.temporaryPoint3Marker.positionVector,this.temporaryThreePointCircleCenter.updateDisplay(),this.temporaryThreePointCircle.centerVector=this.temporaryThreePointCircleCenter._locationVector,this.temporaryThreePointCircle.circleRadius=this.temporaryThreePointCircleCenter._locationVector.angleTo(this.temporaryPoint3Marker.positionVector),this.temporaryThreePointCircle.updateDisplay())):(this.temporaryPoint2MarkerAdded||(this.temporaryPoint2MarkerAdded=!0,this.temporaryPoint2Marker.addToLayers(this.layers)),this.snapTemporaryPointMarkerToPoint!==null&&(this.snapTemporaryPointMarkerToPoint instanceof Le&&!this.snapTemporaryPointMarkerToPoint.isUserCreated?this.temporaryPoint2Marker.positionVector=this.snapTemporaryPointMarkerToPoint.locationVector:(this.temporaryPoint2Marker.removeFromLayers(),this.temporaryPoint2MarkerAdded=!1)),this.snapTemporaryPointMarkerToOneDimensional!==null?this.temporaryPoint2Marker.positionVector=this.snapTemporaryPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryPointMarkerToPoint==null&&(this.temporaryPoint2Marker.positionVector=this.currentSphereVector)):(this.temporaryPoint1MarkerAdded||(this.temporaryPoint1MarkerAdded=!0,this.temporaryPoint1Marker.addToLayers(this.layers)),this.snapTemporaryPointMarkerToPoint!==null&&(this.snapTemporaryPointMarkerToPoint instanceof Le&&!this.snapTemporaryPointMarkerToPoint.isUserCreated?this.temporaryPoint1Marker.positionVector=this.snapTemporaryPointMarkerToPoint.locationVector:(this.temporaryPoint1Marker.removeFromLayers(),this.temporaryPoint1MarkerAdded=!1)),this.snapTemporaryPointMarkerToOneDimensional!==null?this.temporaryPoint1Marker.positionVector=this.snapTemporaryPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryPointMarkerToPoint==null&&(this.temporaryPoint1Marker.positionVector=this.currentSphereVector)):(this.point1LocationSelected?this.point2LocationSelected?(this.temporaryPoint3Marker.removeFromLayers(),this.temporaryPoint3MarkerAdded=!1,this.temporaryThreePointCircleCenter.removeFromLayers(),this.temporaryThreePointCircle.removeFromLayers(),this.temporaryThreePointCircleAndCenterAdded=!1):(this.temporaryPoint2Marker.removeFromLayers(),this.temporaryPoint2MarkerAdded=!1):(this.temporaryPoint1Marker.removeFromLayers(),this.temporaryPoint1MarkerAdded=!1),this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null)}mouseReleased(i){this.isOnSphere&&this.point2LocationSelected&&(!this.tmpVector.subVectors(this.tmpVector1.copy(this.temporaryPoint3Marker.positionVector).normalize(),this.point1Vector).isZero(S.circle.minimumRadius)&&!this.tmpVector.subVectors(this.tmpVector1.copy(this.temporaryPoint3Marker.positionVector).normalize(),this.point2Vector).isZero(S.circle.minimumRadius)?(this.makeThreePointCircleAndCenter()||$.fire("show-alert",{key:"handlers.threePointCircleCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.mouseLeave(i)):$.fire("show-alert",{key:"handlers.threePointCircleRepeatPointSelected",keyOptions:{},type:"info"}))}mouseLeave(i){super.mouseLeave(i),this.prepareForNextThreePointCircle()}prepareForNextThreePointCircle(){this.temporaryThreePointCircleCenter.removeFromLayers(),this.temporaryThreePointCircle.removeFromLayers(),this.temporaryPoint1Marker.removeFromLayers(),this.temporaryPoint2Marker.removeFromLayers(),this.temporaryPoint3Marker.removeFromLayers(),this.temporaryPoint1MarkerAdded=!1,this.temporaryPoint2MarkerAdded=!1,this.temporaryPoint3MarkerAdded=!1,this.temporaryThreePointCircleAndCenterAdded=!1,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null,this.point1SEPoint&&(this.point1SEPoint.glowing=!1,this.point1SEPoint.selected=!1),this.point2SEPoint&&(this.point2SEPoint.glowing=!1,this.point2SEPoint.selected=!1),this.point1SEPoint=null,this.point2SEPoint=null,this.point1LocationSelected=!1,this.point2LocationSelected=!1,this.point1SEPointOneDimensionalParent=null,this.point2SEPointOneDimensionalParent=null,this.point3SEPoint=null,Er.store.unglowAllSENodules()}makeThreePointCircleAndCenter(i=!1){const n=new Dt,r=[];if(this.point1SEPoint===null){let s=null,o=null;this.point1SEPointOneDimensionalParent?(o=new kt(this.point1SEPointOneDimensionalParent),s=new De("point",o),n.addCommand(new zt(o,this.point1SEPointOneDimensionalParent,s))):(o=new Ze,s=new De("point",o),n.addCommand(new Mn(o,s))),o.locationVector=this.point1Vector;const a=Er.addCreateAntipodeCommand(o,n);r.push(o,a),this.tmpVector.copy(o.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),s.locationVector=this.tmpVector,this.point1SEPoint=o}else(this.point1SEPoint instanceof Le&&!this.point1SEPoint.isUserCreated||this.point1SEPoint instanceof ut&&!this.point1SEPoint.isUserCreated)&&n.addCommand(new sn(this.point1SEPoint,!0));if(this.point2SEPoint===null){let s=null,o=null;this.point2SEPointOneDimensionalParent?(o=new kt(this.point2SEPointOneDimensionalParent),s=new De("point",o),n.addCommand(new zt(o,this.point2SEPointOneDimensionalParent,s))):(o=new Ze,s=new De("point",o),n.addCommand(new Mn(o,s))),o.locationVector=this.point2Vector;const a=Er.addCreateAntipodeCommand(o,n);r.push(a,o),this.tmpVector.copy(o.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),s.locationVector=this.tmpVector,this.point2SEPoint=o}else(this.point2SEPoint instanceof Le&&!this.point2SEPoint.isUserCreated||this.point2SEPoint instanceof ut&&!this.point2SEPoint.isUserCreated)&&n.addCommand(new sn(this.point2SEPoint,!0));if(this.hitSEPoints.length>0&&!i)this.point3SEPoint=this.hitSEPoints[0],(this.point3SEPoint instanceof Le&&!this.point3SEPoint.isUserCreated||this.point3SEPoint instanceof ut&&!this.point3SEPoint.isUserCreated)&&n.addCommand(new sn(this.point3SEPoint,!0));else if(!i){let s=null,o=null;this.hitSESegments.length>0?(s=new kt(this.hitSESegments[0]),s.locationVector=this.temporaryPoint3Marker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSESegments[0],o))):this.hitSELines.length>0?(s=new kt(this.hitSELines[0]),s.locationVector=this.temporaryPoint3Marker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSELines[0],o))):this.hitSECircles.length>0?(s=new kt(this.hitSECircles[0]),s.locationVector=this.temporaryPoint3Marker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSECircles[0],o))):this.hitSEEllipses.length>0?(s=new kt(this.hitSEEllipses[0]),s.locationVector=this.temporaryPoint3Marker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSEEllipses[0],o))):this.hitSEParametrics.length>0?(s=new kt(this.hitSEParametrics[0]),s.locationVector=this.temporaryPoint3Marker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSEParametrics[0],o))):this.hitSEPolygons.length>0?(s=new kt(this.hitSEPolygons[0]),s.locationVector=this.temporaryPoint3Marker.positionVector,o=new De("point",s),n.addCommand(new zt(s,this.hitSEPolygons[0],o))):(s=new Ze,s.locationVector=this.temporaryPoint3Marker.positionVector,o=new De("point",s),n.addCommand(new Mn(s,o))),this.point3SEPoint=s;const a=Er.addCreateAntipodeCommand(s,n);r.push(a,s),this.tmpVector.copy(s.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),o.locationVector=this.tmpVector}if(this.point3SEPoint){if(Er.store.sePoints.some(u=>this.tmpVector.subVectors(u.locationVector,this.tmpVector1.copy(this.temporaryThreePointCircleCenter._locationVector).normalize()).isZero()))return!1;const s=new QM(this.point1SEPoint,this.point2SEPoint,this.point3SEPoint),o=s.attachLabelWithOffset(new k(0,S.point.initialLabelOffset,0));n.addCommand(new ZP(s,this.point1SEPoint,this.point2SEPoint,this.point3SEPoint,o));const a=Er.addCreateAntipodeCommand(s,n);r.push(s,a);const l=new Kt(s,this.point1SEPoint,!0),c=new De("circle",l);this.tmpVector.copy(this.point1SEPoint.locationVector).add(new k(0,S.circle.initialLabelOffset,0)).normalize(),c.locationVector=this.tmpVector,n.addCommand(new Kp(l,s,this.point1SEPoint,c)),Er.store.createAllIntersectionsWithCircle(l,r).forEach(u=>{if(u.existingIntersectionPoint)n.addCommand(new nr(u.SEIntersectionPoint,u.parent1));else{const h=u.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));n.addCommand(new ir(u.SEIntersectionPoint,u.parent1,u.parent2,h)),u.SEIntersectionPoint.showing=!1,h.showing=!1,u.createAntipodalPoint&&Er.addCreateAntipodeCommand(u.SEIntersectionPoint,n)}}),n.execute(),s.markKidsOutOfDate(),s.update()}return!0}activate(){if(Er.store.selectedSENodules.length==3){const i=Er.store.selectedSENodules[0],n=Er.store.selectedSENodules[1],r=Er.store.selectedSENodules[2];i instanceof Ze&&n instanceof Ze&&r instanceof Ze&&!(vSe.subVectors(i.locationVector,n.locationVector).isZero()&&ySe.subVectors(i.locationVector,r.locationVector).isZero())&&(this.point1SEPoint=i,this.point2SEPoint=n,this.point3SEPoint=r,this.temporaryThreePointCircleCenter.vector1=i.locationVector,this.temporaryThreePointCircleCenter.vector2=n.locationVector,this.temporaryThreePointCircleCenter.vector3=r.locationVector,this.temporaryThreePointCircleCenter.updateDisplay(),this.makeThreePointCircleAndCenter(!0)||$.fire("show-alert",{key:"handlers.threePointCircleCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.prepareForNextThreePointCircle())}super.activate()}deactivate(){super.deactivate(),this.prepareForNextThreePointCircle()}}class Nr extends _i{constructor(i){super(i);y(this,"centerVector",new k);y(this,"centerSEPoint",null);y(this,"centerSEPointOneDimensionalParent",null);y(this,"centerLocationSelected",!1);y(this,"measurementSEParent",null);y(this,"temporaryCircle");y(this,"arcRadius",0);y(this,"temporaryCenterMarker");y(this,"temporaryCircleAdded",!1);y(this,"temporaryCenterMarkerAdded",!1);y(this,"snapTemporaryPointMarkerToOneDimensional",null);y(this,"snapTemporaryPointMarkerToPoint",null);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpMatrix",new Pt);this.temporaryCircle=new Sa,Nr.store.addTemporaryNodule(this.temporaryCircle),this.temporaryCenterMarker=new mi,Nr.store.addTemporaryNodule(this.temporaryCenterMarker)}mousePressed(i){if(this.isOnSphere&&!this.centerLocationSelected){if(Nr.store.seCircles.length===0&&Nr.store.seSegments.length===0&&Nr.store.expressions.length===0){$.fire("show-alert",{key:"handlers.firstMustCreateMeasurable",type:"error"}),$.fire("left-panel-set-active-tab",{tabNumber:0}),console.debug("set action mode from mouse pressed in measure circle handler"),Nr.store.setActionMode("segment");return}if(this.centerLocationSelected=!0,this.hitSEPoints.length>0){const n=this.hitSEPoints[0];this.centerVector.copy(n.locationVector),this.centerSEPoint=n,this.temporaryCenterMarker.positionVector=n.locationVector,this.temporaryCircle.centerVector=n.locationVector,this.centerSEPoint.glowing=!0,this.centerSEPoint.selected=!0}else this.hitSESegments.length>0?(this.centerSEPointOneDimensionalParent=this.hitSESegments[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryCenterMarker.positionVector=this.centerVector,this.centerSEPoint=null):this.hitSELines.length>0?(this.centerSEPointOneDimensionalParent=this.hitSELines[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryCenterMarker.positionVector=this.centerVector,this.centerSEPoint=null):this.hitSECircles.length>0?(this.centerSEPointOneDimensionalParent=this.hitSECircles[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryCenterMarker.positionVector=this.centerVector,this.centerSEPoint=null):this.hitSEEllipses.length>0?(this.centerSEPointOneDimensionalParent=this.hitSEEllipses[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryCenterMarker.positionVector=this.centerVector,this.centerSEPoint=null):this.hitSEParametrics.length>0?(this.centerSEPointOneDimensionalParent=this.hitSEParametrics[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryCenterMarker.positionVector=this.centerVector,this.centerSEPoint=null):this.hitSEPolygons.length>0?(this.centerSEPointOneDimensionalParent=this.hitSEPolygons[0],this.centerVector.copy(this.centerSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryCircle.centerVector=this.centerVector,this.temporaryCenterMarker.positionVector=this.centerVector,this.centerSEPoint=null):(this.temporaryCircle.centerVector=this.currentSphereVector,this.temporaryCenterMarker.positionVector=this.currentSphereVector,this.centerVector.copy(this.currentSphereVector),this.centerSEPoint=null);Nr.store.expressions.length>0?($.fire("left-panel-set-active-tab",{tabNumber:1}),$.fire("expand-measurement-sheet",{}),$.fire("show-alert",{key:"handlers.measuredCircleCenterSelected",keyOptions:{},type:"info"})):$.fire("show-alert",{key:"handlers.measuredCircleSelect",type:"info"})}}mouseMoved(i){if(super.mouseMoved(i),this.isOnSphere&&!this.centerLocationSelected){let n=null;this.hitSEPoints.length>0?n=this.hitSEPoints[0]:this.hitSESegments.length>0?n=this.hitSESegments[0]:this.hitSELines.length>0?n=this.hitSELines[0]:this.hitSECircles.length>0?n=this.hitSECircles[0]:this.hitSEEllipses.length>0?n=this.hitSEEllipses[0]:this.hitSEParametrics.length>0?n=this.hitSEParametrics[0]:this.hitSEPolygons.length>0?n=this.hitSEPolygons[0]:(this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null),n!==null&&(n instanceof Ze?(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=n):(n.glowing=!0,this.snapTemporaryPointMarkerToOneDimensional=n,this.snapTemporaryPointMarkerToPoint=null)),this.temporaryCenterMarkerAdded||(this.temporaryCenterMarkerAdded=!0,this.temporaryCenterMarker.addToLayers(this.layers)),this.snapTemporaryPointMarkerToPoint!==null&&((this.snapTemporaryPointMarkerToPoint instanceof Le||this.snapTemporaryPointMarkerToPoint instanceof ut)&&!this.snapTemporaryPointMarkerToPoint.isUserCreated?this.temporaryCenterMarker.positionVector=this.snapTemporaryPointMarkerToPoint.locationVector:(this.temporaryCenterMarker.removeFromLayers(),this.temporaryCenterMarkerAdded=!1)),this.snapTemporaryPointMarkerToOneDimensional!==null?this.temporaryCenterMarker.positionVector=this.snapTemporaryPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryPointMarkerToPoint==null&&(this.temporaryCenterMarker.positionVector=this.currentSphereVector)}else if(this.isOnSphere&&this.centerLocationSelected){const n=this.hitSELabels.filter(r=>r.parent.isMeasurable());this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.measurementSEParent=this.hitSESegments[0]):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.measurementSEParent=this.hitSECircles[0]):this.hitSEPolygons.length>0?(this.hitSEPolygons[0].glowing=!0,this.measurementSEParent=this.hitSEPolygons[0]):this.hitSEAngleMarkers.length>0?(this.hitSEAngleMarkers[0].glowing=!0,this.measurementSEParent=this.hitSEAngleMarkers[0]):n.length>0?(this.hitSELabels[0].glowing=!0,this.measurementSEParent=this.hitSELabels[0].parent):this.measurementSEParent=null,this.measurementSEParent!==null?(this.temporaryCircleAdded||(this.temporaryCircleAdded=!0,this.temporaryCircle.addToLayers(this.layers)),this.measurementSEParent instanceof Jt?this.arcRadius=this.measurementSEParent.arcLength:this.measurementSEParent instanceof Kt?this.arcRadius=this.measurementSEParent.circleRadius:(this.measurementSEParent instanceof Ks||this.measurementSEParent instanceof en||this.measurementSEParent instanceof On)&&(this.arcRadius=this.measurementSEParent.value),this.temporaryCircle.circleRadius=this.arcRadius,this.temporaryCircle.updateDisplay()):(this.temporaryCircle.removeFromLayers(),this.temporaryCircleAdded=!1)}else this.temporaryCenterMarker.removeFromLayers(),this.temporaryCenterMarkerAdded=!1,this.temporaryCircle.removeFromLayers(),this.temporaryCircleAdded=!1}mouseReleased(i){this.isOnSphere&&this.centerLocationSelected&&this.measurementSEParent!==null&&(this.makeCircle()||$.fire("show-alert",{key:"handlers.measuredCircleCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.prepareForNextCircle())}mouseLeave(i){super.mouseLeave(i)}prepareForNextCircle(){this.temporaryCircle.removeFromLayers(),this.temporaryCircleAdded=!1,this.temporaryCenterMarker.removeFromLayers(),this.temporaryCenterMarkerAdded=!1,this.snapTemporaryPointMarkerToOneDimensional=null,this.snapTemporaryPointMarkerToPoint=null,this.centerSEPoint!==null&&(this.centerSEPoint.glowing=!1,this.centerSEPoint.selected=!1),this.centerSEPoint=null,this.centerSEPointOneDimensionalParent=null,this.centerLocationSelected=!1,this.measurementSEParent=null,Nr.store.unglowAllSENodules()}displayTemporaryCircle(i,n){this.centerLocationSelected&&(i?(this.temporaryCircleAdded||(this.temporaryCircleAdded=!0,this.temporaryCircle.addToLayers(this.layers)),this.temporaryCircle.circleRadius=n.modPi(),this.temporaryCircle.updateDisplay()):(this.temporaryCircle.removeFromLayers(),this.temporaryCircleAdded=!1))}setExpression(i){this.centerLocationSelected&&(this.measurementSEParent=i,this.makeCircle()||$.fire("show-alert",{key:"handlers.measuredCircleCreationAttemptDuplicate",keyOptions:{},type:"error"}),this.prepareForNextCircle())}makeCircle(){const i=new Dt,n=[];if(this.centerSEPoint===null){let s=null,o=null;this.centerSEPointOneDimensionalParent?(o=new kt(this.centerSEPointOneDimensionalParent),s=new De("point",o),i.addCommand(new zt(o,this.centerSEPointOneDimensionalParent,s))):(o=new Ze,s=new De("point",o),i.addCommand(new Mn(o,s))),o.locationVector=this.centerVector;const a=Nr.addCreateAntipodeCommand(o,i);n.push(o,a),this.tmpVector.copy(o.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),s.locationVector=this.tmpVector,this.centerSEPoint=o}else(this.centerSEPoint instanceof Le&&!this.centerSEPoint.isUserCreated||this.centerSEPoint instanceof ut&&!this.centerSEPoint.isUserCreated)&&i.addCommand(new sn(this.centerSEPoint,!0));let r=null;if(this.measurementSEParent instanceof Jt?Nr.store.expressions.some(s=>s instanceof ws&&this.measurementSEParent!==null&&s.seSegment.name===this.measurementSEParent.name?(r=s,!0):!1)||(r=new ws(this.measurementSEParent),$.fire("show-alert",{key:"handlers.newSegmentMeasurementAdded",keyOptions:{name:`${r.name}`},type:"success"}),i.addCommand(new Fu(r,this.measurementSEParent)),this.measurementSEParent!==null&&this.measurementSEParent.label!==void 0&&(i.addCommand(new vc([this.measurementSEParent.label.ref],q.Label,[{labelDisplayMode:S.segment.measuringChangesLabelModeTo}],[{labelDisplayMode:this.measurementSEParent.label.ref.labelDisplayMode}])),i.addCommand(new qi(this.measurementSEParent.label,!0)))):this.measurementSEParent instanceof Kt?Nr.store.expressions.some(s=>s instanceof Sl&&this.measurementSEParent instanceof Kt&&(s.parents[0].name===this.measurementSEParent.circleSEPoint.name&&s.parents[1].name===this.measurementSEParent.centerSEPoint.name||s.parents[0].name===this.measurementSEParent.centerSEPoint.name&&s.parents[1].name===this.measurementSEParent.circleSEPoint.name)?(r=s,!0):!1)||(r=new Sl(this.measurementSEParent.centerSEPoint,this.measurementSEParent.circleSEPoint),$.fire("show-alert",{key:"handlers.newMeasurementAdded",keyOptions:{name:`${r.name}`},type:"success"}),i.addCommand(new ff(r,[this.measurementSEParent.centerSEPoint,this.measurementSEParent.circleSEPoint]))):r=this.measurementSEParent,Nr.store.seCircles.some(s=>s instanceof yC&&this.tmpVector.subVectors(s.centerSEPoint.locationVector,this.centerSEPoint?this.centerSEPoint.locationVector:this.tmpVector1).isZero()&&r&&r.name===s.radiusMeasurementSEExpression.name))return!1;if(r!==null){const s=new Ze(!0);s.showing=!1,s.exists=!0;const o=r.value.modPi();this.tmpVector.set(-this.centerSEPoint.locationVector.y,this.centerSEPoint.locationVector.x,0),this.tmpVector.isZero()&&this.tmpVector.set(0,-this.centerSEPoint.locationVector.z,this.centerSEPoint.locationVector.y),this.tmpVector.normalize(),this.tmpVector1.copy(this.centerSEPoint.locationVector).multiplyScalar(Math.cos(o)),this.tmpVector1.addScaledVector(this.tmpVector,Math.sin(o)),s.locationVector=this.tmpVector1.normalize();const a=new yC(this.centerSEPoint,s,r),l=new De("circle",a);this.tmpMatrix.makeRotationAxis(this.centerSEPoint.locationVector,Math.PI/2),this.tmpVector.copy(s.locationVector).applyMatrix4(this.tmpMatrix).add(new k(0,S.circle.initialLabelOffset,0)).normalize(),l.locationVector=this.tmpVector,i.addCommand(new JP(a,this.centerSEPoint,r,l)),Nr.store.createAllIntersectionsWithCircle(a,n).forEach(c=>{if(c.existingIntersectionPoint)i.addCommand(new nr(c.SEIntersectionPoint,c.parent1));else{const u=c.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));i.addCommand(new ir(c.SEIntersectionPoint,c.parent1,c.parent2,u)),c.SEIntersectionPoint.showing=!1,u.showing=!1,c.createAntipodalPoint&&Nr.addCreateAntipodeCommand(c.SEIntersectionPoint,i)}})}return i.execute(),this.measurementSEParent&&(this.measurementSEParent.markKidsOutOfDate(),this.measurementSEParent.update()),!0}activate(){super.activate()}deactivate(){super.deactivate(),this.prepareForNextCircle()}}class tl extends _i{constructor(i){super(i);y(this,"translationLineOrSegment",null);y(this,"translationLineOrSegmentSelected",!1);y(this,"measurementSEParent",null);y(this,"tmpVector",new k);y(this,"tmpVector1",new k)}mousePressed(i){if(this.isOnSphere&&!this.translationLineOrSegmentSelected){if(tl.store.seCircles.length===0&&tl.store.seSegments.length===0&&tl.store.expressions.length===0){$.fire("show-alert",{key:"handlers.firstMustCreateMeasurable",type:"error"}),$.fire("left-panel-set-active-tab",{tabNumber:0}),tl.store.setActionMode("segment");return}this.hitSESegments.length>0?(this.translationLineOrSegment=this.hitSESegments[0],this.translationLineOrSegmentSelected=!0,this.translationLineOrSegment.selected=!0,this.translationLineOrSegment.glowing=!0):this.hitSELines.length>0&&(this.translationLineOrSegment=this.hitSELines[0],this.translationLineOrSegmentSelected=!0,this.translationLineOrSegment.selected=!0,this.translationLineOrSegment.glowing=!0),this.translationLineOrSegmentSelected&&$.fire("show-alert",{key:"handlers.translationLineOrSegmentSelected",keyOptions:{},type:"info"})}}mouseMoved(i){if(super.mouseMoved(i),this.isOnSphere&&!this.translationLineOrSegmentSelected)this.hitSESegments.length>0?this.hitSESegments[0].glowing=!0:this.hitSELines.length>0&&(this.hitSELines[0].glowing=!0);else if(this.isOnSphere&&this.translationLineOrSegmentSelected){const n=this.hitSELabels.filter(r=>r.parent.isMeasurable());this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.measurementSEParent=this.hitSESegments[0]):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.measurementSEParent=this.hitSECircles[0]):this.hitSEPolygons.length>0?(this.hitSEPolygons[0].glowing=!0,this.measurementSEParent=this.hitSEPolygons[0]):this.hitSEAngleMarkers.length>0?(this.hitSEAngleMarkers[0].glowing=!0,this.measurementSEParent=this.hitSEAngleMarkers[0]):n.length>0?(this.hitSELabels[0].glowing=!0,this.measurementSEParent=this.hitSELabels[0].parent):this.measurementSEParent=null}}mouseReleased(i){this.isOnSphere&&this.translationLineOrSegmentSelected&&this.measurementSEParent!==null&&(this.makeTranslation()||$.fire("show-alert",{key:"handlers.duplicateTranslation",keyOptions:{},type:"error"}),this.prepareForNextTranslation())}mouseLeave(i){super.mouseLeave(i)}prepareForNextTranslation(){this.translationLineOrSegment!==null&&(this.translationLineOrSegment.glowing=!1,this.translationLineOrSegment.selected=!1),this.translationLineOrSegment=null,this.translationLineOrSegmentSelected=!1,this.measurementSEParent=null,tl.store.unglowAllSENodules()}setExpression(i){this.translationLineOrSegmentSelected&&(this.measurementSEParent=i,this.makeTranslation()||$.fire("show-alert",{key:"handlers.duplicateTranslation",keyOptions:{},type:"error"}),this.prepareForNextTranslation())}makeTranslation(){const i=new Dt;let n=null;if(this.measurementSEParent instanceof Jt?tl.store.expressions.some(r=>r instanceof ws&&this.measurementSEParent!==null&&r.seSegment.name===this.measurementSEParent.name?(n=r,!0):!1)||(n=new ws(this.measurementSEParent),$.fire("show-alert",{key:"handlers.newSegmentMeasurementAdded",keyOptions:{name:`${n.name}`},type:"success"}),i.addCommand(new Fu(n,this.measurementSEParent)),this.measurementSEParent!==null&&this.measurementSEParent.label!==void 0&&(i.addCommand(new vc([this.measurementSEParent.label.ref],q.Label,[{labelDisplayMode:S.segment.measuringChangesLabelModeTo}],[{labelDisplayMode:this.measurementSEParent.label.ref.labelDisplayMode}])),i.addCommand(new qi(this.measurementSEParent.label,!0)))):this.measurementSEParent instanceof Kt?tl.store.expressions.some(r=>r instanceof Sl&&this.measurementSEParent instanceof Kt&&(r.parents[0].name===this.measurementSEParent.circleSEPoint.name&&r.parents[1].name===this.measurementSEParent.centerSEPoint.name||r.parents[0].name===this.measurementSEParent.centerSEPoint.name&&r.parents[1].name===this.measurementSEParent.circleSEPoint.name)?(n=r,!0):!1)||(n=new Sl(this.measurementSEParent.centerSEPoint,this.measurementSEParent.circleSEPoint),$.fire("show-alert",{key:"handlers.newMeasurementAdded",keyOptions:{name:`${n.name}`},type:"success"}),i.addCommand(new ff(n,[this.measurementSEParent.centerSEPoint,this.measurementSEParent.circleSEPoint]))):n=this.measurementSEParent,tl.store.seTransformations.some(r=>{var s;return r instanceof is&&r.seLineOrSegment.name===((s=this.translationLineOrSegment)==null?void 0:s.name)&&(n==null?void 0:n.name)===r.translationDistanceExpression.name}))return!1;if(n!==null&&this.translationLineOrSegment!==null){const r=new is(this.translationLineOrSegment,n);i.addCommand(new QP(r,this.translationLineOrSegment,n)),$.fire("show-alert",{key:"handlers.newTranslationAdded",keyOptions:{name:`${r.name}`},type:"success"})}return i.execute(),!0}activate(){super.activate()}deactivate(){super.deactivate(),this.prepareForNextTranslation()}}class SSe extends L{constructor(i,n,r){super();y(this,"sePoint");y(this,"oldLocationVector",new k);y(this,"newLocationVector",new k);this.sePoint=i,this.oldLocationVector.copy(n),this.newLocationVector.copy(r)}do(){L.store.movePoint({pointId:this.sePoint.id,location:this.newLocationVector})}saveState(){this.lastState=this.sePoint.id}restoreState(){L.store.movePoint({pointId:this.lastState,location:this.oldLocationVector})}toOpcode(){return null}}class bSe extends L{constructor(i,n,r){super();y(this,"seLine");y(this,"oldNormalVector",new k);y(this,"newNormalVector",new k);this.seLine=i,this.oldNormalVector.copy(n),this.newNormalVector.copy(r)}do(){L.store.changeLineNormalVector({lineId:this.seLine.id,normal:this.newNormalVector})}saveState(){this.lastState=this.seLine.id}restoreState(){L.store.changeLineNormalVector({lineId:this.lastState,normal:this.oldNormalVector})}toOpcode(){return null}}class _Se extends L{constructor(i,n,r,s,o){super();y(this,"seSegment");y(this,"oldNormalVector",new k);y(this,"newNormalVector",new k);y(this,"oldArcLength");y(this,"newArcLength");this.seSegment=i,this.oldNormalVector.copy(n),this.newNormalVector.copy(r),this.oldArcLength=s,this.newArcLength=o}do(){L.store.changeSegmentNormalVectorArcLength({segmentId:this.seSegment.id,normal:this.newNormalVector,arcLength:this.newArcLength})}saveState(){this.lastState=this.seSegment.id}restoreState(){L.store.changeSegmentNormalVectorArcLength({segmentId:this.lastState,normal:this.oldNormalVector,arcLength:this.oldArcLength})}toOpcode(){return null}}class PSe extends L{constructor(i,n,r){super();y(this,"seLabel");y(this,"oldLocationVector",new k);y(this,"newLocationVector",new k);this.seLabel=i,this.oldLocationVector.copy(n),this.newLocationVector.copy(r)}do(){L.store.moveLabel({labelId:this.seLabel.id,location:this.newLocationVector})}saveState(){this.lastState=this.seLabel.id}restoreState(){L.store.moveLabel({labelId:this.lastState,location:this.oldLocationVector})}toOpcode(){return null}}class ESe extends L{constructor(i,n,r){var s;super();y(this,"seNodule");y(this,"existing");y(this,"showing");y(this,"initialLabelShowingValue");this.seNodule=i,this.existing=n,this.showing=r,this.seNodule.isLabelable()&&(this.initialLabelShowingValue=(s=this.seNodule.label)==null?void 0:s.showing)}do(){this.seNodule.exists=this.existing,this.seNodule.showing=this.showing,this.existing===!1&&this.initialLabelShowingValue===!0&&(this.seNodule.label.showing=!1)}saveState(){this.lastState=this.seNodule.id}restoreState(){this.seNodule.exists=!this.existing,this.seNodule.showing=!this.showing,this.initialLabelShowingValue!==void 0&&(this.seNodule.label.showing=this.initialLabelShowingValue)}toOpcode(){return null}}class wSe extends L{constructor(i,n,r){super();y(this,"seSlider");y(this,"oldSliderValue");y(this,"newSliderValue");this.seSlider=i,this.oldSliderValue=r,this.newSliderValue=n}do(){this.seSlider.value=this.newSliderValue}saveState(){this.lastState=this.seSlider.id}restoreState(){this.seSlider.value=this.oldSliderValue}toOpcode(){return null}}const zb=new k,Jf=new k;class LV extends _i{constructor(i){super(i);y(this,"movingSomething",!1);y(this,"moveTarget",null);y(this,"rotateSphere",!1);y(this,"beforeMoveStateMap",new Map);y(this,"beforeMoveSENoduleIDList",[]);y(this,"afterMoveStateMap",new Map);y(this,"afterMoveSENoduleIDList",[]);y(this,"beforeMoveVector",new k);y(this,"afterMoveVector",new k);y(this,"changeInPositionRotationMatrix",new Pt)}mousePressed(i){if(this.isOnSphere)if(this.moveTarget=null,this.rotateSphere=!1,this.movingSomething=!1,this.hitSENodules.length>0&&!this.hitSENodules.every(n=>n instanceof Ks)){const n=this.hitSEPoints.filter(s=>s.isFreeToMove()&&s.showing);if(n.length>0){this.moveTarget=n[0],this.moveTarget.markKidsOutOfDate(),this.moveTarget.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.movingSomething=!0;return}const r=this.hitSELabels.filter(s=>s.isFreeToMove()&&s.showing);if(r.length>0){this.moveTarget=r[0],this.moveTarget.markKidsOutOfDate(),this.moveTarget.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.movingSomething=!0;return}if(this.hitSEPoints.length==0){const s=this.hitSESegments.filter(c=>c.isFreeToMove()&&c.showing);if(s.length>0){this.moveTarget=s[0],this.moveTarget.startSEPoint.markKidsOutOfDate(),this.moveTarget.endSEPoint.markKidsOutOfDate(),this.moveTarget.startSEPoint.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.moveTarget.endSEPoint.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.movingSomething=!0;return}const o=this.hitSELines.filter(c=>c.isFreeToMove()&&c.showing);if(o.length>0){this.moveTarget=o[0],this.moveTarget.startSEPoint.markKidsOutOfDate(),this.moveTarget.endSEPoint.markKidsOutOfDate(),this.moveTarget.startSEPoint.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.moveTarget.endSEPoint.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.movingSomething=!0;return}const a=this.hitSECircles.filter(c=>c.isFreeToMove()&&c.showing);if(a.length>0){this.moveTarget=a[0],this.moveTarget.centerSEPoint.markKidsOutOfDate(),this.moveTarget.circleSEPoint.markKidsOutOfDate(),this.moveTarget.centerSEPoint.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.moveTarget.circleSEPoint.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.movingSomething=!0;return}const l=this.hitSEEllipses.filter(c=>c.isFreeToMove()&&c.showing);if(l.length>0){this.moveTarget=l[0],this.moveTarget.focus1SEPoint.markKidsOutOfDate(),this.moveTarget.focus2SEPoint.markKidsOutOfDate(),this.moveTarget.ellipseSEPoint.markKidsOutOfDate(),this.moveTarget.focus1SEPoint.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.moveTarget.focus2SEPoint.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.moveTarget.ellipseSEPoint.update(this.beforeMoveStateMap,this.beforeMoveSENoduleIDList),this.movingSomething=!0;return}}}else{const n=new k(this.currentSphereVector.x,this.currentSphereVector.y,-1*this.currentSphereVector.z),r=LV.store.findNearbySENodules(n,this.currentScreenVector).filter(s=>s instanceof Le||s instanceof ut?s.isUserCreated?s.showing&&s.exists:s.exists:s.showing&&s.exists);!i.shiftKey&&r.length>0&&$.fire("show-alert",{key:"handlers.moveHandlerObjectOnBackOfSphere",keyOptions:{},type:"info"}),this.rotateSphere=!0,this.beforeMoveVector.copy(this.currentSphereVector),$.fire("show-alert",{key:"handlers.moveHandlerNothingSelected",keyOptions:{},type:"warning"})}}mouseMoved(i){super.mouseMoved(i),this.isOnSphere&&(i.preventDefault(),!this.movingSomething&&!this.rotateSphere&&(this.hitSEPoints.filter(n=>n.isFreeToMove()).length>0?this.hitSEPoints[0].glowing=!0:this.hitSELabels.filter(n=>n.isFreeToMove()).length>0?this.hitSELabels[0].glowing=!0:this.hitSEPoints.length==0&&(this.hitSESegments.filter(n=>n.isFreeToMove()).length>0?this.hitSESegments[0].glowing=!0:this.hitSELines.filter(n=>n.isFreeToMove()).length>0?this.hitSELines[0].glowing=!0:this.hitSECircles.filter(n=>n.isFreeToMove()).length>0?this.hitSECircles[0].glowing=!0:this.hitSEEllipses.filter(n=>n.isFreeToMove()).length>0&&(this.hitSEEllipses[0].glowing=!0))),(this.rotateSphere||this.movingSomething)&&(this.moveTarget instanceof Ze?(this.moveTarget.locationVector=this.currentSphereVector,this.moveTarget.markKidsOutOfDate(),this.moveTarget.update()):this.moveTarget instanceof De?this.moveTarget.locationVector=this.currentSphereVector:this.moveTarget instanceof $t||this.moveTarget instanceof Jt?(this.moveTarget.ref.normalDisplay(),this.moveTarget.move(this.previousSphereVector,this.currentSphereVector,i.altKey,i.ctrlKey)):this.moveTarget instanceof Kt?(this.moveTarget.ref.normalDisplay(),this.moveTarget.move(this.previousSphereVector,this.currentSphereVector)):this.moveTarget instanceof Ii?(this.moveTarget.ref.normalDisplay(),this.moveTarget.move(this.previousSphereVector,this.currentSphereVector)):this.moveTarget==null&&this.rotateSphere&&(this.doRotateSphere(),this.afterMoveVector.copy(this.currentSphereVector))))}mouseReleased(i){if(!(!this.movingSomething&&!this.rotateSphere)){if(this.moveTarget==null&&this.rotateSphere){const n=this.beforeMoveVector.angleTo(this.afterMoveVector);Jf.crossVectors(this.beforeMoveVector,this.afterMoveVector),Jf.isZero(S.nearlyAntipodalIdeal)?Math.abs(n)<S.tolerance?this.changeInPositionRotationMatrix.identity():this.changeInPositionRotationMatrix.makeRotationAxis(zb.set(1,0,0),n):(Jf.normalize(),this.changeInPositionRotationMatrix.makeRotationAxis(Jf,n)),new cG(this.changeInPositionRotationMatrix).push()}else{this.moveTarget instanceof Ze?(this.moveTarget.markKidsOutOfDate(),this.moveTarget.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList)):this.moveTarget instanceof De?(this.moveTarget.markKidsOutOfDate(),this.moveTarget.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList)):this.moveTarget instanceof Jt?(this.moveTarget.startSEPoint.markKidsOutOfDate(),this.moveTarget.endSEPoint.markKidsOutOfDate(),this.moveTarget.startSEPoint.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList),this.moveTarget.endSEPoint.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList)):this.moveTarget instanceof $t?(this.moveTarget.startSEPoint.markKidsOutOfDate(),this.moveTarget.endSEPoint.markKidsOutOfDate(),this.moveTarget.startSEPoint.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList),this.moveTarget.endSEPoint.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList)):this.moveTarget instanceof Kt?(this.moveTarget.centerSEPoint.markKidsOutOfDate(),this.moveTarget.circleSEPoint.markKidsOutOfDate(),this.moveTarget.centerSEPoint.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList),this.moveTarget.circleSEPoint.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList)):this.moveTarget instanceof Ii&&(this.moveTarget.focus1SEPoint.markKidsOutOfDate(),this.moveTarget.focus2SEPoint.markKidsOutOfDate(),this.moveTarget.ellipseSEPoint.markKidsOutOfDate(),this.moveTarget.focus1SEPoint.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList),this.moveTarget.focus2SEPoint.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList),this.moveTarget.ellipseSEPoint.update(this.afterMoveStateMap,this.afterMoveSENoduleIDList));const n=new Dt;this.afterMoveSENoduleIDList.reverse(),this.afterMoveSENoduleIDList.forEach(r=>{const s=this.afterMoveStateMap.get(r);if(s===void 0)throw new Error(`MoveHandler: afterMoveStateMap doesn't contain the SENodule id ${r}. This should never happen.`);const o=this.beforeMoveStateMap.get(r);if(o===void 0)n.addCommand(new ESe(s.object,!0,!0)),console.debug(`A new object ${s.object.name} was revealed from before to after during a move event`);else switch(s.kind){case"label":case"pointOnOneOrTwoDimensional":case"point":s.object&&s.locationVector&&o.locationVector&&!zb.subVectors(s.locationVector,o.locationVector).isZero(S.nearlyAntipodalIdeal)&&(s.kind!=="label"?n.addCommand(new SSe(s.object,o.locationVector,s.locationVector)):n.addCommand(new PSe(s.object,o.locationVector,s.locationVector)));break;case"line":s.object&&s.normalVector&&o.normalVector&&!zb.subVectors(s.normalVector,o.normalVector).isZero(S.nearlyAntipodalIdeal)&&n.addCommand(new bSe(s.object,o.normalVector,s.normalVector));break;case"segment":s.object&&s.normalVector&&o.normalVector&&s.arcLength&&o.arcLength&&(!zb.subVectors(o.normalVector,s.normalVector).isZero(S.nearlyAntipodalIdeal)||o.arcLength<Math.PI&&s.arcLength>Math.PI||o.arcLength>Math.PI&&s.arcLength<Math.PI)&&n.addCommand(new _Se(s.object,o.normalVector,s.normalVector,o.arcLength,s.arcLength));break;case"slider":s.object&&s.sliderValue&&o.sliderValue&&s.sliderValue!==o.sliderValue&&n.addCommand(new wSe(s.object,s.sliderValue,o.sliderValue))}}),n.push()}this.moveTarget=null,this.rotateSphere=!1,this.movingSomething=!1,this.beforeMoveStateMap.clear(),this.beforeMoveSENoduleIDList.splice(0),this.afterMoveStateMap.clear(),this.afterMoveSENoduleIDList.splice(0)}}mouseLeave(i){super.mouseLeave(i),this.mouseReleased(i)}doRotateSphere(){const i=this.previousSphereVector.angleTo(this.currentSphereVector);i>S.rotate.minAngle&&(Jf.crossVectors(this.previousSphereVector,this.currentSphereVector).normalize(),this.changeInPositionRotationMatrix.makeRotationAxis(Jf,i),$.fire("sphere-rotate",{transform:this.changeInPositionRotationMatrix}))}}class zo extends _i{constructor(i){super(i);y(this,"rotationVector",new k);y(this,"rotationSEPoint",null);y(this,"rotationSEPointOneDimensionalParent",null);y(this,"rotationCenterLocationSelected",!1);y(this,"measurementSEParent",null);y(this,"temporaryRotationPointMarker");y(this,"temporaryRotationPointMarkerAdded",!1);y(this,"snapTemporaryRotationPointMarkerToOneDimensional",null);y(this,"snapTemporaryRotationPointMarkerToPoint",null);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);this.temporaryRotationPointMarker=new mi,zo.store.addTemporaryNodule(this.temporaryRotationPointMarker)}mousePressed(i){if(this.isOnSphere&&!this.rotationCenterLocationSelected){if(zo.store.seCircles.length===0&&zo.store.seSegments.length===0&&zo.store.expressions.length===0){$.fire("show-alert",{key:"handlers.firstMustCreateMeasurable",type:"error"}),$.fire("left-panel-set-active-tab",{tabNumber:0}),zo.store.setActionMode("segment");return}if(this.rotationCenterLocationSelected=!0,this.hitSEPoints.length>0){const n=this.hitSEPoints[0];this.rotationVector.copy(n.locationVector),this.rotationSEPoint=n,this.temporaryRotationPointMarker.positionVector=n.locationVector,this.rotationSEPoint.glowing=!0,this.rotationSEPoint.selected=!0}else this.hitSESegments.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSESegments[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):this.hitSELines.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSELines[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):this.hitSECircles.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSECircles[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):this.hitSEEllipses.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSEEllipses[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):this.hitSEParametrics.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSEParametrics[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):this.hitSEPolygons.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSEPolygons[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):(this.temporaryRotationPointMarker.positionVector=this.currentSphereVector,this.rotationVector.copy(this.currentSphereVector),this.rotationSEPoint=null);$.fire("show-alert",{key:"handlers.rotationPointSelected",keyOptions:{},type:"info"})}}mouseMoved(i){if(super.mouseMoved(i),this.isOnSphere&&!this.rotationCenterLocationSelected){let n=null;this.hitSEPoints.length>0?n=this.hitSEPoints[0]:this.hitSESegments.length>0?n=this.hitSESegments[0]:this.hitSELines.length>0?n=this.hitSELines[0]:this.hitSECircles.length>0?n=this.hitSECircles[0]:this.hitSEEllipses.length>0?n=this.hitSEEllipses[0]:this.hitSEParametrics.length>0?n=this.hitSEParametrics[0]:this.hitSEPolygons.length>0?n=this.hitSEPolygons[0]:(this.snapTemporaryRotationPointMarkerToOneDimensional=null,this.snapTemporaryRotationPointMarkerToPoint=null),n!==null&&(n instanceof Ze?(n.glowing=!0,this.snapTemporaryRotationPointMarkerToOneDimensional=null,this.snapTemporaryRotationPointMarkerToPoint=n):(n.glowing=!0,this.snapTemporaryRotationPointMarkerToOneDimensional=n,this.snapTemporaryRotationPointMarkerToPoint=null)),this.temporaryRotationPointMarkerAdded||(this.temporaryRotationPointMarkerAdded=!0,this.temporaryRotationPointMarker.addToLayers(this.layers)),this.snapTemporaryRotationPointMarkerToPoint!==null&&(this.snapTemporaryRotationPointMarkerToPoint instanceof Le&&!this.snapTemporaryRotationPointMarkerToPoint.isUserCreated?this.temporaryRotationPointMarker.positionVector=this.snapTemporaryRotationPointMarkerToPoint.locationVector:(this.temporaryRotationPointMarker.removeFromLayers(),this.temporaryRotationPointMarkerAdded=!1)),this.snapTemporaryRotationPointMarkerToOneDimensional!==null?this.temporaryRotationPointMarker.positionVector=this.snapTemporaryRotationPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryRotationPointMarkerToPoint==null&&(this.temporaryRotationPointMarker.positionVector=this.currentSphereVector)}else if(this.isOnSphere&&this.rotationCenterLocationSelected){const n=this.hitSELabels.filter(r=>r.parent.isMeasurable());this.hitSESegments.length>0?(this.hitSESegments[0].glowing=!0,this.measurementSEParent=this.hitSESegments[0]):this.hitSECircles.length>0?(this.hitSECircles[0].glowing=!0,this.measurementSEParent=this.hitSECircles[0]):this.hitSEPolygons.length>0?(this.hitSEPolygons[0].glowing=!0,this.measurementSEParent=this.hitSEPolygons[0]):this.hitSEAngleMarkers.length>0?(this.hitSEAngleMarkers[0].glowing=!0,this.measurementSEParent=this.hitSEAngleMarkers[0]):n.length>0?(this.hitSELabels[0].glowing=!0,this.measurementSEParent=this.hitSELabels[0].parent):this.measurementSEParent=null}else this.temporaryRotationPointMarker.removeFromLayers(),this.temporaryRotationPointMarkerAdded=!1}mouseReleased(i){this.isOnSphere&&this.rotationCenterLocationSelected&&this.measurementSEParent!==null&&(this.makeRotation()||$.fire("show-alert",{key:"handlers.duplicateRotation",keyOptions:{},type:"error"}),this.prepareForNextRotation())}mouseLeave(i){super.mouseLeave(i)}prepareForNextRotation(){this.temporaryRotationPointMarker.removeFromLayers(),this.temporaryRotationPointMarkerAdded=!1,this.snapTemporaryRotationPointMarkerToOneDimensional=null,this.snapTemporaryRotationPointMarkerToPoint=null,this.rotationSEPoint!==null&&(this.rotationSEPoint.glowing=!1,this.rotationSEPoint.selected=!1),this.rotationSEPoint=null,this.rotationSEPointOneDimensionalParent=null,this.rotationCenterLocationSelected=!1,this.measurementSEParent=null,zo.store.unglowAllSENodules()}setExpression(i){this.rotationCenterLocationSelected&&(this.measurementSEParent=i,this.makeRotation()||$.fire("show-alert",{key:"handlers.duplicateRotation",keyOptions:{},type:"error"}),this.prepareForNextRotation())}makeRotation(){const i=new Dt;if(this.rotationSEPoint===null){let r=null,s=null;this.rotationSEPointOneDimensionalParent?(s=new kt(this.rotationSEPointOneDimensionalParent),r=new De("point",s),i.addCommand(new zt(s,this.rotationSEPointOneDimensionalParent,r))):(s=new Ze,r=new De("point",s),i.addCommand(new Mn(s,r))),s.locationVector=this.rotationVector,zo.addCreateAntipodeCommand(s,i),this.tmpVector.copy(s.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),r.locationVector=this.tmpVector,this.rotationSEPoint=s}else(this.rotationSEPoint instanceof Le&&!this.rotationSEPoint.isUserCreated||this.rotationSEPoint instanceof ut&&!this.rotationSEPoint.isUserCreated)&&i.addCommand(new sn(this.rotationSEPoint,!0));let n=null;if(this.measurementSEParent instanceof Jt?zo.store.expressions.some(r=>r instanceof ws&&this.measurementSEParent!==null&&r.seSegment.name===this.measurementSEParent.name?(n=r,!0):!1)||(n=new ws(this.measurementSEParent),$.fire("show-alert",{key:"handlers.newSegmentMeasurementAdded",keyOptions:{name:`${n.name}`},type:"success"}),i.addCommand(new Fu(n,this.measurementSEParent)),this.measurementSEParent!==null&&this.measurementSEParent.label!==void 0&&(i.addCommand(new vc([this.measurementSEParent.label.ref],q.Label,[{labelDisplayMode:S.segment.measuringChangesLabelModeTo}],[{labelDisplayMode:this.measurementSEParent.label.ref.labelDisplayMode}])),i.addCommand(new qi(this.measurementSEParent.label,!0)))):this.measurementSEParent instanceof Kt?zo.store.expressions.some(r=>r instanceof Sl&&this.measurementSEParent instanceof Kt&&(r.parents[0].name===this.measurementSEParent.circleSEPoint.name&&r.parents[1].name===this.measurementSEParent.centerSEPoint.name||r.parents[0].name===this.measurementSEParent.centerSEPoint.name&&r.parents[1].name===this.measurementSEParent.circleSEPoint.name)?(n=r,!0):!1)||(n=new Sl(this.measurementSEParent.centerSEPoint,this.measurementSEParent.circleSEPoint),$.fire("show-alert",{key:"handlers.newMeasurementAdded",keyOptions:{name:`${n.name}`},type:"success"}),i.addCommand(new ff(n,[this.measurementSEParent.centerSEPoint,this.measurementSEParent.circleSEPoint]))):n=this.measurementSEParent,zo.store.seTransformations.some(r=>r instanceof ts&&this.tmpVector.subVectors(r.seRotationPoint.locationVector,this.rotationSEPoint?this.rotationSEPoint.locationVector:this.tmpVector1).isZero()&&(n==null?void 0:n.name)===r.seRotationAngleExpression.name))return!1;if(n!==null){const r=new ts(this.rotationSEPoint,n);i.addCommand(new eE(r,this.rotationSEPoint,n)),$.fire("show-alert",{key:"handlers.newRotationAdded",keyOptions:{name:`${r.name}`},type:"success"})}return i.execute(),!0}activate(){super.activate()}deactivate(){super.deactivate(),this.prepareForNextRotation()}}class Jh extends _i{constructor(i){super(i);y(this,"targetLineOrSegment",null)}mousePressed(i){if(this.isOnSphere&&(this.hitSELines.length>0||this.hitSESegments.length>0)){this.hitSELines.length>0?this.targetLineOrSegment=this.hitSELines[0]:this.hitSESegments.length>0&&(this.targetLineOrSegment=this.hitSESegments[0]);let n="";if(Jh.store.seTransformations.some(r=>r instanceof Qi&&this.targetLineOrSegment!==null&&r.seLineOrSegment.name===this.targetLineOrSegment.name?(n=r.name,!0):!1))if(this.targetLineOrSegment instanceof $t){$.fire("show-alert",{key:"handlers.duplicateReflectionLine",keyOptions:{trans:`${n}`},type:"error"}),this.targetLineOrSegment=null;return}else{$.fire("show-alert",{key:"handlers.duplicateReflectionSegment",keyOptions:{trans:`${n}`},type:"error"}),this.targetLineOrSegment=null;return}if(this.targetLineOrSegment!==null&&this.targetLineOrSegment.label!==void 0){const r=new Qi(this.targetLineOrSegment);$.fire("show-alert",{key:"handlers.newReflectionAdded",keyOptions:{name:`${r.name}`},type:"success"}),new Zv(r,this.targetLineOrSegment).execute(),$.fire("show-alert",{key:"handlers.newReflectionAdded",keyOptions:{name:`${r.name}`},type:"success"}),this.targetLineOrSegment.markKidsOutOfDate(),this.targetLineOrSegment.update(),this.targetLineOrSegment=null}}}mouseMoved(i){super.mouseMoved(i);const n=this.hitSESegments.filter(s=>!Jh.store.seTransformations.some(o=>o instanceof Qi&&o.seLineOrSegment.name===s.name)),r=this.hitSELines.filter(s=>!Jh.store.seTransformations.some(o=>o instanceof Qi&&o.seLineOrSegment.name===s.name));r.length>0?(r[0].glowing=!0,this.targetLineOrSegment=r[0]):n.length>0&&(n[0].glowing=!0,this.targetLineOrSegment=n[0])}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.targetLineOrSegment=null}activate(){if(Jh.store.selectedSENodules.length==1){const i=Jh.store.selectedSENodules[0];if(i instanceof $t||i instanceof Jt){let n="";if(Jh.store.seTransformations.some(r=>r instanceof Qi&&r.seLineOrSegment.name===i.name?(n=r.name,!0):!1))if(i instanceof $t){$.fire("show-alert",{key:"handlers.duplicateReflectionLine",keyOptions:{trans:`${n}`},type:"error"});return}else{$.fire("show-alert",{key:"handlers.duplicateReflectionSegment",keyOptions:{trans:`${n}`},type:"error"});return}else{const r=new Qi(i);$.fire("show-alert",{key:"handlers.newReflectionAdded",keyOptions:{name:`${r.name}`},type:"success"}),new Zv(r,i).execute(),i.markKidsOutOfDate(),i.update()}}}super.activate()}deactivate(){super.deactivate()}}class el extends _i{constructor(i){super(i);y(this,"rotationVector",new k);y(this,"rotationSEPoint",null);y(this,"rotationSEPointOneDimensionalParent",null);y(this,"temporaryRotationPointMarker");y(this,"temporaryRotationPointMarkerAdded",!1);y(this,"snapTemporaryRotationPointMarkerToOneDimensional",null);y(this,"snapTemporaryRotationPointMarkerToPoint",null);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);this.temporaryRotationPointMarker=new mi,el.store.addTemporaryNodule(this.temporaryRotationPointMarker)}mousePressed(i){if(this.isOnSphere){if(this.hitSEPoints.length>0){const n=this.hitSEPoints[0];let r="";if(el.store.seTransformations.some(s=>s instanceof er&&n!==null&&s.sePointOfReflection.name===n.name?(r=s.name,!0):!1)){$.fire("show-alert",{key:"handlers.duplicatePointReflection",keyOptions:{trans:`${r}`},type:"error"});return}this.rotationVector.copy(n.locationVector),this.rotationSEPoint=n,this.temporaryRotationPointMarker.positionVector=n.locationVector,this.rotationSEPoint.glowing=!0,this.rotationSEPoint.selected=!0}else this.hitSESegments.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSESegments[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):this.hitSELines.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSELines[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):this.hitSECircles.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSECircles[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):this.hitSEEllipses.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSEEllipses[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):this.hitSEParametrics.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSEParametrics[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):this.hitSEPolygons.length>0?(this.rotationSEPointOneDimensionalParent=this.hitSEPolygons[0],this.rotationVector.copy(this.rotationSEPointOneDimensionalParent.closestVector(this.currentSphereVector)),this.temporaryRotationPointMarker.positionVector=this.rotationVector,this.rotationSEPoint=null):(this.temporaryRotationPointMarker.positionVector=this.currentSphereVector,this.rotationVector.copy(this.currentSphereVector),this.rotationSEPoint=null);this.makeRotation()||$.fire("show-alert",{key:"handlers.duplicatePointRotation",keyOptions:{trans:""},type:"error"}),this.prepareForNextRotation()}}mouseMoved(i){if(super.mouseMoved(i),this.isOnSphere){const n=this.hitSEPoints.filter(s=>!el.store.seTransformations.some(o=>o instanceof er&&o.sePointOfReflection.name===s.name));let r=null;n.length>0?r=n[0]:this.hitSESegments.length>0?r=this.hitSESegments[0]:this.hitSELines.length>0?r=this.hitSELines[0]:this.hitSECircles.length>0?r=this.hitSECircles[0]:this.hitSEEllipses.length>0?r=this.hitSEEllipses[0]:this.hitSEParametrics.length>0?r=this.hitSEParametrics[0]:this.hitSEPolygons.length>0?r=this.hitSEPolygons[0]:(this.snapTemporaryRotationPointMarkerToOneDimensional=null,this.snapTemporaryRotationPointMarkerToPoint=null),r!==null&&(r instanceof Ze?(r.glowing=!0,this.snapTemporaryRotationPointMarkerToOneDimensional=null,this.snapTemporaryRotationPointMarkerToPoint=r):(r.glowing=!0,this.snapTemporaryRotationPointMarkerToOneDimensional=r,this.snapTemporaryRotationPointMarkerToPoint=null)),this.temporaryRotationPointMarkerAdded||(this.temporaryRotationPointMarkerAdded=!0,this.temporaryRotationPointMarker.addToLayers(this.layers)),this.snapTemporaryRotationPointMarkerToPoint!==null&&(this.snapTemporaryRotationPointMarkerToPoint instanceof Le&&!this.snapTemporaryRotationPointMarkerToPoint.isUserCreated?this.temporaryRotationPointMarker.positionVector=this.snapTemporaryRotationPointMarkerToPoint.locationVector:(this.temporaryRotationPointMarker.removeFromLayers(),this.temporaryRotationPointMarkerAdded=!1)),this.snapTemporaryRotationPointMarkerToOneDimensional!==null?this.temporaryRotationPointMarker.positionVector=this.snapTemporaryRotationPointMarkerToOneDimensional.closestVector(this.currentSphereVector):this.snapTemporaryRotationPointMarkerToPoint==null&&(this.temporaryRotationPointMarker.positionVector=this.currentSphereVector)}else this.temporaryRotationPointMarker.removeFromLayers(),this.temporaryRotationPointMarkerAdded=!1}mouseReleased(i){}mouseLeave(i){this.prepareForNextRotation(),super.mouseLeave(i)}prepareForNextRotation(){this.temporaryRotationPointMarker.removeFromLayers(),this.temporaryRotationPointMarkerAdded=!1,this.snapTemporaryRotationPointMarkerToOneDimensional=null,this.snapTemporaryRotationPointMarkerToPoint=null,this.rotationSEPoint!==null&&(this.rotationSEPoint.glowing=!1,this.rotationSEPoint.selected=!1),this.rotationSEPoint=null,this.rotationSEPointOneDimensionalParent=null,el.store.unglowAllSENodules()}makeRotation(){const i=new Dt;if(this.rotationSEPoint===null){let n=null,r=null;this.rotationSEPointOneDimensionalParent?(r=new kt(this.rotationSEPointOneDimensionalParent),n=new De("point",r),i.addCommand(new zt(r,this.rotationSEPointOneDimensionalParent,n))):(r=new Ze,n=new De("point",r),i.addCommand(new Mn(r,n))),r.locationVector=this.rotationVector,el.addCreateAntipodeCommand(r,i),this.tmpVector.copy(r.locationVector).add(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0)).normalize(),n.locationVector=this.tmpVector,this.rotationSEPoint=r}else(this.rotationSEPoint instanceof Le&&!this.rotationSEPoint.isUserCreated||this.rotationSEPoint instanceof ut&&!this.rotationSEPoint.isUserCreated)&&i.addCommand(new sn(this.rotationSEPoint,!0));if(el.store.seTransformations.some(n=>n instanceof er&&this.tmpVector.subVectors(n.sePointOfReflection.locationVector,this.rotationSEPoint?this.rotationSEPoint.locationVector:this.tmpVector1).isZero()))return!1;if(this.rotationSEPoint!==null){const n=new er(this.rotationSEPoint);i.addCommand(new Qv(n,this.rotationSEPoint)),i.execute(),$.fire("show-alert",{key:"handlers.newPointReflectionAdded",keyOptions:{name:`${n.name}`},type:"success"})}return!0}activate(){if(el.store.selectedSENodules.length==1){const i=el.store.selectedSENodules[0];if(i instanceof Ze){let n="";if(el.store.seTransformations.some(r=>r instanceof er&&r.sePointOfReflection.name===i.name?(n=r.name,!0):!1))$.fire("show-alert",{key:"handlers.duplicatePointReflection",keyOptions:{trans:`${n}`},type:"error"});else{const r=new er(i);$.fire("show-alert",{key:"handlers.newPointReflectionAdded",keyOptions:{name:`${r.name}`},type:"success"}),new Qv(r,i).execute(),i.markKidsOutOfDate(),i.update()}}}super.activate()}deactivate(){this.prepareForNextRotation(),super.deactivate()}}class dd extends _i{constructor(i){super(i);y(this,"targetCircleOfInversion",null)}mousePressed(i){var n;if(this.isOnSphere&&this.hitSECircles.length>0){this.targetCircleOfInversion=this.hitSECircles[0];let r="";if(dd.store.seTransformations.some(s=>s instanceof zr&&this.targetCircleOfInversion!==null&&s.seCircleOfInversion.name===this.targetCircleOfInversion.name?(r=s.name,!0):!1)){$.fire("show-alert",{key:"handlers.duplicateInversion",keyOptions:{trans:`${r}`},type:"error"});return}if(this.targetCircleOfInversion!==null&&this.targetCircleOfInversion.label!==void 0){const s=new zr(this.targetCircleOfInversion);$.fire("show-alert",{key:"handlers.newInversionAdded",keyOptions:{name:`${s.name}`},type:"success"});const o=new Dt;o.addCommand(new Jv(s,this.targetCircleOfInversion)),o.execute(),this.targetCircleOfInversion.markKidsOutOfDate(),this.targetCircleOfInversion.update(),this.targetCircleOfInversion=null}}if(this.isOnSphere&&this.hitSELines.length>0){$.fire("show-alert",{key:"handlers. greatCircleInversion",keyOptions:{name:`${(n=this.hitSELines[0].label)==null?void 0:n.ref.shortUserName}`},type:"error"});return}}mouseMoved(i){super.mouseMoved(i);const n=this.hitSECircles.filter(r=>!dd.store.seTransformations.some(s=>s instanceof zr&&s.seCircleOfInversion.name===r.name));n.length>0&&(n[0].glowing=!0,this.targetCircleOfInversion=n[0])}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i),this.targetCircleOfInversion=null}activate(){if(dd.store.selectedSENodules.length==1){const i=dd.store.selectedSENodules[0];if(i instanceof Kt){let n="";if(dd.store.seTransformations.some(r=>r instanceof zr&&r.seCircleOfInversion.name===i.name?(n=r.name,!0):!1))$.fire("show-alert",{key:"handlers.duplicateInversion",keyOptions:{trans:`${n}`},type:"error"});else{const r=new zr(i);$.fire("show-alert",{key:"handlers.newInversionAdded",keyOptions:{name:`${r.name}`},type:"success"}),new Jv(r,i).execute(),i.markKidsOutOfDate(),i.update()}}}super.activate()}deactivate(){super.deactivate()}}class vi extends _i{constructor(i){super(i);y(this,"transformationSEParent",null);y(this,"transformationType","");y(this,"temporaryPoint1");y(this,"temporaryPoint2");y(this,"temporaryPoint3");y(this,"temporarySegment");y(this,"temporaryLine");y(this,"temporaryCircle");y(this,"temporaryEllipse");y(this,"temporaryParametric");y(this,"temporaryCircleAdded",!1);y(this,"temporaryPoint1Added",!1);y(this,"temporaryPoint2Added",!1);y(this,"temporaryPoint3Added",!1);y(this,"temporarySegmentAdded",!1);y(this,"temporaryLineAdded",!1);y(this,"temporaryEllipseAdded",!1);y(this,"temporaryParametricAdded",!1);y(this,"possiblyGlowing",null);y(this,"lastPossiblyGlowingID",0);y(this,"tmpVector",new k);y(this,"tmpVector1",new k);y(this,"tmpVector2",new k);y(this,"tmpMatrix",new Pt);this.temporaryPoint1=new mi,this.temporaryPoint1.stylize(Vt.ApplyTemporaryVariables),vi.store.addTemporaryNodule(this.temporaryPoint1),this.temporaryPoint2=new mi,this.temporaryPoint2.stylize(Vt.ApplyTemporaryVariables),vi.store.addTemporaryNodule(this.temporaryPoint2),this.temporaryPoint3=new mi,this.temporaryPoint3.stylize(Vt.ApplyTemporaryVariables),vi.store.addTemporaryNodule(this.temporaryPoint3),this.temporarySegment=new Ws,this.temporarySegment.stylize(Vt.ApplyTemporaryVariables),vi.store.addTemporaryNodule(this.temporarySegment),this.temporaryLine=new _s,this.temporaryLine.stylize(Vt.ApplyTemporaryVariables),vi.store.addTemporaryNodule(this.temporaryLine),this.temporaryCircle=new Sa,this.temporaryCircle.stylize(Vt.ApplyTemporaryVariables),vi.store.addTemporaryNodule(this.temporaryCircle),this.temporaryEllipse=new ll,this.temporaryEllipse.stylize(Vt.ApplyTemporaryVariables),vi.store.addTemporaryNodule(this.temporaryEllipse),this.temporaryParametric=new Kv,this.temporaryParametric.stylize(Vt.ApplyTemporaryVariables),vi.store.addTemporaryNodule(this.temporaryParametric)}mousePressed(i){var n,r,s,o,a,l,c,u,h;if(this.isOnSphere)if(this.transformationSEParent!=null){if(this.hitSEPoints.length>0){if(this.hitSEPoints[0].kids.some(g=>g instanceof Dr&&this.transformationSEParent&&g.parentTransformation.name===this.transformationSEParent.name)){$.fire("show-alert",{key:"handlers.duplicateTransformedObject",keyOptions:{object:_e.global.t("objects.points",3),name:(n=this.hitSEPoints[0].label)==null?void 0:n.ref.shortUserName,type:this.transformationType,trans:this.transformationSEParent.name},type:"error"});return}const d=this.transformationSEParent.f(this.hitSEPoints[0].locationVector);if(this.tmpVector.subVectors(d,this.hitSEPoints[0].locationVector).isZero()){$.fire("show-alert",{key:"handlers.pointDoesNotMoveUnderTransformation",keyOptions:{type:this.transformationType,trans:this.transformationSEParent.name,pt:(r=this.hitSEPoints[0].label)==null?void 0:r.ref.shortUserName},type:"error"});return}let f="";if(vi.store.sePoints.some(g=>{var v;return this.tmpVector.subVectors(g.locationVector,d).isZero()?(f=((v=g.label)==null?void 0:v.ref.shortUserName)??"",!0):!1})){$.fire("show-alert",{key:"handlers.transformCreatesSecondPoint",keyOptions:{preimagePt:(s=this.hitSEPoints[0].label)==null?void 0:s.ref.shortUserName,type:this.transformationType,trans:this.transformationSEParent.name,existingPt:f},type:"error"});return}const m=new Dt;this.addTransformedPointCommands(m,this.transformationSEParent,this.hitSEPoints[0],!0),m.execute(),this.prepareForNextGeometricObject();return}if(this.transformationSEParent instanceof is||this.transformationSEParent instanceof ts||this.transformationSEParent instanceof er||this.transformationSEParent instanceof Qi)this.hitSESegments.length>0?!this.hitSESegments[0].kids.some(d=>d instanceof tv&&this.transformationSEParent&&d.parentIsometry.name===this.transformationSEParent.name)&&!vi.store.seSegments.some(d=>Math.abs(d.arcLength-this.hitSESegments[0].arcLength)<S.tolerance&&this.transformationSEParent&&(this.tmpVector.subVectors(d.normalVector,this.transformationSEParent.f(this.hitSESegments[0].normalVector)).isZero()||this.tmpVector.subVectors(this.tmpVector2.copy(d.normalVector).multiplyScalar(-1),this.transformationSEParent.f(this.hitSESegments[0].normalVector)).isZero())&&(this.tmpVector1.subVectors(d.startSEPoint.locationVector,this.transformationSEParent.f(this.transformationSEParent instanceof Qi?this.hitSESegments[0].endSEPoint.locationVector:this.hitSESegments[0].startSEPoint.locationVector)).isZero()||this.tmpVector1.subVectors(d.startSEPoint.locationVector,this.transformationSEParent.f(this.transformationSEParent instanceof Qi?this.hitSESegments[0].startSEPoint.locationVector:this.hitSESegments[0].endSEPoint.locationVector)).isZero()))?(this.applyIsometryToSegment(this.transformationSEParent,this.hitSESegments[0]),this.prepareForNextGeometricObject()):$.fire("show-alert",{key:"handlers.duplicateTransformedObject",keyOptions:{object:_e.global.t("objects.segments",3),name:(o=this.hitSESegments[0].label)==null?void 0:o.ref.shortUserName,type:this.transformationType,trans:this.transformationSEParent.name},type:"error"}):this.hitSELines.length>0?!this.hitSELines[0].kids.some(d=>d instanceof ev&&this.transformationSEParent&&d.parentIsometry.name===this.transformationSEParent.name)&&!vi.store.seLines.some(d=>this.transformationSEParent&&(this.tmpVector.subVectors(d.normalVector,this.transformationSEParent.f(this.hitSELines[0].normalVector)).isZero()||this.tmpVector.copy(d.normalVector).multiplyScalar(-1).sub(this.transformationSEParent.f(this.hitSELines[0].normalVector)).isZero()))?(this.applyIsometryToLine(this.transformationSEParent,this.hitSELines[0]),this.prepareForNextGeometricObject()):$.fire("show-alert",{key:"handlers.duplicateTransformedObject",keyOptions:{object:_e.global.t("objects.lines",3),name:(a=this.hitSELines[0].label)==null?void 0:a.ref.shortUserName,type:this.transformationType,trans:this.transformationSEParent.name},type:"error"}):this.hitSECircles.length>0?!this.hitSECircles[0].kids.some(d=>d instanceof Jg&&this.transformationSEParent&&d.parentIsometry.name===this.transformationSEParent.name)&&!vi.store.seCircles.some(d=>this.transformationSEParent&&this.tmpVector.subVectors(d.centerSEPoint.locationVector,this.transformationSEParent.f(this.hitSECircles[0].centerSEPoint.locationVector)).isZero()&&Math.abs(d.circleRadius-this.hitSECircles[0].circleRadius)<S.tolerance)?(this.applyIsometryToCircle(this.transformationSEParent,this.hitSECircles[0]),this.prepareForNextGeometricObject()):$.fire("show-alert",{key:"handlers.duplicateTransformedObject",keyOptions:{object:_e.global.t("objects.circles",3),name:(l=this.hitSECircles[0].label)==null?void 0:l.ref.shortUserName,type:this.transformationType,trans:this.transformationSEParent.name},type:"error"}):this.hitSEEllipses.length>0?!this.hitSEEllipses[0].kids.some(d=>d instanceof Qg&&this.transformationSEParent&&d.parentIsometry.name===this.transformationSEParent.name)&&!vi.store.seEllipses.some(d=>this.transformationSEParent&&(this.tmpVector.subVectors(d.focus1SEPoint.locationVector,this.transformationSEParent.f(this.hitSEEllipses[0].focus1SEPoint.locationVector)).isZero()&&this.tmpVector.subVectors(d.focus2SEPoint.locationVector,this.transformationSEParent.f(this.hitSEEllipses[0].focus2SEPoint.locationVector)).isZero()||this.tmpVector.subVectors(d.focus2SEPoint.locationVector,this.transformationSEParent.f(this.hitSEEllipses[0].focus1SEPoint.locationVector)).isZero()&&this.tmpVector.subVectors(d.focus1SEPoint.locationVector,this.transformationSEParent.f(this.hitSEEllipses[0].focus2SEPoint.locationVector)).isZero())&&Math.abs(d.ellipseAngleSum-this.hitSEEllipses[0].ellipseAngleSum)<S.tolerance)?(this.applyIsometryToEllipse(this.transformationSEParent,this.hitSEEllipses[0]),this.prepareForNextGeometricObject()):$.fire("show-alert",{key:"handlers.duplicateTransformedObject",keyOptions:{object:_e.global.t("objects.ellipses",3),name:(c=this.hitSEEllipses[0].label)==null?void 0:c.ref.shortUserName,type:this.transformationType,trans:this.transformationSEParent.name},type:"error"}):this.hitSEParametrics.length>0;else if(this.transformationSEParent instanceof zr&&!(this.hitSESegments.length>0))if(this.hitSELines.length>0){const d=this.computeCenterOfInvertedCircle(this.hitSELines[0].normalVector,Math.PI/2,this.transformationSEParent);!this.hitSELines[0].kids.some(f=>f instanceof Dr&&this.transformationSEParent&&f.parentTransformation.name===this.transformationSEParent.name)&&!vi.store.sePoints.some(f=>this.transformationSEParent&&this.tmpVector.subVectors(f.locationVector,d).isZero())?(this.applyInversionToLineOrCircle(this.transformationSEParent,this.hitSELines[0]),this.prepareForNextGeometricObject()):$.fire("show-alert",{key:"handlers.duplicateTransformedObject",keyOptions:{object:_e.global.t("objects.lines",3),name:(u=this.hitSELines[0].label)==null?void 0:u.ref.shortUserName,type:this.transformationType,trans:this.transformationSEParent.name},type:"error"})}else if(this.hitSECircles.length>0){const d=this.computeCenterOfInvertedCircle(this.hitSECircles[0].centerSEPoint.locationVector,this.hitSECircles[0].circleRadius,this.transformationSEParent);this.hitSECircles[0].name!==this.transformationSEParent.seCircleOfInversion.name&&!this.hitSECircles[0].kids.some(f=>f instanceof jc&&this.transformationSEParent&&f.parentTransformation.name===this.transformationSEParent.name)&&!(this.hitSECircles[0].centerSEPoint instanceof jc&&this.hitSECircles[0].centerSEPoint.parentTransformation.name===this.transformationSEParent.name)&&!vi.store.sePoints.some(f=>this.tmpVector.subVectors(f.locationVector,d).isZero()&&this.transformationSEParent instanceof zr&&f.name!==this.transformationSEParent.seCircleOfInversion.centerSEPoint.name&&f instanceof ut&&f.antipodalParent.name!==this.transformationSEParent.seCircleOfInversion.centerSEPoint.name)?(this.applyInversionToLineOrCircle(this.transformationSEParent,this.hitSECircles[0]),this.prepareForNextGeometricObject()):$.fire("show-alert",{key:"handlers.duplicateTransformedObject",keyOptions:{object:_e.global.t("objects.circles",3),name:(h=this.hitSECircles[0].label)==null?void 0:h.ref.shortUserName,type:this.transformationType,trans:this.transformationSEParent.name},type:"error"})}else this.hitSEEllipses.length>0||this.hitSEParametrics.length>0}else $.fire("left-panel-set-active-tab",{tabNumber:1}),$.fire("expand-transformation-sheet",{}),$.fire("show-alert",{key:"handlers.applyTransformationSelectTransformation",type:"info"})}mouseMoved(i){if(this.transformationSEParent!==null)if(this.transformationSEParent.geometricChild.glowing=!0,super.mouseMoved(i),this.isOnSphere){if(this.hitSEPoints.length>0?this.possiblyGlowing=this.hitSEPoints[0]:this.hitSESegments.length>0?this.possiblyGlowing=this.hitSESegments[0]:this.hitSELines.length>0?this.possiblyGlowing=this.hitSELines[0]:this.hitSECircles.length>0?this.possiblyGlowing=this.hitSECircles[0]:this.hitSEEllipses.length>0?this.possiblyGlowing=this.hitSEEllipses[0]:this.hitSEParametrics.length>0?this.possiblyGlowing=this.hitSEParametrics[0]:(this.possiblyGlowing=null,this.prepareForNextGeometricObject()),this.possiblyGlowing!==null&&this.lastPossiblyGlowingID!==this.possiblyGlowing.id&&this.prepareForNextGeometricObject(),this.possiblyGlowing!==null){if(this.possiblyGlowing instanceof Ze)!this.possiblyGlowing.kids.some(n=>{n instanceof Dr&&this.transformationSEParent&&(n.parentTransformation.name,this.transformationSEParent.name)})&&!vi.store.sePoints.some(n=>this.transformationSEParent&&this.tmpVector.subVectors(n.locationVector,this.transformationSEParent.f(this.hitSEPoints[0].locationVector)).isZero())&&(this.temporaryPoint1Added||(this.temporaryPoint1.addToLayers(this.layers),this.temporaryPoint1Added=!0),this.temporaryPoint1.positionVector=this.transformationSEParent.f(this.possiblyGlowing.locationVector),this.possiblyGlowing.glowing=!0);else if(this.possiblyGlowing instanceof Jt)this.transformationSEParent instanceof is||this.transformationSEParent instanceof ts||this.transformationSEParent instanceof er||this.transformationSEParent instanceof Qi?!this.possiblyGlowing.kids.some(n=>n instanceof tv&&this.transformationSEParent&&n.parentIsometry.name===this.transformationSEParent.name)&&!vi.store.seSegments.some(n=>this.possiblyGlowing instanceof Jt&&Math.abs(n.arcLength-this.possiblyGlowing.arcLength)<S.tolerance&&this.transformationSEParent&&(this.tmpVector.subVectors(n.normalVector,this.transformationSEParent.f(this.possiblyGlowing.normalVector)).isZero()||this.tmpVector.subVectors(this.tmpVector2.copy(n.normalVector).multiplyScalar(-1),this.transformationSEParent.f(this.possiblyGlowing.normalVector)).isZero())&&(this.tmpVector1.subVectors(n.startSEPoint.locationVector,this.transformationSEParent.f(this.transformationSEParent instanceof Qi?this.possiblyGlowing.endSEPoint.locationVector:this.possiblyGlowing.startSEPoint.locationVector)).isZero()||this.tmpVector1.subVectors(n.startSEPoint.locationVector,this.transformationSEParent.f(this.transformationSEParent instanceof Qi?this.possiblyGlowing.startSEPoint.locationVector:this.possiblyGlowing.endSEPoint.locationVector)).isZero()))&&(this.temporaryPoint1Added||(this.temporaryPoint1.addToLayers(this.layers),this.temporaryPoint1Added=!0),this.temporaryPoint1.positionVector=this.transformationSEParent.f(this.possiblyGlowing.startSEPoint.locationVector),this.temporaryPoint2Added||(this.temporaryPoint2.addToLayers(this.layers),this.temporaryPoint2Added=!0),this.temporaryPoint2.positionVector=this.transformationSEParent.f(this.possiblyGlowing.endSEPoint.locationVector),this.temporarySegmentAdded||(this.temporarySegment.addToLayers(this.layers),this.temporarySegmentAdded=!0),this.temporarySegment.normalVector=this.transformationSEParent.f(this.possiblyGlowing.normalVector),this.transformationSEParent instanceof Qi?this.temporarySegment.startVector=this.transformationSEParent.f(this.possiblyGlowing.endSEPoint.locationVector):this.temporarySegment.startVector=this.transformationSEParent.f(this.possiblyGlowing.startSEPoint.locationVector),this.temporarySegment.arcLength=this.possiblyGlowing.arcLength,this.temporarySegment.updateDisplay(),this.possiblyGlowing.glowing=!0):this.transformationSEParent instanceof zr;else if(this.possiblyGlowing instanceof $t){if(this.transformationSEParent instanceof is||this.transformationSEParent instanceof ts||this.transformationSEParent instanceof er||this.transformationSEParent instanceof Qi)!this.possiblyGlowing.kids.some(n=>n instanceof ev&&this.transformationSEParent&&n.parentIsometry.name===this.transformationSEParent.name)&&!vi.store.seLines.some(n=>this.transformationSEParent&&this.possiblyGlowing instanceof $t&&(this.tmpVector.subVectors(n.normalVector,this.transformationSEParent.f(this.possiblyGlowing.normalVector)).isZero()||this.tmpVector.copy(n.normalVector).multiplyScalar(-1).sub(this.transformationSEParent.f(this.possiblyGlowing.normalVector)).isZero()))&&(this.temporaryPoint1Added||(this.temporaryPoint1.addToLayers(this.layers),this.temporaryPoint1Added=!0),this.temporaryPoint1.positionVector=this.transformationSEParent.f(this.possiblyGlowing.startSEPoint.locationVector),this.temporaryPoint2Added||(this.temporaryPoint2.addToLayers(this.layers),this.temporaryPoint2Added=!0),this.temporaryPoint2.positionVector=this.transformationSEParent.f(this.possiblyGlowing.endSEPoint.locationVector),this.temporaryLineAdded||(this.temporaryLine.addToLayers(this.layers),this.temporaryLineAdded=!0),this.temporaryLine.normalVector=this.transformationSEParent.f(this.possiblyGlowing.normalVector),this.temporaryLine.updateDisplay(),this.possiblyGlowing.glowing=!0);else if(this.transformationSEParent instanceof zr){const n=this.computeCenterOfInvertedCircle(this.possiblyGlowing.normalVector,Math.PI/2,this.transformationSEParent);!this.possiblyGlowing.kids.some(r=>r instanceof Dr&&this.transformationSEParent&&r.parentTransformation.name===this.transformationSEParent.name)&&!vi.store.sePoints.some(r=>this.transformationSEParent&&this.tmpVector.subVectors(r.locationVector,n).isZero())&&(this.temporaryPoint1Added||(this.temporaryPoint1.addToLayers(this.layers),this.temporaryPoint1Added=!0),this.temporaryPoint1.positionVector=this.transformationSEParent.f(this.possiblyGlowing.startSEPoint.locationVector),this.temporaryPoint2Added||(this.temporaryPoint2.addToLayers(this.layers),this.temporaryPoint2Added=!0),this.temporaryPoint2.positionVector=n,this.temporaryCircleAdded||(this.temporaryCircle.addToLayers(this.layers),this.temporaryCircleAdded=!0),this.temporaryCircle.centerVector=n,this.temporaryCircle.circleRadius=n.angleTo(this.temporaryPoint1.positionVector),this.temporaryCircle.updateDisplay(),this.possiblyGlowing.glowing=!0)}}else if(this.possiblyGlowing instanceof Kt){if(this.transformationSEParent instanceof is||this.transformationSEParent instanceof ts||this.transformationSEParent instanceof er||this.transformationSEParent instanceof Qi)!this.possiblyGlowing.kids.some(n=>n instanceof Jg&&this.transformationSEParent&&n.parentIsometry.name===this.transformationSEParent.name)&&!vi.store.seCircles.some(n=>this.transformationSEParent&&this.possiblyGlowing instanceof Kt&&this.tmpVector.subVectors(n.centerSEPoint.locationVector,this.transformationSEParent.f(this.possiblyGlowing.centerSEPoint.locationVector)).isZero()&&Math.abs(n.circleRadius-this.possiblyGlowing.circleRadius)<S.tolerance)&&(this.temporaryPoint1Added||(this.temporaryPoint1.addToLayers(this.layers),this.temporaryPoint1Added=!0),this.temporaryPoint1.positionVector=this.transformationSEParent.f(this.possiblyGlowing.centerSEPoint.locationVector),this.temporaryPoint2Added||(this.temporaryPoint2.addToLayers(this.layers),this.temporaryPoint2Added=!0),this.temporaryPoint2.positionVector=this.transformationSEParent.f(this.possiblyGlowing.circleSEPoint.locationVector),this.temporaryCircleAdded||(this.temporaryCircle.addToLayers(this.layers),this.temporaryCircleAdded=!0),this.temporaryCircle.centerVector=this.transformationSEParent.f(this.possiblyGlowing.centerSEPoint.locationVector),this.temporaryCircle.circleRadius=this.possiblyGlowing.circleRadius,this.temporaryCircle.updateDisplay(),this.possiblyGlowing.glowing=!0);else if(this.transformationSEParent instanceof zr){const n=this.computeCenterOfInvertedCircle(this.possiblyGlowing.centerSEPoint.locationVector,this.possiblyGlowing.circleRadius,this.transformationSEParent);this.possiblyGlowing.name!==this.transformationSEParent.seCircleOfInversion.name&&!this.possiblyGlowing.kids.some(r=>r instanceof jc&&this.transformationSEParent&&r.parentTransformation.name===this.transformationSEParent.name)&&!(this.hitSECircles[0].centerSEPoint instanceof jc&&this.hitSECircles[0].centerSEPoint.parentTransformation.name===this.transformationSEParent.name)&&!vi.store.sePoints.some(r=>this.tmpVector.subVectors(r.locationVector,n).isZero()&&this.transformationSEParent instanceof zr&&r.name!==this.transformationSEParent.seCircleOfInversion.centerSEPoint.name&&r instanceof ut&&r.antipodalParent.name!==this.transformationSEParent.seCircleOfInversion.centerSEPoint.name)&&(this.temporaryPoint1Added||(this.temporaryPoint1.addToLayers(this.layers),this.temporaryPoint1Added=!0),this.temporaryPoint1.positionVector=this.transformationSEParent.f(this.possiblyGlowing.circleSEPoint.locationVector),this.temporaryPoint2Added||(this.temporaryPoint2.addToLayers(this.layers),this.temporaryPoint2Added=!0),this.temporaryPoint2.positionVector=n,this.temporaryCircleAdded||(this.temporaryCircle.addToLayers(this.layers),this.temporaryCircleAdded=!0),this.temporaryCircle.centerVector=n,this.temporaryCircle.circleRadius=n.angleTo(this.temporaryPoint1.positionVector),this.temporaryCircle.updateDisplay(),this.possiblyGlowing.glowing=!0)}}else this.possiblyGlowing instanceof Ii?this.transformationSEParent instanceof is||this.transformationSEParent instanceof ts||this.transformationSEParent instanceof er||this.transformationSEParent instanceof Qi?!this.possiblyGlowing.kids.some(n=>n instanceof Qg&&this.transformationSEParent&&n.parentIsometry.name===this.transformationSEParent.name)&&!vi.store.seEllipses.some(n=>this.transformationSEParent&&this.possiblyGlowing instanceof Ii&&(this.tmpVector.subVectors(n.focus1SEPoint.locationVector,this.transformationSEParent.f(this.possiblyGlowing.focus1SEPoint.locationVector)).isZero()&&this.tmpVector.subVectors(n.focus2SEPoint.locationVector,this.transformationSEParent.f(this.possiblyGlowing.focus2SEPoint.locationVector)).isZero()||this.tmpVector.subVectors(n.focus2SEPoint.locationVector,this.transformationSEParent.f(this.possiblyGlowing.focus1SEPoint.locationVector)).isZero()&&this.tmpVector.subVectors(n.focus1SEPoint.locationVector,this.transformationSEParent.f(this.possiblyGlowing.focus2SEPoint.locationVector)).isZero())&&Math.abs(n.ellipseAngleSum-this.possiblyGlowing.ellipseAngleSum)<S.tolerance)&&(this.temporaryPoint1Added||(this.temporaryPoint1.addToLayers(this.layers),this.temporaryPoint1Added=!0),this.temporaryPoint1.positionVector=this.transformationSEParent.f(this.possiblyGlowing.focus1SEPoint.locationVector),this.temporaryPoint2Added||(this.temporaryPoint2.addToLayers(this.layers),this.temporaryPoint2Added=!0),this.temporaryPoint2.positionVector=this.transformationSEParent.f(this.possiblyGlowing.focus2SEPoint.locationVector),this.temporaryPoint3Added||(this.temporaryPoint3.addToLayers(this.layers),this.temporaryPoint3Added=!0),this.temporaryPoint3.positionVector=this.transformationSEParent.f(this.possiblyGlowing.ellipseSEPoint.locationVector),this.temporaryEllipseAdded||(this.temporaryEllipse.addToLayers(this.layers),this.temporaryEllipseAdded=!0),this.temporaryEllipse.focus1Vector=this.transformationSEParent.f(this.possiblyGlowing.focus1SEPoint.locationVector),this.temporaryEllipse.focus2Vector=this.transformationSEParent.f(this.possiblyGlowing.focus2SEPoint.locationVector),this.temporaryEllipse.a=this.possiblyGlowing.a,this.temporaryEllipse.b=this.possiblyGlowing.b,this.temporaryEllipse.updateDisplay(),this.possiblyGlowing.glowing=!0):this.transformationSEParent instanceof zr:this.possiblyGlowing instanceof tn&&(this.transformationSEParent instanceof is||this.transformationSEParent instanceof ts||this.transformationSEParent instanceof er||this.transformationSEParent instanceof Qi||this.transformationSEParent instanceof zr);this.lastPossiblyGlowingID=this.possiblyGlowing.id}}else this.prepareForNextGeometricObject()}mouseReleased(i){}mouseLeave(i){super.mouseLeave(i)}prepareForNextGeometricObject(){this.temporaryPoint1.removeFromLayers(),this.temporaryPoint1Added=!1,this.temporaryPoint2.removeFromLayers(),this.temporaryPoint2Added=!1,this.temporaryPoint3.removeFromLayers(),this.temporaryPoint3Added=!1,this.temporarySegment.removeFromLayers(),this.temporarySegmentAdded=!1,this.temporaryLine.removeFromLayers(),this.temporaryLineAdded=!1,this.temporaryCircle.removeFromLayers(),this.temporaryCircleAdded=!1,this.temporaryEllipse.removeFromLayers(),this.temporaryEllipseAdded=!1,this.temporaryParametric.removeFromLayers(),this.temporaryParametricAdded=!1}prepareForNextTransformation(){this.prepareForNextGeometricObject(),this.transformationSEParent&&(this.transformationSEParent.geometricChild.glowing=!1),this.transformationSEParent=null,this.transformationType="",$.fire("set-apply-transformation-footer-text",{text:_e.global.t("objects.selectTransformation")})}setTransformation(i){this.transformationSEParent=i,this.transformationSEParent.geometricChild.glowing=!0,this.transformationSEParent instanceof is?(this.transformationType=_e.global.t("objects.translations",3),$.fire("set-apply-transformation-footer-text",{text:_e.global.t("objects.translations",1)+" "+this.transformationSEParent.name})):this.transformationSEParent instanceof er?(this.transformationType=_e.global.t("objects.pointReflections",3),$.fire("set-apply-transformation-footer-text",{text:_e.global.t("objects.pointReflections",1)+" "+this.transformationSEParent.name})):this.transformationSEParent instanceof Qi?(this.transformationType=_e.global.t("objects.reflections",3),$.fire("set-apply-transformation-footer-text",{text:_e.global.t("objects.reflections",1)+" "+this.transformationSEParent.name})):this.transformationSEParent instanceof ts?(this.transformationType=_e.global.t("objects.rotations",3),$.fire("set-apply-transformation-footer-text",{text:_e.global.t("objects.rotations",1)+" "+this.transformationSEParent.name})):this.transformationSEParent instanceof zr&&(this.transformationType=_e.global.t("objects.inversions",3),$.fire("set-apply-transformation-footer-text",{text:_e.global.t("objects.inversions",1)+" "+this.transformationSEParent.name}))}addTransformedPointCommands(i,n,r,s=!1){var h,d,f;const o=n.f(r.locationVector);let a=r;if(this.tmpVector.subVectors(o,r.locationVector).isZero())return s&&$.fire("show-alert",{key:"handlers.pointDoesNotMoveUnderTransformation",keyOptions:{type:this.transformationType,trans:n.name,pt:(h=r.label)==null?void 0:h.ref.shortUserName},type:"error"}),{newPoint:a,newAntipode:null};if(vi.store.sePoints.map(m=>m).some(m=>this.tmpVector.subVectors(m.locationVector,o).isZero()?(a=m,!0):!1))return s&&$.fire("show-alert",{key:"handlers.transformCreatesSecondPoint",keyOptions:{preimagePt:(d=r.label)==null?void 0:d.ref.shortUserName,type:this.transformationType,trans:n.name,existingPt:(f=a.label)==null?void 0:f.ref.shortUserName},type:"error"}),{newPoint:a,newAntipode:null};(r instanceof Le&&!r.isUserCreated||r instanceof ut&&!r.isUserCreated)&&i.addCommand(new sn(r,!0));const l=new Dr(r,n);l.markKidsOutOfDate(),l.update();const c=l.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));i.addCommand(new tE(l,c,r,n));const u=vi.addCreateAntipodeCommand(l,i);return $.fire("show-alert",{key:"handlers.newTransformedPointAdded",keyOptions:{name:`${l.name}`},type:"success"}),{newPoint:l,newAntipode:u}}applyIsometryToSegment(i,n){var u;const r=new Dt,s=[];let o=null;if(n.startSEPoint.kids.forEach(h=>{h instanceof Dr&&i&&h.parentTransformation.name===i.name&&(o=h)}),o===null){const h=this.addTransformedPointCommands(r,i,n.startSEPoint);o=h.newPoint,h.newAntipode?s.push(o,h.newAntipode):s.push(o)}let a=null;if(n.endSEPoint.kids.forEach(h=>{h instanceof Dr&&i&&h.parentTransformation.name===i.name&&(a=h)}),a===null){const h=this.addTransformedPointCommands(r,i,n.endSEPoint);a=h.newPoint,h.newAntipode?s.push(a,h.newAntipode):s.push(a)}const l=new tv(o,i.f(n.normalVector),n.arcLength,a,n,i);l.markKidsOutOfDate(),l.update();const c=l.attachLabelWithOffset(new k(2*S.segment.initialLabelOffset,S.segment.initialLabelOffset,0));r.addCommand(new iE(l,c,n,i)),vi.store.createAllIntersectionsWithSegment(l,s).forEach(h=>{if(h.existingIntersectionPoint)r.addCommand(new nr(h.SEIntersectionPoint,h.parent1));else{const d=h.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.segment.initialLabelOffset,S.segment.initialLabelOffset,0));r.addCommand(new ir(h.SEIntersectionPoint,h.parent1,h.parent2,d)),h.SEIntersectionPoint.showing=!1,d.showing=!1,h.createAntipodalPoint&&vi.addCreateAntipodeCommand(h.SEIntersectionPoint,r)}}),r.execute(),$.fire("show-alert",{key:"handlers.newIsometrySegmentAdded",keyOptions:{name:`${(u=l.label)==null?void 0:u.ref.shortUserName}`},type:"success"})}applyIsometryToLine(i,n){var u;const r=new Dt,s=[];let o=null;if(n.startSEPoint.kids.forEach(h=>{h instanceof Dr&&i&&h.parentTransformation.name===i.name&&(o=h)}),o===null){const h=this.addTransformedPointCommands(r,i,n.startSEPoint);o=h.newPoint,h.newAntipode?s.push(o,h.newAntipode):s.push(o)}let a=null;if(n.endSEPoint.kids.forEach(h=>{h instanceof Dr&&i&&h.parentTransformation.name===i.name&&(a=h)}),a===null){const h=this.addTransformedPointCommands(r,i,n.endSEPoint);a=h.newPoint,h.newAntipode?s.push(a,h.newAntipode):s.push(a)}const l=new ev(o,i.f(n.normalVector),a,n,i);l.markKidsOutOfDate(),l.update();const c=new De("line",l);this.tmpVector.copy(l.endSEPoint.locationVector).add(new k(2*S.line.initialLabelOffset,S.line.initialLabelOffset,0)).normalize(),c.locationVector=this.tmpVector,r.addCommand(new nE(l,c,n,i)),vi.store.createAllIntersectionsWithLine(l,s).forEach(h=>{if(h.existingIntersectionPoint)r.addCommand(new nr(h.SEIntersectionPoint,h.parent1));else{const d=h.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));r.addCommand(new ir(h.SEIntersectionPoint,h.parent1,h.parent2,d)),h.SEIntersectionPoint.showing=!1,d.showing=!1,h.createAntipodalPoint&&vi.addCreateAntipodeCommand(h.SEIntersectionPoint,r)}}),r.execute(),$.fire("show-alert",{key:"handlers.newIsometryLineAdded",keyOptions:{name:`${(u=l.label)==null?void 0:u.ref.shortUserName}`},type:"success"})}applyIsometryToCircle(i,n){var u;const r=new Dt,s=[];let o=null;if(n.centerSEPoint.kids.forEach(h=>{h instanceof Dr&&i&&h.parentTransformation.name===i.name&&(o=h)}),o===null){const h=this.addTransformedPointCommands(r,i,n.centerSEPoint);o=h.newPoint,h.newAntipode?s.push(o,h.newAntipode):s.push(o)}let a=null;if(n.circleSEPoint.kids.forEach(h=>{h instanceof Dr&&i&&h.parentTransformation.name===i.name&&(a=h)}),a===null){const h=this.addTransformedPointCommands(r,i,n.circleSEPoint);a=h.newPoint,h.newAntipode?s.push(a,h.newAntipode):s.push(a)}const l=new Jg(o,a,n,i);l.markKidsOutOfDate(),l.update();const c=new De("circle",l);this.tmpVector.copy(l.circleSEPoint.locationVector).add(new k(2*S.circle.initialLabelOffset,S.circle.initialLabelOffset,0)).normalize(),c.locationVector=this.tmpVector,r.addCommand(new rE(l,c,n,i)),vi.store.createAllIntersectionsWithCircle(l,s).forEach(h=>{if(h.existingIntersectionPoint)r.addCommand(new nr(h.SEIntersectionPoint,h.parent1));else{const d=h.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));r.addCommand(new ir(h.SEIntersectionPoint,h.parent1,h.parent2,d)),h.SEIntersectionPoint.showing=!1,d.showing=!1,h.createAntipodalPoint&&vi.addCreateAntipodeCommand(h.SEIntersectionPoint,r)}}),r.execute(),$.fire("show-alert",{key:"handlers.newIsometryCircleAdded",keyOptions:{name:`${(u=l.label)==null?void 0:u.ref.shortUserName}`},type:"success"})}applyIsometryToEllipse(i,n){var h;const r=new Dt,s=[];let o=null;if(n.focus1SEPoint.kids.forEach(d=>{d instanceof Dr&&i&&d.parentTransformation.name===i.name&&(o=d)}),o===null){const d=this.addTransformedPointCommands(r,i,n.focus1SEPoint);o=d.newPoint,d.newAntipode?s.push(o,d.newAntipode):s.push(o)}let a=null;if(n.focus2SEPoint.kids.forEach(d=>{d instanceof Dr&&i&&d.parentTransformation.name===i.name&&(a=d)}),a===null){const d=this.addTransformedPointCommands(r,i,n.focus2SEPoint);a=d.newPoint,d.newAntipode?s.push(a,d.newAntipode):s.push(a)}let l=null;if(n.ellipseSEPoint.kids.forEach(d=>{d instanceof Dr&&i&&d.parentTransformation.name===i.name&&(l=d)}),l===null){const d=this.addTransformedPointCommands(r,i,n.ellipseSEPoint);l=d.newPoint,d.newAntipode?s.push(l,d.newAntipode):s.push(l)}const c=new Qg(o,a,l,n,i);c.markKidsOutOfDate(),c.update();const u=new De("ellipse",c);this.tmpVector.copy(c.ellipseSEPoint.locationVector).add(new k(2*S.ellipse.initialLabelOffset,S.ellipse.initialLabelOffset,0)).normalize(),u.locationVector=this.tmpVector,r.addCommand(new sE(c,u,n,i)),vi.store.createAllIntersectionsWithEllipse(c,s).forEach(d=>{if(d.existingIntersectionPoint)r.addCommand(new nr(d.SEIntersectionPoint,d.parent1));else{const f=d.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));r.addCommand(new ir(d.SEIntersectionPoint,d.parent1,d.parent2,f)),d.SEIntersectionPoint.showing=!1,f.showing=!1,d.createAntipodalPoint&&vi.addCreateAntipodeCommand(d.SEIntersectionPoint,r)}}),r.execute(),$.fire("show-alert",{key:"handlers.newIsometryEllipseAdded",keyOptions:{name:`${(h=c.label)==null?void 0:h.ref.shortUserName}`},type:"success"})}computeCenterOfInvertedCircle(i,n,r){if(this.tmpVector1.subVectors(i,r.seCircleOfInversion.centerSEPoint.locationVector).isZero())return new k().copy(i).multiplyScalar(-1);if(this.tmpVector1.addVectors(i,r.seCircleOfInversion.centerSEPoint.locationVector).isZero())return new k().copy(r.seCircleOfInversion.centerSEPoint.locationVector);{const s=r.seCircleOfInversion.centerSEPoint.locationVector.angleTo(i),o=n,a=r.seCircleOfInversion.circleRadius,l=Math.atan(-Math.sin(a)*Math.sin(a)*Math.sin(s)/((1+Math.cos(a)*Math.cos(a))*Math.cos(s)-2*Math.cos(a)*Math.cos(o)));return this.tmpVector1.crossVectors(i,r.seCircleOfInversion.centerSEPoint.locationVector).normalize(),this.tmpVector.crossVectors(r.seCircleOfInversion.centerSEPoint.locationVector,this.tmpVector1).normalize(),this.tmpVector2.copy(r.seCircleOfInversion.centerSEPoint.locationVector).multiplyScalar(Math.cos(l)),this.tmpVector2.addScaledVector(this.tmpVector,Math.sin(l)),new k().copy(this.tmpVector2)}}applyInversionToLineOrCircle(i,n){var f;const r=new Dt,s=[];let o=null;const a=n instanceof $t?n.startSEPoint:n.circleSEPoint;if(a.kids.forEach(m=>{m instanceof Dr&&i&&m.parentTransformation.name===i.name&&(o=m)}),o===null){const m=this.addTransformedPointCommands(r,i,a);o=m.newPoint,m.newAntipode?s.push(o,m.newAntipode):s.push(o)}let l=null;const c=this.computeCenterOfInvertedCircle(n instanceof $t?n.normalVector:n.circleSEPoint.locationVector,n instanceof $t?Math.PI/2:n.circleRadius,i);if(vi.store.sePoints.map(m=>m).forEach(m=>{this.tmpVector.subVectors(m.locationVector,c).isZero()&&(l=m)}),l===null){l=new jc(n,i),l.markKidsOutOfDate(),l.update(),s.push(l);const m=l.attachLabelWithOffset(new k(2*S.line.initialLabelOffset,S.line.initialLabelOffset,0));r.addCommand(new oE(l,m,n,i));const g=vi.addCreateAntipodeCommand(l,r);s.push(l,g)}const u=new Kt(l!==null?l:new Ze,o,!0);u.markKidsOutOfDate(),u.update(),console.debug("new inversion circle radius",u.circleRadius);const h=new De("circle",u);this.tmpVector.copy(u.circleSEPoint.locationVector).add(new k(2*S.circle.initialLabelOffset,S.circle.initialLabelOffset,0)).normalize(),h.locationVector=this.tmpVector,r.addCommand(new Kp(u,l!==null?l:new Ze,o,h)),vi.store.createAllIntersectionsWithCircle(u,s).forEach(m=>{if(m.existingIntersectionPoint)r.addCommand(new nr(m.SEIntersectionPoint,m.parent1));else{const g=m.SEIntersectionPoint.attachLabelWithOffset(new k(2*S.point.initialLabelOffset,S.point.initialLabelOffset,0));r.addCommand(new ir(m.SEIntersectionPoint,m.parent1,m.parent2,g)),m.SEIntersectionPoint.showing=!1,g.showing=!1,m.createAntipodalPoint&&vi.addCreateAntipodeCommand(m.SEIntersectionPoint,r)}}),r.execute();const d=l!==null?(f=l.label)==null?void 0:f.ref.shortUserName:"";$.fire("show-alert",{key:"handlers.newInvertedLineOrCircleAdded",keyOptions:{name:`${d}`},type:"success"})}activate(){super.activate()}deactivate(){super.deactivate(),this.prepareForNextTransformation()}}const TSe={id:"sphereContainer"},xSe=["width","height"],kSe={class:"anchored top left"},CSe={class:"anchored top right"},MSe=ri({__name:"SphereFrame",props:{availableHeight:{default:240},availableWidth:{default:240},isEarthMode:{type:Boolean}},setup(t){const e=An(),{actionMode:i,zoomMagnificationFactor:n,zoomTranslation:r,seLabels:s,layers:o,isEarthMode:a}=Ji(e),l=Eh(),{favoriteTools:c}=Ji(l),{t:u}=qn(),h=t,d=ge(null),f=ge(""),m=W(()=>(console.debug("Updating shortcut icons"),c.value.map(Ue=>Ue.map(Ye=>rl.get(Ye)))));let g,v,p=null,b=null,_=null,P=null,E=null,T=null,C=null,M=null,x=null,V=null,N=null,D=null,O=null,F=null,X=null,Z=null,K=null,z=null,H=null,re=null,ne=null,B=null,Q=null,fe=null,ie=null,se=null,ee=null,de=null,Y=null,te=null,he=null,ae=null,A=null,I=null,G=null,ue=null,Se=null,Ee=null;to(()=>{g=new it({width:h.availableWidth,height:h.availableHeight,autostart:!0});const Ue=[st.foregroundText,st.backgroundText,st.foregroundTextGlowing,st.backgroundTextGlowing].map(Number);new it.Group;let Ye=[];for(const Je in st){const Ge=Number(Je);if(!isNaN(Ge)){const St=new it.Group;Ue.indexOf(Ge)>=0&&(St.scale=new it.Vector(1,-1)),St.addTo(g.scene),Ye.push(St)}}e.init(),e.setLayers(Ye),v=new it.Circle(0,0,S.boundaryCircle.radius),v.noFill(),v.linewidth=S.boundaryCircle.lineWidth,v.addTo(o.value[Number(st.midground)]),pe.idPlottableDescriptionMap.set(String(v.id),{type:"boundaryCircle",side:"mid",fill:!1,part:""}),M=new bd(o.value),p=M,$.listen("sphere-rotate",J),$.listen("zoom-updated",Oe),$.listen("export-current-svg",ve),$.listen("construction-loaded",xe),$.listen("measured-circle-set-temporary-radius",me),$.listen("set-expression-for-tool",Ne),$.listen("set-transformation-for-tool",ze),$.listen("delete-node",ke)}),ki(()=>{var Ue,Ye,Je,Ge,St;g.appendTo(d.value),d.value.addEventListener("mousemove",Pe),(Ue=d.value)==null||Ue.addEventListener("mousedown",we),(Ye=d.value)==null||Ye.addEventListener("mouseup",j),(Je=d.value)==null||Je.addEventListener("mouseleave",R),(Ge=d.value)==null||Ge.addEventListener("wheel",ye,{passive:!0}),(St=d.value)==null||St.addEventListener("contextmenu",Ft=>Ft.preventDefault()),console.debug("TwoJS SVG Canvas is",d.value),e.setCanvas(d.value),Oe()}),He(()=>h.isEarthMode,Ue=>{let Ye=0;for(const Je of Object.values(st).filter(Ge=>typeof Ge!="number"))Je.includes("background")&&(e.layers[Ye].visible=!Ue),Ye++}),an(()=>{var Ue,Ye,Je,Ge,St,Ft;(Ue=d.value)==null||Ue.removeEventListener("mousemove",Pe),(Ye=d.value)==null||Ye.removeEventListener("mousedown",we),(Je=d.value)==null||Je.removeEventListener("mouseup",j),(Ge=d.value)==null||Ge.removeEventListener("mouseleave",R),(St=d.value)==null||St.removeEventListener("wheel",ye),(Ft=d.value)==null||Ft.removeEventListener("contextmenu",be=>be.preventDefault()),$.unlisten("sphere-rotate"),$.unlisten("zoom-updated"),$.unlisten("export-current-svg"),$.unlisten("construction-loaded"),$.unlisten("measured-circle-set-temporary-radius"),$.unlisten("set-expression-for-tool"),$.unlisten("set-transformation-for-tool"),$.unlisten("delete-node")}),He(()=>a.value,Ue=>{if(!Ue)v.stroke="black",v.linewidth=S.boundaryCircle.lineWidth;else{let Ye=v.linewidth;v.stroke="blue";let Je;Je=setInterval(()=>{Ye-=.2,Ye<0?(v.linewidth=0,clearInterval(Je)):v.linewidth=Ye},100)}}),He([()=>h.availableWidth,()=>h.availableHeight],([Ue,Ye])=>{g.width=Ue,g.height=Ye;const Ge=(Math.min(Ue,Ye)/2-16)/S.boundaryCircle.radius;e.setZoomMagnificationFactor(Ge),r.value.splice(0),r.value.push(0,0),Oe(),e.setCanvasDimension(Ue,Ye)});function Oe(){const Ue=n.value,Ye=r,Je=h.availableWidth/2,Ge=h.availableHeight/2;g.scene.translation=new it.Vector(Je+Ye.value[0],Ge+Ye.value[1]),g.scene.scale=new it.Vector(Ue,-Ue),s.value.forEach(St=>{St.update()})}function ye(Ue){const Je=(Ue.currentTarget||Ue.target).getBoundingClientRect(),Ge=Ue.clientX-Je.left-Je.width/2,St=Ue.clientY-Je.top-Je.height/2;let Ft=Ue.deltaY/Je.height;Ue.ctrlKey&&(Ft*=-1);const be=n;let et=be;if(Ft<0){if(be.value<S.zoom.minMagnification){console.error(`Exceeded zoom out limit ${S.zoom.maxMagnification}`),$.fire("show-alert",{key:"handlers.panZoomHandlerZoomOutLimitReached",keyOptions:{},type:"warning"});return}et.value=(1-Math.abs(Ft))*be.value}if(Ft>0){if(be.value>S.zoom.maxMagnification){console.error(`Exceeded zoom in limit ${S.zoom.minMagnification}`),$.fire("show-alert",{key:"handlers.panZoomHandlerZoomInLimitReached",keyOptions:{},type:"warning"});return}et.value=(1+Ft)*be.value}const Ie=[r.value[0],r.value[1]],rt=(Ge-Ie[0])/be.value,Ke=(St-Ie[1])/be.value,Nt=[Ge-rt*et.value,St-Ke*et.value];if(et.value<be.value)if(et.value>1){const gn=(et.value-1)/(be.value-1);Nt[0]*=gn,Nt[1]*=gn}else Nt[0]=0,Nt[1]=0;e.setZoomMagnificationFactor(et.value),r.value.splice(0),r.value.push(...Nt),Oe();const zi=L.commandHistory.length;L.commandHistory[zi-1]instanceof uv?(L.commandHistory[zi-1].setMagnificationFactor=et.value,L.commandHistory[zi-1].setTranslationVector=Nt):new uv(et.value,Nt,be.value,Ie).push()}function Pe(Ue){Ue.button===0&&(p==null||p.mouseMoved(Ue))}function we(Ue){Ue.button===0&&(p==null||p.mousePressed(Ue))}function j(Ue){Ue.button===0&&(p==null||p.mouseReleased(Ue))}function R(Ue){Ue.button===0&&(p==null||p.mouseLeave(Ue))}function J(Ue){e.rotateSphere(Ue.transform)}function ve(){var rt;const Ue=(rt=d.value)==null?void 0:rt.querySelector("svg");console.log("Nodule.idPlottableDescriptionMap",pe.idPlottableDescriptionMap);const Ye=Ue.cloneNode(!0);Ye.setAttribute("xmlns","http://www.w3.org/2000/svg");const Je=Ye.querySelectorAll("text");for(let Ke=0;Ke<Je.length;Ke++)Je[Ke].remove();const Ge=Ye.querySelectorAll("path");for(let Ke=0;Ke<Ge.length;Ke++){const Nt=Ge[Ke],zi=pe.idPlottableDescriptionMap.get(Nt.getAttribute("id")??"");(Nt.getAttribute("visibility")==="hidden"||Nt.getAttribute("d")===""||(zi==null?void 0:zi.type)==="angleMarker"&&zi.part==="edge")&&Nt.remove()}const St=Ye.querySelectorAll("g");for(let Ke=0;Ke<St.length;Ke++){const Nt=St[Ke];Nt.childElementCount===0&&Nt.remove()}const Ft=[],be=Ye.querySelectorAll("defs");for(let Ke=0;Ke<be.length;Ke++)Ft.push(be[Ke].outerHTML);const et=Ye.querySelectorAll("path");for(let Ke=0;Ke<et.length;Ke++){et[Ke].setAttribute("vector-effect","non-scaling-stroke");const Nt=pe.idPlottableDescriptionMap.get(et[Ke].getAttribute("id")??"");if(Nt===void 0)throw new Error(`IconBase - ${et[Ke]} has no id.`);et[Ke].setAttribute("type",Nt.type),et[Ke].setAttribute("side",Nt.side),et[Ke].setAttribute("myfill",String(Nt.fill)),et[Ke].setAttribute("part",Nt.part),Ft.push(et[Ke].outerHTML)}var Ie=new Blob([Ft.join(";")],{type:"text/plain;charset=utf-8"});t1.saveAs(Ie,"iconXXXPaths.svg")}function xe(){f.value="spin",setTimeout(()=>{f.value=""},1200)}function me(Ue){p instanceof Nr&&p.displayTemporaryCircle(Ue.display,Ue.radius)}function Ne(Ue){(p instanceof Nr||p instanceof zo||p instanceof tl)&&p.setExpression(Ue.expression)}function ze(Ue){p instanceof vi?p.setTransformation(Ue.transformation):(e.setActionMode("applyTransformation"),Ee||(Ee=new vi(o.value)),Ee.setTransformation(Ue.transformation))}function ke(Ue){X||(X=new _d(o.value));const Ye=X.delete(Ue.victim);$.fire("show-alert",{key:"handlers.deletedNodes",keyOptions:{type:Ue.victimType,name:Ue.victimName,number:Ye.length-1,objects:Ye.length===2?u("objects.objects",4):u("objects.objects",3)},type:"success"})}He(()=>i.value,Ue=>{p==null||p.deactivate(),p=null;let Ye;const Je=rl.get(Ue);switch(Je&&(Ye={key:Je.displayedName,secondaryMsg:Je.toolUseMessage,keyOptions:{},secondaryMsgKeyOptions:{},type:"directive"}),Ue){case"select":b||(b=new Yn(o.value)),p=b;break;case"delete":X||(X=new _d(o.value)),p=X;break;case"zoomIn":x||(x=new Sx(d.value)),x.zoomMode=r1.MAGNIFY,p=x;break;case"zoomOut":x||(x=new Sx(d.value)),x.zoomMode=r1.MINIFY,p=x;break;case"zoomFit":x||(x=new Sx(d.value)),x.doZoomFit(Math.min(h.availableHeight,h.availableWidth)),x.activate(),x.deactivate(),e.revertActionMode();break;case"iconFactory":fe||(fe=new pSe),fe.createIconPaths(),e.revertActionMode();break;case"hide":Z||(Z=new Sm(o.value)),p=Z;break;case"move":V||(V=new LV(o.value)),p=V;break;case"rotate":M||(M=new bd(o.value)),p=M;break;case"point":_||(_=new j_(o.value)),p=_;break;case"line":P||(P=new Us(o.value)),p=P;break;case"segment":E||(E=new gs(o.value)),p=E;break;case"circle":T||(T=new ho(o.value)),p=T;break;case"ellipse":C||(C=new Xr(o.value)),p=C;break;case"antipodalPoint":D||(D=new fa(o.value)),p=D;break;case"polar":O||(O=new Bs(o.value)),p=O;break;case"intersect":F||(F=new da(o.value)),p=F;break;case"pointOnObject":N||(N=new $_(o.value)),p=N;break;case"segmentLength":K||(K=new bm(o.value)),p=K;break;case"pointDistance":z||(z=new _m(o.value)),p=z;break;case"angle":H||(H=new Or(o.value)),p=H;break;case"coordinate":re||(re=new Pm(o.value)),p=re;break;case"toggleLabelDisplay":ne||(ne=new Em(o.value)),p=ne;break;case"perpendicular":B||(B=new uo(o.value)),p=B;break;case"tangent":Q||(Q=new js(o.value)),p=Q;break;case"measureTriangle":ie||(ie=new Dl(o.value,!0)),p=ie;break;case"measurePolygon":se||(se=new Dl(o.value,!1)),p=se;break;case"midpoint":ee||(ee=new au(o.value,!0)),p=ee;break;case"nSectPoint":de||(de=new au(o.value,!1)),p=de;break;case"angleBisector":Y||(Y=new Nl(o.value,!0)),p=Y;break;case"nSectLine":te||(te=new Nl(o.value,!1)),p=te;break;case"threePointCircle":he||(he=new Er(o.value)),p=he;break;case"measuredCircle":ae||(ae=new Nr(o.value)),p=ae;break;case"translation":A||(A=new tl(o.value)),p=A;break;case"rotation":I||(I=new zo(o.value)),p=I;break;case"reflection":G||(G=new Jh(o.value)),p=G;break;case"pointReflection":ue||(ue=new el(o.value)),p=ue;break;case"inversion":Se||(Se=new dd(o.value)),p=Se;break;case"applyTransformation":Ee||(Ee=new vi(o.value)),p=Ee;break;default:p=null}p&&Ye&&$.fire("show-alert",Ye),p==null||p.activate()});function pt(Ue,Ye,Je){const Ge={};let St=0,Ft=0,be=0;for(;Ue>0;)Ft>0?(Ft--,St++):(be++,Ft=be,St=0),Ue--;return Ge.position="absolute",Ge[Ye]=`${Ft*36}px`,Ge[Je]=`${St*36}px`,Ge}return(Ue,Ye)=>(Te(),Ct("div",TSe,[tt("div",{id:"canvas",ref_key:"canvas",ref:d,class:Gs(f.value),width:Ue.availableWidth,height:Ue.availableHeight},null,10,xSe),tt("div",kSe,[(Te(!0),Ct(mt,null,Zs(m.value[0],(Je,Ge)=>(Te(),Ct("div",{key:Ge,style:mr(pt(Ge,"left","top"))},[w(ud,{model:Je},null,8,["model"])],4))),128))]),tt("div",CSe,[(Te(!0),Ct(mt,null,Zs(m.value[1],(Je,Ge)=>(Te(),Ct("div",{key:Ge,style:mr(pt(Ge,"right","top"))},[w(ud,{model:Je},null,8,["model"])],4))),128))])]))}});const ASe=Tn(MSe,[["__scopeId","data-v-e6d1b589"]]);class yf extends Error{}class VSe extends yf{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class LSe extends yf{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class ISe extends yf{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class wm extends yf{}class hG extends yf{constructor(e){super(`Invalid unit ${e}`)}}class go extends yf{}class jh extends yf{constructor(){super("Zone is an abstract class")}}const gt="numeric",_l="short",Qo="long",W_={year:gt,month:gt,day:gt},uG={year:gt,month:_l,day:gt},OSe={year:gt,month:_l,day:gt,weekday:_l},dG={year:gt,month:Qo,day:gt},fG={year:gt,month:Qo,day:gt,weekday:Qo},mG={hour:gt,minute:gt},pG={hour:gt,minute:gt,second:gt},gG={hour:gt,minute:gt,second:gt,timeZoneName:_l},vG={hour:gt,minute:gt,second:gt,timeZoneName:Qo},yG={hour:gt,minute:gt,hourCycle:"h23"},SG={hour:gt,minute:gt,second:gt,hourCycle:"h23"},bG={hour:gt,minute:gt,second:gt,hourCycle:"h23",timeZoneName:_l},_G={hour:gt,minute:gt,second:gt,hourCycle:"h23",timeZoneName:Qo},PG={year:gt,month:gt,day:gt,hour:gt,minute:gt},EG={year:gt,month:gt,day:gt,hour:gt,minute:gt,second:gt},wG={year:gt,month:_l,day:gt,hour:gt,minute:gt},TG={year:gt,month:_l,day:gt,hour:gt,minute:gt,second:gt},DSe={year:gt,month:_l,day:gt,weekday:_l,hour:gt,minute:gt},xG={year:gt,month:Qo,day:gt,hour:gt,minute:gt,timeZoneName:_l},kG={year:gt,month:Qo,day:gt,hour:gt,minute:gt,second:gt,timeZoneName:_l},CG={year:gt,month:Qo,day:gt,weekday:Qo,hour:gt,minute:gt,timeZoneName:Qo},MG={year:gt,month:Qo,day:gt,weekday:Qo,hour:gt,minute:gt,second:gt,timeZoneName:Qo};class mS{get type(){throw new jh}get name(){throw new jh}get ianaName(){return this.name}get isUniversal(){throw new jh}offsetName(e,i){throw new jh}formatOffset(e,i){throw new jh}offset(e){throw new jh}equals(e){throw new jh}get isValid(){throw new jh}}let bx=null;class HE extends mS{static get instance(){return bx===null&&(bx=new HE),bx}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:i,locale:n}){return FG(e,i,n)}formatOffset(e,i){return dv(this.offset(e),i)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let L0={};function NSe(t){return L0[t]||(L0[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),L0[t]}const RSe={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function FSe(t,e){const i=t.format(e).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,r,s,o,a,l,c,u]=n;return[o,r,s,a,l,c,u]}function zSe(t,e){const i=t.formatToParts(e),n=[];for(let r=0;r<i.length;r++){const{type:s,value:o}=i[r],a=RSe[s];s==="era"?n[a]=o:ci(a)||(n[a]=parseInt(o,10))}return n}let Ub={};class gh extends mS{static create(e){return Ub[e]||(Ub[e]=new gh(e)),Ub[e]}static resetCache(){Ub={},L0={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=gh.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:i,locale:n}){return FG(e,i,n,this.name)}formatOffset(e,i){return dv(this.offset(e),i)}offset(e){const i=new Date(e);if(isNaN(i))return NaN;const n=NSe(this.name);let[r,s,o,a,l,c,u]=n.formatToParts?zSe(n,i):FSe(n,i);a==="BC"&&(r=-Math.abs(r)+1);const d=KE({year:r,month:s,day:o,hour:l===24?0:l,minute:c,second:u,millisecond:0});let f=+i;const m=f%1e3;return f-=m>=0?m:1e3+m,(d-f)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let cF={};function USe(t,e={}){const i=JSON.stringify([t,e]);let n=cF[i];return n||(n=new Intl.ListFormat(t,e),cF[i]=n),n}let s1={};function o1(t,e={}){const i=JSON.stringify([t,e]);let n=s1[i];return n||(n=new Intl.DateTimeFormat(t,e),s1[i]=n),n}let a1={};function BSe(t,e={}){const i=JSON.stringify([t,e]);let n=a1[i];return n||(n=new Intl.NumberFormat(t,e),a1[i]=n),n}let l1={};function jSe(t,e={}){const{base:i,...n}=e,r=JSON.stringify([t,n]);let s=l1[r];return s||(s=new Intl.RelativeTimeFormat(t,e),l1[r]=s),s}let Bg=null;function $Se(){return Bg||(Bg=new Intl.DateTimeFormat().resolvedOptions().locale,Bg)}let hF={};function WSe(t){let e=hF[t];if(!e){const i=new Intl.Locale(t);e="getWeekInfo"in i?i.getWeekInfo():i.weekInfo,hF[t]=e}return e}function GSe(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const i=t.indexOf("-u-");if(i===-1)return[t];{let n,r;try{n=o1(t).resolvedOptions(),r=t}catch{const l=t.substring(0,i);n=o1(l).resolvedOptions(),r=l}const{numberingSystem:s,calendar:o}=n;return[r,s,o]}}function HSe(t,e,i){return(i||e)&&(t.includes("-u-")||(t+="-u"),i&&(t+=`-ca-${i}`),e&&(t+=`-nu-${e}`)),t}function qSe(t){const e=[];for(let i=1;i<=12;i++){const n=di.utc(2009,i,1);e.push(t(n))}return e}function KSe(t){const e=[];for(let i=1;i<=7;i++){const n=di.utc(2016,11,13+i);e.push(t(n))}return e}function Bb(t,e,i,n){const r=t.listingMode();return r==="error"?null:r==="en"?i(e):n(e)}function XSe(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}class YSe{constructor(e,i,n){this.padTo=n.padTo||0,this.floor=n.floor||!1;const{padTo:r,floor:s,...o}=n;if(!i||Object.keys(o).length>0){const a={useGrouping:!1,...n};n.padTo>0&&(a.minimumIntegerDigits=n.padTo),this.inf=BSe(e,a)}}format(e){if(this.inf){const i=this.floor?Math.floor(e):e;return this.inf.format(i)}else{const i=this.floor?Math.floor(e):NV(e,3);return hr(i,this.padTo)}}}class ZSe{constructor(e,i,n){this.opts=n,this.originalZone=void 0;let r;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&gh.create(a).valid?(r=a,this.dt=e):(r="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,r=e.zone.name):(r="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||r,this.dtf=o1(i,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(i=>{if(i.type==="timeZoneName"){const n=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:n}}else return i}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class JSe{constructor(e,i,n){this.opts={style:"long",...n},!i&&NG()&&(this.rtf=jSe(e,n))}format(e,i){return this.rtf?this.rtf.format(e,i):ybe(i,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,i){return this.rtf?this.rtf.formatToParts(e,i):[]}}const QSe={firstDay:1,minimalDays:4,weekend:[6,7]};class cn{static fromOpts(e){return cn.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,i,n,r,s=!1){const o=e||Qn.defaultLocale,a=o||(s?"en-US":$Se()),l=i||Qn.defaultNumberingSystem,c=n||Qn.defaultOutputCalendar,u=c1(r)||Qn.defaultWeekSettings;return new cn(a,l,c,u,o)}static resetCache(){Bg=null,s1={},a1={},l1={}}static fromObject({locale:e,numberingSystem:i,outputCalendar:n,weekSettings:r}={}){return cn.create(e,i,n,r)}constructor(e,i,n,r,s){const[o,a,l]=GSe(e);this.locale=o,this.numberingSystem=i||a||null,this.outputCalendar=n||l||null,this.weekSettings=r,this.intl=HSe(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=XSe(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&i?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:cn.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,c1(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,i=!1){return Bb(this,e,BG,()=>{const n=i?{month:e,day:"numeric"}:{month:e},r=i?"format":"standalone";return this.monthsCache[r][e]||(this.monthsCache[r][e]=qSe(s=>this.extract(s,n,"month"))),this.monthsCache[r][e]})}weekdays(e,i=!1){return Bb(this,e,WG,()=>{const n=i?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},r=i?"format":"standalone";return this.weekdaysCache[r][e]||(this.weekdaysCache[r][e]=KSe(s=>this.extract(s,n,"weekday"))),this.weekdaysCache[r][e]})}meridiems(){return Bb(this,void 0,()=>GG,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[di.utc(2016,11,13,9),di.utc(2016,11,13,19)].map(i=>this.extract(i,e,"dayperiod"))}return this.meridiemCache})}eras(e){return Bb(this,e,HG,()=>{const i={era:e};return this.eraCache[e]||(this.eraCache[e]=[di.utc(-40,1,1),di.utc(2017,1,1)].map(n=>this.extract(n,i,"era"))),this.eraCache[e]})}extract(e,i,n){const r=this.dtFormatter(e,i),s=r.formatToParts(),o=s.find(a=>a.type.toLowerCase()===n);return o?o.value:null}numberFormatter(e={}){return new YSe(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,i={}){return new ZSe(e,this.intl,i)}relFormatter(e={}){return new JSe(this.intl,this.isEnglish(),e)}listFormatter(e={}){return USe(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:RG()?WSe(this.locale):QSe}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let _x=null;class Ys extends mS{static get utcInstance(){return _x===null&&(_x=new Ys(0)),_x}static instance(e){return e===0?Ys.utcInstance:new Ys(e)}static parseSpecifier(e){if(e){const i=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new Ys(XE(i[1],i[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${dv(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${dv(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,i){return dv(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class ebe extends mS{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function lu(t,e){if(ci(t)||t===null)return e;if(t instanceof mS)return t;if(nbe(t)){const i=t.toLowerCase();return i==="default"?e:i==="local"||i==="system"?HE.instance:i==="utc"||i==="gmt"?Ys.utcInstance:Ys.parseSpecifier(i)||gh.create(t)}else return Od(t)?Ys.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new ebe(t)}let uF=()=>Date.now(),dF="system",fF=null,mF=null,pF=null,gF=60,vF,yF=null;class Qn{static get now(){return uF}static set now(e){uF=e}static set defaultZone(e){dF=e}static get defaultZone(){return lu(dF,HE.instance)}static get defaultLocale(){return fF}static set defaultLocale(e){fF=e}static get defaultNumberingSystem(){return mF}static set defaultNumberingSystem(e){mF=e}static get defaultOutputCalendar(){return pF}static set defaultOutputCalendar(e){pF=e}static get defaultWeekSettings(){return yF}static set defaultWeekSettings(e){yF=c1(e)}static get twoDigitCutoffYear(){return gF}static set twoDigitCutoffYear(e){gF=e%100}static get throwOnInvalid(){return vF}static set throwOnInvalid(e){vF=e}static resetCaches(){cn.resetCache(),gh.resetCache()}}class fl{constructor(e,i){this.reason=e,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const AG=[0,31,59,90,120,151,181,212,243,273,304,334],VG=[0,31,60,91,121,152,182,213,244,274,305,335];function Ta(t,e){return new fl("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function IV(t,e,i){const n=new Date(Date.UTC(t,e-1,i));t<100&&t>=0&&n.setUTCFullYear(n.getUTCFullYear()-1900);const r=n.getUTCDay();return r===0?7:r}function LG(t,e,i){return i+(pS(t)?VG:AG)[e-1]}function IG(t,e){const i=pS(t)?VG:AG,n=i.findIndex(s=>s<e),r=e-i[n];return{month:n+1,day:r}}function OV(t,e){return(t-e+7)%7+1}function G_(t,e=4,i=1){const{year:n,month:r,day:s}=t,o=LG(n,r,s),a=OV(IV(n,r,s),i);let l=Math.floor((o-a+14-e)/7),c;return l<1?(c=n-1,l=Ey(c,e,i)):l>Ey(n,e,i)?(c=n+1,l=1):c=n,{weekYear:c,weekNumber:l,weekday:a,...YE(t)}}function SF(t,e=4,i=1){const{weekYear:n,weekNumber:r,weekday:s}=t,o=OV(IV(n,1,e),i),a=jm(n);let l=r*7+s-o-7+e,c;l<1?(c=n-1,l+=jm(c)):l>a?(c=n+1,l-=jm(n)):c=n;const{month:u,day:h}=IG(c,l);return{year:c,month:u,day:h,...YE(t)}}function Px(t){const{year:e,month:i,day:n}=t,r=LG(e,i,n);return{year:e,ordinal:r,...YE(t)}}function bF(t){const{year:e,ordinal:i}=t,{month:n,day:r}=IG(e,i);return{year:e,month:n,day:r,...YE(t)}}function _F(t,e){if(!ci(t.localWeekday)||!ci(t.localWeekNumber)||!ci(t.localWeekYear)){if(!ci(t.weekday)||!ci(t.weekNumber)||!ci(t.weekYear))throw new wm("Cannot mix locale-based week fields with ISO-based week fields");return ci(t.localWeekday)||(t.weekday=t.localWeekday),ci(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),ci(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function tbe(t,e=4,i=1){const n=qE(t.weekYear),r=xa(t.weekNumber,1,Ey(t.weekYear,e,i)),s=xa(t.weekday,1,7);return n?r?s?!1:Ta("weekday",t.weekday):Ta("week",t.weekNumber):Ta("weekYear",t.weekYear)}function ibe(t){const e=qE(t.year),i=xa(t.ordinal,1,jm(t.year));return e?i?!1:Ta("ordinal",t.ordinal):Ta("year",t.year)}function OG(t){const e=qE(t.year),i=xa(t.month,1,12),n=xa(t.day,1,H_(t.year,t.month));return e?i?n?!1:Ta("day",t.day):Ta("month",t.month):Ta("year",t.year)}function DG(t){const{hour:e,minute:i,second:n,millisecond:r}=t,s=xa(e,0,23)||e===24&&i===0&&n===0&&r===0,o=xa(i,0,59),a=xa(n,0,59),l=xa(r,0,999);return s?o?a?l?!1:Ta("millisecond",r):Ta("second",n):Ta("minute",i):Ta("hour",e)}function ci(t){return typeof t>"u"}function Od(t){return typeof t=="number"}function qE(t){return typeof t=="number"&&t%1===0}function nbe(t){return typeof t=="string"}function rbe(t){return Object.prototype.toString.call(t)==="[object Date]"}function NG(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function RG(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function sbe(t){return Array.isArray(t)?t:[t]}function PF(t,e,i){if(t.length!==0)return t.reduce((n,r)=>{const s=[e(r),r];return n&&i(n[0],s[0])===n[0]?n:s},null)[1]}function obe(t,e){return e.reduce((i,n)=>(i[n]=t[n],i),{})}function wp(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function c1(t){if(t==null)return null;if(typeof t!="object")throw new go("Week settings must be an object");if(!xa(t.firstDay,1,7)||!xa(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!xa(e,1,7)))throw new go("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function xa(t,e,i){return qE(t)&&t>=e&&t<=i}function abe(t,e){return t-e*Math.floor(t/e)}function hr(t,e=2){const i=t<0;let n;return i?n="-"+(""+-t).padStart(e,"0"):n=(""+t).padStart(e,"0"),n}function Qh(t){if(!(ci(t)||t===null||t===""))return parseInt(t,10)}function nd(t){if(!(ci(t)||t===null||t===""))return parseFloat(t)}function DV(t){if(!(ci(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function NV(t,e,i=!1){const n=10**e;return(i?Math.trunc:Math.round)(t*n)/n}function pS(t){return t%4===0&&(t%100!==0||t%400===0)}function jm(t){return pS(t)?366:365}function H_(t,e){const i=abe(e-1,12)+1,n=t+(e-i)/12;return i===2?pS(n)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function KE(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function EF(t,e,i){return-OV(IV(t,1,e),i)+e-1}function Ey(t,e=4,i=1){const n=EF(t,e,i),r=EF(t+1,e,i);return(jm(t)-n+r)/7}function h1(t){return t>99?t:t>Qn.twoDigitCutoffYear?1900+t:2e3+t}function FG(t,e,i,n=null){const r=new Date(t),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(s.timeZone=n);const o={timeZoneName:e,...s},a=new Intl.DateTimeFormat(i,o).formatToParts(r).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function XE(t,e){let i=parseInt(t,10);Number.isNaN(i)&&(i=0);const n=parseInt(e,10)||0,r=i<0||Object.is(i,-0)?-n:n;return i*60+r}function zG(t){const e=Number(t);if(typeof t=="boolean"||t===""||Number.isNaN(e))throw new go(`Invalid unit value ${t}`);return e}function q_(t,e){const i={};for(const n in t)if(wp(t,n)){const r=t[n];if(r==null)continue;i[e(n)]=zG(r)}return i}function dv(t,e){const i=Math.trunc(Math.abs(t/60)),n=Math.trunc(Math.abs(t%60)),r=t>=0?"+":"-";switch(e){case"short":return`${r}${hr(i,2)}:${hr(n,2)}`;case"narrow":return`${r}${i}${n>0?`:${n}`:""}`;case"techie":return`${r}${hr(i,2)}${hr(n,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function YE(t){return obe(t,["hour","minute","second","millisecond"])}const lbe=["January","February","March","April","May","June","July","August","September","October","November","December"],UG=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],cbe=["J","F","M","A","M","J","J","A","S","O","N","D"];function BG(t){switch(t){case"narrow":return[...cbe];case"short":return[...UG];case"long":return[...lbe];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const jG=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],$G=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],hbe=["M","T","W","T","F","S","S"];function WG(t){switch(t){case"narrow":return[...hbe];case"short":return[...$G];case"long":return[...jG];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const GG=["AM","PM"],ube=["Before Christ","Anno Domini"],dbe=["BC","AD"],fbe=["B","A"];function HG(t){switch(t){case"narrow":return[...fbe];case"short":return[...dbe];case"long":return[...ube];default:return null}}function mbe(t){return GG[t.hour<12?0:1]}function pbe(t,e){return WG(e)[t.weekday-1]}function gbe(t,e){return BG(e)[t.month-1]}function vbe(t,e){return HG(e)[t.year<0?0:1]}function ybe(t,e,i="always",n=!1){const r={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(t)===-1;if(i==="auto"&&s){const h=t==="days";switch(e){case 1:return h?"tomorrow":`next ${r[t][0]}`;case-1:return h?"yesterday":`last ${r[t][0]}`;case 0:return h?"today":`this ${r[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,c=r[t],u=n?l?c[1]:c[2]||c[1]:l?r[t][0]:t;return o?`${a} ${u} ago`:`in ${a} ${u}`}function wF(t,e){let i="";for(const n of t)n.literal?i+=n.val:i+=e(n.val);return i}const Sbe={D:W_,DD:uG,DDD:dG,DDDD:fG,t:mG,tt:pG,ttt:gG,tttt:vG,T:yG,TT:SG,TTT:bG,TTTT:_G,f:PG,ff:wG,fff:xG,ffff:CG,F:EG,FF:TG,FFF:kG,FFFF:MG};class Ps{static create(e,i={}){return new Ps(e,i)}static parseFormat(e){let i=null,n="",r=!1;const s=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?(n.length>0&&s.push({literal:r||/^\s+$/.test(n),val:n}),i=null,n="",r=!r):r||a===i?n+=a:(n.length>0&&s.push({literal:/^\s+$/.test(n),val:n}),n=a,i=a)}return n.length>0&&s.push({literal:r||/^\s+$/.test(n),val:n}),s}static macroTokenToFormatOpts(e){return Sbe[e]}constructor(e,i){this.opts=i,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...i}).format()}dtFormatter(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i})}formatDateTime(e,i){return this.dtFormatter(e,i).format()}formatDateTimeParts(e,i){return this.dtFormatter(e,i).formatToParts()}formatInterval(e,i){return this.dtFormatter(e.start,i).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,i){return this.dtFormatter(e,i).resolvedOptions()}num(e,i=0){if(this.opts.forceSimple)return hr(e,i);const n={...this.opts};return i>0&&(n.padTo=i),this.loc.numberFormatter(n).format(e)}formatDateTimeFromString(e,i){const n=this.loc.listingMode()==="en",r=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(f,m)=>this.loc.extract(e,f,m),o=f=>e.isOffsetFixed&&e.offset===0&&f.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,f.format):"",a=()=>n?mbe(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(f,m)=>n?gbe(e,f):s(m?{month:f}:{month:f,day:"numeric"},"month"),c=(f,m)=>n?pbe(e,f):s(m?{weekday:f}:{weekday:f,month:"long",day:"numeric"},"weekday"),u=f=>{const m=Ps.macroTokenToFormatOpts(f);return m?this.formatWithSystemDefault(e,m):f},h=f=>n?vbe(e,f):s({era:f},"era"),d=f=>{switch(f){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return r?s({day:"numeric"},"day"):this.num(e.day);case"dd":return r?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return r?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return r?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return r?s({month:"numeric"},"month"):this.num(e.month);case"MM":return r?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return r?s({year:"numeric"},"year"):this.num(e.year);case"yy":return r?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return r?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return r?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return u(f)}};return wF(Ps.parseFormat(i),d)}formatDurationFromString(e,i){const n=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},r=l=>c=>{const u=n(c);return u?this.num(l.get(u),c.length):c},s=Ps.parseFormat(i),o=s.reduce((l,{literal:c,val:u})=>c?l:l.concat(u),[]),a=e.shiftTo(...o.map(n).filter(l=>l));return wF(s,r(a))}}const qG=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function ig(...t){const e=t.reduce((i,n)=>i+n.source,"");return RegExp(`^${e}$`)}function ng(...t){return e=>t.reduce(([i,n,r],s)=>{const[o,a,l]=s(e,r);return[{...i,...o},a||n,l]},[{},null,1]).slice(0,2)}function rg(t,...e){if(t==null)return[null,null];for(const[i,n]of e){const r=i.exec(t);if(r)return n(r)}return[null,null]}function KG(...t){return(e,i)=>{const n={};let r;for(r=0;r<t.length;r++)n[t[r]]=Qh(e[i+r]);return[n,null,i+r]}}const XG=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,bbe=`(?:${XG.source}?(?:\\[(${qG.source})\\])?)?`,RV=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,YG=RegExp(`${RV.source}${bbe}`),FV=RegExp(`(?:T${YG.source})?`),_be=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Pbe=/(\d{4})-?W(\d\d)(?:-?(\d))?/,Ebe=/(\d{4})-?(\d{3})/,wbe=KG("weekYear","weekNumber","weekDay"),Tbe=KG("year","ordinal"),xbe=/(\d{4})-(\d\d)-(\d\d)/,ZG=RegExp(`${RV.source} ?(?:${XG.source}|(${qG.source}))?`),kbe=RegExp(`(?: ${ZG.source})?`);function $m(t,e,i){const n=t[e];return ci(n)?i:Qh(n)}function Cbe(t,e){return[{year:$m(t,e),month:$m(t,e+1,1),day:$m(t,e+2,1)},null,e+3]}function sg(t,e){return[{hours:$m(t,e,0),minutes:$m(t,e+1,0),seconds:$m(t,e+2,0),milliseconds:DV(t[e+3])},null,e+4]}function gS(t,e){const i=!t[e]&&!t[e+1],n=XE(t[e+1],t[e+2]),r=i?null:Ys.instance(n);return[{},r,e+3]}function vS(t,e){const i=t[e]?gh.create(t[e]):null;return[{},i,e+1]}const Mbe=RegExp(`^T?${RV.source}$`),Abe=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Vbe(t){const[e,i,n,r,s,o,a,l,c]=t,u=e[0]==="-",h=l&&l[0]==="-",d=(f,m=!1)=>f!==void 0&&(m||f&&u)?-f:f;return[{years:d(nd(i)),months:d(nd(n)),weeks:d(nd(r)),days:d(nd(s)),hours:d(nd(o)),minutes:d(nd(a)),seconds:d(nd(l),l==="-0"),milliseconds:d(DV(c),h)}]}const Lbe={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function zV(t,e,i,n,r,s,o){const a={year:e.length===2?h1(Qh(e)):Qh(e),month:UG.indexOf(i)+1,day:Qh(n),hour:Qh(r),minute:Qh(s)};return o&&(a.second=Qh(o)),t&&(a.weekday=t.length>3?jG.indexOf(t)+1:$G.indexOf(t)+1),a}const Ibe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Obe(t){const[,e,i,n,r,s,o,a,l,c,u,h]=t,d=zV(e,r,n,i,s,o,a);let f;return l?f=Lbe[l]:c?f=0:f=XE(u,h),[d,new Ys(f)]}function Dbe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const Nbe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Rbe=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Fbe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function TF(t){const[,e,i,n,r,s,o,a]=t;return[zV(e,r,n,i,s,o,a),Ys.utcInstance]}function zbe(t){const[,e,i,n,r,s,o,a]=t;return[zV(e,a,i,n,r,s,o),Ys.utcInstance]}const Ube=ig(_be,FV),Bbe=ig(Pbe,FV),jbe=ig(Ebe,FV),$be=ig(YG),JG=ng(Cbe,sg,gS,vS),Wbe=ng(wbe,sg,gS,vS),Gbe=ng(Tbe,sg,gS,vS),Hbe=ng(sg,gS,vS);function qbe(t){return rg(t,[Ube,JG],[Bbe,Wbe],[jbe,Gbe],[$be,Hbe])}function Kbe(t){return rg(Dbe(t),[Ibe,Obe])}function Xbe(t){return rg(t,[Nbe,TF],[Rbe,TF],[Fbe,zbe])}function Ybe(t){return rg(t,[Abe,Vbe])}const Zbe=ng(sg);function Jbe(t){return rg(t,[Mbe,Zbe])}const Qbe=ig(xbe,kbe),e0e=ig(ZG),t0e=ng(sg,gS,vS);function i0e(t){return rg(t,[Qbe,JG],[e0e,t0e])}const xF="Invalid Duration",QG={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},n0e={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...QG},ha=146097/400,Qf=146097/4800,r0e={years:{quarters:4,months:12,weeks:ha/7,days:ha,hours:ha*24,minutes:ha*24*60,seconds:ha*24*60*60,milliseconds:ha*24*60*60*1e3},quarters:{months:3,weeks:ha/28,days:ha/4,hours:ha*24/4,minutes:ha*24*60/4,seconds:ha*24*60*60/4,milliseconds:ha*24*60*60*1e3/4},months:{weeks:Qf/7,days:Qf,hours:Qf*24,minutes:Qf*24*60,seconds:Qf*24*60*60,milliseconds:Qf*24*60*60*1e3},...QG},Pd=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],s0e=Pd.slice(0).reverse();function $h(t,e,i=!1){const n={values:i?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new Ui(n)}function eH(t,e){let i=e.milliseconds??0;for(const n of s0e.slice(1))e[n]&&(i+=e[n]*t[n].milliseconds);return i}function kF(t,e){const i=eH(t,e)<0?-1:1;Pd.reduceRight((n,r)=>{if(ci(e[r]))return n;if(n){const s=e[n]*i,o=t[r][n],a=Math.floor(s/o);e[r]+=a*i,e[n]-=a*o*i}return r},null),Pd.reduce((n,r)=>{if(ci(e[r]))return n;if(n){const s=e[n]%1;e[n]-=s,e[r]+=s*t[n][r]}return r},null)}function o0e(t){const e={};for(const[i,n]of Object.entries(t))n!==0&&(e[i]=n);return e}class Ui{constructor(e){const i=e.conversionAccuracy==="longterm"||!1;let n=i?r0e:n0e;e.matrix&&(n=e.matrix),this.values=e.values,this.loc=e.loc||cn.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=n,this.isLuxonDuration=!0}static fromMillis(e,i){return Ui.fromObject({milliseconds:e},i)}static fromObject(e,i={}){if(e==null||typeof e!="object")throw new go(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Ui({values:q_(e,Ui.normalizeUnit),loc:cn.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(e){if(Od(e))return Ui.fromMillis(e);if(Ui.isDuration(e))return e;if(typeof e=="object")return Ui.fromObject(e);throw new go(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,i){const[n]=Ybe(e);return n?Ui.fromObject(n,i):Ui.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,i){const[n]=Jbe(e);return n?Ui.fromObject(n,i):Ui.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,i=null){if(!e)throw new go("need to specify a reason the Duration is invalid");const n=e instanceof fl?e:new fl(e,i);if(Qn.throwOnInvalid)throw new ISe(n);return new Ui({invalid:n})}static normalizeUnit(e){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!i)throw new hG(e);return i}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,i={}){const n={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?Ps.create(this.loc,n).formatDurationFromString(this,e):xF}toHuman(e={}){if(!this.isValid)return xF;const i=Pd.map(n=>{const r=this.values[n];return ci(r)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:n.slice(0,-1)}).format(r)}).filter(n=>n);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=NV(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const i=this.toMillis();return i<0||i>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},di.fromMillis(i,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?eH(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const i=Ui.fromDurationLike(e),n={};for(const r of Pd)(wp(i.values,r)||wp(this.values,r))&&(n[r]=i.get(r)+this.get(r));return $h(this,{values:n},!0)}minus(e){if(!this.isValid)return this;const i=Ui.fromDurationLike(e);return this.plus(i.negate())}mapUnits(e){if(!this.isValid)return this;const i={};for(const n of Object.keys(this.values))i[n]=zG(e(this.values[n],n));return $h(this,{values:i},!0)}get(e){return this[Ui.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const i={...this.values,...q_(e,Ui.normalizeUnit)};return $h(this,{values:i})}reconfigure({locale:e,numberingSystem:i,conversionAccuracy:n,matrix:r}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:i}),matrix:r,conversionAccuracy:n};return $h(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return kF(this.matrix,e),$h(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=o0e(this.normalize().shiftToAll().toObject());return $h(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>Ui.normalizeUnit(o));const i={},n={},r=this.toObject();let s;for(const o of Pd)if(e.indexOf(o)>=0){s=o;let a=0;for(const c in n)a+=this.matrix[c][o]*n[c],n[c]=0;Od(r[o])&&(a+=r[o]);const l=Math.trunc(a);i[o]=l,n[o]=(a*1e3-l*1e3)/1e3}else Od(r[o])&&(n[o]=r[o]);for(const o in n)n[o]!==0&&(i[s]+=o===s?n[o]:n[o]/this.matrix[s][o]);return kF(this.matrix,i),$h(this,{values:i},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const i of Object.keys(this.values))e[i]=this.values[i]===0?0:-this.values[i];return $h(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function i(n,r){return n===void 0||n===0?r===void 0||r===0:n===r}for(const n of Pd)if(!i(this.values[n],e.values[n]))return!1;return!0}}const em="Invalid Interval";function a0e(t,e){return!t||!t.isValid?Un.invalid("missing or invalid start"):!e||!e.isValid?Un.invalid("missing or invalid end"):e<t?Un.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class Un{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,i=null){if(!e)throw new go("need to specify a reason the Interval is invalid");const n=e instanceof fl?e:new fl(e,i);if(Qn.throwOnInvalid)throw new LSe(n);return new Un({invalid:n})}static fromDateTimes(e,i){const n=Ag(e),r=Ag(i),s=a0e(n,r);return s??new Un({start:n,end:r})}static after(e,i){const n=Ui.fromDurationLike(i),r=Ag(e);return Un.fromDateTimes(r,r.plus(n))}static before(e,i){const n=Ui.fromDurationLike(i),r=Ag(e);return Un.fromDateTimes(r.minus(n),r)}static fromISO(e,i){const[n,r]=(e||"").split("/",2);if(n&&r){let s,o;try{s=di.fromISO(n,i),o=s.isValid}catch{o=!1}let a,l;try{a=di.fromISO(r,i),l=a.isValid}catch{l=!1}if(o&&l)return Un.fromDateTimes(s,a);if(o){const c=Ui.fromISO(r,i);if(c.isValid)return Un.after(s,c)}else if(l){const c=Ui.fromISO(n,i);if(c.isValid)return Un.before(a,c)}}return Un.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",i){if(!this.isValid)return NaN;const n=this.start.startOf(e,i);let r;return i!=null&&i.useLocaleWeeks?r=this.end.reconfigure({locale:n.locale}):r=this.end,r=r.startOf(e,i),Math.floor(r.diff(n,e).get(e))+(r.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:i}={}){return this.isValid?Un.fromDateTimes(e||this.s,i||this.e):this}splitAt(...e){if(!this.isValid)return[];const i=e.map(Ag).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),n=[];let{s:r}=this,s=0;for(;r<this.e;){const o=i[s]||this.e,a=+o>+this.e?this.e:o;n.push(Un.fromDateTimes(r,a)),r=a,s+=1}return n}splitBy(e){const i=Ui.fromDurationLike(e);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:n}=this,r=1,s;const o=[];for(;n<this.e;){const a=this.start.plus(i.mapUnits(l=>l*r));s=+a>+this.e?this.e:a,o.push(Un.fromDateTimes(n,s)),n=s,r+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const i=this.s>e.s?this.s:e.s,n=this.e<e.e?this.e:e.e;return i>=n?null:Un.fromDateTimes(i,n)}union(e){if(!this.isValid)return this;const i=this.s<e.s?this.s:e.s,n=this.e>e.e?this.e:e.e;return Un.fromDateTimes(i,n)}static merge(e){const[i,n]=e.sort((r,s)=>r.s-s.s).reduce(([r,s],o)=>s?s.overlaps(o)||s.abutsStart(o)?[r,s.union(o)]:[r.concat([s]),o]:[r,o],[[],null]);return n&&i.push(n),i}static xor(e){let i=null,n=0;const r=[],s=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...s),a=o.sort((l,c)=>l.time-c.time);for(const l of a)n+=l.type==="s"?1:-1,n===1?i=l.time:(i&&+i!=+l.time&&r.push(Un.fromDateTimes(i,l.time)),i=null);return Un.merge(r)}difference(...e){return Un.xor([this].concat(e)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:em}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=W_,i={}){return this.isValid?Ps.create(this.s.loc.clone(i),e).formatInterval(this):em}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:em}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:em}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:em}toFormat(e,{separator:i="  "}={}){return this.isValid?`${this.s.toFormat(e)}${i}${this.e.toFormat(e)}`:em}toDuration(e,i){return this.isValid?this.e.diff(this.s,e,i):Ui.invalid(this.invalidReason)}mapEndpoints(e){return Un.fromDateTimes(e(this.s),e(this.e))}}class jb{static hasDST(e=Qn.defaultZone){const i=di.now().setZone(e).set({month:12});return!e.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(e){return gh.isValidZone(e)}static normalizeZone(e){return lu(e,Qn.defaultZone)}static getStartOfWeek({locale:e=null,locObj:i=null}={}){return(i||cn.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:i=null}={}){return(i||cn.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:i=null}={}){return(i||cn.create(e)).getWeekendDays().slice()}static months(e="long",{locale:i=null,numberingSystem:n=null,locObj:r=null,outputCalendar:s="gregory"}={}){return(r||cn.create(i,n,s)).months(e)}static monthsFormat(e="long",{locale:i=null,numberingSystem:n=null,locObj:r=null,outputCalendar:s="gregory"}={}){return(r||cn.create(i,n,s)).months(e,!0)}static weekdays(e="long",{locale:i=null,numberingSystem:n=null,locObj:r=null}={}){return(r||cn.create(i,n,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:i=null,numberingSystem:n=null,locObj:r=null}={}){return(r||cn.create(i,n,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return cn.create(e).meridiems()}static eras(e="short",{locale:i=null}={}){return cn.create(i,null,"gregory").eras(e)}static features(){return{relative:NG(),localeWeek:RG()}}}function CF(t,e){const i=r=>r.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),n=i(e)-i(t);return Math.floor(Ui.fromMillis(n).as("days"))}function l0e(t,e,i){const n=[["years",(l,c)=>c.year-l.year],["quarters",(l,c)=>c.quarter-l.quarter+(c.year-l.year)*4],["months",(l,c)=>c.month-l.month+(c.year-l.year)*12],["weeks",(l,c)=>{const u=CF(l,c);return(u-u%7)/7}],["days",CF]],r={},s=t;let o,a;for(const[l,c]of n)i.indexOf(l)>=0&&(o=l,r[l]=c(t,e),a=s.plus(r),a>e?(r[l]--,t=s.plus(r),t>e&&(a=t,r[l]--,t=s.plus(r))):t=a);return[t,r,a,o]}function c0e(t,e,i,n){let[r,s,o,a]=l0e(t,e,i);const l=e-r,c=i.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);c.length===0&&(o<e&&(o=r.plus({[a]:1})),o!==r&&(s[a]=(s[a]||0)+l/(o-r)));const u=Ui.fromObject(s,n);return c.length>0?Ui.fromMillis(l,n).shiftTo(...c).plus(u):u}const UV={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},MF={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},h0e=UV.hanidec.replace(/[\[|\]]/g,"").split("");function u0e(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let i=0;i<t.length;i++){const n=t.charCodeAt(i);if(t[i].search(UV.hanidec)!==-1)e+=h0e.indexOf(t[i]);else for(const r in MF){const[s,o]=MF[r];n>=s&&n<=o&&(e+=n-s)}}return parseInt(e,10)}else return e}function Ja({numberingSystem:t},e=""){return new RegExp(`${UV[t||"latn"]}${e}`)}const d0e="missing Intl.DateTimeFormat.formatToParts support";function Ki(t,e=i=>i){return{regex:t,deser:([i])=>e(u0e(i))}}const f0e=String.fromCharCode(160),tH=`[ ${f0e}]`,iH=new RegExp(tH,"g");function m0e(t){return t.replace(/\./g,"\\.?").replace(iH,tH)}function AF(t){return t.replace(/\./g,"").replace(iH," ").toLowerCase()}function Qa(t,e){return t===null?null:{regex:RegExp(t.map(m0e).join("|")),deser:([i])=>t.findIndex(n=>AF(i)===AF(n))+e}}function VF(t,e){return{regex:t,deser:([,i,n])=>XE(i,n),groups:e}}function $b(t){return{regex:t,deser:([e])=>e}}function p0e(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function g0e(t,e){const i=Ja(e),n=Ja(e,"{2}"),r=Ja(e,"{3}"),s=Ja(e,"{4}"),o=Ja(e,"{6}"),a=Ja(e,"{1,2}"),l=Ja(e,"{1,3}"),c=Ja(e,"{1,6}"),u=Ja(e,"{1,9}"),h=Ja(e,"{2,4}"),d=Ja(e,"{4,6}"),f=v=>({regex:RegExp(p0e(v.val)),deser:([p])=>p,literal:!0}),g=(v=>{if(t.literal)return f(v);switch(v.val){case"G":return Qa(e.eras("short"),0);case"GG":return Qa(e.eras("long"),0);case"y":return Ki(c);case"yy":return Ki(h,h1);case"yyyy":return Ki(s);case"yyyyy":return Ki(d);case"yyyyyy":return Ki(o);case"M":return Ki(a);case"MM":return Ki(n);case"MMM":return Qa(e.months("short",!0),1);case"MMMM":return Qa(e.months("long",!0),1);case"L":return Ki(a);case"LL":return Ki(n);case"LLL":return Qa(e.months("short",!1),1);case"LLLL":return Qa(e.months("long",!1),1);case"d":return Ki(a);case"dd":return Ki(n);case"o":return Ki(l);case"ooo":return Ki(r);case"HH":return Ki(n);case"H":return Ki(a);case"hh":return Ki(n);case"h":return Ki(a);case"mm":return Ki(n);case"m":return Ki(a);case"q":return Ki(a);case"qq":return Ki(n);case"s":return Ki(a);case"ss":return Ki(n);case"S":return Ki(l);case"SSS":return Ki(r);case"u":return $b(u);case"uu":return $b(a);case"uuu":return Ki(i);case"a":return Qa(e.meridiems(),0);case"kkkk":return Ki(s);case"kk":return Ki(h,h1);case"W":return Ki(a);case"WW":return Ki(n);case"E":case"c":return Ki(i);case"EEE":return Qa(e.weekdays("short",!1),1);case"EEEE":return Qa(e.weekdays("long",!1),1);case"ccc":return Qa(e.weekdays("short",!0),1);case"cccc":return Qa(e.weekdays("long",!0),1);case"Z":case"ZZ":return VF(new RegExp(`([+-]${a.source})(?::(${n.source}))?`),2);case"ZZZ":return VF(new RegExp(`([+-]${a.source})(${n.source})?`),2);case"z":return $b(/[a-z_+-/]{1,256}?/i);case" ":return $b(/[^\S\n\r]/);default:return f(v)}})(t)||{invalidReason:d0e};return g.token=t,g}const v0e={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function y0e(t,e,i){const{type:n,value:r}=t;if(n==="literal"){const l=/^\s+$/.test(r);return{literal:!l,val:l?" ":r}}const s=e[n];let o=n;n==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=i.hour12?"hour12":"hour24");let a=v0e[o];if(typeof a=="object"&&(a=a[s]),a)return{literal:!1,val:a}}function S0e(t){return[`^${t.map(i=>i.regex).reduce((i,n)=>`${i}(${n.source})`,"")}$`,t]}function b0e(t,e,i){const n=t.match(e);if(n){const r={};let s=1;for(const o in i)if(wp(i,o)){const a=i[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(r[a.token.val[0]]=a.deser(n.slice(s,s+l))),s+=l}return[n,r]}else return[n,{}]}function _0e(t){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,n;return ci(t.z)||(i=gh.create(t.z)),ci(t.Z)||(i||(i=new Ys(t.Z)),n=t.Z),ci(t.q)||(t.M=(t.q-1)*3+1),ci(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),ci(t.u)||(t.S=DV(t.u)),[Object.keys(t).reduce((s,o)=>{const a=e(o);return a&&(s[a]=t[o]),s},{}),i,n]}let Ex=null;function P0e(){return Ex||(Ex=di.fromMillis(1555555555555)),Ex}function E0e(t,e){if(t.literal)return t;const i=Ps.macroTokenToFormatOpts(t.val),n=sH(i,e);return n==null||n.includes(void 0)?t:n}function nH(t,e){return Array.prototype.concat(...t.map(i=>E0e(i,e)))}function rH(t,e,i){const n=nH(Ps.parseFormat(i),t),r=n.map(o=>g0e(o,t)),s=r.find(o=>o.invalidReason);if(s)return{input:e,tokens:n,invalidReason:s.invalidReason};{const[o,a]=S0e(r),l=RegExp(o,"i"),[c,u]=b0e(e,l,a),[h,d,f]=u?_0e(u):[null,null,void 0];if(wp(u,"a")&&wp(u,"H"))throw new wm("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:n,regex:l,rawMatches:c,matches:u,result:h,zone:d,specificOffset:f}}}function w0e(t,e,i){const{result:n,zone:r,specificOffset:s,invalidReason:o}=rH(t,e,i);return[n,r,s,o]}function sH(t,e){if(!t)return null;const n=Ps.create(e,t).dtFormatter(P0e()),r=n.formatToParts(),s=n.resolvedOptions();return r.map(o=>y0e(o,t,s))}const wx="Invalid DateTime",LF=864e13;function Wb(t){return new fl("unsupported zone",`the zone "${t.name}" is not supported`)}function Tx(t){return t.weekData===null&&(t.weekData=G_(t.c)),t.weekData}function xx(t){return t.localWeekData===null&&(t.localWeekData=G_(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function rd(t,e){const i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new di({...i,...e,old:i})}function oH(t,e,i){let n=t-e*60*1e3;const r=i.offset(n);if(e===r)return[n,e];n-=(r-e)*60*1e3;const s=i.offset(n);return r===s?[n,r]:[t-Math.min(r,s)*60*1e3,Math.max(r,s)]}function Gb(t,e){t+=e*60*1e3;const i=new Date(t);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function I0(t,e,i){return oH(KE(t),e,i)}function IF(t,e){const i=t.o,n=t.c.year+Math.trunc(e.years),r=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...t.c,year:n,month:r,day:Math.min(t.c.day,H_(n,r))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=Ui.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=KE(s);let[l,c]=oH(a,i,t.zone);return o!==0&&(l+=o,c=t.zone.offset(l)),{ts:l,o:c}}function Mg(t,e,i,n,r,s){const{setZone:o,zone:a}=i;if(t&&Object.keys(t).length!==0||e){const l=e||a,c=di.fromObject(t,{...i,zone:l,specificOffset:s});return o?c:c.setZone(a)}else return di.invalid(new fl("unparsable",`the input "${r}" can't be parsed as ${n}`))}function Hb(t,e,i=!0){return t.isValid?Ps.create(cn.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(t,e):null}function kx(t,e){const i=t.c.year>9999||t.c.year<0;let n="";return i&&t.c.year>=0&&(n+="+"),n+=hr(t.c.year,i?6:4),e?(n+="-",n+=hr(t.c.month),n+="-",n+=hr(t.c.day)):(n+=hr(t.c.month),n+=hr(t.c.day)),n}function OF(t,e,i,n,r,s){let o=hr(t.c.hour);return e?(o+=":",o+=hr(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!i)&&(o+=":")):o+=hr(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!i)&&(o+=hr(t.c.second),(t.c.millisecond!==0||!n)&&(o+=".",o+=hr(t.c.millisecond,3))),r&&(t.isOffsetFixed&&t.offset===0&&!s?o+="Z":t.o<0?(o+="-",o+=hr(Math.trunc(-t.o/60)),o+=":",o+=hr(Math.trunc(-t.o%60))):(o+="+",o+=hr(Math.trunc(t.o/60)),o+=":",o+=hr(Math.trunc(t.o%60)))),s&&(o+="["+t.zone.ianaName+"]"),o}const aH={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},T0e={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},x0e={ordinal:1,hour:0,minute:0,second:0,millisecond:0},lH=["year","month","day","hour","minute","second","millisecond"],k0e=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],C0e=["year","ordinal","hour","minute","second","millisecond"];function M0e(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new hG(t);return e}function DF(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return M0e(t)}}function NF(t,e){const i=lu(e.zone,Qn.defaultZone),n=cn.fromObject(e),r=Qn.now();let s,o;if(ci(t.year))s=r;else{for(const c of lH)ci(t[c])&&(t[c]=aH[c]);const a=OG(t)||DG(t);if(a)return di.invalid(a);const l=i.offset(r);[s,o]=I0(t,l,i)}return new di({ts:s,zone:i,loc:n,o})}function RF(t,e,i){const n=ci(i.round)?!0:i.round,r=(o,a)=>(o=NV(o,n||i.calendary?0:2,!0),e.loc.clone(i).relFormatter(i).format(o,a)),s=o=>i.calendary?e.hasSame(t,o)?0:e.startOf(o).diff(t.startOf(o),o).get(o):e.diff(t,o).get(o);if(i.unit)return r(s(i.unit),i.unit);for(const o of i.units){const a=s(o);if(Math.abs(a)>=1)return r(a,o)}return r(t>e?-0:0,i.units[i.units.length-1])}function FF(t){let e={},i;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],i=Array.from(t).slice(0,t.length-1)):i=Array.from(t),[e,i]}class di{constructor(e){const i=e.zone||Qn.defaultZone;let n=e.invalid||(Number.isNaN(e.ts)?new fl("invalid input"):null)||(i.isValid?null:Wb(i));this.ts=ci(e.ts)?Qn.now():e.ts;let r=null,s=null;if(!n)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(i))[r,s]=[e.old.c,e.old.o];else{const a=i.offset(this.ts);r=Gb(this.ts,a),n=Number.isNaN(r.year)?new fl("invalid input"):null,r=n?null:r,s=n?null:a}this._zone=i,this.loc=e.loc||cn.create(),this.invalid=n,this.weekData=null,this.localWeekData=null,this.c=r,this.o=s,this.isLuxonDateTime=!0}static now(){return new di({})}static local(){const[e,i]=FF(arguments),[n,r,s,o,a,l,c]=i;return NF({year:n,month:r,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static utc(){const[e,i]=FF(arguments),[n,r,s,o,a,l,c]=i;return e.zone=Ys.utcInstance,NF({year:n,month:r,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static fromJSDate(e,i={}){const n=rbe(e)?e.valueOf():NaN;if(Number.isNaN(n))return di.invalid("invalid input");const r=lu(i.zone,Qn.defaultZone);return r.isValid?new di({ts:n,zone:r,loc:cn.fromObject(i)}):di.invalid(Wb(r))}static fromMillis(e,i={}){if(Od(e))return e<-LF||e>LF?di.invalid("Timestamp out of range"):new di({ts:e,zone:lu(i.zone,Qn.defaultZone),loc:cn.fromObject(i)});throw new go(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,i={}){if(Od(e))return new di({ts:e*1e3,zone:lu(i.zone,Qn.defaultZone),loc:cn.fromObject(i)});throw new go("fromSeconds requires a numerical input")}static fromObject(e,i={}){e=e||{};const n=lu(i.zone,Qn.defaultZone);if(!n.isValid)return di.invalid(Wb(n));const r=cn.fromObject(i),s=q_(e,DF),{minDaysInFirstWeek:o,startOfWeek:a}=_F(s,r),l=Qn.now(),c=ci(i.specificOffset)?n.offset(l):i.specificOffset,u=!ci(s.ordinal),h=!ci(s.year),d=!ci(s.month)||!ci(s.day),f=h||d,m=s.weekYear||s.weekNumber;if((f||u)&&m)throw new wm("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(d&&u)throw new wm("Can't mix ordinal dates with month/day");const g=m||s.weekday&&!f;let v,p,b=Gb(l,c);g?(v=k0e,p=T0e,b=G_(b,o,a)):u?(v=C0e,p=x0e,b=Px(b)):(v=lH,p=aH);let _=!1;for(const V of v){const N=s[V];ci(N)?_?s[V]=p[V]:s[V]=b[V]:_=!0}const P=g?tbe(s,o,a):u?ibe(s):OG(s),E=P||DG(s);if(E)return di.invalid(E);const T=g?SF(s,o,a):u?bF(s):s,[C,M]=I0(T,c,n),x=new di({ts:C,zone:n,o:M,loc:r});return s.weekday&&f&&e.weekday!==x.weekday?di.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${x.toISO()}`):x}static fromISO(e,i={}){const[n,r]=qbe(e);return Mg(n,r,i,"ISO 8601",e)}static fromRFC2822(e,i={}){const[n,r]=Kbe(e);return Mg(n,r,i,"RFC 2822",e)}static fromHTTP(e,i={}){const[n,r]=Xbe(e);return Mg(n,r,i,"HTTP",i)}static fromFormat(e,i,n={}){if(ci(e)||ci(i))throw new go("fromFormat requires an input string and a format");const{locale:r=null,numberingSystem:s=null}=n,o=cn.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0}),[a,l,c,u]=w0e(o,e,i);return u?di.invalid(u):Mg(a,l,n,`format ${i}`,e,c)}static fromString(e,i,n={}){return di.fromFormat(e,i,n)}static fromSQL(e,i={}){const[n,r]=i0e(e);return Mg(n,r,i,"SQL",e)}static invalid(e,i=null){if(!e)throw new go("need to specify a reason the DateTime is invalid");const n=e instanceof fl?e:new fl(e,i);if(Qn.throwOnInvalid)throw new VSe(n);return new di({invalid:n})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,i={}){const n=sH(e,cn.fromObject(i));return n?n.map(r=>r?r.val:null).join(""):null}static expandFormat(e,i={}){return nH(Ps.parseFormat(e),cn.fromObject(i)).map(r=>r.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Tx(this).weekYear:NaN}get weekNumber(){return this.isValid?Tx(this).weekNumber:NaN}get weekday(){return this.isValid?Tx(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?xx(this).weekday:NaN}get localWeekNumber(){return this.isValid?xx(this).weekNumber:NaN}get localWeekYear(){return this.isValid?xx(this).weekYear:NaN}get ordinal(){return this.isValid?Px(this.c).ordinal:NaN}get monthShort(){return this.isValid?jb.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?jb.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?jb.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?jb.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,i=6e4,n=KE(this.c),r=this.zone.offset(n-e),s=this.zone.offset(n+e),o=this.zone.offset(n-r*i),a=this.zone.offset(n-s*i);if(o===a)return[this];const l=n-o*i,c=n-a*i,u=Gb(l,o),h=Gb(c,a);return u.hour===h.hour&&u.minute===h.minute&&u.second===h.second&&u.millisecond===h.millisecond?[rd(this,{ts:l}),rd(this,{ts:c})]:[this]}get isInLeapYear(){return pS(this.year)}get daysInMonth(){return H_(this.year,this.month)}get daysInYear(){return this.isValid?jm(this.year):NaN}get weeksInWeekYear(){return this.isValid?Ey(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?Ey(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:i,numberingSystem:n,calendar:r}=Ps.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:i,numberingSystem:n,outputCalendar:r}}toUTC(e=0,i={}){return this.setZone(Ys.instance(e),i)}toLocal(){return this.setZone(Qn.defaultZone)}setZone(e,{keepLocalTime:i=!1,keepCalendarTime:n=!1}={}){if(e=lu(e,Qn.defaultZone),e.equals(this.zone))return this;if(e.isValid){let r=this.ts;if(i||n){const s=e.offset(this.ts),o=this.toObject();[r]=I0(o,s,e)}return rd(this,{ts:r,zone:e})}else return di.invalid(Wb(e))}reconfigure({locale:e,numberingSystem:i,outputCalendar:n}={}){const r=this.loc.clone({locale:e,numberingSystem:i,outputCalendar:n});return rd(this,{loc:r})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const i=q_(e,DF),{minDaysInFirstWeek:n,startOfWeek:r}=_F(i,this.loc),s=!ci(i.weekYear)||!ci(i.weekNumber)||!ci(i.weekday),o=!ci(i.ordinal),a=!ci(i.year),l=!ci(i.month)||!ci(i.day),c=a||l,u=i.weekYear||i.weekNumber;if((c||o)&&u)throw new wm("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&o)throw new wm("Can't mix ordinal dates with month/day");let h;s?h=SF({...G_(this.c,n,r),...i},n,r):ci(i.ordinal)?(h={...this.toObject(),...i},ci(i.day)&&(h.day=Math.min(H_(h.year,h.month),h.day))):h=bF({...Px(this.c),...i});const[d,f]=I0(h,this.o,this.zone);return rd(this,{ts:d,o:f})}plus(e){if(!this.isValid)return this;const i=Ui.fromDurationLike(e);return rd(this,IF(this,i))}minus(e){if(!this.isValid)return this;const i=Ui.fromDurationLike(e).negate();return rd(this,IF(this,i))}startOf(e,{useLocaleWeeks:i=!1}={}){if(!this.isValid)return this;const n={},r=Ui.normalizeUnit(e);switch(r){case"years":n.month=1;case"quarters":case"months":n.day=1;case"weeks":case"days":n.hour=0;case"hours":n.minute=0;case"minutes":n.second=0;case"seconds":n.millisecond=0;break}if(r==="weeks")if(i){const s=this.loc.getStartOfWeek(),{weekday:o}=this;o<s&&(n.weekNumber=this.weekNumber-1),n.weekday=s}else n.weekday=1;if(r==="quarters"){const s=Math.ceil(this.month/3);n.month=(s-1)*3+1}return this.set(n)}endOf(e,i){return this.isValid?this.plus({[e]:1}).startOf(e,i).minus(1):this}toFormat(e,i={}){return this.isValid?Ps.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,e):wx}toLocaleString(e=W_,i={}){return this.isValid?Ps.create(this.loc.clone(i),e).formatDateTime(this):wx}toLocaleParts(e={}){return this.isValid?Ps.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:i=!1,suppressMilliseconds:n=!1,includeOffset:r=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const o=e==="extended";let a=kx(this,o);return a+="T",a+=OF(this,o,i,n,r,s),a}toISODate({format:e="extended"}={}){return this.isValid?kx(this,e==="extended"):null}toISOWeekDate(){return Hb(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:i=!1,includeOffset:n=!0,includePrefix:r=!1,extendedZone:s=!1,format:o="extended"}={}){return this.isValid?(r?"T":"")+OF(this,o==="extended",i,e,n,s):null}toRFC2822(){return Hb(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Hb(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?kx(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:i=!1,includeOffsetSpace:n=!0}={}){let r="HH:mm:ss.SSS";return(i||e)&&(n&&(r+=" "),i?r+="z":e&&(r+="ZZ")),Hb(this,r,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():wx}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const i={...this.c};return e.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,i="milliseconds",n={}){if(!this.isValid||!e.isValid)return Ui.invalid("created by diffing an invalid DateTime");const r={locale:this.locale,numberingSystem:this.numberingSystem,...n},s=sbe(i).map(Ui.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,l=o?e:this,c=c0e(a,l,s,r);return o?c.negate():c}diffNow(e="milliseconds",i={}){return this.diff(di.now(),e,i)}until(e){return this.isValid?Un.fromDateTimes(this,e):this}hasSame(e,i,n){if(!this.isValid)return!1;const r=e.valueOf(),s=this.setZone(e.zone,{keepLocalTime:!0});return s.startOf(i,n)<=r&&r<=s.endOf(i,n)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const i=e.base||di.fromObject({},{zone:this.zone}),n=e.padding?this<i?-e.padding:e.padding:0;let r=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(r=e.unit,s=void 0),RF(i,this.plus(n),{...e,numeric:"always",units:r,unit:s})}toRelativeCalendar(e={}){return this.isValid?RF(e.base||di.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(di.isDateTime))throw new go("min requires all arguments be DateTimes");return PF(e,i=>i.valueOf(),Math.min)}static max(...e){if(!e.every(di.isDateTime))throw new go("max requires all arguments be DateTimes");return PF(e,i=>i.valueOf(),Math.max)}static fromFormatExplain(e,i,n={}){const{locale:r=null,numberingSystem:s=null}=n,o=cn.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0});return rH(o,e,i)}static fromStringExplain(e,i,n={}){return di.fromFormatExplain(e,i,n)}static get DATE_SHORT(){return W_}static get DATE_MED(){return uG}static get DATE_MED_WITH_WEEKDAY(){return OSe}static get DATE_FULL(){return dG}static get DATE_HUGE(){return fG}static get TIME_SIMPLE(){return mG}static get TIME_WITH_SECONDS(){return pG}static get TIME_WITH_SHORT_OFFSET(){return gG}static get TIME_WITH_LONG_OFFSET(){return vG}static get TIME_24_SIMPLE(){return yG}static get TIME_24_WITH_SECONDS(){return SG}static get TIME_24_WITH_SHORT_OFFSET(){return bG}static get TIME_24_WITH_LONG_OFFSET(){return _G}static get DATETIME_SHORT(){return PG}static get DATETIME_SHORT_WITH_SECONDS(){return EG}static get DATETIME_MED(){return wG}static get DATETIME_MED_WITH_SECONDS(){return TG}static get DATETIME_MED_WITH_WEEKDAY(){return DSe}static get DATETIME_FULL(){return xG}static get DATETIME_FULL_WITH_SECONDS(){return kG}static get DATETIME_HUGE(){return CG}static get DATETIME_HUGE_WITH_SECONDS(){return MG}}function Ag(t){if(di.isDateTime(t))return t;if(t&&t.valueOf&&Od(t.valueOf()))return di.fromJSDate(t);if(t&&typeof t=="object")return di.fromObject(t);throw new go(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const A0e={id:"earth"},V0e=ri({__name:"EarthLayer",props:{availableWidth:{},availableHeight:{}},setup(t){const{coords:e}=Yge(),{flyTo:i}=XM(),n=t,r=An(),{zoomMagnificationFactor:s,zoomTranslation:o,inverseTotalRotationMatrix:a}=Ji(r);let l=null;const c=new Pt,u=new ire;let h;const d=new Zne,f=new ore(16777215,.2),m=new sre(16777215,1);d.add(f);const g=new NM(S.boundaryCircle.radius,200,200);let v;const p=n.availableHeight/(s.value*2),b=n.availableWidth/(s.value*2),_=new c4(-b,b,p,-p,1,2*S.boundaryCircle.radius*s.value);_.position.z=S.boundaryCircle.radius*Math.max(1.1,s.value),_.position.z=Math.min(b,p),_.updateProjectionMatrix(),_.setViewOffset(n.availableWidth,n.availableHeight,-o.value[0],-o.value[1],n.availableWidth,n.availableHeight),console.debug(`Setting up camera viewport for ${b}x${p}`),ki(async()=>{const[T,C,M]=await Promise.all([u.loadAsync("/earth/earth.jpg"),u.loadAsync("/earth/elevate.jpg"),u.loadAsync("/earth/starfield.jpg")]);console.debug("Promise.all(): Loading all textures done"),d.background=M;const x=new Jne({map:T,bumpMap:C,bumpScale:10});v=new Hc(g,x);const V=Math.max(n.availableHeight,n.availableWidth),N=E();m.position.set(V*Math.cos(N),0,V*Math.sin(N)),v.add(m),v.rotation.x=Math.PI/2,c.copy(a.value).invert(),v.setRotationFromMatrix(c),d.add(v),h=new m4({canvas:document.getElementById("earth")}),h.setSize(n.availableWidth,n.availableHeight),h.setPixelRatio(window.devicePixelRatio),h.setClearColor(0,0),setTimeout(async()=>{!isNaN(e.value.latitude)&&!isNaN(e.value.longitude)&&e.value.latitude!==1/0&&e.value.longitude!==1/0&&await i(e.value.latitude,e.value.longitude)},2e3),P()});function P(){l=requestAnimationFrame(P),h.render(d,_)}He([()=>n.availableWidth,()=>n.availableHeight,()=>s.value],([T,C,M])=>{h&&h.setSize(T,C);const x=T/(M*2),V=C/(M*2);_.left=-x,_.right=x,_.top=V,_.bottom=-V,_.far=2*S.boundaryCircle.radius*M,_.position.z=S.boundaryCircle.radius*Math.max(1.1,M),_.updateProjectionMatrix()}),He(()=>a.value.elements,()=>{c.copy(a.value).invert(),v.setRotationFromMatrix(c)},{deep:!0}),He(()=>o.value,T=>{_.setViewOffset(n.availableWidth,n.availableHeight,-T[0],-T[1],n.availableWidth,n.availableHeight)},{deep:!0}),an(()=>{l!=null&&cancelAnimationFrame(l)});function E(){const T=di.now(),C=T.toUTC();console.debug("Time now is ",T.toISOTime(),C.toISOTime());const M=C.minute+60*(C.hour-12),x=M/4;return console.debug("Number of UTC elapse minutes",M,"Sun estimate longitude",x),x*Math.PI/180}return(T,C)=>(Te(),Ct("canvas",A0e))}});const L0e=Tn(V0e,[["__scopeId","data-v-4d27cb62"]]);const I0e=Qd("v-alert-title"),O0e=["success","info","warning","error"],D0e=We({border:{type:[Boolean,String],validator:t=>typeof t=="boolean"||["top","end","bottom","start"].includes(t)},borderColor:String,closable:Boolean,closeIcon:{type:ji,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:t=>O0e.includes(t)},...Ut(),...Ba(),...bh(),...Tl(),...rf(),...Oy(),...cs(),...pn(),...wn(),...bc({variant:"flat"})},"VAlert"),qb=vt()({name:"VAlert",props:D0e(),emits:{"click:close":t=>!0,"update:modelValue":t=>!0},setup(t,e){let{emit:i,slots:n}=e;const r=Oi(t,"modelValue"),s=W(()=>{if(t.icon!==!1)return t.type?t.icon??`$${t.type}`:t.icon}),o=W(()=>({color:t.color??t.type,variant:t.variant})),{themeClasses:a}=Hn(t),{colorClasses:l,colorStyles:c,variantClasses:u}=tf(o),{densityClasses:h}=wl(t),{dimensionStyles:d}=_h(t),{elevationClasses:f}=xl(t),{locationStyles:m}=sf(t),{positionClasses:g}=Dy(t),{roundedClasses:v}=hs(t),{textColorClasses:p,textColorStyles:b}=ko(bt(t,"borderColor")),{t:_}=nf(),P=W(()=>({"aria-label":_(t.closeLabel),onClick(E){r.value=!1,i("click:close",E)}}));return()=>{const E=!!(n.prepend||s.value),T=!!(n.title||t.title),C=!!(n.close||t.closable);return r.value&&w(t.tag,{class:["v-alert",t.border&&{"v-alert--border":!!t.border,[`v-alert--border-${t.border===!0?"start":t.border}`]:!0},{"v-alert--prominent":t.prominent},a.value,l.value,h.value,f.value,g.value,v.value,u.value,t.class],style:[c.value,d.value,m.value,t.style],role:"alert"},{default:()=>{var M,x;return[ef(!1,"v-alert"),t.border&&w("div",{key:"border",class:["v-alert__border",p.value],style:b.value},null),E&&w("div",{key:"prepend",class:"v-alert__prepend"},[n.prepend?w(rr,{key:"prepend-defaults",disabled:!s.value,defaults:{VIcon:{density:t.density,icon:s.value,size:t.prominent?44:28}}},n.prepend):w(lt,{key:"prepend-icon",density:t.density,icon:s.value,size:t.prominent?44:28},null)]),w("div",{class:"v-alert__content"},[T&&w(I0e,{key:"title"},{default:()=>{var V;return[((V=n.title)==null?void 0:V.call(n))??t.title]}}),((M=n.text)==null?void 0:M.call(n))??t.text,(x=n.default)==null?void 0:x.call(n)]),n.append&&w("div",{key:"append",class:"v-alert__append"},[n.append()]),C&&w("div",{key:"close",class:"v-alert__close"},[n.close?w(rr,{key:"close-defaults",defaults:{VBtn:{icon:t.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var V;return[(V=n.close)==null?void 0:V.call(n,{props:P.value})]}}):w(Qt,ht({key:"close-btn",icon:t.closeIcon,size:"x-small",variant:"text"},P.value),null)])]}})}}});const N0e=We({bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:ji,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...Ut(),...rf({location:"top end"}),...cs(),...pn(),...wn(),...af({transition:"scale-rotate-transition"})},"VBadge"),Cx=vt()({name:"VBadge",inheritAttrs:!1,props:N0e(),setup(t,e){const{backgroundColorClasses:i,backgroundColorStyles:n}=Cs(bt(t,"color")),{roundedClasses:r}=hs(t),{t:s}=nf(),{textColorClasses:o,textColorStyles:a}=ko(bt(t,"textColor")),{themeClasses:l}=D7(),{locationStyles:c}=sf(t,!0,u=>(t.floating?t.dot?2:4:t.dot?8:12)+(["top","bottom"].includes(u)?+(t.offsetY??0):["left","right"].includes(u)?+(t.offsetX??0):0));return Tt(()=>{const u=Number(t.content),h=!t.max||isNaN(u)?t.content:u<=+t.max?u:`${t.max}+`,[d,f]=tk(e.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return w(t.tag,ht({class:["v-badge",{"v-badge--bordered":t.bordered,"v-badge--dot":t.dot,"v-badge--floating":t.floating,"v-badge--inline":t.inline},t.class]},f,{style:t.style}),{default:()=>{var m,g;return[w("div",{class:"v-badge__wrapper"},[(g=(m=e.slots).default)==null?void 0:g.call(m),w(Gl,{transition:t.transition},{default:()=>{var v,p;return[fi(w("span",ht({class:["v-badge__badge",l.value,i.value,r.value,o.value],style:[n.value,a.value,t.inline?{}:c.value],"aria-atomic":"true","aria-label":s(t.label,u),"aria-live":"polite",role:"status"},d),[t.dot?void 0:e.slots.badge?(p=(v=e.slots).badge)==null?void 0:p.call(v):t.icon?w(lt,{icon:t.icon},null):h]),[[ln,t.modelValue]])]}})])]}})}),{}}}),R0e={id:"msghub"},F0e={style:{display:"flex"}},zF=3e3,BV=ri({__name:"MessageHub",setup(t){const{t:e}=qn({useScope:"local"}),i=ge(!1),n=ge(!0),r=ge(!1),s=ge(!1),o=ge(!0),a=W(()=>S.messageTypes.map(E=>({value:E,title:e(E)}))),l=ge(a.value.map(E=>E.value)),c=ge([]);let u;ki(()=>{$.listen("show-alert",p)}),He(()=>l.value,E=>{E.length!==S.messageTypes.length&&(o.value=!1)});function h(){o.value&&(l.value.splice(0),l.value.push(...S.messageTypes))}const d=W(()=>v.value.length>0?v.value[0]:null);function f(E){return E.type==="directive"?"mdi-lightbulb":E.type}function m(E){return E.type==="directive"?"success":E.type}function g(E){let T=e(E.key,E.keyOptions);return E.secondaryMsg&&(T=T.concat(": "+e(E.secondaryMsg,E.secondaryMsgKeyOptions))),T}const v=W(()=>l.value.length===S.messageTypes.length?c.value:c.value.filter(E=>l.value.includes(E.type)));function p(E){E.timestamp=Date.now(),c.value.unshift(E)}function b(E){c.value.splice(E,1),r.value&&c.value.length===0&&(r.value=!1)}function _(){s.value=!0,u=setTimeout(()=>{c.value.splice(0),u=null},zF)}function P(){u&&(clearTimeout(u),u=null),s.value=!1}return(E,T)=>{const C=Mo("t");return Te(),Ct(mt,null,[tt("div",R0e,[w(Ph,{class:"pa-0"},{default:U(()=>[w(pr,{justify:"center",align:"center",class:"ma-0"},{default:U(()=>[w(Si,{cols:"auto",class:"pa-0"},{default:U(()=>[w(Qt,{icon:"",size:"small",variant:"text",onClick:T[0]||(T[0]=M=>n.value=!n.value)},{default:U(()=>[n.value?(Te(),qe(lt,{key:0},{default:U(()=>[$e("mdi-bell")],void 0,!0),_:1})):(Te(),qe(lt,{key:1},{default:U(()=>[$e("mdi-bell-off")],void 0,!0),_:1}))],void 0,!0),_:1})],void 0,!0),_:1}),w(Si,{cols:"auto"},{default:U(()=>[l.value.length!==a.value.length?(Te(),qe(Cx,{key:0,content:l.value.length},{default:U(()=>[w(lt,{id:"filter-menu-popup"},{default:U(()=>[$e("mdi-filter")],void 0,!0),_:1})],void 0,!0),_:1},8,["content"])):(Te(),qe(lt,{key:1,id:"filter-menu-popup"},{default:U(()=>[$e("mdi-filter")],void 0,!0),_:1})),l.value.length!==a.value.length?(Te(),qe(dr,{key:2,activator:"#filter-menu-popup"},{default:U(()=>[$e(nt(l.value.map(M=>M.toUpperCase()).join(", ")),1)],void 0,!0),_:1})):Vi("",!0),w(Ep,{modelValue:i.value,"onUpdate:modelValue":T[4]||(T[4]=M=>i.value=M),activator:"#filter-menu-popup","close-on-content-click":!1,location:"top",offset:"32"},{default:U(()=>[w(uc,{class:"pa-1"},{default:U(()=>[fi(w(gP,null,null,512),[[C,"selectMsgType"]]),w(lh,null,{default:U(()=>[w(Py,{label:le(e)("selectAll"),modelValue:o.value,"onUpdate:modelValue":[T[1]||(T[1]=M=>o.value=M),h]},null,8,["label","modelValue"]),tt("div",F0e,[(Te(!0),Ct(mt,null,Zs(a.value,M=>(Te(),qe(Py,{modelValue:l.value,"onUpdate:modelValue":T[2]||(T[2]=x=>l.value=x),class:"mx-2",value:M.value,label:M.title,density:"compact",direction:"horizontal"},null,8,["modelValue","value","label"]))),256))])],void 0,!0),_:1}),w(Op,null,{default:U(()=>[w(Ry),w(Qt,{variant:"outlined",density:"comfortable",onClick:T[3]||(T[3]=M=>i.value=!1)},{default:U(()=>[$e(" OK ")],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1},8,["modelValue"])],void 0,!0),_:1}),w(Si,{id:"msg-display-area",class:"pa-0 ma-0"},{default:U(()=>[n.value?(Te(),qe(Pq,{key:0},{default:U(()=>[d.value?(Te(),qe(qb,{key:d.value.key,class:"my-1 py-0",border:"end",variant:"outlined","border-color":m(d.value),type:m(d.value),density:"compact",closable:"",icon:d.value.type,text:g(d.value),"onUpdate:modelValue":T[5]||(T[5]=M=>b(0))},null,8,["border-color","type","icon","text"])):(Te(),qe(qb,{key:1,text:le(e)("noMessages")},null,8,["text"]))],void 0,!0),_:1})):(Te(),qe(qb,{key:1,transition:"fade-transition",color:"grey",text:le(e)("msgDisabled"),class:"text-white"},null,8,["text"]))],void 0,!0),_:1}),w(Si,{cols:"auto",class:"pa-0"},{default:U(()=>[w(Ep,{modelValue:r.value,"onUpdate:modelValue":T[6]||(T[6]=M=>r.value=M),activator:"#msg-popup","close-on-content-click":!1,location:"top",contained:""},{default:U(()=>[w(uc,{class:"bg-white","max-width":600},{default:U(()=>[w(lh,null,{default:U(()=>[(Te(!0),Ct(mt,null,Zs(v.value,(M,x)=>(Te(),qe(qb,{class:"my-1 py-0",border:"end",variant:"outlined","border-color":m(M),key:`${M.key}-${x}`,density:"compact",closable:"",icon:f(M),type:m(M),text:g(M),"onUpdate:modelValue":V=>b(x)},null,8,["border-color","icon","type","text","onUpdate:modelValue"]))),128))],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1},8,["modelValue"]),w(Qt,{id:"msg-popup",flat:"",icon:"",disabled:v.value.length==0,size:"small"},{default:U(()=>[r.value?(Te(),qe(lt,{key:0},{default:U(()=>[$e("mdi-triangle-down")],void 0,!0),_:1})):v.value.length>1?(Te(),qe(Cx,{key:1,content:v.value.length},{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-triangle")],void 0,!0),_:1})],void 0,!0),_:1},8,["content"])):(Te(),qe(lt,{key:2},{default:U(()=>[$e("mdi-triangle")],void 0,!0),_:1}))],void 0,!0),_:1},8,["disabled"])],void 0,!0),_:1}),w(Si,{cols:"auto",class:"pa-0 mx-1"},{default:U(()=>[w(Qt,{flat:"",icon:"",size:"small",disabled:c.value.length===0,onClick:_},{default:U(()=>[c.value.length>0?(Te(),qe(Cx,{key:0,content:c.value.length},{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-trash-can")],void 0,!0),_:1})],void 0,!0),_:1},8,["content"])):(Te(),qe(lt,{key:1},{default:U(()=>[$e("mdi-trash-can")],void 0,!0),_:1}))],void 0,!0),_:1},8,["disabled"])],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1})]),w(CV,{modelValue:s.value,"onUpdate:modelValue":T[7]||(T[7]=M=>s.value=M),timeout:zF},{actions:U(()=>[w(Qt,{onClick:P,color:"warning"},{default:U(()=>[$e(nt(le(e)("undo")),1)],void 0,!0),_:1})]),default:U(()=>[$e(nt(le(e)("deleteWarning"))+" ",1)],void 0),_:1},8,["modelValue"])],64)}}});function UF(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{all:i=>{const{normalize:n}=i;return n(["All"])},deleteMsg:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Delete ",r(s("msgType"))," messages"])},deleteWarning:i=>{const{normalize:n}=i;return n(["Messages will be deleted"])},directive:i=>{const{normalize:n}=i;return n(["Directive"])},error:i=>{const{normalize:n}=i;return n(["Error"])},info:i=>{const{normalize:n}=i;return n(["Informational"])},noMessages:i=>{const{normalize:n}=i;return n(["No messages"])},msgDisabled:i=>{const{normalize:n}=i;return n(["(Messages disabled)"])},selectAll:i=>{const{normalize:n}=i;return n(["Select All Type"])},selectMsgType:i=>{const{normalize:n}=i;return n(["Select Message Type"])},success:i=>{const{normalize:n}=i;return n(["Success"])},undo:i=>{const{normalize:n}=i;return n(["Undo"])},warning:i=>{const{normalize:n}=i;return n(["Warning"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"all":"All","deleteMsg":"Delete {msgType} messages","deleteWarning":"Messages will be deleted","directive":"Directive","error":"Error","info":"Informational","noMessages":"No messages","msgDisabled":"(Messages disabled)","selectAll":"Select All Type","selectMsgType":"Select Message Type","success":"Success","undo":"Undo","warning":"Warning"}}'),delete e._Ctor}function BF(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"id",resource:{all:i=>{const{normalize:n}=i;return n(["Semua Pesan"])},deleteMsg:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Hapus Pesan Jenis ",r(s("msgType"))])},deleteWarning:i=>{const{normalize:n}=i;return n(["Pesan-pesan akan dihapus"])},directive:i=>{const{normalize:n}=i;return n(["Petunjuk"])},error:i=>{const{normalize:n}=i;return n(["Kesalahan"])},info:i=>{const{normalize:n}=i;return n(["Informasional"])},noMessages:i=>{const{normalize:n}=i;return n(["Tidak ada pesan"])},selectAll:i=>{const{normalize:n}=i;return n(["Pilih semua jenis pesan"])},selectMsgType:i=>{const{normalize:n}=i;return n(["Pilih Jenis Pesan"])},success:i=>{const{normalize:n}=i;return n(["Sukses"])},undo:i=>{const{normalize:n}=i;return n(["Urung"])},warning:i=>{const{normalize:n}=i;return n(["Peringatan"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"id":{"all":"Semua Pesan","deleteMsg":"Hapus Pesan Jenis {msgType}","deleteWarning":"Pesan-pesan akan dihapus","directive":"Petunjuk","error":"Kesalahan","info":"Informasional","noMessages":"Tidak ada pesan","selectAll":"Pilih semua jenis pesan","selectMsgType":"Pilih Jenis Pesan","success":"Sukses","undo":"Urung","warning":"Peringatan"}}'),delete e._Ctor}typeof UF=="function"&&UF(BV);typeof BF=="function"&&BF(BV);const z0e=Tn(BV,[["__scopeId","data-v-6c316cca"]]),U0e={key:0,class:"text-subtitle-2",style:{color:"red"}},B0e=ri({__name:"SimpleNumberSelector",props:{modelValue:{},title:{},thumbStringValues:{},numSelected:{},conflict:{type:Boolean}},emits:["update:modelValue"],setup(t,{emit:e}){const i=q1();let n=t;const r=e,s=ge(n.modelValue);function o(c){if(n.thumbStringValues.length>0){const u=Number((i==null?void 0:i.min)??0),h=Number((i==null?void 0:i.step)??1);return n.thumbStringValues[Math.floor((c-u)/h)]??"NaN"}return"Yes"}function a(){const c=Number(i==null?void 0:i.step);console.debug("Increase slider by",c),s.value+=c,r("update:modelValue",s.value)}function l(){s.value-=Number((i==null?void 0:i.step)??1),r("update:modelValue",s.value)}return(c,u)=>(Te(),Ct("div",null,[tt("span",{class:"text-subtitle-2",style:mr({color:c.conflict?"red":""})},nt(c.title+" ("+o(le(n).modelValue??0)+")"),5),c.numSelected>1?(Te(),Ct("span",U0e,nt(" "+c.$t("style.labelStyleOptionsMultiple")),1)):Vi("",!0),w(hp,ht(le(i),{modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=h=>s.value=h),"thumb-label":"","show-ticks":""}),{prepend:U(()=>[w(lt,{onClick:l},{default:U(()=>[$e("mdi-minus")],void 0,!0),_:1})]),append:U(()=>[w(lt,{onClick:a},{default:U(()=>[$e("mdi-plus")],void 0,!0),_:1})]),"thumb-label":U(({modelValue:h})=>[tt("span",null,nt(o(h)),1)]),_:1},16,["modelValue"])]))}});const fv=Tn(B0e,[["__scopeId","data-v-71d1ff11"]]);var cH={exports:{}},hH={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},uH={exports:{}},j0e=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},$0e=j0e,W0e=Array.prototype.concat,G0e=Array.prototype.slice,jF=uH.exports=function(e){for(var i=[],n=0,r=e.length;n<r;n++){var s=e[n];$0e(s)?i=W0e.call(i,G0e.call(s)):i.push(s)}return i};jF.wrap=function(t){return function(){return t(jF(arguments))}};var H0e=uH.exports,mv=hH,yS=H0e,dH=Object.hasOwnProperty,fH=Object.create(null);for(var Mx in mv)dH.call(mv,Mx)&&(fH[mv[Mx]]=Mx);var Jo=cH.exports={to:{},get:{}};Jo.get=function(t){var e=t.substring(0,3).toLowerCase(),i,n;switch(e){case"hsl":i=Jo.get.hsl(t),n="hsl";break;case"hwb":i=Jo.get.hwb(t),n="hwb";break;default:i=Jo.get.rgb(t),n="rgb";break}return i?{model:n,value:i}:null};Jo.get.rgb=function(t){if(!t)return null;var e=/^#([a-f0-9]{3,4})$/i,i=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,n=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,r=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,s=/^(\w+)$/,o=[0,0,0,1],a,l,c;if(a=t.match(i)){for(c=a[2],a=a[1],l=0;l<3;l++){var u=l*2;o[l]=parseInt(a.slice(u,u+2),16)}c&&(o[3]=parseInt(c,16)/255)}else if(a=t.match(e)){for(a=a[1],c=a[3],l=0;l<3;l++)o[l]=parseInt(a[l]+a[l],16);c&&(o[3]=parseInt(c+c,16)/255)}else if(a=t.match(n)){for(l=0;l<3;l++)o[l]=parseInt(a[l+1],0);a[4]&&(a[5]?o[3]=parseFloat(a[4])*.01:o[3]=parseFloat(a[4]))}else if(a=t.match(r)){for(l=0;l<3;l++)o[l]=Math.round(parseFloat(a[l+1])*2.55);a[4]&&(a[5]?o[3]=parseFloat(a[4])*.01:o[3]=parseFloat(a[4]))}else return(a=t.match(s))?a[1]==="transparent"?[0,0,0,0]:dH.call(mv,a[1])?(o=mv[a[1]],o[3]=1,o):null:null;for(l=0;l<3;l++)o[l]=Eu(o[l],0,255);return o[3]=Eu(o[3],0,1),o};Jo.get.hsl=function(t){if(!t)return null;var e=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,i=t.match(e);if(i){var n=parseFloat(i[4]),r=(parseFloat(i[1])%360+360)%360,s=Eu(parseFloat(i[2]),0,100),o=Eu(parseFloat(i[3]),0,100),a=Eu(isNaN(n)?1:n,0,1);return[r,s,o,a]}return null};Jo.get.hwb=function(t){if(!t)return null;var e=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,i=t.match(e);if(i){var n=parseFloat(i[4]),r=(parseFloat(i[1])%360+360)%360,s=Eu(parseFloat(i[2]),0,100),o=Eu(parseFloat(i[3]),0,100),a=Eu(isNaN(n)?1:n,0,1);return[r,s,o,a]}return null};Jo.to.hex=function(){var t=yS(arguments);return"#"+Kb(t[0])+Kb(t[1])+Kb(t[2])+(t[3]<1?Kb(Math.round(t[3]*255)):"")};Jo.to.rgb=function(){var t=yS(arguments);return t.length<4||t[3]===1?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"};Jo.to.rgb.percent=function(){var t=yS(arguments),e=Math.round(t[0]/255*100),i=Math.round(t[1]/255*100),n=Math.round(t[2]/255*100);return t.length<4||t[3]===1?"rgb("+e+"%, "+i+"%, "+n+"%)":"rgba("+e+"%, "+i+"%, "+n+"%, "+t[3]+")"};Jo.to.hsl=function(){var t=yS(arguments);return t.length<4||t[3]===1?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"};Jo.to.hwb=function(){var t=yS(arguments),e="";return t.length>=4&&t[3]!==1&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"};Jo.to.keyword=function(t){return fH[t.slice(0,3)]};function Eu(t,e,i){return Math.min(Math.max(e,t),i)}function Kb(t){var e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}var q0e=cH.exports;const wy=hH,mH={};for(const t of Object.keys(wy))mH[wy[t]]=t;const At={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var pH=At;for(const t of Object.keys(At)){if(!("channels"in At[t]))throw new Error("missing channels property: "+t);if(!("labels"in At[t]))throw new Error("missing channel labels property: "+t);if(At[t].labels.length!==At[t].channels)throw new Error("channel and label counts mismatch: "+t);const{channels:e,labels:i}=At[t];delete At[t].channels,delete At[t].labels,Object.defineProperty(At[t],"channels",{value:e}),Object.defineProperty(At[t],"labels",{value:i})}At.rgb.hsl=function(t){const e=t[0]/255,i=t[1]/255,n=t[2]/255,r=Math.min(e,i,n),s=Math.max(e,i,n),o=s-r;let a,l;s===r?a=0:e===s?a=(i-n)/o:i===s?a=2+(n-e)/o:n===s&&(a=4+(e-i)/o),a=Math.min(a*60,360),a<0&&(a+=360);const c=(r+s)/2;return s===r?l=0:c<=.5?l=o/(s+r):l=o/(2-s-r),[a,l*100,c*100]};At.rgb.hsv=function(t){let e,i,n,r,s;const o=t[0]/255,a=t[1]/255,l=t[2]/255,c=Math.max(o,a,l),u=c-Math.min(o,a,l),h=function(d){return(c-d)/6/u+1/2};return u===0?(r=0,s=0):(s=u/c,e=h(o),i=h(a),n=h(l),o===c?r=n-i:a===c?r=1/3+e-n:l===c&&(r=2/3+i-e),r<0?r+=1:r>1&&(r-=1)),[r*360,s*100,c*100]};At.rgb.hwb=function(t){const e=t[0],i=t[1];let n=t[2];const r=At.rgb.hsl(t)[0],s=1/255*Math.min(e,Math.min(i,n));return n=1-1/255*Math.max(e,Math.max(i,n)),[r,s*100,n*100]};At.rgb.cmyk=function(t){const e=t[0]/255,i=t[1]/255,n=t[2]/255,r=Math.min(1-e,1-i,1-n),s=(1-e-r)/(1-r)||0,o=(1-i-r)/(1-r)||0,a=(1-n-r)/(1-r)||0;return[s*100,o*100,a*100,r*100]};function K0e(t,e){return(t[0]-e[0])**2+(t[1]-e[1])**2+(t[2]-e[2])**2}At.rgb.keyword=function(t){const e=mH[t];if(e)return e;let i=1/0,n;for(const r of Object.keys(wy)){const s=wy[r],o=K0e(t,s);o<i&&(i=o,n=r)}return n};At.keyword.rgb=function(t){return wy[t]};At.rgb.xyz=function(t){let e=t[0]/255,i=t[1]/255,n=t[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92;const r=e*.4124+i*.3576+n*.1805,s=e*.2126+i*.7152+n*.0722,o=e*.0193+i*.1192+n*.9505;return[r*100,s*100,o*100]};At.rgb.lab=function(t){const e=At.rgb.xyz(t);let i=e[0],n=e[1],r=e[2];i/=95.047,n/=100,r/=108.883,i=i>.008856?i**(1/3):7.787*i+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116;const s=116*n-16,o=500*(i-n),a=200*(n-r);return[s,o,a]};At.hsl.rgb=function(t){const e=t[0]/360,i=t[1]/100,n=t[2]/100;let r,s,o;if(i===0)return o=n*255,[o,o,o];n<.5?r=n*(1+i):r=n+i-n*i;const a=2*n-r,l=[0,0,0];for(let c=0;c<3;c++)s=e+1/3*-(c-1),s<0&&s++,s>1&&s--,6*s<1?o=a+(r-a)*6*s:2*s<1?o=r:3*s<2?o=a+(r-a)*(2/3-s)*6:o=a,l[c]=o*255;return l};At.hsl.hsv=function(t){const e=t[0];let i=t[1]/100,n=t[2]/100,r=i;const s=Math.max(n,.01);n*=2,i*=n<=1?n:2-n,r*=s<=1?s:2-s;const o=(n+i)/2,a=n===0?2*r/(s+r):2*i/(n+i);return[e,a*100,o*100]};At.hsv.rgb=function(t){const e=t[0]/60,i=t[1]/100;let n=t[2]/100;const r=Math.floor(e)%6,s=e-Math.floor(e),o=255*n*(1-i),a=255*n*(1-i*s),l=255*n*(1-i*(1-s));switch(n*=255,r){case 0:return[n,l,o];case 1:return[a,n,o];case 2:return[o,n,l];case 3:return[o,a,n];case 4:return[l,o,n];case 5:return[n,o,a]}};At.hsv.hsl=function(t){const e=t[0],i=t[1]/100,n=t[2]/100,r=Math.max(n,.01);let s,o;o=(2-i)*n;const a=(2-i)*r;return s=i*r,s/=a<=1?a:2-a,s=s||0,o/=2,[e,s*100,o*100]};At.hwb.rgb=function(t){const e=t[0]/360;let i=t[1]/100,n=t[2]/100;const r=i+n;let s;r>1&&(i/=r,n/=r);const o=Math.floor(6*e),a=1-n;s=6*e-o,o&1&&(s=1-s);const l=i+s*(a-i);let c,u,h;switch(o){default:case 6:case 0:c=a,u=l,h=i;break;case 1:c=l,u=a,h=i;break;case 2:c=i,u=a,h=l;break;case 3:c=i,u=l,h=a;break;case 4:c=l,u=i,h=a;break;case 5:c=a,u=i,h=l;break}return[c*255,u*255,h*255]};At.cmyk.rgb=function(t){const e=t[0]/100,i=t[1]/100,n=t[2]/100,r=t[3]/100,s=1-Math.min(1,e*(1-r)+r),o=1-Math.min(1,i*(1-r)+r),a=1-Math.min(1,n*(1-r)+r);return[s*255,o*255,a*255]};At.xyz.rgb=function(t){const e=t[0]/100,i=t[1]/100,n=t[2]/100;let r,s,o;return r=e*3.2406+i*-1.5372+n*-.4986,s=e*-.9689+i*1.8758+n*.0415,o=e*.0557+i*-.204+n*1.057,r=r>.0031308?1.055*r**(1/2.4)-.055:r*12.92,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,r=Math.min(Math.max(0,r),1),s=Math.min(Math.max(0,s),1),o=Math.min(Math.max(0,o),1),[r*255,s*255,o*255]};At.xyz.lab=function(t){let e=t[0],i=t[1],n=t[2];e/=95.047,i/=100,n/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;const r=116*i-16,s=500*(e-i),o=200*(i-n);return[r,s,o]};At.lab.xyz=function(t){const e=t[0],i=t[1],n=t[2];let r,s,o;s=(e+16)/116,r=i/500+s,o=s-n/200;const a=s**3,l=r**3,c=o**3;return s=a>.008856?a:(s-16/116)/7.787,r=l>.008856?l:(r-16/116)/7.787,o=c>.008856?c:(o-16/116)/7.787,r*=95.047,s*=100,o*=108.883,[r,s,o]};At.lab.lch=function(t){const e=t[0],i=t[1],n=t[2];let r;r=Math.atan2(n,i)*360/2/Math.PI,r<0&&(r+=360);const o=Math.sqrt(i*i+n*n);return[e,o,r]};At.lch.lab=function(t){const e=t[0],i=t[1],r=t[2]/360*2*Math.PI,s=i*Math.cos(r),o=i*Math.sin(r);return[e,s,o]};At.rgb.ansi16=function(t,e=null){const[i,n,r]=t;let s=e===null?At.rgb.hsv(t)[2]:e;if(s=Math.round(s/50),s===0)return 30;let o=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(i/255));return s===2&&(o+=60),o};At.hsv.ansi16=function(t){return At.rgb.ansi16(At.hsv.rgb(t),t[2])};At.rgb.ansi256=function(t){const e=t[0],i=t[1],n=t[2];return e===i&&i===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(i/255*5)+Math.round(n/255*5)};At.ansi16.rgb=function(t){let e=t%10;if(e===0||e===7)return t>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const i=(~~(t>50)+1)*.5,n=(e&1)*i*255,r=(e>>1&1)*i*255,s=(e>>2&1)*i*255;return[n,r,s]};At.ansi256.rgb=function(t){if(t>=232){const s=(t-232)*10+8;return[s,s,s]}t-=16;let e;const i=Math.floor(t/36)/5*255,n=Math.floor((e=t%36)/6)/5*255,r=e%6/5*255;return[i,n,r]};At.rgb.hex=function(t){const i=(((Math.round(t[0])&255)<<16)+((Math.round(t[1])&255)<<8)+(Math.round(t[2])&255)).toString(16).toUpperCase();return"000000".substring(i.length)+i};At.hex.rgb=function(t){const e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let i=e[0];e[0].length===3&&(i=i.split("").map(a=>a+a).join(""));const n=parseInt(i,16),r=n>>16&255,s=n>>8&255,o=n&255;return[r,s,o]};At.rgb.hcg=function(t){const e=t[0]/255,i=t[1]/255,n=t[2]/255,r=Math.max(Math.max(e,i),n),s=Math.min(Math.min(e,i),n),o=r-s;let a,l;return o<1?a=s/(1-o):a=0,o<=0?l=0:r===e?l=(i-n)/o%6:r===i?l=2+(n-e)/o:l=4+(e-i)/o,l/=6,l%=1,[l*360,o*100,a*100]};At.hsl.hcg=function(t){const e=t[1]/100,i=t[2]/100,n=i<.5?2*e*i:2*e*(1-i);let r=0;return n<1&&(r=(i-.5*n)/(1-n)),[t[0],n*100,r*100]};At.hsv.hcg=function(t){const e=t[1]/100,i=t[2]/100,n=e*i;let r=0;return n<1&&(r=(i-n)/(1-n)),[t[0],n*100,r*100]};At.hcg.rgb=function(t){const e=t[0]/360,i=t[1]/100,n=t[2]/100;if(i===0)return[n*255,n*255,n*255];const r=[0,0,0],s=e%1*6,o=s%1,a=1-o;let l=0;switch(Math.floor(s)){case 0:r[0]=1,r[1]=o,r[2]=0;break;case 1:r[0]=a,r[1]=1,r[2]=0;break;case 2:r[0]=0,r[1]=1,r[2]=o;break;case 3:r[0]=0,r[1]=a,r[2]=1;break;case 4:r[0]=o,r[1]=0,r[2]=1;break;default:r[0]=1,r[1]=0,r[2]=a}return l=(1-i)*n,[(i*r[0]+l)*255,(i*r[1]+l)*255,(i*r[2]+l)*255]};At.hcg.hsv=function(t){const e=t[1]/100,i=t[2]/100,n=e+i*(1-e);let r=0;return n>0&&(r=e/n),[t[0],r*100,n*100]};At.hcg.hsl=function(t){const e=t[1]/100,n=t[2]/100*(1-e)+.5*e;let r=0;return n>0&&n<.5?r=e/(2*n):n>=.5&&n<1&&(r=e/(2*(1-n))),[t[0],r*100,n*100]};At.hcg.hwb=function(t){const e=t[1]/100,i=t[2]/100,n=e+i*(1-e);return[t[0],(n-e)*100,(1-n)*100]};At.hwb.hcg=function(t){const e=t[1]/100,n=1-t[2]/100,r=n-e;let s=0;return r<1&&(s=(n-r)/(1-r)),[t[0],r*100,s*100]};At.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]};At.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]};At.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]};At.gray.hsl=function(t){return[0,0,t[0]]};At.gray.hsv=At.gray.hsl;At.gray.hwb=function(t){return[0,100,t[0]]};At.gray.cmyk=function(t){return[0,0,0,t[0]]};At.gray.lab=function(t){return[t[0],0,0]};At.gray.hex=function(t){const e=Math.round(t[0]/100*255)&255,n=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(n.length)+n};At.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]};const K_=pH;function X0e(){const t={},e=Object.keys(K_);for(let i=e.length,n=0;n<i;n++)t[e[n]]={distance:-1,parent:null};return t}function Y0e(t){const e=X0e(),i=[t];for(e[t].distance=0;i.length;){const n=i.pop(),r=Object.keys(K_[n]);for(let s=r.length,o=0;o<s;o++){const a=r[o],l=e[a];l.distance===-1&&(l.distance=e[n].distance+1,l.parent=n,i.unshift(a))}}return e}function Z0e(t,e){return function(i){return e(t(i))}}function J0e(t,e){const i=[e[t].parent,t];let n=K_[e[t].parent][t],r=e[t].parent;for(;e[r].parent;)i.unshift(e[r].parent),n=Z0e(K_[e[r].parent][r],n),r=e[r].parent;return n.conversion=i,n}var Q0e=function(t){const e=Y0e(t),i={},n=Object.keys(e);for(let r=n.length,s=0;s<r;s++){const o=n[s];e[o].parent!==null&&(i[o]=J0e(o,e))}return i};const u1=pH,e_e=Q0e,fm={},t_e=Object.keys(u1);function i_e(t){const e=function(...i){const n=i[0];return n==null?n:(n.length>1&&(i=n),t(i))};return"conversion"in t&&(e.conversion=t.conversion),e}function n_e(t){const e=function(...i){const n=i[0];if(n==null)return n;n.length>1&&(i=n);const r=t(i);if(typeof r=="object")for(let s=r.length,o=0;o<s;o++)r[o]=Math.round(r[o]);return r};return"conversion"in t&&(e.conversion=t.conversion),e}t_e.forEach(t=>{fm[t]={},Object.defineProperty(fm[t],"channels",{value:u1[t].channels}),Object.defineProperty(fm[t],"labels",{value:u1[t].labels});const e=e_e(t);Object.keys(e).forEach(n=>{const r=e[n];fm[t][n]=n_e(r),fm[t][n].raw=i_e(r)})});var r_e=fm;const mm=q0e,Go=r_e,gH=["keyword","gray","hex"],d1={};for(const t of Object.keys(Go))d1[[...Go[t].labels].sort().join("")]=t;const X_={};function jr(t,e){if(!(this instanceof jr))return new jr(t,e);if(e&&e in gH&&(e=null),e&&!(e in Go))throw new Error("Unknown model: "+e);let i,n;if(t==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof jr)this.model=t.model,this.color=[...t.color],this.valpha=t.valpha;else if(typeof t=="string"){const r=mm.get(t);if(r===null)throw new Error("Unable to parse color from string: "+t);this.model=r.model,n=Go[this.model].channels,this.color=r.value.slice(0,n),this.valpha=typeof r.value[n]=="number"?r.value[n]:1}else if(t.length>0){this.model=e||"rgb",n=Go[this.model].channels;const r=Array.prototype.slice.call(t,0,n);this.color=f1(r,n),this.valpha=typeof t[n]=="number"?t[n]:1}else if(typeof t=="number")this.model="rgb",this.color=[t>>16&255,t>>8&255,t&255],this.valpha=1;else{this.valpha=1;const r=Object.keys(t);"alpha"in t&&(r.splice(r.indexOf("alpha"),1),this.valpha=typeof t.alpha=="number"?t.alpha:0);const s=r.sort().join("");if(!(s in d1))throw new Error("Unable to parse color from object: "+JSON.stringify(t));this.model=d1[s];const{labels:o}=Go[this.model],a=[];for(i=0;i<o.length;i++)a.push(t[o[i]]);this.color=f1(a)}if(X_[this.model])for(n=Go[this.model].channels,i=0;i<n;i++){const r=X_[this.model][i];r&&(this.color[i]=r(this.color[i]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}jr.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(t){let e=this.model in mm.to?this:this.rgb();e=e.round(typeof t=="number"?t:1);const i=e.valpha===1?e.color:[...e.color,this.valpha];return mm.to[e.model](i)},percentString(t){const e=this.rgb().round(typeof t=="number"?t:1),i=e.valpha===1?e.color:[...e.color,this.valpha];return mm.to.rgb.percent(i)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const t={},{channels:e}=Go[this.model],{labels:i}=Go[this.model];for(let n=0;n<e;n++)t[i[n]]=this.color[n];return this.valpha!==1&&(t.alpha=this.valpha),t},unitArray(){const t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,this.valpha!==1&&t.push(this.valpha),t},unitObject(){const t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,this.valpha!==1&&(t.alpha=this.valpha),t},round(t){return t=Math.max(t||0,0),new jr([...this.color.map(o_e(t)),this.valpha],this.model)},alpha(t){return t!==void 0?new jr([...this.color,Math.max(0,Math.min(1,t))],this.model):this.valpha},red:Fn("rgb",0,Pr(255)),green:Fn("rgb",1,Pr(255)),blue:Fn("rgb",2,Pr(255)),hue:Fn(["hsl","hsv","hsl","hwb","hcg"],0,t=>(t%360+360)%360),saturationl:Fn("hsl",1,Pr(100)),lightness:Fn("hsl",2,Pr(100)),saturationv:Fn("hsv",1,Pr(100)),value:Fn("hsv",2,Pr(100)),chroma:Fn("hcg",1,Pr(100)),gray:Fn("hcg",2,Pr(100)),white:Fn("hwb",1,Pr(100)),wblack:Fn("hwb",2,Pr(100)),cyan:Fn("cmyk",0,Pr(100)),magenta:Fn("cmyk",1,Pr(100)),yellow:Fn("cmyk",2,Pr(100)),black:Fn("cmyk",3,Pr(100)),x:Fn("xyz",0,Pr(95.047)),y:Fn("xyz",1,Pr(100)),z:Fn("xyz",2,Pr(108.833)),l:Fn("lab",0,Pr(100)),a:Fn("lab",1),b:Fn("lab",2),keyword(t){return t!==void 0?new jr(t):Go[this.model].keyword(this.color)},hex(t){return t!==void 0?new jr(t):mm.to.hex(this.rgb().round().color)},hexa(t){if(t!==void 0)return new jr(t);const e=this.rgb().round().color;let i=Math.round(this.valpha*255).toString(16).toUpperCase();return i.length===1&&(i="0"+i),mm.to.hex(e)+i},rgbNumber(){const t=this.rgb().color;return(t[0]&255)<<16|(t[1]&255)<<8|t[2]&255},luminosity(){const t=this.rgb().color,e=[];for(const[i,n]of t.entries()){const r=n/255;e[i]=r<=.04045?r/12.92:((r+.055)/1.055)**2.4}return .2126*e[0]+.7152*e[1]+.0722*e[2]},contrast(t){const e=this.luminosity(),i=t.luminosity();return e>i?(e+.05)/(i+.05):(i+.05)/(e+.05)},level(t){const e=this.contrast(t);return e>=7?"AAA":e>=4.5?"AA":""},isDark(){const t=this.rgb().color;return(t[0]*2126+t[1]*7152+t[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const t=this.rgb();for(let e=0;e<3;e++)t.color[e]=255-t.color[e];return t},lighten(t){const e=this.hsl();return e.color[2]+=e.color[2]*t,e},darken(t){const e=this.hsl();return e.color[2]-=e.color[2]*t,e},saturate(t){const e=this.hsl();return e.color[1]+=e.color[1]*t,e},desaturate(t){const e=this.hsl();return e.color[1]-=e.color[1]*t,e},whiten(t){const e=this.hwb();return e.color[1]+=e.color[1]*t,e},blacken(t){const e=this.hwb();return e.color[2]+=e.color[2]*t,e},grayscale(){const t=this.rgb().color,e=t[0]*.3+t[1]*.59+t[2]*.11;return jr.rgb(e,e,e)},fade(t){return this.alpha(this.valpha-this.valpha*t)},opaquer(t){return this.alpha(this.valpha+this.valpha*t)},rotate(t){const e=this.hsl();let i=e.color[0];return i=(i+t)%360,i=i<0?360+i:i,e.color[0]=i,e},mix(t,e){if(!t||!t.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof t);const i=t.rgb(),n=this.rgb(),r=e===void 0?.5:e,s=2*r-1,o=i.alpha()-n.alpha(),a=((s*o===-1?s:(s+o)/(1+s*o))+1)/2,l=1-a;return jr.rgb(a*i.red()+l*n.red(),a*i.green()+l*n.green(),a*i.blue()+l*n.blue(),i.alpha()*r+n.alpha()*(1-r))}};for(const t of Object.keys(Go)){if(gH.includes(t))continue;const{channels:e}=Go[t];jr.prototype[t]=function(...i){return this.model===t?new jr(this):i.length>0?new jr(i,t):new jr([...a_e(Go[this.model][t].raw(this.color)),this.valpha],t)},jr[t]=function(...i){let n=i[0];return typeof n=="number"&&(n=f1(i,e)),new jr(n,t)}}function s_e(t,e){return Number(t.toFixed(e))}function o_e(t){return function(e){return s_e(e,t)}}function Fn(t,e,i){t=Array.isArray(t)?t:[t];for(const n of t)(X_[n]||(X_[n]=[]))[e]=i;return t=t[0],function(n){let r;return n!==void 0?(i&&(n=i(n)),r=this[t](),r.color[e]=n,r):(r=this[t]().color[e],i&&(r=i(r)),r)}}function Pr(t){return function(e){return Math.max(0,Math.min(t,e))}}function a_e(t){return Array.isArray(t)?t:[t]}function f1(t,e){for(let i=0;i<e;i++)typeof t[i]!="number"&&(t[i]=0);return t}var l_e=jr;const $F=IP(l_e);const c_e=We({color:{type:Object},disabled:Boolean,dotSize:{type:[Number,String],default:10},height:{type:[Number,String],default:150},width:{type:[Number,String],default:300},...Ut()},"VColorPickerCanvas"),h_e=El({name:"VColorPickerCanvas",props:c_e(),emits:{"update:color":t=>!0,"update:position":t=>!0},setup(t,e){let{emit:i}=e;const n=_t(!1),r=ge(),s=_t(parseFloat(t.width)),o=_t(parseFloat(t.height)),a=ge({x:0,y:0}),l=W({get:()=>a.value,set(v){var _,P;if(!r.value)return;const{x:p,y:b}=v;a.value=v,i("update:color",{h:((_=t.color)==null?void 0:_.h)??0,s:So(p,0,s.value)/s.value,v:1-So(b,0,o.value)/o.value,a:((P=t.color)==null?void 0:P.a)??1})}}),c=W(()=>{const{x:v,y:p}=l.value,b=parseInt(t.dotSize,10)/2;return{width:Lt(t.dotSize),height:Lt(t.dotSize),transform:`translate(${Lt(v-b)}, ${Lt(p-b)})`}}),{resizeRef:u}=Rd(v=>{var _;if(!((_=u.value)!=null&&_.offsetParent))return;const{width:p,height:b}=v[0].contentRect;s.value=p,o.value=b});function h(v,p,b){const{left:_,top:P,width:E,height:T}=b;l.value={x:So(v-_,0,E),y:So(p-P,0,T)}}function d(v){v.type==="mousedown"&&v.preventDefault(),!t.disabled&&(f(v),window.addEventListener("mousemove",f),window.addEventListener("mouseup",m),window.addEventListener("touchmove",f),window.addEventListener("touchend",m))}function f(v){if(t.disabled||!r.value)return;n.value=!0;const p=J9(v);h(p.clientX,p.clientY,r.value.getBoundingClientRect())}function m(){window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m),window.removeEventListener("touchmove",f),window.removeEventListener("touchend",m)}function g(){var P;if(!r.value)return;const v=r.value,p=v.getContext("2d");if(!p)return;const b=p.createLinearGradient(0,0,v.width,0);b.addColorStop(0,"hsla(0, 0%, 100%, 1)"),b.addColorStop(1,`hsla(${((P=t.color)==null?void 0:P.h)??0}, 100%, 50%, 1)`),p.fillStyle=b,p.fillRect(0,0,v.width,v.height);const _=p.createLinearGradient(0,0,0,v.height);_.addColorStop(0,"hsla(0, 0%, 100%, 0)"),_.addColorStop(1,"hsla(0, 0%, 0%, 1)"),p.fillStyle=_,p.fillRect(0,0,v.width,v.height)}return He(()=>{var v;return(v=t.color)==null?void 0:v.h},g,{immediate:!0}),He(()=>[s.value,o.value],(v,p)=>{g(),a.value={x:l.value.x*v[0]/p[0],y:l.value.y*v[1]/p[1]}},{flush:"post"}),He(()=>t.color,()=>{if(n.value){n.value=!1;return}a.value=t.color?{x:t.color.s*s.value,y:(1-t.color.v)*o.value}:{x:0,y:0}},{deep:!0,immediate:!0}),ki(()=>g()),Tt(()=>w("div",{ref:u,class:["v-color-picker-canvas",t.class],style:t.style,onMousedown:d,onTouchstartPassive:d},[w("canvas",{ref:r,width:s.value,height:o.value},null),t.color&&w("div",{class:["v-color-picker-canvas__dot",{"v-color-picker-canvas__dot--disabled":t.disabled}],style:c.value},null)])),{}}});function u_e(t,e){if(e){const{a:i,...n}=t;return n}return t}function d_e(t,e){if(e==null||typeof e=="string"){const i=FU(t);return t.a===1?i.slice(0,7):i}if(typeof e=="object"){let i;return md(e,["r","g","b"])?i=oh(t):md(e,["h","s","l"])?i=LU(t):md(e,["h","s","v"])&&(i=t),u_e(i,!md(e,["a"])&&t.a===1)}return t}const Tm={h:0,s:0,v:0,a:1},m1={inputProps:{type:"number",min:0},inputs:[{label:"R",max:255,step:1,getValue:t=>Math.round(t.r),getColor:(t,e)=>({...t,r:Number(e)})},{label:"G",max:255,step:1,getValue:t=>Math.round(t.g),getColor:(t,e)=>({...t,g:Number(e)})},{label:"B",max:255,step:1,getValue:t=>Math.round(t.b),getColor:(t,e)=>({...t,b:Number(e)})},{label:"A",max:1,step:.01,getValue:t=>{let{a:e}=t;return e!=null?Math.round(e*100)/100:1},getColor:(t,e)=>({...t,a:Number(e)})}],to:oh,from:uP};var hz;const f_e={...m1,inputs:(hz=m1.inputs)==null?void 0:hz.slice(0,3)},p1={inputProps:{type:"number",min:0},inputs:[{label:"H",max:360,step:1,getValue:t=>Math.round(t.h),getColor:(t,e)=>({...t,h:Number(e)})},{label:"S",max:1,step:.01,getValue:t=>Math.round(t.s*100)/100,getColor:(t,e)=>({...t,s:Number(e)})},{label:"L",max:1,step:.01,getValue:t=>Math.round(t.l*100)/100,getColor:(t,e)=>({...t,l:Number(e)})},{label:"A",max:1,step:.01,getValue:t=>{let{a:e}=t;return e!=null?Math.round(e*100)/100:1},getColor:(t,e)=>({...t,a:Number(e)})}],to:LU,from:oM},m_e={...p1,inputs:p1.inputs.slice(0,3)},vH={inputProps:{type:"text"},inputs:[{label:"HEXA",getValue:t=>t,getColor:(t,e)=>e}],to:FU,from:RU},p_e={...vH,inputs:[{label:"HEX",getValue:t=>t.slice(0,7),getColor:(t,e)=>e}]},Dd={rgb:f_e,rgba:m1,hsl:m_e,hsla:p1,hex:p_e,hexa:vH},g_e=t=>{let{label:e,...i}=t;return w("div",{class:"v-color-picker-edit__input"},[w("input",i,null),w("span",null,[e])])},v_e=We({color:Object,disabled:Boolean,mode:{type:String,default:"rgba",validator:t=>Object.keys(Dd).includes(t)},modes:{type:Array,default:()=>Object.keys(Dd),validator:t=>Array.isArray(t)&&t.every(e=>Object.keys(Dd).includes(e))},...Ut()},"VColorPickerEdit"),y_e=El({name:"VColorPickerEdit",props:v_e(),emits:{"update:color":t=>!0,"update:mode":t=>!0},setup(t,e){let{emit:i}=e;const n=W(()=>t.modes.map(s=>({...Dd[s],name:s}))),r=W(()=>{var a;const s=n.value.find(l=>l.name===t.mode);if(!s)return[];const o=t.color?s.to(t.color):null;return(a=s.inputs)==null?void 0:a.map(l=>{let{getValue:c,getColor:u,...h}=l;return{...s.inputProps,...h,disabled:t.disabled,value:o&&c(o),onChange:d=>{const f=d.target;f&&i("update:color",s.from(u(o??s.to(Tm),f.value)))}}})});return Tt(()=>{var s;return w("div",{class:["v-color-picker-edit",t.class],style:t.style},[(s=r.value)==null?void 0:s.map(o=>w(g_e,o,null)),n.value.length>1&&w(Qt,{icon:"$unfold",size:"x-small",variant:"plain",onClick:()=>{const o=n.value.findIndex(a=>a.name===t.mode);i("update:mode",n.value[(o+1)%n.value.length].name)}},null)])}),{}}});const S_e=We({color:{type:Object},disabled:Boolean,hideAlpha:Boolean,...Ut()},"VColorPickerPreview"),b_e=El({name:"VColorPickerPreview",props:S_e(),emits:{"update:color":t=>!0},setup(t,e){let{emit:i}=e;const n=new AbortController;ky(()=>n.abort());async function r(){if(!HL)return;const s=new window.EyeDropper;try{const o=await s.open({signal:n.signal}),a=RU(o.sRGBHex);i("update:color",{...t.color??Tm,...a})}catch{}}return Tt(()=>{var s,o;return w("div",{class:["v-color-picker-preview",{"v-color-picker-preview--hide-alpha":t.hideAlpha},t.class],style:t.style},[HL&&w("div",{class:"v-color-picker-preview__eye-dropper",key:"eyeDropper"},[w(Qt,{onClick:r,icon:"$eyeDropper",variant:"plain",density:"comfortable"},null)]),w("div",{class:"v-color-picker-preview__dot"},[w("div",{style:{background:OU(t.color??Tm)}},null)]),w("div",{class:"v-color-picker-preview__sliders"},[w(hp,{class:"v-color-picker-preview__track v-color-picker-preview__hue",modelValue:(s=t.color)==null?void 0:s.h,"onUpdate:modelValue":a=>i("update:color",{...t.color??Tm,h:a}),step:0,min:0,max:360,disabled:t.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null),!t.hideAlpha&&w(hp,{class:"v-color-picker-preview__track v-color-picker-preview__alpha",modelValue:((o=t.color)==null?void 0:o.a)??1,"onUpdate:modelValue":a=>i("update:color",{...t.color??Tm,a}),step:1/256,min:0,max:1,disabled:t.disabled,thumbSize:14,trackSize:8,trackFillColor:"white",hideDetails:!0},null)])])}),{}}});const __e={base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"},P_e={base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"},E_e={base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"},w_e={base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"},T_e={base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"},x_e={base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"},k_e={base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"},C_e={base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"},M_e={base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"},A_e={base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"},V_e={base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"},L_e={base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"},I_e={base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"},O_e={base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"},D_e={base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"},N_e={base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"},R_e={base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"},F_e={base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"},z_e={base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"},U_e={black:"#000000",white:"#ffffff",transparent:"#ffffff00"},B_e={red:__e,pink:P_e,purple:E_e,deepPurple:w_e,indigo:T_e,blue:x_e,lightBlue:k_e,cyan:C_e,teal:M_e,green:A_e,lightGreen:V_e,lime:L_e,yellow:I_e,amber:O_e,orange:D_e,deepOrange:N_e,brown:R_e,blueGrey:F_e,grey:z_e,shades:U_e},j_e=We({swatches:{type:Array,default:()=>$_e(B_e)},disabled:Boolean,color:Object,maxHeight:[Number,String],...Ut()},"VColorPickerSwatches");function $_e(t){return Object.keys(t).map(e=>{const i=t[e];return i.base?[i.base,i.darken4,i.darken3,i.darken2,i.darken1,i.lighten1,i.lighten2,i.lighten3,i.lighten4,i.lighten5]:[i.black,i.white,i.transparent]})}const W_e=El({name:"VColorPickerSwatches",props:j_e(),emits:{"update:color":t=>!0},setup(t,e){let{emit:i}=e;return Tt(()=>w("div",{class:["v-color-picker-swatches",t.class],style:[{maxHeight:Lt(t.maxHeight)},t.style]},[w("div",null,[t.swatches.map(n=>w("div",{class:"v-color-picker-swatches__swatch"},[n.map(r=>{const s=Ea(r),o=uP(s),a=IU(s);return w("div",{class:"v-color-picker-swatches__color",onClick:()=>o&&i("update:color",o)},[w("div",{style:{background:a}},[t.color&&Jd(t.color,o)?w(lt,{size:"x-small",icon:"$success",color:E7(r,"#FFFFFF")>2?"white":"black"},null):void 0])])})]))])])),{}}}),G_e=We({canvasHeight:{type:[String,Number],default:150},disabled:Boolean,dotSize:{type:[Number,String],default:10},hideCanvas:Boolean,hideSliders:Boolean,hideInputs:Boolean,mode:{type:String,default:"rgba",validator:t=>Object.keys(Dd).includes(t)},modes:{type:Array,default:()=>Object.keys(Dd),validator:t=>Array.isArray(t)&&t.every(e=>Object.keys(Dd).includes(e))},showSwatches:Boolean,swatches:Array,swatchesMaxHeight:{type:[Number,String],default:150},modelValue:{type:[Object,String]},...Ua(A5({width:300}),["height","location","minHeight","maxHeight","minWidth","maxWidth"])},"VColorPicker"),H_e=El({name:"VColorPicker",props:G_e(),emits:{"update:modelValue":t=>!0,"update:mode":t=>!0},setup(t){const e=Oi(t,"mode"),i=ge(null),n=Oi(t,"modelValue",void 0,o=>{if(o==null||o==="")return null;let a;try{a=uP(Ea(o))}catch{return null}return i.value&&(a={...a,h:i.value.h},i.value=null),a},o=>o?d_e(o,t.modelValue):null),{rtlClasses:r}=io(),s=o=>{n.value=o,i.value=o};return ki(()=>{t.modes.includes(e.value)||(e.value=t.modes[0])}),Pl({VSlider:{color:void 0,trackColor:void 0,trackFillColor:void 0}}),Tt(()=>{const o=mo.filterProps(t);return w(mo,ht({rounded:t.rounded,elevation:t.elevation,theme:t.theme,class:["v-color-picker",r.value,t.class],style:[{"--v-color-picker-color-hsv":OU({...n.value??Tm,a:1})},t.style]},o,{maxWidth:t.width}),{default:()=>[!t.hideCanvas&&w(h_e,{key:"canvas",color:n.value,"onUpdate:color":s,disabled:t.disabled,dotSize:t.dotSize,width:t.width,height:t.canvasHeight},null),(!t.hideSliders||!t.hideInputs)&&w("div",{key:"controls",class:"v-color-picker__controls"},[!t.hideSliders&&w(b_e,{key:"preview",color:n.value,"onUpdate:color":s,hideAlpha:!e.value.endsWith("a"),disabled:t.disabled},null),!t.hideInputs&&w(y_e,{key:"edit",modes:t.modes,mode:e.value,"onUpdate:mode":a=>e.value=a,color:n.value,"onUpdate:color":s,disabled:t.disabled},null)]),t.showSwatches&&w(W_e,{key:"swatches",color:n.value,"onUpdate:color":s,maxHeight:t.swatchesMaxHeight,swatches:t.swatches,disabled:t.disabled},null)]})}),{}}}),q_e={key:0,class:"text-subtitle-2",style:{color:"red"}},yH=ri({__name:"SimpleColorSelector",props:{title:{},conflict:{type:Boolean},styleName:{},numSelected:{},modelValue:{}},emits:["resetColor","update:modelValue"],setup(t,{emit:e}){const{t:i}=qn(),n=t,r=e,s=ge("#FF00FF00"),o=ge(!1),a=ge(!1),l=ge(!1),c=ge(S.style.swatches),u=ge(i("style.noFill"));function h(m){console.log("What is toggle flag?",o.value)}function d(m){let g=$F(m).hsl().string();g.split(",").length==3&&(g=g.replace(/\)$/,", 1.0)").replace(/^hsl/,"hsla")),console.log("Color changed to",m,g),r("update:modelValue",g)}ki(()=>{n.modelValue!==void 0&&n.modelValue!==null&&(s.value=$F(n.modelValue).hexa());const m=n.styleName.replace("Color","");n.styleName.charAt(0).toUpperCase()+m.substring(1);var v=/fill/gi;u.value=n.styleName.search(v)===-1?i("style.noStroke"):i("style.noFill");var p=/label/gi;a.value=n.title.search(p)!==-1});function f(){l.value=!l.value}return He(()=>n.modelValue,m=>{}),He(()=>o.value,m=>{m?(l.value=!1,c.value=S.style.greyedOutSwatches):c.value=S.style.swatches}),(m,g)=>(Te(),Ct(mt,null,[tt("div",null,[tt("span",{class:"text-subtitle-2",style:mr({color:m.conflict?"red":""})},nt(m.title+" "),5),fi(w(lt,{color:m.conflict?"":s.value,size:"small"},{default:U(()=>[$e(" mdi-checkbox-blank ")],void 0),_:1},8,["color"]),[[ln,o.value===!1]]),m.numSelected>1?(Te(),Ct("span",q_e,nt(" "+m.$t("style.labelStyleOptionsMultiple")),1)):Vi("",!0)]),w(Ph,{class:"pa-0 ma-0"},{default:U(()=>[w(pr,{justify:"end","no-gutters":"",align:"center"},{default:U(()=>[w(Si,{cols:"auto"},{default:U(()=>[w(dr,{location:"bottom","max-width":"400px"},{activator:U(({props:v})=>[tt("span",k1(lP(v)),[w(Py,{modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=p=>o.value=p),label:u.value,color:"indigo darken-3","hide-details":"",density:"compact",onClick:h},null,8,["modelValue","label"])],16)]),default:U(()=>[$e(" "+nt(a.value?m.$t("style.noFillLabelTip"):m.$t("style.noFillTip")),1)],void 0,!0),_:1})],void 0,!0),_:1}),w(Ry),w(Si,{cols:"auto",class:"ma-0 pl-0 pr-0 pt-2 pb-2"},{default:U(()=>[w(V0,{type:"colorInput",onClick:f,disabled:o.value,tooltip:le(i)("showInput")},{icon:U(()=>[$e("mdi-palette")]),_:1},8,["disabled","tooltip"])],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1}),w(H_e,{disabled:o.value,"hide-sliders":"","hide-canvas":"","show-swatches":!o.value,"hide-inputs":!l.value,"swatches-max-height":96,swatches:c.value,modelValue:s.value,"onUpdate:modelValue":[g[1]||(g[1]=v=>s.value=v),d],mode:"hexa",id:"colorPicker"},null,8,["disabled","show-swatches","hide-inputs","swatches","modelValue"])],64))}});function WF(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{showInput:i=>{const{normalize:n}=i;return n(["Show Color Input"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"showInput":"Show Color Input"}}'),delete e._Ctor}typeof WF=="function"&&WF(yH);const Y_=Tn(yH,[["__scopeId","data-v-95a57b6d"]]);class K_e extends L{constructor(i,n){super();y(this,"currentBackStyleContrast");y(this,"pastBackStyleContrast");this.currentBackStyleContrast=i,this.pastBackStyleContrast=n}do(){L.store.changeBackContrast(this.currentBackStyleContrast)}saveState(){this.lastState=0}restoreState(){L.store.changeBackContrast(this.pastBackStyleContrast)}toOpcode(){return null}}function SH(t,e,i,n=!0){const r=An(),{selectedSENodules:s,oldStyleSelections:o,initialStyleStatesMap:a,defaultStyleStatesMap:l}=Ji(r),c=[];let u=ge([]);const h=ge([]),d=[],f=ge({});let m={},g=.5;const v=ge(!1),p=W(()=>s.value.filter(Z=>Z instanceof en).length>0),b=W(()=>s.value.filter(Z=>Z instanceof $t||Z instanceof Jt||Z instanceof Kt||Z instanceof Ii||Z instanceof tn).length>0);function _(Z){return c.some(K=>K.match(Z))}function P(Z){return!u.value.some(K=>K.match(Z))}ki(()=>{$.listen("style-data-clear",T),$.listen("style-data-to-default",C),$.listen("save-style-state",F)}),an(()=>{$.unlisten("style-data-clear"),$.unlisten("style-data-to-default")});function E(Z,K){console.debug("Style data to apply",K),h.value.forEach((z,H)=>{const re={};Z.forEach(ne=>{re[ne]=K[H][ne]}),z.updateStyle(t,re)}),K.length>0&&Z.forEach(z=>{f[z]=K[0][z]})}function T(Z){const K=a.value.get(t);if(K){const z=Z.selector.split(",");Z.selector==="labelBackFillColor"&&z.push("labelDynamicBackStyle"),Z.panel!==void 0&&Z.panel===q.Back&&z.push("dynamicBackStyle"),E(z,K)}$.fire("style-label-conflict-color-reset",{})}function C(Z){const K=l.value.get(t);if(K){const z=Z.selector.split(",");z.some(H=>H==="labelBackFillColor")&&z.push("labelDynamicBackStyle"),Z.panel===q.Back&&z.push("dynamicBackStyle"),E(z,K)}$.fire("style-label-conflict-color-reset",{})}He(()=>n,Z=>{t===q.Back&&(v.value=Z)}),He(()=>s.value,Z=>{if(console.debug("StyleEditor: object selection changed",Z.length),F(),c.splice(0),Z.length===0)return;f.value={},r.setSelectedSENodules(Z.filter(e)),h.value.splice(0),h.value.push(...s.value.map(i)),r.setOldSelection(s.value);const K=h.value.map(ne=>ne.currentStyleState(t));r.recordStyleState({panel:t,selected:h.value}),f.value={...K[0]};const z=K.flatMap(ne=>Object.getOwnPropertyNames(ne).filter(B=>!B.startsWith("__"))),H=new Set(z),re=K.map(ne=>Object.getOwnPropertyNames(ne).filter(B=>!B.startsWith("__")));if(H.forEach(ne=>{re.every(B=>B.indexOf(ne)>-1)&&c.push(ne)}),h.value.length>1){v.value=!1,u.value=c.filter(B=>{const fe=h.value[0].currentStyleState(t)[B];return B==="dynamicBackStyle"?v.value=fe:B==="dashArray"&&Array.isArray(fe)&&fe.length===0&&fe.push(0,0),!h.value.every(se=>{const de=se.currentStyleState(t)[B];return Array.isArray(de)||Array.isArray(fe)?(de.length===0&&de.push(0,0),M(de,fe)):B.search(/Color/)>-1?x(de,fe):de===fe})}),u.value.length>0&&u.value.forEach(B=>{console.error("Disagreement in property value",B)});const ne=[];u.value.forEach(B=>ne.push(B)),$.fire("style-update-conflicting-props",{propNames:ne})}else{u.value.splice(0);const ne=h.value[0].currentStyleState(t);ne.dashArray&&ne.dashArray.length===0&&ne.dashArray.push(0,0),v.value=ne.dynamicBackStyle??!1,console.debug("Only one object is selected");const B=[];u.value.forEach(Q=>B.push(Q)),$.fire("style-update-conflicting-props",{propNames:B})}if(g=pe.getBackStyleContrast(),d.splice(0),d.push(...h.value),_(/dashArray/)){let ne;f.value.dashArray&&(f.value.dashArray[0]===0&&f.value.dashArray[1]===0?ne=!0:ne=!1,$.fire("update-empty-dash-array",{emptyDashArray:ne}))}},{immediate:!0});function M(Z,K){const z=Z||[],H=K||[];return z.length==0&&H.length===0?!0:z.length==0?H.every(re=>re===0):H.length==0?z.every(re=>re===0):z.every((re,ne)=>re===H[ne])}function x(Z,K){if(Z===void 0&&K===void 0)return!0;if(Z===void 0||K===void 0)return!1;if(Z.search(/hsla/)===-1||K.search(/hsla/)===-1)throw new Error(`Style editor in hslaCompare: at least one of the strings is not a color string: ${Z},${K}`);const z=pe.convertStringToHSLAObject(Z),H=pe.convertStringToHSLAObject(K);return Math.abs(z.h-H.h)<S.tolerance&&Math.abs(z.s-H.s)<S.tolerance&&Math.abs(z.l-H.l)<S.tolerance&&Math.abs(z.a-H.a)<S.tolerance}He(()=>f.value,V,{deep:!0,immediate:!0});function V(Z){const K={...Z},z=new Set(Object.getOwnPropertyNames(m).filter(B=>!B.startsWith("__"))),re=[...new Set(Object.getOwnPropertyNames(K).filter(B=>!B.startsWith("__")))].filter(B=>z.has(B)),ne={...K};[...re].forEach(B=>{const Q=m[B],fe=K[B];let ie=!0;Array.isArray(fe)||Array.isArray(Q)?(fe.length===0&&fe.push(0,0),ie=M(fe,Q)):B.search(/Color/)>-1?ie=x(fe,Q):ie=fe===Q,ie?delete ne[B]:$.fire("style-option-change",{prop:B})}),h.value.length>1&&delete ne.labelDisplayText,re.length>0&&h.value.forEach(B=>{console.debug("Updating style of",B,"payload",ne),B.updateStyle(t,ne)}),m={...Z}}function N(Z){Z.forEach(z=>{const H=u.value.findIndex(re=>re===z);H>-1&&u.value.splice(H,1)});const K=[];u.value.forEach(z=>K.push(z)),$.fire("style-update-conflicting-props",{propNames:K}),t===q.Back&&(v.value=!0)}function D(Z,K){if(!Z&&!K)return[];const z=[];if(!Z){for(const ne in K)z.push({prop:ne,oldValue:void 0,newValue:K[ne]});return z}if(!K){for(const ne in Z)z.push({prop:ne,oldValue:K[ne],newValue:void 0});return z}const H=[...Object.getOwnPropertyNames(Z),...Object.getOwnPropertyNames(K)].filter(ne=>!ne.startsWith("__"));return[...new Set(H)].forEach(ne=>{const B=Z[ne],Q=K[ne];Array.isArray(B)&&Array.isArray(Q)?M(B,Q)||z.push({prop:ne,oldValue:B,newValue:Q}):ne.search(/Color/)>-1?x(Q,B)||z.push({prop:ne,oldValue:B,newValue:Q}):B!=Q&&z.push({prop:ne,oldValue:B,newValue:Q})}),z}function O(Z,K){return Z.length!==K.length?!1:Z.every((H,re)=>D(H,K[re]).length===0)}function F(){const Z=new Dt;let K=0;if(g!==pe.getBackStyleContrast()){console.log(g,"ISSUED COMMAND: The back style constant changed to ",pe.getBackStyleContrast());const z=new K_e(pe.getBackStyleContrast(),g);g=pe.getBackStyleContrast(),Z.addCommand(z),K++}if(o.value.length>0){console.debug("Number of previously selected object? ",d.length),console.debug("Number of currently selected object? ",h.value.length);const z=a.value.get(t)??[],H=h.value.map(re=>re.currentStyleState(t));if(O(z,H))console.debug("Everything stayed unchanged");else{console.debug("ISSUE StyleNoduleCommand"),console.debug("Previous style",z),console.debug("Next style",H);const re=new vc(h.value,t,H,z);Z.addCommand(re),K++}r.setOldSelection([])}K>0&&Z.push()}const X=W(()=>h.value.length);return{agreement:P,styleOptions:f,selectionCount:X,conflictingProps:u,automaticBackStyleCommonValue:v,angleMarkersSelected:p,oneDimensionSelected:b,forceDataAgreement:N,hasStyle:_,dataAgreement:P}}const bH=Symbol.for("vuetify:v-tabs"),X_e=We({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Ua(cB({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),wu=vt()({name:"VTab",props:X_e(),setup(t,e){let{slots:i,attrs:n}=e;const{textColorClasses:r,textColorStyles:s}=ko(t,"sliderColor"),o=ge(),a=ge(),l=W(()=>t.direction==="horizontal"),c=W(()=>{var h,d;return((d=(h=o.value)==null?void 0:h.group)==null?void 0:d.isSelected.value)??!1});function u(h){var f,m;let{value:d}=h;if(d){const g=(m=(f=o.value)==null?void 0:f.$el.parentElement)==null?void 0:m.querySelector(".v-tab--selected .v-tab__slider"),v=a.value;if(!g||!v)return;const p=getComputedStyle(g).color,b=g.getBoundingClientRect(),_=v.getBoundingClientRect(),P=l.value?"x":"y",E=l.value?"X":"Y",T=l.value?"right":"bottom",C=l.value?"width":"height",M=b[P],x=_[P],V=M>x?b[T]-_[T]:b[P]-_[P],N=Math.sign(V)>0?l.value?"right":"bottom":Math.sign(V)<0?l.value?"left":"top":"center",O=(Math.abs(V)+(Math.sign(V)<0?b[C]:_[C]))/Math.max(b[C],_[C])||0,F=b[C]/_[C]||0,X=1.5;pd(v,{backgroundColor:[p,"currentcolor"],transform:[`translate${E}(${V}px) scale${E}(${F})`,`translate${E}(${V/X}px) scale${E}(${(O-1)/X+1})`,"none"],transformOrigin:Array(3).fill(N)},{duration:225,easing:xv})}}return Tt(()=>{const h=Qt.filterProps(t);return w(Qt,ht({symbol:bH,ref:o,class:["v-tab",t.class],style:t.style,tabindex:c.value?0:-1,role:"tab","aria-selected":String(c.value),active:!1},h,n,{block:t.fixed,maxWidth:t.fixed?300:void 0,"onGroup:selected":u}),{...i,default:()=>{var d;return w(mt,null,[((d=i.default)==null?void 0:d.call(i))??t.text,!t.hideSlider&&w("div",{ref:a,class:["v-tab__slider",r.value],style:s.value},null)])}})}),_c({},o)}});function Y_e(t){return t?t.map(e=>j0(e)?e:{text:e,value:e}):[]}const Z_e=We({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...AV({mandatory:"force"}),...Ba(),...pn()},"VTabs"),J_e=vt()({name:"VTabs",props:Z_e(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const n=Oi(t,"modelValue"),r=W(()=>Y_e(t.items)),{densityClasses:s}=wl(t),{backgroundColorClasses:o,backgroundColorStyles:a}=Cs(bt(t,"bgColor"));return Pl({VTab:{color:bt(t,"color"),direction:bt(t,"direction"),stacked:bt(t,"stacked"),fixed:bt(t,"fixedTabs"),sliderColor:bt(t,"sliderColor"),hideSlider:bt(t,"hideSlider")}}),Tt(()=>{const l=B_.filterProps(t);return w(B_,ht(l,{modelValue:n.value,"onUpdate:modelValue":c=>n.value=c,class:["v-tabs",`v-tabs--${t.direction}`,`v-tabs--align-tabs-${t.alignTabs}`,{"v-tabs--fixed-tabs":t.fixedTabs,"v-tabs--grow":t.grow,"v-tabs--stacked":t.stacked},s.value,o.value,t.class],style:[{"--v-tabs-height":Lt(t.height)},a.value,t.style],role:"tablist",symbol:bH}),{default:()=>[i.default?i.default():r.value.map(c=>w(wu,ht(c,{key:c.text}),null))]})}),{}}});const Q_e=t=>{const{touchstartX:e,touchendX:i,touchstartY:n,touchendY:r}=t,s=.5,o=16;t.offsetX=i-e,t.offsetY=r-n,Math.abs(t.offsetY)<s*Math.abs(t.offsetX)&&(t.left&&i<e-o&&t.left(t),t.right&&i>e+o&&t.right(t)),Math.abs(t.offsetX)<s*Math.abs(t.offsetY)&&(t.up&&r<n-o&&t.up(t),t.down&&r>n+o&&t.down(t))};function ePe(t,e){var n;const i=t.changedTouches[0];e.touchstartX=i.clientX,e.touchstartY=i.clientY,(n=e.start)==null||n.call(e,{originalEvent:t,...e})}function tPe(t,e){var n;const i=t.changedTouches[0];e.touchendX=i.clientX,e.touchendY=i.clientY,(n=e.end)==null||n.call(e,{originalEvent:t,...e}),Q_e(e)}function iPe(t,e){var n;const i=t.changedTouches[0];e.touchmoveX=i.clientX,e.touchmoveY=i.clientY,(n=e.move)==null||n.call(e,{originalEvent:t,...e})}function nPe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:t.left,right:t.right,up:t.up,down:t.down,start:t.start,move:t.move,end:t.end};return{touchstart:i=>ePe(i,e),touchend:i=>tPe(i,e),touchmove:i=>iPe(i,e)}}function rPe(t,e){var a;const i=e.value,n=i!=null&&i.parent?t.parentElement:t,r=(i==null?void 0:i.options)??{passive:!0},s=(a=e.instance)==null?void 0:a.$.uid;if(!n||!s)return;const o=nPe(e.value);n._touchHandlers=n._touchHandlers??Object.create(null),n._touchHandlers[s]=o,bU(o).forEach(l=>{n.addEventListener(l,o[l],r)})}function sPe(t,e){var s,o;const i=(s=e.value)!=null&&s.parent?t.parentElement:t,n=(o=e.instance)==null?void 0:o.$.uid;if(!(i!=null&&i._touchHandlers)||!n)return;const r=i._touchHandlers[n];bU(r).forEach(a=>{i.removeEventListener(a,r[a])}),delete i._touchHandlers[n]}const _H={mounted:rPe,unmounted:sPe},oPe=_H,PH=Symbol.for("vuetify:v-window"),EH=Symbol.for("vuetify:v-window-group"),aPe=We({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:t=>typeof t=="boolean"||t==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Ut(),...pn(),...wn()},"VWindow"),lPe=vt()({name:"VWindow",directives:{Touch:_H},props:aPe(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:i}=e;const{themeClasses:n}=Hn(t),{isRtl:r}=io(),{t:s}=nf(),o=Ip(t,EH),a=ge(),l=W(()=>r.value?!t.reverse:t.reverse),c=_t(!1),u=W(()=>{const P=t.direction==="vertical"?"y":"x",T=(l.value?!c.value:c.value)?"-reverse":"";return`v-window-${P}${T}-transition`}),h=_t(0),d=ge(void 0),f=W(()=>o.items.value.findIndex(P=>o.selected.value.includes(P.id)));He(f,(P,E)=>{const T=o.items.value.length,C=T-1;T<=2?c.value=P<E:P===C&&E===0?c.value=!0:P===0&&E===C?c.value=!1:c.value=P<E}),jn(PH,{transition:u,isReversed:c,transitionCount:h,transitionHeight:d,rootRef:a});const m=W(()=>t.continuous||f.value!==0),g=W(()=>t.continuous||f.value!==o.items.value.length-1);function v(){m.value&&o.prev()}function p(){g.value&&o.next()}const b=W(()=>{const P=[],E={icon:r.value?t.nextIcon:t.prevIcon,class:`v-window__${l.value?"right":"left"}`,onClick:o.prev,"aria-label":s("$vuetify.carousel.prev")};P.push(m.value?i.prev?i.prev({props:E}):w(Qt,E,null):w("div",null,null));const T={icon:r.value?t.prevIcon:t.nextIcon,class:`v-window__${l.value?"left":"right"}`,onClick:o.next,"aria-label":s("$vuetify.carousel.next")};return P.push(g.value?i.next?i.next({props:T}):w(Qt,T,null):w("div",null,null)),P}),_=W(()=>t.touch===!1?t.touch:{...{left:()=>{l.value?v():p()},right:()=>{l.value?p():v()},start:E=>{let{originalEvent:T}=E;T.stopPropagation()}},...t.touch===!0?{}:t.touch});return Tt(()=>fi(w(t.tag,{ref:a,class:["v-window",{"v-window--show-arrows-on-hover":t.showArrows==="hover"},n.value,t.class],style:t.style},{default:()=>{var P,E;return[w("div",{class:"v-window__container",style:{height:d.value}},[(P=i.default)==null?void 0:P.call(i,{group:o}),t.showArrows!==!1&&w("div",{class:"v-window__controls"},[b.value])]),(E=i.additional)==null?void 0:E.call(i,{group:o})]}}),[[Mo("touch"),_.value]])),{group:o}}}),cPe=We({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Ut(),...Ay(),...yP()},"VWindowItem"),Wm=vt()({name:"VWindowItem",directives:{Touch:oPe},props:cPe(),emits:{"group:selected":t=>!0},setup(t,e){let{slots:i}=e;const n=xi(PH),r=Vy(t,EH),{isBooted:s}=MP();if(!n||!r)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const o=_t(!1),a=W(()=>s.value&&(n.isReversed.value?t.reverseTransition!==!1:t.transition!==!1));function l(){!o.value||!n||(o.value=!1,n.transitionCount.value>0&&(n.transitionCount.value-=1,n.transitionCount.value===0&&(n.transitionHeight.value=void 0)))}function c(){var m;o.value||!n||(o.value=!0,n.transitionCount.value===0&&(n.transitionHeight.value=Lt((m=n.rootRef.value)==null?void 0:m.clientHeight)),n.transitionCount.value+=1)}function u(){l()}function h(m){o.value&&vn(()=>{!a.value||!o.value||!n||(n.transitionHeight.value=Lt(m.clientHeight))})}const d=W(()=>{const m=n.isReversed.value?t.reverseTransition:t.transition;return a.value?{name:typeof m!="string"?n.transition.value:m,onBeforeEnter:c,onAfterEnter:l,onEnterCancelled:u,onBeforeLeave:c,onAfterLeave:l,onLeaveCancelled:u,onEnter:h}:!1}),{hasContent:f}=mM(t,r.isSelected);return Tt(()=>w(Gl,{transition:d.value,disabled:!s.value},{default:()=>{var m;return[fi(w("div",{class:["v-window-item",r.selectedClass.value,t.class],style:t.style},[f.value&&((m=i.default)==null?void 0:m.call(i))]),[[ln,r.isSelected.value]])]}})),{groupItem:r}}}),GF=99999,wH=ri({__name:"PopOverTabs",props:{iconName:{},tooltip:{},tooltipLocation:{}},setup(t){const e=ge(0),i=ge(!1);return He(()=>e.value,n=>{i.value=n!==GF}),(n,r)=>(Te(),qe(Ep,{modelValue:i.value,"onUpdate:modelValue":r[3]||(r[3]=s=>i.value=s),location:"start","close-on-content-click":!1,offset:40},{activator:U(({props:s})=>[w(dr,{location:n.tooltipLocation},{activator:U(({props:o})=>[w(lt,ht(ht(s,o),{icon:n.iconName}),null,16,["icon"])]),default:U(()=>[tt("span",null,nt(n.tooltip),1)],void 0,!0),_:2},1032,["location"])]),default:U(()=>[w(mo,{class:"bg-white"},{default:U(()=>[w(J_e,{modelValue:e.value,"onUpdate:modelValue":r[1]||(r[1]=s=>e.value=s)},{default:U(()=>[Ma(n.$slots,"tabs"),w(wu,{value:GF},{default:U(()=>[w(lt,{onClick:r[0]||(r[0]=s=>i.value=!1)},{default:U(()=>[$e("mdi-chevron-double-right")],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:3},8,["modelValue"]),w(lPe,{modelValue:e.value,"onUpdate:modelValue":r[2]||(r[2]=s=>e.value=s)},{default:U(()=>[Ma(n.$slots,"pages")],void 0,!0),_:3},8,["modelValue"]),Ma(n.$slots,"default")],void 0,!0),_:3})],void 0),_:3},8,["modelValue"]))}}),hPe="",uPe="",jV=ri({__name:"LabelStyle",props:{panel:{}},setup(t){const e=t,i=An(),{t:n}=qn(),{selectionCount:r,dataAgreement:s,conflictingProps:o,forceDataAgreement:a,styleOptions:l}=SH(e.panel,b,_),{selectedSENodules:c}=Ji(i),u=vU(),h=ge(null),d=ge(null),f=ge(null),m=ge(null),g=ge(l.value.labelTextScalePercent??100),v=ge(l.value.labelTextRotation??0);He(()=>c.value,p);function p(){Object.keys(E).forEach(te=>{E[te]=!1})}He(()=>c.value,Y=>{const te=s(/labelDynamicBackStyle/);console.info("Watching",Y.length,te,H.value),s(/labelDynamicBackStyle/),u.showDialog(h.value),u.showDialog(d.value)},{deep:!0});function b(Y){return Y.isLabelable()}function _(Y){return Y.label.ref}const P={labelDisplayText:!1,labelDisplayMode:!1,labelDisplayCaption:!1,labelTextFamily:!1,labelTextStyle:!1,labelTextDecoration:!1,labelTextScalePercent:!1,labelTextRotation:!1},E={labelDisplayText:!1,labelDisplayMode:!1,labelDisplayCaption:!1,labelTextFamily:!1,labelTextStyle:!1,labelTextDecoration:!1,labelTextScalePercent:!1,labelTextRotation:!1,labelBackFillColor:!1,labelFrontFillColor:!1},T=[],C=S.style.maxLabelTextScalePercent,M=S.style.minLabelTextScalePercent,x=[],V=S.label.maxLabelDisplayTextLength,N=ge(""),D=S.label.maxLabelDisplayCaptionLength,O=[{text:n("labelDisplayModes.nameOnly"),value:Xi.NameOnly,optionRequiresMeasurementValueToExist:!1,optionRequiresCaptionToExist:!1},{text:n("labelDisplayModes.captionOnly"),value:Xi.CaptionOnly,optionRequiresMeasurementValueToExist:!1,optionRequiresCaptionToExist:!0},{text:n("labelDisplayModes.valueOnly"),value:Xi.ValueOnly,optionRequiresMeasurementValueToExist:!0,optionRequiresCaptionToExist:!1},{text:n("labelDisplayModes.nameAndCaption"),value:Xi.NameAndCaption,optionRequiresMeasurementValueToExist:!1,optionRequiresCaptionToExist:!0},{text:n("labelDisplayModes.nameAndValue"),value:Xi.NameAndValue,optionRequiresMeasurementValueToExist:!0,optionRequiresCaptionToExist:!1}],F=[{text:n("fonts.genericSanSerif"),value:"sans/-serif"},{text:n("fonts.genericSerif"),value:"serif"},{text:n("fonts.monospace"),value:"monospace"},{text:n("fonts.cursive"),value:"cursive"},{text:n("fonts.fantasy"),value:"fantasy"}],X=[{text:n("textStyle.normal"),value:"normal"},{text:n("textStyle.italic"),value:"italic"},{text:n("textStyle.bold"),value:"bold"}],Z=[{text:n("textDecoration.none"),value:"none"},{text:n("textDecoration.underline"),value:"underline"},{text:n("textDecoration.strikethrough"),value:"strikethrough"},{text:n("textDecoration.overline"),value:"overline"}],K=[];to(()=>{for(let Y=S.style.minLabelTextScalePercent;Y<=S.style.maxLabelTextScalePercent;Y+=20)x.push(Y.toFixed(0)+"%");for(let Y=-180;Y<=180;Y+=22.5)K.push(Y.toFixed(1).replace(/\.0$/,"")+"")}),ki(()=>{$.listen("style-label-conflict-color-reset",z),$.listen("style-update-conflicting-props",Y=>{T.splice(0),Y.propNames.forEach(te=>T.push(te))})});function z(){p(),de(T)}an(()=>{$.unlisten("style-label-conflict-color-reset"),$.unlisten("style-update-conflicting-props")});const H=W(()=>c.value.every(Y=>Y.isLabelable()?Y.label.showing:!0));function re(){a(["labelDynamicBackStyle"]),l.value.labelDynamicBackStyle=!l.value.labelDynamicBackStyle}function ne(){$.fire("toggle-label-visibility",{fromPanel:!0})}function B(Y){if(Y!=null){if(Y.length>S.label.maxLabelDisplayTextLength)return n("message.maxLabelDisplayTextLength",{max:S.label.maxLabelDisplayTextLength});if(Y.length===0)return n("message.minLabelDisplayTextLength",{})}return!0}function Q(Y){if(Y.labelDisplayText!==void 0&&Y.labelDisplayText!==null)if(Y.labelDisplayText.length>S.label.maxLabelDisplayTextLength){const te=Y.labelDisplayText;Y.labelDisplayText=te.slice(0,S.label.maxLabelDisplayTextLength)}else Y.labelDisplayText.length===0?Y.labelDisplayText=N.value:N.value=Y.labelDisplayText;return!0}function fe(Y){return Y&&Y.length>S.label.maxLabelDisplayCaptionLength?n("message.maxCaptionLength",{max:S.label.maxLabelDisplayCaptionLength}):!0}function ie(Y){if(Y.labelDisplayCaption!==void 0&&Y.labelDisplayCaption.length>S.label.maxLabelDisplayCaptionLength){const te=Y.labelDisplayCaption;Y.labelDisplayCaption=te.slice(0,S.label.maxLabelDisplayCaptionLength)}return!0}function se(Y){const te=[];return c.value.filter(b).map(_).map(ae=>ae).every(ae=>ae.value.length!==0)?te.push(...O):te.push(...O.filter(ae=>!ae.optionRequiresMeasurementValueToExist)),Y.labelDisplayCaption&&Y.labelDisplayCaption.length>0?te:te.filter(ae=>!ae.optionRequiresCaptionToExist)}function ee(Y,te){return Y>1?n(te?"commonCaptionText":"commonLabelText"):n(te?"captionText":"labelText")}function de(Y){Y.forEach(te=>{switch(te){case"labelDisplayText":f!==void 0&&(f.$el.getElementsByTagName("input")[0].value="");break;case"labelDisplayCaption":m!==void 0&&(m.$el.getElementsByTagName("input")[0].value="");break}te.search(/Color/)===-1?E[te]="error":E[te]="red"})}return(Y,te)=>(Te(),Ct(mt,null,[w(wH,{"icon-name":"mdi-tag",tooltip:le(n)("labelStyle"),"tooltip-location":"left"},{tabs:U(()=>[w(wu,null,{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-pencil")],void 0,!0),_:1})],void 0,!0),_:1}),w(wu,null,{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-format-text")],void 0,!0),_:1})],void 0,!0),_:1}),w(wu,null,{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-palette")],void 0,!0),_:1})],void 0,!0),_:1})]),pages:U(()=>[w(Wm,{class:"pa-2"},{default:U(()=>[w(vr,{modelValue:le(l).labelDisplayText,"onUpdate:modelValue":te[0]||(te[0]=he=>le(l).labelDisplayText=he),disabled:le(r)>1,label:Y.$t("labelText"),counter:le(V),ref_key:"labelDisplayText",ref:f,class:Gs({shake:P.labelDisplayText,conflict:E.labelDisplayText}),variant:"outlined",density:"compact",placeholder:ee(le(r),!1),"error-messages":Y.$t(hPe,{max:le(V)}),rules:[B,Q(le(l))]},null,8,["modelValue","disabled","label","counter","class","placeholder","error-messages","rules"]),w(vr,{modelValue:le(l).labelDisplayCaption,"onUpdate:modelValue":te[1]||(te[1]=he=>le(l).labelDisplayCaption=he),modelModifiers:{lazy:!0},label:Y.$t("labelCaption"),counter:le(D),placeholder:ee(le(r),!0),ref_key:"labelDisplayCaption",ref:m,class:Gs({shake:P.labelDisplayCaption,conflict:E.labelDisplayCaption}),variant:"outlined",density:"compact",onKeypress:te[2]||(te[2]=he=>E.labelDisplayCaption=!1),"error-messages":Y.$t(uPe,{max:le(D)}),rules:[fe,ie(le(l))]},null,8,["modelValue","label","counter","placeholder","class","error-messages","rules"]),w(fv,{numSelected:le(r),modelValue:g.value,"onUpdate:modelValue":te[3]||(te[3]=he=>g.value=he),title:le(n)("labelTextScale"),ref:"labelTextScalePercent",color:E.labelTextScalePercent?"red":"",conflict:E.labelTextScalePercent,class:Gs({shake:P.labelTextScalePercent}),min:le(M),max:le(C),step:20,"thumb-string-values":x},null,8,["numSelected","modelValue","title","color","conflict","class","min","max"]),w(fv,{numSelected:le(r),modelValue:v.value,"onUpdate:modelValue":te[4]||(te[4]=he=>v.value=he),ref_key:"labelTextRotation",ref:v,conflict:E.labelTextRotation,class:Gs({shake:P.labelTextRotation}),title:le(n)("labelTextRotation"),color:E.labelTextRotation?"red":"",onResetColor:te[5]||(te[5]=he=>E.labelTextRotation=!1),min:-3.14159,max:3.14159,step:.39269875,"thumb-string-values":K},null,8,["numSelected","modelValue","conflict","class","title","color","thumb-string-values"])],void 0,!0),_:1}),w(Wm,{class:"pa-2"},{default:U(()=>[w(ym,{modelValue:le(l).labelTextFamily,"onUpdate:modelValue":te[6]||(te[6]=he=>le(l).labelTextFamily=he),modelModifiers:{lazy:!0},label:Y.$t("labelTextFamily"),items:F,"item-title":"text","item-value":"value",ref:"labelTextFamily",class:Gs({shake:P.labelTextFamily,conflict:E.labelTextFamily}),onChange:te[7]||(te[7]=he=>E.labelTextFamily=!1),variant:"outlined",density:"compact"},null,8,["modelValue","label","class"]),w(ym,{modelValue:le(l).labelTextStyle,"onUpdate:modelValue":te[8]||(te[8]=he=>le(l).labelTextStyle=he),modelModifiers:{lazy:!0},label:Y.$t("labelTextStyle"),items:X,"item-title":"text","item-value":"value",ref:"labelTextStyle",class:Gs({shake:P.labelTextStyle,conflict:E.labelTextStyle}),onChange:te[9]||(te[9]=he=>E.labelTextStyle=!1),variant:"outlined",density:"compact"},null,8,["modelValue","label","class"]),w(ym,{modelValue:le(l).labelTextDecoration,"onUpdate:modelValue":te[10]||(te[10]=he=>le(l).labelTextDecoration=he),modelModifiers:{lazy:!0},label:Y.$t("labelTextDecoration"),items:Z,"item-title":"text","item-value":"value",ref:"labelTextDecorations",class:Gs({shake:P.labelTextDecoration,conflict:E.labelTextDecoration}),onChange:te[11]||(te[11]=he=>E.labelTextDecoration=!1),variant:"outlined",density:"compact"},null,8,["modelValue","label","class"]),w(ym,{modelValue:le(l).labelDisplayMode,"onUpdate:modelValue":te[12]||(te[12]=he=>le(l).labelDisplayMode=he),modelModifiers:{lazy:!0},class:Gs(["pa-0",{shake:P.labelDisplayMode,conflict:E.labelDisplayMode}]),disabled:se(le(l)).length<2,ref:"labelDisplayMode",label:Y.$t("labelDisplayMode"),items:se(le(l)),"item-title":"text","item-value":"value",onChange:te[13]||(te[13]=he=>E.labelDisplayMode=!1),variant:"outlined",density:"compact"},null,8,["modelValue","class","disabled","label","items"])],void 0,!0),_:1}),w(Wm,{class:"pa-2"},{default:U(()=>[w(Y_,{title:le(n)("labelFrontFillColor"),numSelected:le(r),ref:"labelFrontFillColor","style-name":"labelFrontFillColor",conflict:E.labelFrontFillColor,onResetColor:te[14]||(te[14]=he=>E.labelFrontFillColor=!1),modelValue:le(l).labelFrontFillColor,"onUpdate:modelValue":te[15]||(te[15]=he=>le(l).labelFrontFillColor=he)},null,8,["title","numSelected","conflict","modelValue"]),w(Y_,{numSelected:le(r),title:le(n)("labelBackFillColor"),conflict:E.labelBackFillColor,onResetColor:te[16]||(te[16]=he=>E.labelBackFillColor=!1),ref:"labelBackFillColor","style-name":"labelBackFillColor",modelValue:le(l).labelBackFillColor,"onUpdate:modelValue":te[17]||(te[17]=he=>le(l).labelBackFillColor=he)},null,8,["numSelected","title","conflict","modelValue"])],void 0,!0),_:1})]),_:1},8,["tooltip"]),w(xu,{ref_key:"backStyleDisagreementDialog",ref:h,title:le(n)("backStyleDisagreement"),width:"50%","yes-text":le(n)("enableCommonStyle"),"yes-action":re},{default:U(()=>[$e(nt(le(n)("message.multipleObjectDifferingStyles")),1)],void 0),_:1},8,["title","yes-text"]),w(xu,{ref_key:"labelNotVisibleDialog",ref:d,width:"50%",title:le(n)("labelNotVisible"),"yes-text":le(n)("makeLabelsVisible"),"yes-action":ne},{default:U(()=>[$e(nt(le(n)("clickToMakeLabelsVisible")),1)],void 0),_:1},8,["title","yes-text"])],64))}});function HF(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{backStyleDisagreement:i=>{const{normalize:n}=i;return n(["Back Styling Disagreement"])},clickToMakeLabelsVisible:i=>{const{normalize:n}=i;return n(["Click the button below to make labels visible"])},commonCaptionText:i=>{const{normalize:n}=i;return n(["Common Caption Text"])},commonLabelText:i=>{const{normalize:n}=i;return n(["Common Label Text"])},enableCommonStyle:i=>{const{normalize:n}=i;return n(["Enable Common Style"])},fonts:{cursive:i=>{const{normalize:n}=i;return n(["Cursive Font"])},fantasy:i=>{const{normalize:n}=i;return n(["Fantasy"])},genericSanSerif:i=>{const{normalize:n}=i;return n(["San Serif Font"])},genericSerif:i=>{const{normalize:n}=i;return n(["Serif Font"])},monospace:i=>{const{normalize:n}=i;return n(["Monospace Font"])}},labelBackFillColor:i=>{const{normalize:n}=i;return n(["Label Back Fill Color"])},labelCaption:i=>{const{normalize:n}=i;return n(["Label Caption"])},labelDisplayMode:i=>{const{normalize:n}=i;return n(["Label Display Mode"])},labelDisplayModes:{captionOnly:i=>{const{normalize:n}=i;return n(["Caption Only"])},nameAndCaption:i=>{const{normalize:n}=i;return n(["Name & Caption"])},nameAndValue:i=>{const{normalize:n}=i;return n(["Name & Value"])},nameOnly:i=>{const{normalize:n}=i;return n(["Name Only"])},valueOnly:i=>{const{normalize:n}=i;return n(["Value Only"])}},labelFrontFillColor:i=>{const{normalize:n}=i;return n(["Label Front Fill Color"])},labelNotVisible:i=>{const{normalize:n}=i;return n(["Labels Not Visible"])},labelStyle:i=>{const{normalize:n}=i;return n(["Label Style"])},labelText:i=>{const{normalize:n}=i;return n(["Label Text"])},labelTextDecoration:i=>{const{normalize:n}=i;return n(["Label Text Decoration"])},labelTextFamily:i=>{const{normalize:n}=i;return n(["Label Text Family"])},labelTextRotation:i=>{const{normalize:n}=i;return n(["Label Rotation ()"])},labelTextScale:i=>{const{normalize:n}=i;return n(["Label Scale (%)"])},labelTextStyle:i=>{const{normalize:n}=i;return n(["Label Text Style"])},makeLabelsVisible:i=>{const{normalize:n}=i;return n(["Make Labels Visible"])},message:{maxLabelDisplayTextLength:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Label cannot be longer than ",r(s("max"))," characters"])},minLabelDisplayTextLength:i=>{const{normalize:n}=i;return n(["Label must have at least 1 character"])},maxCaptionLength:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Caption cannot be longer than ",r(s("max"))," characters"])},multipleObjectDifferingStyles:i=>{const{normalize:n}=i;return n(["Multiple object(s) selected have differing label styles."])}},textDecoration:{none:i=>{const{normalize:n}=i;return n(["No decoration"])},overline:i=>{const{normalize:n}=i;return n(["Overline"])},strikethrough:i=>{const{normalize:n}=i;return n(["Strikethrough"])},underline:i=>{const{normalize:n}=i;return n(["Underline"])}},textStyle:{bold:i=>{const{normalize:n}=i;return n(["Bold"])},italic:i=>{const{normalize:n}=i;return n(["Italic"])},normal:i=>{const{normalize:n}=i;return n(["Normal"])}}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"backStyleDisagreement":"Back Styling Disagreement","clickToMakeLabelsVisible":"Click the button below to make labels visible","commonCaptionText":"Common Caption Text","commonLabelText":"Common Label Text","enableCommonStyle":"Enable Common Style","fonts":{"cursive":"Cursive Font","fantasy":"Fantasy","genericSanSerif":"San Serif Font","genericSerif":"Serif Font","monospace":"Monospace Font"},"labelBackFillColor":"Label Back Fill Color","labelCaption":"Label Caption","labelDisplayMode":"Label Display Mode","labelDisplayModes":{"captionOnly":"Caption Only","nameAndCaption":"Name & Caption","nameAndValue":"Name & Value","nameOnly":"Name Only","valueOnly":"Value Only"},"labelFrontFillColor":"Label Front Fill Color","labelNotVisible":"Labels Not Visible","labelStyle":"Label Style","labelText":"Label Text","labelTextDecoration":"Label Text Decoration","labelTextFamily":"Label Text Family","labelTextRotation":"Label Rotation ()","labelTextScale":"Label Scale (%)","labelTextStyle":"Label Text Style","makeLabelsVisible":"Make Labels Visible","message":{"maxLabelDisplayTextLength":"Label cannot be longer than {max} characters","minLabelDisplayTextLength":"Label must have at least 1 character","maxCaptionLength":"Caption cannot be longer than {max} characters","multipleObjectDifferingStyles":"Multiple object(s) selected have differing label styles."},"textDecoration":{"none":"No decoration","overline":"Overline","strikethrough":"Strikethrough","underline":"Underline"},"textStyle":{"bold":"Bold","italic":"Italic","normal":"Normal"}}}'),delete e._Ctor}function qF(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"id",resource:{backStyleDisagreement:i=>{const{normalize:n}=i;return n(["Gaya Tampilan Belakang Bertentangan"])},clickToMakeLabelsVisible:i=>{const{normalize:n}=i;return n(["Tekan tombol dibawah untuk menampilkan label"])},commonCaptionText:i=>{const{normalize:n}=i;return n(["Keterangan Teks Gabungan"])},commonLabelText:i=>{const{normalize:n}=i;return n(["Label Teks Gabungan"])},enableCommonStyle:i=>{const{normalize:n}=i;return n(["Aktifkan Gaya Tampilan Gabungan"])},fonts:{cursive:i=>{const{normalize:n}=i;return n(["Cursive Font"])},fantasy:i=>{const{normalize:n}=i;return n(["Fantasy"])},genericSanSerif:i=>{const{normalize:n}=i;return n(["San Serif Font"])},genericSerif:i=>{const{normalize:n}=i;return n(["Serif Font"])},monospace:i=>{const{normalize:n}=i;return n(["Monospace Font"])}},labelBackFillColor:i=>{const{normalize:n}=i;return n(["Warna pengisi latar belakang"])},labelCaption:i=>{const{normalize:n}=i;return n(["Keterangan Teks"])},labelDisplayMode:i=>{const{normalize:n}=i;return n(["Mode Penampilan Label"])},labelDisplayModes:{captionOnly:i=>{const{normalize:n}=i;return n(["Keterangan Saja"])},nameAndCaption:i=>{const{normalize:n}=i;return n(["Nama & Keterangan"])},nameAndValue:i=>{const{normalize:n}=i;return n(["Nama & Nilai"])},nameOnly:i=>{const{normalize:n}=i;return n(["Nama Saja"])},valueOnly:i=>{const{normalize:n}=i;return n(["Nilai Saja"])}},labelFrontFillColor:i=>{const{normalize:n}=i;return n(["Warning Pengisi Label Later Depan"])},labelNotVisible:i=>{const{normalize:n}=i;return n(["Label Tidak Ditampilkan"])},labelText:i=>{const{normalize:n}=i;return n(["Teks Label"])},labelTextDecoration:i=>{const{normalize:n}=i;return n(["Dekorasi Teks Label"])},labelTextFamily:i=>{const{normalize:n}=i;return n(["Keluarga Text Label"])},labelTextRotation:i=>{const{normalize:n}=i;return n(["Rotasi Label"])},labelTextScale:i=>{const{normalize:n}=i;return n(["Persentasi Skala Label"])},labelTextStyle:i=>{const{normalize:n}=i;return n(["Gaya Tampilan Teks Label"])},makeLabelsVisible:i=>{const{normalize:n}=i;return n(["Tampilkan Label"])},message:{maxLabelDisplayTextLength:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Label terlalu panjang. Max ",r(s("max"))," huruf"])},minLabelDisplayTextLength:i=>{const{normalize:n}=i;return n(["Label minimum 1 karakter"])},maxCaptionLength:i=>{const{normalize:n,interpolate:r,named:s}=i;return n(["Teks Keterangna terlalu panjang. Max ",r(s("max"))," huruf"])},multipleObjectDifferingStyles:i=>{const{normalize:n}=i;return n(["Objek yang diseleksi memiliki gaya tampilan label berbeda"])}},textDecoration:{none:i=>{const{normalize:n}=i;return n(["Tanpa dekorasi"])},overline:i=>{const{normalize:n}=i;return n(["Garis atas"])},strikethrough:i=>{const{normalize:n}=i;return n(["Garis coret"])},underline:i=>{const{normalize:n}=i;return n(["Garis bawah"])}},textStyle:{bold:i=>{const{normalize:n}=i;return n(["Bold"])},italic:i=>{const{normalize:n}=i;return n(["Italic"])},normal:i=>{const{normalize:n}=i;return n(["Normal"])}}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"id":{"backStyleDisagreement":"Gaya Tampilan Belakang Bertentangan","clickToMakeLabelsVisible":"Tekan tombol dibawah untuk menampilkan label","commonCaptionText":"Keterangan Teks Gabungan","commonLabelText":"Label Teks Gabungan","enableCommonStyle":"Aktifkan Gaya Tampilan Gabungan","fonts":{"cursive":"Cursive Font","fantasy":"Fantasy","genericSanSerif":"San Serif Font","genericSerif":"Serif Font","monospace":"Monospace Font"},"labelBackFillColor":"Warna pengisi latar belakang","labelCaption":"Keterangan Teks","labelDisplayMode":"Mode Penampilan Label","labelDisplayModes":{"captionOnly":"Keterangan Saja","nameAndCaption":"Nama & Keterangan","nameAndValue":"Nama & Nilai","nameOnly":"Nama Saja","valueOnly":"Nilai Saja"},"labelFrontFillColor":"Warning Pengisi Label Later Depan","labelNotVisible":"Label Tidak Ditampilkan","labelText":"Teks Label","labelTextDecoration":"Dekorasi Teks Label","labelTextFamily":"Keluarga Text Label","labelTextRotation":"Rotasi Label","labelTextScale":"Persentasi Skala Label","labelTextStyle":"Gaya Tampilan Teks Label","makeLabelsVisible":"Tampilkan Label","message":{"maxLabelDisplayTextLength":"Label terlalu panjang. Max {max} huruf","minLabelDisplayTextLength":"Label minimum 1 karakter","maxCaptionLength":"Teks Keterangna terlalu panjang. Max {max} huruf","multipleObjectDifferingStyles":"Objek yang diseleksi memiliki gaya tampilan label berbeda"},"textDecoration":{"none":"Tanpa dekorasi","overline":"Garis atas","strikethrough":"Garis coret","underline":"Garis bawah"},"textStyle":{"bold":"Bold","italic":"Italic","normal":"Normal"}}}'),delete e._Ctor}typeof HF=="function"&&HF(jV);typeof qF=="function"&&qF(jV);const dPe=Tn(jV,[["__scopeId","data-v-c10fcec3"]]),fPe=We({...FP(),...df(),...L5(),strict:Boolean,modelValue:{type:Array,default:()=>[0,0]}},"VRangeSlider"),mPe=vt()({name:"VRangeSlider",props:fPe(),emits:{"update:focused":t=>!0,"update:modelValue":t=>!0,end:t=>!0,start:t=>!0},setup(t,e){let{slots:i,emit:n}=e;const r=ge(),s=ge(),o=ge(),{rtlClasses:a}=io();function l(x){if(!r.value||!s.value)return;const V=SC(x,r.value.$el,t.direction),N=SC(x,s.value.$el,t.direction),D=Math.abs(V),O=Math.abs(N);return D<O||D===O&&V<0?r.value.$el:s.value.$el}const c=I5(t),u=Oi(t,"modelValue",void 0,x=>x!=null&&x.length?x.map(V=>c.roundValue(V)):[0,0]),{activeThumbRef:h,hasLabels:d,max:f,min:m,mousePressed:g,onSliderMousedown:v,onSliderTouchstart:p,position:b,trackContainerRef:_}=O5({props:t,steps:c,onSliderStart:()=>{n("start",u.value)},onSliderEnd:x=>{var D;let{value:V}=x;const N=h.value===((D=r.value)==null?void 0:D.$el)?[V,u.value[1]]:[u.value[0],V];!t.strict&&N[0]<N[1]&&(u.value=N),n("end",u.value)},onSliderMove:x=>{var O,F,X,Z;let{value:V}=x;const[N,D]=u.value;!t.strict&&N===D&&N!==m.value&&(h.value=V>N?(O=s.value)==null?void 0:O.$el:(F=r.value)==null?void 0:F.$el,(X=h.value)==null||X.focus()),h.value===((Z=r.value)==null?void 0:Z.$el)?u.value=[Math.min(V,D),D]:u.value=[N,Math.max(N,V)]},getActiveThumb:l}),{isFocused:P,focus:E,blur:T}=uf(t),C=W(()=>b(u.value[0])),M=W(()=>b(u.value[1]));return Tt(()=>{const x=za.filterProps(t),V=!!(t.label||i.label||i.prepend);return w(za,ht({class:["v-slider","v-range-slider",{"v-slider--has-labels":!!i["tick-label"]||d.value,"v-slider--focused":P.value,"v-slider--pressed":g.value,"v-slider--disabled":t.disabled},a.value,t.class],style:t.style,ref:o},x,{focused:P.value}),{...i,prepend:V?N=>{var D,O;return w(mt,null,[((D=i.label)==null?void 0:D.call(i,N))??(t.label?w(RP,{class:"v-slider__label",text:t.label},null):void 0),(O=i.prepend)==null?void 0:O.call(i,N)])}:void 0,default:N=>{var F,X;let{id:D,messagesId:O}=N;return w("div",{class:"v-slider__container",onMousedown:v,onTouchstartPassive:p},[w("input",{id:`${D.value}_start`,name:t.name||D.value,disabled:!!t.disabled,readonly:!!t.readonly,tabindex:"-1",value:u.value[0]},null),w("input",{id:`${D.value}_stop`,name:t.name||D.value,disabled:!!t.disabled,readonly:!!t.readonly,tabindex:"-1",value:u.value[1]},null),w(D5,{ref:_,start:C.value,stop:M.value},{"tick-label":i["tick-label"]}),w(bC,{ref:r,"aria-describedby":O.value,focused:P&&h.value===((F=r.value)==null?void 0:F.$el),modelValue:u.value[0],"onUpdate:modelValue":Z=>u.value=[Z,u.value[1]],onFocus:Z=>{var K,z,H,re;E(),h.value=(K=r.value)==null?void 0:K.$el,u.value[0]===u.value[1]&&u.value[1]===m.value&&Z.relatedTarget!==((z=s.value)==null?void 0:z.$el)&&((H=r.value)==null||H.$el.blur(),(re=s.value)==null||re.$el.focus())},onBlur:()=>{T(),h.value=void 0},min:m.value,max:u.value[1],position:C.value,ripple:t.ripple},{"thumb-label":i["thumb-label"]}),w(bC,{ref:s,"aria-describedby":O.value,focused:P&&h.value===((X=s.value)==null?void 0:X.$el),modelValue:u.value[1],"onUpdate:modelValue":Z=>u.value=[u.value[0],Z],onFocus:Z=>{var K,z,H,re;E(),h.value=(K=s.value)==null?void 0:K.$el,u.value[0]===u.value[1]&&u.value[0]===f.value&&Z.relatedTarget!==((z=r.value)==null?void 0:z.$el)&&((H=s.value)==null||H.$el.blur(),(re=r.value)==null||re.$el.focus())},onBlur:()=>{T(),h.value=void 0},min:u.value[0],max:f.value,position:M.value,ripple:t.ripple},{"thumb-label":i["thumb-label"]})])}})}),{}}}),pPe={key:0},gPe={class:"text-subtitle-2",style:{color:"red"}},vPe={class:"text-subtitle-2"},yPe={class:"text-subtitle-2"},SPe={key:1,class:"text-subtitle-2",style:{color:"red"}},bPe=0,_Pe=0,TH=ri({__name:"FrontBackStyle",props:{panel:{}},setup(t){q1();const e=t,i=An(),{selectedSENodules:n,oldStyleSelections:r,styleSavedFromPanel:s}=Ji(i),{styleOptions:o,dataAgreement:a,forceDataAgreement:l,selectionCount:c,hasStyle:u,conflictingProps:h,angleMarkersSelected:d,oneDimensionSelected:f}=SH(e.panel,P,E),{t:m}=qn({useScope:"local"}),g=ge(o.value.strokeWidthPercent??100),v=ge(o.value.pointRadiusPercent??100),p=ge(o.value.angleMarkerRadiusPercent??100);function b(){Object.keys(_).forEach(Pe=>{_[Pe]=!1})}let _={angleMarkerRadiusPercent:!1,angleMarkerTickMark:!1,angleMarkerDoubleArc:!1,angleMarkerArrowHeads:!1,pointRadiusPercent:!1,strokeColor:!1,fillColor:!1,strokeWidthPercent:!1,dashArray:!1,reverseDashArray:!1};function P(ye){return ye.ref!==void 0}function E(ye){return ye.ref}const T=S.style.maxStrokeWidthPercent,C=S.style.minStrokeWidthPercent,M=[];ge(!1);const x=S.style.maxPointRadiusPercent,V=S.style.minPointRadiusPercent,N=[],D=S.style.maxAngleMarkerRadiusPercent,O=S.style.minAngleMarkerRadiusPercent,F=[],X=ge(0),Z=ge(0);let K=0,z=0,H=0,re=0;const ne=ge(!0);let B=!1;const Q=W(()=>he.value?m("backgroundStyle"):m("foregroundStyle"));function fe(ye){return ye?S.angleMarker.maxGapLengthOrDashLength:S.style.maxGapLengthOrDashLength}function ie(ye){return ye?S.angleMarker.sliderStepSize:S.style.sliderStepSize}const se=ge(pe.getBackStyleContrast()),ee=["Min","10%","20%","30%","40%","50%","60%","70%","80%","90%","Same"];function de(){i.changeBackContrast(se.value)}const Y=[];to(()=>{for(let ye=S.style.minStrokeWidthPercent;ye<=S.style.maxStrokeWidthPercent;ye+=20)M.push(ye.toFixed(0)+"%");for(let ye=S.style.minPointRadiusPercent;ye<=S.style.maxPointRadiusPercent;ye+=20)N.push(ye.toFixed(0)+"%");for(let ye=S.style.minAngleMarkerRadiusPercent;ye<S.style.maxAngleMarkerRadiusPercent;ye+=20)F.push(ye.toFixed(0)+"%")}),ki(()=>{$.listen("style-label-conflict-color-reset",te),$.listen("style-update-conflicting-props",ye=>{Y.splice(0),ye.propNames.forEach(Pe=>Y.push(Pe))}),$.listen("update-empty-dash-array",ye=>{console.log("set empty dash pattern"),ne.value=ye.emptyDashArray})});function te(){B=!1,b(),Oe(Y)}an(()=>{$.unlisten("style-label-conflict-color-reset"),$.unlisten("style-update-conflicting-props"),$.unlisten("update-empty-dash-array")});const he=W(()=>e.panel===q.Back);W(()=>e.panel===q.Front),W(()=>n.value.every(ye=>ye.showing));function ae(ye){if(ye.dashArray){B||(B=!0,ye.dashArray[0]===0&&ye.dashArray[1]===0?ne.value=!0:ne.value=!1,re=ye.dashArray[0],H=ye.dashArray[0],z=ye.dashArray[1],K=ye.dashArray[1]);const Pe=`(Dash:${ye.dashArray[1].toFixed(1)}/Gap:${ye.dashArray[0].toFixed(1)})`,we=`(Dash:${ye.dashArray[0].toFixed(1)}/Gap:${ye.dashArray[1].toFixed(1)})`;return ye.reverseDashArray?Pe:we}else return""}function A(ye,Pe){ye.dashArray&&(re=H,H=ye.dashArray[0],z=K,K=ye.dashArray[1])}function I(ye){var Pe,we;(Pe=ye.dashArray)==null||Pe.splice(0),(we=ye.dashArray)==null||we.push(H,K),$.fire("update-input-group-with-selector",{inputSelector:"dashArray"})}function G(ye){$.fire("update-input-group-with-selector",{inputSelector:ye})}function ue(ye){var Pe,we,j,R;!ne&&ye.dashArray?(K=z,H=re,(Pe=ye.dashArray)==null||Pe.splice(0),(we=ye.dashArray)==null||we.push(re,z)):ye.dashArray&&(z=K,re=H,(j=ye.dashArray)==null||j.splice(0),(R=ye.dashArray)==null||R.push(0,0)),X.value+=1,Z.value+=1,$.fire("update-input-group-with-selector",{inputSelector:"dashArray"})}function Se(ye,Pe){var R,J;const we=Pe?S.angleMarker.sliderStepSize:S.style.sliderStepSize,j=Pe?S.angleMarker.maxGapLengthOrDashLength:S.style.maxGapLengthOrDashLength;K+we<=j&&H+we<=j&&(z=K,re=H,K+=we,H+=we,ye.dashArray&&((R=ye.dashArray)==null||R.splice(0),(J=ye.dashArray)==null||J.push(H,K)))}function Ee(ye,Pe){var R,J;const we=Pe?S.angleMarker.sliderStepSize:S.style.sliderStepSize,j=0;K-we>=j&&H-we>=j&&(z=K,re=H,K-=we,H-=we,ye.dashArray&&((R=ye.dashArray)==null||R.splice(0),(J=ye.dashArray)==null||J.push(H,K)))}function Oe(ye){ye.forEach(Pe=>{_[Pe]=!0})}return(ye,Pe)=>(Te(),qe(wH,{"icon-name":he.value?"mdi-arrange-send-backward":"mdi-arrange-bring-forward",tooltip:Q.value,"tooltip-location":"left"},{tabs:U(()=>[w(wu,null,{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-format-color-fill")],void 0,!0),_:1})],void 0,!0),_:1}),w(wu,null,{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-format-line-style")],void 0,!0),_:1})],void 0,!0),_:1}),w(wu,null,{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-angle-acute")],void 0,!0),_:1})],void 0,!0),_:1})]),pages:U(()=>[w(Wm,{class:"pa-2"},{default:U(()=>[he.value?(Te(),Ct("div",pPe,[w(dr,{location:"bottom","max-width":"400px"},{activator:U(({props:we})=>[tt("p",k1(lP(we)),[tt("span",gPe,nt(le(m)("globalBackStyleContrast")+" "),1),tt("span",vPe,nt(le(m)("backStyleContrast"))+" "+nt(" ("+Math.floor(se.value*100)+"%)"),1)],16)]),default:U(()=>[tt("span",null,nt(le(m)("backStyleContrastToolTip")),1)],void 0,!0),_:1}),w(hp,{modelValue:se.value,"onUpdate:modelValue":Pe[0]||(Pe[0]=we=>se.value=we),min:0,step:.1,max:1,disabled:!le(o).dynamicBackStyle&&!le(a)(/dynamicBackStyle/),onChange:de,density:"compact"},{prepend:U(()=>[]),"thumb-label":U((...we)=>[$e(nt(ee[Math.floor(we.modelValue*10)]),1)]),append:U(()=>[]),_:1},8,["modelValue","disabled"])])):Vi("",!0),(le(u)(/strokeColor/),Te(),qe(Y_,{key:1,numSelected:le(c),title:le(m)("strokeColor"),conflict:le(_).strokeColor,onResetColor:Pe[1]||(Pe[1]=we=>le(_).strokeColor=!1),"style-name":"strokeColor",modelValue:le(o).strokeColor,"onUpdate:modelValue":Pe[2]||(Pe[2]=we=>le(o).strokeColor=we)},null,8,["numSelected","title","conflict","modelValue"])),(le(u)(/fillColor/),Te(),qe(Y_,{key:2,title:le(m)("fillColor"),numSelected:le(c),conflict:le(_).fillColor,onResetColor:Pe[3]||(Pe[3]=we=>le(_).fillColor=!1),"style-name":"fillColor",modelValue:le(o).fillColor,"onUpdate:modelValue":Pe[4]||(Pe[4]=we=>le(o).fillColor=we)},null,8,["title","numSelected","conflict","modelValue"]))],void 0,!0),_:1}),w(Wm,{class:"pa-2"},{default:U(()=>[(le(u)(/strokeWidthPercent/),Te(),qe(fv,{key:0,numSelected:le(c),conflict:le(_).strokeWidthPercent,modelValue:g.value,"onUpdate:modelValue":Pe[5]||(Pe[5]=we=>g.value=we),title:le(m)("strokeWidthPercent"),min:le(C),max:le(T),color:le(_).strokeWidthPercent?"red":"",onResetColor:Pe[6]||(Pe[6]=we=>le(_).strokeWidthPercent=!1),step:20,"thumb-string-values":M},null,8,["numSelected","conflict","modelValue","title","min","max","color"])),w(fv,{numSelected:le(c),modelValue:v.value,"onUpdate:modelValue":Pe[7]||(Pe[7]=we=>v.value=we),color:le(_).pointRadiusPercent?"red":"",conflict:le(_).pointRadiusPercent,onResetColor:Pe[8]||(Pe[8]=we=>le(_).pointRadiusPercent=!1),title:le(m)("pointRadiusPercent"),min:le(V),max:le(x),step:20,"thumb-string-values":N},null,8,["numSelected","modelValue","color","conflict","title","min","max","thumb-string-values"]),tt("span",yPe,nt(le(m)("dashPattern")),1),le(n).length>1?(Te(),Ct("span",SPe,nt(" "+ye.$t("labelStyleOptionsMultiple")),1)):Vi("",!0),fi(tt("span",null,nt(ae(le(o))),513),[[ln,!ne.value]]),(Te(),qe(mPe,{modelValue:le(o).dashArray,"onUpdate:modelValue":Pe[11]||(Pe[11]=we=>le(o).dashArray=we),key:X.value,min:"0",step:ie(le(u)(/angleMarker/)),disabled:ne.value,max:fe(le(u)(/angleMarker/)),color:le(_).dashArray?"red":"",onChange:Pe[12]||(Pe[12]=we=>{var j;A(le(o),((j=le(o))==null?void 0:j.dashArray)??[]),le(_).dashArray=!1}),density:"compact"},{prepend:U(()=>[w(lt,{onClick:Pe[9]||(Pe[9]=we=>Ee(le(o),le(u)(/angleMarker/)))},{default:U(()=>[$e(" mdi-minus ")],void 0,!0),_:1})]),append:U(()=>[w(lt,{onClick:Pe[10]||(Pe[10]=we=>Se(le(o),le(u)(/angleMarker/)))},{default:U(()=>[$e(" mdi-plus ")],void 0,!0),_:1})]),_:1},8,["modelValue","step","disabled","max","color"])),w(dr,{location:"bottom","max-width":"400px"},{activator:U(({props:we})=>[tt("span",vL(we,!0),[(Te(),qe(Py,{modelValue:ne.value,"onUpdate:modelValue":Pe[13]||(Pe[13]=j=>ne.value=j),key:bPe,"false-value":!0,"true-value":!1,color:le(_).dashArray?"red":"",onClick:Pe[14]||(Pe[14]=j=>{ue(le(o)),le(_).dashArray=!1}),"hide-details":"",density:"compact"},{label:U(()=>[tt("span",{style:mr({color:le(_).dashArray?"red":""})},nt(le(m)("dashPattern")),5)]),_:1},8,["modelValue","color"]))],16)]),default:U(()=>[$e(" "+nt(ye.$t("dashPatternCheckBoxToolTip")),1)],void 0,!0),_:1}),w(dr,{location:"bottom","max-width":"400px"},{activator:U(({props:we})=>[tt("span",vL(we,!0),[(Te(),qe(Py,{modelValue:le(o).reverseDashArray,"onUpdate:modelValue":Pe[15]||(Pe[15]=j=>le(o).reverseDashArray=j),key:_Pe,disabled:ne.value,color:le(_).reverseDashArray?"red":"",onClick:Pe[16]||(Pe[16]=j=>{I(le(o)),le(_).reverseDashArray=!1}),"hide-details":"",density:"compact"},{label:U(()=>[tt("span",{style:mr({color:le(_).reverseDashArray?"red":""})},nt(le(m)("dashArrayReverse")),5)]),_:1},8,["modelValue","disabled","color"]))],16)]),default:U(()=>[$e(" "+nt(ye.$t("dashPatternReverseArrayToolTip")),1)],void 0,!0),_:1})],void 0,!0),_:1}),w(Wm,{class:"pa-2"},{default:U(()=>[w(fv,{numSelected:le(c),color:le(_).angleMarkerRadiusPercent?"red":"",conflict:le(_).angleMarkerRadiusPercent,onResetColor:Pe[17]||(Pe[17]=we=>le(_).angleMarkerRadiusPercent=!1),modelValue:p.value,"onUpdate:modelValue":Pe[18]||(Pe[18]=we=>p.value=we),title:le(m)("angleMarkerRadiusPercent"),min:le(O),max:le(D),step:20,"thumb-string-values":F},null,8,["numSelected","color","conflict","modelValue","title","min","max","thumb-string-values"]),w(Ql,{modelValue:le(o).angleMarkerTickMark,"onUpdate:modelValue":Pe[19]||(Pe[19]=we=>le(o).angleMarkerTickMark=we),color:le(_).angleMarkerTickMark?"red":"",onChange:Pe[20]||(Pe[20]=we=>{G("angleMarkerRadiusPercent,angleMarkerTickMark,angleMarkerDoubleArc"),le(_).angleMarkerTickMark=!1})},{label:U(()=>[tt("span",{style:mr({color:le(_).angleMarkerTickMark?"red":""})},nt(le(m)("angleMarkerTickMark")),5)]),_:1},8,["modelValue","color"]),w(Ql,{modelValue:le(o).angleMarkerDoubleArc,"onUpdate:modelValue":Pe[21]||(Pe[21]=we=>le(o).angleMarkerDoubleArc=we),color:le(_).angleMarkerDoubleArc?"red":"",onChange:Pe[22]||(Pe[22]=we=>(G("angleMarkerRadiusPercent,angleMarkerTickMark,angleMarkerDoubleArc,angleMarkerAArrowHeads"),le(_).angleMarkerDoubleArc=!1))},{label:U(()=>[tt("span",{style:mr({color:le(_).angleMarkerDoubleArc?"red":""})},nt(le(m)("angleMarkerDoubleArc")),5)]),_:1},8,["modelValue","color"]),w(Ql,{modelValue:le(o).angleMarkerArrowHeads,"onUpdate:modelValue":Pe[23]||(Pe[23]=we=>le(o).angleMarkerArrowHeads=we),color:le(_).angleMarkerArrowHeads?"red":"",onChange:Pe[24]||(Pe[24]=we=>(G("angleMarkerRadiusPercent,angleMarkerTickMark,angleMarkerDoubleArc,angleMarkerArrowHeads"),le(_).angleMarkerArrowHeads=!1))},{label:U(()=>[tt("span",{style:mr({color:le(_).angleMarkerArrowHeads?"red":""})},nt(le(m)("angleMarkerArrowHeads")),5)]),_:1},8,["modelValue","color"])],void 0,!0),_:1})]),_:1},8,["icon-name","tooltip"]))}});function KF(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{angleMarkerArrowHeads:i=>{const{normalize:n}=i;return n(["Arrow Head"])},angleMarkerDoubleArc:i=>{const{normalize:n}=i;return n(["Double Arc"])},angleMarkerRadiusPercent:i=>{const{normalize:n}=i;return n(["Angle Marker Radius"])},angleMarkerTickMark:i=>{const{normalize:n}=i;return n(["Tick Mark"])},backgroundStyle:i=>{const{normalize:n}=i;return n(["Background Style"])},backStyleContrast:i=>{const{normalize:n}=i;return n(["Back Style Contrast"])},backStyleContrastToolTip:i=>{const{normalize:n}=i;return n(["By default the back side display style of an object is determined by the front style of that object and the value of Global Back Style Contrast. A Back Style Contrast of 100% means there is no color or size difference between front and back styling. A Back Style Contrast of 0% means that the object is invisible and its size reduction is maximized."])},dashArrayReverse:i=>{const{normalize:n}=i;return n(["Switch Dash and Gap"])},dashPattern:i=>{const{normalize:n}=i;return n(["Dash Pattern"])},dashPatternCheckBoxToolTip:i=>{const{normalize:n}=i;return n(["Enable or Disable a dash pattern for the selected objects."])},dashPatternReverseArrayToolTip:i=>{const{normalize:n}=i;return n(["Switch the dash and gap lengths so that the gap length can be less than the dash length"])},fillColor:i=>{const{normalize:n}=i;return n(["Fill Color"])},foregroundStyle:i=>{const{normalize:n}=i;return n(["Foreground Style"])},globalBackStyleContrast:i=>{const{normalize:n}=i;return n(["Global Back Style Contrast"])},labelStyleOptionsMultiple:i=>{const{normalize:n}=i;return n(["(Multiple)"])},pointRadiusPercent:i=>{const{normalize:n}=i;return n(["Point Radius (%)"])},strokeColor:i=>{const{normalize:n}=i;return n(["Stroke Color"])},strokeWidthPercent:i=>{const{normalize:n}=i;return n(["Stroke Width (%)"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"angleMarkerArrowHeads":"Arrow Head","angleMarkerDoubleArc":"Double Arc","angleMarkerRadiusPercent":"Angle Marker Radius","angleMarkerTickMark":"Tick Mark","backgroundStyle":"Background Style","backStyleContrast":"Back Style Contrast","backStyleContrastToolTip":"By default the back side display style of an object is determined by the front style of that object and the value of Global Back Style Contrast. A Back Style Contrast of 100% means there is no color or size difference between front and back styling. A Back Style Contrast of 0% means that the object is invisible and its size reduction is maximized.","dashArrayReverse":"Switch Dash and Gap","dashPattern":"Dash Pattern","dashPatternCheckBoxToolTip":"Enable or Disable a dash pattern for the selected objects.","dashPatternReverseArrayToolTip":"Switch the dash and gap lengths so that the gap length can be less than the dash length","fillColor":"Fill Color","foregroundStyle":"Foreground Style","globalBackStyleContrast":"Global Back Style Contrast","labelStyleOptionsMultiple":"(Multiple)","pointRadiusPercent":"Point Radius (%)","strokeColor":"Stroke Color","strokeWidthPercent":"Stroke Width (%)"}}'),delete e._Ctor}typeof KF=="function"&&KF(TH);const XF=Tn(TH,[["__scopeId","data-v-8cb2a4ff"]]),PPe={key:0,class:"vertical-nav-drawer"},EPe={id:"visibility-control"},xH=ri({__name:"StyleDrawer",setup(t){const e=ge(!0),{t:i}=qn();return(n,r)=>(Te(),Ct(mt,null,[e.value?(Te(),qe(Qt,{key:0,id:"style-icon",icon:"",size:"small",style:{position:"fixed",right:"0","border-radius":"8px","background-color":"#002108",color:"white"},onClick:r[0]||(r[0]=s=>e.value=!e.value)},{default:U(()=>[w(dr,{activator:"parent",location:"bottom"},{default:U(()=>[$e(nt(le(i)("showDrawer")),1)],void 0,!0),_:1}),w(lt,null,{default:U(()=>[$e("mdi-palette")],void 0,!0),_:1})],void 0),_:1})):Vi("",!0),w(xo,null,{default:U(()=>[e.value?Vi("",!0):(Te(),Ct("div",PPe,[w(dPe,{panel:le(q).Label},null,8,["panel"]),w(XF,{panel:le(q).Front},null,8,["panel"]),w(XF,{panel:le(q).Back},null,8,["panel"]),tt("div",EPe,[tt("span",null,[$e(nt(le(i)("label"))+" ",1),w(lt,{color:"black"},{default:U(()=>[$e("mdi-eye")],void 0,!0),_:1})]),tt("span",null,[$e(nt(le(i)("object"))+" ",1),w(lt,{color:"black"},{default:U(()=>[$e("mdi-eye")],void 0,!0),_:1})])]),w(Qt,{icon:"",size:"x-small",onClick:r[1]||(r[1]=s=>e.value=!e.value)},{default:U(()=>[w(lt,null,{default:U(()=>[$e("mdi-chevron-double-right")],void 0,!0),_:1})],void 0,!0),_:1})]))],void 0),_:1})],64))}});function YF(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"",resource:{en:{showDrawer:i=>{const{normalize:n}=i;return n(["Show Style Drawer"])},label:i=>{const{normalize:n}=i;return n(["Label"])},object:i=>{const{normalize:n}=i;return n(["Object"])}},id:{showDrawer:i=>{const{normalize:n}=i;return n(["Buka Panel Gaya Tampilan"])},label:i=>{const{normalize:n}=i;return n(["Label"])},object:i=>{const{normalize:n}=i;return n(["Objek"])}}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"showDrawer":"Show Style Drawer","label":"Label","object":"Object"},"id":{"showDrawer":"Buka Panel Gaya Tampilan","label":"Label","object":"Objek"}}'),delete e._Ctor}typeof YF=="function"&&YF(xH);const wPe=Tn(xH,[["__scopeId","data-v-9344d021"]]),$V=t=>(Q8("data-v-6ebc8a8b"),t=t(),e6(),t),TPe={style:{position:"fixed",right:"8px",width:"80px",top:"0",bottom:"0",display:"flex","flex-direction":"column","justify-content":"center","z-index":"1"}},xPe={id:"toolbox-and-sphere"},kPe={id:"toolbox"},CPe={id:"sphere-and-msghub"},MPe={key:0,id:"earthAndCircle"},APe=["model-value"],VPe=["src","width","height"],LPe={id:"msghub"},IPe={id:"zoomPanel",class:"pr-5"},OPe={style:{display:"flex"}},DPe=$V(()=>tt("div",{class:"horizontalLine"},null,-1)),NPe={style:{display:"flex"}},RPe=$V(()=>tt("div",{class:"horizontalLine"},null,-1)),FPe={style:{display:"flex"}},zPe=$V(()=>tt("div",{class:"horizontalLine"},null,-1)),UPe={style:{"padding-left":"15px"}},BPe=25,ZF=5e3,kH=ri({__name:"Easel",props:{documentId:{}},setup(t){const e=fS(),i=cE(),{t:n}=qn(),r=An(),s=LP(),{seNodules:o,temporaryNodules:a,hasObjects:l,zoomMagnificationFactor:c,isEarthMode:u}=Ji(r),h=t,{mainRect:d}=jM(),f=Dp(),m=W(()=>f.height.value-d.value.top),g=W(()=>m.value-60),v=W(()=>[rl.get("undoAction"),rl.get("redoAction")]),p=ge(""),b=ge({}),_=ge(!1);let P=!1,E=null;const T=ge(null),C=ge(!1),M=ge(""),x=ge(1);let V;to(()=>{$.listen("magnification-updated",re),$.listen("preview-construction",N)});const N=B=>{B!==null?(console.debug("Previewing construction",B),M.value===""&&(p.value="preview-fadein"),M.value=B.preview,x.value=B.aspectRatio??1,b.value.author=B.author,b.value.count=B.objectCount):(p.value="preview-fadeout",M.value="")},D=ge(100),O=ge(100);function F(){O.value=f.width.value*(1-BPe/100)-d.value.left-d.value.right,D.value=f.height.value-d.value.bottom-d.value.top-80}function X(B){r.removeAllFromLayers(),r.init(),Xe.resetAllCounters(),yy(vl(e,"constructions",B)).then(Q=>{const{author:fe,constructionDocId:ie}=Q.data();return yy(vl(e,"users",fe,"constructions",ie))}).then(async Q=>{if(Q.exists()){const{script:fe}=Q.data();if(fe.startsWith("https:")){const ie=Mu(i,fe),se=await dp(ie).then(ee=>N_.get(ee)).then(ee=>ee.data);_C(JSON.parse(se))}else _C(JSON.parse(fe));r.updateDisplay()}else $.fire("show-alert",{key:"constructions.constructionNotFound",keyOptions:{docId:B},type:"error"})})}ki(()=>{window.addEventListener("resize",F),F(),h.documentId&&X(h.documentId),$.listen("set-action-mode-to-select-tool",Z),$.listen("initiate-clear-construction",K),window.addEventListener("keydown",H)}),an(()=>{$.unlisten("set-action-mode-to-select-tool"),window.removeEventListener("keydown",H)});function Z(){r.setActionMode("select")}function K(){C.value=!0,V=setTimeout(()=>{r.removeAllFromLayers(),r.init(),L.commandHistory.splice(0),L.redoHistory.splice(0),Xe.resetAllCounters(),$.fire("undo-enabled",{value:L.commandHistory.length>0}),$.fire("redo-enabled",{value:L.redoHistory.length>0})},ZF)}function z(){V&&(clearTimeout(V),V=null),C.value=!1}function H(B){navigator.userAgent.indexOf("Mac OS X")!==-1?B.code==="KeyZ"&&!B.shiftKey&&B.metaKey?L.undo():B.code==="KeyZ"&&B.shiftKey&&B.metaKey&&L.redo():B.code==="KeyZ"&&!B.shiftKey&&B.ctrlKey?L.undo():B.code==="KeyY"&&!B.shiftKey&&B.ctrlKey&&L.redo()}function re(B){_s.updateCurrentStrokeWidthForZoom(B.factor),Ws.updateCurrentStrokeWidthForZoom(B.factor),Sa.updateCurrentStrokeWidthForZoom(B.factor),ih.updateCurrentStrokeWidthAndRadiusForZoom(B.factor),mi.updatePointScaleFactorForZoom(B.factor),p_.updateTextScaleFactorForZoom(B.factor),ll.updateCurrentStrokeWidthForZoom(B.factor),Kv.updateCurrentStrokeWidthForZoom(B.factor),o.value.forEach(Q=>{var fe;(fe=Q.ref)==null||fe.adjustSize()}),a.value.forEach(Q=>{Q.adjustSize()})}function ne(){P=!0,E&&s.replace({path:E.path})}return He(()=>u.value,()=>{_.value=!_.value}),dae((B,Q)=>{var fe;return l.value&&!P?((fe=T.value)==null||fe.show(),E=B,!1):!0}),(B,Q)=>(Te(),Ct(mt,null,[tt("div",TPe,[w(wPe)]),tt("div",xPe,[tt("div",kPe,[w(hSe,{id:"toolbox",ref:"toolbox"},null,512)]),tt("div",CPe,[M.value.length===0?(Te(),Ct("div",MPe,[_.value?(Te(),qe(L0e,{key:0,"available-height":D.value,"available-width":O.value},null,8,["available-height","available-width"])):Vi("",!0),w(ASe,{style:{position:"relative"},"available-width":O.value,"available-height":D.value,"is-earth-mode":_.value},null,8,["available-width","available-height","is-earth-mode"])])):(Te(),Ct("div",{key:1,class:Gs(["justify-center","align-start",p.value]),"model-value":M.value.length>0},[$e(" Aspect ratio "+nt(x.value)+" ",1),tt("img",{id:"previewImage",src:M.value,width:g.value*x.value,height:g.value},null,8,VPe)],10,APe)),tt("div",LPe,[(Te(!0),Ct(mt,null,Zs(v.value,fe=>(Te(),qe(ud,{class:"mx-1",key:fe.action,model:fe},null,8,["model"]))),128)),w(ud,{disabled:!le(l),class:"mx-1",model:le(rl).get("resetAction")},null,8,["disabled","model"]),w(z0e),tt("div",IPe,[tt("div",OPe,[w(ud,{isShortcutTool:!0,class:"mx-1",model:le(rl).get("zoomFit")},null,8,["model"]),DPe]),tt("div",NPe,[w(ud,{isShortcutTool:!0,class:"mx-1",model:le(rl).get("zoomOut")},null,8,["model"]),RPe]),tt("div",FPe,[w(ud,{isShortcutTool:!0,class:"mx-1",model:le(rl).get("zoomIn")},null,8,["model"]),zPe]),tt("span",UPe,nt((100*le(c)).toFixed(2)),1)])])]),w(xu,{ref_key:"unsavedWorkDialog",ref:T,"max-width":"40%",title:le(n)("unsavedConstructionsConfirmation"),"yes-text":le(n)("constructionsKeep"),"no-text":le(n)("constructionsDiscard"),"no-action":ne},{default:U(()=>[$e(nt(le(n)("unsavedConstructionsMessage")),1)],void 0),_:1},8,["title","yes-text","no-text"]),w(CV,{modelValue:C.value,"onUpdate:modelValue":Q[0]||(Q[0]=fe=>C.value=fe),timeout:ZF},{actions:U(()=>[w(Qt,{onClick:z,color:"warning"},{default:U(()=>[$e(nt(le(n)("undo")),1)],void 0,!0),_:1})]),default:U(()=>[$e(nt(le(n)("clearConstructionMessage"))+" ",1)],void 0),_:1},8,["modelValue"])])],64))}});function JF(t){const e=t.options||t;e.__i18n=e.__i18n||[],e.__i18n.push({locale:"en",resource:{clearConstructionMessage:i=>{const{normalize:n}=i;return n(["The current construction will be cleared"])},unsavedConstructionsMessage:i=>{const{normalize:n}=i;return n(["You have unsaved constructions. Keep or discard?"])},unsavedConstructionsConfirmation:i=>{const{normalize:n}=i;return n(["Unsaved Constructions"])},constructionsDiscard:i=>{const{normalize:n}=i;return n(["Discard"])},constructionsKeep:i=>{const{normalize:n}=i;return n(["Keep"])},undo:i=>{const{normalize:n}=i;return n(["Undo"])}}}),e.__i18nBridge=e.__i18nBridge||[],e.__i18nBridge.push('{"en":{"clearConstructionMessage":"The current construction will be cleared","unsavedConstructionsMessage":"You have unsaved constructions. Keep or discard?","unsavedConstructionsConfirmation":"Unsaved Constructions","constructionsDiscard":"Discard","constructionsKeep":"Keep","undo":"Undo"}}'),delete e._Ctor}typeof JF=="function"&&JF(kH);const QF=Tn(kH,[["__scopeId","data-v-6ebc8a8b"]]),jPe=ri({__name:"Login",setup(t){const e=Fp(),i=fS(),n=LP(),r=Eh(),s=ge(""),o=ge(""),{userDisplayedName:a,userProfilePictureURL:l}=Ji(r),c=[b=>b?b.indexOf("@")>0?!0:"Missing '@'?":!1],u=[b=>b?b.length>=6?!0:"Password must be at least 6 characters":!1],h=ge(!1),d=W(()=>c.map(b=>b(s.value)).every(b=>typeof b=="boolean"&&b));function f(){wY(e,s.value,o.value).then(b=>{var _;xY(b.user),$.fire("show-alert",{key:"account.emailVerification",keyOptions:{emailAddr:(_=b.user)==null?void 0:_.email},type:"info"})}).catch(b=>{$.fire("show-alert",{key:"account.createError",keyOptions:{error:b},type:"error"})})}function m(b){yy(vl(i,"users",b)).then(_=>{if(_!=null&&_.exists()){const P=_.data();console.debug("User Profile Details from Firestore",P);const{favoriteTools:E,displayName:T,profilePictureURL:C}=P;a.value===void 0&&(r.userDisplayedName=T),l.value===void 0&&(r.userProfilePictureURL=C),r.parseAndSetFavoriteTools(E??"#")}})}function g(){TY(e,s.value,o.value).then(b=>{var _;(_=b.user)!=null&&_.emailVerified?(m(b.user.uid),n.replace({path:"/"})):$.fire("show-alert",{key:"account.emailNotVerified",keyOptions:void 0,type:"warning"})}).catch(b=>{$.fire("show-alert",{key:"account.loginError",keyOptions:{error:b},type:"error"})})}function v(){console.debug("Sending password reset email to",s.value),EY(e,s.value).then(()=>{$.fire("show-alert",{key:"account.passwordReset",keyOptions:{emailAddr:s.value},type:"info"})})}function p(){const b=new zc;XY(e,b).then(_=>{m(_.user.uid),n.replace({path:"/"})}).catch(_=>{console.debug("Error attempting to login with Google account",_),$.fire("show-alert",{key:"account.loginError",keyOptions:{error:_},type:"error"})})}return(b,_)=>(Te(),qe(Ph,{fluid:""},{default:U(()=>[w(pr,{justify:"center"},{default:U(()=>[w(Si,{cols:"5"},{default:U(()=>[w(mo,{elevation:"4",class:"pa-4"},{default:U(()=>[w(V5,{modelValue:h.value,"onUpdate:modelValue":_[2]||(_[2]=P=>h.value=P)},{default:U(()=>[w(pr,{class:"flex-column mb-2"},{default:U(()=>[w(Si,{cols:"auto"},{default:U(()=>[w(vr,{label:"UserId/Email",modelValue:s.value,"onUpdate:modelValue":_[0]||(_[0]=P=>s.value=P),rules:c,required:"","prepend-icon":"mdi-account"},null,8,["modelValue"])],void 0,!0),_:1}),w(Si,{cols:"auto"},{default:U(()=>[w(vr,{label:"Password",modelValue:o.value,"onUpdate:modelValue":_[1]||(_[1]=P=>o.value=P),type:"password",rules:u,"prepend-icon":"mdi-lock"},null,8,["modelValue"])],void 0,!0),_:1}),w(Si,{cols:"auto"},{default:U(()=>[w(pr,null,{default:U(()=>[w(Si,{cols:"auto"},{default:U(()=>[w(Qt,{onClick:f,disabled:!h.value},{default:U(()=>[$e(" Signup ")],void 0,!0),_:1},8,["disabled"])],void 0,!0),_:1}),w(Si,{cols:"auto"},{default:U(()=>[w(Qt,{disabled:!d.value,onClick:v},{default:U(()=>[$e(" Reset Password ")],void 0,!0),_:1},8,["disabled"])],void 0,!0),_:1}),w(Si,{cols:"auto"},{default:U(()=>[w(Qt,{color:"primary",onClick:g,disabled:!h.value},{default:U(()=>[$e(" Signin ")],void 0,!0),_:1},8,["disabled"])],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1}),w(ch),w(pr,null,{default:U(()=>[w(Si,{cols:"auto"},{default:U(()=>[$e("or use other account providers")],void 0,!0),_:1})],void 0,!0),_:1}),w(pr,null,{default:U(()=>[w(Si,{cols:"4"},{default:U(()=>[w(Qt,{onClick:p},{default:U(()=>[w(lt,{left:""},{default:U(()=>[$e("mdi-google")],void 0,!0),_:1}),$e(" Google ")],void 0,!0),_:1})],void 0,!0),_:1}),w(Si,{cols:"4"},{default:U(()=>[w(Qt,{disabled:""},{default:U(()=>[w(lt,{left:""},{default:U(()=>[$e("mdi-yahoo")],void 0,!0),_:1}),$e(" Yahoo ")],void 0,!0),_:1})],void 0,!0),_:1}),w(Si,{cols:"4"},{default:U(()=>[w(Qt,{disabled:""},{default:U(()=>[w(lt,{left:""},{default:U(()=>[$e("mdi-facebook")],void 0,!0),_:1}),$e(" Facebook ")],void 0,!0),_:1})],void 0,!0),_:1}),w(Si,{cols:"4"},{default:U(()=>[w(Qt,{disabled:""},{default:U(()=>[w(lt,{left:""},{default:U(()=>[$e("mdi-twitter")],void 0,!0),_:1}),$e(" Twitter ")],void 0,!0),_:1})],void 0,!0),_:1}),w(Si,{cols:"4"},{default:U(()=>[w(Qt,{disabled:""},{default:U(()=>[w(lt,{left:""},{default:U(()=>[$e("mdi-github")],void 0,!0),_:1}),$e(" GitHub ")],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1},8,["modelValue"])],void 0,!0),_:1})],void 0,!0),_:1})],void 0,!0),_:1})],void 0),_:1}))}});function ez(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),i.push.apply(i,n)}return i}function $i(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?ez(Object(i),!0).forEach(function(n){ka(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ez(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function ka(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function $Pe(t,e){if(t==null)return{};var i,n,r=function(o,a){if(o==null)return{};var l,c,u={},h=Object.keys(o);for(c=0;c<h.length;c++)l=h[c],a.indexOf(l)>=0||(u[l]=o[l]);return u}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)i=s[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}function Xd(t){return function(e){if(Array.isArray(e))return Ax(e)}(t)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||function(e,i){if(e){if(typeof e=="string")return Ax(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ax(e,i)}}(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ax(t,e){(e==null||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var tz,WPe,Xb,kr=(tz=function(t){/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var e={}.hasOwnProperty;function i(){for(var n=[],r=0;r<arguments.length;r++){var s=arguments[r];if(s){var o=typeof s;if(o==="string"||o==="number")n.push(s);else if(Array.isArray(s)){if(s.length){var a=i.apply(null,s);a&&n.push(a)}}else if(o==="object")if(s.toString===Object.prototype.toString)for(var l in s)e.call(s,l)&&s[l]&&n.push(l);else n.push(s.toString())}}return n.join(" ")}t.exports?(i.default=i,t.exports=i):window.classNames=i})()},tz(Xb={path:WPe,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(e==null&&Xb.path)}},Xb.exports),Xb.exports),kl=function(t){return function(e,i){if(!e)return t;var n;typeof e=="string"?n=e:i=e;var r=t;return n&&(r+="__"+n),r+(i?Object.keys(i).reduce(function(s,o){var a=i[o];return a&&(s+=" "+(typeof a=="boolean"?r+"--"+o:r+"--"+o+"_"+a)),s},""):"")}};function g1(t,e,i){var n,r,s,o,a;function l(){var u=Date.now()-o;u<e&&u>=0?n=setTimeout(l,e-u):(n=null,i||(a=t.apply(s,r),s=r=null))}e==null&&(e=100);var c=function(){s=this,r=arguments,o=Date.now();var u=i&&!n;return n||(n=setTimeout(l,e)),u&&(a=t.apply(s,r),s=r=null),a};return c.clear=function(){n&&(clearTimeout(n),n=null)},c.flush=function(){n&&(a=t.apply(s,r),s=r=null,clearTimeout(n),n=null)},c}g1.debounce=g1;var v1=g1,Bt=function(){return Bt=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Bt.apply(this,arguments)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function CH(t,e){var i,n;return t&&e?(i=""+t+e[0].toUpperCase()+e.slice(1),n=t+"-"+e):(i=t||e,n=t||e),{name:i,classname:n}}function MH(t){return/^blob:/.test(t)}function iz(t){return MH(t)||function(e){return/^data:/.test(e)}(t)}function tm(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Rr(t){return t===void 0}function O0(t){return typeof t=="object"&&t!==null}function y1(t,e,i){var n={};return O0(t)?(Object.keys(e).forEach(function(r){Rr(t[r])?n[r]=e[r]:O0(e[r])?O0(t[r])?n[r]=y1(t[r],e[r],i[r]):n[r]=t[r]?e[r]:i[r]:e[r]===!0||e[r]===!1?n[r]=!!t[r]:n[r]=t[r]}),n):t?e:i}function Yb(t){var e=Number(t);return Number.isNaN(e)?t:e}function nz(t){return typeof(t=="number"||function(e){return typeof e=="object"&&e!==null}(t)&&toString.call(t)=="[object Number]")&&!AH(t)}function AH(t){return t!=t}function VH(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}var pv=function(t,e){t===void 0&&(t={}),e===void 0&&(e={}),this.type="manipulateImage",this.move=t,this.scale=e},GPe=function(t,e){e===void 0&&(e={}),this.type="resize",this.directions=t,this.params=e},WV=function(t){this.type="move",this.directions=t},HPe=function(){function t(e,i,n,r,s){this.type="drag",this.nativeEvent=e,this.position=n,this.previousPosition=r,this.element=i,this.anchor=s}return t.prototype.shift=function(){var e=this,i=e.element,n=e.anchor,r=e.position;if(i){var s=i.getBoundingClientRect(),o=s.left,a=s.top;return{left:r.left-o-n.left,top:r.top-a-n.top}}return{left:0,top:0}},t}(),GV={name:"DraggableElement",props:{classname:{type:String}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){if(!this.$refs.draggable)throw new Error('You should add ref "draggable" to your root element to use draggable mixin');this.touches=[],this.hovered=!1},methods:{onMouseOver:function(){this.hovered||(this.hovered=!0,this.$emit("enter"))},onMouseLeave:function(){this.hovered&&!this.touches.length&&(this.hovered=!1,this.$emit("leave"))},onTouchStart:function(t){t.cancelable&&!this.disabled&&t.touches.length===1&&(this.touches=Xd(t.touches),this.hovered||(this.$emit("enter"),this.hovered=!0),t.touches.length&&this.initAnchor(this.touches.reduce(function(e,i){return{clientX:e.clientX+i.clientX/t.touches.length,clientY:e.clientY+i.clientY/t.touches.length}},{clientX:0,clientY:0})),t.preventDefault&&t.preventDefault(),t.stopPropagation())},onTouchEnd:function(){this.processEnd()},onTouchMove:function(t){this.touches.length&&(this.processMove(t,t.touches),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation())},onMouseDown:function(t){if(!this.disabled){var e={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[e],this.initAnchor(e),t.stopPropagation()}},onMouseMove:function(t){this.touches.length&&(this.processMove(t,[{fake:!0,clientX:t.clientX,clientY:t.clientY}]),t.preventDefault&&t.preventDefault())},onMouseUp:function(){this.processEnd()},initAnchor:function(t){var e=this.$refs.draggable.getBoundingClientRect(),i=e.left,n=e.right,r=e.bottom,s=e.top;this.anchor={left:t.clientX-i,top:t.clientY-s,bottom:r-t.clientY,right:n-t.clientX}},processMove:function(t,e){var i=Xd(e);if(this.touches.length){if(this.touches.length===1&&i.length===1){var n=this.$refs.draggable;this.$emit("drag",new HPe(t,n,{left:i[0].clientX,top:i[0].clientY},{left:this.touches[0].clientX,top:this.touches[0].clientY},this.anchor))}this.touches=i}},processEnd:function(){this.touches.length&&this.$emit("drag-end"),this.hovered&&(this.$emit("leave"),this.hovered=!1),this.touches=[]}},emits:["drag","drag-end","leave","enter"]};GV.render=function(t,e,i,n,r,s){return Te(),qe("div",{ref:"draggable",class:i.classname,onTouchstart:e[1]||(e[1]=function(){return s.onTouchStart&&s.onTouchStart.apply(s,arguments)}),onMousedown:e[2]||(e[2]=function(){return s.onMouseDown&&s.onMouseDown.apply(s,arguments)}),onMouseover:e[3]||(e[3]=function(){return s.onMouseOver&&s.onMouseOver.apply(s,arguments)}),onMouseleave:e[4]||(e[4]=function(){return s.onMouseLeave&&s.onMouseLeave.apply(s,arguments)})},[Ma(t.$slots,"default")],34)};var Vx=kl("vue-handler-wrapper"),LH={name:"HandlerWrapper",components:{DraggableElement:GV},props:{horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},computed:{classes:function(){var t;if(this.horizontalPosition||this.verticalPosition){var e,i=CH(this.horizontalPosition,this.verticalPosition);t=Vx((ka(e={},i.classname,!0),ka(e,"disabled",this.disabled),e))}else t=Vx({disabled:this.disabled});return{root:t,draggable:Vx("draggable")}}},emits:["leave","enter","drag","drag-end"]};LH.render=function(t,e,i,n,r,s){var o=ml("DraggableElement");return Te(),qe("div",{class:s.classes.root},[w(o,{class:s.classes.draggable,onDrag:e[1]||(e[1]=function(a){return t.$emit("drag",a)}),onDragEnd:e[2]||(e[2]=function(a){return t.$emit("drag-end")}),onLeave:e[3]||(e[3]=function(a){return t.$emit("leave")}),onEnter:e[4]||(e[4]=function(a){return t.$emit("enter")})},{default:U(function(){return[Ma(t.$slots,"default")]}),_:3},8,["class"])],2)};var qPe=kl("vue-line-wrapper"),IH={name:"LineWrapper",components:{DraggableElement:GV},props:{position:{type:String,required:!0},disabled:{type:Boolean,default:!1}},computed:{classname:function(){var t;return qPe((ka(t={},this.position,!0),ka(t,"disabled",this.disabled),t))}},emits:["leave","enter","drag","drag-end"]};IH.render=function(t,e,i,n,r,s){var o=ml("DraggableElement");return Te(),qe(o,{class:s.classname,onDrag:e[1]||(e[1]=function(a){return t.$emit("drag",a)}),onDragEnd:e[2]||(e[2]=function(a){return t.$emit("drag-end")}),onLeave:e[3]||(e[3]=function(a){return t.$emit("leave")}),onEnter:e[4]||(e[4]=function(a){return t.$emit("enter")})},{default:U(function(){return[Ma(t.$slots,"default")]}),_:3},8,["class"])};var Wl=["left","right","top","bottom"],KPe=["left","right"],XPe=["top","bottom"],YPe=["left","top"],ZPe=["fill-area","fit-area","stencil","none"],rz={left:0,top:0,width:0,height:0};function sz(t,e,i){return!(i=i||["width","height","left","top"]).some(function(n){return t[n]!==e[n]})}function yc(t){return{left:t.left,top:t.top,right:t.left+t.width,bottom:t.top+t.height}}function Tp(t,e){return{left:t.left-e.left,top:t.top-e.top}}function ss(t){return{left:t.left+t.width/2,top:t.top+t.height/2}}function Ty(t,e){var i={left:0,top:0,right:0,bottom:0};return Wl.forEach(function(n){var r=e[n],s=yc(t)[n];i[n]=r!==void 0&&s!==void 0?n==="left"||n==="top"?Math.max(0,r-s):Math.max(0,s-r):0}),i}function zl(t,e){return{left:t.left-e.left,top:t.top-e.top,width:t.width+e.left+e.right,height:t.height+e.top+e.bottom}}function ZE(t){return{left:-t.left,top:-t.top}}function wo(t,e){return Bt(Bt({},t),{left:t.left+e.left,top:t.top+e.top})}function La(t,e,i,n){if(e!==1){if(i){var r=ss(t);return{width:t.width*e,height:t.height*e,left:t.left+t.width*(1-e)/2+(i.left-r.left)*(n||1-e),top:t.top+t.height*(1-e)/2+(i.top-r.top)*(n||1-e)}}return{width:t.width*e,height:t.height*e,left:t.left+t.width*(1-e)/2,top:t.top+t.height*(1-e)/2}}return t}function Hi(t){return t.width/t.height}function xp(t,e){return Math.min(e.right!==void 0&&e.left!==void 0?(e.right-e.left)/t.width:1/0,e.bottom!==void 0&&e.top!==void 0?(e.bottom-e.top)/t.height:1/0)}function kp(t,e){var i={left:0,top:0},n=Ty(t,e);return n.left&&n.left>0?i.left=n.left:n.right&&n.right>0&&(i.left=-n.right),n.top&&n.top>0?i.top=n.top:n.bottom&&n.bottom>0&&(i.top=-n.bottom),i}function Lx(t,e){var i;return e.minimum&&t<e.minimum?i=e.minimum:e.maximum&&t>e.maximum&&(i=e.maximum),i}function OH(t,e){var i=Hi(t),n=Hi(e);return e.width<1/0&&e.height<1/0?i>n?{width:e.width,height:e.width/i}:{width:e.height*i,height:e.height}:e.width<1/0?{width:e.width,height:e.width/i}:e.height<1/0?{width:e.height*i,height:e.height}:t}function DH(t,e){var i=e*Math.PI/180;return{width:Math.abs(t.width*Math.cos(i))+Math.abs(t.height*Math.sin(i)),height:Math.abs(t.width*Math.sin(i))+Math.abs(t.height*Math.cos(i))}}function cu(t,e){var i=e*Math.PI/180;return{left:t.left*Math.cos(i)-t.top*Math.sin(i),top:t.left*Math.sin(i)+t.top*Math.cos(i)}}function JE(t,e){var i=Ty(os(t,e),e);return i.left+i.right+i.top+i.bottom?i.left+i.right>i.top+i.bottom?Math.min((t.width+i.left+i.right)/t.width,xp(t,e)):Math.min((t.height+i.top+i.bottom)/t.height,xp(t,e)):1}function os(t,e,i){i===void 0&&(i=!1);var n=kp(t,e);return wo(t,i?ZE(n):n)}function S1(t){return{width:t.right!==void 0&&t.left!==void 0?t.right-t.left:1/0,height:t.bottom!==void 0&&t.top!==void 0?t.bottom-t.top:1/0}}function JPe(t,e){return Bt(Bt({},t),{minWidth:Math.min(e.width,t.minWidth),minHeight:Math.min(e.height,t.minHeight),maxWidth:Math.min(e.width,t.maxWidth),maxHeight:Math.min(e.height,t.maxHeight)})}function NH(t,e,i){i===void 0&&(i=!0);var n={};return Wl.forEach(function(r){var s=t[r],o=e[r];s!==void 0&&o!==void 0?n[r]=r==="left"||r==="top"?i?Math.max(s,o):Math.min(s,o):i?Math.min(s,o):Math.max(s,o):o!==void 0?n[r]=o:s!==void 0&&(n[r]=s)}),n}function QE(t,e){return NH(t,e,!0)}function oz(t){var e=t.size,i=t.aspectRatio,n=t.ignoreMinimum,r=t.sizeRestrictions;return!!((e.correctRatio||Hi(e)>=i.minimum&&Hi(e)<=i.maximum)&&e.height<=r.maxHeight&&e.width<=r.maxWidth&&e.width&&e.height&&(n||e.height>=r.minHeight&&e.width>=r.minWidth))}function az(t,e){return Math.pow(t.width-e.width,2)+Math.pow(t.height-e.height,2)}function Jc(t){var e=t.width,i=t.height,n=t.sizeRestrictions,r={minimum:t.aspectRatio&&t.aspectRatio.minimum||0,maximum:t.aspectRatio&&t.aspectRatio.maximum||1/0},s={width:Math.max(n.minWidth,Math.min(n.maxWidth,e)),height:Math.max(n.minHeight,Math.min(n.maxHeight,i))};function o(c,u){return u===void 0&&(u=!1),c.reduce(function(h,d){return oz({size:d,aspectRatio:r,sizeRestrictions:n,ignoreMinimum:u})&&(!h||az(d,{width:e,height:i})<az(h,{width:e,height:i}))?d:h},null)}var a=[];r&&[r.minimum,r.maximum].forEach(function(c){c&&a.push({width:s.width,height:s.width/c,correctRatio:!0},{width:s.height*c,height:s.height,correctRatio:!0})}),oz({size:s,aspectRatio:r,sizeRestrictions:n})&&a.push(s);var l=o(a)||o(a,!0);return l&&{width:l.width,height:l.height}}function b1(t){var e=t.event,i=t.coordinates,n=t.positionRestrictions,r=n===void 0?{}:n,s=wo(i,e.directions);return wo(s,kp(s,r))}function QPe(t){var e=t.coordinates,i=t.transform,n=t.imageSize,r=t.sizeRestrictions,s=t.positionRestrictions,o=t.aspectRatio,a=t.visibleArea,l=function(u,h){return b1({coordinates:u,positionRestrictions:s,event:new WV({left:h.left-u.left,top:h.top-u.top})})},c=Bt({},e);return(Array.isArray(i)?i:[i]).forEach(function(u){var h={};Rr((h=typeof u=="function"?u({coordinates:c,imageSize:n,visibleArea:a}):u).width)&&Rr(h.height)||(c=function(d,f){var m=Bt(Bt(Bt({},d),Jc({width:f.width,height:f.height,sizeRestrictions:r,aspectRatio:o})),{left:0,top:0});return l(m,{left:d.left,top:d.top})}(c,Bt(Bt({},c),h))),Rr(h.left)&&Rr(h.top)||(c=l(c,Bt(Bt({},c),h)))}),c}function eEe(t){t.event;var e=t.getAreaRestrictions,i=t.boundaries,n=t.coordinates,r=t.visibleArea;t.aspectRatio;var s=t.stencilSize,o=t.sizeRestrictions,a=t.positionRestrictions;t.stencilReference;var l,c,u,h=Bt({},n),d=Bt({},r),f=Bt({},s);l=Hi(f),c=Hi(h),u===void 0&&(u=.001),(l===0||c===0?Math.abs(c-l)<u:Math.abs(c/l)<1+u&&Math.abs(c/l)>1-u)||(h=Bt(Bt({},h),Jc({sizeRestrictions:o,width:h.width,height:h.height,aspectRatio:{minimum:Hi(f),maximum:Hi(f)}})));var m=JE(d=La(d,h.width*i.width/(d.width*f.width)),e({visibleArea:d,type:"resize"}));return m!==1&&(d=La(d,m),h=La(h,m)),d=os(d=wo(d,Tp(ss(h),ss(d))),e({visibleArea:d,type:"move"})),{coordinates:h=os(h,QE(yc(d),a)),visibleArea:d}}function tEe(t){var e=t.event,i=t.getAreaRestrictions,n=t.boundaries,r=t.coordinates,s=t.visibleArea;t.aspectRatio,t.stencilSize,t.sizeRestrictions;var o=t.positionRestrictions;t.stencilReference;var a=Bt({},r),l=Bt({},s);if(r&&s&&e.type!=="manipulateImage"){var c={width:0,height:0};l.width,n.width,Hi(n)>Hi(a)?(c.height=.8*n.height,c.width=c.height*Hi(a)):(c.width=.8*n.width,c.height=c.width*Hi(a));var u=JE(l=La(l,a.width*n.width/(l.width*c.width)),i({visibleArea:l,type:"resize"}));l=La(l,u),u!==1&&(c.height/=u,c.width/=u),l=os(l=wo(l,Tp(ss(a),ss(l))),i({visibleArea:l,type:"move"})),a=os(a,QE(yc(l),o))}return{coordinates:a,visibleArea:l}}function iEe(t){var e=t.event,i=t.coordinates,n=t.visibleArea,r=t.getAreaRestrictions,s=Bt({},n),o=Bt({},i);if(e.type==="setCoordinates"){var a=Math.max(0,o.width-s.width),l=Math.max(0,o.height-s.height);a>l?s=La(s,Math.min(o.width/s.width,xp(s,r({visibleArea:s,type:"resize"})))):l>a&&(s=La(s,Math.min(o.height/s.height,xp(s,r({visibleArea:s,type:"resize"}))))),s=os(s=wo(s,ZE(kp(o,yc(s)))),r({visibleArea:s,type:"move"}))}return{visibleArea:s,coordinates:o}}function nEe(t){var e=t.imageSize,i=t.visibleArea,n=t.coordinates,r=i||e;return{left:(i?i.left:0)+r.width/2-n.width/2,top:(i?i.top:0)+r.height/2-n.height/2}}function rEe(t){var e=t.imageSize,i=t.visibleArea,n=t.aspectRatio,r=t.sizeRestrictions,s=i||e,o=Math.min(n.maximum||1/0,Math.max(n.minimum||0,Hi(s))),a=s.width<s.height?{width:.8*s.width,height:.8*s.width/o}:{height:.8*s.height,width:.8*s.height*o};return Jc(Bt(Bt({},a),{aspectRatio:n,sizeRestrictions:r}))}function sEe(t){var e,i,n=t.imageSize,r=t.visibleArea,s=t.boundaries,o=t.aspectRatio,a=t.sizeRestrictions,l=t.stencilSize,c=r||n;return Hi(c)>Hi(s)?i=(e=l.height*c.height/s.height)*Hi(l):e=(i=l.width*c.width/s.width)/Hi(l),Jc({width:i,height:e,aspectRatio:o,sizeRestrictions:a})}function oEe(t){var e=t.getAreaRestrictions,i=t.coordinates,n=t.imageSize,r=Hi(t.boundaries);if(i){var s={height:Math.max(i.height,n.height),width:Math.max(i.width,n.width)},o=OH({width:Hi(s)>r?s.width:s.height*r,height:Hi(s)>r?s.width/r:s.height},S1(e())),a={left:i.left+i.width/2-o.width/2,top:i.top+i.height/2-o.height/2,width:o.width,height:o.height},l=Ty(i,yc(Bt({left:0,top:0},n))),c={};return!l.left&&!l.right&&a.width<=n.width&&(c.left=0,c.right=n.width),!l.top&&!l.bottom&&a.height<=n.height&&(c.top=0,c.bottom=n.height),os(a,c)}var u=Hi(n);return o={height:u>r?n.height:n.width/r,width:u>r?n.height*r:n.width},{left:n.width/2-o.width/2,top:n.height/2-o.height/2,width:o.width,height:o.height}}function Zb(t,e){return NH(t,yc(e))}function aEe(t){var e=t.event,i=t.coordinates,n=t.visibleArea,r=t.sizeRestrictions,s=t.getAreaRestrictions,o=t.positionRestrictions,a=t.adjustStencil,l=e.scale,c=e.move,u=Bt({},n),h=Bt({},i),d=1,f=1,m=l.factor&&Math.abs(l.factor-1)>.001;u=wo(u,{left:c.left||0,top:c.top||0});var g={stencil:{minimum:Math.max(r.minWidth?r.minWidth/h.width:0,r.minHeight?r.minHeight/h.height:0),maximum:Math.min(r.maxWidth?r.maxWidth/h.width:1/0,r.maxHeight?r.maxHeight/h.height:1/0,xp(h,o))},area:{maximum:xp(u,s({visibleArea:u,type:"resize"}))}};l.factor&&m&&(l.factor<1?(f=Math.max(l.factor,g.stencil.minimum))>1&&(f=1):l.factor>1&&(f=Math.min(l.factor,Math.min(g.area.maximum,g.stencil.maximum)))<1&&(f=1)),f&&(u=La(u,f,l.center));var v=i.left-n.left,p=n.width+n.left-(i.width+i.left),b=i.top-n.top,_=n.height+n.top-(i.height+i.top);return u=os(u=wo(u,kp(u,{left:o.left!==void 0?o.left-v*f:void 0,top:o.top!==void 0?o.top-b*f:void 0,bottom:o.bottom!==void 0?o.bottom+_*f:void 0,right:o.right!==void 0?o.right+p*f:void 0})),s({visibleArea:u,type:"move"})),h.width=h.width*f,h.height=h.height*f,h.left=u.left+v*f,h.top=u.top+b*f,h=os(h,QE(yc(u),o)),l.factor&&m&&a&&(l.factor>1?d=Math.min(g.area.maximum,l.factor)/f:l.factor<1&&(d=Math.max(h.height/u.height,h.width/u.width,l.factor/f)),d!==1&&(u=wo(u=os(u=La(u,d,l.factor>1?l.center:ss(h)),s({visibleArea:u,type:"move"})),ZE(kp(h,yc(u)))))),{coordinates:h,visibleArea:u}}function lEe(t){var e=t.aspectRatio,i=t.getAreaRestrictions,n=t.coordinates,r=t.visibleArea,s=t.sizeRestrictions,o=t.positionRestrictions,a=t.imageSize,l=t.previousImageSize,c=t.angle,u=Bt({},n),h=Bt({},r),d=cu(ss(Bt({left:0,top:0},l)),c);return(u=Bt(Bt({},Jc({sizeRestrictions:s,aspectRatio:e,width:u.width,height:u.height})),cu(ss(u),c))).left-=d.left-a.width/2+u.width/2,u.top-=d.top-a.height/2+u.height/2,h=La(h,JE(h,i({visibleArea:h,type:"resize"}))),{coordinates:u=os(u,o),visibleArea:h=os(h=wo(h,Tp(ss(u),ss(n))),i({visibleArea:h,type:"move"}))}}function cEe(t){var e=t.flip,i=t.previousFlip,n=t.rotate;t.aspectRatio;var r=t.getAreaRestrictions,s=t.coordinates,o=t.visibleArea,a=t.imageSize,l=Bt({},s),c=Bt({},o),u=i.horizontal!==e.horizontal,h=i.vertical!==e.vertical;if(u||h){var d=cu({left:a.width/2,top:a.height/2},-n),f=cu(ss(l),-n),m=cu({left:u?d.left-(f.left-d.left):f.left,top:h?d.top-(f.top-d.top):f.top},n);l=wo(l,Tp(m,ss(l))),f=cu(ss(c),-n),c=os(c=wo(c,Tp(m=cu({left:u?d.left-(f.left-d.left):f.left,top:h?d.top-(f.top-d.top):f.top},n),ss(c))),r({visibleArea:c,type:"move"}))}return{coordinates:l,visibleArea:c}}function lz(t){var e=t.directions,i=t.coordinates,n=t.positionRestrictions,r=n===void 0?{}:n,s=t.sizeRestrictions,o=t.preserveRatio,a=t.compensate,l=Bt({},e),c=zl(i,l).width,u=zl(i,l).height;c<0&&(l.left<0&&l.right<0?(l.left=-(i.width-s.minWidth)/(l.left/l.right),l.right=-(i.width-s.minWidth)/(l.right/l.left)):l.left<0?l.left=-(i.width-s.minWidth):l.right<0&&(l.right=-(i.width-s.minWidth))),u<0&&(l.top<0&&l.bottom<0?(l.top=-(i.height-s.minHeight)/(l.top/l.bottom),l.bottom=-(i.height-s.minHeight)/(l.bottom/l.top)):l.top<0?l.top=-(i.height-s.minHeight):l.bottom<0&&(l.bottom=-(i.height-s.minHeight)));var h=Ty(zl(i,l),r);a&&(h.left&&h.left>0&&h.right===0?(l.right+=h.left,l.left-=h.left):h.right&&h.right>0&&h.left===0&&(l.left+=h.right,l.right-=h.right),h.top&&h.top>0&&h.bottom===0?(l.bottom+=h.top,l.top-=h.top):h.bottom&&h.bottom>0&&h.top===0&&(l.top+=h.bottom,l.bottom-=h.bottom),h=Ty(zl(i,l),r));var d={width:1/0,height:1/0,left:1/0,right:1/0,top:1/0,bottom:1/0};if(Wl.forEach(function(g){var v=h[g];v&&l[g]&&(d[g]=Math.max(0,1-v/l[g]))}),o){var f=Math.min.apply(null,Wl.map(function(g){return d[g]}));f!==1/0&&Wl.forEach(function(g){l[g]*=f})}else Wl.forEach(function(g){d[g]!==1/0&&(l[g]*=d[g])});if(c=zl(i,l).width,u=zl(i,l).height,l.right+l.left&&(c>s.maxWidth?d.width=(s.maxWidth-i.width)/(l.right+l.left):c<s.minWidth&&(d.width=(s.minWidth-i.width)/(l.right+l.left))),l.bottom+l.top&&(u>s.maxHeight?d.height=(s.maxHeight-i.height)/(l.bottom+l.top):u<s.minHeight&&(d.height=(s.minHeight-i.height)/(l.bottom+l.top))),o){var m=Math.min(d.width,d.height);m!==1/0&&Wl.forEach(function(g){l[g]*=m})}else d.width!==1/0&&KPe.forEach(function(g){l[g]*=d.width}),d.height!==1/0&&XPe.forEach(function(g){l[g]*=d.height});return l}function Jb(t,e,i){return e==0&&i==0?t/2:e==0?0:i==0?t:t*Math.abs(e/(e+i))}var hEe=kl("vue-simple-handler"),uEe=kl("vue-simple-handler-wrapper"),HV={name:"SimpleHandler",components:{HandlerWrapper:LH},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){var t,e=(ka(t={},this.horizontalPosition,!!this.horizontalPosition),ka(t,this.verticalPosition,!!this.verticalPosition),ka(t,"".concat(this.horizontalPosition,"-").concat(this.verticalPosition),!!(this.verticalPosition&&this.horizontalPosition)),ka(t,"hover",this.hover),t);return{default:kr(hEe(e),this.defaultClass,this.hover&&this.hoverClass),wrapper:kr(uEe(e),this.wrapperClass)}}},methods:{onDrag:function(t){this.$emit("drag",t)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};HV.render=function(t,e,i,n,r,s){var o=ml("HandlerWrapper");return Te(),qe(o,{class:s.classes.wrapper,"vertical-position":i.verticalPosition,"horizontal-position":i.horizontalPosition,disabled:i.disabled,onDrag:s.onDrag,onDragEnd:s.onDragEnd,onEnter:s.onEnter,onLeave:s.onLeave},{default:U(function(){return[w("div",{class:s.classes.default},null,2)]}),_:1},8,["class","vertical-position","horizontal-position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var dEe=kl("vue-simple-line"),fEe=kl("vue-simple-line-wrapper"),qV={name:"SimpleLine",components:{LineWrapper:IH},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},position:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){return{root:kr(dEe(ka({},this.position,!0)),this.defaultClass,this.hover&&this.hoverClass),wrapper:kr(fEe(ka({},this.position,!0)),this.wrapperClass)}}},methods:{onDrag:function(t){this.$emit("drag",t)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};qV.render=function(t,e,i,n,r,s){var o=ml("LineWrapper");return Te(),qe(o,{class:s.classes.wrapper,position:i.position,disabled:i.disabled,onDrag:s.onDrag,onDragEnd:s.onDragEnd,onEnter:s.onEnter,onLeave:s.onLeave},{default:U(function(){return[w("div",{class:s.classes.root},null,2)]}),_:1},8,["class","position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var Ix=kl("vue-bounding-box"),mEe=["east","west",null],pEe=["south","north",null],RH={name:"BoundingBox",props:{width:{type:Number},height:{type:Number},transitions:{type:Object},handlers:{type:Object,default:function(){return{eastNorth:!0,north:!0,westNorth:!0,west:!0,westSouth:!0,south:!0,eastSouth:!0,east:!0}}},handlersComponent:{type:[Object,String],default:function(){return HV}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}},lines:{type:Object,default:function(){return{west:!0,north:!0,east:!0,south:!0}}},linesComponent:{type:[Object,String],default:function(){return qV}},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},resizable:{type:Boolean,default:!0}},data:function(){var t=[];return mEe.forEach(function(e){pEe.forEach(function(i){if(e!==i){var n=CH(e,i),r=n.name,s=n.classname;t.push({name:r,classname:s,verticalDirection:i,horizontalDirection:e})}})}),{points:t}},computed:{style:function(){var t={};return this.width&&this.height&&(t.width="".concat(this.width,"px"),t.height="".concat(this.height,"px"),this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction))),t},classes:function(){var t=this.handlersClasses,e=this.handlersWrappersClasses,i=this.linesClasses,n=this.linesWrappersClasses;return{root:Ix(),handlers:t,handlersWrappers:e,lines:i,linesWrappers:n}},lineNodes:function(){var t=this,e=[];return this.points.forEach(function(i){i.horizontalDirection&&i.verticalDirection||!t.lines[i.name]||e.push({name:i.name,component:t.linesComponent,class:kr(t.classes.lines.default,t.classes.lines[i.name],!t.resizable&&t.classes.lines.disabled),wrapperClass:kr(t.classes.linesWrappers.default,t.classes.linesWrappers[i.name],!t.resizable&&t.classes.linesWrappers.disabled),hoverClass:t.classes.lines.hover,verticalDirection:i.verticalDirection,horizontalDirection:i.horizontalDirection,disabled:!t.resizable})}),e},handlerNodes:function(){var t=this,e=[],i=this.width,n=this.height;return this.points.forEach(function(r){if(t.handlers[r.name]){var s={name:r.name,component:t.handlersComponent,class:kr(t.classes.handlers.default,t.classes.handlers[r.name]),wrapperClass:kr(t.classes.handlersWrappers.default,t.classes.handlersWrappers[r.name]),hoverClass:t.classes.handlers.hover,verticalDirection:r.verticalDirection,horizontalDirection:r.horizontalDirection,disabled:!t.resizable};if(i&&n){var o=r.horizontalDirection,a=r.verticalDirection,l=o==="east"?i:o==="west"?0:i/2,c=a==="south"?n:a==="north"?0:n/2;s.wrapperClass=Ix("handler"),s.wrapperStyle={transform:"translate(".concat(l,"px, ").concat(c,"px)")},t.transitions&&t.transitions.enabled&&(s.wrapperStyle.transition="".concat(t.transitions.time,"ms ").concat(t.transitions.timingFunction))}else s.wrapperClass=Ix("handler",ka({},r.classname,!0));e.push(s)}}),e}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[]},methods:{onEnd:function(){this.$emit("resize-end")},onHandlerDrag:function(t,e,i){var n,r=t.shift(),s=r.left,o=r.top,a={left:0,right:0,top:0,bottom:0};e==="west"?a.left-=s:e==="east"&&(a.right+=s),i==="north"?a.top-=o:i==="south"&&(a.bottom+=o),!i&&e?n="width":i&&!e&&(n="height"),this.resizable&&this.$emit("resize",new GPe(a,{allowedDirections:{left:e==="west"||!e,right:e==="east"||!e,bottom:i==="south"||!i,top:i==="north"||!i},preserveAspectRatio:t.nativeEvent&&t.nativeEvent.shiftKey,respectDirection:n}))}},emits:["resize","resize-end"]};RH.render=function(t,e,i,n,r,s){return Te(),qe("div",{ref:"box",class:s.classes.root,style:s.style},[Ma(t.$slots,"default"),w("div",null,[(Te(!0),qe(mt,null,Zs(s.lineNodes,function(o){return Te(),qe(Sv(o.component),{key:o.name,"default-class":o.class,"hover-class":o.hoverClass,"wrapper-class":o.wrapperClass,position:o.name,disabled:o.disabled,onDrag:function(a){return s.onHandlerDrag(a,o.horizontalDirection,o.verticalDirection)},onDragEnd:e[1]||(e[1]=function(a){return s.onEnd()})},null,8,["default-class","hover-class","wrapper-class","position","disabled","onDrag"])}),128))]),(Te(!0),qe(mt,null,Zs(s.handlerNodes,function(o){return Te(),qe("div",{key:o.name,style:o.wrapperStyle,class:o.wrapperClass},[(Te(),qe(Sv(o.component),{"default-class":o.class,"hover-class":o.hoverClass,"wrapper-class":o.wrapperClass,"horizontal-position":o.horizontalDirection,"vertical-position":o.verticalDirection,disabled:o.disabled,onDrag:function(a){return s.onHandlerDrag(a,o.horizontalDirection,o.verticalDirection)},onDragEnd:e[2]||(e[2]=function(a){return s.onEnd()})},null,8,["default-class","hover-class","wrapper-class","horizontal-position","vertical-position","disabled","onDrag"]))],6)}),128))],6)};var gEe=kl("vue-draggable-area"),FH={name:"DraggableArea",props:{movable:{type:Boolean,default:!0},activationDistance:{type:Number,default:20}},computed:{classnames:function(){return{default:gEe()}}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[],this.touchStarted=!1},methods:{onTouchStart:function(t){if(t.cancelable){var e=this.movable&&t.touches.length===1;e&&(this.touches=Xd(t.touches)),(this.touchStarted||e)&&(t.preventDefault(),t.stopPropagation())}},onTouchEnd:function(){this.touchStarted=!1,this.processEnd()},onTouchMove:function(t){this.touches.length>=1&&(this.touchStarted?(this.processMove(t,t.touches),t.preventDefault(),t.stopPropagation()):VH({x:this.touches[0].clientX,y:this.touches[0].clientY},{x:t.touches[0].clientX,y:t.touches[0].clientY})>this.activationDistance&&(this.initAnchor({clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}),this.touchStarted=!0))},onMouseDown:function(t){if(this.movable&&t.button===0){var e={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[e],this.initAnchor(e),t.stopPropagation()}},onMouseMove:function(t){this.touches.length&&(this.processMove(t,[{fake:!0,clientX:t.clientX,clientY:t.clientY}]),t.preventDefault&&t.cancelable&&t.preventDefault(),t.stopPropagation())},onMouseUp:function(){this.processEnd()},initAnchor:function(t){var e=this.$refs.container.getBoundingClientRect(),i=e.left,n=e.top;this.anchor={x:t.clientX-i,y:t.clientY-n}},processMove:function(t,e){var i=Xd(e);if(this.touches.length){var n=this.$refs.container.getBoundingClientRect(),r=n.left,s=n.top;this.touches.length===1&&i.length===1&&this.$emit("move",new WV({left:i[0].clientX-(r+this.anchor.x),top:i[0].clientY-(s+this.anchor.y)}))}},processEnd:function(){this.touches.length&&this.$emit("move-end"),this.touches=[]}},emits:["move","move-end"]};FH.render=function(t,e,i,n,r,s){return Te(),qe("div",{ref:"container",onTouchstart:e[1]||(e[1]=function(){return s.onTouchStart&&s.onTouchStart.apply(s,arguments)}),onMousedown:e[2]||(e[2]=function(){return s.onMouseDown&&s.onMouseDown.apply(s,arguments)})},[Ma(t.$slots,"default")],544)};function Ox(t){var e,i;return{rotate:t.rotate||0,flip:{horizontal:((e=t==null?void 0:t.flip)===null||e===void 0?void 0:e.horizontal)||!1,vertical:((i=t==null?void 0:t.flip)===null||i===void 0?void 0:i.vertical)||!1}}}function vEe(t){return new Promise(function(e,i){try{if(t)if(/^data:/i.test(t))e(function(l){l=l.replace(/^data:([^;]+);base64,/gim,"");for(var c=atob(l),u=c.length,h=new ArrayBuffer(u),d=new Uint8Array(h),f=0;f<u;f++)d[f]=c.charCodeAt(f);return h}(t));else if(/^blob:/i.test(t)){var n=new FileReader;n.onload=function(l){e(l.target.result)},s=t,o=function(l){n.readAsArrayBuffer(l)},(a=new XMLHttpRequest).open("GET",s,!0),a.responseType="blob",a.onload=function(){this.status!=200&&this.status!==0||o(this.response)},a.send()}else{var r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState===4&&(r.status===200||r.status===0?e(r.response):i("Warning: could not load an image to parse its orientation"),r=null)},r.onprogress=function(){r.getResponseHeader("content-type")!=="image/jpeg"&&r.abort()},r.withCredentials=!1,r.open("GET",t,!0),r.responseType="arraybuffer",r.send(null)}else i("Error: the image is empty")}catch(l){i(l)}var s,o,a})}function zH(t){var e=t.rotate,i=t.flip,n=t.scaleX,r=t.scaleY,s="";return s+=" rotate("+e+"deg) ",s+=" scaleX("+n*(i.horizontal?-1:1)+") ",s+=" scaleY("+r*(i.vertical?-1:1)+") "}function yEe(t){try{var e,i=new DataView(t),n=void 0,r=void 0,s=void 0,o=void 0;if(i.getUint8(0)===255&&i.getUint8(1)===216)for(var a=i.byteLength,l=2;l+1<a;){if(i.getUint8(l)===255&&i.getUint8(l+1)===225){s=l;break}l++}if(s&&(n=s+10,function(f,m,g){var v,p="";for(v=m,g+=m;v<g;v++)p+=String.fromCharCode(f.getUint8(v));return p}(i,s+4,4)==="Exif")){var c=i.getUint16(n);if(((r=c===18761)||c===19789)&&i.getUint16(n+2,r)===42){var u=i.getUint32(n+4,r);u>=8&&(o=n+u)}}if(o){for(var h=i.getUint16(o,r),d=0;d<h;d++)if(l=o+12*d+2,i.getUint16(l,r)===274){l+=8,e=i.getUint16(l,r),i.setUint16(l,1,r);break}}return e}catch{return null}}function cz(t,e){var i=e.getBoundingClientRect(),n=i.left,r=i.top,s={left:0,top:0},o=0;return t.forEach(function(a){s.left+=(a.clientX-n)/t.length,s.top+=(a.clientY-r)/t.length}),t.forEach(function(a){o+=VH({x:s.left,y:s.top},{x:a.clientX-n,y:a.clientY-r})}),{centerMass:s,spread:o,count:t.length}}var UH={props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0},eventsFilter:{type:Function,required:!1}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},created:function(){this.transforming=!1,this.debouncedProcessEnd=v1(this.processEnd),this.touches=[]},methods:{processMove:function(t,e){if(this.touches.length){if(this.touches.length===1&&e.length===1)this.$emit("move",new pv({left:this.touches[0].clientX-e[0].clientX,top:this.touches[0].clientY-e[0].clientY}));else if(this.touches.length>1&&this.touchResize){var i=cz(e,this.$refs.container),n=this.oldGeometricProperties;n.count===i.count&&n.count>1&&this.$emit("resize",new pv({left:n.centerMass.left-i.centerMass.left,top:n.centerMass.top-i.centerMass.top},{factor:n.spread/i.spread,center:i.centerMass})),this.oldGeometricProperties=i}this.touches=e}},processEnd:function(){this.transforming&&(this.transforming=!1,this.$emit("transform-end"))},processStart:function(){this.transforming=!0,this.debouncedProcessEnd.clear()},processEvent:function(t){return this.eventsFilter?this.eventsFilter(t,this.transforming)!==!1:(t.preventDefault(),t.stopPropagation(),!0)},onTouchStart:function(t){if(t.cancelable&&(this.touchMove||this.touchResize&&t.touches.length>1)&&this.processEvent(t)){var e=this.$refs.container,i=e.getBoundingClientRect(),n=i.left,r=i.top,s=i.bottom,o=i.right;this.touches=Xd(t.touches).filter(function(a){return a.clientX>n&&a.clientX<o&&a.clientY>r&&a.clientY<s}),this.oldGeometricProperties=cz(this.touches,e)}},onTouchEnd:function(t){t.touches.length===0&&(this.touches=[],this.processEnd())},onTouchMove:function(t){var e=this;if(this.touches.length){var i=Xd(t.touches).filter(function(n){return!n.identifier||e.touches.find(function(r){return r.identifier===n.identifier})});this.processEvent(t)&&(this.processMove(t,i),this.processStart())}},onMouseDown:function(t){if(this.mouseMove&&"buttons"in t&&t.buttons===1&&this.processEvent(t)){var e={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[e],this.processStart()}},onMouseMove:function(t){this.touches.length&&this.processEvent(t)&&this.processMove(t,[{clientX:t.clientX,clientY:t.clientY}])},onMouseUp:function(){this.touches=[],this.processEnd()},onWheel:function(t){if(this.wheelResize&&this.processEvent(t)){var e=this.$refs.container.getBoundingClientRect(),i=e.left,n=e.top,r=1+this.wheelResize.ratio*(o=t.deltaY||t.detail||t.wheelDelta,(a=+o)==0||AH(a)?a:a>0?1:-1),s={left:t.clientX-i,top:t.clientY-n};this.$emit("resize",new pv({},{factor:r,center:s})),this.touches.length||this.debouncedProcessEnd()}var o,a}},emits:["resize","move","transform-end"]};UH.render=function(t,e,i,n,r,s){return Te(),qe("div",{ref:"container",onTouchstart:e[1]||(e[1]=function(){return s.onTouchStart&&s.onTouchStart.apply(s,arguments)}),onMousedown:e[2]||(e[2]=function(){return s.onMouseDown&&s.onMouseDown.apply(s,arguments)}),onWheel:e[3]||(e[3]=function(){return s.onWheel&&s.onWheel.apply(s,arguments)})},[Ma(t.$slots,"default")],544)};var _1={components:{TransformableImage:UH},props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0}},emits:["resize","move"]};_1.render=function(t,e,i,n,r,s){var o=ml("transformable-image");return Te(),qe(o,{"touch-move":i.touchMove,"touch-resize":i.touchResize,"mouse-move":i.mouseMove,"wheel-resize":i.wheelResize,onMove:e[1]||(e[1]=function(a){return t.$emit("move",a)}),onResize:e[2]||(e[2]=function(a){return t.$emit("resize",a)})},{default:U(function(){return[Ma(t.$slots,"default")]}),_:3},8,["touch-move","touch-resize","mouse-move","wheel-resize"])};var Qb=kl("vue-preview"),BH={props:{coordinates:{type:Object},transitions:{type:Object},image:{type:Object,default:function(){return{}}},imageClass:{type:String},width:{type:Number},height:{type:Number},fill:{type:Boolean}},data:function(){return{calculatedImageSize:{width:0,height:0},calculatedSize:{width:0,height:0}}},computed:{classes:function(){return{root:Qb({fill:this.fill}),wrapper:Qb("wrapper"),imageWrapper:Qb("image-wrapper"),image:kr(Qb("image"),this.imageClass)}},style:function(){if(this.fill)return{};var t={};return this.width&&(t.width="".concat(this.size.width,"px")),this.height&&(t.height="".concat(this.size.height,"px")),this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),t},wrapperStyle:function(){var t={width:"".concat(this.size.width,"px"),height:"".concat(this.size.height,"px"),left:"calc(50% - ".concat(this.size.width/2,"px)"),top:"calc(50% - ".concat(this.size.height/2,"px)")};return this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),t},imageStyle:function(){if(this.coordinates&&this.image){var t=this.coordinates.width/this.size.width,e=$i($i({rotate:0,flip:{horizontal:!1,vertical:!1}},this.image.transforms),{},{scaleX:1/t,scaleY:1/t}),i=this.imageSize.width,n=this.imageSize.height,r=DH({width:i,height:n},e.rotate),s={width:"".concat(i,"px"),height:"".concat(n,"px"),left:"0px",top:"0px"},o={rotate:{left:(i-r.width)*e.scaleX/2,top:(n-r.height)*e.scaleY/2},scale:{left:(1-e.scaleX)*i/2,top:(1-e.scaleY)*n/2}};return s.transform=`translate(
				`.concat(-this.coordinates.left/t-o.rotate.left-o.scale.left,"px,").concat(-this.coordinates.top/t-o.rotate.top-o.scale.top,"px) ")+zH(e),this.transitions&&this.transitions.enabled&&(s.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),s}return{}},size:function(){return{width:this.width||this.calculatedSize.width,height:this.height||this.calculatedSize.height}},imageSize:function(){return{width:this.image.width||this.calculatedImageSize.width,height:this.image.height||this.calculatedImageSize.height}}},watch:{image:function(t){(t.width||t.height)&&this.onChangeImage()}},mounted:function(){var t=this;this.onChangeImage(),this.$refs.image.addEventListener("load",function(){t.refreshImage()}),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh)},methods:{refreshImage:function(){var t=this.$refs.image;this.calculatedImageSize.height=t.naturalHeight,this.calculatedImageSize.width=t.naturalWidth},refresh:function(){var t=this.$refs.root;this.width||(this.calculatedSize.width=t.clientWidth),this.height||(this.calculatedSize.height=t.clientHeight)},onChangeImage:function(){var t=this.$refs.image;t&&t.complete&&this.refreshImage(),this.refresh()}}};BH.render=function(t,e,i,n,r,s){return Te(),qe("div",{ref:"root",class:s.classes.root,style:s.style},[w("div",{ref:"wrapper",class:s.classes.wrapper,style:s.wrapperStyle},[fi(w("img",{ref:"image",src:i.image&&i.image.src,class:s.classes.image,style:s.imageStyle},null,14,["src"]),[[ln,i.image&&i.image.src]])],6)],6)};var jH={components:{Preview:BH},inheritAttrs:!1};jH.render=function(t,e,i,n,r,s){var o=ml("preview");return Te(),qe(o,ht(t.$attrs,{fill:!0}),null,16)};var Dx=kl("vue-rectangle-stencil"),$H={name:"RectangleStencil",components:{StencilPreview:jH,BoundingBox:RH,DraggableArea:FH},props:{image:{type:Object},coordinates:{type:Object},stencilCoordinates:{type:Object},handlers:{type:Object},handlersComponent:{type:[Object,String],default:function(){return HV}},lines:{type:Object},linesComponent:{type:[Object,String],default:function(){return qV}},aspectRatio:{type:[Number,String]},minAspectRatio:{type:[Number,String]},maxAspectRatio:{type:[Number,String]},movable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},transitions:{type:Object},movingClass:{type:String},resizingClass:{type:String},previewClass:{type:String},boundingBoxClass:{type:String},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}}},data:function(){return{moving:!1,resizing:!1}},computed:{classes:function(){return{stencil:kr(Dx({movable:this.movable,moving:this.moving,resizing:this.resizing}),this.moving&&this.movingClass,this.resizing&&this.resizingClass),preview:kr(Dx("preview"),this.previewClass),boundingBox:kr(Dx("bounding-box"),this.boundingBoxClass)}},style:function(){var t=this.stencilCoordinates,e=t.height,i=t.width,n=t.left,r=t.top,s={width:"".concat(i,"px"),height:"".concat(e,"px"),transform:"translate(".concat(n,"px, ").concat(r,"px)")};return this.transitions&&this.transitions.enabled&&(s.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),s}},methods:{onMove:function(t){this.$emit("move",t),this.moving=!0},onMoveEnd:function(){this.$emit("move-end"),this.moving=!1},onResize:function(t){this.$emit("resize",t),this.resizing=!0},onResizeEnd:function(){this.$emit("resize-end"),this.resizing=!1},aspectRatios:function(){return{minimum:this.aspectRatio||this.minAspectRatio,maximum:this.aspectRatio||this.maxAspectRatio}}},emits:["resize","resize-end","move","move-end"]};$H.render=function(t,e,i,n,r,s){var o=ml("stencil-preview"),a=ml("draggable-area"),l=ml("bounding-box");return Te(),qe("div",{class:s.classes.stencil,style:s.style},[w(l,{width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,transitions:i.transitions,class:s.classes.boundingBox,handlers:i.handlers,"handlers-component":i.handlersComponent,"handlers-classes":i.handlersClasses,"handlers-wrappers-classes":i.handlersWrappersClasses,lines:i.lines,"lines-component":i.linesComponent,"lines-classes":i.linesClasses,"lines-wrappers-classes":i.linesWrappersClasses,resizable:i.resizable,onResize:s.onResize,onResizeEnd:s.onResizeEnd},{default:U(function(){return[w(a,{movable:i.movable,onMove:s.onMove,onMoveEnd:s.onMoveEnd},{default:U(function(){return[w(o,{image:i.image,coordinates:i.coordinates,width:i.stencilCoordinates.width,height:i.stencilCoordinates.height,class:s.classes.preview,transitions:i.transitions},null,8,["image","coordinates","width","height","class","transitions"])]}),_:1},8,["movable","onMove","onMoveEnd"])]}),_:1},8,["width","height","transitions","class","handlers","handlers-component","handlers-classes","handlers-wrappers-classes","lines","lines-component","lines-classes","lines-wrappers-classes","resizable","onResize","onResizeEnd"])],6)};var SEe=["transitions"],Oc=kl("vue-advanced-cropper"),WH={name:"Cropper",components:{BackgroundWrapper:_1},props:{src:{type:String,default:null},stencilComponent:{type:[Object,String],default:function(){return $H}},backgroundWrapperComponent:{type:[Object,String],default:function(){return _1}},stencilProps:{type:Object,default:function(){return{}}},autoZoom:{type:Boolean,default:!1},imageClass:{type:String},boundariesClass:{type:String},backgroundClass:{type:String},foregroundClass:{type:String},minWidth:{type:[Number,String]},minHeight:{type:[Number,String]},maxWidth:{type:[Number,String]},maxHeight:{type:[Number,String]},debounce:{type:[Boolean,Number],default:500},transitions:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},canvas:{type:[Object,Boolean],default:!0},crossOrigin:{type:[Boolean,String],default:void 0},transitionTime:{type:Number,default:300},imageRestriction:{type:String,default:"fit-area",validator:function(t){return ZPe.indexOf(t)!==-1}},roundResult:{type:Boolean,default:!0},defaultSize:{type:[Function,Object]},defaultPosition:{type:[Function,Object]},defaultVisibleArea:{type:[Function,Object]},defaultTransforms:{type:[Function,Object]},defaultBoundaries:{type:[Function,String],validator:function(t){return!(typeof t=="string"&&t!=="fill"&&t!=="fit")}},priority:{type:String,default:"coordinates"},stencilSize:{type:[Object,Function]},resizeImage:{type:[Boolean,Object],default:!0},moveImage:{type:[Boolean,Object],default:!0},autoZoomAlgorithm:{type:Function},resizeAlgorithm:{type:Function,default:function(t){var e=t.event,i=t.coordinates,n=t.aspectRatio,r=t.positionRestrictions,s=t.sizeRestrictions,o=Bt(Bt({},i),{right:i.left+i.width,bottom:i.top+i.height}),a=e.params||{},l=Bt({},e.directions),c=a.allowedDirections||{left:!0,right:!0,bottom:!0,top:!0};s.widthFrozen&&(l.left=0,l.right=0),s.heightFrozen&&(l.top=0,l.bottom=0),Wl.forEach(function(P){c[P]||(l[P]=0)});var u=zl(o,l=lz({coordinates:o,directions:l,sizeRestrictions:s,positionRestrictions:r})).width,h=zl(o,l).height,d=a.preserveRatio?Hi(o):Lx(u/h,n);if(d){var f=a.respectDirection;if(f||(f=o.width>=o.height||d===1?"width":"height"),f==="width"){var m=u/d-o.height;if(c.top&&c.bottom){var g=l.top,v=l.bottom;l.bottom=Jb(m,v,g),l.top=Jb(m,g,v)}else c.bottom?l.bottom=m:c.top?l.top=m:c.right?l.right=0:c.left&&(l.left=0)}else if(f==="height"){var p=o.width-h*d;if(c.left&&c.right){var b=l.left,_=l.right;l.left=-Jb(p,b,_),l.right=-Jb(p,_,b)}else c.left?l.left=-p:c.right?l.right=-p:c.top?l.top=0:c.bottom&&(l.bottom=0)}l=lz({directions:l,coordinates:o,sizeRestrictions:s,positionRestrictions:r,preserveRatio:!0,compensate:a.compensate})}return u=zl(o,l).width,h=zl(o,l).height,(d=a.preserveRatio?Hi(o):Lx(u/h,n))&&Math.abs(d-u/h)>.001&&Wl.forEach(function(P){c[P]||(l[P]=0)}),b1({event:new WV({left:-l.left,top:-l.top}),coordinates:{width:i.width+l.right+l.left,height:i.height+l.top+l.bottom,left:i.left,top:i.top},positionRestrictions:r})}},moveAlgorithm:{type:Function,default:b1},initStretcher:{type:Function,default:function(t){var e=t.stretcher,i=t.imageSize,n=Hi(i);e.style.width=i.width+"px",e.style.height=e.clientWidth/n+"px",e.style.width=e.clientWidth+"px"}},fitCoordinates:{type:Function,default:function(t){var e=t.visibleArea,i=t.coordinates,n=t.aspectRatio,r=t.sizeRestrictions,s=t.positionRestrictions,o=Bt(Bt({},i),Jc({width:i.width,height:i.height,aspectRatio:n,sizeRestrictions:{maxWidth:e.width,maxHeight:e.height,minHeight:Math.min(e.height,r.minHeight),minWidth:Math.min(e.width,r.minWidth)}}));return o=os(o=wo(o,Tp(ss(i),ss(o))),QE(yc(e),s))}},fitVisibleArea:{type:Function,default:function(t){var e=t.visibleArea,i=t.boundaries,n=t.getAreaRestrictions,r=t.coordinates,s=Bt({},e);s.height=s.width/Hi(i),s.top+=(e.height-s.height)/2,(r.height-s.height>0||r.width-s.width>0)&&(s=La(s,Math.max(r.height/s.height,r.width/s.width)));var o=ZE(kp(r,yc(s=La(s,JE(s,n({visibleArea:s,type:"resize"}))))));return s.width<r.width&&(o.left=0),s.height<r.height&&(o.top=0),s=os(s=wo(s,o),n({visibleArea:s,type:"move"}))}},areaRestrictionsAlgorithm:{type:Function,default:function(t){var e=t.visibleArea,i=t.boundaries,n=t.imageSize,r=t.imageRestriction,s=t.type,o={};return r==="fill-area"?o={left:0,top:0,right:n.width,bottom:n.height}:r==="fit-area"&&(Hi(i)>Hi(n)?(o={top:0,bottom:n.height},e&&s==="move"&&(e.width>n.width?(o.left=-(e.width-n.width)/2,o.right=n.width-o.left):(o.left=0,o.right=n.width))):(o={left:0,right:n.width},e&&s==="move"&&(e.height>n.height?(o.top=-(e.height-n.height)/2,o.bottom=n.height-o.top):(o.top=0,o.bottom=n.height)))),o}},sizeRestrictionsAlgorithm:{type:Function,default:function(t){return{minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight}}},positionRestrictionsAlgorithm:{type:Function,default:function(t){var e=t.imageSize,i={};return t.imageRestriction!=="none"&&(i={left:0,top:0,right:e.width,bottom:e.height}),i}}},data:function(){return{transitionsActive:!1,imageLoaded:!1,imageAttributes:{width:null,height:null,crossOrigin:null,src:null},defaultImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},appliedImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},boundaries:{width:0,height:0},visibleArea:null,coordinates:$i({},rz)}},computed:{image:function(){return{src:this.imageAttributes.src,width:this.imageAttributes.width,height:this.imageAttributes.height,transforms:this.imageTransforms}},imageTransforms:function(){return{rotate:this.appliedImageTransforms.rotate,flip:{horizontal:this.appliedImageTransforms.flip.horizontal,vertical:this.appliedImageTransforms.flip.vertical},translateX:this.visibleArea?this.visibleArea.left/this.coefficient:0,translateY:this.visibleArea?this.visibleArea.top/this.coefficient:0,scaleX:1/this.coefficient,scaleY:1/this.coefficient}},imageSize:function(){var t=function(e){return e*Math.PI/180}(this.imageTransforms.rotate);return{width:Math.abs(this.imageAttributes.width*Math.cos(t))+Math.abs(this.imageAttributes.height*Math.sin(t)),height:Math.abs(this.imageAttributes.width*Math.sin(t))+Math.abs(this.imageAttributes.height*Math.cos(t))}},initialized:function(){return!!(this.visibleArea&&this.imageLoaded)},settings:function(){var t=y1(this.resizeImage,{touch:!0,wheel:{ratio:.1},adjustStencil:!0},{touch:!1,wheel:!1,adjustStencil:!1});return{moveImage:y1(this.moveImage,{touch:!0,mouse:!0},{touch:!1,mouse:!1}),resizeImage:t}},coefficient:function(){return this.visibleArea?this.visibleArea.width/this.boundaries.width:0},areaRestrictions:function(){return this.imageLoaded?this.areaRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction,boundaries:this.boundaries}):{}},transitionsOptions:function(){return{enabled:this.transitionsActive,timingFunction:"ease-in-out",time:350}},sizeRestrictions:function(){if(this.boundaries.width&&this.boundaries.height&&this.imageSize.width&&this.imageSize.height){var t=this.sizeRestrictionsAlgorithm({imageSize:this.imageSize,minWidth:Rr(this.minWidth)?0:Yb(this.minWidth),minHeight:Rr(this.minHeight)?0:Yb(this.minHeight),maxWidth:Rr(this.maxWidth)?1/0:Yb(this.maxWidth),maxHeight:Rr(this.maxHeight)?1/0:Yb(this.maxHeight)});if(t=function(n){var r=n.areaRestrictions,s=n.sizeRestrictions;n.imageSize;var o=n.boundaries,a=n.positionRestrictions;n.imageRestriction;var l=Bt(Bt({},s),{minWidth:s.minWidth!==void 0?s.minWidth:0,minHeight:s.minHeight!==void 0?s.minHeight:0,maxWidth:s.maxWidth!==void 0?s.maxWidth:1/0,maxHeight:s.maxHeight!==void 0?s.maxHeight:1/0});a.left!==void 0&&a.right!==void 0&&(l.maxWidth=Math.min(l.maxWidth,a.right-a.left)),a.bottom!==void 0&&a.top!==void 0&&(l.maxHeight=Math.min(l.maxHeight,a.bottom-a.top));var c=S1(r),u=OH(o,c);return c.width<1/0&&(!l.maxWidth||l.maxWidth>u.width)&&(l.maxWidth=Math.min(l.maxWidth,u.width)),c.height<1/0&&(!l.maxHeight||l.maxHeight>u.height)&&(l.maxHeight=Math.min(l.maxHeight,u.height)),l.minWidth>l.maxWidth&&(l.minWidth=l.maxWidth,l.widthFrozen=!0),l.minHeight>l.maxHeight&&(l.minHeight=l.maxHeight,l.heightFrozen=!0),l}({sizeRestrictions:t,areaRestrictions:this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}),imageSize:this.imageSize,boundaries:this.boundaries,positionRestrictions:this.positionRestrictions,imageRestriction:this.imageRestriction,visibleArea:this.visibleArea,stencilSize:this.getStencilSize()}),this.visibleArea&&this.stencilSize){var e=this.getStencilSize(),i=S1(this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}));t.maxWidth=Math.min(t.maxWidth,i.width*e.width/this.boundaries.width),t.maxHeight=Math.min(t.maxHeight,i.height*e.height/this.boundaries.height),t.maxWidth<t.minWidth&&(t.minWidth=t.maxWidth),t.maxHeight<t.minHeight&&(t.minHeight=t.maxHeight)}return t}return{minWidth:0,minHeight:0,maxWidth:0,maxHeight:0}},positionRestrictions:function(){return this.positionRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction})},classes:function(){return{cropper:Oc(),image:kr(Oc("image"),this.imageClass),stencil:Oc("stencil"),boundaries:kr(Oc("boundaries"),this.boundariesClass),stretcher:kr(Oc("stretcher")),background:kr(Oc("background"),this.backgroundClass),foreground:kr(Oc("foreground"),this.foregroundClass),imageWrapper:kr(Oc("image-wrapper")),cropperWrapper:kr(Oc("cropper-wrapper"))}},stencilCoordinates:function(){if(this.initialized){var t=this.coordinates,e=t.width,i=t.height,n=t.left,r=t.top;return{width:e/this.coefficient,height:i/this.coefficient,left:(n-this.visibleArea.left)/this.coefficient,top:(r-this.visibleArea.top)/this.coefficient}}return this.defaultCoordinates()},boundariesStyle:function(){var t={width:this.boundaries.width?"".concat(Math.round(this.boundaries.width),"px"):"auto",height:this.boundaries.height?"".concat(Math.round(this.boundaries.height),"px"):"auto",transition:"opacity ".concat(this.transitionTime,"ms"),pointerEvents:this.imageLoaded?"all":"none"};return this.imageLoaded||(t.opacity="0"),t},imageStyle:function(){var t=this.imageAttributes.width>this.imageAttributes.height?{width:Math.min(1024,this.imageAttributes.width),height:Math.min(1024,this.imageAttributes.width)/(this.imageAttributes.width/this.imageAttributes.height)}:{height:Math.min(1024,this.imageAttributes.height),width:Math.min(1024,this.imageAttributes.height)*(this.imageAttributes.width/this.imageAttributes.height)},e={left:(t.width-this.imageSize.width)/(2*this.coefficient),top:(t.height-this.imageSize.height)/(2*this.coefficient)},i={left:(1-1/this.coefficient)*t.width/2,top:(1-1/this.coefficient)*t.height/2},n=$i($i({},this.imageTransforms),{},{scaleX:this.imageTransforms.scaleX*(this.imageAttributes.width/t.width),scaleY:this.imageTransforms.scaleY*(this.imageAttributes.height/t.height)}),r={width:"".concat(t.width,"px"),height:"".concat(t.height,"px"),left:"0px",top:"0px",transform:"translate(".concat(-e.left-i.left-this.imageTransforms.translateX,"px, ").concat(-e.top-i.top-this.imageTransforms.translateY,"px)")+zH(n)};return this.transitionsOptions.enabled&&(r.transition="".concat(this.transitionsOptions.time,"ms ").concat(this.transitionsOptions.timingFunction)),r}},watch:{src:function(){this.onChangeImage()},stencilComponent:function(){var t=this;this.$nextTick(function(){t.resetCoordinates(),t.runAutoZoom("setCoordinates"),t.onChange()})},minWidth:function(){this.onPropsChange()},maxWidth:function(){this.onPropsChange()},minHeight:function(){this.onPropsChange()},maxHeight:function(){this.onPropsChange()},imageRestriction:function(){this.reset()},stencilProps:function(t,e){["aspectRatio","minAspectRatio","maxAspectRatio"].find(function(i){return t[i]!==e[i]})&&this.$nextTick(this.onPropsChange)}},created:function(){this.debouncedUpdate=v1(this.update,this.debounce),this.debouncedDisableTransitions=v1(this.disableTransitions,this.transitionsOptions.time),this.awaiting=!1},mounted:function(){this.$refs.image.addEventListener("load",this.onSuccessLoadImage),this.$refs.image.addEventListener("error",this.onFailLoadImage),this.onChangeImage(),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh),this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.debouncedUpdate.clear(),this.debouncedDisableTransitions.clear()},methods:{getResult:function(){var t=this.initialized?this.prepareResult($i({},this.coordinates)):this.defaultCoordinates(),e={rotate:this.imageTransforms.rotate%360,flip:$i({},this.imageTransforms.flip)};if(this.src&&this.imageLoaded){var i=this;return{image:this.image,coordinates:t,visibleArea:this.visibleArea?$i({},this.visibleArea):null,imageTransforms:e,get canvas(){return i.canvas?i.getCanvas():void 0}}}return{image:this.image,coordinates:t,visibleArea:this.visibleArea?$i({},this.visibleArea):null,canvas:void 0,imageTransforms:e}},zoom:function(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.transitions,r=n===void 0||n;this.onManipulateImage(new pv({},{factor:1/t,center:e}),{normalize:!1,transitions:r})},move:function(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.transitions,r=n===void 0||n;this.onManipulateImage(new pv({left:t||0,top:e||0}),{normalize:!1,transitions:r})},setCoordinates:function(t){var e=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=i.autoZoom,r=n===void 0||n,s=i.transitions,o=s===void 0||s;this.$nextTick(function(){e.imageLoaded?(e.transitionsActive||(o&&e.enableTransitions(),e.coordinates=e.applyTransform(t),r&&e.runAutoZoom("setCoordinates"),o&&e.debouncedDisableTransitions()),e.onChange()):e.delayedTransforms=t})},refresh:function(){var t=this,e=this.$refs.image;if(this.src&&e)return this.initialized?this.updateVisibleArea().then(function(){t.onChange()}):this.resetVisibleArea().then(function(){t.onChange()})},reset:function(){var t=this;return this.resetVisibleArea().then(function(){t.onChange(!1)})},awaitRender:function(t){var e=this;this.awaiting||(this.awaiting=!0,this.$nextTick(function(){t(),e.awaiting=!1}))},prepareResult:function(t){return this.roundResult?function(e){var i=e.coordinates,n=e.sizeRestrictions,r=e.positionRestrictions,s={width:Math.round(i.width),height:Math.round(i.height),left:Math.round(i.left),top:Math.round(i.top)};return s.width>n.maxWidth?s.width=Math.floor(i.width):s.width<n.minWidth&&(s.width=Math.ceil(i.width)),s.height>n.maxHeight?s.height=Math.floor(i.height):s.height<n.minHeight&&(s.height=Math.ceil(i.height)),os(s,r)}($i($i({},this.getPublicProperties()),{},{positionRestrictions:Zb(this.positionRestrictions,this.visibleArea),coordinates:t})):t},processAutoZoom:function(t,e,i,n){var r=this.autoZoomAlgorithm;r||(r=this.stencilSize?eEe:this.autoZoom?tEe:iEe);var s=r({event:{type:t,params:n},visibleArea:e,coordinates:i,boundaries:this.boundaries,aspectRatio:this.getAspectRatio(),positionRestrictions:this.positionRestrictions,getAreaRestrictions:this.getAreaRestrictions,sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize()});return $i($i({},s),{},{changed:!sz(s.visibleArea,e)||!sz(s.coordinates,i)})},runAutoZoom:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=e.transitions,n=i!==void 0&&i,r=$Pe(e,SEe),s=this.processAutoZoom(t,this.visibleArea,this.coordinates,r),o=s.visibleArea,a=s.coordinates,l=s.changed;n&&l&&this.enableTransitions(),this.visibleArea=o,this.coordinates=a,n&&l&&this.debouncedDisableTransitions()},normalizeEvent:function(t){return function(e){var i=e.event,n=e.visibleArea,r=e.coefficient;if(i.type==="manipulateImage")return Bt(Bt({},i),{move:{left:i.move&&i.move.left?r*i.move.left:0,top:i.move&&i.move.top?r*i.move.top:0},scale:{factor:i.scale&&i.scale.factor?i.scale.factor:1,center:i.scale&&i.scale.center?{left:i.scale.center.left*r+n.left,top:i.scale.center.top*r+n.top}:null}});if(i.type==="resize"){var s=Bt(Bt({},i),{directions:Bt({},i.directions)});return Wl.forEach(function(a){s.directions[a]*=r}),s}if(i.type==="move"){var o=Bt(Bt({},i),{directions:Bt({},i.directions)});return YPe.forEach(function(a){o.directions[a]*=r}),o}return i}($i($i({},this.getPublicProperties()),{},{event:t}))},getCanvas:function(){if(this.$refs.canvas){var t=this.$refs.canvas,e=this.$refs.image,i=this.imageTransforms.rotate!==0||this.imageTransforms.flip.horizontal||this.imageTransforms.flip.vertical?function(a,l,c){var u=c.rotate,h=c.flip,d={width:l.naturalWidth,height:l.naturalHeight},f=DH(d,u),m=a.getContext("2d");a.height=f.height,a.width=f.width,m.save();var g=cu(ss(Bt({left:0,top:0},d)),u);return m.translate(-(g.left-f.width/2),-(g.top-f.height/2)),m.rotate(u*Math.PI/180),m.translate(h.horizontal?d.width:0,h.vertical?d.height:0),m.scale(h.horizontal?-1:1,h.vertical?-1:1),m.drawImage(l,0,0,d.width,d.height),m.restore(),a}(this.$refs.sourceCanvas,e,this.imageTransforms):e,n=$i({minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,maxArea:this.maxCanvasSize,imageSmoothingEnabled:!0,imageSmoothingQuality:"high",fillColor:"transparent"},this.canvas),r=function(a){return a.find(function(l){return c=l,!Number.isNaN(parseFloat(c))&&isFinite(c);var c})},s=Jc({sizeRestrictions:{minWidth:r([n.width,n.minWidth])||0,minHeight:r([n.height,n.minHeight])||0,maxWidth:r([n.width,n.maxWidth])||1/0,maxHeight:r([n.height,n.maxHeight])||1/0},width:this.coordinates.width,height:this.coordinates.height,aspectRatio:{minimum:this.coordinates.width/this.coordinates.height,maximum:this.coordinates.width/this.coordinates.height}});if(n.maxArea&&s.width*s.height>n.maxArea){var o=Math.sqrt(n.maxArea/(s.width*s.height));s={width:Math.round(o*s.width),height:Math.round(o*s.height)}}return function(a,l,c,u,h){a.width=u?u.width:c.width,a.height=u?u.height:c.height;var d=a.getContext("2d");d.clearRect(0,0,a.width,a.height),h&&(h.imageSmoothingEnabled&&(d.imageSmoothingEnabled=h.imageSmoothingEnabled),h.imageSmoothingQuality&&(d.imageSmoothingQuality=h.imageSmoothingQuality),h.fillColor&&(d.fillStyle=h.fillColor,d.fillRect(0,0,a.width,a.height),d.save()));var f=c.left<0?-c.left:0,m=c.top<0?-c.top:0;d.drawImage(l,c.left+f,c.top+m,c.width,c.height,f,m,a.width,a.height)}(t,i,this.coordinates,s,n),t}},update:function(){this.$emit("change",this.getResult())},applyTransform:function(t){var e=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.visibleArea&&e?JPe(this.sizeRestrictions,this.visibleArea):this.sizeRestrictions,n=this.visibleArea&&e?Zb(this.positionRestrictions,this.visibleArea):this.positionRestrictions;return QPe({transform:t,coordinates:this.coordinates,imageSize:this.imageSize,sizeRestrictions:i,positionRestrictions:n,aspectRatio:this.getAspectRatio(),visibleArea:this.visibleArea})},resetCoordinates:function(){var t=this;if(this.$refs.image){this.$refs.cropper,this.$refs.image;var e=this.defaultSize;e||(e=this.stencilSize?sEe:rEe);var i=this.sizeRestrictions;i.minWidth,i.minHeight,i.maxWidth,i.maxHeight;var n=tm(e)?e({boundaries:this.boundaries,imageSize:this.imageSize,aspectRatio:this.getAspectRatio(),sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize(),visibleArea:this.visibleArea}):e,r=this.defaultPosition||nEe,s=[n,function(o){var a=o.coordinates;return $i({},tm(r)?r({coordinates:a,imageSize:t.imageSize,visibleArea:t.visibleArea}):t.defaultPosition)}];this.delayedTransforms&&s.push.apply(s,Xd(Array.isArray(this.delayedTransforms)?this.delayedTransforms:[this.delayedTransforms])),this.coordinates=this.applyTransform(s,!0),this.delayedTransforms=null}},clearImage:function(){var t=this;this.imageLoaded=!1,setTimeout(function(){var e=t.$refs.stretcher;e&&(e.style.height="auto",e.style.width="auto"),t.coordinates=t.defaultCoordinates(),t.boundaries={width:0,height:0}},this.transitionTime)},enableTransitions:function(){this.transitions&&(this.transitionsActive=!0)},disableTransitions:function(){this.transitionsActive=!1},updateBoundaries:function(){var t=this,e=this.$refs.stretcher,i=this.$refs.cropper;return this.initStretcher({cropper:i,stretcher:e,imageSize:this.imageSize}),this.$nextTick().then(function(){var n={cropper:i,imageSize:t.imageSize};if(tm(t.defaultBoundaries)?t.boundaries=t.defaultBoundaries(n):t.defaultBoundaries==="fit"?t.boundaries=function(r){var s=r.cropper,o=r.imageSize,a=s.clientHeight,l=s.clientWidth,c=a,u=o.width*a/o.height;return u>l&&(u=l,c=o.height*l/o.width),{width:u,height:c}}(n):t.boundaries=function(r){var s=r.cropper;return{width:s.clientWidth,height:s.clientHeight}}(n),!t.boundaries.width||!t.boundaries.height)throw new Error("It's impossible to fit the cropper in the current container")})},resetVisibleArea:function(){var t=this;return this.appliedImageTransforms=$i($i({},this.defaultImageTransforms),{},{flip:$i({},this.defaultImageTransforms.flip)}),this.updateBoundaries().then(function(){t.priority!=="visible-area"&&(t.visibleArea=null,t.resetCoordinates());var e,i,n,r,s,o,a=t.defaultVisibleArea||oEe;t.visibleArea=tm(a)?a({imageSize:t.imageSize,boundaries:t.boundaries,coordinates:t.priority!=="visible-area"?t.coordinates:null,getAreaRestrictions:t.getAreaRestrictions,stencilSize:t.getStencilSize()}):t.defaultVisibleArea,t.visibleArea=(e={visibleArea:t.visibleArea,boundaries:t.boundaries,getAreaRestrictions:t.getAreaRestrictions},i=e.visibleArea,n=e.boundaries,r=e.getAreaRestrictions,s=Bt({},i),o=Hi(n),s.width/s.height!==o&&(s.height=s.width/o),os(s,r({visibleArea:s,type:"move"}))),t.priority==="visible-area"?t.resetCoordinates():t.coordinates=t.fitCoordinates({visibleArea:t.visibleArea,coordinates:t.coordinates,aspectRatio:t.getAspectRatio(),positionRestrictions:t.positionRestrictions,sizeRestrictions:t.sizeRestrictions}),t.runAutoZoom("resetVisibleArea")}).catch(function(){t.visibleArea=null})},updateVisibleArea:function(){var t=this;return this.updateBoundaries().then(function(){t.visibleArea=t.fitVisibleArea({imageSize:t.imageSize,boundaries:t.boundaries,visibleArea:t.visibleArea,coordinates:t.coordinates,getAreaRestrictions:t.getAreaRestrictions}),t.coordinates=t.fitCoordinates({visibleArea:t.visibleArea,coordinates:t.coordinates,aspectRatio:t.getAspectRatio(),positionRestrictions:t.positionRestrictions,sizeRestrictions:t.sizeRestrictions}),t.runAutoZoom("updateVisibleArea")}).catch(function(){t.visibleArea=null})},onChange:function(){var t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];t&&this.debounce?this.debouncedUpdate():this.update()},onChangeImage:function(){var t,e=this;if(this.imageLoaded=!1,this.delayedTransforms=null,this.src){if(function(r){if(iz(r))return!1;var s=window.location,o=/(\w+:)?(?:\/\/)([\w.-]+)?(?::(\d+))?\/?/.exec(r)||[],a={protocol:o[1]||"",host:o[2]||"",port:o[3]||""},l=function(c){return c.port||((c.protocol||s.protocol)==="http"?80:433)};return!(!a.protocol&&!a.host&&!a.port||a.protocol&&a.protocol==s.protocol&&a.host&&a.host==s.host&&a.host&&l(a)==l(s))}(this.src)){var i=Rr(this.crossOrigin)?this.canvas:this.crossOrigin;i===!0&&(i="anonymous"),this.imageAttributes.crossOrigin=i||null}if(this.checkOrientation){var n=(t=this.src,new Promise(function(r){vEe(t).then(function(s){var o=yEe(s);r(s?{source:t,arrayBuffer:s,orientation:o}:{source:t,arrayBuffer:null,orientation:null})}).catch(function(s){console.warn(s),r({source:t,arrayBuffer:null,orientation:null})})}));setTimeout(function(){n.then(e.onParseImage)},this.transitionTime)}else setTimeout(function(){e.onParseImage({source:e.src})},this.transitionTime)}else this.clearImage()},onFailLoadImage:function(){this.imageAttributes.src&&(this.clearImage(),this.$emit("error"))},onSuccessLoadImage:function(){var t=this,e=this.$refs.image;e&&!this.imageLoaded&&(this.imageAttributes.height=e.naturalHeight,this.imageAttributes.width=e.naturalWidth,this.imageLoaded=!0,this.resetVisibleArea().then(function(){t.$emit("ready"),t.onChange(!1)}))},onParseImage:function(t){var e=this,i=t.source,n=t.arrayBuffer,r=t.orientation;this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.imageAttributes.revoke=!1,n&&r&&r>1?MH(i)||!iz(i)?(this.imageAttributes.src=URL.createObjectURL(new Blob([n])),this.imageAttributes.revoke=!0):this.imageAttributes.src=function(s){for(var o=[],a=new Uint8Array(s);a.length>0;){var l=a.subarray(0,8192);o.push(String.fromCharCode.apply(null,Array.from?Array.from(l):l.slice())),a=a.subarray(8192)}return"data:image/jpeg;base64,"+btoa(o.join(""))}(n):this.imageAttributes.src=i,tm(this.defaultTransforms)?this.appliedImageTransforms=Ox(this.defaultTransforms()):O0(this.defaultTransforms)?this.appliedImageTransforms=Ox(this.defaultTransforms):this.appliedImageTransforms=function(s){var o=Ox({});if(s)switch(s){case 2:o.flip.horizontal=!0;break;case 3:o.rotate=-180;break;case 4:o.flip.vertical=!0;break;case 5:o.rotate=90,o.flip.vertical=!0;break;case 6:o.rotate=90;break;case 7:o.rotate=90,o.flip.horizontal=!0;break;case 8:o.rotate=-90}return o}(r),this.defaultImageTransforms=$i($i({},this.appliedImageTransforms),{},{flip:$i({},this.appliedImageTransforms.flip)}),this.$nextTick(function(){var s=e.$refs.image;s&&s.complete&&(function(o){return!!o.naturalWidth}(s)?e.onSuccessLoadImage():e.onFailLoadImage())})},onResizeEnd:function(){this.runAutoZoom("resize",{transitions:!0})},onMoveEnd:function(){this.runAutoZoom("move",{transitions:!0})},onMove:function(t){var e=this;this.transitionsOptions.enabled||this.awaitRender(function(){e.coordinates=e.moveAlgorithm($i($i({},e.getPublicProperties()),{},{positionRestrictions:Zb(e.positionRestrictions,e.visibleArea),coordinates:e.coordinates,event:e.normalizeEvent(t)})),e.onChange()})},onResize:function(t){var e=this;this.transitionsOptions.enabled||this.stencilSize&&!this.autoZoom||this.awaitRender(function(){var i=e.sizeRestrictions,n=Math.min(e.coordinates.width,e.coordinates.height,20*e.coefficient);e.coordinates=e.resizeAlgorithm($i($i({},e.getPublicProperties()),{},{positionRestrictions:Zb(e.positionRestrictions,e.visibleArea),sizeRestrictions:{maxWidth:Math.min(i.maxWidth,e.visibleArea.width),maxHeight:Math.min(i.maxHeight,e.visibleArea.height),minWidth:Math.max(i.minWidth,n),minHeight:Math.max(i.minHeight,n)},event:e.normalizeEvent(t)})),e.onChange(),e.ticking=!1})},onManipulateImage:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.transitionsOptions.enabled){var i=e.transitions,n=i!==void 0&&i,r=e.normalize,s=r===void 0||r;n&&this.enableTransitions();var o=aEe($i($i({},this.getPublicProperties()),{},{event:s?this.normalizeEvent(t):t,getAreaRestrictions:this.getAreaRestrictions,imageRestriction:this.imageRestriction,adjustStencil:!this.stencilSize&&this.settings.resizeImage.adjustStencil})),a=o.visibleArea,l=o.coordinates;this.visibleArea=a,this.coordinates=l,this.runAutoZoom("manipulateImage"),this.onChange(),n&&this.debouncedDisableTransitions()}},onPropsChange:function(){this.coordinates=this.applyTransform(this.coordinates,!0),this.onChange(!1)},getAreaRestrictions:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.visibleArea,i=t.type,n=i===void 0?"move":i;return this.areaRestrictionsAlgorithm({boundaries:this.boundaries,imageSize:this.imageSize,imageRestriction:this.imageRestriction,visibleArea:e,type:n})},getAspectRatio:function(t){var e,i,n=this.stencilProps,r=n.aspectRatio,s=n.minAspectRatio,o=n.maxAspectRatio;if(this.$refs.stencil&&this.$refs.stencil.aspectRatios){var a=this.$refs.stencil.aspectRatios();e=a.minimum,i=a.maximum}if(Rr(e)&&(e=Rr(r)?s:r),Rr(i)&&(i=Rr(r)?o:r),!t&&(Rr(e)||Rr(i))){var l=this.getStencilSize(),c=l?Hi(l):null;Rr(e)&&(e=nz(c)?c:void 0),Rr(i)&&(i=nz(c)?c:void 0)}return{minimum:e,maximum:i}},getStencilSize:function(){if(this.stencilSize)return t={currentStencilSize:{width:this.stencilCoordinates.width,height:this.stencilCoordinates.height},stencilSize:this.stencilSize,boundaries:this.boundaries,coefficient:this.coefficient,coordinates:this.coordinates,aspectRatio:this.getAspectRatio(!0)},e=t.boundaries,i=t.stencilSize,n=t.aspectRatio,Lx(Hi(r=tm(i)?i({boundaries:e,aspectRatio:n}):i),n)&&(r=Jc({sizeRestrictions:{maxWidth:e.width,maxHeight:e.height,minWidth:0,minHeight:0},width:r.width,height:r.height,aspectRatio:{minimum:n.minimum,maximum:n.maximum}})),(r.width>e.width||r.height>e.height)&&(r=Jc({sizeRestrictions:{maxWidth:e.width,maxHeight:e.height,minWidth:0,minHeight:0},width:r.width,height:r.height,aspectRatio:{minimum:Hi(r),maximum:Hi(r)}})),r;var t,e,i,n,r},getPublicProperties:function(){return{coefficient:this.coefficient,visibleArea:this.visibleArea,coordinates:this.coordinates,boundaries:this.boundaries,sizeRestrictions:this.sizeRestrictions,positionRestrictions:this.positionRestrictions,aspectRatio:this.getAspectRatio(),imageRestriction:this.imageRestriction}},defaultCoordinates:function(){return $i({},rz)},flip:function(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.transitions,r=n===void 0||n;if(!this.transitionsActive){r&&this.enableTransitions();var s=$i({},this.imageTransforms.flip),o=cEe({flip:{horizontal:t?!s.horizontal:s.horizontal,vertical:e?!s.vertical:s.vertical},previousFlip:s,rotate:this.imageTransforms.rotate,visibleArea:this.visibleArea,coordinates:this.coordinates,imageSize:this.imageSize,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),a=o.visibleArea,l=o.coordinates;t&&(this.appliedImageTransforms.flip.horizontal=!this.appliedImageTransforms.flip.horizontal),e&&(this.appliedImageTransforms.flip.vertical=!this.appliedImageTransforms.flip.vertical),this.visibleArea=a,this.coordinates=l,this.onChange(),r&&this.debouncedDisableTransitions()}},rotate:function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=e.transitions,n=i===void 0||i;if(!this.transitionsActive){n&&this.enableTransitions();var r=$i({},this.imageSize);this.appliedImageTransforms.rotate+=t;var s=lEe({visibleArea:this.visibleArea,coordinates:this.coordinates,previousImageSize:r,imageSize:this.imageSize,angle:t,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),o=s.visibleArea,a=s.coordinates,l=this.processAutoZoom("rotateImage",o,a);o=l.visibleArea,a=l.coordinates,this.visibleArea=o,this.coordinates=a,this.onChange(),n&&this.debouncedDisableTransitions()}}},emits:["change","error","ready"]},bEe={key:0,ref:"canvas",style:{display:"none"}},_Ee={key:1,ref:"sourceCanvas",style:{display:"none"}};WH.render=function(t,e,i,n,r,s){return Te(),qe("div",{ref:"cropper",class:s.classes.cropper},[w("div",{ref:"stretcher",class:s.classes.stretcher},null,2),w("div",{class:s.classes.boundaries,style:s.boundariesStyle},[(Te(),qe(Sv(i.backgroundWrapperComponent),{class:s.classes.cropperWrapper,"wheel-resize":s.settings.resizeImage.wheel,"touch-resize":s.settings.resizeImage.touch,"touch-move":s.settings.moveImage.touch,"mouse-move":s.settings.moveImage.mouse,onMove:s.onManipulateImage,onResize:s.onManipulateImage},{default:U(function(){return[w("div",{class:s.classes.background,style:s.boundariesStyle},null,6),w("div",{class:s.classes.imageWrapper},[w("img",{ref:"image",crossorigin:r.imageAttributes.crossOrigin,src:r.imageAttributes.src,class:s.classes.image,style:s.imageStyle,onMousedown:e[1]||(e[1]=Qx(function(){},["prevent"]))},null,46,["crossorigin","src"])],2),w("div",{class:s.classes.foreground,style:s.boundariesStyle},null,6),fi((Te(),qe(Sv(i.stencilComponent),ht({ref:"stencil",image:s.image,coordinates:r.coordinates,"stencil-coordinates":s.stencilCoordinates,transitions:s.transitionsOptions},i.stencilProps,{onResize:s.onResize,onResizeEnd:s.onResizeEnd,onMove:s.onMove,onMoveEnd:s.onMoveEnd}),null,16,["image","coordinates","stencil-coordinates","transitions","onResize","onResizeEnd","onMove","onMoveEnd"])),[[ln,r.imageLoaded]]),i.canvas?(Te(),qe("canvas",bEe,null,512)):Vi("",!0),i.canvas?(Te(),qe("canvas",_Ee,null,512)):Vi("",!0)]}),_:1},8,["class","wheel-resize","touch-resize","touch-move","mouse-move","onMove","onResize"]))],6)],2)};const PEe=ri({__name:"PhotoCropper",emits:["no-capture","photo-captured"],setup(t,{emit:e}){const i=fS(),n=Fp(),r=cE(),s=LP(),o=e,a=Eh(),{temporaryProfilePicture:l}=Ji(a),c=ge(""),u=W(()=>l.value);let h=null,d=1,f=null;fae(async(b,_)=>{d=_.path.includes("photocapture")?2:1;const P=l.value;createImageBitmap(g(P)).then(E=>{h=E})});function m(b){h&&(c.value=b.canvas.toDataURL("image/png"),f=g(c.value))}function g(b){const _=b.split(",");let P;_[0].indexOf("base64")>=0?P=atob(_[1]):P=unescape(_[1]);const E=_[0].indexOf(":"),T=_[0].indexOf(";"),C=_[0].substring(E+1,T),M=new Uint8Array(P.length);for(let x=0;x<P.length;x++)M[x]=P.charCodeAt(x);return new Blob([M],{type:C})}function v(){var b;if(f){const _=((b=n.currentUser)==null?void 0:b.uid)??"nouser",P=Mu(r,`profilePictures/${_}`);_ue(P,f,{contentType:"image/png"}).then(E=>dp(E.ref)).then(E=>{o("photo-captured",{}),s.go(-d);const T=vl(i,"users",_);return Tpe(T,{profilePictureURL:E},{merge:!0})}).then(()=>{$.fire("show-alert",{key:"Profile picture is saved to Firebase",type:"info"}),l.value=""}).catch(E=>{$.fire("show-alert",{key:"Unable to upload profile picture to Firebase"+E,type:"error"})})}}function p(){l.value="",o("no-capture",{}),s.go(-d)}return(b,_)=>{var P;return Te(),Ct("div",null,[u.value.length>0?(Te(),qe(le(WH),{key:0,class:"cropper",src:u.value,"stencil-props":{aspectRation:1/1,resizable:!0},"stencil-component":(P=b.$options.components)==null?void 0:P.CircleStencil,onChange:m},null,8,["src","stencil-component"])):Vi("",!0),w(Qt,{onClick:v},{default:U(()=>[w(lt,{left:"",color:"secondary"},{default:U(()=>[$e("mdi-upload")],void 0,!0),_:1}),$e(" Crop & Upload ")],void 0),_:1}),w(Qt,{onClick:p},{default:U(()=>[w(lt,{left:"",color:"secondary"},{default:U(()=>[$e("mdi-close")],void 0,!0),_:1}),$e(" Cancel ")],void 0),_:1})])}}});const EEe=Tn(PEe,[["__scopeId","data-v-9dd1cf4c"]]),wEe=[{path:"/",name:"Home",component:QF},{path:"/account",name:"Account",component:jPe},{path:"/construction/:documentId",name:"Construction",component:QF,props:!0},{path:"/settings",component:()=>bT(()=>import("./Settings-bea97d95.js"),["assets/Settings-bea97d95.js","assets/Settings-6cf53e1c.css"]),children:[{path:"/",component:()=>bT(()=>import("./ProfilePicture-a481549f.js"),["assets/ProfilePicture-a481549f.js","assets/ProfilePicture-0490a60a.css"])},{name:"PhotoCapture",path:"photocapture",component:()=>bT(()=>import("./PhotoCapture-2a662be7.js"),["assets/PhotoCapture-2a662be7.js","assets/PhotoCapture-89e88b51.css"])},{name:"PhotoCropper",path:"photocropper/:image",component:EEe,props:!0}]}],TEe=_ae({history:Doe("/"),routes:wEe});const xEe=["aria-labelledby"],kEe=["innerHTML"],CEe=ri({__name:"IconBase",props:{iconName:{},iconSize:{},notInline:{type:Boolean}},setup(t){const e=t;let i=[[]];const n=ge(!1);let r="",s="";const o=ge(""),a=ge(S.icons.defaultIconSize),l=ge("");ki(()=>{e.notInline===void 0?a.value=e.iconSize??S.icons.defaultInlineIconSize:a.value=e.iconSize??S.icons.defaultIconSize,r=S.icons[e.iconName].props.filePath,i=S.icons[e.iconName].props.emphasizeTypes,n.value=S.icons[e.iconName].props.mdiIcon,typeof n.value!="string"?N_.get(r,{responseType:"text"}).then(p=>{s=p.data;const b=s.split(";");b.forEach((_,P)=>{var M;if(P===0)return;const E=u(_,"type"),T=u(_,"side");if(u(_,"myfill")==="true"&&E==="angleMarker"){const x=((M=u(_,"d"))==null?void 0:M.split(" "))??[];if(x.length===0)throw new Error(`IconBase - Undefined d path attribute in ${_}.`);T==="front"?(b[P]=h(b[P],"transform",f(u(b[P],"transform")??"",S.icons.normal.angle.scale.front,Number(x[1])*(1-S.icons.normal.angle.scale.front),Number(x[2])*(1-S.icons.normal.angle.scale.front))),b[P-1]=h(b[P-1],"transform",f(u(b[P-1],"transform")??"",S.icons.normal.angle.scale.front,Number(x[1])*(1-S.icons.normal.angle.scale.front),Number(x[2])*(1-S.icons.normal.angle.scale.front)))):(b[P]=h(b[P],"transform",f(u(b[P],"transform")??"",S.icons.normal.angle.scale.front,Number(x[1])*(1-S.icons.normal.angle.scale.back),Number(x[2])*(1-S.icons.normal.angle.scale.back))),b[P-1]=h(b[P-1],"transform",f(u(b[P-1],"transform")??"",S.icons.normal.angle.scale.front,Number(x[1])*(1-S.icons.normal.angle.scale.back),Number(x[2])*(1-S.icons.normal.angle.scale.back))))}}),b.forEach((_,P)=>{P!==0&&(b[P]=c(b[P]),b[P]=d(b[P],"type"),b[P]=d(b[P],"side"),b[P]=d(b[P],"myfill"),b[P]=d(b[P],"part"))}),o.value=b.join(" ")}):l.value=n.value});function c(p){const b=u(p,"type");if(b===void 0)throw new Error(`IconBase - amendAttributes ${p} has no attribute type`);const _=u(p,"side");if(_===void 0)throw new Error(`IconBase - amendAttributes ${p} has no attribute side`);const P=u(p,"myfill");if(P===void 0)throw new Error(`IconBase - amendAttributes ${p} has no attribute fill`);let E,T,C;switch(b){case"boundaryCircle":p=h(p,"stroke-width",S.icons.boundaryCircle.strokeWidth.toString()),p=h(p,"stroke",S.icons.boundaryCircle.color);break;case"angleMarker":P==="false"?(T=m("angleMarker",i,_),E=g("angleMarker",i,_),p=h(p,"stroke-width",T),p=h(p,"stroke",E)):(C=v("angleMarker",i,_),p=h(p,"fill",C));break;case"circle":u(p,"stroke")!=="undefined"?(T=m("circle",i,_),E=g("circle",i,_),p=h(p,"stroke-width",T),p=h(p,"stroke",E)):(C=v("circle",i,_),C!==""&&(p=h(p,"fill",C)));break;case"line":T=m("line",i,_),E=g("line",i,_),p=h(p,"stroke-width",T),p=h(p,"stroke",E);break;case"point":T=m("point",i,_),E=g("point",i,_),C=v("point",i,_),p=h(p,"stroke-width",T),p=h(p,"stroke",E),p=h(p,"fill",C),p=h(p,"transform",f(u(p,"transform")??"",_==="back"?S.icons.normal.point.scale.back:S.icons.normal.point.scale.front));break;case"segment":T=m("segment",i,_),E=g("segment",i,_),p=h(p,"stroke-width",T),p=h(p,"stroke",E);break;case"ellipse":u(p,"stroke")!=="undefined"?(T=m("ellipse",i,_),E=g("ellipse",i,_),p=h(p,"stroke-width",T),p=h(p,"stroke",E)):(C=v("ellipse",i,_),C!==""&&(p=h(p,"fill",C)));break}return p}function u(p,b){const _=p.indexOf(b+"=");if(_===-1)return;const P=_+b.length+2,E=p.indexOf('"',P);return p.slice(P,E)}function h(p,b,_){const P=p.indexOf(b+"=");if(P===-1)return p;const E=P+b.length+2,T=p.indexOf('"',E),C=p.slice(0,E),M=p.slice(T);return C+_+M}function d(p,b){const _=p.indexOf(b+"=");if(_===-1)return p;const P=_+b.length+2,E=p.indexOf('"',P),T=p.slice(0,P),C=p.slice(E);return T+C}function f(p,b,_,P){if(p==="")throw new Error("IconBase - Error in Set Transform Scale. Undefined SVG transform matrix");const E=p.slice(7,p.length-1).split(" ").map(T=>Number(T));return _!==void 0&&(E[4]=_),P!==void 0&&(E[5]=P),"matrix("+b*Math.sign(E[0])+" 0 0 "+b*Math.sign(E[3])+" "+E[4]+" "+E[5]+")"}function m(p,b,_){let P;switch(p){case"point":return P=b.findIndex(E=>E[0]==="point"),P===-1?_==="back"?S.icons.normal.point.strokeWidth.back.toString():S.icons.normal.point.strokeWidth.front.toString():_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.point.strokeWidth.back.toString():S.icons.normal.point.strokeWidth.back.toString():b[P].indexOf("front")!==-1?S.icons.emphasize.point.strokeWidth.front.toString():S.icons.normal.point.strokeWidth.front.toString();case"line":return P=b.findIndex(E=>E[0]==="line"),P===-1?_==="back"?S.icons.normal.line.strokeWidth.back.toString():S.icons.normal.line.strokeWidth.front.toString():_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.line.strokeWidth.back.toString():S.icons.normal.line.strokeWidth.back.toString():b[P].indexOf("front")!==-1?S.icons.emphasize.line.strokeWidth.front.toString():S.icons.normal.line.strokeWidth.front.toString();case"segment":return P=b.findIndex(E=>E[0]==="segment"),P===-1?_==="back"||_==="03"?S.icons.normal.segment.strokeWidth.back.toString():S.icons.normal.segment.strokeWidth.front.toString():_==="back"||_==="03"?b[P].indexOf("back")!==-1?S.icons.emphasize.segment.strokeWidth.back.toString():S.icons.normal.segment.strokeWidth.back.toString():b[P].indexOf("front")!==-1?S.icons.emphasize.segment.strokeWidth.front.toString():S.icons.normal.segment.strokeWidth.front.toString();case"circle":return P=b.findIndex(E=>E[0]==="circle"),P===-1?_==="back"?S.icons.normal.circle.strokeWidth.back.toString():S.icons.normal.circle.strokeWidth.front.toString():_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.circle.strokeWidth.back.toString():S.icons.normal.circle.strokeWidth.back.toString():b[P].indexOf("front")!==-1?S.icons.emphasize.circle.strokeWidth.front.toString():S.icons.normal.circle.strokeWidth.front.toString();case"angleMarker":return P=b.findIndex(E=>E[0]==="angleMarker"),P===-1?_==="back"?S.icons.normal.angle.strokeWidth.back.toString():S.icons.normal.angle.strokeWidth.front.toString():_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.angleMarker.strokeWidth.back.toString():S.icons.normal.angle.strokeWidth.back.toString():b[P].indexOf("front")!==-1?S.icons.emphasize.angleMarker.strokeWidth.front.toString():S.icons.normal.angle.strokeWidth.front.toString();case"ellipse":return P=b.findIndex(E=>E[0]==="ellipse"),P===-1?_==="back"?S.icons.normal.ellipse.strokeWidth.back.toString():S.icons.normal.ellipse.strokeWidth.front.toString():_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.ellipse.strokeWidth.back.toString():S.icons.normal.ellipse.strokeWidth.back.toString():b[P].indexOf("front")!==-1?S.icons.emphasize.ellipse.strokeWidth.front.toString():S.icons.normal.ellipse.strokeWidth.front.toString()}return"1"}function g(p,b,_){let P;switch(p){case"point":return P=b.findIndex(E=>E[0]==="point"),P===-1?_==="back"?S.icons.normal.point.edgeColor.back:S.icons.normal.point.edgeColor.front:_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.point.edgeColor.back:S.icons.normal.point.edgeColor.back:b[P].indexOf("front")!==-1?S.icons.emphasize.point.edgeColor.front:S.icons.normal.point.edgeColor.front;case"line":return P=b.findIndex(E=>E[0]==="line"),P===-1?_==="back"?S.icons.normal.line.edgeColor.back:S.icons.normal.line.edgeColor.front:_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.line.edgeColor.back:S.icons.normal.line.edgeColor.back:b[P].indexOf("front")!==-1?S.icons.emphasize.line.edgeColor.front:S.icons.normal.line.edgeColor.front;case"segment":return P=b.findIndex(E=>E[0]==="segment"),P===-1?_==="back"||_==="03"?S.icons.normal.segment.edgeColor.back:S.icons.normal.segment.edgeColor.front:_==="back"||_==="03"?b[P].indexOf("back")!==-1?S.icons.emphasize.segment.edgeColor.back:S.icons.normal.segment.edgeColor.back:b[P].indexOf("front")!==-1?S.icons.emphasize.segment.edgeColor.front:S.icons.normal.segment.edgeColor.front;case"circle":return P=b.findIndex(E=>E[0]==="circle"),P===-1?_==="back"?S.icons.normal.circle.edgeColor.back:S.icons.normal.circle.edgeColor.front:_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.circle.edgeColor.back:S.icons.normal.circle.edgeColor.back:b[P].indexOf("front")!==-1?S.icons.emphasize.circle.edgeColor.front:S.icons.normal.circle.edgeColor.front;case"angleMarker":return P=b.findIndex(E=>E[0]==="angleMarker"),P===-1?_==="back"?S.icons.normal.angle.edgeColor.back:S.icons.normal.angle.edgeColor.front:_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.angleMarker.edgeColor.back:S.icons.normal.angle.edgeColor.back:b[P].indexOf("front")!==-1?S.icons.emphasize.angleMarker.edgeColor.front:S.icons.normal.angle.edgeColor.front;case"ellipse":return P=b.findIndex(E=>E[0]==="ellipse"),P===-1?_==="back"?S.icons.normal.ellipse.edgeColor.back:S.icons.normal.ellipse.edgeColor.front:_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.ellipse.edgeColor.back:S.icons.normal.ellipse.edgeColor.back:b[P].indexOf("front")!==-1?S.icons.emphasize.ellipse.edgeColor.front:S.icons.normal.ellipse.edgeColor.front}return"hsla(0, 0%, 0%, 1)"}function v(p,b,_){let P;switch(p){case"point":return P=b.findIndex(E=>E[0]==="point"),P===-1?_==="back"?S.icons.normal.point.fillColor.back:S.icons.normal.point.fillColor.front:_==="back"?b[P].indexOf("back")!==-1?S.icons.emphasize.point.fillColor.back:S.icons.normal.point.fillColor.back:b[P].indexOf("front")!==-1?S.icons.emphasize.point.fillColor.front:S.icons.normal.point.fillColor.front;case"line":break;case"segment":break;case"circle":return P=b.findIndex(E=>E[0]==="circle"),P===-1?_==="back"?S.icons.normal.circle.fillColor.back:S.icons.normal.circle.fillColor.front:_==="back"?b[P].indexOf("back")!==-1?"":S.icons.normal.circle.fillColor.back:b[P].indexOf("front")!==-1?"":S.icons.normal.circle.fillColor.front;case"angleMarker":return P=b.findIndex(E=>E[0]==="angleMarker"),P===-1?_==="14"||_==="15"?S.icons.normal.angle.fillColor.back:S.icons.normal.angle.fillColor.front:_==="14"||_==="15"?b[P].indexOf("back")!==-1?S.icons.emphasize.angleMarker.fillColor.back:S.icons.normal.angle.fillColor.back:b[P].indexOf("front")!==-1?S.icons.emphasize.angleMarker.fillColor.front:S.icons.normal.angle.fillColor.front;case"ellipse":return P=b.findIndex(E=>E[0]==="ellipse"),P===-1?_==="back"?S.icons.normal.ellipse.fillColor.back:S.icons.normal.ellipse.fillColor.front:_==="back"?b[P].indexOf("back")!==-1?"":S.icons.normal.ellipse.fillColor.back:b[P].indexOf("front")!==-1?"":S.icons.normal.ellipse.fillColor.front}return"hsla(0, 0%, 0%, 0)"}return(p,b)=>n.value?(Te(),qe(lt,{key:0,size:a.value},{default:U(()=>[$e(nt(l.value),1)],void 0),_:1},8,["size"])):(Te(),Ct("svg",{key:1,xmlns:"http://www.w3.org/2000/svg",transform:"matrix(1 0 0 -1 0 0)",viewBox:"-250 -250 500 500",preserveAspectRatio:"xMidYMid meet",class:"customIcon","aria-labelledby":p.iconName,style:{overflow:"visible"},"vector-effect":"non-scaling-stroke"},[tt("g",{innerHTML:o.value},null,8,kEe)],8,xEe))}});const MEe=Tn(CEe,[["__scopeId","data-v-29d7de40"]]),AEe=["earthPoint","angle","angleBisector","antipodalPoint","applyTransformation","appSettings","calculationObject","circle","clearConstruction","constructionsTab","coordinate","copyToClipboard","cycleNodeValueDisplayMode","delete","deleteConstruction","deleteNode","downloadConstruction","earthLatitude","earthLongitude","earthPoint","ellipse","hide","hideNode","hideNodeLabel","iconFactory","intersect","inversion","line","measuredCircle","measurementObject","measurePolygon","measureTriangle","midpoint","move","notifications","nSectLine","nSectPoint","objectsTab","parametric","perpendicular","point","pointDistance","pointOnObject","pointReflection","polar","redo","reflection","rotate","rotation","segment","segment","segmentLength","select","shareConstruction","showNode","showNodeLabel","slider","stylePanel","tangent","threePointCircle","toggleLabelDisplay","toolsTab","transformedCircle","transformedEllipse","transformedLine","transformedPoint","transformedSegment","translation","undo","zoomFit","zoomIn","zoomOut"],VEe=t=>t.reduce((e,i,n)=>({...e,[i]:()=>ia(MEe,{iconName:i})}),{}),LEe=VEe(AEe),IEe=lG({icons:{defaultSet:"mdi",aliases:LEe,sets:{}},defaults:{VTooltip:{openDelay:500,closeDelay:0,disabled:!1}},theme:{themes:{light:{},dark:{}}}});Pi.prototype.toFixed=function(t){return"("+this.x.toFixed(t)+","+this.y.toFixed(t)+")"};k.prototype.toFixed=function(t){return"("+this.x.toFixed(t)+","+this.y.toFixed(t)+","+this.z.toFixed(t)+")"};k.prototype.from=function(t){if(t!==void 0){const e=t.replaceAll(/[()]/g,"").split(",").map(Number);this.setX(e[0]),this.setY(e[1]),this.setZ(e[2])}else this.setX(0),this.setY(0),this.setZ(1)};k.prototype.isZero=function(t){const e=t||S.tolerance;return Math.abs(this.x)<=e&&Math.abs(this.y)<=e&&Math.abs(this.z)<=e};Number.prototype.toDegrees=function(){return Number(this)/Math.PI*180};Number.prototype.toRadians=function(){return Number(this)*Math.PI/180};Number.prototype.modTwoPi=function(){return(Number(this)%(2*Math.PI)+2*Math.PI)%(2*Math.PI)};Number.prototype.modPi=function(){return(Number(this)%Math.PI+Math.PI)%Math.PI};Array.prototype.rotate=function(t){const e=this.length>>>0;let i=t>>0;return i=(i%e+e)%e,Array.prototype.push.apply(this,Array.prototype.splice.call(this,0,i)),this};Array.prototype.clear=function(){Array.prototype.splice.call(this,0,this.length)};function OEe(t){return t instanceof Ze?"point":t instanceof Jt?"segment":t instanceof Kt?"circle":t instanceof $t?"line":"point"}const im=new k;new k;Xe.prototype.attachLabelWithOffset=function(t){const e=OEe(this),i=new De(e,this);switch(e){case"point":im.copy(this.locationVector).add(t).normalize();break;case"line":im.copy(this.endSEPoint.locationVector).add(t).normalize();break;case"segment":im.copy(this.getMidPointVector()).add(t).normalize(),this.arcLength>Math.PI&&im.multiplyScalar(-1);break;case"circle":im.copy(this.circleSEPoint.locationVector).add(t).normalize();break}return i.locationVector=im,i};var DEe="firebase",NEe="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tc(DEe,NEe,"app");const REe={apiKey:"AIzaSyDNA-9m5KvjcxAeTE6ixr_bhXr2Hs2zNys",authDomain:"spherical-easel.firebaseapp.com",projectId:"spherical-easel",storageBucket:"spherical-easel.appspot.com",messagingSenderId:"157369820516",appId:"1:157369820516:web:70391e3fea4b7d6ef7c671"},FEe=BZ();qB(REe);const SS=z9(poe);SS.use(IEe);SS.use(TEe);SS.use(FEe);SS.use(_e);SS.mount("#app");const ew=An();L.setGlobalStore(ew);Tr.setGlobalStore(ew);Xe.setGlobalStore(ew);pe.setGlobalStore(ew);export{vl as $,to as A,ki as B,fi as C,Mo as D,We as E,mt as F,MV as G,vt as H,Tt as I,ht as J,z_ as K,df as L,Ua as M,KW as N,ji as O,Ao as P,Oi as Q,Cy as R,za as S,rl as T,RP as U,Ph as V,nwe as W,Fp as X,fS as Y,yy as Z,Tn as _,qe as a,S as a0,ml as a1,wu as a2,Vi as a3,J_e as a4,Wm as a5,mo as a6,vr as a7,ym as a8,mr as a9,lPe as aa,Tpe as ab,$ as ac,EY as ad,Q8 as ae,e6 as af,tve as ag,LP as ah,dc as ai,an as aj,dae as ak,w as b,W as c,ri as d,pr as e,Si as f,Qt as g,lt as h,$e as i,tt as j,gP as k,Bm as l,Ct as m,Zs as n,Te as o,jo as p,zW as q,ge as r,le as s,nt as t,qn as u,lh as v,U as w,uc as x,Eh as y,Ji as z};
